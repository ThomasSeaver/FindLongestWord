var bCheating = false;

function ChangePersonLst(md) {
	var i;
	var j;
	var av = md.getElementById("peoplelst");
	var s = av.options[av.selectedIndex].value;
	if (s == "you") per = perYou;
	else if (findPerson(s) === null) return;
	md.getElementById("pname").innerHTML = per.getPersonName() + (per.uid == "you" ? " <a class='black' href='' onclick='var na=prompt(\"Name?\",perYou.getPersonName());if(na)perYou.name=na;updateLeftBar();ChangePersonLst(document);return false'>Rename</a>" : "");
	md.getElementById("uid").innerHTML = per.uid;
	md.getElementById("pgender").innerHTML = per.getPersonGender() +
		(per.uid == "you" && isPossess() ? " (now " + perYourBody.getPersonGender() + ")" : "") + (per.uid == "you" ? " <a class='black' href='' onclick='GenderToggle();return false'>Change</a>" : "");
	md.getElementById("pplace").innerHTML = (per.uid == "you" ? Place + (isPossess() ? " (body " + per.place + ")" : "") : per.whereNow() + "(" + per.place + ")") + "";
	md.getElementById("pcharm").innerHTML = (per.sCharmedBy === "" ? "No-one" : per.sCharmedBy) + " (" + per.charmed + ")";
	md.getElementById("pcharmtime").innerHTML = per.charmedTime + " (for " + per.hoursCharmed(per.sCharmedBy) +
		"hrs)";
	s = "";
	for (var k = 0; k < per.flags.length; k++) {
		var s1 = dec2bin(per.flags[k]);
		if (s1.length < 32) {
			j = s1.length;
			for (i = j; i < 32; i++) s1 = "0" + s1
		}
		if (k > 0) s += "<br>";
		s += s1
	}
	md.getElementById("pflags").innerHTML = s;
	s = per.other;
	for (i = 0; i < per.extra.length; i++) s += ", " + per.extra[i];
	md.getElementById("pextra").innerHTML = s;
	md.getElementById("phealth").innerHTML = per.health + "";
	s = "";
	if (per.NoItems > 0)
		for (i = 1; i <= per.NoItems; i++) {
			if (i > 1) s += ", ";
			s += getItemName(per.Items[i])
		}
	md.getElementById("pitems").innerHTML = s
}

function writePersonDetails() {
	var md = WritePlaceHeader(true);
	var cw;
	if (gameState.nRightBarState == 2 || gameState.bInventoryPopup) cw = gameState.nLeftBarState == 2 ? "100vw - 45px" : "91vw - 20px";
	else if (gameState.nRightBarState == 1) cw = gameState.nLeftBarState == 2 ? "100vw - 45px" : "91vw - 20px";
	else if (gameState.nRightBarState > 2) cw = gameState.nLeftBarState == 2 ? "100vw - 45px" : "91vw - 20px";
	md.write('<div style="width:100%;width:calc(' + cw + ')">' + '<table style="width:100%;padding:2px;border-collapse:collapse;border-spacing:0;border-width:0"><tr style="width:100%"><td class="inventbar" style="vertical-align:top;width:100%"><p style="font-size:x-large"><b>People in the Game</b></p></td></tr></table>' +
		'<p style="font-size:medium">These are the details for all defined people in the game.</p>' + '<table style="width:98%;background-color:lightcyan;color:black;text-align:left">' + '<tr><td style="width:20%;vertical-align:top">' + '<select name="peoplelst" id="peoplelst" size="1" onchange="ChangePersonLst(document)">');
	var p;
	var par = [];
	var i;
	for (i = 0; i < arPeople.length; i++) {
		p = arPeople[i];
		var s = '<option value="' + p.uid + '"';
		if (p.uid == "you") s += " selected>You</option>";
		else s += ">" + p.name + "</option>";
		par.push(s)
	}
	par.sort();
	for (i = 0; i < par.length; i++) md.write(par[i]);
	md.write('</select></td><td style="width:80%"><table style="color:black">' + '<tr><td style="width:33%"><b>Person Name: </b></td><td style="width:66%"><span id="pname"></span> (id: <span id="uid"></span>)</td></tr>' + '<tr><td style="width:33%"><b>Gender: </b></td><td style="width:66%"><span id="pgender"></span></td></tr>' + '<tr><td style="width:33%"><b>Location: </b></td><td style="width:66%"><span id="pplace"></span></td></tr>' + '<tr><td style="width:33%"><b>Charmed: </b></td><td style="width:66%"><span id="pcharm"></span></td></tr>' +
		'<tr><td style="width:33%"><b>Charmed At: </b></td><td style="width:66%"><span id="pcharmtime"></span></td></tr>' + '<tr><td style="width:33%"><b>Flags: </b></td><td style="width:66%"><span id="pflags"></span></td></tr>' + '<tr><td style="width:33%"><b>Other + Extra: </b></td><td style="width:66%"><span id="pextra"></span></td></tr>' + '<tr><td style="width:33%"><b>Health: </b></td><td style="width:66%"><span id="phealth"></span></td></tr>' + '<tr><td style="width:33%"><b>Items: </b></td><td style="width:66%"><span id="pitems"></span></td></tr>' +
		'<tr><td><a class="black" href="" onclick="ChangeCharm();return false" title="person,level">Charm them</a> <input type="text" id="charmby" size="10" value=""></td>' + '<td><a class="black" href="" onclick="MoveThem();return false">Move them</a> <input type="text" id="moveto" size="10" value=""> <a class="black" href="" onclick="HealThem();return false">Heal them</a> <input type="text" id="heal" size="10" value=""></td></tr>' + '<tr><td><a class="black" href="" onclick="ChangeFlag();return false">Toggle Flag</a> <input type="text" id="tflag" size="10" value=""></td>' +
		'<td><a class="black" href="" onclick="ChangeOther();return false">Change Other/Extra</a> <input type="text" id="oextra" size="2" value=""> to <input type="text" id="oextravalue" size="10" value=""></td></tr>' + "</table></td></tr></table>" + "<script type='text/javascript'>" + "function ChangeFlag() {" + "var flg = document.getElementById('tflag').value;" + "var ps = document.getElementById('uid').innerHTML;" + "var per = findPerson(ps);" + "if (per === null) return;" + "var no = parseInt(flg,10);" + "if (flg !== '') per.setFlag(no, !per.checkFlag(no));" +
		"ChangePersonLst(document);" + "}\r" + "function ChangeOther() {" + "var flg = document.getElementById('oextra').value;" + "var ps = document.getElementById('uid').innerHTML;" + "var no = 0;" + "if (no !== '') no = parseInt(flg,10);" + "var vals = document.getElementById('oextravalue').value;" + "if (vals !== '') setPersonOther(ps,parseInt(vals,10), no);" + "ChangePersonLst(document);" + "}\r" + "function ChangeCharm() {" + "var by = document.getElementById('charmby').value;" + "var ar = by.split(',');" + "var wby = ar[0];" +
		"var clv = 4;" + "if (ar.length > 0) clv = parseInt(ar[1], 10);" + "var ps = document.getElementById('uid').innerHTML;" + "var per = findPerson(ps);" + "if (per === null) return;" + "if (wby === '') per.unCharmThem(clv, 'You');" + "else per.charmThem(clv, wby);" + "ChangePersonLst(document);" + "}\r" + "function MoveThem() {" + "var mto = document.getElementById('moveto').value;" + "var ps = document.getElementById('uid').innerHTML;" + "var per = findPerson(ps);" + "if (per === null) return;" + "per.moveThem(parseInt(mto, 10));" +
		"ChangePersonLst(document);" + "}\r" + "function HealThem() {" + "var hl = document.getElementById('heal').value;" + "var ps = document.getElementById('uid').innerHTML;" + "var per = findPerson(ps);" + "if (per === null) return;" + "per.health = parseInt(hl, 10);" + "ChangePersonLst(document);" + "}\r" + "\x3c/script>" + "</div>");
	addOptionLink(md, "return to the game", "DoReturn()");
	writePageFooter(md);
	ChangePersonLst(document)
}

function writeItemDetails() {
	var md = WritePlaceHeader(true);
	var i;
	var cw;
	if (gameState.nRightBarState == 2) cw = gameState.nLeftBarState == 2 ? "100vw - 45px" : "91vw - 20px";
	else if (gameState.nRightBarState == 1) cw = gameState.nLeftBarState == 2 ? "100vw - 45px" : "91vw - 20px";
	else if (gameState.nRightBarState > 2) cw = gameState.nLeftBarState == 2 ? "100vw - 45px" : "91vw - 20px";
	md.write('<script type="text/javascript">' + "function AddItem() {" + "var sItem = document.getElementById('itemNo').value;" + "if (sItem !== '') {" + "if (sItem.toLowerCase().split(' ').join('') == 'shieldedcharm') learnSpell('Shielded Charm');" +
		"else {" + "var no;" + "if (parseInt(sItem, 10) > 0) no = parseInt(sItem, 10);" + "else no = getItemNo(sItem);" + "if (perYourBody.FindItem(no) === 0) {" + "if (no > 9 && no < 21) learnSpell(no);" + "else perYourBody.PutItem(no, true);" + "}" + "}" + "writeItemDetails()" + "}" + "}" + "function MoveItem(idx) {" + "var sItem = document.getElementById('itemNo' + idx).value;" + "if (sItem !== '') {" + "if (idx >= 0 && idx < T.length) T[idx].place = parseInt(sItem, 10);" + "writeItemDetails()" + "}" + "}" + "\x3c/script>" + '<div style="width:100%;width:calc(' +
		cw + ')">' + '<table style="width:100%;padding:2px;border-collapse:collapse;border-spacing:0;border-width:0"><tr style="width:100%"><td class="inventbar" style="vertical-align:top;width:100%"><p style="font-size:x-large"><b>Items in the Game</b></p></td></tr></table>' + '<p style="font-size:medium">These are the details for all items in the game.</p>' + "<p><b>Your Possessions</b></p>" + '<table style="width:98%;background-color:lightcyan;color:black;text-align:left">');
	if (perYou.NoItems > 0)
		for (i = 1; i <= perYou.NoItems; i++) {
			md.write('<tr><td style="width:25%;vertical-align:top"><b>' +
				getItemName(perYou.Items[i]) + "</b></td>");
			if (perYou.Items[i] >= 10 && perYou.Items[i] <= 20) md.write("<td colspan=2>a spell</td>");
			else md.write('<td style="width:15%"><a class="black" href="" onclick="perYou.RemoveItemSL(' + i + ');writeItemDetails();return false">destroy</a></td>' + '<td style="width:65%"><a href="" class="black" onclick="perYou.DropItem(' + perYou.Items[i] + ');writeItemDetails();return false">drop</a></td>' + "</tr>")
		}
	md.write("</tr><tr><td colspan=3>&nbsp;</td></tr>" + "<tr><td colspan=3><b>Add an <a href=''class='black' onclick='AddItem();return false'>item</a></b> <input type='text' id='itemNo' size='20' value=''></td>" +
		"</table>" + "<p><b>Items around in the game</b></p>" + '<table style="width:98%;background-color:lightcyan;color:black;text-align:left">');
	for (i = 0; i < T.length; i++) md.write('<tr><td style="width:25%;vertical-align:top"><b>' + getItemName(T[i].item) + "</b></td>" + '<td style="width:15%">Location: ' + T[i].place + "</td>" + '<td style="width:65%"><a class="black" href="" onclick="removeItemSL(' + i + ');writeItemDetails();return false">destroy</a> <input type="text" id="itemNo' + i + '" size="10" value=""> <a class="black" href="" onclick="MoveItem(' +
		i + ');return false">move</a></td>' + "</tr>");
	md.write("</table><p><b>Valid items in the game</b></p><p>");
	var itemlist = Object.getOwnPropertyNames(oBaseItems);
	var itm;
	for (i = 0; i < itemlist.length; i++) {
		itm = oBaseItems[itemlist[i]];
		if (itm.name === undefined) continue;
		var num = parseInt(itemlist[i], 10);
		md.write("<b>" + getItemName(num) + "</b> (" + num + ")");
		if (i != itemlist.length - 1) md.write(", ")
	}
	md.write("</p></div>");
	addOptionLink(md, "return to the game", "DoReturn()");
	writePageFooter(md)
}

function writePlaceDetails() {
	var md = WritePlaceHeader(true);
	var i;
	var cw;
	if (gameState.nRightBarState == 2) cw = gameState.nLeftBarState == 2 ? "100vw - 45px" : "91vw - 20px";
	else if (gameState.nRightBarState == 1) cw = gameState.nLeftBarState == 2 ? "100vw - 45px" : "91vw - 20px";
	else if (gameState.nRightBarState > 2) cw = gameState.nLeftBarState == 2 ? "100vw - 45px" : "91vw - 20px";
	md.write('<script type="text/javascript">' + "function SetFlag(ps,idx) {" + "var sItem = document.getElementById('placeNo' + idx).value;" + "if (sItem !== '') {" +
		"setPlaceFlag(ps, parseInt(sItem, 10), !checkPlaceFlag(ps, parseInt(sItem, 10)));" + "writePlaceDetails()" + "}" + "}" + "\x3c/script>" + '<div style="width:100%;width:calc(' + cw + ')">' + '<table style="width:100%;padding:2px;border-collapse:collapse;border-spacing:0;border-width:0"><tr style="width:100%"><td class="inventbar" style="vertical-align:top;width:100%"><p style="font-size:x-large"><b>Places in the Game</b></p></td></tr></table>' + '<p style="font-size:medium">These are the details for all defined places in the game.</p>' +
		'<table style="width:98%;background-color:lightcyan;color:black;text-align:left">');
	for (i = 1; i <= arPlaces.length; i++) {
		var j;
		var s = dec2bin(arPlaces[i]);
		if (s.length < 32) {
			j = s.length;
			for (var z = j; z < 32; z++) s = "0" + s
		}
		var nm = getPlaceNameIdx(i);
		if (nm !== "") md.write('<tr><td style="width:35%;vertical-align:top"><b>' + nm + "</b> " + (isPlaceKnown(nm) ? "(known)" : "(unknown)") + "</td>" + '<td style="width:35%;vertical-align:top"><b>Flags:</b> ' + s + "</td>" + '<td style="width:30%"><input type="text" id="placeNo' + i + '" size="10" value=""> <a class="black" href="" onclick="SetFlag(\'' +
			nm.split(" ").join("").split("Glenvale").join("").split("Place").join("Pl").split("Drive").join("Dr").split("Road").join("Rd").split("Home").join("House").split(".").join("").split("'").join("").split("&rsquo;").join("").trim() + "'," + i + ');return false">set flag</a></td>' + "</tr>")
	}
	md.write("</table></div>");
	addOptionLink(md, "return to the game", "DoReturn()");
	writePageFooter(md)
}
var sComment = "";
var bChat;
var bChatLeft;

function Converse(s, nRequest) {
	checkInvisible();
	if (nRequest > 0) WriteCommentsHeader();
	else ClearComments();
	bChat = true;
	bChatLeft = true;
	var ret = true;
	var perC = findPerson(s);
	if (perC !== null && perC.Replies !== undefined) {
		per = perC;
		if (nRequest > 0) addComments('<p style="margin-top: 0em; margin-bottom: 0.5em;font-size:large"><b>' + per.getPersonName() + "</b></p>");
		ret = per.Replies(Math.abs(nRequest))
	} else switch (s.toLowerCase()) {
		case "libraryresearch":
			ret = RepliesLibraryResearch(Math.abs(nRequest));
			break;
		case "misc":
			ret =
				RepliesMisc(Math.abs(nRequest));
			break;
		case "trial":
			ret = RepliesTrial(Math.abs(nRequest));
			break
	}
	if (nRequest > 0) WriteCommentsFooter(bChat, bChatLeft);
	if (ret) dispPlace()
}

function isCommentsShown() {
	return sComment !== ""
}

function setComments(s, click) {
	var cdiv = document.getElementById("commentdiv");
	if (cdiv) {
		cdiv.innerHTML = "";
		if (click === false) cdiv.onclick = undefined
	}
	sComment = s
}

function setCommentsNoClick(s) {
	setComments(s, false)
}

function addComments(s) {
	sComment += s
}

function resetComments(s) {
	sComment = s
}

function ClearComments(nt) {
	if (nt !== true) sComment = "";
	var cdiv = document.getElementById("commentdiv");
	if (cdiv) {
		cdiv.style.display = "none";
		cdiv.innerHTML = ""
	}
	bPopupShown = false
}

function WriteCommentsHeader(click) {
	setComments('<span onclick="ClearComments()" class="zoom-icon" style="color:black;top:0.6em;right:6%;font-size:1.5em">&#215;</span><div class="conversebubble">', click)
}

function WriteCommentsFooter(chat, left) {
	if (bPopupShown || sComment === "") {
		ClearComments();
		return
	}
	bPopupShown = true;
	bChat = chat;
	bChatLeft = left;
	var md = document;
	var cdiv = md.getElementById("commentdiv");
	if (!cdiv) return;
	if (bChat === true)
		if (bChatLeft !== false) cdiv.style.backgroundImage = "url(" + getThemeFolder() + "speechgrey.png)";
		else cdiv.style.backgroundImage = "url(" + getThemeFolder() + "speechgrey-right.png)";
	else cdiv.style.backgroundImage = "url(" + getThemeFolder() + "bubblegrey.png)";
	if (sComment.indexOf("<b>") == -1) cdiv.innerHTML =
		"<br>" + sComment + "</div>";
	else cdiv.innerHTML = sComment + "</div>";
	cdiv.style.display = "block"
}

function WriteComments(sText, by, click) {
	WriteCommentsHeader(click);
	if (by !== undefined && by !== "") addComments('<p style="margin-top: 0em; margin-bottom: 0.5em;font-size:large;cursor: pointer;"><b>' + GetPersonName(by) + "</b></p>" + sText);
	else addComments(sText);
	WriteCommentsFooter(bChat, bChatLeft)
}

function alterComments(top, mxheight, click) {
	var cdiv = document.getElementById("commentdiv");
	if (!cdiv) return;
	if (!gameState.bCommentLL) cdiv.style.top = top;
	if (mxheight !== undefined) cdiv.style.maxHeight = mxheight;
	if (click !== undefined) cdiv.onclick = click
}

function Reply(txt, ps, js, par, rf) {
	bChatLeft = js !== undefined ? js.indexOf("bChatLeft=false") == -1 : true;
	if (ps !== undefined) txt = '<p style="margin-top: 0em; margin-bottom: 0.5em;font-size:large"><b>' + GetPersonName(ps) + "</b></p>" + txt;
	if (txt !== undefined && txt !== "")
		if (txt.indexOf("conversebubble") == -1) {
			WriteCommentsHeader();
			addComments(txt)
		} else setComments(txt);
	if (js !== undefined) eval(js);
	WriteCommentsFooter(ps !== undefined && ps !== "", bChatLeft);
	passTime(true);
	if (rf === false) return;
	dispPlace(undefined, par)
}

function startAlternatives(doc, txt) {
	gameState.bAltStarted = true;
	if (!doc) doc = mdCache;
	if (!txt) txt = "Choose <b>one</b> of the following";
	doc.write('<fieldset class="gblock alternatives" style="border:1px solid red;padding-bottom:1em;margin-top:1em;margin-bottom:-0.7em"><legend>' + txt + '</legend><div style="margin-top:-1.2em">')
}

function endAlternatives(doc) {
	gameState.bAltStarted = false;
	if (!doc) doc = mdCache;
	doc.write("</div></fieldset>")
}

function addTextForQuestions(doc, txt, alg) {
	if (!doc) doc = mdCache;
	if (!alg) alg = "left";
	doc.write('<p class="gblock" style="padding-top:1em;padding-bottom:0;margin-bottom:-0.7em;margin-top:0px;text-align:' + alg + ';">' + txt + "</p>")
}

function startQuestionsOnly(txt, clr, doc) {
	if (!doc) doc = mdCache;
	if (txt === undefined) txt = "Do you want to:";
	if (clr !== "" && clr !== undefined) clr = clr == "clear" ? "clear:both" : "color:" + clr + ";";
	else clr = "";
	doc.write('<p class="gblock" style="clear:both;padding-top:0;padding-bottom:0;margin-bottom:-6px;margin-top:-4px;font-size: medium;' + clr + '"><b>' + txt + "</b></p>")
}

function startQuestionsText(doc) {
	var bHex = isPlaceEnscribed(Place);
	if (Place != 43 && bHex && (perDavy.checkFlag(9) || isSpellKnown("Teleport")) && sType === "") {
		doc.write('<p><img draggable="false" style="float:left;height:1.5em" src="' + getThemeFolder() + (isPlaceAttuned(Place) ? "symbol2" : "symbol1") + '.png" alt="Hexagram" title="Hexagram"> ');
		if (Place == 53) doc.write("You see a symbol embossed into the base of the statue.</p>");
		else if (Place == 26 || Place == 141) doc.write("You see a symbol chiseled into one of the stones.</p>");
		else doc.write("You see a symbol carved into a tree nearby.</p>")
	}
	if (sPossess == "cast") doc.write('<p style="text-align:center;color:#FF0000"><b>Possession Spell Cast</b></p>');
	if (sType !== "") return;
	var p;
	for (var i = 0, ie = arPeople.length; i < ie; i++) {
		p = arPeople[i];
		p.showPersonTextHere(doc)
	}
}
var bQuestionsShown;

function startQuestions(txt, clr, doc) {
	if (bQuestionsShown) return;
	bQuestionsShown = true;
	if (!doc) doc = mdCache;
	startQuestionsText(doc);
	startQuestionsOnly(txt, clr, doc);
	var p;
	for (var i = 0, ie = arPeople.length; i < ie; i++) {
		p = arPeople[i];
		p.showPersonChat(true, doc)
	}
}

function addQuestionR(doc, lnk, txt, ps, js, par, rf, pclass) {
	if (pclass === undefined) pclass = "chatblock";
	var sc = "Reply('" + txt.split('"').join("&quot;").split("'").join("&rsquo;") + "',";
	if (ps !== undefined && ps !== "") sc += "'" + ps + "'";
	else sc += "undefined";
	sc += ",'" + js + "'";
	if (par !== undefined) sc += ",'" + par + "'";
	if (rf !== undefined) {
		if (par === undefined) sc += ",undefined";
		if (rf !== undefined) sc += ",'" + rf + "'"
	}
	return addOptionLink(doc, lnk, sc + ");", pclass)
}

function addQuestionRO(doc, lnk, txt, ps, js, par, rf) {
	return addQuestionR(doc, lnk, txt, ps, js, par, rf, "optionblock")
}

function addQuestionC(doc, lnk, per, chc, pclass) {
	if (pclass === undefined) pclass = "chatblock";
	return addOptionLink(doc, lnk, "Converse('" + per + "'," + chc + ")", pclass)
}

function addQuestionCO(doc, lnk, per, chc) {
	return addQuestionC(doc, lnk, per, chc, "optionblock")
}

function addOptionLink(doc, lnk, js, pclass, sty, id) {
	if (pclass === undefined)
		if (lnk.indexOf("walk ") != -1 || lnk.indexOf("exit ") != -1 || lnk.indexOf("return ") != -1 || lnk.indexOf("leave ") != -1 || lnk.indexOf("visit ") != -1 || lnk.indexOf("follow ") != -1) pclass = "moveblock";
		else if (lnk.indexOf("order ") != -1 || lnk.indexOf("ask ") != -1 || lnk.indexOf("'talk' ") != -1 || lnk.indexOf("talk ") != -1 || lnk.indexOf("tell ") != -1 || lnk.indexOf('"') != -1) pclass = "chatblock";
	else pclass = "optionblock";
	if (pclass == "moveblock") lnk = "<img draggable='false' src='UI/walk.png' style='height:10px;height:0.8em' alt='walk'> " +
		lnk;
	var st = "";
	if (gameState.bAltStarted) sty = sty !== undefined ? sty + ";width:95%" : "width:95%";
	if (sty !== undefined) st = " style='" + sty + "'";
	if (id !== undefined) st += " id='" + id + "'";
	if (doc === "ss") return "<p class='gblock " + pclass + "'" + st + " onClick='ClearComments();" + js + "'>" + lnk + "</p>";
	st = "<p class='gblock " + pclass + "'" + st + ' onClick="ClearComments();' + js + '">' + lnk + "</p>";
	if (doc == "comments") addComments(st);
	else if (doc && doc != "string") doc.write(st);
	return st
}

function addOptionLinkC(doc, lnk, js) {
	return addOptionLink(doc, lnk, js, "chatblock")
}

function addPopupLink(doc, lnk, title, body, blk, onclose, noclick, pclass, psty) {
	var st = addOptionLink(doc, lnk, "showPopupWindowNow" + gameState.nUId + "();", pclass);
	return st + addPopupWindow(doc, title, body, onclose, psty, blk, noclick)
}

function addPopupLinkC(doc, lnk, title, body, blk, onclose, noclick, psty) {
	return addPopupLink(doc, lnk, title, body, blk, onclose, noclick, "chatblock", psty)
}

function RepliesMisc(nR) {
	if (nR == 11300) {
		bChat = false;
		setPlaceFlag("Museum", 3, false);
		moveItem(29, 276);
		Place = 276;
		addComments("<p><b>Museum</b></p>You open the safe.")
	} else if (nR == 63) {
		bChat = false;
		PlaceI(37, 63);
		addComments("<p><b>Kite in a Tree</b></p>You pull on the string causing the kite and small branch to fall. Unfortunately the kite is wrecked, beyond repair.")
	}
	if (nR == 182) {
		findPerson("MsTitus");
		per.other = 3;
		bChat = false;
		passTime(false, true);
		passTime(false, true);
		passTime(false, true);
		addComments('<img src="UI/books/thothbook.jpg" style="width:15%;float:right;margin-left:5px;margin-bottom:1em" alt="Book of Thoth">You spend a while checking novels, not because you believe the book is a fiction, but in case there are references to it that may give you some clues.</p><p>You realise quickly that you could spend days running through books or stories influenced by this, say the infamous Necronomicon, the Book of Thoth, and many other books of power in fiction.</p><p>The only consistent thing you see before giving up is that these books are always written in a cipher of some sort and that all the books you looked at had been checked out by two people, recently <b>Davy Robbins</b>, and in the more distant past <b>Sarah Gates</b>.');
		if (!perYou.isQuestComplete(1)) addComments('</p><p>During your search you hear Ms. Titus take a phone call, it is just so quiet in the library. You hear her say something like "...see you when you get back Mrs Clutz...", but shortly after she returns to reading her book with a sigh.')
	} else if (nR == 13206) {
		bChat = false;
		addComments("<p><b>Ghost in the Alley</b></p><p>The ghost almost seems to smile at you, then turns and walks <i>through</i> the painting and into the wall.</p>");
		if (!isSpellKnown("Pass")) addComments("<p>You check the wall and it is completely solid, you wonder how you might be also to follow the ghost. Maybe the book can help but you will have to <b>study</b> it more.</p>");
		movePerson("Kurndorf", 1E3)
	} else if (nR == 30300) {
		addComments("<p><b>Hiding the Heirloom</b></p><p>You very carefully slip off the necklace and hide it at the back of one of the drawers beneath the sink.</p>");
		perYourBody.DropItem(43)
	} else if (nR == 376) {
		bChat = false;
		addComments("<p><b>Stone in the Alley</b></p>");
		if (perYourBody.NoItems < perYourBody.MaxItems) {
			if (checkPlaceFlag("Alley", 6)) {
				perYourBody.PutItem(5);
				setPlaceFlag("Alley", 6, false)
			}
			usingItem(5, "You reach down and pick up the stone...  Score!")
		} else addComments("<p>You reach to pick up the stone, but realize you don't have room in your bag for it.</p>")
	} else if (nR ==
		1506) {
		bChat = false;
		addComments("<p><b>Gina's Bathroom</b></p>");
		if (perYourBody.NoItems < perYourBody.MaxItems) {
			if (checkPlaceFlag("GinasHouse", 6)) {
				perYourBody.PutItem(6);
				setPlaceFlag("GinasHouse", 6, false)
			}
			usingItem(6, "You reach down and pick up the stone...  Score!")
		} else addComments("<p>You reach to pick up the stone, but realize you don't have room for it in your bag.</p>")
	} else if (nR == 1891) {
		bChat = false;
		addComments("<p><b>Stone in the Attic</b></p>");
		if (perYourBody.NoItems < perYourBody.MaxItems) {
			if (!perYou.checkFlag(4)) {
				perYourBody.PutItem(6);
				perYou.setFlag(4)
			}
			usingItem(6, "You reach down and pick up the stone...  Score!")
		} else addComments("<p>You reach to pick up the stone, but realize you don't have room in your bag for it.</p>")
	}
	return true
}

function addWatchTVLink(md, lnk, title, body, img, js) {
	js = js ? js + ";" : "";
	var s;
	if (img.indexOf(".mp4") != -1) s = '<video width="99%" autoplay style="display:block;position:relative;height:60vh;max-width:99%;border-width:0;border-style:none;top:0.5em;right:0;margin-left:auto;margin-right:auto;padding:0"><source src="Images/' + img + '" type="video/mp4"></video>';
	else s = '<img style="display:block;position:relative;height:60vh;max-width:99%;border-width:0;border-style:none;top:0.5em;right:0;margin-left:auto;margin-right:auto;padding:0" src="Images/' +
		img + '" alt="' + img + '">';
	addPopupLink(md, lnk, title, '<table style="width:100%;height:80vh"><tr style="vertical-align:top"><td style="width:30%;padding-right:8px">' + body + '</td><td style="width:70%">' + s + '<img style="border:none;position:absolute;width:70%;border-width:0;border-style:none;top:2em;right:0;margin:0px 0px 0px 0px;padding:0" src="UI/tv.png" alt="TV"></td></tr></table>', true, js + "WaitHere(3)")
}

function mainCache() {
	this.getDocHead = function() {
		return '<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0">'
	};
	this.sPage = "";
	this.clear = function() {
		this.sPage = ""
	};
	this.write = function(s) {
		this.sPage += s
	};
	this.open = function() {
		this.sPage = ""
	};
	this.close = function() {
		var md = document;
		md.close();
		this.updateElement(md.body, this.sPage);
		this.sPage = ""
	};
	this.updateElement = function(el, s) {
		var so = "";
		var scr = "";
		var i = s.indexOf("<script");
		while (i !=
			-1) {
			if (i > 0) {
				so += s.substr(0, i);
				s = s.substr(i)
			}
			if (s.indexOf(">") != -1) {
				s = s.substr(s.indexOf(">") + 1);
				var i2 = s.indexOf("\x3c/script>");
				if (scr !== "" && scr.substr(-1, 1) != ";") scr += ";";
				if (i2 != -1) {
					scr += s.substr(0, i2);
					s = s.substr(i2 + 9)
				} else {
					scr += s;
					s = ""
				}
			}
			i = s.indexOf("<script")
		}
		if (s !== "") so += s;
		el.innerHTML = so;
		if (scr !== "") setTimeout(function() {
			mdCache.addScript(el, scr)
		}, 100)
	};
	this.addScript = function(el, scr) {
		var script = document.createElement("script");
		script.type = "text/javascript";
		try {
			script.appendChild(document.createTextNode(scr));
			el.appendChild(script)
		} catch (e) {
			script.text = scr;
			el.appendChild(script)
		}
	}
}
var mdCache = new mainCache;

function GameStatus() {
	this.pclr = "";
	this.nUId = 0;
	this.bCheatShown = false;
	this.bAltStarted = false;
	this.nWidth = 0;
	this.bRightCol = false;
	this.sLeftColSize = "";
	this.sRightColSize = "";
	this.bPeopleCol = false;
	this.bSleepLink = false;
	this.nCurrentQS = 0;
	this.plcTitle = "";
	this.nLastOut = 0;
	this.startPlace = function() {
		this.nWidth = getWidth(document);
		this.plcTitle = "";
		this.pclr = "";
		this.nUId = 0;
		this.bAltStarted = false;
		if (isOutside()) this.nLastOut = Place;
		this.sRightColSize = "";
		this.sLeftColSize = "";
		this.bRightCol = false;
		this.bPeopleCol =
			false;
		this.bSleepLink = false;
		this.bExplicitNow = undefined
	};
	this.bSidebarsHidden = false;
	this.bSidebarsHiddenLB = true;
	this.nLeftBarState = 2;
	this.getLeftBarWidth = function() {
		if (this.bSidebarsHidden) return "0px";
		if (this.nLeftBarState == 2) return "25px";
		if (this.nWidth < 800) return "90px";
		return "8%"
	};
	this.nRightBarState = 2;
	this.getRightBarWidth = function() {
		if (this.bSidebarsHidden || this.nRightBarState === 0 || gameState.nRightBarState < 3 && gameState.bInventoryPopup) return "0px";
		if (this.nRightBarState == 2) return "25px";
		else if (this.nRightBarState ==
			1) {
			if (this.nWidth < 800) return "120px";
			return "15%"
		} else if (this.nWidth < 800) return "240px";
		else if (this.nRightBarState > 2) return !this.bPhoneLandscape && (this.sPhoneState == "type=notes" || this.sPhoneState == "type=photos" || this.sPhoneState == "type=map") ? "50%" : "25%";
		return "4px"
	};
	this.sUnDo = "";
	this.bExplicit = true;
	this.bExplicitNow = true;
	this.nExplicitRatio = .8;
	this.bAllPlaces = false;
	this.bPuzzles = true;
	this.bUseRuneMatching = true;
	this.bAllowUndo = false;
	this.bCommentLL = false;
	this.bUseIcons = false;
	this.bInventoryPopup = false;
	this.nMaxPhotos = 5;
	this.sPhoneState = "";
	this.bPhoneLandscape = true;
	this.bLBNoShow = false;
	this.nMaxThemes = 2
}
var nTheme = 0;

function getThemeFolder() {
	return "UI/themes/theme" + nTheme + "/"
}

function getThemeFolderI(nt) {
	return "UI/themes/theme" + nt + "/"
}

function toggleTheme() {
	nTheme++;
	if (nTheme > gameState.nMaxThemes) nTheme = 0;
	updateCSS();
	dispPlace()
}

function addImageString(img, widh, alg, imgbig, title, per, ph) {
	if (img.indexOf("UI/") == -1 && img.indexOf("Images/") == -1) img = "Images/" + img;
	if (!imgbig) imgbig = img;
	else if (imgbig.indexOf("UI/") == -1) imgbig = "Images/" + imgbig;
	if (!ph) ph = "";
	if (!alg) alg = gameState.sRightColSize !== "" ? "right;margin: 0px 0px 4px 4px" : "left;margin: 0px 4px 4px 0px";
	else if (alg == "right") alg = "right;margin: 0px 0px 4px 4px";
	else if (alg == "left") alg = "left;margin: 0px 4px 4px 0px";
	if (sCurrency === "\u00a3") {
		img = img.split("Setting/").join("UK/");
		imgbig = imgbig.split("Setting/").join("UK/")
	} else {
		img = img.split("Setting/").join("US/");
		imgbig = imgbig.split("Setting/").join("US/")
	}
	if (!widh) widh = gameState.sRightColSize !== "" ? "width:100%" : "width:95%";
	else if (widh.indexOf("height:") == -1) widh = isScreenSmall() ? "width:100%" : "width:" + (widh == "50vw" ? "45vw" : widh);
	else if (widh === "height:max%") widh = widh = isScreenSmall() ? "width:100%" : "height:99%;max-width:50%;max-height:100%;width:auto";
	else if (widh === "height:max") widh = widh = isScreenSmall() ? "width:100%" : "height:95%;height:calc(100vh - 12px); height: -moz-calc(100vh - 12px); height: -webkit-calc(100vh - 12px)";
	var widi = widh.indexOf("height:") == -1 ? "width:100%" : "height:100%";
	var st;
	if (alg == "center") st = '<div style="text-align:center">';
	else st = '<div style="text-align:left;float:' + alg + ";display:inline-block;position:relative;" + widh + '">';
	st += '<a draggable="false" style="height:100%;display:inline-block;position:relative;' + (alg == "center" ? widh : "width:100%") + '" href="' + imgbig + '" rel="lightbox">' + '<span class="zoom-icon" style="left:6px"><img draggable="false" src="data:image/png;base64,' + (img == imgbig ? "iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAEr0lEQVRIx62UbWjVZRiHr+f/dvZ69uLEuemaTufcNE0UmjNpWlkqEUJRCyVFDK2IWFBEnyQUsQ8R5ScLSTRtqDNkKZZrNJXNqWs6X6ZN287ZznGbm2c7b/+3pw9OGOQZlv7g/nhfF/fN89yCR48KrBZCVE0tKCjPm5yXJ6WUfr+/2+frbgT2Ar8Ckv+RuampaS1r39kof2s4Lbv8ARnoG5DBvgHp670jT55qkG++vU56PJ7fgeljG8UjwJdPm1Fc+9XX36bNnVNKZ3cv530DjNguABmGysKpEynMn0RzywU++mBLv9/XtQK48CiCWU9NK2reu/+gN+bAyb8CzCstZunMfLKSDQD6wnEaOrq4fr2TlSVTiEVGWFv1RiDY2/MMEBhXoBvGqX0HD1c6SelcMTXWPFuGpqoIMbZNIl1J3HY4dPpPyrMMAl2dvLth7QEp5VvKOPzy1a++VpmRnUPLsMuishn0RC38o9UTu1/+qI0vahGM25TPK6E+MMLMWbNZ+nzl60DReBN898OBQxuuxjRyy+aQnOxB1zU0VUGIB7sVSCSuBMdxsCyb4ZEY4Y6rZIwE+HDLpu1aIvrUgqdWZOfkMhCIYJgOyZqDB4HquKhC8GBLUoIjJZYrGYxY9A5FGIpI1heXkpae/nIiQXpe/pT8weFh7ulekkwHy3BJEi66ItBG6abrEnVcRiyHobhDKGoyOBwnYqtE4yb5UwpKEgnSVE0nalqM2C7Jpo1iu0jhYCoCMboaAFeCrih4DVBcDcfQsAwD0zTRDSM5kWA4EongURWsqIXjSgSgqwpJqoKuCNTRKRwpMV1JzHYQjkNMVYgLF0VRiITD4USCEV/X312KohbkuFE8SFIU8OoqKZqKRxGoyn2B7UpM1yUMWELgQZKvSyLRGH5f15WEz7S/L1h3+VIbc1MEwrLRXZcUAZm6QpZHI9sYLY+GV1NJEhLdcRCWTWmSpKXpLPFYrC6RQAC+X34+RK7ikBa5hxuzUGwbD5CuCjJ1hQxdIVURGNJFWDZO3GRCbIgMaXHi2JEosFtLAN9ZUflSddn8hcTiJgvSdTqGBjCTNBxdRVEF+v0/TNyysWMmZiSOHrrLLMOm5scaOm9c2wH4tIfBn3thVfWmze9TkDeJvNyJ1NWfZYbXwQkpxGQmnqQcUoWClGC5LrHBIbIiITKtELVHa6k7vP8o8AWA9i/4i6uq12/czOyZhWRneLly4xaX2y7SdrGFFavXUFxUSO9wP+H0NKSEUCiEHoly+doNThytka3Njd8D7wHOWIEAdi5ZvrJ6/cbNPF1SRG5ONsH+QXqC/Zw720hr0x+7WpsaF08vmTM/v2A6ad5MpIThe3fx3b7JrY72M5ZpbgVOPGznXy5aslx+s6dGNl1sl909QXm+7Zrc89MxWbHsFQlsG3vCgXXAp8AnQBVQON5V3la6YLH8fMcuWXu8QbZf75TNre2J4P85mjdr4seLKpaRlelFUQQ3b3fjC/Sxb89uztQf3w589liCSDh0yXWdBaZlc/NWF4P3QtTV1nD+TP1jwwFU13Ha7/T6qjImTNaC/Xc5eewIbecanwh8bCo0w3PBm5VjAlufJPgf1fU7s1g5rIEAAAAASUVORK5CYII=" :
			"iVBORw0KGgoAAAANSUhEUgAAAQAAAAEACAYAAABccqhmAAAOC0lEQVR42u3diZMVxR3A8f3P3qHTs4m86e6NYjzwSCkGo6JGrWCMmqgBFBUjKkYQNJpIlKAo0USDCOWVildEYwykgieKCSDocsiaX78VcA+Wt8v0vDfz+36qXi1VQNfOm/719PHrnr4+AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJiaRuqmN4ybKT8vb6T+evk5T37+XH7OaST+Evm7WbXUnl03rel8W0AJNJPW9+pp6+qGsStqafZmI8m21RK7VwL766l93Dgfv71h/N9riV9ZT/1c+fPZfPNAwST4zpNAX1RP/Hp5Yv/vCMH6dc7Bf7TPe6FhCL0I7hCQZ8Abf2N48uYYrHkH/7gfaRDeqqf27maancZdBCbzhE/8o43U7ioqWGOXV0uyA/J5Xa5tHncYGEWe8DdL0LzdC8FaSHmJ/aiW+ru581ArBIB0k3f2fLBGLi98B/JdLKVGoPpP+sTOka79m2UN1gLKey8sS1JTUBmyRHeiVOrHGmm2r2LBGrc8415omOxcahDK+bRP7U2yHv+himCNWZ7kNMiy563UKJQl8FeGWW+VwRqxPElsCt/pw9Qw9Or4fg3BWkx57SSo1GfUOvRA4PtnCdbulNdONjIDJ1MLUaiasU6Wrl4mWHujvFriNoZNTtRMxJ3R7/d+7DIewdo75dk3ZRfjKdRU5N/VN34dwVqW8rKXqLHIK/CXDc9AE1xlK69u3CpqMKYW+Kn/mYzzdxNcZS/P7qun7hZqNDqb4Ot3pw+npBJcVSpPGvOtHGKCiYN/xMw+wVXR8pgfwOjuvlsg4/yvCC4d5YV7zbAAw0/9xG8iuHSWV0vdlppxZBRqVE/9r6USDBEMlCeJRH8gIjQ99Y37gGCgvNG7DuuJnUF0VHus/xDBQHkT7zr0K4iUSs7w208IBsrrpLywZEjEVGas727pbKxPMFDeqG3Hqb+dCCr1DL99hWCgvGPdckwkla+7f9bRz9UnGCiv45ec7AnvTCSyShH87kEqL+XFKK9u/O+JsN5+8m+m8lJezPIkZ+DfRFpvdvkHqbyUV9B5A4MNk/2IyOuFtX3j7qDyUl5XzhtI/T1EYFeD32+g8h5zeUN8f1MvT7IH/0okdqPb33E6r9LKm/jP64nfUE/t4nqaXVlPsjMayQnHdfbdWieN64Vhl2QjcU9LYsxnBP8E5SX2YyKyqMSefntOe1mG4B+VvWb/G9JYYx560TD2LGlQHpCVlo8J/jFbjPfKcPQHRGjUrD6/iMo2MujlO7mza0Ow1M2Xp9/73I9vZw86XmMWp7L5Jwj+Q/vYn5N/M9BDvbLj5Pda1fl8QrWHEdIoryZi8xzvTzqlt5KVbahuen/fugxBloSDOJlA9K8Rubms8bst6oPf2BdLOFxbrT5pKHUfEcFTrUDGZjLG3aE5+MPsu6Sfnlbexnvg+MNHrulcPZDMwc8b6TSOHZvc06M1a+JupILgN25NhXpx9+peOsz21fodpw11NtmXXaX6MIrhE2tnV+6+mtapklOwS/HS4ZDc10uJ8Im7/QuUrytvlyAxFZ/Q/Y/uOR03j0gfL/gTt1R18CdWzYSRjIvfUL2Uaxx7CEZ2D7NHOINO29Ku26g6acjY3xH5fe288z9p7/YX+327afI7XC7r9Qvls1SeRvfJ0Os2aYQv7XSvQH6NgO6Xssi9eEz5k9+tUz7hd6CZuO8UsCZ/nvQynh+bqTf295Og3CnDsfuLWyE40huYlSwdGveUzid/mj2nfSOJZPb9NOZ33DT+YnnKb5vy75f49bHrQbPfn6R+y7Hxf1G2zm/VB3/s7L6QiprT9UoKsr8x8gTw/erPG0jcBi3d/g3qg1+SnOKN8X1/jG512IAUt14c7KnoPW8g9IoJfgUTQrFeTS3lWil/f8TrfS1i3ZjJYSPtnsAzFQ1++wzB3376D0acVd8T/XqNXxdv2BJOeeKkoSqlgQ8/mYxdTfAfmvW9I0rwTHgwR87Xa+ytkR4SV3DS0KGXkaysxpM/zVYQ/Ic/kbrP9xR5vbUkO9A002qR6ssg9eXQZ3nJZ/vdEm7miO7/PyLN+Bd/vZFmrWVpdBX1ZcSQa2FJn/z2eoJ/zLr/L/LPpzjSq9DiX2+keYBTqC9j/u+ckk34ZRcS/OMd1Z3/Tr/2abRdul7p4d1bbI9Gb8ZgePtVSSb8WtPDnnaCP/74XxJozuzy9UbZxyATmp9SX8Z89pckxXeiJBTVGz8+iPCkXN7t642UKfpngn/cHuSuXg/+Dwn+4pJopFv4evcPLHUzi5vX4PVkIVeih2f9O2259d1MGS+vjdfb6ub15n/CjeQDLCL4j7T6kvX27kH5hd8m+Mf9PB5nsqzL1xvhdJvQqFBfxtkrkNiNZZkH2Erwj9lMsz5CoHR/aTPCSoBsQ76L4B+9UciV6wWkR58MVHYzjdsYoQEY6oF34f0qwnU9RPCP2CW4s6TJQEfamaZxv3e2LcJkWdff0ivzPldEuK7nCP6D3f5sb4n3AQzM6OQYKi03M/9J12xtD7wI84T8k5v8TurL8J4L2RtxZqn3A7SPpeJmHnxDzPdzTree2+XrHYqbCai8vpjsor4qkBz46wj+cEP9bd1Pm80zPdU/n/8SYDgYhOAPb8jqqxLprt6p/bCHGNmA0l1+q1vX20zdDyMkN63VHvzhDVl9VSQTRsu1H/YQ4Yl5bleu1/htMeqIjHu/Uh38qb27r8qk4ixX/m64h/MfBth3i75eWf67OP+hYjZf95jf6nhlmDQCv9GaLhxeBpJ74PTb4wq+3iiHg8rvtEPvk98t6dNkco1AtcaEdeN/m//wyt1UTEaj3x0n+O0NaoM/cUv7NBr7Qgg9SUO1dOD43MfPxj0WNfjb5zxkJ8VpAMJZgPqCvxbpUJUy9QSWqDwfIPGbokyijWgEcg3+vQ3TOj3S5PB6pRN+i/vQfnnl7TpfDOmXxfk+3YKcu/0fNs20JM4DILtWaZLPAiJ/5ATQPI0ZYNL4XRDn+5yWSbd6Uw6z/cvi9f7swHC6q7p1/quJ+HGXgfxP9CWBZPuaSevEeEHWPqB1kmc0+P0yRFkRvdFP3HZlwT8k9+MSIn3iCjv78FNBS+XIBqUR8PEbWHeNBN3TjcR+NGo+Ys9wI2EfkGHJ2cXcZ/eZso09IcFpJhHe0epAdkYtcXuUjQm/bPT7aRrur+xv/1TVk9+EFY58N4L16agodoeqvQKyzBZ2T1a3d9c6VZa9vlB2ht82IvnYlrU+UJcxGOGcve7P72TX6ZvwyzYRwXk0Aol7Q1vGYM34f1ZnhSd7SdtSnyS5vUzk5lqJ7JPaMgbbmXfGzy/tUz/NrpTg361wnf8JIjbOzPFijWcMylzIJzFewBGvu986Ra5xs8rcftMiuy/uU8VfNPLdg6ryBv4l6aOze7eX5k6WntqrGrf0hsM75d5cSIQWVtn8dq0nx8hM+icSaPN7p1F2l4a9DWpP8kmyrURkdyYH31V/zFjqn5fhwaziG+Bw4rN98nBvTGfwS87KK0RiN3sCiVuj/Zixb2X0vSP59bfJ30+P0OPKZPg1VxqbVznq/WDw24eIwJ6YdHJXhZN2eDHpmM/28JIN+dwn+yyuCxOJMkE3vZlkrXraGnEeQdMMNBr9A9+VCcez5Pu8ur1NW9KG2xOQvOFpRHkhrTescBB5vTYkSP1nBD/lRQ1+SWNumswRbb3aG0j8C1ReyotSnnHriLBSrBCEAzGovJSXW3n7QyozkVW2hsD4bVReyjuW8mQO5H0iqdyrBE8TDJQ3pdOQjF1NBFWjJ3B5yNQiGCivwwNb90hW34+JnMrNDWRvEwyUd5TP34iUKq8SpPbmkXsJCAbK++ZYNOPmECFacgZC1hzBQHlhrC9Lx0SExt6A8b8MJ+ASDDrLk4fAF1U+gg2d9gZS/zLBpay8xD9Lzce35gbcbKkUnxNclT9cZUc3dk+iNL0B9yDBVcV3MYbj1Ryn9aDT3AG3keCqRnnSu1tLjcbkG4HUXqbtDTaVegV74jc1+72nJuMY5wf8PGkMBgmukpQnczmS73EFNRf5NgSJu39yB48QrEWW1743xi+hpiLy0MA/MvZYLIK1i+Xtl8BfRs1EsQ1B4h8lWLt6BuIeyeK7i5qIrpKKuEL76bjFvjvRfilP/IXUPPTaHMFS2XE4SLDGKs/uKvOr0qBmjsDODy+LIPhzK++9cFIxNQvl6hGYgZPDsdwE/1TKs/vCZCu1CNVoDFJ/e2fHlqsP/nek4byMGoOKNgTOyqThSpk03EvwH3rX4RcysfcgtQO65gqMmymfp4a7u9qCP9s9/Fq31gXUBNAYGHuOTHStagdGdY/dekd6QLfWjc2448BEDULqr5dG4cXJn1/YQ8Ev6/Uy9/HHpnE85YFj6yH4+WFbqzxFd/ZsLn7qtsjPx2VYcwN3DIjaQxiYEbrTMn/wZC21m2tJdqCw4A+77cI7GI1bXO/353M3gJ5pGFqnh62wdePnSgNxb824NTKMeKX9dG6/Kk2y6UYdhBpy6mWJcus3JyW/JF33Z+TfrZSGZZn8eaHMS1wrwX6+/B1jdwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKD6/g+r1BoMYwx5dAAAAABJRU5ErkJggg==") +
		'" width="24" height="24" alt="Zoom"></span>';
	var psh = 0;
	var tp = "24";
	if (per !== undefined && per !== "") {
		if (typeof per == "string") per = findPerson(per);
		per.visitThem();
		if (!per.shown) {
			if (per.isPersonInfo()) {
				per.infoid = gameState.nUId;
				gameState.nUId++;
				st += '<span onmouseover="gameState.bLBNoShow=true" onmouseout="gameState.bLBNoShow=false" onclick="showPopupWindowNow' + per.infoid + '()" class="zoom-icon" style="cursor:pointer;left:6px;top:' + tp + 'px"><img draggable="false" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQQAAAEECAMAAAD51ro4AAAABGdBTUEAALGPC/xhBQAAAwBQTFRFAAAABwcHDw8PHx8fKysrMzMzQ0NDT09PV1dXZ2dna2trd3d3xcXFxsbGx8fHyMjIycnJysrK19fX2NjY2dnZ2tra29vb3Nzc3d3d3t7e39/f4ODg4eHh4+Pj5OTk5eXl5+fn6Ojo6urq7Ozs7e3t7+/v8fHx////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAqvgvmAAAAQB0Uk5T////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AFP3ByUAAAAJcEhZcwAAEnIAABJyAV5lW+MAAAAZdEVYdFNvZnR3YXJlAHBhaW50Lm5ldCA0LjAuMTXdYP5PAAAQ/0lEQVR4Xu2dC1fbuhKFXdqetpwkEKDtpRQKCXD//y/s3SPJwW/NHj0Id7FXyyPYenyeGcmSLDd/q6pRKhxeSTWzO0HtTr9Cn31Np/RZ/n6KH07CSTVUB4JUH/r2yX9vms16tTp7+G9HD2er1XoT/tx8+ua/10FRHoID8O8/rk7NZrULlV7QbhVg/POvfC0PoiyEDoCz9WOoo1KP6zM5rwaIghCEgAewVlz+ae3Wcr4DUZBDKQhCwAPYh/qYtfcg8L8UhyIQWgLb36Eeyfq9LcmhAAQg+ILibu5DBTLpXqIlEi6AITeEYATbzAS87mEPJcwhL4RgBL9CoQvoVwlzyAnBI9g8hfIW0hPcIjOGfBA8gutQ1KK6zowhE4QQCopEgindZw0OeSCcNKcfmia5R8Bo3zQfTjNRyAEBZvCp2RYOBWM9bZFtFgzpEHwsqI5A9JQpNqRC8AiqOkJXcIoMGBIhIBg0zW0o0avotkEREikkQXDB4EcozavpR3JoSIDgPSGU5FWV6hN2CM4T7kIxXll3aT5hheA84SqU4Qh0leITRgjODMzjRSW0SzAGG4QTdFqPyAy8rlAoGwULBOcKvfHy49CD1SUMEJwrhHyPTEaX4CGIK1S5Ybbo2uQSLATnCq/WS45rb3EJEsIRu0Irg0twEI6yVRiKbyUoCMLgJmR1xLphKTAQhMFRdZDmtCMpEBCEwXPI5sj1zFFQQ3DNQsjjDYhqJLQQ3kCz0BfTSCghiCtchuTfiC71LqGD8AYZMBRUEITB95D0G9J3LQUNhDfKQE9BAeHNMlBTUEBAmH1z8aDVJQofqrGg+CHoIGRn8LxuV+l1tVmts3fGLjXdhSiEk8x9pFu3DAvya/Ne1C51bNZZJ3NQ/CiFGAQJCCG5dF3L8quX2vcKB4Nz8iy2+YZtFGEhAiEfg3vd0kzHIiz/zLTaIU5hGYIwyOGmt1Ip9drUDogcnhG/m1qEIAzS75335wSAVgcQ5+ljedE760UIaF+Sx1B+ojJfOACtBISc+p+QlFk3kYZy6Y8oROJY2jMaQjFrAwEv4YAENok+ebVchAUIyY3jExqD9CUU4IBEElcDLTeU8xBSG4Ynb8yJCEQeQ9qKoMWwMA8BfpQSky6ajzE/EFs/KHrkx+YiJG3RfikszP4F+SZ0WOCEkYEdqZdrBb2ikcMNbSWEqOuF9OcgJAWEm6gjBAvf+MdhHt3DT6pT7K3VQliYgZASEOIL63x9BoudfihPM4eG+bAwAwG2Z517/wnki3VBZWDZE33B+EI0YPjU/AyHs3pA6iGdgaY/RmZG93uOj/KKlc2kHp9BcwCNvYbZ3sIkBHtAuImagWMwa2UPCgrIwhgZcOZk4pMQQNt2y3ARrYNjsHAlFXNHkoKttdzNOMTUh1ZnQESMTnhEGCgpwCVM8XHGIaYgIAaHkyj9ibtCnIGgVFBAVn/C8ZRQtZBGVxOfIQvLGs0f8cI7R4sW/s+M0XYlMC2txN3kZRpnZ4yKinDg+Cq8+SJqUJ6CJTBMxsYxBFyHcAIj3fyn0tGmjbYv6wzxlJmNPsHFMqxbV4QDSJs2Oo+qxCwmO5X2CIIlKmrXRKjT1piCd4lwAqGJtIcfgC89uKleF9I0Z+GUiM50G4oo2pqx0DkfFnaYmcUQtAwAWNkH22n8ATLZwtgUBr+jnPRIipbB3+ZfdYlxaDhpWRYK+xHhfl6W5lHN4C9RYBwaTorIQmHUTPbzQvvBdkcnG95pNc0mnBTVRr3LkOG6PQ2bycFvH7bhQK00HZtWTbMKZ0W10m+1BA9me03bDwsQkB5pCD+m+h5zKgNBzJfsQeNOr3flennR/vVHHxAgdQupbiOdJCyQd1ODkNP9hW4aFDd8XRWJCZBQ4Cx40EB086L7CERQFDXNOpwY1ZqBAApscOz3FTo/wxC4FQFMUBQVgyBF54Ljfa/onbxYQ4jN9Y7UNOq2Z8tBkODIjTv2TOHlR9CkppzUdwwH4YRwblSDyBWVhAXqLqI3IfWSF2sIZECAgDmcGxXpaJI2GRa6ptD5SR+7RT/pckoWSlvDdQqnqAXCVG+h2/4cfkIiTDMz6npqpDa2nscqhQJxFXi5iIfMCIcV8c4AAbSqIzK+z1OIdYhO2Gl/QPmYfbJuLMVUm4LFEFwVmBbi10sV2tzUluplK6aUU9EV6TfiepnrcPiub8OhyEKoeanKaSQsiJmZs5e+SPiuu0QHWYsp+US7dmxH9EWcKbwYXKgMFxbtxZQYHnl24rul3fHSIO7oEBrbb0wnwdQ8BknXbrGzYHvuPYhrJg9dBf+N84bmo72YjsKCLaifW5rUCYoWElLo4A8eAnIOf1BoOC5DanH+TDebNy9cTcIUUG13VvjKtA3sHd5QKOjMWhPFOpeYTDVxX1Es/b66z+am4aDplVs5NhCTBkJ/N/k7IHf1IWZFXDhJLalQ/4JY3Fm69IBkIyv4VELKRIgPczz+CxMS0g1B5DFA5+v1ufshBwII6YSCKhSCgv+iH/cy3UJPChja51voR0IWhGT1z0eEUTz5gvP0o8xtRM0iB0KUB4ATY9bhdlVqxIQE7Xzx64m7pC4ouP8EO/ivy+qIhTgTChuXt2v3nwgJecJiUTGh0QcF/If9qNevTizzODqhPurFNt67AYEJCWXCouiVQqMLCvKPPSeLhIBvIEWukczFgb6q8k8/WWwd+BoJCFxfabN2QncxW2/JJa6+J3bT3w6COi4yM+YL8gj6+wQ8I0blwkBcVhcZHQT1e3nyhITp+6dMd1AiwsEfPQRclvBBXFlCggyrzCxsVS0Sj4sKCsiw+dt8U5+x9FidWsJg1vQes1DAdVXPLaP6AkE/cZM6nCISBiG5SWWhQAytoPo4nLgBRwFDLmbFGOShEM3kRa5hQixSrylLDwlxBlkoEEFhJVG6+aruNGfoMyPHaFP0iIPC4VYhKGh7zjsAEAjh16jIhUQTQuEUiwgyjNsQfR8SAuw05GGV8gYPh4UTrCKCAgshNSRorTTd74ig4CB81h+eXDTtnX6yKRA9QAAQhd9iek4OCY12I7vvGbLSTj84BOpuQnJcZC5PstGpI6PvKGiPZlaeT4px1NTwo19Rj2sLaY8GspCDUUzITm2I9AaOa0tAyFAwdeOd7Hp64B6CdgAig4lWhKB2PbcxnnrfkAzBSn2rlux6+iD84CCEX6JKLRcgFHnyZVpMvd4hvEMQvUOA3iFA7xCgdwjQOwToHQL0DgF6hwC9Q4AchIo3UPUgsDdQ2pJluJWuB4G9la44qFIRAjmoUm94rSYEcnit3kBrVQjcQGu1Ife6ELghd63zJE++1IVATb7Um4arCIGdhqs3IVsRgr6FrD01XxNCsan51MhYE4J+iiNAqLVcpx4EhARuuU69hVv1IBAhwS/cIuaFEoNCRQj6kOC6CRUXc1aEQC7mrListxoEhARyWS/Rr0gMCtUgECHB9QCRV7Wl/vUg6ENCWOqPsqnb1MSyVYOgz8j1fRwE9Slpj//UggAH5x//0RtPWlCoBYEKCeLg8o89x6pqENirin+wnjoPh1aCQPSZXx4OReHUkTFpwW0lCOrFw5C/J3T/CfNJeWC8FgTbA+NEUDBtkBdUBwK8wbJ1AHeaPTTWgcDYdWcTCZROHxQSHkupAgFX1LSdCAUvITRWgcCExdas/RciKMgNuNEUakCAIaiHR9qQ4CHgzBqbTdWAgMIZN5tC8WpsO1YFgnnbMS4omDegqwABNm3egA7nVtiKsDyEpK0IUT4inFg3pSwPAQWzb0rJ+YN1e9LiEGDQKduTcv5g7CsUh0D1EcYb1aKARFQ1bllcGgKuZNKWxSREmymUhmCuQ/sdFItvY14YAqqQuI05GRpNG9qXhZBhQ3vhyL0ZgG8my0Lgmsdel+8lL6qrYLqlLgoBFzH9JRdsWDE4REkImV53ApSlX3xTDoJsWKO/e4RmXnxDm4LhFUjFIKAoWV6BJKbA9BotL8MqBQFFz/QyLNoU2LBQDELG16IJT/2os4h+QV4ZCBIQmNZx8QV5bIfp//JViWIKHFH2pZlFIKAI5OvAF1+aWfz1qerpDWLdKB0Ucf+49PpUtuspIoKj/hkEAgIfFMebu/V/M6Qo/qWkQLiDet5Xs63fUKPrNsiLbiAgNQWivIPINSsLg/Gc8jAvuq8AaSmAcDgjKmWksTCYGBAa/o6Cqpd5tCJeuK8cuPml8wZhQN0xiCYW24wys5iC1hbUaY8v1pRMdjCV9ugDmALZ6ooQaxQYtBFHtRIEifFR3O1tN0p7TBztRziekW7faaUpaAxh8XVSCxo2j6LxJ5ZmErrQuASu3l04fkF3CkMQV2D7SKJR8yiaQK4r6Uiq3bdVZjZ1sQYSBgavneE7lZ06fvX1RxEYNGY2ebF6cuGAvGfymna0qc+QBzOTcxDuS6KBIZ72pYIkwgHbvXeamTmbNDxkol7j2pMiMCDtRQpXUWewhgNZvzqd9uSHxtgIxV9xF6lCFKNzBW488aA5R5umbnUI90B1xCWcMc8Y2k53Nt1L9JqdRp4xPWSl3WVkqJ8xY3DXctIYLlSnUnMsHT2gUiGdgWY+tvVIvRAfI+8tcZfzfGANO9w+L5sBECBhU0QUzTvaDARkaA0L0E0Mg69Os10Fc3tYbfGr5hxjNIBQobnU5yBIntSEVF9wv+hVxZXpSH5ZPgHWYwxUoqXHGWchSFigx1c6umg+RqvVU+zQj8Z20WuP6oTExpr/S0pYECE0RAxcK+8I9mAgmg8I0DwE5J0QFkRPcPR0DB7BNglBpCu+AEGyT3BC0fMm7uyLEj9AAhtjz6BVZKHZEgQJC/ZoHPTTe4WFgxCQU/XPL8woNn+++EcJC7abiK726ADQb4kVAO4Feucp0dlrtxgQoEUIjkKiJTrdSpXUIA4ADIO+E4qPAy9DcBRCWom6P5NKRUF0AJxxqyVmFWUQg5CRAnQt/cIAAuoVzdUe8gC2CR21geIMohBQuMSGcqDbtatrh0XQ4Q2a6xw+cNBy4+gVhSCX6DIkmE3P65Xby6Svzar/Cskcio9TQXEI0lBmp1BLl5HG0UtxiIQF5Vt7jk3fFQEBUkB4uxSUDFQQ3ioFLQMdBEfhzcWFSy0DJYS3SEHPQAsBFE5N85+vJsVE0EFaCKCQuddUViismoEegneJ7J2ZMiJX4BMQHIX0O+sKit47D8RAcBSSR1nK64ZkwEFwFBJH3MrrimVAQgCFo28kmGYhiIQACoi76SNexbSnmoUgFoJ3iXxDHpl1TbuCiIdwzC5hcAWRAYJ3CevMfUE9WFxBZIHgXeLoWgm+VWhlg+Bd4qg6TvFFLvMyQvAucUTGcGV1BZEVQjAGy6rPArpLMAPIDkGM4ctxNBOpk98JEIJPvPq4248UT3BKghB8IutkCavbNE9wSoQQfOLV+tFoE9I8wSkVQotBvQl4TsUXC+qUDiGEhsT1NAY9bZODQVAOCC40fKjsFPum+ZAcDILyQBBjQKeV3H8hQfcuu0wMckGAfGyocpN9nSkWtMoHocWwKRwcnjaZEeSF0GKg9u4i9QvJZ0aQG8IhOGyLRIf7bdZQcFBuCFAwh01mDveytiW7ETgVgHAwh2ar3wM4ot+y5KuEETgVgQC1HJp1cu9h75Z6FSMAlYIACQe/JG1tHoPaeQCy0K0UAaggBEg4tEsz1+TtxeNat/wzg8pCEHVAyCo9hVHs2vV9NQCIykMQORBN8w03PF6b9Wp11hu1fzhbrdaHxY2fvvnv5QGI6kDwEhSnXyF5YemMPsvfT/FDnep71YQA+ZrGFQ6vor9//wf+n/eZpwyw/AAAAABJRU5ErkJggg==" width="24" height="24" alt="Info"></span>';
				tp = "48";
				psh = 1
			}
			per.shown = true
		}
	}
	if (ph !== "") {
		if (ph != "none") {
			st += '<span onmouseover="gameState.bLBNoShow=true" onmouseout="gameState.bLBNoShow=false" onclick="setWallpaper(\'' + img + '\')" class="zoom-icon" style="cursor:pointer;left:6px;top:' + tp + 'px"><img draggable="false" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAABuBAMAAAAdXgYKAAAAG1BMVEUAAAD+/v/+/v77+/z9/f38/Pz6+vr6+vv9/f6gZmltAAAAAXRSTlMAQObYZgAAAkhJREFUeNrtmF1ugzAMxwNjax8BcQASpnaPU8UBYDzsddoJKk5Q9QSddvFByzfBcextmibyEImq+cf5JbYTC7G2ta1tbX+peSqR4SGw7lR8G/9AGn3trgoedXTdHSuBgm5AkKhK4J1hwCEQ4p5jgAzfhMMyIPEFz4BDKGTCkxCSBzESEc+AXAQ8iIEIeBArAR7ESoAHMfwZiGnlplsGxF1Wu7lLh3i6BZqCDLGNdFSIaSPgUiHGbbAtiBA7gZIIsRNwiBC7fOEQIXYCLhFi1grccSGeuRDz7rcXZQNx1woMzvaDlTtPT+K++pA27hxPDEiBHdG788QV6m3ZWMXE+ih4crwt0iompup1nMKFUPSY6EP3GEximTK1TSytbyhqYolAz0AklgwMkQiIRwGtwQxxL8AQaYb43McXGsSsvxKTIKaDO3VBgagGAi4eopzHt4Uwr4eY9Tll9C4okBDTPhiEI4ESCfFS/bf59EcCrkVMLMfnuGk4iKqfLJo8js74xOKOI/zyGhYTSzlypFYAAzEcbPrsgXdGQPT7ydKZgIOA2IIfXnaW16CBOEit/vyRaoa47ydTmlduboR46h7Ek3OsX8McYn/28lgjsDVBHIB3tC/1DwPEwayeVsAxQIyNtQIDRHO1AYYYIgRAiDGi3gFCzMwCGwhihCm5SABijBFwAYgnjMAGgIgrGwEQcQIARJwAADFDFb4AiClG4HMtQPxKAcIK4j8ohXk8AzJcoWO5i/U3YHz3HUVZ1hq4heVLE2YfaRJP9SXuCzR7PxspD0TSAAAAAElFTkSuQmCC" width="24" height="24" alt="Wallpaper"></span>';
			if (ph.indexOf("photo") != -1) st += '<span onmouseover="gameState.bLBNoShow=true" onmouseout="gameState.bLBNoShow=false" onclick="gameState.bLBNoShow=true;usePhone(\'deletephoto\',' + ph.substr(5) + ');return false" class="zoom-icon" style="cursor:pointer;right:0px"><img draggable="false" src="UI/themes/theme0/delete.png" width="48" height="48" alt="Delete"></span>'
		}
	} else if (perYourBody.FindItem(2) > 0) st += '<span onmouseover="gameState.bLBNoShow=true" onmouseout="gameState.bLBNoShow=false" onclick="setWallpaper(\'' +
		img + '\',\'Photo taken and set as your phone wallpaper\')" class="zoom-icon" style="cursor:pointer;left:6px;top:' + tp + 'px"><img draggable="false" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAATwAAAE8CAMAAABq2/00AAAABGdBTUEAALGPC/xhBQAAAwBQTFRFAAAAAgICAwMDBAQEBQUFBgYGBwcHCAgICQkJCgoKCwsLDAwMDQ0NDg4ODw8PEBAQEREREhISExMTFBQUFRUVFhYWFxcXGBgYGRkZGhoaGxsbHBwcHR0dHh4eHx8fICAgISEhIiIiIyMjJCQkJSUlJiYmJycnKCgoKSkpKioqKysrLCwsLS0tLi4uLy8vMDAwMTExMjIyNDQ0NTU1NjY2Nzc3ODg4OTk5Ojo6Ozs7PDw8PT09Pj4+Pz8/QEBAQUFBQkJCQ0NDRERERUVFRkZGR0dHSEhISUlJSkpKS0tLTExMTU1NTk5OT09PUFBQUVFRUlJSU1NTVFRUVVVVVlZWWFhYWVlZWlpaW1tbXFxcXV1dXl5eX19fYGBgYWFhYmJiY2NjZGRkZWVlZmZmZ2dnaGhoaWlpampqa2trbGxsbW1tbm5ub29vcHBwcXFxcnJyc3NzdHR0dXV1dnZ2d3d3eHh4eXl5enp6e3t7fHx8fX19fn5+f39/gICAgYGBgoKCg4ODhISEhYWFhoaGh4eHiIiIiYmJioqKi4uLjIyMjY2Njo6Oj4+PkJCQkZGRkpKSk5OTlJSUlZWVlpaWl5eXmJiYmZmZmpqam5ubnJycnZ2dnp6en5+foKCgoaGhoqKio6OjpKSkpaWlpqamp6enqKioqampqqqqq6urrKysra2trq6ur6+vsLCwsbGxsrKys7OztLS0tbW1tra2t7e3uLi4ubm5u7u7vLy8vb29vr6+v7+/wMDAwcHBwsLCw8PDxMTExcXFxsbGx8fHyMjIycnJysrKy8vLzMzMzc3Nzs7Oz8/P0NDQ0dHR0tLS09PT1NTU1dXV1tbW19fX2NjY2dnZ2tra29vb3Nzc3d3d3t7e39/f4ODg4eHh4uLi4+Pj5OTk5eXl5ubm5+fn6Ojo6enp6urq6+vr7Ozs7e3t7u7u7+/v8PDw8fHx8vLy8/Pz9PT09fX19vb29/f3+Pj4+fn5+vr6+/v7/Pz8/f39/v7+////AAAAAAAAAAAAAAAAluOFBgAAAQB0Uk5T////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AFP3ByUAAAAJcEhZcwAADsEAAA7BAbiRa+0AAAAZdEVYdFNvZnR3YXJlAHBhaW50Lm5ldCA0LjAuMTXdYP5PAAAYR0lEQVR4Xu2deYAVxZnAawZQB5BLcbgcBC9EGBCIK7qYeG1WN8PhwSqSlVVxUUlAZTl0iGfUVTa4ImhURA2CUVcXRE0kJvEGBBEQBLmHYZiLGeZ6r6v6j9nvq/4ec7033e91V79uqF8MMK+r66vvN1Xd1edj9ZqU0fJcoOW5QMtzgZbnAi3PBVqeC7Q8F2h5LtDyXKDluUDLc4GW5wItzwVangu0PBdoeS7Q8lyg5blAy3OBlucCLc8FWp4LtDwXaHku0PJcoOW5QMtzQTrkjWLeM4rq9hWf5U3sRMmqoNNEiuIXfsqL9bgO51xx/aS7Z8x0zqxG0EcS/HnGXbdcf9XZJ1HdORTLF/yTl4u5dbrojqXfVwtTAKYp/3ICFD0KfSSxfjYFFzWblt4xorPP+nySl58DaZ10/oMbi6IxFbHk3SNMLrhp1hV/99DAE/E3REGV44u8bOwRHSd8VEXZKkMc+dPELIiVW19/J8VWiR/yclgm63nnHoHdQy3QA8XeX51m6VOPD/JgB9t2zLd1psENylEZ8PvhonbD2Hagz4ddr3J5UyGP4e/UGdgpPNrGJQZjAJG3hmb6sedQLa8DYyeML6XcfEOUjG+XwTKpDcpQLA92sl0WHVHe45rDRcWCbuoPO9TKg7nd6WsM9cO1OTB8+Ze9YINB7VCE0urhkOKszzk3/O95ZpSLz88Ee6NU7jdUyoMxO2yT8ulJIoTx3fAMlpGh0J5CeeCu7y7ue6+LAccd2/swlhlKeXkZrPfHsPGhXHwH5PGPezKWR+1RgDp5cCy7SsD0jnLxHWHATnfFCSp3GsqqZqzNvAjlkT6iTzKWQS3yHlXy8lnGpYfT1uticHEY9vhTqU2eo0oeYz03pG/IxoBDtfU91A1cdfKejao/i2KLENH56s4RKJLH2NAKPMcbAMqHKOt6aurNY+3e8+xEsUv4220zVHUR+ttbGLukCi9UUPvTy5ELVXU9JdXms7Z/wLN3gZDH+esZina4SuQxNqKYmp5+uCgarqjrKZL3WECGLADb3odCJG8iO2E3tTwAwPZjR1s1sxUV8hgbZQZgjkfguYmRarqeGnn/xYOxs4gxJzTy8ljWX4LlzlzdXsmZKQXyGOtXGJQ5HrG/r5Kup0TeWJ7+cwJN4OPCI+8+anNgEPeGR95z1ObAIBaER94qanNgEKtCIm8q6/QjtTkwiJ0dVRzeei9vFDttD7U5MIg9PVTce+G9vBzWt4DaHBxgrqLgpikV8gYcpCYHBlF4Xljk5RZRmwODODhEy0sVUZSbJnl5uTnJwNjgQ9TmwCCKBjNG7XNGrpNj4Vbl5bGUCGLPA3mp0LrCxPIm0vpt+w656MpfjBk9phmjAfpnU0bfU05tDgy8bNpYat1RErZ/zJi8Ky8ackYbyr+VKU4iefIZsY79bnx82TcFxSXllVVHnFJ1pCZYZwUQUe04AShYebi06MCGZY//a//20h85aUHcBbLTtR3x9KdFeP2Q42WAZAjYyTwAG0SNc4i8yYoXffrkcHwsIcFZ/HjysPT5938v7/7HE3PW4xNUqz1WWwMFtx4xSBZYjfMtsweikHyS05iW8nIZyxz0u4IIh5B49QRUJHk9IoCjNok24W9fdhUccXgFJFrwm8GZoI/8NKL5R/jMSdeFRWBN1qSRFD7bBfSRogaafTIK9hJ37cX+quU1gou9U2Df0Xzi0lQedLv+S2vxKQYtrzHgo2bpGS2GbpMfYel1W6PCgAFPa2kkMBQ534bHDGTKotFPsLnLml0RmIvVQUOIyplZTe01+gE2d09WB+dKf+AQvOrxpvYa/s1Yh7eieluXGJi8RN46qbG9o/9krP0ivZNtBXnEYCzo2Mhe7F85rO3jNVRMkwgh6h5u22CP/gE7kjk1emJsB0xDauY0nGgheYyNqIC9MZXRJADncOXDjj4WY8mDufE33NDy7IChKcSanNjAlX9NZO2WanEOEcZr7ehATcpjbOxhLc8hMFm+hroe/pnDuqzTOwuncBFd19Wyh38wNk1P8BwD+1XjnqPyGOu1MZmzhRpzY29pT8q7LwojmT7XOCB6H8nLYZ1+BHV6h5EE4sdOOFNm0PFG1+EJe00S1I3GrsdyWeZyPWSThS/PhMMMxli3Qi0vSYR54BToeiBvoJ7jJQvsIq6z5F2j5SWLEGKRJW9yMNxhK+SECVoG007rD/wbPoE5PBGQ+agQG7oyvJ/nHmxfMJB+0BR6s9zhTQuxD+CjYMiDBhVdAOoYm2O1KyAII3po2+dvzX90zvTbb77+5snTHnjkxVWfbyuNSocBaSq0IjpWynsgMPJEzYHVz8248uzeHWTDGujY8+yfz3hhdVF1cOSJfNmyB9I7FHBgwv9Mvn/F3Cu6yBYl4tSr5n5QKO/AwYFDIzldLJNNSnPPwxM6onzd7EutGwlj4FkLgj6xyL78/nVH5PhN81HR17I5+WmWZ/LDL17e0OXIWEtoOczqL19cIW8JSWu7d8i25Kf3N1i6/Dr5QnyENCWGyrGu498uS/OwPSgbkp+mNghhCF7w5ADZCID82EGl2YCnCzneuokbQKrRV2pkKx5IjzzY8PPShfKWVYDMOIPWGbyonKt/ZXoihGxDfnp+c4LveKiHbEBy5iysFXs8uEtOqdOCbEGahm3F4v4yfCrqEGvl/ovT9aq5WM/zFXmLuTC+HieDp6oOsSq4fg1ek0mDQBndZ3ny8tPuadaX9pCGVJF1dJi+F/Y9/k8ZZHCf5QnTqH1XfiGQW3WIrGfI+3XC/x2HDO33sBWHvel2FrKmDjMrj/2eB9s6IdZdKcNS8u6RtV2zHjd8FMYfZFwf5Qkuoit6y6iUuRfI+s74EI7zKIw/yLC+yiudKWNS2l4h65xbemzLM8uuliEpZ++QtY719+tyZEyf5MHhmFEkJ3eUsLdgxeOL/TzcwIh+yYMN+rbhGI+y9Rqs+sLtPs73MKBvPY9vH4LhKFfvwcqHbj825fGNcmZMmaoAqx++mcKpB8P5IQ+PZrfLF0xQnmrAAEN2+HXXEkbzQx4czRb9FGNRlqrAEFcU+3SohsH8kVco39FCOaoDg4wpPrZ6nqj4Z4xEGaoEw+RVUli1YCjV8nB7V/cIBqL81IKBnooYPmz3MJJyeXBAuwy/8JiyUw1EynrHj8myH/JMg2843T930l6f744ReZxH5DkoSk09GOzqSPjlYQa8+l6MQpn5AYabVY3nv6xWKALDKN/mrcCbACkvp8iGNUCfOgXW6LbSMBRfUpUtUyzvAN4SQFk5QjaqJbTUEVB88AHV36srW6VWnrgHY1BStsgGSbK6Zffu2y+nV3Y364IHQoXswcL3G/QGMVXIJqnc5gm+GW9UpJzskM0BOl82ZdHqDdv3FpUd3L19/epFk38qX+eHUEk7oGSHrYofvpbtUSqv/F8cZywbw9pf/OineP8d7GnkNgvn2EJU/u3BkdZy55VdWxbyYcufxwiUUKvIprAek78og50k+IJug/d+HoUf+nBSEre2QLGTloRbnijES2WUT2vIhrDuD/9giZJ3jcX+gx8B/OuH/G5WQVqrNaBU3xJqhhpkS1TJAwXGw44zZSxnXgWtmRBR/gR+R7yTOrHUk4bKPa5siCJ5+OLDgrOhfsqmFbAVWTdsdjCpFcZ3o7OwOK3ZClDovEMqzw9gM1TJw7H2P07TZP3eqnZwRAAj2qxeJjsfrdsKUOh5HO+qwFYolLcH78CjVBIi2zB6F27VHMjDPck2eXLQScXDChz05lSRjVAmz3zRWYqMTSt2PieDzcHBu+VaVENCoMgrCm/BkG1QJc+sHuQsw67zjCTuM8F78YzHTnZW9eDakPY8/oGzBLu/HjHk3MQZcuJSu7i7s8o/CmnPi9xunx/GfyOCOhzLw6Kc1yzGVamWRECJKRFazXuwAcrk7Tn6wqqEYPjHUryf+De4MtWTCMb678c5Nq3iLRhflTzjBdvkMPq0mhQnstX/gatTTQmAAi9B7eGTF2nxZtzmYPCrS/AhnlTghy7HCqiu+MDyayMO5o8pgdFVyfuqk4N+kb0XSqbW84TYeRrUQHUlAHbl63FmrQJl8qC9c+0yg+UnLXGxPRL8JdsrmrB8Qdi2ebiducJBYqOrUk8MOlSl7clCWH4NzqtVAHWrkWeKWrtRC5FP3+FiRMGUhW/tCbVQffFhrJuqq5DK5HHxuX1a7NGIm9v/wV4EH/Sn+uIDy7+h8l4DVSuSZzxhkxYs7u36W6r4PruuB4vnhWxvy3nVVfZdYrbrpIQxA+qhGuMDs6HqcMkT5s6zbJPqs9X1hlzwLb1s45y5N2RTFb4aKqbmxwUWT3V/5zoXUTzOoDrjAov/oub6LdSspueJ+fY5/c39aIJ9xsf2gRaGbNjifQLU+vgwNrDGg8mrENX224eZYZM31rY/zEn1oLYRONfDe7Co1rgwdkO4tnkiMtRW3koP5OEXs71jK29YuLZ5fF9nu4xO3m0angyn7Sfbheqs5ltPVckTXzT5upeWMHYZnk6n4q4QF9uFar+OinqLKnnmClt5k51canSCuNUu1IkfUVFvUSZvOdRLjY8HLH3co45n8odsY71LRb0FKlYj71XbhN6mku7BF9lRvfGApcuopLdAxWq2ec/bDaUum6ioa/jGDnbBFlNRb1ElD08jU9PjwljvbVTSNWJLtl2weVTUW1TJE9Pt8um3i4q6Z7vNJU6Yj1NJb1Em7w67fAbglR9v2HO2XbBfKzk+UyZvkl0+gw9QUdeIggF2waaES559z9tHRV0j9pxpF2x6uOTZnFSBbd5OKuoa8cPpdsHuD5e8R+3y6enZ3pZv6W4XbCEV9RZl8vCd/a3g5TxPbGhvFyxc8zzxGtRLbY8HLF1BRV0j3raNFa4jDPOPtgk9TCVdw22u3cLS96iot0DFSuTx90+0G0q3CevxKNeIW+xCheysCl/T7KvDm8PYKK8ehzUutAvVwbPtaxNUyRNFjb+9OQ6wx9jh0fxhq+1J6+xiKuotyuRFBtllxN716I7NN6EuqjUujF2kZJqnTp643lbevVEPLgAJwW+1lXdTuOSZ4t7WM4KUzq1yfwMO56Kyj+2vaVbIep65ECqm5scFFn/i/qZDzo1V9oFeCJk8vtY+pwl1rpMSog62DzaBstaF7KK3fGaPmh8fxnpscb3LEHy9zYEtxDlnT8h6nqgeZ5sUm+HBDsNudwFxxit6/kydPCe3SfXYBSVpjdQQ2/HJZaoxLrB4gUfXOJsDVSvaYfA1NllhWg9FXcqLznYQZaMad8rkgZOozTUtTKvrV+5u6OafwYGMXZTeityplGf+3D4vlleW+pASBi/B931TbfGB5WM9OpJpAdStRh609ykHiZ24JPWexwWfh82n2uIDy58JXc8DNnW1SQwz67I+9dTEGvvXozF2yrYwPjIa+Se71DD4pQeSeco7BugQxu5/sAuAEUZHFI1apfK4zQ04AEaf5uSVIC0AeUcm4epUUwKgwNtYWAkYXpU8s/Bcu9ykvelG8vLAXfQuXJnqSQRj5x+SxVWA8ZX1PJkeZZEIjL8wkvyRBq/5Ha5KtSQCSkyPykGuAmyAKnlCfGKfHubX/qkITNmcJ4hfJFT9GH6hK9WRECjyd0VjFoDa1fU8YQx1liCbUcWdv5QGX7hQOQ1XoxoSAkV+UkdrKQCboKzncfF7ZxnC4Dro/Kwy/FIK5fbOSdWLw/pGHy5KfuIgRalv8Brn8owvzsNVaO3EQJmRJercKZWHvOQkSWmv1/wyOM7F18bRqi0ADSIKZUqeli9wpHVbAQq9rrDjKZdXjl9fS7m0gmzGNZvRXuLtO27rYMyux2Nmh5VeUKFoRyuR7VAoz+krQ2U72k/eiAestGpLYCdrbJgkXz3osMpXW+vJrpENUSnvoLOuR/o6//rbGlqzJUJUf3OX9cpfWqdVoNiQMuHVwx7xkE1RKC/Kl+AroimfVpFNYd0nroShBoMXkoZBStVAhxTi8LsTnL9uFavLWqZwzAKyLSp7njhyi8NsY/pYj5uWf1uJWz/8T2KK8g1v3EDv+XVe2ZRqhXsLQLZGoTzD5D90cZxwTB/rNuK2R/64trCopKTkUOHaNx/99+HU55KpqeuPKne1gGyPyp4HM9oHMQblZI9sEdGpZ79eR99rjlAZe7DwEymcrEkK2SSF8pDiCyEGJeUI2aiW0FJHQPF/LFX9la2yVYrl8fc6J5m6hWwbQj8nAazUeZXcWqpENk6xPEM8h1EoLz/AcC+rOxUVA8OolgfzM3yhmX/2MNi4WpzthF8eTDi2JftlLK6AWIN2KhaH+CEP3y37of11Ls+ASD2+9OP7vX2Rxw1R+1sMRNmpBQPNi6j+/h8EI6mXZxpGVL6QnPJTCYa5tw7cHRs9DxHmYQcv5vUADHK3P9+T6Z88LorHYCzKURUY4toSH3odgsF8kQeboIJhGIyyVAMGuOyQ6ilKDIzmU88TfBNeTFNpD6sftkWezfcDDOeHPESIHWr7HlZ+4U5/xCEYzz95xsEbMR7l6jVY9S8PefNyL0dgQL/k4cgtvENGpHS9RNZ7VxFMiyicemRIv+QB0ZopMiRl7B2y1rtroXcfmz0P4Wbdf3fFmJSzV2CVpy6o8297h2BQP+XhrWF/ktf7vdQn6xv416hPU5QYMqyP8uRlsF0TZFjK3D2ytkl75UU3P5FxfR22OOc78qx1PYeSd4es6ZTnq+G34tP8LoaM7GfPQ4QZXYF3AAEkIHWsai563/DhFFRzZGj/5Zm85qkcGZscpIqso+8ztUpvq0iEDO63PNxtiOimX+K9na70yfU73LrZwC0p1e0jMrzv8uS2j9e9cr4Mn6o+a+Wh79Th1eF02JPx0yAPEWbNK/JgNyV91oojlvo8t2uMbEG65OHh2u8HyyYk6Y/WueCVIuh0VJ3/yDakSZ60x8tfu1g2AiAzdlBp9rNXD+NoPT7lWZkL01j3q3NkOwDykxgqxwZO3xiR95Gmz116ex4BCve+MS5bNkVCnppDS4Hu49/c7+MJgETItqRfHhfG7pdvp52vBRmzoM8kQyYv3sN9O1vcGrI56ZeHGz9RV7Fp4S/64aPbiTj53AmLNh+WjwsFwF0g5IE+3HJJh9GCL/8we/zIPrJdjTl95E2zln9dAIMVXxwHJdO5sSNkwx4IQEOaIvZ/9cn/LX/pmcfm/nb+y8tWrl67H3UFjYDKwyMQqzPC/7Gn4TEELQoOJC94WM7wP2kNN3PWguAQseQF67eKjcGOBn+jupjAwMkrtuQFr2FhYJeUlx+snhcWvpXydM9Lif+V8vK1u1TAl+4EbocRBsCYYV0DnBGAg+ywwUUZvhKHsTuDN4cKPnxrLynvWj1sk0aIZZlsIsi7QMtLFs75bYzhqbIhVVpeknCzKlfKy2i7SstLEiFWtWV59ThwJ0foM41DePR2PNmNfa9PKR580+caJ5TmsE4oD+zNC+AZn0AjnoYDM5I3aH8QTzYGmL2DWAZemKqvz83InK/lJcX8NizHkgddL2eflucU2D3sP8O6Nop/5DE2pzYA1/JCghGZw9jUmLx62HX83b/nF0IO53/tIgctyYOBe4ln3/p5rCMKLond0GD9NRW/3Z3rU1O2GNwUt2XAwYUk5pBlLomm4abokMEFj7ySGet4MXlgL3ulninbAR1vZY+j7o7KA3t9v9TybODis74N7hrkwXwl+xvY7GmBieDc5OuzWWyDBzRoBHtn/dnPRy5DBhyEGX8+q7G7RvLQXq8Veo+bCM75ip5N3DWWVz+KsS5zy6isphlGeX7HTJZLriSN5WHfa3PdPkPgTau6BxIwXPHWcb5vXBvGRpEpiyby4EfGzlxSpU+NNgJdcHHk9f6MZTTpdy3k1edC5xu5tlafHW0Ael3dWnxaJCefJMVoLk92vlMmb3H+LQHHOjBqv7/9VLBCfhoR5yPofKzdzR+UwuDFeR9yXG0BIVeZM3Q5/EfZhze2BSON97Ix4sjDU1Sgb+B/flEYMbmB9wPjPcLHC4308UjRZ7MGnJABI5bMNCWuvPr6TiyDZWYNvfmlbystbcfPKMZxJv9fsfHFCRe0+ir6RJ9PBXuSNn2vuPbf7rxv5qyZxw8z7p543c/OgJmJJH6vQxLJq6/Pn5pnPcp+PJNYHJJYHpHf5B3ZxxPyMkWr2MrTJEbLc4GW5wItzwVangu0PBdoeS7Q8lyg5blAy3OBlucCLc8FWp4LtDwXaHku0PJcoOW5QMtzgZbnAi3PBVqeC7Q8F2h5LtDyXKDluUDLc4GW5wItzwVaXsrU1/8/kJ1Yka/ScfEAAAAASUVORK5CYII=" width="24" height="24" alt="Camera"></span>';
	if (img.indexOf(".mp4") != -1) st += '<video width="100%" autoplay style="' + widi + ';margin: 0px 0px" ><source src="' + img + '" type="video/mp4"></video>';
	else {
		st += '<img draggable="false" src="' + img + '" style="' + widi + ';margin: 0px 0px" alt="' + img + '"';
		if (title !== undefined && title !== "") st += ' title="' + title + '">';
		else st += ">"
	}
	st += "</a></div>";
	if (psh > 0) {
		gameState.nUId = per.infoid;
		st += addPopupWindow("string", per.getPersonName(), per.getPersonInfo(), undefined, undefined, true)
	}
	return st
}

function AddImage(img, widh, alg, imgbig, title, per, doc, ph) {
	var st = addImageString(img, widh, alg, imgbig, title, per, ph);
	if (doc === undefined) mdCache.write(st);
	else if (doc == "comments") addComments(st);
	else if (doc && doc !== "string" && doc !== "ss") doc.write(st);
	return st
}

function AddImageRandom(imgbase, no, wid, alg, imgbig, title, baseno, per, doc, ph) {
	if (baseno === undefined || baseno === "") baseno = 0;
	var idx = Math.floor(Math.random() * no) + baseno;
	var img;
	if (imgbase.indexOf("-day") != -1) img = imgbase.split("-day")[0] + String.fromCharCode(idx + 97) + "-day";
	else if (imgbase.indexOf("-night") != -1) img = imgbase.split("-night")[0] + String.fromCharCode(idx + 97) + "-night";
	else img = imgbase + String.fromCharCode(idx + 97);
	if (img == "monstera") img += ".png";
	else if (img.indexOf("sex-ff lick f") > 0 || img.indexOf("sex-ff lick g") >
		0) img += ".gif";
	else img += ".jpg";
	if (wid !== undefined && wid !== "") {
		var ar = wid.split(",");
		if (ar.length > 1)
			if (idx > ar.length - 1) wid = ar[ar.length - 1];
			else wid = ar[idx]
	}
	return AddImage(img, wid, alg, imgbig, title, per, doc, ph)
}

function AddImageArray(choices, wid, alg, imgbig, title, per, doc, ph) {
	if (choices.length === 0) return "";
	var img = choices[Math.floor(choices.length * Math.random())];
	if (per != undefined) img = per.getImg(img);
	return AddImage(img, wid, alg, imgbig, title, per, doc, ph)
}

function AddImageArrayX(choices, wid, alg, imgbig, title, per, doc, ph) {
	if (choices.length === 0) return "";
	var img = choices[Math.floor(choices.length * Math.random())];
	return AddImageX(img, wid, alg, imgbig, title, per, doc, ph)
}

function AddImageX(img, wid, alg, imgbig, title, per, doc, ph) {
	return AddImage("Explicit/" + img, wid, alg, imgbig, title, per, doc, ph)
}

function AddImageRandomX(imgbase, no, wid, alg, imgbig, title, baseno, per, doc, ph) {
	return AddImageRandom("Explicit/" + imgbase, no, wid, alg, imgbig, title, baseno, per, doc, ph)
}

function AddImageRorX(img, wid, alg, imgbig, title, per, doc, ph) {
	return AddImage((isExplicit() ? "Explicit/" : "") + img, wid, alg, imgbig, title, per, doc, ph)
}

function AddImageRandomRorX(imgbase, no, wid, alg, imgbig, title, baseno, per, doc, ph) {
	return AddImageRandom((isExplicit() ? "Explicit/" : "") + imgbase, no, wid, alg, imgbig, title, baseno, per, doc, ph)
}

function addBackgroundImageString(img, alg, bInvert, sty) {
	if (alg === undefined || alg === "") alg = "87% 0%";
	if (bInvert === true) sty = (sty === undefined ? "" : sty) + "-webkit-filter:invert(100%);filter:invert(100%)";
	if (alg == "fill") return "<style>.mainblock:before {content:' ';display:block;position:absolute;left:0;top:0;width:100%;height:100%;z-index:-1;opacity:" + (nTheme === 0 ? "0.2" : "0.8") + ";background-image:url(" + img + ");background-size:cover" + (sty !== undefined ? ";" + sty : "") + "}</style>";
	return "<style>.mainblock:before {content:' ';display:block;position:absolute;left:0;top:0;width:100%;height:100%;z-index:-1;opacity:" +
		(nTheme === 0 ? "0.2" : "0.8") + ";background-image:url(" + img + ");background-repeat:no-repeat;background-position:" + alg + ";background-size:auto 100vh" + (sty !== undefined ? ";" + sty : "") + "}</style>"
}

function addBackgroundImage(img, alg, sty, doc) {
	var st = addBackgroundImageString(img, alg, sty);
	if (doc === undefined) mdCache.write(st);
	else if (doc == "comments") addComments(st);
	else if (doc && doc != "string" && doc != "ss") doc.write(st);
	return st
}

function AddMana(no) {
	nMana = nMana + no;
	updateLeftBar()
}

function toggleIcons() {
	gameState.bUseIcons = !gameState.bUseIcons;
	showRightBar(gameState.nRightBarState)
}

function toggleInventoryPopup() {
	gameState.bInventoryPopup = !gameState.bInventoryPopup;
	updateLeftBar();
	showRightBar(gameState.nRightBarState)
}

function toggleBubble() {
	gameState.bCommentLL = !gameState.bCommentLL
}
var bPopupShown;

function addPopupWindow(md, title, txt, onclose, sty, blk, noclick, nocloseb) {
	if (isBritish()) txt = txt.split("Setting/").join("UK/");
	else txt = txt.split("Setting/").join("US/");
	if (sty === undefined) sty = "";
	else sty = ";" + sty.split("height:80%").join("height:80vh");
	var bWhite = sty.indexOf("background-color:white") != -1;
	var stxt = bWhite ? "color:black;text-shadow:-1px 0px white, 0px 1px white, 1px 0px white, 0px -1px white" : "color:white;text-shadow:-1px 0px black, 0px 1px black, 1px 0px black, 0px -1px black";
	var st = '<div id="light' +
		gameState.nUId + '" class="white_content" style="text-align:left;' + (noclick !== true ? "cursor:pointer;" : "") + (bWhite ? "" : "background-color:black;") + stxt + sty + '"';
	if (noclick !== true) st += ' onClick="closePopupWindowNow' + gameState.nUId + '()"';
	st += "><div style='height:98%;height:calc(100% - 1.5em);width:100%;cursor:pointer;margin-bottom:-4px;font-size:1.1em;margin-top:1.5em'>" + txt + "</div>";
	if (title !== "") st += "<p style='z-index:83;position:absolute;top:0.6em;left:2%;width:96%;text-align:center;" + (noclick !== true ? "cursor:pointer" :
		"") + ";margin-top:-12px;font-size:x-large'><b>" + capitalizeFirstLetter(title) + "</b></p>";
	if (nocloseb !== true && !isScreenSmall()) {
		var stxtg = bWhite ? "color:grey;text-shadow:-1px 0px white, 0px 1px white, 1px 0px white, 0px -1px white" : "color:grey;text-shadow:-1px 0px black, 0px 1px black, 1px 0px black, 0px -1px black";
		st += '<a style="z-index:83;position:absolute;top:5px;left:5px;line-height:10px;' + stxtg + '" href="#" onClick="closePopupWindowNow' + gameState.nUId + '();return false">' + (noclick !== true ? "click anywhere to close" :
			"close") + "</a>"
	}
	st += "</div><script type='text/javascript'>function showPopupWindowNow" + gameState.nUId + "() {document.getElementById('light" + gameState.nUId + "').style.display='block';";
	if (blk !== false) st += "document.getElementById('fadeblack').style.display='block';";
	st += "};function closePopupWindowNow" + gameState.nUId + "(){if(gameState.bLBNoShow)return;";
	if (blk !== false) st += "document.getElementById('fadeblack').style.display='none';";
	st += "document.getElementById('light" + gameState.nUId + "').style.display='none';setQueryParams();bPopupShown=false;";
	if (onclose !== "" && onclose !== undefined) st += onclose;
	st += "}\x3c/script>";
	gameState.nUId++;
	if (md === undefined) mdCache.write(st);
	else if (md == "comments") addComments(st);
	else if (md && md !== "string" && md != "ss") md.write(st);
	return st
}

function showPopupWindow(title, txt, onclose, sty, blk, noclick, nocloseb) {
	if (bPopupShown) return "";
	if (onclose === undefined) onclose = "dispPlace()";
	bPopupShown = true;
	mdCache.write(addPopupWindow("string", title, txt, onclose, sty, blk, noclick, nocloseb) + "<script type='text/javascript'>showPopupWindowNow" + (gameState.nUId - 1) + "()\x3c/script>")
}

function writePageFooter(doc) {
	doc.write('<div id="fadeblack" class="black_overlay"></div></body></html>');
	doc.close()
}

function hideSidebars() {
	gameState.bSidebarsHidden = true;
	hideLeftBar();
	hideRightBar();
	ClearComments(true)
}

function showSideBars(param) {
	if (sComment !== "") WriteCommentsFooter(bChat);
	showLeftBar();
	showRightBar(-1 * gameState.nRightBarState, param)
}

function updateGameDisplay() {
	updateRightBar();
	updateLeftBar();
	updateMain()
}

function updateRightBar(shw) {
	var rb = document.getElementById("rightbar");
	if (!rb) return;
	if (gameState.nRightBarState < 3 && gameState.bInventoryPopup) shw = "none";
	if (shw !== undefined) {
		rb.style.display = shw;
		if (shw == "none") return
	}
	var rm = gameState.getRightBarWidth();
	rb.style.width = rm;
	mdCache.updateElement(rb, gameState.nRightBarState < 3 ? getInventoryContents() : getPhoneContents())
}

function hideRightBar() {
	updateRightBar("none")
}

function showRightBar(no, param) {
	if (Place == 1) return;
	gameState.bSidebarsHidden = false;
	var orbs = gameState.nRightBarState;
	if (no !== undefined) {
		gameState.nRightBarState = Math.abs(no);
		if (gameState.nRightBarState > 4) gameState.nRightBarState = orbs;
		orbs = -1
	}
	if (orbs != gameState.nRightBarState)
		if (gameState.nRightBarState < 3) {
			gameState.sPhoneState = "";
			updateRightBar("block")
		} else {
			usePhone(param);
			updateRightBar("block")
		}
	updateMain()
}

function updateLeftBar(shw) {
	var lb = document.getElementById("leftbar");
	if (!lb) return;
	if (shw !== undefined) {
		lb.style.display = shw;
		if (shw == "none") return
	}
	gameState.bSidebarsHidden = false;
	var lm = gameState.getLeftBarWidth();
	lb.style.width = lm;
	lb.style.backgroundImage = "url(" + getThemeFolder() + "background.jpg)";
	mdCache.updateElement(lb, getLeftBarContents())
}

function hideLeftBar() {
	updateLeftBar("none")
}

function showLeftBar() {
	updateLeftBar("block")
}

function toggleLeftBar() {
	gameState.nLeftBarState = gameState.nLeftBarState == 1 ? 2 : 1;
	updateLeftBar();
	updateMain()
}

function getLeftBarContents() {
	var dn;
	var hr = getHour();
	if (hr > 5 && hr < 8) dn = "sunrise";
	else if (hr > 17 && hr < 20) dn = "sunset";
	else dn = hr > 5 && hr < 20 ? "day" : "night";
	var tm = hr < 12 ? hr + "am" : hr == 12 ? "Noon" : hr - 12 + "pm";
	var hm = hr > 12 ? hr - 12 : hr;
	var min = getTime() - hr * 100;
	var ts = getDay(true) + " " + hm + ":" + (min < 10 ? "0" + min : min);
	var ph = perYourBody.FindItem(2);
	if (gameState.nLeftBarState == 2) return "<div id=\"lsd\" style=\"width:100%\" onmouseover=\"document.getElementById('lsdbig1').style.display='block';\" onmouseout=\"document.getElementById('lsdbig1').style.display='none';\">" + getLSD() +
		"</div>" + '<img draggable="false" class="lsdimg" style="margin-top:-8px" src="' + getThemeFolder() + dn + 'black.png" alt="' + dn + '" title="' + getDay() + (dn == "day" ? "" : " " + dn) + ", " + tm + '">' + '<p style="font-size:xx-small;text-align:center;margin-top:-4px"><b>' + ts + "</b></p>" + '<span class="zoom-icon" style="bottom:12px;left:0px"><img draggable="false" style="cursor: pointer;width:99%" onclick="toggleLeftBar()" src="data:image/gif;base64,R0lGODlhKAAoAOMKAKioqKmpqaqqqqurq6ysrLm5ubq6uru7u/39/f7+/v///////////////////////yH+EUNyZWF0ZWQgd2l0aCBHSU1QACH5BAEKAA8ALAAAAAAoACgAAAT+8Jkgqr046xzMO8JAbWR5BYMABqjpkuJothbLXuJrpqFc8zzdbOMTlooYpDFZQY2czaVrEGNRpcdaIKFQJG5R7OnU7fqUwmBvUFaI1OosJUCAvgXttcBZ3/tJMnEVeRlBaGE/eylUXF5XOTljOyGIbGWGFYs6KXMYKXlxnYKeI5ylFI0Jik0UPDQlIl5ts7RlXK87AbUKCF5cvbW4LrJdjcTGyAovQALJbQnGxbaU1LCITm1QYaOFpZSdeGVRrdTC3ThqhJlq5jiZJwBB6gMAPswbQa6R4V0/3u9ScuiCpmAONzEy1B1CWCEVIjE4fPhSlghiE0w1LOyz6AkgRw4jfs6E/JgRkI4WCy22QgGApIl431yCTFGgnUwRBSSk5NjhQQQAOw==" alt="Open" title="Show Details"></span>' +
		'<div id="skore" style="width:100%">' + '<img draggable="false" class="lsdimg" src="' + getThemeFolder() + 'mana.png" style="width:99%" title="Mana ' + nMana + '" alt="Mana"><p style="font-size:x-small;text-align:center;margin-top:-4px"><b>' + nMana + "</b></p>" + '<img draggable="false" class="lsdimg" src="' + getThemeFolder() + (isBritish() ? "moneyuk" : "moneyus") + '.png" style="width:99%" title="Cash ' + sCurrency + perYou.getCashOnHand() + '" alt="Money"><br><p style="font-size:x-small;text-align:center;margin-top:-4px"><b>' +
		sCurrency + perYou.getCashOnHand() + "</b></p>" + "</div>" + (ph > 0 ? '<a draggable="false" class="lsdimg" href="javascript:HandleItem(' + ph + ',2)"><img draggable="false" src="' + getThemeFolder() + (arSMS.length > 0 ? "phonesms" : "phone") + '.png" style="width:99%" title="' + (arSMS.length > 0 ? "SMS Available" : "Phone") + '" alt="Phone"></a><br>' : "") + (gameState.bInventoryPopup ? addPopupWindow("string", "Inventory", getInventoryContents(1), "", "width:50%", false, true) + '<a draggable="false" class="lsdimg" href="javascript:showPopupWindowNow' +
			(gameState.nUId - 1) + '()"><img draggable="false" src="' + getThemeFolder() + 'bag.png" style="width:99%" title="Inventory" alt="Inventory"></a>' : "") + '<br><a id="qsavelink" href="#" onClick="QuickSave();return false"><img draggable="false" src="' + getThemeFolder() + 'quicksave.png" style="display:block;width:66%;margin-left:auto;margin-right:auto;margin-bottom:2px" title="Quick Save" alt="Quick Save"></a>' + '<a id="savelink" href="#" onClick="DoSave();return false"><img draggable="false" src="' + getThemeFolder() +
		'save.png" style="width:99%" title="Save Game" alt="Save"></a>' + '<a href="#" onClick="DoLoad();return false"><img draggable="false" src="' + getThemeFolder() + 'load.png" style="width:99%" title="Load Game" alt="Load"></a>' + (gameState.bAllowUndo ? '<br><a href="#" onclick="loadUnDo();return false"><img draggable="false" src="UI/' + (gameState.sUnDo === "" ? "undo-grey" : "undo") + '.png" style="width:99%" title="Undo" alt="Undo"></a>' : "") + '<br><br><a href="#" onclick="helpCreditsPage();return false"><img draggable="false" src="' +
		getThemeFolder() + 'credits.png" style="width:99%" title="Credits" alt="Credits"></a><br>' + '<a href="#" onclick="helpGamePlayPage();return false"><img draggable="false" src="UI/help.png" style="width:99%" title="Help" alt="Help"></a>';
	var s = '<span class="zoom-icon" style="z-index:41;bottom:2px;right:2px"><img draggable="false" src="UI/' + dn + '.png" width="42" height="42" alt="' + dn + '" title="' + getDay() + (dn == "day" ? "" : " " + dn) + ", " + tm + '"></span>' + "<span class='zoom-icon' style='z-index:41;position:absolute;bottom:12px;left:0px'><img draggable='false' style='cursor:pointer;' onclick='toggleLeftBar()' src='" +
		getThemeFolder() + "collapse.png' width='24' height='24' alt='Close'  title='Hide Details'></span>" + "<script type='text/javascript'>" + "function swap(shw) {" + "document.getElementById(shw).style.display = 'block';" + "for (var i = 1; i < swap.arguments.length; i++) document.getElementById(swap.arguments[i]).style.display = 'none';" + "}" + "function MoveTo() {" + "var sPlace = document.getElementById('Cheating').moveTo.value.split('?')[0];" + "var sPar = document.getElementById('Cheating').moveTo.value.split('?')[1];" +
		"if (sPlace !== '') dispPlace(parseInt(sPlace, 10), sPar !== undefined ? sPar : '');" + "}" + "\x3c/script>" + "<div id='lsdbig' style='width:100%;'>" + getLSD() + "</div><div id='skore' style='width:100%'>" + '<table style="width:100%;padding:2px;border-collapse:collapse;border-spacing:0"><tr><td style="width:50%;vertical-align:top;text-align:left;font-size:1em"><b>Mana:</b><br><input type="text" name="ManaText" value="' + nMana + '" size=3 maxlength=3 disabled="disabled" title="Your current mana for spells" style="font-weight:bold;width:90%;font-size:1em"></td><td style="width:50%;vertical-align:top;text-align:left;font-size:1em"><b>Cash:</b><br><input type="text" name="CashText" value="' +
		sCurrency + perYou.getCashOnHand() + '" size=3 maxlength=4 disabled="disabled" title="How much cash you have on hand" style="font-weight:bold;width:90%;font-size:1em"></td></tr></table><b>' + (ph > 0 ? '<a draggable="false" href="javascript:HandleItem(' + ph + ',2)" style="font-size:small;font-size:0.8em">Use your Phone</a>' : "") + (gameState.bInventoryPopup ? '<br><a draggable="false" href="javascript:showPopupWindowNow' + gameState.nUId + '()" style="font-size:small;font-size:0.8em;margin-top:-8px">Check Inventory</a>' +
			addPopupWindow("string", "Inventory", getInventoryContents(1), "", "width:50%", false, true) : "") + "</b></div><div id='barmain' style='text-align:center;width:100%" + (gameState.bCheatShown ? ";display:none" : "") + "'>" + "<hr>" + "<p style='margin-top:-6px;font-size:small;font-size:0.8em'>" + "<span style='font-size:x-small'>Version 14.8.4</span><br><b>" + "<a href='index.html' target='_top'>Home</a><br>" + "<a href='#' onClick='DoRestart();return false'>Restart Game</a><br><br>" + "<a id='qsavelink' href='#' onClick='QuickSave();return false'>Quick Save</a><br>" +
		"<a id='savelink' href='#' onClick='DoSave();return false'>Save game</a><br>" + "<a href='#' onClick='DoLoad();return false'>Load game</a><br><br>" + (gameState.bAllowUndo ? "<a href='#' onclick='loadUnDo();return false'>Undo Last Move</a><br>" : "") + "<a href='#' onclick='helpCreditsPage();return false'>Credits</a> " + "<a href='#' onclick='helpGamePlayPage();return false'>Gameplay</a><br><br>" + "<a href='http://www.hypnopics-collective.net/smf_forum/index.php' target='_top'><i>Collective</i> Forum</a><br>" +
		"<a href='http://www.tfgamessite.com/phpbb3/index.php' target='_top'><i>TF Games Site</i></a><br><br>";
	if (bCheating) s += "<a href=\"#\" onclick=\"gameState.bCheatShown=true;swap('cheat','barmain');return false\">Cheat</a>";
	s += "</b></p></div>" + "<div id='cheat'" + (gameState.bCheatShown ? "" : " style='display:none'") + ">" + "<p style='font-size:small;font-size:0.8em;margin-top:4px;margin-bottom:-8px'><b>Cheater!</b> <a href='#' onclick='gameState.bCheatShown=false;swap(\"barmain\",\"cheat\");return false'>stop</a></p>" +
		"<form method='GET' id='Cheating' action='.'>" + "<p style='font-size:small;font-size:0.8em'>Add <a href='' onclick='AddCash(20);return false'>money</a><br>" + "Add <a href='' onclick='AddMana(10);return false'>mana</a><br>" + "Add <a href='' onclick='perYou.addExperience(9);dispPlace();return false'>experience</a><br></p>" + "<p style='text-align:center;font-size:small'>" + "<a href='' onclick='toggleExplicit();updateLeftBar();return false' title='Explicit Images'>Explicit Scenes <b>" + (isExplicit(true) ? "Off" :
			"On") + "</b></a>" + "<br><a href='' onclick='toggleLocale();return false' title='Where in the world'>Swap Locale</a>" + "<br><a href='' onclick='if(!confirm(\"Warning: this can break your game?\")){return false;}else{togglePath();updateLeftBar();return false;}' title='Path'>" + getPathName() + "</a>" + "<br><a href='' onclick='WaitHere(6);return false'>pass 1 hr</a>" + "<br><a href='' onclick='WaitHere(-6);return false'>go back 1 hr</a>" + "<br><a href='' onclick='WaitHere(144);return false'>pass 1 day</a>" + "<br><a href='' onclick='WaitforForDayNight();return false'>wait for " +
		(isDay() ? "night" : "day") + "</a>" + "<br><a href='' onclick='writeItemDetails();return false'>View Items</a>" + "<br><a href='' onclick='writePlaceDetails();return false'>View Places</a>" + "<br><a href='' onclick='writePersonDetails();return false'>View People</a>" + "</p><p style='font-size:small;font-size:0.8em;text-align:center'><b><span id='cplace'>" + "Your location <a href='#' onclick='dispPlace();return false'>" + Place + (sPlaceParams !== "" ? "?" + sPlaceParams : "") + "</a>" + "</span></b><br>" + "<a href='' onclick='MoveTo();return false'>Move To</a> <input type='text' id='moveTo' size='3' value=''></p>" +
		"</form>" + "</div>";
	return s
}

function getLSD() {
	var sChar = perYou.getPersonName();
	if (sChar === "undefined" || sChar === "") return "";
	var sResult = '<p style="font-family:Arial;color:#FF0000;text-align:center;line-height:16px;margin-top:0px;font-size:1.5em">';
	var fldr = "Player/" + sAvatarFolder;
	if (isPossess()) {
		var img = perYourBody.getImg(perYourBody.getPossessionFace());
		sResult += "<a href='#'><img draggable='false' " + (isInvisible() ? "class='grayscale' " : "") + "src='Images/" + img + ".jpg' onClick='Dispossession();return false' title='Dispossess " + sChar +
			"' style='width:100%' alt='Dispossess'/></a>"
	} else sResult += "<img draggable='false' " + (isInvisible() ? "class='grayscale' " : "") + "src='Images/" + fldr + "/" + (perYou.checkFlag(31) ? "face3" : "face1") + ".jpg' title='" + sChar + ", yourself" + (isInvisible() ? " Invisible" : "") + "' style='width:100%' alt='Yourself'>";
	if (gameState.nLeftBarState == 2) return sResult + "</p>";
	if (isPossess()) sResult += "<br><span style='cursor:pointer'><b>" + sChar + "<br>Possessed";
	else sResult += "<br><span style='cursor:default'><b>" + sChar;
	return sResult +
		"</b></span></p>"
}

function updateLSD() {
	var lsd = document.getElementById("lsdbig");
	if (!lsd) lsd = document.getElementById("lsdbig1");
	if (!lsd) return;
	mdCache.updateElement(lsd, getLSD())
}

function updateMain(s) {
	var rm = gameState.getRightBarWidth();
	var lm = gameState.getLeftBarWidth();
	var mb = document.getElementById("mainbar");
	if (!mb) return;
	mb.style.width = "calc(100% - " + lm + " - " + rm + ")";
	mb.style.margin = "0px " + rm + " 0px " + lm;
	if (s !== undefined) mdCache.updateElement(mb, s)
}

function SetLeftColumnSize(size) {
	gameState.sLeftColSize = "td-left" + (size !== "" && size !== undefined ? "-" + size : "")
}

function AddRightColumn(doc, pclass) {
	if (gameState.bRightCol) return;
	if (!doc) doc = mdCache;
	if (pclass === undefined) pclass = gameState.sRightColSize !== "" ? gameState.sRightColSize : "td-right";
	doc.write('<br></td><td class="' + pclass + '">');
	gameState.sRightColSize = pclass;
	gameState.bRightCol = true
}

function AddRightColumnMed(doc) {
	AddRightColumn(doc, "td-right-med")
}

function AddRightColumnLarge(doc) {
	AddRightColumn(doc, "td-right-large")
}

function SetRightColumnSize(size) {
	gameState.sRightColSize = "td-right" + (size !== "" && size !== undefined ? "-" + size : "")
}

function isPuzzles() {
	return gameState.bPuzzles
}

function togglePuzzles(val) {
	setPuzzles(val);
	alert("Puzzles are now " + (gameState.bPuzzles ? "on" : "off"))
}

function setPuzzles(val) {
	gameState.bPuzzles = val === undefined ? !gameState.bPuzzles : val
}

function isExplicit(base) {
	if (base === true || !gameState.bExplicit) return gameState.bExplicit;
	if (gameState.bExplicitNow === undefined) gameState.bExplicitNow = Math.random() < gameState.nExplicitRatio;
	return gameState.bExplicitNow
}

function toggleExplicit(val) {
	setExplicit(val);
	alert("Explicit content is " + (gameState.bExplicit ? "on" : "off"))
}

function setExplicit(val) {
	gameState.bExplicitNow = undefined;
	gameState.bExplicit = val === undefined ? !gameState.bExplicit : val
}

function isBritish() {
	return sCurrency === "\u00a3"
}

function getCurrencyName() {
	return isBritish() ? "pounds" : "dollars"
}

function getProsecutor() {
	return isBritish() ? "Crown Prosecutor" : "District Attorney"
}

function getOfficer(upr) {
	if (upr !== false) return isBritish() ? "P.C." : "Officer";
	return isBritish() ? "constable" : "officer"
}

function getPoliceChief() {
	return isBritish() ? "Chief Inspector" : "Police Chief"
}

function getShopStore(upr) {
	return upr === true ? isBritish() ? "Shop" : "Store" : isBritish() ? "shop" : "store"
}

function toggleLocale() {
	sCurrency = isBritish() ? "$" : "\u00a3";
	updateLocale();
	dispPlace();
	alert("Glenvale is now in the " + (isBritish() ? "UK" : "US"))
}

function updateLocale() {
	getBaseItemObj(22).image = isBritish() ? "moneyuk.png" : "moneyus.png"
}

function isMurderPath(bSoft) {
	if (bSoft === true) return perGates.checkFlag(1) && perGates.other == 600;
	return perGates.checkFlag(1)
}

function isCharmedPath() {
	return !perGates.checkFlag(1) && perGates.other != 700
}

function isGoodPath() {
	return perGates.checkFlag(8)
}

function isConspiracyPath() {
	return perGates.other == 700
}

function getPathName() {
	if (isConspiracyPath()) return "Conspiracy";
	if (isMurderPath(true)) return "Soft Murder";
	if (isMurderPath(false)) return "Hard Murder";
	if (isGoodPath()) return "Good Apprentice";
	return "Apprentice"
}

function togglePath() {
	if (isCharmedPath() && !isGoodPath()) perGates.setFlag(8);
	else if (isGoodPath()) {
		perGates.setFlag(8, false);
		perGates.other = 700
	} else if (isConspiracyPath()) {
		perGates.setFlag(8, false);
		perGates.other = 10;
		perGates.setFlag(1)
	} else if (isMurderPath(false) && perGates.other != 600) {
		perGates.other = 600;
		perGates.setFlag(1)
	} else {
		perGates.setFlag(1, false);
		perGates.other = 10
	}
}

function isBeasleyServant() {
	return perBeasley.extra[0] > 0
}

function getBeasleyServant() {
	return perBeasley.extra[0]
}

function setBeasleyServant(no) {
	perBeasley.extra[0] = no
}

function updatePath() {
	getBaseItemObj(4).image = isMurderPath() ? "UI/books/book2.png" : "UI/books/book1.png"
}

function isMainStoryComplete() {
	if (!(isDavyDefeated() || perDavy.checkFlag(6))) return false;
	if (!isDemonQuestDone()) return false;
	if (!isRitualComplete()) return false;
	if (!isCharmedBy("Tess") || !isCharmedBy("MrBeasley") || !isCharmedBy("Mayor") || !isCharmedBy("OfficerBatton") || !isCharmedBy("Gina") || !isCharmedBy("Victoria") || !isCharmedBy("Diane")) return false;
	findPerson("Jessica");
	if (per.place == 161 && per.getRivalry() != -1) return false;
	if (wherePerson("Miku") === 0) return false;
	return true
}

function DoRestart(nm) {
	if (sGender === "") {
		DoNewGame();
		return
	}
	if (nm === undefined && perYou !== undefined) nm = perYou.name;
	document.write(mdCache.getDocHead() + "<title>Mind Control Adventures - A Spell For All</title>" + '<link rel="stylesheet" type="text/css" href="' + getThemeFolder() + 'game.css">' + '<script type="text/javascript" src="Javascripts/compiled.js">\x3c/script>' + '<script type="text/javascript" src="Javascripts/Visions/visions.js">\x3c/script>' + '<script type="text/javascript" src="Javascripts/Visions/Explicit/visions.js">\x3c/script>' +
		'<script type="text/javascript" src="Javascripts/config.js">\x3c/script>' + "</head>" + '<body style="overflow-x:hidden" onload="StartThis()">' + '<script type="text/javascript">' + "function StartThis() {" + "initialiseGame();" + 'perYou.name="' + nm + '";sGender="' + sGender + '";setExplicit(' + isExplicit(true) + ');sAvatarFolder="' + sAvatarFolder + '";' + 'sCurrency="' + sCurrency + '";bCheating=' + bCheating + ";setRunes(" + isRunes() + ");setPuzzles(" + isPuzzles() + ");" + "gameState.nRightBarState=" + gameState.nRightBarState + ";gameState.nLeftBarState=" +
		gameState.nLeftBarState + ";nTheme=" + nTheme + ";gameState.bUseIcons=" + gameState.bUseIcons + ";" + "gameState.bAllPlaces=" + gameState.bAllPlaces + ";gameState.bAllowUndo=" + gameState.bAllowUndo + ";gameState.bInventoryPopup=" + gameState.bInventoryPopup + ";startGame();" + "}" + "\x3c/script>" + "</body>" + "</html>");
	document.close()
}

function addRestartLink(md) {
	addOptionLink(md, "Restart the Game", "DoRestart()");
	var sItem = document.getElementById("savelink");
	if (sItem !== undefined) sItem.style.display = "none";
	sItem = document.getElementById("qsavelink");
	if (sItem !== undefined) sItem.style.display = "none";
	if (gameState.bAllowUndo) addOptionLink(md, "Try again", "loadUnDo()")
}

function DoNewGame() {
	top.location = "index.html"
}

function startGame() {
	if (sGender == "LoadGame") {
		sGender = "";
		DoLoad()
	} else setTimeout(startGame2, 100)
}

function startGame2() {
	window.addEventListener("resize", updateLeftBar);
	updateLocale();
	if (gameState.bAllPlaces) {
		setPlaceKnown("SchoolField");
		setPlaceKnown("DuckPond");
		setPlaceKnown("TownHall");
		setPlaceKnown("Police Station");
		setPlaceKnown("Alley");
		setPlaceKnown("Museum");
		setPlaceKnown("ShoppingCenter");
		setPlaceKnown("Hotel");
		setPlaceKnown("PoliceStation");
		setPlaceKnown("Hospital");
		setPlaceKnown("WildRanges");
		setPlaceKnown("MechanicsShop");
		setPlaceKnown("RathdownRd");
		setPlaceKnown("CheriseRd");
		setPlaceKnown("AmaranthPl");
		setPlaceKnown("DervishRd");
		setPlaceKnown("TVStation");
		setPlaceKnown("Aquarium");
		setPlaceKnown("Park");
		setPlaceKnown("Church");
		setPlaceKnown("Graveyard");
		setPlaceFlag("Park", 4);
		setPlaceKnown("NewAgeStore");
		setPlaceKnown("CelesteRd");
		setPlaceKnown("HavenApartments")
	}
	if (isScreenSmall()) gameState.nLeftBarState = 2;
	showRightBar(-2);
	gotoPlace(1)
}

function DoReturn() {
	if (sGender === "") DoNewGame();
	else {
		showSideBars();
		dispPlace()
	}
}

function checkBitFlag(flg, nOffSet) {
	return (flg & 1 << nOffSet - 1) !== 0 ? true : false
}

function setBitFlag(flg, nOffSet, nVal) {
	nOffSet--;
	if (nVal !== false) return flg | 1 << nOffSet;
	else return flg & ~(1 << nOffSet)
}

function setQueryParams(qp) {
	sPlaceParams = qp === undefined ? "" : qp;
	sType = getQueryParam("type")
}

function addQueryParams(qp) {
	if (sPlaceParams === "") sPlaceParams = qp;
	else sPlaceParams = sPlaceParams + "&" + qp;
	sType = getQueryParam("type")
}

function getQueryParams(qs) {
	if (qs === undefined) qs = sPlaceParams;
	qs = qs.split("+").join(" ");
	var params = {};
	var tokens;
	var re = /[?&]?([^=]+)=([^&]*)/g;
	while (true) {
		tokens = re.exec(qs);
		if (!tokens) break;
		params[decodeURIComponent(tokens[1])] = decodeURIComponent(tokens[2])
	}
	return params
}

function getQueryParam(val, qs) {
	var param = getQueryParams(qs);
	if (param[val] !== undefined) return param[val];
	return ""
}

function get_browser_info() {
	var ua = navigator.userAgent;
	var tem;
	var M = ua.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i) || [];
	if (/trident/i.test(M[1])) {
		tem = /\brv[ :]+(\d+)/g.exec(ua) || [];
		return {
			name: "IE ",
			version: tem[1] || ""
		}
	}
	if (M[1] === "Chrome") {
		tem = ua.match(/\bOPR\/(\d+)/);
		if (tem !== null) return {
			name: "Opera",
			version: tem[1]
		}
	}
	M = M[2] ? [M[1], M[2]] : [navigator.appName, navigator.appVersion, "-?"];
	tem = ua.match(/version\/(\d+)/i);
	if (tem !== null) M.splice(1, 1, tem[1]);
	return {
		name: M[0],
		version: M[1]
	}
}

function isChrome() {
	var isChromium = window.chrome;
	return isChromium !== null && isChromium !== undefined && window.navigator.vendor === "Google Inc."
}

function isOpera() {
	var bw = get_browser_info();
	return bw.name === "Opera" || bw.name == "OPR"
}

function getIEVersion() {
	var match = navigator.userAgent.match(/(?:MSIE |Trident\/.*; rv:)(\d+)/);
	return match ? parseInt(match[1]) : undefined
}

function isMicrosoftEdge() {
	return /Edge\//i.test(navigator.userAgent)
}

function isSafari() {
	return Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor") > 0
}

function redrawElement(el) {
	if (el === undefined || el === null) return;
	if (!(isOpera() || isChrome())) return;
	if (el.style === undefined) return;
	el.style.display = "none";
	var a = el.offsetHeight;
	el.style.display = "block";
	el.style.webkitTransform = "scale(1)"
}
if (!String.prototype.trim)(function() {
	var rtrim = /^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;
	String.prototype.trim = function() {
		return this.replace(rtrim, "")
	}
})();

function hideCol(tblid, col) {
	var tbl = document.getElementById(tblid);
	if (tbl === null) return;
	if (col < 0 || col >= tbl.rows[0].cells.length) return;
	for (var i = 0; i < tbl.rows.length; i++)
		for (var j = 0; j < tbl.rows[i].cells.length; j++) {
			tbl.rows[i].cells[j].style.display = "";
			if (j == col) tbl.rows[i].cells[j].style.display = "none"
		}
	redrawElement(tbl)
}

function getWidth(bd) {
	var win = bd.defaultView || bd.parentWindow;
	var e = bd.documentElement;
	var g = bd.getElementsByTagName("body")[0];
	return win.innerWidth || e.clientWidth || g.clientWidth
}

function getHeight(bd) {
	var win = bd.defaultView || bd.parentWindow;
	var e = bd.documentElement;
	var g = bd.getElementsByTagName("body")[0];
	return win.innerHeight || e.clientHeight || g.clientHeight
}

function isScreenSmall() {
	return gameState.nWidth < 480
}

function capitalize(s) {
	return s.charAt(0).toUpperCase() + s.slice(1)
}

function capitalizeFirstLetter(s) {
	return s.charAt(0).toUpperCase() + s.slice(1)
}

function updateCSS() {
	var allsuspects = document.getElementsByTagName("link");
	for (var i = allsuspects.length; i >= 0; i--)
		if (allsuspects[i] && allsuspects[i].getAttribute("href") !== null) {
			allsuspects[i].href = getThemeFolder() + "game.css";
			break
		}
	redrawElement(document.body)
}

function changeBgImage(image, element) {
	element.style.backgroundImage = "url('" + image + "')"
}

function stopRKey(evt) {
	evt = evt ? evt : event ? event : null;
	var node = evt.target ? evt.target : evt.srcElement ? evt.srcElement : null;
	if (evt.keyCode == 13 && node.type == "text") return false
}

function MakeArray(n, fill) {
	this.length = n;
	for (var i = 1; i <= n; i++) this[i] = fill;
	return this
}

function dec2bin(dec) {
	return (dec >>> 0).toString(2)
}

function byte2Hex(n) {
	var nybHexString = "0123456789ABCDEF";
	return String(nybHexString.substr(n >> 4 & 15, 1)) + nybHexString.substr(n & 15, 1)
}
Object.prototype.clone = function() {
	var i, newObj = this instanceof Array ? [] : {};
	for (i in this) {
		if (i === "clone") continue;
		if (this[i] && typeof this[i] === "object") newObj[i] = this[i].clone();
		else newObj[i] = this[i]
	}
	return newObj
};
var gameState;
var arHexagrams;
var sType;
var sAvatarFolder = "JamesDeen";
var sMaleFolderList = "JamesDeen,MilesPride,Tommy,Billy,SammyCase,BrentCorrigan";
var sFemaleFolderList = "Eufrat,TeenKasia,TaylorSands,Beata,Arianna,Natasha";

function initialiseGame() {
	gameState = new GameStatus;
	nMaxSaves = 10;
	arHexagrams = [];
	arSMSImages = [];
	sPossess = "";
	sType = "";
	nUnreadSMS = 0;
	nPhoneWallpapers = 6;
	sPhoneImage = "";
	arSMS = [];
	arPhotos = [];
	sMaleFolderList = "JamesDeen,MilesPride,Tommy,Billy,SammyCase,BrentCorrigan";
	sFemaleFolderList = "Eufrat,TeenKasia,TaylorSands,Beata,Arianna,Natasha";
	initialiseTime();
	initialisePeople();
	initialisePlaces();
	setConfig();
	initialiseItems();
	updatePath()
}
var oBaseItems = {
	1: {
		startingname: "Mr. Beasley's Paper",
		name: "",
		startingplace: 10,
		image: "dossier.jpg",
		getDescription: function() {
			return "It's the lecture on Carl Kurndorf, describing the events and book of Sacred Disciplines of Control. This could help with your research.<br>Maybe you should go and study it somewhere you can look up some of the references in the paper."
		}
	},
	2: {
		startingname: "Your phone",
		name: "",
		startingplace: "You",
		image: "phone.jpg",
		getDescription: function() {
			return "It's your mobile phone, not particularly high-end but it is adequate for basic apps and making calls. It is not connected to the web, darn it!"
		}
	},
	3: {
		startingplace: 13,
		startingname: "Kate's address",
		name: "",
		image: "note.jpg"
	},
	4: {
		startingplace: 0,
		startingname: "Book",
		name: "",
		image: "book1.png"
	},
	5: {
		startingplace: 0,
		startingname: "Old stone",
		name: "",
		image: "stone1.png",
		getDescription: function() {
			return "It looks like a very old sculpture."
		}
	},
	6: {
		startingplace: 0,
		startingname: "Rustic stone",
		name: "",
		image: "stone2.jpg",
		getDescription: function() {
			return "It looks like a very old sculpture."
		}
	},
	7: {
		startingplace: 0,
		startingname: "Robbins address",
		name: "",
		image: "note.jpg",
		getDescription: function() {
			return "<i>Mr. Beasley,<br><br>You are correct about the magic spell. I have used it on some of the people in my neighborhood and they are head over heels in love with me. I am keeping the code in my room at my house for safe keeping and heading out to find more magic artifacts.  Perhaps I'll have one of my new <i>friends</i> help me look.<br><br>Thank you,<br>Davy</i>"
		}
	},
	8: {
		startingplace: 0,
		startingname: "Envelope",
		name: "",
		image: "envelope.jpg",
		getDescription: function() {
			return "<i>Mr. Beasley,<br><br>You are correct about the magic spell. I have used it on some of the people in my neighborhood and they are head over heels in love with me. I am keeping the code in my room at my house for safe keeping and heading out to find more magic artifacts.  Perhaps I'll have one of my new <i>friends</i> help me look.<br><br>Thank you,<br>Davy</i>"
		}
	},
	9: {
		startingplace: 0,
		startingname: "Police Pistol",
		name: "",
		image: "gun.jpg",
		getDescription: function() {
			return "A loaded police pistol."
		}
	},
	10: {
		startingplace: 0,
		name: "",
		startingname: "Unlife Enspelled"
	},
	11: {
		startingplace: 0,
		name: "",
		startingname: "Pass"
	},
	12: {
		startingplace: 0,
		name: "",
		startingname: "Wealth"
	},
	13: {
		startingplace: 0,
		place: 0,
		name: "",
		startingname: "Teleport"
	},
	14: {
		startingplace: 0,
		name: "",
		startingname: "Charm"
	},
	15: {
		startingplace: 0,
		name: "",
		startingname: "Clairvoyance"
	},
	16: {
		startingplace: 0,
		name: "",
		startingname: "Possession"
	},
	17: {
		startingplace: 0,
		name: "",
		startingname: "Invisibility"
	},
	18: {
		startingplace: 0,
		name: "",
		startingname: "Transform"
	},
	19: {
		startingplace: 0,
		name: "",
		startingname: "Drain"
	},
	20: {
		startingplace: 0,
		name: "",
		startingname: "Unknown Spell"
	},
	21: {
		startingplace: 0,
		startingname: "Blue Key",
		name: "",
		image: "bluekey.jpg",
		getDescription: function() {
			return "A key with a pentacle engraved on the top."
		}
	},
	22: {
		startingplace: 0,
		startingname: "Money",
		name: "",
		image: "",
		getDescription: function() {
			return sCurrency + "10.00 is not going to get you very far."
		}
	},
	23: {
		startingplace: 0,
		startingname: "Hotel Plans",
		name: "",
		image: "hotelplans.jpg",
		getDescription: function() {
			return "The Broken Inn Hotel is comprised of two stories with a bar, lobby, rooms and a cellar. Entry is gained by the front entrance with the cellar entry leading from the bar area."
		}
	},
	24: {
		startingplace: 0,
		startingname: "Gold Stone",
		name: "",
		image: "stone3.png",
		getDescription: function() {
			return "An gold sculpture. Possibly magical."
		}
	},
	25: {
		startingplace: 202,
		startingname: "Wooden box",
		name: "",
		image: "woodenbox.jpg",
		getDescription: function() {
			var s = "A bound wooden box, simply decorated, with an old metal clasp.</p><p>The box is currently <b>";
			if (!perYou.checkFlag(6)) return s + "closed</b>.";
			else return s + "open</b>."
		}
	},
	26: {
		startingplace: 0,
		startingname: "S\u00e9ance Article",
		name: "",
		image: "seancearticle.jpg",
		getDescription: function() {
			return "Seances are used to summon the spirits from the other side.</p><p>Two people of magic: witches or warlocks, along with an innocent, must conduct the ritual. It is rumoured that seances need a great deal of magic power to work."
		}
	},
	27: {
		startingplace: 0,
		startingname: "Letter of Credit",
		name: "",
		image: "letterofcredit.jpg",
		getDescription: function() {
			return perGates.getPersonName() + "'s seal of approval. You can use this to be advanced some money from " + perGates.getPersonName() + "' bank."
		}
	},
	28: {
		startingplace: 0,
		startingname: "Paperweight",
		name: "",
		image: "paperweight.jpg"
	},
	29: {
		startingplace: 0,
		startingname: "Vase",
		name: "",
		image: "vase1.jpg",
		getDescription: function() {
			var perAbby = findPerson("Abby");
			if (perAbby.getQuestDragonGem() < 3) perAbby.setQuestDragonGem(3);
			return "A dragon vase"
		}
	},
	30: {
		startingplace: 195,
		startingname: "Shovel",
		name: "",
		image: "shovel.jpg",
		getDescription: function() {
			var s = "A hardy tool for made from plastic and some metal. By pressing the side you can make it collapse in a carry item.";
			if (whereItem(30) == 195) return s + "</p><p>Cost " + sCurrency + "15";
			else return s
		}
	},
	31: {
		startingplace: 0,
		startingname: "Whistle",
		name: "",
		image: "whistle.jpg",
		getDescription: function() {
			return "A silver whistle."
		}
	},
	32: {
		startingplace: 0,
		startingname: "Silver Ring",
		name: "",
		image: "ring1.png"
	},
	33: {
		startingplace: 0,
		startingname: "Blue Bottle",
		name: "",
		image: "bluebottle.jpg",
		pickup: function(per) {
			if (perDavy.getQuestBlueBottle() < 10) perDavy.setQuestBlueBottle(10)
		},
		getDescription: function() {
			var s = "A very old blue bottle with a stopper attached.";
			if (perDavy.getQuestBlueBottle() < 20) return s + " The inside smells fanitly of brimstone.</p>";
			else return s + " The swirling colors inside remind you of the power contained within.</p>"
		}
	},
	34: {
		startingplace: 0,
		startingname: "Blonde Lock",
		name: "",
		image: "lock-of-hair-blonde.jpg",
		getDescription: function() {
			return "A lock of blonde hair."
		}
	},
	35: {
		startingplace: 0,
		startingname: "Dragon Gem",
		name: "",
		image: "gem1.jpg"
	},
	36: {
		startingplace: 68,
		startingname: "Letter",
		name: "",
		image: "letter.jpg",
		getDescription: function() {
			return "<i>Gates,</p><p>I know what you have and take warning. Deliver it to me tonight or pay the consequences.</p><p>Davy Robbins</i>"
		}
	},
	37: {
		startingplace: 0,
		startingname: "String",
		name: "",
		image: "string.jpg",
		pickup: function(per) {
			if (perYou.getQuestRustyKey() < 1) perYou.setQuestRustyKey(1)
		},
		getDescription: function() {
			if (whereItem(38) == 1E3) return "A long thread, with a magnet tied to one end.";
			else return "A long thread, useful for tying things."
		}
	},
	38: {
		startingplace: 289,
		startingname: "Magnet",
		name: "",
		image: "magnet.jpg",
		pickup: function(per) {
			if (perYou.getQuestRustyKey() == 900) perYou.setQuestRustyKey(6)
		},
		getDescription: function() {
			return "A small magnet. What could you use it for?"
		}
	},
	39: {
		startingplace: 0,
		startingname: "Rusty key",
		name: "",
		image: "rustykey.jpg",
		getDescription: function() {
			return "Hrm.  An old key.  Wonder what this is good for..."
		}
	},
	40: {
		startingplace: 0,
		startingname: "Bottle of Wine",
		name: "",
		image: "wine.jpg",
		getDescription: function() {
			return "An Australian vintage shiraz wine. The label says 1903, that was a very good year"
		}
	},
	41: {
		startingplace: 0,
		startingname: "Aftane",
		name: "",
		image: "talisman.jpg",
		getDescription: function() {
			return "A powerful artifact against the dead. Use it wisely."
		}
	},
	42: {
		startingplace: 0,
		startingname: "Gina's Address",
		name: "",
		image: "note.jpg"
	},
	43: {
		startingplace: "Gina",
		name: "",
		startingname: "Heirloom Necklace",
		image: "talisman2.jpg",
		getDescription: function() {
			var s = "A very old and powerful magical necklace.  Most likely it was something handed down from generation to generation by the women of Gina's family.";
			if (!isPossess()) s += " Not anymore, of course.";
			return s
		}
	},
	44: {
		startingplace: 0,
		startingname: "Rosary",
		name: "",
		image: "rosary.jpg",
		getDescription: function() {
			return "This rosary used to belong to Mother Superior from the Lady of Our Heavenly Father."
		}
	},
	45: {
		startingplace: 0,
		startingname: "Strap-On",
		name: "",
		image: "Explicit/strap-on.jpg",
		getDescription: function() {
			return "A strap-on so you can fuck your lover. It has several alternate appendages."
		}
	},
	46: {
		startingplace: 0,
		startingname: "Pamela's Bracelet",
		name: "",
		image: "bracelet1.jpg",
		getDescription: function() {
			if (checkPersonFlag("Pamela", 11)) return '"Twin Souls" bracelet given to you by Pamela the Church groundskeeper. It u said to be some sort of defence, and has an unknown aura of power.';
			else if (checkPersonFlag("Pamela", 9)) return '"Twin Souls" bracelet given to you by Pamela the Church groundskeeper. It has an unknown aura of power.';
			else return "A bracelet given to you by Pamela the Church groundskeeper. It has an unknown aura of power."
		}
	},
	47: {
		startingplace: 252,
		startingname: "Bag",
		name: "",
		image: "bag.jpg",
		pickup: function(per) {
			per.MaxItems += 20
		},
		drop: function(per) {
			per.MaxItems -= 20
		},
		getDescription: function() {
			return "A large sports bag that allows you to carry a lot more!."
		}
	},
	48: {
		startingplace: 383,
		name: "",
		startingname: "Catholic Relic",
		image: "artifact2.jpg",
		pickup: function(per) {
			if (per.uid == "you") {
				var perD = findPerson("Desiree");
				if (perD.getQuestRelic() <
					50) perD.setQuestRelic(50);
				if (perJesse.getDemonPath() < 150) perJesse.setDemonPath(150)
			}
		},
		getDescription: function() {
			if (isDemonBound()) return "An ancient artifact of the catholic faith - the presence of the Demon <i>bound</i> within turning the surface crimson.</p><p>Whattaya know.  It worked.  Now what?";
			else {
				var s = "An ancient artifact of the catholic faith.  If you had actually done your research I'm sure you would have discovered that this was once worn by some Saint What's His Name...  Or something like that.</p><p> What you <b>do</b> know is that ";
				if (checkPersonFlag("Gypsy", 8)) return s + " it is powerful enough to exorcise a demon possessing an <i>innocent</i> and hold the demon within until you can think of something <i>else</i> to do with it.";
				else return s + " a demon wants it enough to ask you to go get it from a local church for it.  Then again... does it want it...  or <i>fear</i> it?"
			}
		}
	},
	49: {
		startingplace: 0,
		startingname: "Holy Water",
		name: "",
		image: "holywater.jpg",
		getDescription: function() {
			var s = "A bottle of Holy Water.  Useful for <i>purifying</i> things against the undead or more demonic elements.  This particular bottle has enough to anoint " +
				perYou.getHolyWaterUses() + " more item";
			if (perYou.getHolyWaterUses() > 1) return s + "s.";
			else return s + "."
		}
	},
	50: {
		startingplace: 0,
		startingname: "Salt Shaker",
		name: "",
		image: "salt1.jpg",
		getDescription: function() {
			return "A simple salt shaker.  The lid is a little loose.  Don't spill it."
		}
	},
	51: {
		startingplace: 0,
		startingname: "Ritual Chalice",
		name: "",
		image: "chalice1.jpg",
		getDescription: function() {
			return "A ritual chalice from the church.  There is still the faint hint of wine from the last service."
		}
	},
	52: {
		startingplace: 345,
		name: "",
		startingname: "Crystal",
		image: "quartz2.jpg",
		getDescription: function() {
			if (perKurndorf.getQuestRitual() < 200) return "A large quartz crystal.  Pretty in its own right, but potentially useful if you know what to do with it.  Otherwise its just a big paperweight.";
			else return "A large quartz crystal.</p><p>  It seems to pulse with a dark light, proof that the spirit of Kurndorf still lies trapped within."
		}
	},
	53: {
		startingplace: 0,
		startingname: "Silver Dagger",
		name: "",
		image: "dagger.jpg",
		getDescription: function() {
			return "A silver dagger.  Although it has a sharp edge I wouldn't count on it in a fight."
		}
	},
	54: {
		startingplace: 345,
		startingname: "Candles",
		name: "",
		image: "candles1.jpg",
		getDescription: function() {
			return "A few beeswax candles.  They'll burn long and hot, with a subtle hint of honey. How nice."
		}
	},
	55: {
		startingplace: 195,
		startingname: "Scissors",
		name: "",
		image: "scissors1.jpg",
		getDescription: function() {
			return "A simple pair of cutting shears. Now remember, don't run with these in your hand!"
		}
	},
	56: {
		startingplace: 0,
		startingname: "Lock of <i>YOUR</i> hair",
		name: "",
		image: "lock-of-hair.jpg",
		getDescription: function() {
			return "A small cutting of hair.  If memory serves, this particular piece was once attached to <i>your</i> head."
		}
	},
	57: {
		startingplace: 0,
		startingname: "Skull",
		name: "",
		image: "skull1.jpg",
		getDescription: function() {
			var s = "An old skull, most likely very important to its prior owner for a time.</p>You have skulls from:</p><p>";
			if (perKurndorf.checkFlag(1)) s += " ~ Kurndorf's Crypt";
			if (perKurndorf.checkFlag(2)) s += " ~ the Graveyard";
			if (perKurndorf.checkFlag(3)) s += " ~ the Catacombs";
			return s
		}
	},
	58: {
		startingplace: 0,
		startingname: "Hemlock",
		name: "",
		image: "hemlock.jpg",
		getDescription: function() {
			return "A piece of Poison Hemlock, nasty-tasting in small doses and quite deadly in large ones."
		}
	},
	59: {
		startingplace: 0,
		startingname: "Chalk",
		name: "",
		image: "chalk.jpg",
		getDescription: function() {
			return "A few sticks of white chalk.  Good for drawing things on chalkboards... or stone floors."
		}
	},
	60: {
		startingplace: 0,
		startingname: "Hypnosis Book",
		name: "",
		image: "UI/books/hypnosisbook.jpg",
		getDescription: function() {
			return "A textbook on the techniques of hypnosis. A large but well illustrated book, a good few hours read!"
		}
	},
	61: {
		startingplace: 0,
		startingname: "Brass Key",
		name: "",
		image: "brasskey.jpg",
		getDescription: function() {
			return "A simple brass key."
		}
	},
	62: {
		startingplace: 0,
		startingname: "Garlic",
		name: "",
		image: "garlic.jpg",
		getDescription: function() {
			return "A string of garlic bulbs."
		}
	},
	63: {
		startingplace: 0,
		startingname: "Camryn's Pendant",
		name: "",
		image: "heartpendant.jpg",
		getDescription: function() {
			return "A pendant owned by Camryn"
		}
	},
	64: {
		startingplace: 0,
		startingname: "Crystal Ring",
		name: "",
		image: "crystalring.jpg",
		getDescription: function() {
			var s = "A ring made from quartz crystal, supposedly once owned by Kurndorf";
			if (wherePerson("Ghost") == -64) s += ", it is glowing gently and you can feel the presence of Keana.";
			else s += ".";
			return s
		}
	},
	65: {
		startingplace: 0,
		startingname: "Stakes",
		name: "",
		image: "stakes.jpg",
		getDescription: function() {
			return "A few prepared hawthorn wood stakes."
		}
	},
	66: {
		startingplace: 0,
		startingname: "Suitcase",
		name: "",
		image: "suitcase.jpg",
		getDescription: function() {
			return "Various Items Mom asked you to bring to the TV station. Better hurry, these are quite heavy."
		}
	},
	67: {
		startingplace: 0,
		startingname: "Gabby's Necklace",
		name: "",
		image: "gabbynecklace.png",
		getDescription: function() {
			return "Gabby's Necklace, a psychometry trinket made originally by Kurndorf, passed down to Gabby though her family."
		}
	}
};

function getBaseItemObj(no) {
	if (oBaseItems.hasOwnProperty(no + "")) return oBaseItems[no + ""];
	return undefined
}

function getItemNo(nm) {
	nm = nm.split(" ").join("").split("'").join("").toLowerCase().trim();
	var itemlist = Object.getOwnPropertyNames(oBaseItems);
	var itm;
	for (var i = 0, ie = itemlist.length; i < ie; i++) {
		itm = oBaseItems[itemlist[i]];
		if (itm.startingname === undefined) continue;
		if (itm.startingname.split(" ").join("").split("'").join("").toLowerCase().trim() == nm) return parseInt(itemlist[i], 10)
	}
	return 0
}

function getItemName(no) {
	if (typeof no == "string") no = getItemNo(no);
	var itm = getBaseItemObj(no);
	if (itm !== undefined) return itm.name;
	return ""
}

function setItemName(no, nm) {
	if (typeof no == "string") no = getItemNo(no);
	var itm = getBaseItemObj(no);
	if (itm !== undefined) itm.name = nm
}

function OutsideItem(itm, plc) {
	this.item = itm;
	this.place = plc
}

function whereItem(no) {
	if (typeof no == "string") no = getItemNo(no);
	if (no < 1) return 1;
	var fi = perYourBody.FindItem(no);
	if (fi > 0) return fi * -1;
	for (var i = 0, ie = T.length; i < ie; i++)
		if (T[i].item == no) return T[i].place;
	return 0
}

function isItemHere(no, plc) {
	if (typeof no == "string") no = getItemNo(no);
	if (no < 1) return false;
	if (plc === undefined) plc = Place;
	for (var i = 0, ie = T.length; i < ie; i++)
		if (T[i].item == no)
			if (T[i].place == plc) return true;
	return false
}

function isItemNotHere(no, plc) {
	if (typeof no == "string") no = getItemNo(no);
	if (no < 1) return true;
	if (perYourBody.FindItem(no) !== 0) return false;
	if (plc === undefined) plc = Place;
	for (var i = 0, ie = T.length; i < ie; i++)
		if (T[i].item == no) return T[i].place !== plc;
	return true
}

function PlaceI(no, at) {
	var ret = true;
	if (typeof no == "string") no = getItemNo(no);
	if (no < 1) return ret;
	if (typeof at == "string") {
		var perTo = findPerson(at);
		ret = perTo.AddItem(no);
		at = 0
	}
	if (at === undefined) at = Place;
	if (at !== 0) T.push(new OutsideItem(no, at));
	else
		for (var i = 0, ie = T.length; i < ie; i++)
			if (T[i].item == no && T[i].place == Place) {
				T.splice(i, 1);
				break
			}
	return ret
}

function moveItem(no, to, frm) {
	if (typeof no == "string") no = getItemNo(no);
	if (no < 1) return;
	var at = 0;
	for (var i = 0, ie = T.length; i < ie; i++)
		if (T[i].item == no) {
			at = T[i].place;
			break
		}
	if (frm !== undefined)
		if (at != frm && at !== 0 && at !== 1E3) return;
	if (to === undefined) to = Place;
	for (i = 0, ie = T.length; i < ie; i++)
		if (T[i].item == no && T[i].place == at) {
			T.splice(i, 1);
			break
		}
	PlaceI(no, to)
}

function removeItemSL(no) {
	if (no >= 0 && no < T.length) T.splice(no, 1)
}

function createMenu() {
	var no = createMenu.arguments[0];
	var s = no + "";
	if (no < 10) s = "0" + s + "";
	var a1 = '<a draggable="false" href="javascript:HandleItem(' + no + ",";
	var a2 = ',false)">';
	var itm = getBaseItemObj(no);
	var str = "";
	if (itm !== undefined) {
		str = '<img draggable="false" style="float:right;margin-right:10%;max-width:80%;max-height: 80" src="';
		if (itm.image.indexOf("Images/") == -1 && itm.image.indexOf("UI/") == -1) str += "Images/Items/";
		str += itm.image + '" height="100" alt="' + itm.image + '"/>'
	}
	for (var i = 1; i < createMenu.arguments.length; i++) {
		var a =
			createMenu.arguments[i];
		if (a == 1) str += a1 + 1 + a2 + "Examine</a>";
		else if (a == 2) str += " " + a1 + 2 + a2 + "Use</a>";
		else if (a == 3) str += " " + a1 + 3 + a2 + "Give</a>";
		else if (a == 4) str += " " + a1 + 4 + a2 + "Pick&nbsp;up</a>";
		else if (a == 5) str += " " + a1 + 5 + a2 + "Drop</a>";
		else if (a == 6) str += " " + a1 + 6 + a2 + "Buy</a>"
	}
	return str
}

function getItemsHere() {
	var found = 0;
	var str = "";
	if (Place == 436 && sType === "" || Place == 249 && sType == "egypt") {
		str = '<b>Things here:</b><span style="font-size:small"><div style="clear:both;text-align:center;"><b>Painting</b><br><img draggable="false" style="float:right;margin-right:10%;max-width:80%;max-height: 80" src="Images/amyancestor1.jpg" height="100" alt="Painting"/><br><a href="javascript:examinePainting()">Examine</a></div>';
		found++
	}
	for (var i = 0, ie = T.length; i < ie; i++)
		if (T[i].place == Place) {
			found++;
			if (found ==
				1) str = '<b>Things here:</b><span style="font-size:small"><div style="clear:both;text-align:center">';
			else str += '<div style="clear:both;text-align:center"><br>';
			str += "<b>" + getItemName(T[i].item) + "</b><br>" + createMenu(T[i].item, 1, 4) + "</div>"
		}
	if (found > 0) str += "</span>";
	return str
}

function ShowItems() {
	var s = getItemsHere();
	if (s === "") return;
	var md = mdCache;
	AddRightColumn(md);
	md.write('<div id="itemshere" style="text-align:center">' + s + "</div>")
}

function reShowItems() {
	var md = document;
	var mi = md.getElementById("itemshere");
	if (mi !== undefined && mi !== null) {
		var s = getItemsHere();
		if (s !== "") mi.innerHTML = s;
		else if (!gameState.bPeopleCol) {
			mi.innerHTML = "";
			hideCol("maintable", 2)
		}
	}
}

function showSpellList(shw) {
	var lst = document.getElementById("spelllist");
	if (lst) lst.style.display = shw
}

function getItemLinks(no, nt) {
	if (!nt) nt = nTheme;
	var itm = perYou.getInventoryItem(no);
	var st = isScreenSmall() ? ";float:left" : ";float:right";
	if (perYou.getInventoryItem(no) >= 10 && perYou.getInventoryItem(no) <= 20) {
		if (gameState.bUseIcons) {
			if (itm == 16 && isPossess()) return '<a href="javascript:Dispossession()"><img class="image-hover-highlight" src="' + getThemeFolderI(nt) + 'delete.png" width="20px" style="margin-right:5px' + st + '" title="End the Spell" alt="End the Spell"></a>';
			else if (isScreenSmall()) return '<a href="javascript:HandleItem(' +
				no + ',1,true,true)"><img class="image-hover-highlight" src="' + getThemeFolderI(nt) + 'information.png" width="20px" style="margin-right:2px' + st + '" title="Review" alt="Review"></a>' + '<a href="javascript:HandleItem(' + no + ',2,true,true)"><img class="image-hover-highlight" src="' + getThemeFolderI(nt) + 'mana.png" width="20px" style="margin-right:5px' + st + '" title="Cast" alt="Cast"></a>';
			return '<a href="javascript:HandleItem(' + no + ',2,true,true)"><img class="image-hover-highlight" src="' + getThemeFolderI(nt) + 'mana.png" width="20px" style="margin-right:5px' +
				st + '" title="Cast" alt="Cast"></a>' + '<a href="javascript:HandleItem(' + no + ',1,true,true)"><img class="image-hover-highlight" src="' + getThemeFolderI(nt) + 'information.png" width="20px" style="margin-right:2px' + st + '" title="Review" alt="Review"></a>'
		}
		if (perYou.getInventoryItem(no) == 16 && isPossess()) return '<a href="javascript:Dispossession()">End the Spell</a>';
		else return '<a href="javascript:HandleItem(' + no + ',2,true,true)">Cast</a> ' + '<a href="javascript:HandleItem(' + no + ',1,true,true)">Review</a>'
	}
	if (gameState.bUseIcons) {
		if (isScreenSmall()) return '<a href="javascript:HandleItem(' +
			no + ',1)"><img class="image-hover-highlight" src="' + getThemeFolderI(nt) + 'examine.png" width="20px" style="margin-right:2px' + st + '" title="Examine" alt="Examine"></a>' + '<a href="javascript:HandleItem(' + no + ',2)"><img class="image-hover-highlight" src="' + getThemeFolderI(nt) + 'use.png" width="20px" style="margin-right:2px' + st + '" title="' + (itm == 4 ? "Open" : "Use") + '" alt="' + (itm == 4 ? "Open" : "Use") + '"></a>' + '<a href="javascript:HandleItem(' + no + ',3)"><img class="image-hover-highlight" src="' + getThemeFolderI(nt) +
			'give.png" width="20px" style="margin-right:2px' + st + '" title="Give" alt="Give"></a>' + '<a href="javascript:HandleItem(' + no + ',5)"><img class="image-hover-highlight" src="' + getThemeFolderI(nt) + 'drop.png" width="20px" style="margin-right:5px' + st + '" title="Drop" alt="Drop"></a>';
		return '<a href="javascript:HandleItem(' + no + ',5)"><img class="image-hover-highlight" src="' + getThemeFolderI(nt) + 'drop.png" width="20px" style="margin-right:5px' + st + '" title="Drop" alt="Drop"></a>' + '<a href="javascript:HandleItem(' +
			no + ',3)"><img class="image-hover-highlight" src="' + getThemeFolderI(nt) + 'give.png" width="20px" style="margin-right:2px' + st + '" title="Give" alt="Give"></a>' + '<a href="javascript:HandleItem(' + no + ',2)"><img class="image-hover-highlight" src="' + getThemeFolderI(nt) + 'use.png" width="20px" style="margin-right:2px' + st + '" title="' + (itm == 4 ? "Open" : "Use") + '" alt="' + (itm == 4 ? "Open" : "Use") + '"></a>' + '<a href="javascript:HandleItem(' + no + ',1)"><img class="image-hover-highlight" src="' + getThemeFolderI(nt) + 'examine.png" width="20px" style="margin-right:2px' +
			st + '" title="Examine" alt="Examine"></a>'
	}
	return '<a href="javascript:HandleItem(' + no + ',1)">Examine</a> ' + '<a href="javascript:HandleItem(' + no + ',2)">' + (itm == 4 ? "Open" : "Use") + "</a> " + '<a href="javascript:HandleItem(' + no + ',3)">Give</a> ' + '<a href="javascript:HandleItem(' + no + ',5)">Drop</a>'
}

function allowDropItem(ev) {
	ev.preventDefault()
}

function dragItem(ev) {
	ev.dataTransfer.setData("text", ev.target.id)
}

function dropItem(ev, target) {
	ev.preventDefault();
	if (ev.dataTransfer.getData("text").substr(0, 4) != "item") {
		ev.stopPropagation();
		return false
	}
	var idFrom = parseInt(ev.dataTransfer.getData("text").substr(4), 10);
	var idTo = parseInt(target.id.substr(4), 10);
	if (isNaN(idTo)) return;
	var i;
	if (idTo < idFrom)
		for (i = idFrom; i > idTo; i--) perYourBody.MoveIup(i);
	else
		for (i = idFrom; i < idTo; i++) perYourBody.MoveIdown(i);
	return false
}

function dropSpell(ev, target) {
	ev.preventDefault();
	if (ev.dataTransfer.getData("text").substr(0, 5) != "spell") {
		ev.stopPropagation();
		return false
	}
	var idFrom = parseInt(ev.dataTransfer.getData("text").substr(5), 10);
	var idTo = parseInt(target.id.substr(5), 10);
	if (isNaN(idTo)) return;
	var i;
	if (idTo < idFrom)
		for (i = idFrom; i > idTo; i--) perYourBody.MoveIup(i);
	else
		for (i = idFrom; i < idTo; i++) perYourBody.MoveIdown(i);
	return false
}

function getItemLine(i, bFirst, bLast, nt) {
	if (!nt) nt = nTheme;
	var acls = gameState.bInventoryPopup ? "white" : "black";
	var s;
	var no = perYourBody.getInventoryItem(i);
	if (gameState.bUseIcons) {
		s = '<div style="width:100%;display:table"><div ' + (no == 2 ? "" : 'id="item' + i + '" draggable="true" ondrop="dropItem(event,this)" ondragover="allowDropItem(event)" ondragstart="dragItem(event)" ') + 'style="clear:both;margin-left:5px;text-align:left;margin-bottom:-4px;display:table-cell;vertical-align:middle">' + '<b><a draggable="false" href="javascript:HandleItem(' +
			i + ',2)" class="' + (gameState.bInventoryPopup ? "itemtitlewhite" : "itemtitle") + '" style="text-decoration:none' + (gameState.nWidth < 800 ? "" : ";max-width:calc(100% - 95px);display:inline-block") + '"><span style="font-size:' + (no == 2 ? "1em" : "0.8em") + '">' + getItemName(no) + "</span></a>";
		if (gameState.nWidth < 800) s += '<br><span style="clear:both">';
		s += getItemLinks(i, nt);
		if (no == 2 && arSMS.length > 0) s += ' <a draggable="false" href="#" onclick="showRightBar(gameState.nRightBarState + 2,\'sms\')"><img class="image-hover-highlight" src="' +
			getThemeFolderI(nt) + 'smsinvent.png" style="height:1em' + (isScreenSmall() ? ";float:left" : "") + '"></a>';
		if (gameState.nWidth < 800) s += "</span>";
		s += "</b></div></div>"
	} else {
		s = "<table " + (no == 2 ? "" : 'id="item' + i + '" draggable="true" ondrop="dropItem(event,this)" ondragover="allowDropItem(event)" ondragstart="dragItem(event)" ') + 'style="width:100%"><tr><td style="width:5px">';
		if (!bFirst) s += '<a draggable="false" class="' + acls + '" href="javascript:perYourBody.MoveIup(' + i + ')" style="color:' + (nt === 0 ? "orange" : "blue") +
			';text-decoration:none">&#9650;</a> ';
		else s += '<span style="font-size:0.8em">&nbsp;</span>';
		s += '</td><td><div style="text-align:center;margin-bottom:-2px">' + '<b><a draggable="false" href="javascript:HandleItem(' + i + ',2)" class="' + (gameState.bInventoryPopup ? "itemtitlewhite" : "itemtitle") + '" style="text-decoration:none"><span style="font-size:' + (no == 2 ? "1em" : "0.8em") + '">' + getItemName(no) + "</a>";
		if (no == 2 && arSMS.length > 0) s += ' <a draggable="false" href="#" onclick="showRightBar(gameState.nRightBarState + 2,\'sms\')"><img class="image-hover-highlight" src="' +
			getThemeFolderI(nt) + 'smsinvent.png" style="height:1em"></a>';
		s += '</span></b></div></td><td style="width:5px">';
		if (!bLast) s += '<a draggable="false" class="' + acls + '" href="javascript:perYourBody.MoveIdown(' + i + ')" style="color:' + (nt === 0 ? "orange" : "blue") + ';text-decoration:none">&#9660;</a>';
		else s += '<span style="font-size:0.8em">&nbsp;</span>';
		s += '</td></tr></table><p style="font-size:0.8em;text-align:center;margin-top:-' + (no == 2 ? "2" : "3") + 'px;margin-bottom:-2px">' + getItemLinks(i, nt) + "</p>"
	}
	return s
}

function getInventoryContents(nState) {
	var nt = gameState.bInventoryPopup ? 1 : nTheme;
	if (!nState) nState = gameState.nRightBarState;
	var acls = gameState.bInventoryPopup ? "white" : "black";
	var s;
	var i;
	if (nState == 1) {
		if (!gameState.bInventoryPopup) s = '<span class="zoom-icon" style="position:absolute;top:0px;left:0px"><img draggable="false" style="cursor:pointer;" onclick="showRightBar(2)" src="' + getThemeFolderI(nt) + 'collapse.png" width="24" height="24" alt="Zoom" title="Hide your inventory"></span>' + '<img draggable="false" src="' +
			getThemeFolderI(nt) + 'bartitle.png" style="margin-left:20px;border-style:none;height:40px;margin-bottom:-0.75em;width:95%;width:calc(100% - 20px);" alt="Inventory:">';
		else s = "";
		if (perYourBody.NoItems + perYou.extra[3] !== 0) {
			var j = 0;
			i = perYourBody.FindItem(4);
			if (i > 0) {
				var cls = perYou.canUseExperience() ? " blink" : "";
				if (gameState.bUseIcons) {
					s += '<div style="margin-left:5px;text-align:left;margin-bottom:-4px">' + '<a class="booktitle' + cls + '" href="javascript:HandleItem(' + i + ',2)" style="text-decoration:none">' + "<b>" +
						getItemName(4);
					if (gameState.nWidth < 800) s += '</div><div style="clear:both">';
					s += getItemLinks(i, nt) + "</b></a></div>"
				} else s += '<table style="width:100%"><tr><td style="width:5px;vertical-align:top">' + '<span style="font-size:0.8em">&nbsp;</span>' + '</td><td style="vertical-align:top"><div style="text-align:center">' + '<a class="booktitle' + cls + '" href="javascript:HandleItem(' + i + ',2)" style="text-decoration:none">' + "<b>" + getItemName(4) + "</b></a>" + '</div></td><td style="width:5px;vertical-align:top"><span style="font-size:0.8em">&nbsp;</span>' +
					'</td></tr></table><p style="font-size:0.8em;text-align:center;margin-top:-5px;margin-bottom:0;">' + getItemLinks(i, nt) + "</p>";
				j++
			}
			var lastS = 0;
			for (i = 1; i <= perYou.NoItems; i++) {
				if (perYou.getInventoryItem(i) != 4 && (perYou.getInventoryItem(i) < 10 || perYou.getInventoryItem(i) > 20)) continue;
				lastS = i
			}
			for (i = 1; i <= perYou.NoItems; i++) {
				var no = perYou.getInventoryItem(i);
				if (no < 10 || no > 20) continue;
				if (gameState.bUseIcons) {
					s += '<div style="width:100%;display:table"><div style="clear:both;margin-left:5px;text-align:left;margin-bottom:-4px;display:table-cell;vertical-align:middle" id="spell' +
						i + '" draggable="true" ondrop="dropSpell(event,this)" ondragover="allowDropItem(event)" ondragstart="dragItem(event)"><b><a draggable="false" href="javascript:HandleItem(' + i + ',2)" style="text-decoration:none" ';
					if (no == 16 && isPossess()) s += 'class="possessspelltitle">' + getItemName(no) + " Spell</a></b>";
					else s += 'class="spelltitle">' + getItemName(no) + " Spell</a></b>";
					if (gameState.nWidth < 800) s += '</span><br><span style="clear:both">';
					s += getItemLinks(i, nt);
					s += "</span></b></div></div>"
				} else {
					s += '<table style="width:100%;padding:0" id="spell' +
						i + '" draggable="true" ondrop="dropSpell(event,this)" ondragover="allowDropItem(event)" ondragstart="dragItem(event)"><tr><td style="width:5px">';
					if (j > 1) s += '<a class="' + acls + '" href="javascript:perYou.MoveIup(' + i + ')" style="color:' + (nt === 0 ? "orange" : "blue") + ';text-decoration:none">&#9650;</a> ';
					else s += '<span style="font-size:0.8em">&nbsp;</span>';
					s += '</td><td><div style="text-align:center;margin-bottom:-2px"><b><a draggable="false" href="javascript:HandleItem(' + i + ',2)" style="text-decoration:none" ';
					if (no == 16 && isPossess()) s += 'class="possessspelltitle">' + getItemName(no) + " Spell</a></b>";
					else s += 'class="spelltitle">' + getItemName(no) + " Spell</a></b>";
					s += '</div></td><td style="width:5px">';
					if (i != lastS) s += '<a href="javascript:perYou.MoveIdown(' + i + ')" style="color:' + (nt === 0 ? "orange" : "blue") + ';text-decoration:none">&#9660;</a>';
					else s += '<span style="font-size:0.8em">&nbsp;</span>';
					s += '</td></tr></table><p style="font-size:0.8em;margin-top:-3px;margin-bottom:-2px;text-align:center;">';
					s += getItemLinks(i,
						nt) + "</p>"
				}
				j++
			}
			if (j > 0) s += '<hr style="clear:both;margin-bottom:' + (gameState.bUseIcons ? "0px" : "2px") + '">';
			var tj = j;
			for (i = 1; i <= perYourBody.NoItems; i++) {
				if (perYourBody.getInventoryItem(i) == 4 || perYourBody.getInventoryItem(i) > 9 && perYourBody.getInventoryItem(i) < 21) continue;
				lastS = i
			}
			i = perYourBody.FindItem(2);
			if (i > 0) {
				s += getItemLine(i, true, true, nt);
				j++
			}
			for (i = 1; i <= perYourBody.NoItems; i++) {
				if (perYourBody.getInventoryItem(i) == 2 || perYourBody.getInventoryItem(i) == 4 || perYourBody.getInventoryItem(i) > 9 && perYourBody.getInventoryItem(i) <
					21) continue;
				s += getItemLine(i, j <= tj, i == lastS, nt);
				j++
			}
		} else {
			s += '<p style="text-align:center;"><b>You are currently carrying absolutely nothing.</b></p> ';
			if (nMoney > 0) s += '<p style="text-align:center;">Aside from what little cash you have stashed in your pockets that is.</p>'
		}
		return s
	} else {
		s = '<span id="zoom-icon" style="top:5%"><img draggable="false" onclick="showRightBar(1)" src="data:image/gif;base64,R0lGODlhKAAoAOMKAKioqKmpqaqqqqurq6ysrLm5ubq6uru7u/39/f7+/v///////////////////////yH+EUNyZWF0ZWQgd2l0aCBHSU1QACH5BAEKAA8ALAAAAAAoACgAAAT+8Jkgqr046xzMO8JAbWR5BYMABqjpkuJothbLXuJrpqFc8zzdbOMTlooYpDFZQY2czaVrEGNRpcdaIKFQJG5R7OnU7fqUwmBvUFaI1OosJUCAvgXttcBZ3/tJMnEVeRlBaGE/eylUXF5XOTljOyGIbGWGFYs6KXMYKXlxnYKeI5ylFI0Jik0UPDQlIl5ts7RlXK87AbUKCF5cvbW4LrJdjcTGyAovQALJbQnGxbaU1LCITm1QYaOFpZSdeGVRrdTC3ThqhJlq5jiZJwBB6gMAPswbQa6R4V0/3u9ScuiCpmAONzEy1B1CWCEVIjE4fPhSlghiE0w1LOyz6AkgRw4jfs6E/JgRkI4WCy22QgGApIl431yCTFGgnUwRBSSk5NjhQQQAOw==" style="width:99%" height="24" alt="Open" style="cursor:pointer" title="Show your inventory"></span><br>';
		i = perYourBody.FindItem(2);
		if (i > 0) s += '<a draggable="false" onmouseover="showSpellList(\'none\')" href="javascript:HandleItem(' + i + ',2)"><img draggable="false" src="' + getThemeFolderI(nt) + (arSMS.length > 0 ? "phonesms" : "phone") + '.png" style="width:99%" title="' + (arSMS.length > 0 ? "SMS Available" : "Phone") + '" alt="Phone"></a><br>';
		i = perYourBody.FindItem(32);
		if (i > 0) s += '<a draggable="false" href="javascript:HandleItem(' + i + ',2)"><img draggable="false" src="' + getThemeFolderI(nt) + 'ring.png" style="width:99%" title="Silver Ring" alt="Ring"></a>';
		s += "<br><br>";
		i = perYourBody.FindItem(4);
		if (i > 0) s += '<a draggable="false" href="javascript:HandleItem(' + i + ',2)"><img draggable="false" src="' + getThemeFolderI(nt) + (perYou.canUseExperience() ? "bookred" : "book") + '.png" style="width:99%" title="Book" alt="Book"></a><br>';
		for (i = 1; i <= perYou.NoItems; i++) switch (perYou.getInventoryItem(i)) {
			case 10:
				s += '<a draggable="false" href="javascript:HandleItem(' + i + ',2,true,true)"><img draggable="false" src="' + getThemeFolderI(nt) + 'unlife.png" style="width:99%" title="Cast Unlife Enspelled" alt="Unlife"></a>';
				break;
			case 11:
				s += '<a draggable="false" href="javascript:HandleItem(' + i + ',2,true,true)"><img draggable="false" src="' + getThemeFolderI(nt) + 'pass.png" style="width:99%" title="Cast Pass" alt="Pass"></a>';
				break;
			case 12:
				s += '<a draggable="false" href="javascript:HandleItem(' + i + ',2,true,true)"><img draggable="false" src="' + getThemeFolderI(nt) + 'wealth.png" style="width:99%" title="Cast Wealth" alt="Wealth"></a>';
				break;
			case 13:
				s += '<a draggable="false" href="javascript:HandleItem(' + i + ',2,true,true)"><img draggable="false" src="' +
					getThemeFolderI(nt) + 'teleport.png" style="width:99%" title="Cast Teleport" alt="Teleport"></a>';
				break;
			case 14:
				s += '<a draggable="false" href="javascript:HandleItem(' + i + ',2,true,true)"><img draggable="false" src="' + getThemeFolderI(nt) + 'charm.png" style="width:99%" title="Cast Charm" alt="Charm"></a>';
				break;
			case 15:
				s += '<a draggable="false" href="javascript:HandleItem(' + i + ',2,true,true)"><img draggable="false" src="' + getThemeFolderI(nt) + 'clairvoyance.png" style="width:99%" title="Cast Clairvoyance" alt="Clairvoyance"></a>';
				break;
			case 16:
				if (isPossess()) s += '<a draggable="false" href="javascript:Dispossession()"><img draggable="false" src="' + getThemeFolderI(nt) + 'possess.png" style="width:99%" title="End the Possession" alt="Dispossess"></a>';
				else s += '<a draggable="false" href="javascript:HandleItem(' + i + ',2,true,true)"><img draggable="false" src="' + getThemeFolderI(nt) + 'possess.png" style="width:99%" title="Cast Possession" alt="Possess"></a>';
				break;
			case 17:
				s += '<a draggable="false" href="javascript:HandleItem(' + i + ',2,true,true)"><img draggable="false" src="' +
					getThemeFolderI(nt) + 'invisibility.png" style="width:99%" title="Cast Invisibility" alt="Invisibility"></a>';
				break;
			case 18:
				s += '<a draggable="false" href="javascript:HandleItem(' + i + ',2,true,true)"><img draggable="false" src="' + getThemeFolderI(nt) + 'transform.png" style="width:99%" title="Cast Transform" alt="Transform"></a>';
				break
		}
		return s + '<p style="text-align:center;line-height:0.8em"><b>' + perYou.NoItems + '</b><br><br>I<br>t<br>e<br>m<br></p><p style="text-align:center;line-height:0.8em"><b>&nbsp;I<br>&nbsp;n<br>&nbsp;v<br>&nbsp;e<br>&nbsp;n<br>&nbsp;t<br>&nbsp;o<br>&nbsp;r<br>&nbsp;y</b></p>'
	}
}

function HandleItem(isl, cmd, slot, bYou) {
	var no;
	if (slot === false) {
		no = isl;
		isl = undefined
	} else no = bYou === true ? perYou.Items[isl] : perYourBody.Items[isl];
	ClearComments();
	bChat = false;
	WriteCommentsHeader(!(no == 35 && cmd == 1));
	var nm;
	switch (no) {
		case 4:
			nm = "Sacred Disciplines of Control";
			break;
		case 38:
			nm = "Small Magnet";
			break;
		case 41:
			nm = "Aftane Of The Dead";
			break;
		default:
			nm = getItemName(no);
			break
	}
	var bSpell = no >= 10 && no < 21;
	var itm = getBaseItemObj(no);
	if (nm !== "" && !bSpell) addComments('<p style="margin-top:0em;margin-bottom:0.5em;font-size:large"><b>' +
		nm + "</b></p>");
	var ret = "default";
	var p;
	for (var i = 0, ie = arPeople.length; i < ie; i++) {
		p = arPeople[i];
		var rt = p.handleItem(no, cmd);
		if (rt !== "") {
			if (rt == "public") addComments("Don't cast the spell here. It is too public.");
			ret = rt;
			break
		}
	}
	if (ret === "default" && !bSpell && no != 2 && no != 25 && no != 56 && no != 46 && no < 60 || no == 66) ret = eval("CheckNo" + no + "(" + cmd + "," + isl + ")");
	if (ret === "default" || ret === "defaultnc") switch (cmd) {
		case 1:
			if (no >= 10 && no < 20) addComments(getSpellDescription(no));
			else if (itm.getDescription !== undefined) usingItem(no,
				itm.getDescription(), itm.image);
			break;
		case 2:
			if (no == 2) {
				ClearComments();
				showRightBar(gameState.nRightBarState + 2);
				ret = "nofooter";
				return
			} else if (no == 10) addComments("There are no living dead present to cast this on.");
			else if (no == 11) ret = CastingPassSpell();
			else if (no == 12) CastWealthSpell();
			else if (no == 13) ret = CastingTeleport();
			else if (no == 14) ret = CastingCharm();
			else if (no == 15) {
				ret = CastingClairvoyance();
				if (ret === undefined) ret = ""
			} else if (no == 16) CastPossession();
			else if (no == 17) CastInvisibility();
			else if (no ==
				18) addComments("You start to cast the spell, but nothing happens, no-one here is susceptible to it");
			else if (no == 60) ret = useItem60();
			else if (no == 65) ret = useItem65();
			else if (no == 67 && wherePerson("Mom") == 452 && Place == 452) {
				gotoPlace(Place, "type=momnecklace");
				ret = "nofooter";
				break
			} else if (ret !== "defaultnc") usingItem(no, "There is no way to use this here.", itm.image);
			break;
		case 3:
			usingItem(no, "Who would be interested in taking it?", itm.image);
			break;
		case 4:
			if (perYourBody.PutItem(no)) {
				if (ret !== "defaultnc")
					if (no ==
						2) usingItem(no, "You put your phone into your pocket.", itm.image);
					else usingItem(no, "You pick up the " + nm + " and put it in your bag.", itm.image);
				ret = "refresh"
			} else if (ret !== "defaultnc") usingItem(no, "You cannot pick up the " + nm + " you are carrying too much.", itm.image);
			break;
		case 5:
			if (Place == 46 || Place == 41) {
				perYourBody.DropItem(no, 41);
				if (ret !== "defaultnc") usingItem(no, "You drop the " + nm + " in your storage chest.", itm.image);
				ret = "refresh"
			} else if (ret !== "defaultnc") usingItem(no, "You shouldn't drop it, who knows when you're going to need it!",
				itm.image);
			break
	}
	if (ret !== "nofooterconverse" && ret !== "nofooter" && ret !== "nofooterrefresh") WriteCommentsFooter(bChat, bChatLeft);
	else if (ret == "nofooter" || ret == "nofooterrefresh") ClearComments();
	if (ret === "refresh" || ret == "nofooterrefresh") dispPlace();
	else reShowItems()
}

function usingItem(no, desc, img) {
	if (!desc) return;
	if (img === undefined) img = getBaseItemObj(no).image;
	if (img !== "") {
		addComments('<table style="width:100%"><tr><td style="vertical-align:top;width:20%;max-width:8vw"><img draggable="false" src="');
		if (img.indexOf("Images/") == -1 && img.indexOf("UI/") == -1) addComments("Images/Items/");
		addComments(img + '"style="width:95%;max-width:8vw" alt="' + img + '"></td><td style="vertical-align:top"><p style="margin-top:0.2em">' + desc + "</p></td></tr></table>")
	} else addComments(desc)
}

function examineItem(no, desc, img) {
	usingItem(no, desc, img)
}

function CheckNo1(cmd, isl) {
	if (cmd == 1) return "default";
	if (cmd == 2 || cmd == 3)
		if (Place == 8) {
			findPerson("Monique");
			if (per.other > 0 || per.isCharmedBy()) {
				perYourBody.DropItem(1, 0);
				per.other = 3;
				perYou.addExperience(1);
				usingItem(1, '"Thank you, ' + per.getYourNameFor() + ". Let me see whether it is in our database. Wow, what an amazing book! There is no known author and no published date. The database says that it is an ancient book of spells that was brought from the middle east hundreds of years ago. We don't have it here since it is now owned by a <b>" + perGates.getPersonName() +
					'</b>.<br><br>He lives in that large mansion on the far outskirts of town. I once went there to deliver some information he had requested and I had to take a <b>taxi</b> to get there and back"');
				return "refresh"
			} else addComments("Now that would be awfully rude, you haven't even introduced yourself to the girl yet.")
		} else if (cmd == 2) return "default";
	else usingItem(1, "You'd better keep it. It might come in handy later.");
	if (cmd == 4) {
		perYourBody.PutItem(1);
		if (perBeasley.checkFlag(14)) usingItem(1, "You slide the paper into your pocket. The topmost paper hangs out but it should be secure.");
		else {
			gotoPlace(Place, "type=pickupbeasleypaper");
			return "nofooter"
		}
	}
	if (cmd == 5)
		if (Place == 10) {
			perYourBody.DropItem(1);
			addComments("You put the paper back on the desk where you found it.");
			return "refresh"
		} else if (Place == 46 || Place == 41) {
		perYourBody.DropItem(1, 41);
		addComments("You throw the paper down in your storage chest.");
		return "refresh"
	} else return "default";
	return ""
}

function CheckNo3(cmd, isl) {
	if (cmd == 1 || cmd == 4) {
		if (perYourBody.FindItem(3) > 0) perYourBody.RemoveItem(3);
		else PlaceI(3, 0);
		if (!isPlaceKnown("GrangerHouse")) {
			addComments("<p>You now know Kate's address.</p>");
			setPlaceKnown("GrangerHouse");
			setPlaceKnown("Alley")
		}
		if (Place == 8) addComments("<p><i>Kate Granger<br>34 Yoolaroo Drive,<br>Glenvale</i></p>");
		else addComments("<p><i>Kate<br>Come on over whenever you get the time<br> 34 Yoolaroo Drive,<br>Glenvale</i></p>");
		return "refresh"
	}
}

function CheckNo4(cmd, isl) {
	var itm;
	if (cmd == 1) {
		itm = getBaseItemObj(4);
		addComments('<a draggable="false" href="javascript:ShowSpells();"><img draggable="false" src="' + itm.image + '" style="width:15%;border-style:none" alt="Book"></a></p><p>By: Dragi Yusovish<br>1854</p><p><i><span style="font-size:small">Click on the book for a list of spells...</span></i>');
		if (perYou.canUseExperience()) {
			addComments("</p><p>You notice the book is softly glowing. Opening the book you see some passages almost make sense now that you are more familiar with magic. You should research these passages, but you need help from someone more experienced with deciphering the codes of warlocks.");
			perYou.setFlag(11);
			return "refresh"
		}
	}
	if (cmd == 2)
		if (perYou.canUseExperience() && !perYou.checkFlag(11)) {
			itm = getBaseItemObj(4);
			addComments('<a draggable="false" href="javascript:ShowSpells();"><img draggable="false" src="' + itm.image + '" style="width:15%;border-style:none" alt="Book"></a></p><p>By: Dragi Yusovish<br>1854</p><p><i><span style="font-size:small">Click on the book for a list of spells...</span></i>');
			addComments("</p><p>You notice the book is softly glowing. Opening the book you see some passages almost make sense now that you are more familiar with magic. You should research these passages, but you need help from someone more experienced with deciphering the codes of warlocks.");
			perYou.setFlag(11);
			return "refresh"
		} else {
			ShowSpells();
			return "nofooter"
		}
	if (cmd == 3)
		if (Place == 11)
			if (isSpellKnown("Charm")) addComments("Do you really think that would be wise at this point?  Mr. Beasley, with the Book?  Perhaps you should hold on to it, if only to keep it from him.");
			else if (checkPersonFlag("MrBeasley", 6)) addComments("You have already made up your mind <b>not</b> to give him the book!");
	else dispPlace(71, "");
	else if (Place == 110)
		if (isCharmedBy("Mayor", "Davy") && (isBeasleyServant() || getBeasleyServant() ==
				999)) {
			addComments("You give the book to the mayor.");
			dispPlace(158, "")
		} else addComments("You shouldn't give away the greatest spell book in history.");
	else if (Place == 192) {
		if (getPersonOther("Vampyre") >= 60) addComments("You hand the Book to Sarah but she refuses saying that you need it now");
		else {
			perYourBody.DropItem(4, "Sarah");
			addComments("You give the book to Sarah.")
		}
		dispPlace(192, "")
	} else addComments("You shouldn't give away the greatest spell book in history.");
	if (cmd == 4)
		if (getPersonOther("Vampyre") >
			1 && Place == 192 && getPersonOther("Vampyre") != 100 && getPersonOther("Vampyre") != 60) {
			dispPlace(198, "book=take");
			return ""
		} else {
			if (!perYourBody.PutItem(4)) {
				addComments("You are overloaded and cannot carry the book");
				return "refesh"
			}
			itm = getBaseItemObj(4);
			perYou.completeQuest(4);
			if (Place == 19) {
				updatePath();
				perYou.addCorruption(3);
				var md = document;
				var cdiv = md.getElementById("commentdiv");
				if (cdiv) {
					cdiv.style.top = "5%";
					cdiv.style.maxHeight = "90%"
				}
				addComments('<img draggable="false" src="' + itm.image + '" style="float:right;width:15%;margin:0 0 0 5px" alt="Book">' +
					"<p>You pick up the book, the thing you have been obsessing about, the focus of your desires. In your hurry to possess it you forget that you have blood on your hands still and feel slimy stickiness as you touch the book. As you do the book seems to change in front of your eyes, the cover becomes redder as if stained with the blood of " + perGates.getPersonName() + ".</p>");
				if (perGates.other == 600) addComments("<p>You cannot but help think about the people who killed " + perGates.getPersonName() + " and tell yourself that you would never of gone that far...and keep telling yourself that.</p>");
				else addComments("<p>You keep thinking of the moment the gun went off, and you saw " + perGates.getPersonName() + " die. You tell yourself this was a horrible accident, you did not mean this to happen...and keep telling yourself that.</p>");
				addComments("<p>Now you have the book, you are troubled that you do not know what to do with it. From a brief look at it's contents it seems to be in a complex code, a mixture of runes, nonsensical text and ominous drawings. You are going to have to seek some help, avoiding people discovering what happened here.</p>" +
					"<p>You also know from your research that any secrets and spells you may learn from the Book require something called mana, the source of magic. You have no idea what this is, how to harness it or how to get it.</p>" + "<p>Nervously, you lift the heavy book and put it into your school bag.</p>")
			} else addComments("You lift the heavy book and put it into your school bag.");
			if (Place == 76 && getBeasleyServant() == 50) setBeasleyServant(999);
			return "refresh"
		}
	if (cmd == 5)
		if (Place == 19) addComments("There is no way you are going to leave it here!");
		else if (Place == 46 || Place == 41) {
		if (Place == 46) addComments("You place the book down on your side table");
		else addComments("You place the book in your storage chest");
		if (getPersonOther("MrBeasley") >= 3 && !perYou.checkFlag(7)) {
			perYou.setFlag(7);
			addComments(" and accidentally spill your rock collection. Among all of the rocks is a rather odd looking stone");
			PlaceI(5)
		} else addComments(".");
		perYourBody.DropItem(4, Place);
		return "refresh"
	} else addComments("You should not leave the book here. Someone else might find it.");
	return ""
}

function CheckNo5(cmd, isl) {
	if (cmd == 2) {
		if (Place == 26) {
			perYou.setFlag(10);
			var nm = perYou.checkFlag(20) ? 11 : 10;
			if (gameState.bAllowUndo) nm += 5;
			AddMana(nm);
			perYourBody.RemoveItemSL(isl);
			usingItem(5, "You twirl the old stone around in your hand.<br>It glows, warms, flashes then disintengrates to dust in your palm, leaving you with more power: " + nm + " mana points.");
			return "refresh"
		}
		usingItem(5, "You can't do anything with this useless piece of junk.");
		return ""
	}
	if (cmd == 3) {
		if (Place == 11 && !perYou.checkFlag(10)) {
			perYou.setFlag(10);
			usingItem(5,
				'Mr. Beasley looks at the stone and hands it back to you, after hesitating,</p><p>"Yes, that seems to be one of the stones of mana. You need to spin it on your hand at a special place, I suggest in the Wild Ranges.</p>')
		} else if (Place == 17)
			if (perGates.other == 10) {
				perYou.completeQuest(1);
				perGates.other = 14;
				usingItem(5, perGates.getPersonNameShort() + ' takes the stone and looks at it for a moment.  "Hmm. Yes.  This one will do nicely to get you started.  Good job, my ' + perYou.getSex() + '", he says smiling at you.</p><p>"You can use the stone to gain mana at the Wild Ranges, just use it this way", he shows you how to spin the stone in your hand and then returns it to you.</p><p>He gestures at the Book on the table, "It is time to learn your first spell my apprentice"');
				return "refresh"
			} else usingItem(5, '"Nice of you to offer, my ' + perYou.getSex() + ", but I'm sure you need this more than I,\" he says, not willing to take the stone from your hands.");
		else addComments("Nobody wants it.");
		return ""
	}
	return "default"
}

function CheckNo6(cmd, isl) {
	if (cmd == 2) {
		if (Place == 26) {
			var nm = perYou.checkFlag(20) ? 22 : 20;
			if (gameState.bAllowUndo) nm += 5;
			perYou.setFlag(10);
			AddMana(nm);
			perYourBody.RemoveItemSL(isl);
			usingItem(6, "You twirl the rustic stone around in your hand.<br>It glows, warms, flashes then disintengrates to dust in your palm leaving you with more power. " + nm + " mana points");
			return "refresh"
		} else usingItem(6, "You can't do anything with this useless piece of junk.");
		return ""
	}
	if (cmd == 3)
		if (Place == 11 && !perYou.checkFlag(10)) {
			perYou.setFlag(10);
			usingItem(6, 'Mr. Beasley looks at the stone and hands it back to you, after hesitating,</p><p>"Yes, that seems to be one of the stones of mana. You need to spin it on your hand at a special place, I suggest in the Wild Ranges.</p>');
			return ""
		} else if (Place == 17) {
		if (perGates.other == 10) {
			perYou.completeQuest(1);
			perGates.other = 14;
			usingItem(6, perGates.getPersonNameShort() + ' takes the stone and looks at it for a moment.  "Hmm. Yes.  This one will do nicely to get you started.  Good job, my ' + perYou.getSex() +
				'", he says smiling at you.</p><p>"You can use the stone to gain mana at the Wild Ranges, just use it this way", he shows you how to spin the stone in your hand and then returns it to you.</p><p>He gestures at the Book on the table, "It is time to learn your first spell my apprentice"');
			return "refresh"
		}
	} else {
		usingItem(6, '"Nice of you to offer, my ' + perYou.getSex() + ", but I'm sure you need this more than I,\" he says, not willing to take the stone from your hands.");
		return ""
	}
	return "default"
}

function CheckNo7(cmd, isl) {
	if (cmd == 1 || cmd == 4) {
		if (perYourBody.FindItem(7) > 0) perYourBody.RemoveItem(7);
		else PlaceI(7, 0);
		if (!isPlaceKnown("RobbinsHouse")) {
			addComments("<p>You now know the Robbinses' address.</p>");
			setPlaceKnown("RobbinsHouse");
			if (!isPlaceKnown("Alley")) setPlaceKnown("Alley")
		}
		addComments("<p><i>Robbins House<br><br> 36 Yoolaroo Drive,<br>Glenvale</i></p>");
		return "refresh"
	}
}

function CheckNo8(cmd, isl) {
	if (cmd == 3) {
		if (Place == 110 && isMurderPath()) {
			Converse("Mayor", 81E3);
			return "nofooterconverse"
		} else if (Place == 285 && !isMurderPath()) {
			Converse("Trial", 35);
			return "nofooterconverse"
		} else addComments("Nobody here wants it.");
		return ""
	}
	if (cmd == 4) {
		if (perYourBody.PutItem(8)) usingItem(8, "You put the envelope in your top pocket.");
		return "refresh"
	}
	return "default"
}

function CheckNo9(cmd, isl) {
	if (cmd == 1) return "default";
	if (cmd == 2)
		if (Place == 142) {
			ClearComments();
			setPersonOther("Anita", 900);
			PlaceI(21, 63);
			dispPlace(63, "type=shootanita", "You take the pistol out and shoot faster than Anita can think. She crumbles to the ground.");
			return "nofooterconverse"
		} else if (Place == 63 && sType == "jessepark" || Place == 375) dispPlace(Place, "type=threatenlegion1");
	else if (Place == 374) usingItem(9, "<p>Trying to shoot her in your <i>house</i> would be a very, very bad idea.</p>");
	else usingItem(9,
		"You can not use the pistol here.");
	if (cmd == 3) usingItem(9, "You shouldn't give away dangerous weapons.");
	if (cmd == 4) {
		if (perYourBody.PutItem(9)) usingItem(9, "You pick the pistol up and check it. It is fully loaded.");
		return "refresh"
	}
	if (cmd == 5)
		if (Place == 46 || Place == 41) {
			perYourBody.DropItem(9, 41);
			usingItem(9, "You hide the pistol in your storage chest.");
			return "refresh"
		} else usingItem(9, "You should not leave the pistol here. Someone else might use it!")
}

function CheckNo21(cmd, isl) {
	if (cmd == 2) {
		if (perYourBody.FindItem(25) === 0) usingItem(21, "You cannot use the key on anything here.");
		else {
			if (!perYou.checkFlag(6)) {
				usingItem(21, "You unlock and open the wooden box.");
				perYou.setFlag(6)
			} else {
				usingItem(21, "You close and lock the wooden box.");
				perYou.setFlag(6, false)
			}
			return "refresh"
		}
		return ""
	}
	if (cmd == 4) {
		if (perYourBody.PutItem(21)) usingItem(21, "You pick up the key and turn it over. It looks like it fits a small lock.");
		return "refresh"
	}
	return "default"
}

function CheckNo22(cmd, isl) {
	if (cmd == 4) {
		addComments("You pick the money up and put it into your " + (perYou.isMaleSex() ? "wallet." : "purse."));
		PlaceI(22, 0);
		AddCash(10);
		return "refresh"
	}
	return "default"
}

function CheckNo23(cmd, isl) {
	if (cmd == 2) {
		if (Place == 124) {
			setComments("");
			dispPlace(161, "type=useplans");
			return "nofooter"
		} else addComments("You look at the plans but there is little you can otherwise do with them here.");
		return ""
	}
	if (cmd == 3) {
		addComments("You shouldn't give away the plans. You might need them later on.");
		return ""
	}
	if (cmd == 4) {
		setPlaceFlag("Hotel", 4);
		if (Place == 46 || Place == 41) {
			if (perYourBody.PutItem(23)) addComments("You put the hotel plans into your bag.")
		} else if (perYourBody.PutItem(23)) addComments("Angela hands you the hotel plans");
		return "refresh"
	}
	return "default"
}

function CheckNo24(cmd, isl) {
	if (cmd == 2) {
		if (Place == 26) {
			var nm = perYou.checkFlag(20) ? 6 : 5;
			AddMana(nm);
			perYourBody.DropItem(24, 1);
			usingItem(24, "You twirl the gold stone around in your hand.<br>It glows, warms, flashes then disintengrates to dust in your palm leaving you with more power. " + nm + " mana points")
		} else usingItem(24, "You can't do anything with this useless piece of junk.");
		return ""
	}
	return "default"
}

function CheckNo26(cmd, isl) {
	if (cmd == 2) {
		if (Place == 193)
			if (getPersonOther("Jessica") == 11 && perJesse.whereNow() == 193) {
				addComments('"I have everything we need. Let\'s get this s\u00e9ance started."');
				dispPlace(339, "")
			} else {
				if (perJesse.whereNow() != 193) addComments("She looks at you quizically.  \"But we don't have the <i>innocent</i> yet.  We can't start without one.\"</p>")
			}
		else addComments("You can't use it here.");
		return ""
	}
	if (cmd == 4) {
		if (perYourBody.PutItem(26)) {
			perKurndorf.setQuestSeance(19);
			usingItem(26,
				"You take the article and put into your bag.");
			return "refresh"
		}
		return ""
	}
	return "default"
}

function CheckNo27(cmd, isl) {
	if (cmd == 3)
		if (Place == 225) {
			addComments('"Ah, yes.  You need to speak with Kristin, the bank manager about this...  her office is over there." She says, pointing at the appropriate room.');
			dispPlace(362, "");
			return ""
		} else if (Place == 362) {
		Converse("Kristin", 2701);
		return "nofooterconverse"
	}
	if (cmd == 5) {
		if (Place == 46 || Place == 41) {
			perYourBody.DropItem(27, 41);
			usingItem(27, "You drop the letter in your storage chest.")
		} else {
			perYourBody.RemoveItemSL(isl);
			usingItem(27, "You throw it away.")
		}
		return "refresh"
	}
	return "default"
}

function CheckNo28(cmd, isl) {
	if (cmd == 1) {
		addComments("Inside of a glass paperweight you see a stone that looks familar.");
		if (whereItem(28) == 195) addComments("<p>Cost " + sCurrency + "3</p>");
		return ""
	}
	if (cmd == 2)
		if (Place == 26) {
			perYourBody.DropItem(28, 1E3);
			usingItem(5, "The paperweight flashes hotly in your hand before the glass shatters leaving only an old stone.");
			perYourBody.PutItem(5);
			return ""
		}
	return "default"
}

function SetVaseVariables() {
	var perAbby = findPerson("Abby");
	if (perAbby.getQuestDragonGem() < 5) perAbby.setQuestDragonGem(5);
	var perMG = findPerson("Mrs Granger");
	var perKate = findPerson("Kate");
	setPlaceKnown("MechanicsShop");
	if (!isDavyDefeated())
		if (perKate.other == 999 || perKate.other < 15)
			if (perKate.place != 9999)
				if (perMG.checkFlag(1)) {
					perKate.place = Math.random() < .5 ? 47 : 421;
					if (perKate.place == 421) setPlaceKnown("DuckPond");
					perKate.other = 10
				} else {
					perKate.place = 1;
					perKate.other = 7;
					perKate.charmedTime = nTime
				}
	else perKate.other =
		60;
	if (perMG.other >= 50 && perMG.checkFlag(1)) {
		setPlaceKnown("Hospital");
		if (perMG.place == 275.5) perMG.place = 278;
		perMG.other = 54
	}
}

function CheckNo29(cmd, isl) {
	if (cmd == 2) {
		usingItem(29, "You can't do anything with this at the moment, it is very strongly made.");
		return ""
	}
	if (cmd == 3)
		if (Place == 279) {
			perYourBody.DropItem(29);
			usingItem(29, "You give the vase to Hannah, she looks at it professionally and puts it on a workbench.");
			return "refresh"
		}
	if (cmd == 4) {
		var perAbby = findPerson("Abby");
		if (perAbby.getQuestDragonGem() < 3) perAbby.setQuestDragonGem(3);
		if (isPossess()) addComments("What would be the point of picking up the vase while possessing someone.  Then you'd never be able to get it!");
		else if (Place == 46 || Place == 41) return "default";
		else if (Place == 276 && !checkPlaceFlag("Museum", 3) || checkPlaceFlag("Museum", 8)) {
			SetVaseVariables();
			if (perYourBody.FindItem(29) === 0) perYourBody.PutItem(29);
			usingItem(29, "You take the vase and put it into your bag.")
		} else if (Place == 279) {
			if (perYourBody.FindItem(29) === 0) perYourBody.PutItem(29);
			usingItem(29, "You pick the vase back up and put it into your bag")
		} else {
			gotoPlace(241);
			return "nofooter"
		}
		return "refresh"
	}
	return "default"
}

function CheckNo30(cmd, isl) {
	if (cmd == 2) {
		if (Place == 26 && checkPlaceFlag("Crypt", 2))
			if (!isPlaceKnown("Crypt"))
				if (isPuzzles()) {
					addComments("<p>You unfold the shovel and dig.</p><p>After fifteen minutes you strike a tablet with a weird inscription.</p>");
					dispPlace(246, "")
				} else {
					addComments("<p>You unfold the shovel and dig.</p><p>After fifteen minutes you strike a tablet with a weird inscription. You quickly decipher the tablet, and the ground shakes as the great tablet before you crumbles to dust beneath your feet. You have discovered an ancient crypt.</p>");
					setPlaceKnown("Crypt");
					dispPlace(247, "")
				}
		else addComments("<p>You have already exposed the crypt.  There is no need to dig any further.</p>");
		if (Place == 325 && !perKurndorf.checkFlag(2))
			if (perYourBody.NoItems == perYourBody.MaxItems && perYourBody.FindItem(57) === 0) addComments("You don't have enough room to carry any more items.  Make room and try again.");
			else {
				if (perYourBody.FindItem(57) === 0) perYourBody.PutItem(57);
				perKurndorf.setFlag(2);
				addComments("<p>You unfold the shovel and dig.</p><p>After about 30 minutes you manage to unearth a human skull.  Knock off the extra dirt and it would make a <i>lovely</i> centerpiece!</p>")
			}
		else addComments("You can't do anything with this at the moment.");
		return ""
	}
	if (cmd == 4) {
		if (Place == 195)
			if (nMoney > 14) {
				if (perYourBody.PutItem(30)) {
					AddCash(-15);
					addComments("You tuck it under your arm and pay " + sCurrency + "15.")
				}
			} else addComments("You do not have enough money. The shovel costs " + sCurrency + "15.");
		else if (perYourBody.PutItem(30)) addComments("You tuck it under your arm.");
		return "refresh"
	}
	return "default"
}

function CheckNo31(cmd, isl) {
	if (cmd == 2) {
		if (Place == 142) {
			usingItem(31, "<p>You whistle for help.</p><p>The police surround the area. A shoot-out starts, and Anita crumples to the ground. Townsfolk and emergency services arrive to help you and clean up the mess.</p>");
			setPersonOther("Anita", 900);
			dispPlace(63, "")
		} else usingItem(31, "You can't do anything with this at the moment.");
		return ""
	}
	if (cmd == 4) {
		if (perYourBody.PutItem(31)) usingItem(31, "You place it around your neck.");
		return "refresh"
	}
	return "default"
}

function examineSilverRingStart() {
	addComments('<table><tr style="vertical-align:top"><td style="width:20%"><img draggable="false" src="Images/Items/ring1.png" style="width:95%" alt="Ring"></td><td><p style="margin-top:0">A silver ring made in ancient times, bearing an image of a winged woman.</p>')
}

function useSilverRingStart() {
	addComments('<table><tr style="vertical-align:top"><td style="width:20%"><img draggable="false" src="Images/Items/ring1.png" style="width:95%" alt="Ring"></td><td>')
}

function noeffectSilverRing() {
	addComments("<p>It feels cold against your finger.</p></td></tr></table>")
}

function examineSilverRingReacts(nm) {
	examineSilverRingStart();
	addComments("<p>It seems to be reacting to " + nm + "'s presence... getting warmer the closer you get.</p>" + "</td></tr></table>");
	return "handled"
}

function CheckNo32(cmd, isl) {
	var perT;
	if (cmd == 2) {
		useSilverRingStart();
		if (Place == 110 && isCharmedBy("Mayor", "Davy") || Place == 176 && isCharmedBy("Mayor", "Davy") && wherePerson("Mayor") == 2) {
			addComments("<p>You clasp the ring with your fist. It glows and, within moments, it absorbs the mana powering the <i>charm</i> over the Mayor.</p></td></tr></table>");
			unCharmPerson("Mayor");
			AddMana(5);
			return "refresh"
		} else if (Place == 36 && (wherePerson("Kate") == 47 || wherePerson("Kate") == 421)) {
			if (wherePerson("Kate") == 47 || wherePerson("Kate") ==
				421) {
				if (checkPersonFlag("Kate", 31)) gotoPlace(36, "type=freed&before=true");
				else gotoPlace(36, "type=freed&before=");
				return "nofooter"
			}
		} else if (Place == 45 && isCharmedBy("Tracy", "Davy")) {
			perT = findPerson("Tracy");
			perT.unCharmThem();
			addComments("<p>You clasp the ring with your fist. It glows and, within moments, it absorbs the mana powering the <i>charm</i> over your sister.</p></td></tr></table>");
			AddMana(5);
			return "refresh"
		} else if (Place == 74 || Place == 75) {
			addComments("<p>You clasp the ring with your fist. It flickers for a moment but nothing happens, maybe the spell affecting the girls is too recently cast and still washing through their bodies and minds.</p></td></tr></table>");
			return
		} else if (Place == 76 && !checkPersonFlag("AmyRoss", 1)) {
			AddMana(10);
			addComments("<p>You clasp the ring with your fist. It glows and, within moments, it absorbs the mana powering the <i>charm</i> over Catherine and Amy.</p></td></tr></table>");
			dispPlace(76, "type=freed");
			return
		} else if ((Place == 108 || Place == 139) && wherePerson("Kate") == Place && isCharmedBy("Kate", "Davy")) {
			if (checkPersonFlag("Kate", 31)) gotoPlace(139, "type=freed&before=true&plc=" + Place);
			else gotoPlace(139, "type=freed&before=&plc=" + Place);
			return "nofooter"
		} else if (Place == 142) {
			ShotByAnita();
			return "nofooter"
		} else if (Place == 156 && isCharmedBy("Tracy", "Davy")) {
			perT = findPerson("Tracy");
			perT.unCharmThem();
			addComments("<p>You clasp the ring with your fist. It glows and, within moments, it absorbs the mana powering the <i>charm</i> over your sister.</p></td></tr></table>");
			AddMana(5);
			dispPlace(45, "");
			return
		} else if (Place == 176 && isCharmedBy("MrsRobbins", "Davy")) {
			var perG = findPerson("MrsRobbins");
			perG.setFlag(1, false);
			perG.unCharmThem();
			addComments("<p>You clasp the ring with your fist. It glows and, within moments, it absorbs the mana powering the <i>charm</i> over Mrs Robbins.</p>" +
				"<p>She blinks and looks uncertain for a moment,<br>" + '"I\'m sorry, were you here to see my son Davy, or was it Tina...Tina...ummm was she home yet? Right then, please get to the point of what you want?"</p>' + "</td></tr></table>");
			AddMana(5);
			return "refresh"
		} else if (Place == 184) {
			if (perDavy.other != 8 && perDavy.getQuestBlueBottle() != 20 && perDavy.getQuestBlueBottle() != 21) {
				AddMana(20);
				perDavy.other = 8;
				addComments("<p>You clasp the ring with your fist. It glows, far brighter than ever before, and you have to shield your eyes.  Across the room you hear Davy give a strangled grunt, as mana flows from him to you.");
				if (perDavy.checkFlag(5) && (!perDavy.checkFlag(6) && !perDavy.checkFlag(7)) || perDavy.checkFlag(8)) {
					addComments("</p></td></tr></table>");
					return
				} else {
					addComments("<p>You clasp the ring with your fist. It glows, far brighter than ever before, and you have to shield your eyes.  Across the room you hear Davy give a strangled grunt, as mana flows from him to you.</p></td></tr></table>");
					dispPlace(267, "")
				}
			} else addComments("You have already drained him of his power.</p></td></tr></table>");
			return
		} else if (Place ==
			224) {
			addComments("<p>You clasp the ring with your fist. It flickers but nothing happens.</p></td></tr></table>");
			return
		} else if (Place == 252 && isCharmedBy("Anita", "Davy") && wherePerson("Anita") === 252) {
			addComments("<p>You clasp the ring with your fist. It glows and, within moments, it absorbs the mana powering the <i>charm</i> over Anita.</p>" + "<p>She looks even more confused and drops the shotgun. Fortunately it was not cocked. She looks around unsure where she is or who you are.</p>" + "</td></tr></table>");
			var perAnita = findPerson("Anita");
			perAnita.unCharmThem();
			AddMana(5);
			dispPlace(252, "type=freed");
			return
		} else if (gameState.plcTitle == "Taxi Driver" && !perDavy.checkFlag(1)) {
			addComments("<p>You clasp the ring with your fist. It glows and, within moments, it absorbs the mana powering the <i>charm</i> over the Taxi Driver.</p></td></tr></table>");
			perDavy.setFlag(1);
			AddMana(5);
			return "refresh"
		}
		cmd = 1.1
	}
	if (Math.floor(cmd) == 1) {
		if (cmd == 1) examineSilverRingStart();
		var NPC = "";
		if (gameState.plcTitle == "Taxi Driver" &&
			!perDavy.checkFlag(1)) NPC = "the Taxi Driver";
		else {
			for (var i = 0, ie = arPeople.length - 3; i < ie; i++) {
				perT = arPeople[i];
				if (perT.isHere() && perT.isCharmed()) {
					NPC = perT.getPersonNameShort();
					break
				}
			}
			if (NPC === "")
				if (Place == 36 && (wherePerson("Kate") == 47 || wherePerson("Kate") == 421) && isCharmedBy("Kate", "Davy") || Place == 108 && wherePerson("Kate") == 108) NPC = "Kate";
				else if (Place == 139 && isCharmedBy("Kate", "Davy")) NPC = "Kate";
			else if (Place == 184) NPC = "Davy";
			else if (Place == 224) NPC = "John Adams";
			else if (Place == 145 && !isCharmed("MsJones") &&
				!checkPersonFlag("MsJones", 1)) NPC = "Ms. Jones";
			else if (Place == 74 || Place == 75 || Place == 76 && isCharmedBy("AmyRoss", "MrBeasley") && isCharmedBy("Catherine", "MrBeasley")) NPC = "Catherine and Amy"
		}
		if (NPC === "") noeffectSilverRing();
		else addComments("<p>It seems to be reacting to " + NPC + "'s presence... getting warmer the closer you get.</p></td></tr></table>")
	}
	if (cmd == 3) return "default";
	if (cmd == 4) {
		if (perYourBody.PutItem(32)) {
			addComments("You place it on your finger.");
			if (wherePerson("MsJones") == 242) movePerson("MsJones",
				isMurderPath() ? 0 : 145)
		}
		return "refresh"
	}
	if (cmd == 5)
		if (Place == 46 || Place == 41) {
			perYourBody.DropItem(32, 41);
			addComments("You take the ring off and put it into your storage chest.");
			return "refresh"
		} else addComments("If you throw it away you might never see it again.");
	return ""
}

function CheckNo33(cmd, isl) {
	if (cmd == 1) return "default";
	if (cmd == 2)
		if (Place == 184) {
			if (perDavy.other != 8 && perDavy.getQuestBlueBottle() != 20 && perDavy.getQuestBlueBottle() != 21) {
				perDavy.setQuestBlueBottle(20);
				addComments("You aim the bottle at Davy and pull open the stopper. In an spray of blue light Kurdoff's power is drawn from Davy's body and into the bottle, leaving him defenseless against you.");
				if (perDavy.checkFlag(5) && (!perDavy.checkFlag(6) && !perDavy.checkFlag(7)) || perDavy.checkFlag(8)) return;
				dispPlace(267,
					"")
			} else addComments("You have already drained him of his power.");
			return ""
		}
	if (cmd == 5) {
		if (Place == 46 || Place == 41) {
			perYourBody.DropItem(33, 41);
			addComments("You leave the bottle here in your storage chest.");
			return "refresh"
		} else addComments("You should not leave the bottle here in case someone else finds it.");
		return ""
	}
	return "default"
}

function CheckNo34(cmd, isl) {
	if (cmd == 2) {
		if (isPossess("cast")) {
			Possession("Gina");
			return "nofooterconverse"
		} else usingItem(34, "You can not use it here.");
		return ""
	}
	return "default"
}

function CheckNo35(cmd, isl) {
	if (cmd == 1) {
		addComments('<table><tr><td style="vertical-align:top;width:20%">');
		if (isRunes()) addComments('<a draggable="false" href="#" onClick="Research(\'Spell\', \'NeoOne\');return false"><img draggable="false" src="Images/Items/gem1.jpg" style="width:95%" alt="Dragon Gem">');
		else addComments('<a draggable="false" href="#" onClick="dispPlace(280);return false"><img draggable="false" src="Images/Items/gem1.jpg" style="width:95%" alt="Dragon Gem">');
		addComments("</td><td><p>A dragon gem. It appears to have some tiny writing on its back.</p></td></tr></table>");
		return ""
	}
	if (cmd == 4) {
		addComments("The gem is far too hot to pick up, and seems to burn with an inner glow. You're not sure it will ever cool.");
		return ""
	}
	return "default"
}

function CheckNo36(cmd, isl) {
	if (cmd == 3)
		if (Place == 285)
			if (isMurderPath()) {
				Converse("Trial", 35);
				return "nofooterconverse"
			}
	return "default"
}

function CheckNo37(cmd, isl) {
	if (cmd == 2)
		if (perYourBody.FindItem(38) > 0) {
			perYou.setQuestRustyKey(9);
			perYourBody.DropItem(38, 1E3);
			setItemName(37, "String & Magnet");
			addComments("You tie the string onto the small magnet");
			updateRightBar();
			return "refresh"
		} else if (Place == 42 && perYou.getQuestRustyKey() == 9 && checkPlaceFlag("Alley", 2) && !isConspiracyPath()) {
		perYou.setQuestRustyKey(1E3);
		perYourBody.DropItem(37, 1E3);
		PlaceI(39, 42);
		addComments("<p>You lower the magnet into the deep gutter drain with the string. After fishing a bit you carefully you pull up an rusty old key.</p><p>Oh no! You've dropped the magnet down into the drain!</p>");
		return "refresh"
	} else if (Place == 86 && checkPersonFlag("Bambi", 5) && perYou.getQuestRustyKey() == 9) {
		perYou.setQuestRustyKey(1E3);
		perYourBody.DropItem(37, 1E3);
		PlaceI(39, 86);
		addComments("<p>You lower the magnet into the deep hole with the string. After fishing a bit you carefully you pull up an rusty old key.</p><p>Oh no! You've dropped the magnet down into the hole!</p>");
		return "refresh"
	}
	return "default"
}

function CheckNo38(cmd, isl) {
	if (cmd == 2) {
		if (perYourBody.FindItem(37) > 0) {
			perYou.setQuestRustyKey(9);
			perYourBody.DropItem(38, 1E3);
			setItemName(37, "String & Magnet");
			addComments("You tie the string onto the small magnet");
			updateRightBar()
		} else addComments("Whatever are you going to use a magnet on?");
		return ""
	} else if (cmd == 4) {
		if (perYourBody.PutItem(38)) addComments("You examine the magnet then tuck it into your pocket.");
		return "refresh"
	}
	return "default"
}

function CheckNo39(cmd, isl) {
	if (cmd == 2) {
		if (Place == 161 && (isMurderPath() || isConspiracyPath())) {
			perYou.setQuestRustyKey(999);
			perYourBody.DropItem(39, 1E3);
			addComments("<p>You place the rusty key into a cabinet lock. You twist and pull, sliding the door open. A wine bottle is now within your grasp.</p><p>The rusty key jams in the lock, quite unwilling to come back out.  What a loss.</p>");
			PlaceI(40, 161);
			return "refresh"
		}
		addComments("You can not use the key on anything here.");
		return ""
	}
	if (cmd == 3) {
		if (Place ==
			17 && !isMurderPath()) {
			perYou.setQuestRustyKey(999);
			perGates.other = 21;
			perYou.setQuestAftane(1);
			perYourBody.DropItem(39, 1E3);
			perYou.completeQuest(2);
			addComments("You pass the key to " + perGates.getPersonNameShort() + ". He thanks you then turns to slide a picture aside to reveal a hidden safe. Moments later the safe door swings open.");
			return "refresh"
		} else addComments("You shouldn't give away this item yet.");
		return ""
	}
	if (cmd == 4) {
		if (perYourBody.PutItem(39)) addComments("You pick up the key, wondering what it could be used for.");
		return "refresh"
	}
	return "default"
}

function CheckNo40(cmd, isl) {
	if (cmd == 1) return "default";
	if (cmd == 2) addComments("Whatever are you going to use a bottle of wine on?");
	else if (cmd == 3) {
		if (Place == 192) {
			perYourBody.DropItem(40);
			addComments("You hand the bottle to Sarah.");
			return "refresh"
		}
	} else if (cmd == 4) {
		if (perYourBody.PutItem(40)) addComments("You put the wine bottle in your bag.");
		return "refresh"
	} else if (cmd == 5)
		if (Place == 46 || Place == 41) {
			perYourBody.DropItem(40, 41);
			addComments("You carefully place the bottle in your storage chest.");
			return "refresh"
		} else addComments("You shouldn't drop it because it might break.");
	return ""
}

function CheckNo41(cmd, isl) {
	if (cmd == 1) return "default";
	else if (cmd == 2) addComments("You cannot use the aftane now.");
	else if (cmd == 3) addComments("Hold on to it. It is too valuable to give away.");
	else if (cmd == 4) {
		if (perYourBody.PutItem(41)) addComments("You hang the aftane around your neck.");
		return "refresh"
	} else if (cmd == 5)
		if (Place == 46 || Place == 41) {
			perYourBody.DropItem(41, 41);
			addComments("You carefully place the aftane in your storage chest.");
			return "refresh"
		} else addComments("You shouldn't drop it because it might break.")
}

function CheckNo42(cmd, isl) {
	if (cmd == 1 || cmd == 4) {
		if (perYourBody.FindItem(42) > 0) perYourBody.RemoveItem(42);
		else PlaceI(42, 0);
		if (!isPlaceKnown("GinasHouse")) {
			addComments("<p>You now know Gina's address. ");
			setPlaceKnown("GinasHouse");
			if (!isPlaceKnown("RathdownRd")) setPlaceKnown("RathdownRd");
			if (!isPlaceKnown("Hotel")) setPlaceKnown("Hotel")
		}
		addComments("On the note is written</p><p><i>Mayor,<br><br> I will be staying at home while the museum is closed, please forward anything you need from me to 2138 Rathdown Rd. Thank you, Gina.</i></p>");
		return "refresh"
	}
}

function CheckNo43(cmd, isl) {
	if (cmd == 1) return "default";
	if (cmd == 2)
		if (isPossess("cast")) {
			AddMana(19);
			Possession("Gina");
			return "nofooterconverse"
		} else addComments("This <i>particular</i> magical item is not the type you can <b>use</b> per se.  Perhaps you should just keep wearing it...  for protection.");
	else if (cmd == 3) addComments("You should hold on to it. It is far too valuable to give away something that can protect you from <i>charm</i> spells!");
	else if (cmd == 4)
		if (!isPossess("Gina")) {
			if (perYourBody.PutItem(43)) addComments("You pick up the heirloom and place it around your neck, tucking it under your shirt.");
			return "refresh"
		} else addComments("What would be the point of picking it back up when you just took it off?");
	else if (cmd == 5)
		if (Place == 46 || Place == 41) {
			perYourBody.DropItem(43, 41);
			addComments("You carefully place the necklace in your storage chest.");
			return "refresh"
		} else return "default"
}

function CheckNo44(cmd, isl) {
	if (cmd == 2)
		if (isPossess("cast")) {
			Possession("Daria");
			return "nofooterconverse"
		}
	if (cmd == 4) {
		addComments("You put the " + getItemName(44) + " into your backpack.");
		if (perYourBody.FindItem(44) === 0) {
			perYourBody.PutItem(44);
			var perD = findPerson("Desiree");
			if (perD.getQuestRelic() < 40) perD.setQuestRelic(40)
		}
		return "refresh"
	}
	return "default"
}

function CheckNo45(cmd, isl) {
	if (cmd == 2) {
		usingItem(45, "While you would love to use this on someone, it is probably best to talk to them about it first.");
		return ""
	}
	if (cmd == 3) {
		usingItem(45, "While you would like to <i>GIVE</i> it to someone, it is best to not just hand it over to another person.");
		return ""
	}
	return "default"
}

function CheckNo47(cmd, isl) {
	if (cmd == 4) {
		if (perYourBody.FindItem(47) === 0) {
			perYourBody.MaxItems += 20;
			perYourBody.PutItem(47);
			usingItem(47, "You pick up the sports bag and sling it over your shoulder, you should be able to carry more things now.");
			return "refresh"
		}
	} else if (cmd == 5) {
		usingItem(47, "You should keep the bag, it is very useful!");
		return ""
	}
	return "default"
}

function CheckNo48(cmd, isl) {
	if (cmd == 2) {
		if (Place == 375) addComments("Try <i>giving</i> it to her.  That might work better.");
		else if (Place == 53 && whereItem(35) == -53) {
			perYou.DropItem(48, -53);
			addComments("You hang the relic in the claws of the dragon, it sits there very snugly.");
			return "refresh"
		} else addComments("There is no way to <i>USE</i> this here.");
		return ""
	} else if (cmd == 3) {
		if (Place == 375 && !isDemonBound()) {
			Converse("Jesse", 481);
			return "nofooterconverse"
		} else addComments("Lets not give this away to just anyone.");
		return ""
	} else if (cmd == 4) {
		if (isPossess("Daria")) {
			perYourBody.PutItem(48);
			addComments("Mother Superior is now carrying the " + getItemName(48) + ".");
			return "refresh"
		} else if (perYourBody.FindItem(48) === 0) {
			if (perYourBody.PutItem(48)) {
				var perD = findPerson("Desiree");
				if (perD.getQuestRelic() < 50) perD.setQuestRelic(50);
				if (perJesse.getDemonPath() < 150) perJesse.setDemonPath(150);
				addComments("You pick up the " + getItemName(48) + " and put it in your bag.")
			}
			return "refresh"
		}
		return ""
	}
	return "default"
}

function AddWater() {
	perYou.setHolyWaterUses(perYou.getHolyWaterUses() + 3)
}

function UseHolyWater(ItemNum) {
	perYou.setHolyWaterUses(perYou.getHolyWaterUses() - 1);
	if (perYou.getHolyWaterUses() === 0) perYourBody.DropItem(49, 1);
	if (ItemNum == 48) {
		alert("You anointed the " + getItemName(ItemNum) + " with Holy Water, it is strange how warm it now feels. You doubt it will stay anointed for more than a few minutes, five at most.");
		perJesse.setFlag(11)
	} else if (ItemNum == 62) {
		alert("You have purified the " + getItemName(ItemNum) + " with Holy Water.");
		setPersonFlag("Vampyre", 11)
	} else alert("You anointed the " +
		getItemName(ItemNum) + " with Holy Water.");
	gotoPlace()
}

function anointItem() {
	var md = WritePlaceHeader(true);
	md.write('<table style="padding:10px;border-collapse:collapse;border-spacing:0;border-width:0"><tr><td style="vertical-align:top"><td style="vertical-align:top" rowspan=10>' + '<img src="Images/Items/holywater.jpg" style="float:left;margin:0px 5px" alt="Holy Water">' + '</td><td colspan="5" style="vertical-align:top">' + '<p style="text-align:center;font-size:x-large"><b>Holy Water</b></p></td></tr><tr><td>&nbsp;</td>');
	var z = 0;
	for (var i = 1; i <= perYourBody.NoItems; i++) {
		if (perYourBody.getInventoryItem(i) >=
			10 && perYourBody.getInventoryItem(i) <= 20 || perYourBody.getInventoryItem(i) == 49) continue;
		z++;
		if (z % 6 === 0) {
			md.write("</tr><tr><td>&nbsp;</td>");
			z = 1
		}
		md.write('<td><a href="javascript:UseHolyWater(' + perYourBody.getInventoryItem(i) + ')">' + getItemName(perYourBody.getInventoryItem(i)) + "</a></td>")
	}
	md.write("</tr><tr><td>&nbsp;</td></tr><tr><td>&nbsp;</td><td colspan=4><p>Which item would you like to anoint with the holy water? (Click on it)</p>");
	addLinkToPlace(md, "Never mind...", Place);
	WritePlaceFooter(md,
		"", true, true)
}

function CheckNo49(cmd, isl) {
	if (cmd == 2) {
		if (Place == 375 && !perJesse.checkFlag(5)) addComments("Don't use it <i>now</i>.  She'll see you use it.");
		else if (isPossess("cast")) addComments("The holy water does not have enough of a personal connection to anyone...");
		else {
			addComments("You open the bottle of holy water...  now what?");
			anointItem()
		}
		return ""
	} else if (cmd == 4) {
		if (isPossess("Daria")) {
			perYourBody.PutItem(49);
			addComments("Mother Superior is now carrying the " + getItemName(49) + ".")
		} else if (perYourBody.FindItem(49) === 0) {
			if (perYourBody.PutItem(49)) {
				AddWater();
				addComments("You pick up the " + getItemName(49) + " and put it in your bag.")
			}
		} else {
			PlaceI(49, 0);
			AddWater();
			addComments("You pick up the " + getItemName(49) + " and put it in your bag.")
		}
		return "refresh"
	}
	return "default"
}

function CheckNo50(cmd, isl) {
	if (cmd == 2) {
		if (Place == 342 && perKurndorf.getQuestGhost() >= 100) {
			if (!perKurndorf.checkFlag(11)) {
				perKurndorf.setFlag(11);
				perYourBody.DropItem(50, 343);
				return "nofooterrefresh"
			}
		} else addComments("There isn't anything to use the Salt on here.  Where's a good hard-boiled egg when you need one?!");
		return ""
	} else if (cmd == 3)
		if (Place == 342 && perKurndorf.getQuestGhost() >= 100)
			if (!perKurndorf.checkFlag(11)) {
				perKurndorf.setFlag(11);
				perYourBody.DropItem(50, 343);
				return "nofooterrefresh"
			}
	return "default"
}

function CheckNo51(cmd, isl) {
	if (cmd == 2) {
		if (Place == 342 && perKurndorf.getQuestGhost() >= 100) {
			if (!perKurndorf.checkFlag(12)) {
				perKurndorf.setFlag(12);
				perYourBody.DropItem(51, 343);
				return "nofooterrefresh"
			}
		} else if (Place == 161 && isPossess()) addComments("<p>You try and use the chalice, but it doesn't seem to have a close enough connection to anyone to be useful.</p>");
		return ""
	} else if (cmd == 3) {
		if (Place == 342 && perKurndorf.getQuestGhost() >= 100) {
			if (!perKurndorf.checkFlag(12)) {
				perKurndorf.setFlag(12);
				perYourBody.DropItem(51,
					343);
				return "nofooterrefresh"
			}
		} else addComments("Feeling generous?  Don't you think you should keep this, as opposed to providing evidence of your theft?");
		return ""
	} else if (cmd == 4)
		if (isPossess("Daria")) {
			perYourBody.PutItem(51);
			addComments("Mother Superior is now carrying the " + getItemName(51) + ".");
			return "refresh"
		} else if (Place == 318 && !checkPersonFlag("Daria", 4))
		if (isInvisible()) {
			perYourBody.PutItem(51);
			addComments("You pick up the " + getItemName(51) + " and put it in your bag.");
			return "refresh"
		} else {
			if (perKurndorf.getQuestGhost() <
				101) perKurndorf.setQuestGhost(101);
			if (!checkPlaceFlag("Church", 7)) {
				setPlaceFlag("Church", 7);
				setQueryParams("type=stopped&from=chalice");
				return "nofooterrefresh"
			}
			bChatLeft = false;
			WriteCommentsHeader();
			addComments("<p><b>Mother Superior</b></p>" + "<p>\"And just what do you think you're doing, young " + perYou.getManWoman() + '.  That is church property!  Would you like me to call the Police?" she demands, wrenching the chalice from your hands. "I suggest you leave!"</p>');
			return ""
		}
	return "default"
}

function CheckNo52(cmd, isl) {
	if (cmd == 2) {
		if (Place == 342 && perKurndorf.getQuestGhost() >= 100)
			if (!perKurndorf.checkFlag(13)) {
				perKurndorf.setFlag(13);
				perYourBody.DropItem(52, 343);
				return "nofooterrefresh"
			}
	} else if (cmd == 3)
		if (Place == 342 && perKurndorf.getQuestGhost() >= 100)
			if (!perKurndorf.checkFlag(13)) {
				perKurndorf.setFlag(13);
				perYourBody.DropItem(52, 343);
				return "nofooterrefresh"
			}
	return "default"
}

function CheckNo53(cmd, isl) {
	if (cmd == 2)
		if (Place == 342 && perKurndorf.getQuestGhost() >= 100) {
			if (!perKurndorf.checkFlag(14)) {
				perKurndorf.setFlag(14);
				perYourBody.DropItem(53, 343);
				return "nofooterrefresh"
			}
		} else if (isPossess("cast")) addComments("<p>You try and use the dagger, but it doesn't seem to have a close enough connection to anyone to be useful.</p>");
	else addComments("Planning on stabbing someone with this?  Not the best idea.");
	else if (cmd == 3) {
		if (Place == 342 && perKurndorf.getQuestGhost() >= 100)
			if (!perKurndorf.checkFlag(14)) {
				perKurndorf.setFlag(14);
				perYourBody.DropItem(53, 343);
				return "nofooterrefresh"
			}
	} else if (cmd == 4)
		if (isPossess("Daria")) {
			perYourBody.PutItem(53);
			addComments("Mother Superior is now carrying the " + getItemName(53) + ".");
			return "refresh"
		}
	return "default"
}

function CheckNo54(cmd, isl) {
	if (cmd == 2) {
		if (Place == 342 && perKurndorf.getQuestGhost() >= 100) {
			if (!perKurndorf.checkFlag(15)) {
				perKurndorf.setFlag(15);
				perYourBody.DropItem(54, 343);
				return "nofooterrefresh"
			}
		} else addComments("Need a little extra light?  Perhaps you should save these for something special.");
		return ""
	} else if (cmd == 3) {
		if (Place == 342 && perKurndorf.getQuestGhost() >= 100) {
			if (!perKurndorf.checkFlag(15)) {
				perKurndorf.setFlag(15);
				perYourBody.DropItem(54, 343);
				return "nofooterrefresh"
			}
		} else addComments("I always wished someone would just start handing out candles!  What are you thinking?");
		return ""
	}
	return "default"
}

function CheckNo55(cmd, isl) {
	if (cmd == 2) {
		if (perYourBody.FindItem(56) === 0)
			if (perYourBody.NoItems < perYourBody.MaxItems) {
				perYourBody.PutItem(56);
				addComments("You cut off a lock of your own hair.  Now what are you going to use <i>that</i> for?");
				return "refresh"
			} else addComments("You don't have room in your inventory... Make some room and then we can talk.");
		else addComments("Planning on cutting some things up?  Not much here worth snipping.");
		return ""
	}
	return "default"
}

function CheckNo57(cmd, isl) {
	if (cmd == 2) {
		if (Place == 342 && perKurndorf.getQuestGhost() >= 100) {
			dispPlace(346, "");
			return "nofooter"
		} else addComments("There is no way to <i>USE</i> the skull here.");
		return ""
	} else if (cmd == 3) {
		addComments("Practicing some Shakespeare?  Thou mayest wish to hold on to this lest some naif misconstrue your forthright intentions.");
		return ""
	}
	return "default"
}

function CheckNo58(cmd, isl) {
	if (cmd == 2) {
		if (Place == 342 && perKurndorf.getQuestGhost() >= 100)
			if (!perKurndorf.checkFlag(16)) {
				perKurndorf.setFlag(16);
				perYourBody.DropItem(58, 343);
				return "nofooterrefresh"
			}
	} else if (cmd == 3) {
		if (Place == 342 && perKurndorf.getQuestGhost() >= 100)
			if (!perKurndorf.checkFlag(16)) {
				perKurndorf.setFlag(16);
				perYourBody.DropItem(58, 343);
				return "nofooterrefresh"
			}
		addComments('Oh yes.  "Here, try chewing on this?  Its great for your complexion!" - Lets not try that little trick shall we.');
		return ""
	}
	return "default"
}

function CheckNo59(cmd, isl) {
	if (cmd == 2) {
		if (Place == 342 && perKurndorf.getQuestGhost() >= 100)
			if (perKurndorf.checkFlag(17)) addComments("<p>You have already drawn the ritual circle.</p>");
			else {
				addComments("<p>Under the close watch and direction of Kurndorf you carefully draw a circle and pictograms on the floor.</p><p>You use up the chalk drawing the ritual circle.</p>");
				perKurndorf.setFlag(17);
				perYourBody.RemoveItem(59);
				return "refresh"
			}
		addComments("<p>Planning on making some chalk drawings?  Perhaps you should save this for a more important use.</p>");
		return ""
	} else if (cmd == 5) {
		if (Place == 46 || Place == 41) return "default";
		else if (Place == 342) addComments("<p>Try <i>using<i> the chalk to draw.  It works a lot better than just dropping it on the floor.</p>");
		else addComments("You shouldn't drop it, who knows when you're going to need it!");
		return ""
	}
	return "default"
}

function useItem60() {
	if (perYou.checkFlag(24)) addComments("You have already read the book, re-reading it will not help you.");
	else if (Place != 3 && Place != 8 && Place != 46) addComments("You should go somewhere quiet to read the book.");
	else {
		WaitHereOnly(24);
		perYou.setFlag(24);
		addComments("You spend a few hours reading the book, and you think you now understand the basics of hypnosis. Some things you now understand<ul>" + "<li>Not every one can be hypnotised, and they have to trust you at least a little</li>" +
			"<li>You can only ask or tell them to do something they would be willing to do, though with skill you can get them to do things they do not know they would be willing to do</li>" + "<li>It is easiest to use a focus like a spiral, or the proverbial watch, to help them concentrate.</li>" + "</ul>You also realise there is a lot more you do not know and you need a lot of practise!</p>");
		return "refresh"
	}
	return "default"
}

function useItem65() {
	if (Place == 299 && (sType == "bound" || sType == "boundfree")) {
		perYou.RemoveItem(65);
		gotoPlace(299, "type=stakevampyre");
		return "nofooter"
	}
	return "default"
}

function CheckNo66(cmd, isl) {
	findPerson("Mom");
	var d = Math.floor(per.hoursCharmed("skip") / 24) + 1;
	if (cmd == 3) {
		if (Place == 415)
			if (d < 5) {
				per.setFlag(34);
				perYou.RemoveItem(66);
				gotoPlace(415, "type=givesuitcase" + d);
				return "nofooter"
			} else addComments("Mom no longer needs it");
		return ""
	} else if (cmd == 5) {
		if (d >= 4 && Place == 154) {
			perYou.RemoveItem(66);
			addComments("Mom no longer needs the clothes to you unpack the suitcase and put it away");
			return ""
		} else addComments("You need to give this to your Mom");
		return ""
	}
	return "default"
}
var T;

function initialiseItems() {
	T = [];
	var itemlist = Object.getOwnPropertyNames(oBaseItems);
	var itm;
	for (var i = 0, ie = itemlist.length; i < ie; i++) {
		itm = oBaseItems[itemlist[i]];
		if (itm.name === undefined) continue;
		itm.name = itm.startingname;
		if (itm.startingplace === 0) continue;
		var num = parseInt(itemlist[i], 10);
		PlaceI(num, itm.startingplace)
	}
}

function checkVis(svg, id, label) {
	var place = svg.getElementById(id);
	var vis = "hidden";
	if (isPlaceKnown(label)) vis = "visible";
	place.setAttribute("visibility", vis)
}

function filterByValue(svg, keyvalue_pairs, list) {
	var generateExpression = function(key, value) {
		var parseValue = function(value) {
			var result = "";
			switch (value[0]) {
				case "!":
				case "<":
				case ">":
				case "=":
					result += value[0] + "=";
					value = value.substr(1);
					break;
				default:
					result += "==";
					break
			}
			result += '"' + value + '"';
			return result
		};
		var test = "";
		switch (typeof value) {
			case "object":
				test += "(";
				for (var i in value) {
					var val = value[i];
					if (Number(i)) test += "||";
					test += 'o["' + key + '"]' + parseValue(val)
				}
				test += ")";
				break;
			case "string":
				test += 'o["' + key +
					'"]' + parseValue(value);
				break
		}
		return test
	};
	var result = [];
	var keys = Object.getOwnPropertyNames(keyvalue_pairs);
	var test = "";
	for (var k in keys) {
		var key = keys[k];
		if (Number(k)) test += "&&";
		test += '(o.hasAttribute("' + key + '")';
		var value = keyvalue_pairs[key];
		switch (typeof value) {
			case "object":
			case "string":
				test += "&&" + generateExpression(key, value) + ")";
				break;
			case "null":
				test += ")";
				break
		}
	}
	for (var i in list) {
		var o = list[i];
		if (typeof o != "object") continue;
		if (eval(test)) result.push(o)
	}
	return result
}

function getLayers(svg) {
	var groups = svg.getElementsByTagName("g");
	return filterByValue(svg, {
		"onload": "!"
	}, groups)
}

function checkMap() {
	var mapd = document.getElementById("map");
	var map = null;
	try {
		if (isChrome()) map = mapd === null ? null : mapd;
		else map = mapd === null ? null : mapd.contentDocument;
		if (!map) map = mapd
	} catch (err) {
		map = mapd === null ? null : mapd
	}
	if (map === null) return;
	mapd.style.visibility = "hidden";
	var list = getLayers(map);
	for (var i in list) {
		var o = list[i];
		if (typeof o != "object") continue;
		if (/\d/.test(o.id)) continue;
		if (o.hasAttribute("inkscape:label")) checkVis(map, o.id, o.getAttribute("inkscape:label"))
	}
	mapd.style.visibility = "visible"
}
var oPlaceMap = {
	2: {
		ar: [3, 6, 8, 12, 13, 20, 21, 22, 23, 24, 28, 29, 30, 31, 32, 62, 147, 148, 208, 209, 210, 235]
	},
	9: {
		ar: [10, 11, 27, 69, 70, 71, 72, 73, 74, 75, 76, 77, 143, 144, 145, 159, 160, 179, 180, 234, 242, 252, 253, 254, 255, 400, 401, 402, 403, 404]
	},
	16: {
		ar: [14, 15, 17, 18, 19, 64, 65, 66, 67, 126, 127, 128, 129, 131, 155, 186, 191, 192, 199, 200, 201, 202, 212, 290, 291, 292, 293, 294, 296, 297, 299]
	},
	26: {
		ar: [25, 34, 86, 246, 247, 248]
	},
	42: {
		ar: [53]
	},
	45: {
		ar: [41, 46, 122, 149, 156, 170, 236, 287, 288, 289, 355, 356, 357, 358, 374, 408, 410, 411]
	},
	63: {
		ar: [87, 88, 89, 91, 92, 399]
	},
	94: {
		ar: [90, 95,
			96, 97, 98, 110, 158, 243, 244
		]
	},
	112: {
		ar: [300]
	},
	123: {
		ar: [124, 125, 133, 134, 135, 136, 137, 138, 161, 162, 171, 173, 174, 181, 182, 183, 184, 185, 193, 258, 267, 269, 270, 271, 272, 339, 340, 341, 342, 343, 375]
	},
	167: {
		ar: [168, 169, 175, 187, 188, 189, 221, 222, 223, 260, 261]
	},
	176: {
		ar: [79, 80, 81, 82, 83, 84, 85, 93, 130, 163]
	},
	177: {
		ar: [33, 35, 39, 40, 48, 49, 50, 51, 54, 55, 56, 57, 58, 59, 60, 61, 108, 139]
	},
	194: {
		ar: [195, 196, 203, 204, 205, 206, 211, 224, 225, 227, 237, 281, 282, 283, 284, 286, 344, 345, 348, 349, 350, 351, 352, 353, 362, 363, 364, 365, 366, 367]
	},
	215: {
		ar: [213, 214, 275, 278, 441,
			442, 443, 444
		]
	},
	238: {
		ar: [239, 240, 241, 249, 276, 277, 278, 304]
	},
	302: {
		ar: [303, 311, 312, 313, 314, 315]
	},
	317: {
		ar: [318, 319, 320, 321, 322, 326, 327, 332, 334, 335, 336, 337, 338, 382, 383, 384, 406]
	},
	359: {
		ar: [371, 372, 412, 413, 414, 415, 416, 417]
	},
	360: {
		ar: [361, 369, 370, 394, 395, 396, 397, 398]
	},
	456: {
		ar: [457, 458, 459, 460]
	},
	465: {
		ar: [466, 467, 468]
	}
};

function isAtLocation(plc) {
	if (Place == plc) return true;
	var plclist = Object.getOwnPropertyNames(oPlaceMap);
	plc = oPlaceMap[plc + ""];
	if (plc.ar === undefined) return false;
	return plc.ar.indexOf(Place) != -1
}

function getLocationOnMap(map) {
	var plc;
	var plclist = Object.getOwnPropertyNames(oPlaceMap);
	for (var i = 0, ie = plclist.length; i < ie; i++) {
		plc = oPlaceMap[plclist[i]];
		if (plc.ar === undefined) continue;
		if (plc.ar.indexOf(Place) != -1) return parseInt(plclist[i], 10)
	}
	if (map !== undefined) {
		for (var obj in map) {
			if (!map.hasOwnProperty(obj)) continue;
			if (map[obj].id == Place) return Place;
			if (!map[obj].show()) continue;
			var plcid = 0;
			map[obj].buildings.forEach(function(b) {
				if (b.id == Place) plcid = Place
			});
			if (plcid !== 0) return Place
		}
		if (gameState.nLastOut !==
			0) return gameState.nLastOut
	}
	return Place
}

function addPlace(id, name, color, d, text_x, text_pos, classes, hide, construction, pos) {
	this.id = id;
	this.name = name;
	this.color = color;
	this.d = d;
	this.text_x = text_x;
	this.text_pos = text_pos;
	this.classes = classes;
	this.show = function() {
		return isPlaceKnown(this.id) || isPlaceKnown(this.name.replace(/_/g, ""))
	};
	this.hide = hide;
	this.construction = construction;
	this.pos = pos;
	this.buildings = [];
	this.addBuilding = function(id, name, img, size, pos, romb) {
		var building = {};
		building.id = id;
		building.name = name;
		building.img = img;
		building.size = size;
		building.pos = pos;
		building.romb = romb;
		building.show = function() {
			var bOk;
			if (gameState.plcTitle == "Teleport") {
				if (isPlaceAttuned(53) && this.id == 42) return true;
				else if (isPlaceAttuned(319) && this.id == 317) return true;
				bOk = isPlaceAttuned(this.id) || this.id == 45;
				if (perYou.checkFlag(21))
					if (this.id == 42 || this.id == 26 || this.id == 123 || this.id == 176 || this.id == 177 || this.id == 230 || this.id == 9) bOk = true
			} else bOk = isPlaceKnown(this.name.replace(/_/g, ""));
			return bOk
		};
		this.buildings.push(building)
	}
}

function addHereHex(id, plc, x, y, clk) {
	var svg = plc == id ? '<image id="here" x="' + x + '" y="' + y + '" height="60" width="60" xlink:href="UI/map/here.png"/>' : "";
	if (isPlaceAttuned(id)) return svg + '<image x="' + (x + 18) + '" y="' + (y + 18) + '" height="24" width="24" xlink:href="UI/themes/theme0/symbol1.png"' + (plc != id && clk !== "" && gameState.plcTitle == "Teleport" ? ' cursor="pointer" onclick="' + clk + '"' : "") + "/>";
	return svg
}

function renderPlace(p, plc, clkfn) {
	var text_pos;
	switch (p.text_pos) {
		case "up":
			text_pos = -3;
			break;
		case "down":
			text_pos = 8;
			break;
		default:
			text_pos = p.text_pos;
			break
	}
	var classes = p.classes ? 'class="' + p.classes + '"' : "";
	var color = p.show() ? p.color : "#b3b3b3";
	if (!p.show() && p.hide) return "";
	var clk = "";
	if (clkfn !== undefined) clk = clkfn(p.id);
	var svg = '<path id="' + p.name + '" ' + classes + ' style="stroke:' + color + ';" d="' + p.d + '"/>';
	if (p.show()) svg += '<text xml:space="preserve" dx="' + p.text_x + '" dy="' + text_pos + '" fill="' + p.color +
		'" ><textPath xlink:href="#' + p.name + '">' + p.name.split("").join(" ").replace(/_/g, " ") + "</textPath></text>";
	if (p.pos !== undefined) svg += addHereHex(p.id, plc, p.pos.x, p.pos.y, clk);
	if (p.show() && p.construction) {
		var romb = addRomb(p, p.construction, true);
		var romb2 = addRomb(p, p.construction + 70, true);
		return svg + '<rect x="' + (romb.p.x - 1) + '" y="' + (romb.p.y - 1) + '" width="' + (romb2.p.x - romb.p.x + 2.5) + '" height="' + (romb2.p.y - romb.p.y + 2.5) + '" fill="url(#construction)" />' + romb.print + romb2.print + '<text xml:space="preserve" dx="' +
			(p.construction + 10) + '" dy="-3" fill="url(#construction)" ><textPath xlink:href="#' + p.name + '">Construction</textPath></text>'
	}
	return svg
}

function renderBuilding(p, b, plc, clkfn) {
	if (!b.show()) return "";
	var bOk = gameState.plcTitle == "Teleport";
	var svg = "";
	if (b.romb >= 0) {
		var romb = addRomb(p, b.romb, false);
		var pos2 = {
			x: b.pos.x + b.size.x / 2,
			y: b.pos.y + b.size.y / 2
		};
		svg = '<line x1="' + romb.p.x + '" y1="' + romb.p.y + '" x2="' + pos2.x + '" y2="' + pos2.y + '" style="stroke:' + p.color + '; stroke-width:2;" />' + romb.print
	}
	var clk = "";
	if (clkfn !== undefined) clk = clkfn(b.id);
	return svg + '<image x="' + b.pos.x + '" y="' + b.pos.y + '" height="' + b.size.y + '" width="' + b.size.x + '" xlink:href="' +
		b.img + (plc != b.id && clk !== "" ? '" cursor="pointer" onclick="' + clk : "") + '"> <title role="tooltip">' + b.name.replace(/_/g, " ") + "</title></image>" + '<rect  x="' + b.pos.x + '" y="' + b.pos.y + '" height="' + b.size.y + '" width="' + b.size.x + '" style="stroke:' + p.color + '; stroke-width:2; fill:none; " />' + (plc == b.id ? '<image id="here" x="' + (b.pos.x - 23) + '" y="' + (b.pos.y + b.size.y - 60) + '" height="60" width="60" xlink:href="UI/map/here.png"/>' : "") + (bOk ? '<image x="' + b.pos.x + '" y="' + b.pos.y + '" height="18" width="18" xlink:href="UI/themes/theme0/symbol1.png"/>' :
			"")
}

function addRomb(p, x, construction) {
	var path = document.createElementNS("http://www.w3.org/2000/svg", "path");
	path.setAttributeNS(null, "d", p.d);
	var point = path.getPointAtLength(x);
	var rombsize = 3;
	var color = construction ? "#860000" : p.color;
	var fill = construction ? "#ff0000" : "#ffffff";
	var svg = '<g transform="translate(' + (point.x - rombsize) + "," + (point.y - rombsize) + ')">' + '<path style="fill:' + fill + "; stroke:" + color + ';stroke-width:1;" d="m' + rombsize + ",0 L" + 2 * rombsize + "," + rombsize + " L" + rombsize + "," + 2 * rombsize + " L0," + rombsize +
		' Z"/>' + (construction ? '<path style="fill:#ffffff;stroke:none;" d="M2.8,3.1L2.7,2.1c0-0.2,0-0.3,0-0.4c0-0.1,0-0.2,0.1-0.3S2.9,1.4,3,1.4c0.1,0,0.2,0,0.2,0.1s0.1,0.2,0.1,0.3 \t\tc0,0.1,0,0.2,0,0.3l-0.1,1c0,0.1,0,0.2-0.1,0.3S3.1,3.4,3,3.4c-0.1,0-0.1,0-0.1-0.1S2.8,3.2,2.8,3.1z M3,4.4c-0.1,0-0.1,0-0.2-0.1 \tS2.7,4.2,2.7,4.1c0-0.1,0-0.1,0.1-0.2S2.9,3.8,3,3.8s0.2,0,0.2,0.1S3.3,4,3.3,4.1c0,0.1,0,0.2-0.1,0.2S3.1,4.4,3,4.4z"/>' : "") + "</g>";
	return {
		print: svg,
		p: point
	}
}

function renderMap(clkfn) {
	var map = {};
	map["Amaranth_Place"] = new addPlace(38, "Amaranth_Place", "#ff0066", "M569.1,542.8v-29.4c0-5.1,2.5-9,9-9l173-0.1", 15, "up", false, false, false, {
		x: 600,
		y: 450
	});
	map["Cherise_Road"] = new addPlace(37, "Cherise_Road", "#0066ff", "M305.8,576.9h48.8c4.3,0,8-4,8-8V445.7 c0-4.5-3.1-8.3-8.3-8.3h-83.1", 85, "up", false, false, false, {
		x: 335,
		y: 400
	});
	map["Tunnel"] = new addPlace(178, "Tunnel", "#000080", "M271.1,187.1l-0.3-96.7", 45, "up", "dash", true, false);
	map["Catacomb_Tunnel"] = new addPlace(323,
		"Catacomb_Tunnel", "#202090", "M516.3,482.4h180.9c7.7,0,10.2-2.6,10.2-10.2l0-61.9", 115, "down", "dash", true, false);
	map["Park_Bridge"] = new addPlace(216, "Park_Bridge", "#9a00c0", "M271.1,227.8h81", 5, "down", false, false, false);
	map["Park"] = new addPlace(47, "Park", "#cd00ff", "M271.1,318.4V187.1", 45, "up", false, false, false);
	map["Kollam_Street"] = new addPlace(44, "Kollam_Street", "#ff0000", "M271.1,318.4v180.6", 55, "down", false, false, false, {
		x: 241,
		y: 330
	});
	map["Scholastic_Road"] = new addPlace(2, "Scholastic_Road", "#01fa01",
		"M271.1,318.4h187.5", 45, "down", false, false, false);
	map["Rathdown_Road"] = new addPlace(229, "Rathdown_Road", "#aa0088", "M458.5,543.8h110.6", 5, "up", false, false, false, {
		x: 500,
		y: 490
	});
	map["Dervish_Road"] = new addPlace(5, "Dervish_Road", "#00aa88", "M178.4,499.6l-0.1,77.1c0,16.4,7.6,18.6,18.3,18.6 h90.3c12.1,0,18.9-4.2,18.9-18.3", 115, "up", false, false, false, {
		x: 168,
		y: 540
	});
	map["Alleyway"] = new addPlace(42, "Alleyway", "#000080", "M154.3,369.4l116.8-0.1", 5, "up", false, true, false);
	map["Church_Lane"] = new addPlace(317, "Church_Lane",
		"#00ccff", "M751.1,356.1v148.3", 5, "up", false, false, 80);
	map["Broken_Oar_Street"] = new addPlace(123, "Broken_Oar_Street", "#ff00cc", "M458.6,318.4v224.8", 5, "up", false, false, false);
	map["Main_Street"] = new addPlace(94, "Main_Street", "#ff6600", "M458.6,318.1l86.4,0c48.4,0,59.3,38.3,99.7,38.2 l106.3-0.3", 120, "up", false, false, 230);
	map["Shopping_Center"] = new addPlace(194, "Shopping_Center", "#00ffcc", "M178.4,498.9l118.2,0.3c6.5,0,9.2,2.8,9.2,10v67.8", 5, "down", false, false, false);
	map["Yoolaroo_Drive"] = new addPlace(43,
		"Yoolaroo_Drive", "#800000", "M178.4,498.9l-0.1-38.6c0-19.1-34.4-22.9-34.4-59.1 l0.4-22.4c0,0.9-9.3-4.9-9.3-9.3c0-4.4,4.9-9.3,9.3-9.3c3.9,0,9.4,5.3,9.6,9.3c0.2,4.4-9.6,9.3-9.6,9.3", 25, "down", false, false, false, {
			x: 120,
			y: 350
		});
	map["Oakpine_Road"] = new addPlace(1001, "Oakpine_Road", "#0b830b", "M458.5,318.3v-79.9c0-54.5,86.1-47.5,86.1-81.1V90.5", 100, "up", false, false, false);
	map["Parkview_Road"] = new addPlace(1002, "Parkview_Road", "#000000", "M224.2,90.5h320.4", 60, "down", false, false, 250);
	map["Radio_Drive"] = new addPlace(1003,
		"Radio_Drive", "#aa4300", "M545,318.4v82.8c0,19.9,17.4,13.5,17.4,39.5", 5, "up", false, false, false);
	map["Celeste_Road"] = new addPlace(455, "Celeste_Road", "#4b834b", "M544.6,109.2h236.8v91", 5, "up", false, false, false, {
		x: 594,
		y: 49
	});
	map["Oakpine_Road"].addBuilding(360, "Glenvale Aquarium", "Images/aquarium1.jpg", {
		x: 90,
		y: 60
	}, {
		x: 445,
		y: 100
	}, 228);
	map["Oakpine_Road"].addBuilding(238, "Glenvale Museum", "Images/museum.jpg", {
		x: 72,
		y: 60
	}, {
		x: 555,
		y: 120
	}, 215);
	map["Celeste_Road"].addBuilding(456, "Apartments", "Images/apartments1.jpg", {
		x: 60,
		y: 60
	}, {
		x: 555,
		y: 35
	}, 41);
	map["Kollam_Street"].addBuilding(45, "Home", "Images/house4.jpg", {
		x: 70,
		y: 70 / 600 * 370
	}, {
		x: 280,
		y: 330
	}, 33);
	map["Kollam_Street"].addBuilding(112, "Kellys' House", "Images/house7.jpg", {
		x: 70,
		y: 70 / 600 * 382
	}, {
		x: 280,
		y: 380
	}, 83);
	map["Alleyway"].addBuilding(42, "Alley", "Images/alley1.jpg", {
		x: 46,
		y: 60
	}, {
		x: 190,
		y: 369.5
	}, -1);
	map["Church_Lane"].addBuilding(317, "Lady of Our Heavenly Father", "Images/church1.jpg", {
		x: 80,
		y: 79
	}, {
		x: 665,
		y: 365
	}, 45);
	map["Main_Street"].addBuilding(94, "Glenvale Town Hall",
		"Images/cityhall1.jpg", {
			x: 60,
			y: 60 / 472 * 576
		}, {
			x: 540,
			y: 240
		}, 77);
	map["Cherise_Road"].addBuilding(435, "Gym", "Images/gymoutside.jpg", {
		x: 55,
		y: 55 / 785 * 600
	}, {
		x: 280,
		y: 445
	}, 270);
	map["Cherise_Road"].addBuilding(436, "Ross' House", "Images/house11.jpg", {
		x: 75,
		y: 75 / 6 * 4
	}, {
		x: 373,
		y: 490
	}, 115);
	map["Cherise_Road"].addBuilding(433, "Aunt's House", "Images/house12.jpg", {
		x: 70,
		y: 70 / 450 * 339
	}, {
		x: 373,
		y: 550
	}, 50);
	map["Park"].addBuilding(47, "Glenvale Park", "Images/park1.jpg", {
		x: 45,
		y: 60
	}, {
		x: 280,
		y: 250
	}, 38);
	map["Park"].addBuilding(63,
		"Park Pathway", "Images/park3.jpg", {
			x: 35,
			y: 35 / 256 * 375
		}, {
			x: 225,
			y: 226
		}, 90.5);
	map["Park"].addBuilding(26, "Wild Ranges", "Images/stones.jpg", {
		x: 70,
		y: 70
	}, {
		x: 190,
		y: 150
	}, 140);
	map["Scholastic_Road"].addBuilding(9, "Glenvale High School", "Images/school1.jpg", {
		x: 60,
		y: 60 / 491 * 600
	}, {
		x: 200,
		y: 283
	}, 0);
	map["Scholastic_Road"].addBuilding(2, "Glenvale Library", "Images/library1.jpg", {
		x: 99,
		y: 66
	}, {
		x: 350,
		y: 245
	}, 70);
	map["Park_Bridge"].addBuilding(215, "Glenvale Hospital", "Images/hospital1.jpg", {
			x: 88,
			y: 88 / 640 * 427
		}, {
			x: 350,
			y: 162
		},
		1E3);
	map["Park_Bridge"].addBuilding(216, "Park Bridge", "Images/park2.jpg", {
		x: 48,
		y: 48 / 665 * 799
	}, {
		x: 280,
		y: 162
	}, 33);
	map["Broken_Oar_Street"].addBuilding(325, "Glenvale Graveyard", "Images/graveyard.jpg", {
		x: 68,
		y: 43
	}, {
		x: 468,
		y: 440
	}, 143);
	map["Broken_Oar_Street"].addBuilding(123, "Broken Inn Hotel", "Images/hotel1.jpg", {
		x: 75,
		y: 60
	}, {
		x: 373,
		y: 390
	}, 103);
	map["Yoolaroo_Drive"].addBuilding(177, "Granger's House", "Images/house3.jpg", {
		x: 75,
		y: 75 / 600 * 365
	}, {
		x: 50,
		y: 347
	}, 145);
	map["Yoolaroo_Drive"].addBuilding(176, "Robbins' House",
		"Images/house1.jpg", {
			x: 75,
			y: 75 / 600 * 377
		}, {
			x: 60,
			y: 400
		}, 85);
	map["Yoolaroo_Drive"].addBuilding(460, "Tanika's House", "Images/house15.jpg", {
		x: 75,
		y: 75 / 600 * 453
	}, {
		x: 90,
		y: 455
	}, 15);
	map["Dervish_Road"].addBuilding(420, "Bartel's House", "Images/house2.jpg", {
		x: 75,
		y: 75 / 8 * 6
	}, {
		x: 95,
		y: 525
	}, 53);
	map["Dervish_Road"].addBuilding(430, "Kristin's House", "Images/house8.jpg", {
		x: 50 / 412 * 600,
		y: 50
	}, {
		x: 187,
		y: 515
	}, 43);
	map["Shopping_Center"].addBuilding(194, "Shopping Center", "Images/shops1.jpg", {
		x: 50 / 123 * 189,
		y: 50
	}, {
		x: 270,
		y: 515
	}, -1);
	map["Shopping_Center"].addBuilding(465, "Haven Apartments", "Images/apartments2.jpg", {
		x: 50,
		y: 50
	}, {
		x: 195,
		y: 440
	}, 42);
	map["Parkview_Road"].addBuilding(16, "Mansion", "Images/mansion.jpg", {
		x: 93.6,
		y: 60
	}, {
		x: 280,
		y: 22
	}, 55);
	map["Parkview_Road"].addBuilding(141, "Sacred Clearing", "Images/stones3.jpg", {
		x: 98,
		y: 60
	}, {
		x: 170,
		y: 22
	}, 47);
	map["Tunnel"].addBuilding(178, "Tunnel", "Images/tunnel1.jpg", {
		x: 50,
		y: 42.6
	}, {
		x: 271,
		y: 105
	}, -1);
	map["Rathdown_Road"].addBuilding(230, "Adams' House", "Images/house5.jpg", {
		x: 55 / 377 * 600,
		y: 55
	}, {
		x: 550,
		y: 553
	}, 150);
	map["Rathdown_Road"].addBuilding(302, "Gina's House", "Images/house6.jpg", {
		x: 55 / 466 * 720,
		y: 55
	}, {
		x: 454,
		y: 553
	}, 36);
	map["Rathdown_Road"].addBuilding(228, "Ms Titus's House", "Images/house13.jpg", {
		x: 45 / 466 * 720,
		y: 45
	}, {
		x: 478,
		y: 488
	}, 55);
	map["Amaranth_Place"].addBuilding(450, "Leanne's House", "Images/house10.jpg", {
		x: 60 / 45 * 60,
		y: 60
	}, {
		x: 740,
		y: 513
	}, 210);
	map["Amaranth_Place"].addBuilding(452, "Gabby's House", "Images/house9.jpg", {
		x: 60 / 45 * 60,
		y: 60
	}, {
		x: 650,
		y: 513
	}, 131);
	map["Radio_Drive"].addBuilding(167, "Police Station",
		"Images/police1station.jpg", {
			x: 50,
			y: 50 / 215 * 287
		}, {
			x: 485,
			y: 330
		}, 45);
	map["Radio_Drive"].addBuilding(359, "TV &amp; Radio Station", "Images/radio1.jpg", {
		x: 85,
		y: 85 / 277 * 237
	}, {
		x: 570,
		y: 403
	}, 1E3);
	var cPS = 20;
	var mapSvg = '<?xml version="1.0" encoding="utf-8"?><svg class="shadow" version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 860 620" xml:space="preserve"><defs>' + '<pattern id="construction" patternUnits="userSpaceOnUse" width="' + cPS + '" height="' +
		cPS + '"><rect x="0" y="0" width="' + cPS + '" height="' + cPS + '" fill="#000000" /><path style="stroke:#ffff00; stroke-width:' + cPS / 3 + ';" d="M-4,4 l8,-8 M0,' + cPS + " l" + cPS + ",-" + cPS + " M" + (cPS - 4) + "," + (cPS + 4) + ' l8,-8" /></pattern>' + '<style type="text/css">\tpath {fill: none;stroke-width:2;stroke-linecap: round;stroke-linejoin: round;} text {font-family:Tahoma, Arial;font-size:8px;font-weight:bold;letter-spacing:0px;stroke:none;} #outside {stroke:#b3b3b3;} .dash {stroke-dasharray:5,4;}</style></defs>' + '<g id="outside" class="dash">' +
		'<path d="M64.7,90.5l159.3,0"/>' + '<path d="M124,90.5v57.7 c0,10.3,1.4,24.5-23.4,24.4c-70.5-0.2-73.1,125.7,0,125.7h44.2V360"/>' + (Place >= 480 && Place <= 481 ? addHereHex(Place, Place, 30, 200, "") : "") + '<path d="M683.5,356.2V224.6h-37.2"/>' + '<path d="M683.5,246.6h107.7"/>' + "</g>";
	var plc = getLocationOnMap(map);
	for (var obj in map)
		if (map.hasOwnProperty(obj)) mapSvg += renderPlace(map[obj], plc, clkfn);
	for (var objb in map) {
		if (!map.hasOwnProperty(objb)) continue;
		if (!map[objb].show()) continue;
		map[objb].buildings.forEach(function(b) {
			mapSvg +=
				renderBuilding(map[objb], b, plc, clkfn)
		})
	}
	if (mapSvg.indexOf("here.png") != -1) return mapSvg + '<use xlink:href="#here"><title role="tooltip">You are here</title></use></svg>';
	return mapSvg + "</svg>"
}

function getMapHTML(wid, hei, clkfn) {
	if (isSafari()) return '<object height="' + wid + '" width="' + hei + '" style="visibility:hidden" id="map" type="image/svg+xml" data="UI/map/map.svg"></object>';
	var parser = new DOMParser;
	var doc = parser.parseFromString(renderMap(clkfn), "image/svg+xml");
	if (doc.documentElement.outerHTML === undefined) {
		var temp = document.createElement("div");
		temp.style.cssText = "height:" + wid + ";width:" + hei;
		var dnode = doc.documentElement.cloneNode(true);
		temp.appendChild(dnode);
		return temp.innerHTML
	}
	return doc.documentElement.outerHTML
}
var sCurrency = "$";
var nMoney;

function AddCash(no) {
	nMoney = nMoney + no;
	updateLeftBar()
}

function changeBankBalance(no) {
	if (perYou.getBankBalance() === 0) perYou.setBankBalance(1);
	else {
		perYou.setBankBalance(perYou.getBankBalance() + no);
		AddCash(no * -1)
	}
}

function useATM() {
	var md = WritePlaceHeader(false, "td-left-small");
	addPlaceTitle(md, "Checking the ATM", "atm.jpg", 0, false, "", true);
	var accountMax = perYou.checkFlag(9) ? -1 : Math.floor(nTime / 288) > 30 ? -1 : 200;
	var accountBalance = perYou.getBankBalance() - 1;
	var nCashOnHand = perYou.getCashOnHand();
	md.write("<p>");
	if (Place == 225) md.write("In the corner of the bank lies the ATM. ");
	else if (Place == 194) md.write("Outside the bank lies the ATM. ");
	md.write("You slide your account card through the reader and enter your PIN when prompted.</p>" +
		"The machine pauses a moment before displaying the following:<br>" + '<div style="text-align:left;background-image:url(Images/atmbg.jpg);background-color:#E2DCD1;background-repeat:no-repeat;background-size:auto 100%;background-position:right;color:black;border:5px solid gray;padding:5px;font-family:Arial;text-shadow:-1px 0px #E2DCD1, 0px 1px white, 1px 0px #E2DCD1, 0px -1px #E2DCD1"><p style="text-align:center;margin-top:-6px;font-size:x-large"><b>Welcome to the Friendly Loan Company ATM!</b></p><p>' +
		"Account number is XXXX-XXXX-12345 - PRIMARY CHECKING<br>" + 'Account Balance: <span style="font-size:xx-large">' + sCurrency + accountBalance + ".00</span>");
	if (accountMax > 0) md.write("(max* " + sCurrency + accountMax + ".00)");
	md.write("</p><p>Do you wish to:<br>1. ");
	if ((accountBalance + 50 <= accountMax || accountMax < 0) && nCashOnHand >= 50) md.write('<a class="black" href="javascript:changeBankBalance(50);useATM()">Deposit: ' + sCurrency + "50</a><br>");
	else md.write('<span style="color:808080;">-+|> OPTION UNAVAILABLE <|+-</span><br>');
	md.write("2. ");
	if ((accountBalance + 20 <= accountMax || accountMax < 0) && nCashOnHand >= 20) md.write('<a class="black" href="javascript:changeBankBalance(20);useATM()">Deposit: ' + sCurrency + "20</a><br>");
	else md.write('<span style="color:808080;">-+|> OPTION UNAVAILABLE <|+-</span><br>');
	md.write("3. ");
	if ((accountBalance + 10 <= accountMax || accountMax < 0) && nCashOnHand >= 10) md.write('<a class="black" href="javascript:changeBankBalance(10);useATM()">Deposit: ' + sCurrency + "10</a><br>");
	else md.write('<span style="color:808080;">-+|> OPTION UNAVAILABLE <|+-</span><br>');
	md.write("4. ");
	if ((accountBalance + 5 <= accountMax || accountMax < 0) && nCashOnHand >= 5) md.write('<a class="black" href="javascript:changeBankBalance(5);useATM()">Deposit: ' + sCurrency + "5</a><br>");
	else md.write('<span style="color:808080;">-+|> OPTION UNAVAILABLE <|+-</span><br>');
	md.write("</p><p>5. ");
	if (accountBalance >= 50) md.write('<a class="black" href="javascript:changeBankBalance(-50);useATM()">Withdraw: ' + sCurrency + "50</a><br>");
	else md.write('<span style="color:808080;">-+|> INSUFFICIENT FUNDS <|+-</span><br>');
	md.write("6. ");
	if (accountBalance >= 20) md.write('<a class="black" href="javascript:changeBankBalance(-20);useATM()">Withdraw: ' + sCurrency + "20</a><br>");
	else md.write('<span style="color:808080;">-+|> INSUFFICIENT FUNDS <|+-</span><br>');
	md.write("7. ");
	if (accountBalance >= 10) md.write('<a class="black" href="javascript:changeBankBalance(-10);useATM()">Withdraw: ' + sCurrency + "10</a><br>");
	else md.write('<span style="color:808080;">-+|> INSUFFICIENT FUNDS <|+-</span><br>');
	md.write("8. ");
	if (accountBalance >=
		5) md.write('<a class="black" href="javascript:;changeBankBalance(-5);useATM()">Withdraw: ' + sCurrency + "5</a><br>");
	else md.write('<span style="color:808080;">-+|> INSUFFICIENT FUNDS <|+-</span><br>');
	md.write("</p>");
	md.write('9. <a class="black" href="javascript:dispPlace(' + Place + ')">END TRANSACTION</a><br><br>');
	if (accountMax > 0) md.write("<b>* - unlimited account balance begins after 1 month of activity.</b><br>");
	md.write('<p style="text-align:center;margin-bottom:-6px;font-size:small">PRODUCT OF GLENVALE FINANCIAL SOLUTIONS</div><br>');
	WritePlaceFooter(md, "", true, true)
}
var per;

function Person(nm, plc, fldrin, drs) {
	this.uid = nm.split(" ").join("").split(".").join("").toLowerCase().trim();
	this.name = nm;
	this.folder = fldrin !== undefined ? fldrin : "";
	this.place = plc === undefined ? 0 : plc;
	this.flags = [0];
	this.charmed = 0;
	this.charmedTime = 0;
	this.sCharmedBy = "";
	this.other = 0;
	this.extra = [0];
	this.health = 100;
	this.Items = new MakeArray(0, 0);
	this.NoItems = 0;
	this.MaxItems = 10;
	this.dress = drs !== undefined ? drs : "";
	this.shown = false;
	this.infoid = 0;
	this.isDead = function() {
		return this.health === 0
	};
	this.isCharmedBy = function(by) {
		if (this.charmed ===
			0) return false;
		if (by === undefined) return this.sCharmedBy == "You";
		return by == this.sCharmedBy
	};
	this.isCharmed = function() {
		return this.charmed !== 0
	};
	this.getCharmedLevel = function(by) {
		if (this.charmed === 0) return 0;
		if (by !== undefined)
			if (this.sCharmedBy != by) return 0;
		if ((this.charmed & 8) !== 0) return 4;
		if ((this.charmed & 1) !== 0) return 1;
		if ((this.charmed & 2) !== 0) return 2;
		if ((this.charmed & 4) !== 0) return 3;
		if ((this.charmed & 16) !== 0) return 5;
		return this.charmed
	};
	this.charmThemF = function(no) {
		this.charmedTime = nTime;
		this.charmed =
			setBitFlag(this.charmed, no === undefined ? 4 : no)
	};
	this.charmThem = function(no, by) {
		this.charmed = 0;
		this.charmThemF(no);
		this.sCharmedBy = by === undefined || by === "" ? "You" : by
	};
	this.unCharmThem = function() {
		this.charmed = 0;
		this.charmedTime = 0;
		this.sCharmedBy = ""
	};
	this.getYourNameFor = function() {
		var clv = this.getCharmedLevel();
		if (clv === 0 || clv == 1) return perYou.getPersonName();
		if (clv == 2) return "my Love";
		return perYou.getMaster()
	};
	this.hoursCharmed = function(by) {
		if (by !== "skip" && !this.isCharmedBy(by)) return 0;
		return Math.floor((nTime -
			this.charmedTime) / 12)
	};
	this.checkFlag = function(no) {
		var idx = Math.floor((no - 1) / 32);
		if (idx > this.flags.length) return false;
		return (this.flags[idx] & 1 << no - 1 - idx * 32) !== 0
	};
	this.setFlag = function(no, nVal) {
		var idx = Math.floor((no - 1) / 32);
		if (idx > this.flags.length)
			for (var i = this.flags.length; i <= idx; i++) this.flags.push(0);
		this.flags[idx] = setBitFlag(this.flags[idx], no - idx * 32, nVal)
	};
	this.checkAnyFlags = function(nof, not) {
		if (not < nof) return false;
		for (var i = nof; i <= not; i++)
			if (this.checkFlag(i)) return true;
		return false
	};
	this.isHere =
		function() {
			return this.whereNow() == Place || this.place == -1
		};
	this.whereNow = function() {
		return this.place
	};
	this.moveThem = function(np) {
		this.place = np
	};
	this.getInventoryItem = function(no) {
		return this.Items[no]
	};
	this.DropItem = function(no, plc, nowi) {
		if (typeof no == "string") no = getItemNo(no);
		var bFnd = false;
		for (var i = 1; i <= this.NoItems; i++)
			if (this.Items[i] == no) {
				if (!PlaceI(this.Items[i], plc)) return false;
				if (i != this.NoItems)
					for (var j = i; j <= this.NoItems - 1; j++) this.Items[j] = this.Items[j + 1];
				var itm = getBaseItemObj(no);
				if (itm.drop !==
					undefined) itm.drop(this);
				this.NoItems--;
				bFnd = true
			}
		if (bFnd && nowi !== true) updateRightBar();
		return true
	};
	this.DropAllItems = function(at) {
		var i;
		if (typeof at == "string") {
			var perTo = findPerson(at);
			if (perTo !== null) {
				if (perTo.Items.length === 0) perTo.Items = new MakeArray(this.MaxItems, 0);
				if (this.NoItems > perTo.MaxItems) {
					for (i = perTo.MaxItems; i < this.NoItems; i++) {
						perTo.Items[i] = 0;
						perTo.length++
					}
					if (this.NoItems > perTo.MaxItems) perTo.MaxItems = this.NoItems
				}
			}
		}
		var itemlist = Object.getOwnPropertyNames(oBaseItems);
		for (i = 0; i <
			itemlist.length; i++) {
			var no = parseInt(itemlist[i], 10);
			if ((no < 10 || no > 20) && this.FindItem(no) > 0)
				if (!this.DropItem(no, at, true)) return false
		}
		updateRightBar();
		return true
	};
	this.AddItem = function(no) {
		if (this.NoItems == this.MaxItems) {
			alert("You cannot carry more than " + this.MaxItems + " objects at the same time, you are not strong enough!");
			return false
		} else {
			if (typeof no == "string") no = getItemNo(no);
			if (no < 1) return;
			this.NoItems++;
			if (this.Items.length === 0) this.Items = new MakeArray(this.MaxItems, 0);
			this.Items[this.NoItems] =
				no;
			var itm = getBaseItemObj(no);
			if (itm.pickup !== undefined) itm.pickup(this);
			return true
		}
	};
	this.PutItem = function(no, nore, nowr) {
		if (this.NoItems == this.MaxItems) {
			if (this == perYourBody) alert("You cannot carry more than " + this.MaxItems + " objects at the same time, you are not strong enough!");
			return false
		}
		if (typeof no == "string") no = getItemNo(no);
		if (no < 1) return false;
		this.NoItems++;
		var itm = getBaseItemObj(no);
		if (itm.pickup !== undefined) itm.pickup(this);
		if (this.Items.length === 0) this.Items = new MakeArray(this.MaxItems,
			0);
		this.Items[this.NoItems] = no;
		PlaceI(no, 0);
		if (nowr !== true) updateRightBar();
		if (nore !== true) reShowItems();
		return true
	};
	this.RemoveItemSL = function(no) {
		if (no < this.NoItems)
			for (var j = no; j <= this.NoItems - 1; j++) this.Items[j] = this.Items[j + 1];
		this.Items[this.NoItems] = 0;
		this.NoItems--;
		var itm = getBaseItemObj(no);
		if (itm.drop !== undefined) itm.drop(this);
		updateRightBar()
	};
	this.RemoveItem = function(no) {
		var isl = this.FindItem(no);
		if (isl !== 0) this.RemoveItemSL(isl)
	};
	this.FindItem = function(no) {
		if (typeof no == "string") no =
			getItemNo(no);
		for (var i = 1, ie = this.NoItems; i <= ie; i++)
			if (this.Items[i] == no) return i;
		return 0
	};
	this.MoveIup = function(no) {
		if (no == 1) return;
		var it = this.Items[no];
		var iSwap = no - 1;
		for (var i = 1; i <= this.NoItems; i++) {
			if (this.Items[i] == 4) continue;
			if (it > 9 && it < 21) {
				if (i == no || (this.Items[i] < 10 || this.Items[i] > 20)) continue
			} else if (i == no || this.Items[i] > 9 && this.Items[i] < 21) continue;
			iSwap = i
		}
		if (no <= iSwap) iSwap = no - 1;
		this.Items[no] = this.Items[iSwap];
		this.Items[iSwap] = it;
		updateRightBar()
	};
	this.MoveIdown = function(no) {
		if (no ==
			this.NoItems) return;
		var it = this.Items[no];
		var iSwap = no + 1;
		for (var i = 1; i <= this.NoItems; i++) {
			if (this.Items[i] == 4) continue;
			if (it > 9 && it < 21) {
				if (i == no || (this.Items[i] < 10 || this.Items[i] > 20)) continue
			} else if (i == no || this.Items[i] > 9 && this.Items[i] < 21) continue;
			iSwap = i;
			if (i > no) break
		}
		if (no >= iSwap) iSwap = no + 1;
		this.Items[no] = this.Items[iSwap];
		this.Items[iSwap] = it;
		updateRightBar()
	};
	this.savePerson = function() {
		var i, ie;
		var s = saveVar(this.uid) + saveVar(this.place);
		s += saveVarShortNo(this.flags.length);
		for (i = 0, ie = this.flags.length; i <
			ie; i++) s += saveVar(this.flags[i]);
		s += saveVar(this.dress);
		s += saveVar(this.charmed) + saveVar(this.charmedTime) + saveVar(this.sCharmedBy) + saveVar(this.other) + saveVar(this.health) + saveVarShortNo(this.extra.length);
		for (i = 0, ie = this.extra.length; i < ie; i++) s += saveVar(this.extra[i]);
		s += saveVar(this.NoItems);
		s += saveVar(this.MaxItems);
		if (this.NoItems > 0)
			for (i = 1; i <= this.NoItems; i++) s += saveVar(this.Items[i]);
		return s
	};
	this.loadPerson = function(s, type) {
		this.place = GetNo(s);
		var el, i;
		if (type < 19) this.flags[0] = GetNo(s);
		else {
			el =
				GetNoShort(s);
			for (i = 0; i < el; i++)
				if (i === 0) this.flags[i] = GetNo(s);
				else this.flags.push(GetNo(s));
			this.dress = GetStr(s)
		}
		this.charmed = GetNo(s);
		this.charmedTime = GetNo(s);
		this.sCharmedBy = GetStr(s);
		this.other = GetNo(s);
		this.health = GetNo(s);
		el = GetNoShort(s);
		var cel = this.extra.length;
		for (i = 0; i < el; i++)
			if (i < cel) this.extra[i] = GetNo(s);
			else GetNo(s);
		if (type < 19 && this.extra[0] !== 0) this.flags.push(this.extra[0]);
		this.NoItems = GetNo(s);
		this.MaxItems = GetNo(s);
		if (this.NoItems === 0) {
			this.Items = new MakeArray(0, 0);
			return
		}
		this.Items =
			new MakeArray(this.MaxItems > this.NoItems ? this.MaxItems : this.NoItems, 0);
		for (i = 1; i <= this.NoItems; i++) this.Items[i] = GetNo(s)
	};
	this.getImg = function(img, dn, tdress) {
		if (!img) return img;
		if (img.indexOf("GenericSex/") == 0) return img;
		if (img.charAt(0) == "!") {
			img = img.slice(1);
			tdress = ""
		}
		if (dn === true) {
			var ar = img.split(".");
			img = ar[0] + (isDay() ? "-day" : "-night") + "." + ar[1]
		}
		var s;
		if (this.folder !== "") s = "People/" + this.folder + "/";
		else s = "";
		if (tdress !== undefined) {
			if (tdress !== "") return s + tdress + "/" + img
		} else if (this.dress !==
			"") return s + this.dress + "/" + img;
		return s + img
	};
	this.showPerson = function(img, widh, alg, imgbig, title, dn, doc) {
		return AddImage(this.getImg(img, dn), widh, alg, this.getImg(imgbig, dn), !title ? this.getPersonName() : title, this, doc)
	};
	this.showPersonRandom = function(imgbase, no, wid, alg, imgbig, title, baseno, dn, doc) {
		return AddImageRandom(this.getImg(imgbase, dn), no, wid, alg, this.getImg(imgbig, dn), !title ? this.getPersonName() : title, baseno, this, doc)
	};
	this.showPersonX = function(img, wid, alg, imgbig, title, dn, doc) {
		return AddImage("Explicit/" +
			this.getImg(img, dn), wid, alg, this.getImg(imgbig, dn), !title ? this.getPersonName() : title, this, doc)
	};
	this.showPersonRandomX = function(imgbase, no, wid, alg, imgbig, title, baseno, dn, doc) {
		return AddImageRandom("Explicit/" + this.getImg(imgbase, dn), no, wid, alg, this.getImg(imgbig, dn), !title ? this.getPersonName() : title, baseno, this, doc)
	};
	this.showPersonRorX = function(img, wid, alg, imgbig, title, dn, doc) {
		return AddImage((isExplicit() ? "Explicit/" : "") + this.getImg(img, dn), wid, alg, this.getImg(imgbig, dn), !title ? this.getPersonName() :
			title, this, doc)
	};
	this.showPersonRandomRorX = function(imgbase, no, wid, alg, imgbig, title, baseno, dn, doc) {
		return AddImageRandom((isExplicit() ? "Explicit/" : "") + this.getImg(imgbase, dn), no, wid, alg, this.getImg(imgbig, dn), !title ? this.getPersonName() : title, baseno, this, doc)
	};
	this.showPersonDN = function(img, widh, alg, imgbig, title, doc) {
		return AddImage(this.getImg(img, true), widh, alg, this.getImg(imgbig, true), !title ? this.getPersonName() : title, this, doc)
	};
	this.showPersonRandomDN = function(imgbase, no, wid, alg, imgbig, title,
		baseno, doc) {
		return AddImageRandom(this.getImg(imgbase, true), no, wid, alg, this.getImg(imgbig, true), !title ? this.getPersonName() : title, baseno, this, doc)
	};
	this.showPersonXDN = function(img, wid, alg, imgbig, title, doc) {
		return AddImage("Explicit/" + this.getImg(img, true), wid, alg, this.getImg(imgbig, true), !title ? this.getPersonName() : title, this, doc)
	};
	this.showPersonRandomXDN = function(imgbase, no, wid, alg, imgbig, title, baseno, doc) {
		return AddImageRandom("Explicit/" + this.getImg(imgbase, true), no, wid, alg, this.getImg(imgbig,
			true), !title ? this.getPersonName() : title, baseno, this, doc)
	};
	this.showPersonRorXDN = function(img, wid, alg, imgbig, title, doc) {
		return AddImage((isExplicit() ? "Explicit/" : "") + this.getImg(img, true), wid, alg, this.getImg(imgbig, true), !title ? this.getPersonName() : title, this, doc)
	};
	this.showPersonRandomRorXDN = function(imgbase, no, wid, alg, imgbig, title, baseno, doc) {
		return AddImageRandom((isExplicit() ? "Explicit/" : "") + this.getImg(imgbase, true), no, wid, alg, this.getImg(imgbig, true), !title ? this.getPersonName() : title, baseno,
			this, doc)
	};
	this.showPersonArray = function(choices, widh, alg, imgbig, title, dn, doc) {
		return AddImageArray(choices, widh, alg, this.getImg(imgbig, dn), !title ? this.getPersonName() : title, this, doc)
	};
	this.showPersonArrayX = function(choices, wid, alg, imgbig, title, dn, doc) {
		return AddImageArrayX(choices, wid, alg, this.getImg(imgbig, dn), !title ? this.getPersonName() : title, this, doc)
	};
	this.showPersonString = function(img, widh, alg, imgbig, title, dn) {
		return addImageString(this.getImg(img, dn), widh, alg, this.getImg(imgbig, dn), !title ?
			this.getPersonName() : title, this)
	};
	this.addPersonString = function(img, widh, alg, imgbig, title, dn) {
		return addImageString(this.getImg(img, dn), widh, alg, this.getImg(imgbig, dn), !title ? this.getPersonName() : title, this, "noinfo")
	};
	this.addPersonFace = function(esc, wid) {
		var img = this.getImg(this.getPossessionFace());
		if (sCurrency === "\u00a3") img = img.split("Setting/").join("UK/");
		else img = img.split("Setting/").join("US/");
		if (!wid) wid = "20%";
		if (esc === true) return "<img src=\\'Images/" + img + ".jpg\\' style=\\'float:left;width:" +
			wid + ";margin:0 10px 1em 0\\' alt=\\'" + this.uid + "\\' title=\\'" + this.getPersonName() + "\\'>";
		return '<img src="Images/' + img + '.jpg" style="float:left;width:' + wid + ';margin:0 10px 1em 0" alt="' + this.uid + '" title="' + this.getPersonName() + '">'
	};
	this.showPersonFace = function(wid, alg, imgbig, title, doc) {
		this.showPerson(this.getPossessionFace() + ".jpg", wid, alg, imgbig, title, doc)
	};
	this.getNextDress = function(drs) {
		return ""
	};
	this.showPersonInfo = function(doc) {
		if (this.isPersonInfo() && this.getPersonInfo() !== "")
			if (this.shown) doc.write('<script type="text/javascript">showPopupWindowNow' +
				this.infoid + "();\x3c/script>");
			else this.infoid = showPopupWindow(this.getPersonName(), this.getPersonInfo(), "", "", false)
	};
	this.addQuestionC = function(doc, lnk, chc, pclass) {
		if (pclass === undefined) pclass = "chatblock";
		addOptionLink(doc, lnk, "Converse('" + this.uid + "'," + chc + ")", pclass)
	};
	this.addQuestionCO = function(doc, lnk, chc) {
		this.addQuestionC(doc, lnk, chc, "optionblock")
	};
	this.visitThem = function() {};
	this.getPersonGender = function() {
		return "woman"
	};
	this.isMaleSex = function() {
		return this.getPersonGender() != "woman"
	};
	this.isMan = function() {
		return this.getPersonGender() == "man"
	};
	this.isBornMale = function() {
		return this.getPersonGender() == "man"
	};
	this.getManWoman = function() {
		return this.getPersonGender() == "man" ? "man" : "woman"
	};
	this.getHeShe = function() {
		return this.getPersonGender() != "man" ? "she" : "he"
	};
	this.getHimHer = function() {
		return this.getPersonGender() != "man" ? "her" : "him"
	};
	this.getHisHer = function() {
		return this.getPersonGender() != "man" ? "her" : "his"
	};
	this.getSex = function() {
		return this.getPersonGender() != "man" ? "girl" : "boy"
	};
	this.getMaster = function() {
		return this.getPersonGender() != "man" ? "Mistress" : "Master"
	};
	this.getLord = function() {
		return this.getPersonGender() == "man" ? "My Lord" : "My Lady"
	};
	this.getWitch = function(upr, slav) {
		if (slav === true) {
			if (upr === undefined || upr === false) return this.getPersonGender() == "man" ? "volkhov" : "vedma";
			return this.getPersonGender() == "man" ? "Volkhov" : "Vedma"
		}
		if (upr === undefined || upr === false) return this.getPersonGender() == "man" ? "warlock" : "witch";
		return this.getPersonGender() == "man" ? "Warlock" : "Witch"
	};
	this.getPersonAddress =
		function() {
			return ""
		};
	this.getPersonName = function(full) {
		return full !== true && this.sCharmedBy == "You" ? "Slave " + this.name : this.name
	};
	this.getPersonNameShort = function() {
		return this.name
	};
	this.isPersonInfo = function() {
		return false
	};
	this.getPersonInfo = function() {};
	this.addPersonPhoneCall = function() {
		return false
	};
	this.getPersonSMS = function(id) {
		return ""
	};
	this.isPhoneable = function() {
		return false
	};
	this.callThem = function() {};
	this.Replies = undefined;
	this.isVampyre = function() {
		return false
	};
	this.fedUponEvent = function(by) {
		return false
	};
	this.feedOnEvent = function(whoon) {};
	this.enterChurch = function(plc, s) {
		return s
	};
	this.possessThem = function() {
		return false
	};
	this.dispossessThem = function() {
		return true
	};
	this.getPossessionFace = function() {
		return this.uid + "-face"
	};
	this.passTimeNight = function() {
		return ""
	};
	this.passTimeDay = function() {
		return ""
	};
	this.addPlaceImageLeft = function(lit) {
		return ""
	};
	this.isPlaceImageRight = function() {
		return false
	};
	this.showPlaceImageRight = function(md) {};
	this.showEvent = function() {
		return false
	};
	this.showEventPopup = function() {
		return false
	};
	this.showEventSleep = function(wt, plc, s, param) {
		return false
	};
	this.showPersonTextHere = function(doc) {};
	this.showPersonChat = function(bGeneral, doc) {};
	this.handleItem = function(no, cmd) {
		return ""
	}
}

function findPerson(ps) {
	var s = ps.split(" ").join("").split(".").join("").toLowerCase().trim();
	if (per !== null && per.uid == s) return per;
	for (var i = 0, ie = arPeople.length - 1; i < ie; i++)
		if (arPeople[i].uid == s) {
			per = arPeople[i];
			return per
		}
	if (s == "you") {
		per = perYou;
		return per
	}
	if (s == "mothersuperior") return findPerson("Daria");
	if (s == "mayorthomas") return findPerson("Mayor");
	if (s == "keana") return findPerson("Ghost");
	if (s == "doctortina" || s == "nursetina") return findPerson("DoctorKay");
	return null
}

function addPerson(nm, plc, fldr, drs) {
	per = new Person(nm, plc, fldr, drs);
	arPeople.push(per);
	return per
}

function checkPersonFlag(ps, flg) {
	if (findPerson(ps) !== null) return per.checkFlag(flg);
	return false
}

function setPersonFlag(ps, flg, nVal) {
	if (findPerson(ps) !== null) per.setFlag(flg, nVal)
}

function setPF(ps, flg, nVal) {
	setPersonFlag(ps, flg, nVal)
}

function getPersonOther(ps, idx) {
	if (findPerson(ps) !== null) {
		if (idx !== undefined && idx > 0) return per.extra[idx - 1];
		return per.other
	}
	return 0
}

function setPersonOther(ps, nVal, idx) {
	if (findPerson(ps) !== null)
		if (idx !== undefined && idx > 0) per.extra[idx - 1] = nVal;
		else per.other = nVal
}

function movePerson(ps, plc) {
	if (findPerson(ps) !== null) per.moveThem(plc)
}

function wherePerson(ps) {
	if (findPerson(ps) !== null) return per.whereNow();
	return 0
}

function isPersonHere(ps) {
	if (ps === undefined) {
		var p;
		for (var i = 0, ie = arPeople.length - 1; i < ie; i++) {
			p = arPeople[i];
			if (p.place == -1) continue;
			if (p.isHere()) return true
		}
	} else if (findPerson(ps) !== null) return per.isHere();
	return false
}

function setPersonVisited(ps) {
	if (findPerson(ps) !== null) per.visitThem()
}

function EnterChurch(plc, nogo) {
	var s;
	if (plc == 318) s = "As you approach the entry to the church";
	else if (plc == 326) s = "As you approach the secret passage";
	else if (plc == 319)
		if (nogo === true) s = "You cast the spell and you fade out and then appear in the courtyard of the Church.";
		else s = "As you approach the entry to the church";
	else s = "As you approach the secret tunnel";
	var bs = s;
	var p;
	for (var i = 0, ie = arPeople.length - 2; i < ie; i++) {
		p = arPeople[i];
		if (p.place == -1 && p.isVampyre()) s = p.enterChurch(plc, s)
	}
	if (s == bs) s = "";
	if (nogo !==
		true) gotoPlace(plc, undefined, s);
	return s
}

function ShowPeople(so, txt) {
	var b = false;
	var p;
	for (var i = 0, ie = arPeople.length - 2; i < ie; i++) {
		p = arPeople[i];
		if (!b && p.isPlaceImageRight() && !p.shown && p.health !== 0) {
			if (so === true && p.place != -1 && !p.isCharmedBy("You")) continue;
			b = true
		}
	}
	if (!b) return;
	var md = mdCache;
	if (gameState.sRightColSize === "") AddPeopleColumnMed(md, txt);
	else {
		b = gameState.bPeopleCol;
		AddPeopleColumn(md, gameState.sRightColSize, txt);
		if (b) md.write("<br>")
	}
	gameState.bPeopleCol = true;
	for (i = 0, ie = arPeople.length - 2; i < ie; i++) {
		p = arPeople[i];
		if (p.isPlaceImageRight() &&
			!p.shown && p.health !== 0) {
			if (so === true && p.place != -1 && !p.isCharmedBy("You")) continue;
			p.showPlaceImageRight(md)
		}
	}
}

function ShowPopupEvents() {
	if (bPopupShown || sComment !== "" && sType.indexOf("dream") == -1) return;
	var p;
	for (var i = 0, ie = arPeople.length; i < ie; i++) {
		p = arPeople[i];
		if (p.showEventPopup()) return
	}
	if (sPlaceParams !== "" || bPopupShown || perYourBody.FindItem(2) === 0 || isCommentsShown()) return;
	for (i = 0, ie = arPeople.length - 2; i < ie; i++) {
		p = arPeople[i];
		if (!p.isHere())
			if (p.addPersonPhoneCall()) break
	}
	if (bNewSMS && !checkPersonFlag("Glenvale", 36)) newSMS()
}

function GetPersonName(ps, full) {
	if (findPerson(ps) !== null) return per.getPersonName(full);
	return ps
}

function AddPeopleColumn(doc, pclass, txt) {
	if (gameState.bPeopleCol) return;
	if (!doc) doc = mdCache;
	gameState.bPeopleCol = true;
	AddRightColumn(doc, pclass);
	if (txt === undefined || txt === "") txt = "People here";
	doc.write('<p style="text-align:center;margin-bottom:4px;margin-top:0"><b>' + txt + "</b>")
}

function AddPeopleColumnMed(doc, txt) {
	AddPeopleColumn(doc, "td-right-med", txt)
}

function AddPeopleColumnLarge(doc, txt) {
	AddPeopleColumn(doc, "td-right-large", txt)
}
var arPeople;

function initialisePeople() {
	arPeople = [];
	initialiseAbby();
	initialiseAngela();
	initialiseMayorThomas();
	initialiseBeasley();
	initialiseAdeleRoss();
	initialiseCatherineRoss();
	initialiseAnita();
	initialiseBambi();
	initialiseMia();
	initialiseCarol();
	initialiseEllie();
	initialiseDebraKelly();
	initialiseJanetKelly();
	initialiseDidi();
	initialiseDonna();
	initialiseGina();
	initialiseCamryn();
	initialiseHannah();
	initialiseAlison();
	initialiseJenny();
	initialiseJade();
	initialiseKateGranger();
	initialiseMrsGranger();
	initialiseKristin();
	initialiseKylie();
	initialiseLeanne();
	initialiseLouise();
	initialiseGabby();
	initialiseMadison();
	initialiseNina();
	initialiseZoey();
	initialiseMonique();
	initialiseMom();
	initialiseTracy();
	initialiseMelissa();
	initialiseMotherSuperior();
	initialiseSisterDesiree();
	initialiseMsJones();
	initialiseMissLogan();
	initialiseMrsTanika();
	initialiseTitus();
	initialiseMiku();
	initialiseGhost();
	initialiseNurseMegan();
	initialiseNurseSandra();
	initialiseDoctorKay();
	initialiseDianeWhite();
	initialiseOfficerBatton();
	initialiseOfficerSmith();
	initialiseOfficerKhan();
	initialisePamela();
	initialiseJohnAdams();
	initialiseTessAdams();
	initialiseVictoria();
	initialiseLauren();
	initialiseSarah();
	initialiseSofia();
	initialiseMrsRobbins();
	initialiseTina();
	initialiseVampyre();
	initialiseMrTanika();
	initialiseAuntBrandi();
	initialiseJesse();
	initialiseLucy();
	initialiseSeraphina();
	initialiseAmyRoss();
	initialiseEsmeralda();
	initialiseJessica();
	initialiseGates();
	initialiseDavyRobbins();
	initialiseGlenvale();
	initialiseKurndorf();
	initialiseYou()
}
var bNewSMS;
var arSMSImages;
var nUnreadSMS;
var arSMS;

function newSMS() {
	bChat = false;
	setTimeout(updateRightBar, 100);
	setCommentsNoClick('<table><tr><td style="width:15%"><img src="UI/smsblack.png" style="width:95%;float:left" alt="SMS"></td><td><p><b>Incoming SMS</b><br>Your phone chimes to indicate you have just received an SMS.</p>');
	addOptionLink("comments", "check your SMS messages", "ClearComments();showRightBar(gameState.nRightBarState + 2,'sms')");
	addOptionLink("comments", "not now", "ClearComments()", "optionblock", "padding-top:0.25em;line-height:0.75em;width:200px;max-width:20%;max-width:14vw;margin-top:0.75em");
	addComments("</td></tr></table>")
}

function addSMS(id) {
	arSMS.push(id)
}

function receiveSMS(from, txt, img, wid) {
	if (img === undefined) img = "";
	return from + "^" + txt + "^" + img + (wid !== undefined ? "`" + wid : "") + "|"
}

function replyToSMS(txt) {
	return "~" + txt + "~" + "|"
}

function receiveCall(from, txt, nt) {
	bChat = false;
	if (nt !== true) showRightBar(gameState.nRightBarState + 2);
	setComments('<div class="conversebubble"><table><tr><td style="width:15%;vertical-align:top"><img src="UI/phonecall.png" style="width:95%" alt="Phone Call"></td><td><p>' + (from !== "" ? "<b>Phone call from " + from + "</b><br>" : "") + txt + "</p></td></tr></table>", txt.indexOf("gblock") == -1)
}

function makeCall(bSMS, from, txt) {
	if (sType !== "") return false;
	if (bSMS) {
		if (bNewSMS) return false;
		addSMS(from);
		bNewSMS = true;
		nUnreadSMS++
	} else receiveCall(from, txt, false);
	return true
}

function makePhoneCall(ps) {
	if (findPerson(ps) !== null) per.callThem()
}

function addSMSToPhotos(id) {
	var imdx = Math.floor((id - 1) / 32);
	arSMSImages[imdx] = setBitFlag(arSMSImages[imdx], (id - 1) % 32 + 1)
}
var nPhoneWallpapers;
var sPhoneImage;
var arPhotos;

function setWallpaper(img, msg) {
	if (img.substr(0, 7) == "Images/") img = img.substr(7);
	perYou.extra[7] = -1;
	var j;
	if (sPhoneImage !== "" && sPhoneImage != img) {
		for (j = 0; j < arPhotos.length; j++)
			if (img == arPhotos[j]) break;
		if (j >= arPhotos.length) {
			if (arPhotos.length >= gameState.nMaxPhotos) arPhotos.splice(0, 1)
		} else arPhotos.splice(j, 1);
		arPhotos.push(sPhoneImage)
	}
	sPhoneImage = img;
	if (gameState.nRightBarState >= 3) usePhone();
	if (msg === undefined) WriteComments("Set as your wallpaper");
	else WriteComments(msg)
}

function showDelete(doc, no) {
	var el = doc.getElementById("del" + no);
	if (el) el.style.display = "block"
}

function hideDelete(doc, no) {
	var el = doc.getElementById("del" + no);
	if (el) el.style.display = "none"
}

function rotatePhone() {
	var sb = gameState.sPhoneState;
	gameState.bPhoneLandscape = !gameState.bPhoneLandscape;
	if (gameState.bPhoneLandscape) {
		hideSidebars();
		usePhone(sb)
	} else {
		showRightBar(-1 * gameState.nRightBarState);
		showLeftBar();
		gameState.sPhoneState = sb;
		updateGameDisplay();
		dispPlace()
	}
}

function usePhone(stypein, no) {
	gameState.sPhoneState = stypein === undefined ? "type=" : stypein.indexOf("type=") == -1 ? "type=" + stypein : stypein;
	var stype = getQueryParam("type", gameState.sPhoneState);
	var i;
	if (stype === "" || stype === undefined || stype == "alarm" || stype == "sms" || stype == "clear" || stype == "delete" || stype == "addressbook" || stype == "apps" || stype == "game" || stype == "games") {
		if (stype == "clear") {
			arSMS = new Array;
			gameState.sPhoneState = ""
		} else if (stype == "delete") {
			arSMS.splice(no, 1);
			if (arSMS.length > 0) gameState.sPhoneState =
				"type=sms";
			else gameState.sPhoneState = ""
		} else if (stype == "game") gameState.sPhoneState = "type=game&id=" + no;
		updateRightBar(true);
		updateMain();
		return
	}
	if (gameState.bPhoneLandscape) hideSidebars();
	if (stype == "gamebig") gameState.sPhoneState = "type=gamebig&id=" + no;
	else if (stype == "clearphotos") {
		arSMSImages = new Array;
		for (i = 0; i < 11; i++) arSMSImages.push(0);
		sPhoneImage = "";
		perYou.extra[7] = 0;
		gameState.sPhoneState = "type=photos"
	} else if (stype == "deletephoto") {
		if (no == -1) {
			sPhoneImage = "";
			perYou.extra[7] = 0
		} else if (no < 0) arPhotos.splice(no *
			-1 - 1, 1);
		else {
			i = Math.floor((no - 1) / 32);
			arSMSImages[i] = setBitFlag(arSMSImages[i], (no - 1) % 32 + 1, false)
		}
		gameState.sPhoneState = "type=photos"
	}
	if (gameState.bPhoneLandscape) updateMain(getPhoneContents());
	else {
		updateRightBar(true);
		updateMain()
	}
}

function getPhoneContents() {
	var stype = getQueryParam("type", gameState.sPhoneState);
	var sno = getQueryParam("id", gameState.sPhoneState);
	var no = sno;
	var s;
	var i;
	var img;
	var wpt = perYou.extra[7] == 1 ? "black" : "white";
	var wa = Math.round(.045 * gameState.nWidth);
	var ha = Math.round(.072 * getHeight(document));
	var la = Math.round(.05 * gameState.nWidth);
	if (!gameState.bPhoneLandscape) {
		wa = wa / 2 - 4;
		la = la / 2 + 4
	}
	var imdx;
	var p;
	var sDec;
	var ar;
	var k;
	var sr;
	var bTo;
	var ir;
	var id;
	var hr;
	var hm;
	var min;

	function showQuestF(st, comp, desc,
		nobr, failed) {
		if (!st) return "";
		if (comp) desc = '<span style="text-decoration:line-through">' + desc + "</span> " + (failed === true ? "&#10006;" : "&#10004;");
		if (nobr !== true) return desc + "<br>";
		return desc
	}

	function showQuest(no, desc, failed) {
		return showQuestF(perYou.isQuestStarted(no), perYou.isQuestComplete(no), desc, false, failed)
	}
	if (stype === "" || stype === undefined || stype == "alarm" || stype == "sms" || stype == "clear" || stype == "delete" || stype == "addressbook" || stype == "apps" || stype == "game" || stype == "games") {
		if (perYou.extra[7] == -1) img =
			sPhoneImage;
		else img = "phonewallpaper" + String.fromCharCode(perYou.extra[7] + 49) + ".jpg";
		s = '<script type="text/javascript">document.onkeypress = stopRKey\x3c/script>' + '<div style="position:absolute;top:0;left:0;text-align:left;cursor:default;vertical-align:top;width:100%;height:100%;max-height:300vw;z-index:46;color:black">' + '<img style="float:left;position:relative;vertical-align:top;width:95%;min-height:78%;max-height:78%;border-width:0;border-style:none;top:9%;left:5%;margin: 0px 0px 0px 0px;padding:0" src="Images/' +
			img + '" alt="' + img + '">';
		if (stype == "sms") {
			nUnreadSMS = 0;
			s += '<img style="position:absolute;width:100%;height:100%;display:inline-block;border-width:0;border-style:none;top:0;left:0;margin:0px 0px 0px 0px;padding:0" src="UI/phone3p.png" alt="phone">' + '<div style="position:absolute;top:9%;left:6%;width:88%;height:77%;background-color:white"></div>' + '<div id="smsdiv" style="position:absolute;top:9%;left:6%;width:88%;height:72%;background-color:transparent;overflow-y:auto;overflow-x:hidden;margin-top:0.25em">' +
				'<script type="text/javascript">' + "function toggleFilter() {" + 'var el = document.getElementById("selPerson");' + 'if (el.style.display == "none") {' + 'el.style.display = "block";' + 'document.getElementById("clearall").style.display = "none";' + 'document.getElementById("done").style.display = "none";' + "}" + "else {" + 'el.style.display = "none";' + 'document.getElementById("clearall").style.display = "block";' + 'document.getElementById("done").style.display = "block";' + "}" + "}" + "function alterPerson() {" + 'var x = document.getElementById("selPerson").value;' +
				'if (x == "All") x = undefined;' + 'usePhone("sms",x);' + "}" + ';var myDiv = document.getElementById("smsdiv");' + "if (myDiv) myDiv.scrollTop = myDiv.scrollHeight;" + "\x3c/script>";
			var cnt = 0;
			var ps = "";
			var j;
			for (j = 0; j < arPeople.length - 2; j++) {
				p = arPeople[j];
				for (i = 0; i < arSMS.length; i++) {
					id = arSMS[i];
					if (p.getPersonSMS(id) !== "") {
						cnt++;
						ps += '<option value="' + p.uid + '"' + (no === p.uid ? " selected " : "") + ">" + p.getPersonName() + "</option>";
						break
					}
				}
			}
			for (i = 0; i < arSMS.length; i++) {
				sDec = "";
				id = arSMS[i];
				for (j = 0; j < arPeople.length - 2; j++) {
					p =
						arPeople[j];
					if (no !== "" && p.uid !== no) continue;
					sDec = p.getPersonSMS(id);
					if (sDec !== "") break
				}
				if (sDec === "") continue;
				ar = sDec.split("|");
				var bAdd = false;
				for (k = 0; k < ar.length; k++) {
					if (ar[k] === "") continue;
					bTo = ar[k].indexOf("~") != -1;
					if (!bAdd) {
						s += '<div onmouseover="showDelete(document,' + i + ')" onmouseout="hideDelete(document,' + i + ')" style="width:100%">' + '<div id="del' + i + '" style="display:none;width:100%;z-index:83"><a href="javascript:usePhone(\'delete\',' + i + ')"><img src="UI/themes/theme0/delete.png" style="height:1.2em;float:' +
							(bTo ? "left" : "right") + '" alt="Delete" title="Delete"></a></div>';
						bAdd = true
					} else s += '<div style="width:100%">';
					if (bTo) {
						sr = ar[k].split("~");
						s += '<div class="smsto"><p class="smsp"><span style="font-size:x-small"><b>from: ' + (sr[0] === "" ? perYou.getPersonName() : sr[0]) + "</b></span><br>" + sr[1] + "</p></div>"
					} else {
						sr = ar[k].split("^");
						s += '<div class="smsfrom"><p class="smsp"><span style="font-size:x-small"><b>from: ' + sr[0] + "</b></span><br>" + sr[1] + "</p></div>"
					}
					s += "</div>";
					if (sr.length > 1 && sr[2] !== "") {
						imdx = Math.floor((id -
							1) / 32);
						arSMSImages[imdx] = setBitFlag(arSMSImages[imdx], (id - 1) % 32 + 1);
						if (sr[2].indexOf("`") == -1) s += '<img src="Images/' + p.getImg("!" + sr[2]) + '" style="width:60%;margin-left:15%" alt="SMS"><span class="wp-icon" onclick="setWallpaper(\'' + sr[2] + '\')"><img src="UI/wallpaperblack.png" width="24px" alt="Wall" title="Set as Wallpaper"></span>';
						else {
							ir = sr[2].split("`");
							if (ir.length > 1) s += '<img src="Images/' + p.getImg("!" + ir[0]) + '" style="width:' + ir[1] + ';margin-left:10%" alt="SMS">';
							else s += sr[2]
						}
					}
				}
			}
			s += "</div>";
			if (cnt < 2) {
				s += addOptionLink("string", "Clear", "usePhone('clear')", undefined, "position:absolute;top:79%;top:calc(86% - 2.75em);width:36%;left:8%;margin-right:auto;border-left-width:0;padding-top:0.25em;padding-bottom:0.25em;");
				s += addOptionLink("string", "Done", "usePhone()", undefined, "position:absolute;top:79%;top:calc(86% - 2.75em);width:36%;left:51%;margin-right:auto;border-left-width:0;padding-top:0.25em;padding-bottom:0.25em;")
			} else {
				s += '<div style="position:absolute;top:79%;top:calc(86% - 1.75em);width:4%;left:8%;"><a href="javascript:toggleFilter()"><img src="UI/filter.png" style="width:100%" alt="Filter" title="Filter Conversations"></a>' +
					'</div><select style="display:none;position:absolute;top:79%;top:calc(86% - 2em);width:70%;left:13%;font-weight:bold" name="selPerson" id="selPerson" size="1" onchange="alterPerson();"><option value="All"' + (no === "" ? " selected" : "") + ">All</option>" + ps + "</select>";
				s += addOptionLink("string", "Clear", "usePhone('clear')", undefined, "position:absolute;top:79%;top:calc(86% - 2.75em);width:34%;left:13%;margin-right:auto;border-left-width:0;padding-top:0.25em;padding-bottom:0.25em;", "clearall");
				s += addOptionLink("string",
					"Done", "usePhone()", undefined, "position:absolute;top:79%;top:calc(86% - 2.75em);width:34%;left:53%;margin-right:auto;border-left-width:0;padding-top:0.25em;padding-bottom:0.25em;", "done")
			}
		} else if (stype == "addressbook") {
			s += '<img style="position:absolute;width:100%;height:100%;display:inline-block;border-width:0;border-style:none;top:0;left:0;margin:0px 0px 0px 0px;padding:0" src="UI/phone3p.png" alt="phone">' + '<div style="position:absolute;top:9%;left:6%;width:88%;height:77%;background-color:white"></div>' +
				'<div id="addressdiv" style="position:absolute;top:9%;left:6%;width:88%;height:72%;background-color:transparent;overflow-y:auto;overflow-x:hidden;margin-top:0.25em">' + '<table style="margin-left:5px;margin-right:5px;width:98%;vertical-align:top;border-collapse:collapse"><tr><td style="width:80%;vertical-align:top;border:1px solid black"><b>Person</b></td><td style="width:8%;vertical-align:top;border:1px solid black;font-size:x-small"><b>';
			if (isSpellKnown("Charm")) s += '<img src="UI/themes/theme0/mana.png" width="16px" style="display:block;margin:auto" title="Charmed" alt="Charmed">';
			else s += '<img src="UI/themes/theme0/book.png" width="16px" style="display:block;margin:auto" title="Other" alt="Other">';
			s += '</b></td><td style="width:10%">&nbsp;</td></tr>';
			var par = [];
			var nSlaves = 0;
			for (i = 0; i < arPeople.length - 3; i++) {
				p = arPeople[i];
				var ad = p.getPersonAddress();
				var sp = "";
				if (p.isCharmedBy()) {
					sp = '<tr id="' + p.uid + '"><td style="width:80%;padding-left:2px;border:1px solid grey">' + p.getPersonName(true) + "<br>";
					if (ad !== "") sp += '<span style="font-size:small"><b>Address</b>: ' + ad + "</span>";
					else sp +=
						"&nbsp;";
					sp += '</td><td style="width:8%;border:1px solid grey;text-align:center">&#10004;';
					nSlaves++
				} else if (ad !== "") sp = '<tr id="' + p.uid + '"><td style="width:80%;padding-left:2px;border:1px solid grey">' + p.getPersonName(true) + '<br><span style="font-size:small"><b>Address</b>: ' + ad + '</span></td><td style="width:8%;border:1px solid grey;text-align:center">&nbsp;';
				if (sp !== "") {
					sp += '</td><td style="width:10%">';
					if (p.isPhoneable()) sp += "<img onClick=\"makePhoneCall('" + p.uid + '\')" src="UI/phone2enabled.png" width="100%" style="float:left;margin:0 0 0 1px;cursor:pointer" title="Call Them" alt="Phone">';
					else sp += '<img src="UI/phone2disabled.png" width="100%" style="float:left;margin:0 0 0 1px" title="Cannot Call" alt="Phone">';
					sp += "</td></tr>";
					par.push(sp)
				}
			}
			par.sort(function(aa, ab) {
				if (aa.indexOf("phone2enabled") != -1 && ab.indexOf("phone2enabled") == -1) return -1;
				if (aa.indexOf("phone2enabled") == -1 && ab.indexOf("phone2enabled") != -1) return 1;
				return aa.localeCompare(ab)
			});
			for (i = 0; i < par.length; i++) s += par[i];
			s += '<tr><td style="width:80%;border:1px solid grey"><b>Total: ' + nSlaves + "</b></td></tr></table></div>" +
				addOptionLink("string", "Done", "usePhone()", undefined, "position:absolute;top:77%;top:calc(86% - 2.75em);width:36%;left:51%;margin-right:auto;border-left-width:0;padding-top:0.25em;padding-bottom:0.25em;");
			if (sno !== "") s += '<script>var el=getElementById("' + sno + '").scrollIntoView()\x3c/script>'
		} else if (stype == "apps") {
			var tms = perYou.checkFlag(33) ? "7am" : perYou.checkFlag(34) ? "8am" : "6am";
			s += '<img style="position:absolute;width:100%;height:100%;display:inline-block;border-width:0;border-style:none;top:0;left:0;margin:0px 0px 0px 0px;padding:0" src="UI/phone3p.png" alt="phone">' +
				'<div style="position:absolute;top:9%;left:6%;width:88%;height:77%;background-color:white"></div>' + '<div id="appsdiv" style="position:absolute;top:9%;left:6%;width:88%;height:72%;background-color:transparent;overflow-y:auto;overflow-x:hidden;margin-top:0.25em">' + '<table style="margin-left:5px;margin-right:5px;width:98%;vertical-align:top;border-collapse:collapse"><tr style="vertical-align:top">' + '<td style="width:33%"><a href="javascript:usePhone(\'alarm\')"><img style="width:95%" src="UI/alarmblack.png" alt="Alarm" title="Set your alarm clock"/></a>' +
				"<br><b>Alarm:<br></b>at: " + tms + "</td>" + '<td style="width:33%"><a href="javascript:setPersonFlag(\'Glenvale\',36,!checkPersonFlag(\'Glenvale\',36));usePhone(\'apps\')"><img style="width:95%" src="UI/smsnotification.png" alt="SMS" title="Enable SMS Notifications"/></a>' + "<br><b>Alert new SMS's:</b><br>" + (checkPersonFlag("Glenvale", 36) ? "No" : "Yes") + "</td>" + '<td style="width:33%"><a href="javascript:setExplicit(!isExplicit(true));usePhone(\'apps\')"><img style="width:95%" src="UI/xrated.png" alt="Explicit" title="Explicit content filter"/></a>' +
				"<br><b>Explicit Filter</b><br>" + (isExplicit(true) ? "disabled" : "enabled") + "</td>" + '</tr><tr style="vertical-align:top">' + '<td style="width:33%"><a href="javascript:toggleTheme();usePhone(\'apps\')"><img style="width:95%" src="UI/themes.png" alt="Theme" title="App to chamge the display theme"/></a>' + "<br><b>Theme:</b><br>" + (nTheme === 0 ? "White" : nTheme == 1 ? "Black" : nTheme == 2 ? "Dark Grey" : "Theme " + nTheme) + " Theme</td>" + '<td style="width:33%"><a href="javascript:toggleIcons();usePhone(\'apps\')"><img style="width:95%" src="UI/icons.png" alt="Icon" title="App to change the item icon view"/></a>' +
				"<br><b>Inventory:</b><br>" + (gameState.bUseIcons ? "Icons" : "Text") + "</td>" + '<td style="width:33%"><a href="javascript:toggleInventoryPopup();usePhone(\'apps\')"><img style="width:95%" src="UI/themes/theme0/bag.png" alt="Icon" title="Alter how the inventory is shown"/></a>' + "<br><b>Inventory:</b><br>" + (gameState.bInventoryPopup ? "Popup" : "Sidebar") + "</td>" + '</tr><tr style="vertical-align:top">' + '<td style="width:33%"><a href="javascript:setRunes(' + !isRunes() + ');usePhone(\'apps\')"><img style="width:95%" src="UI/runes.png" alt="Runes" title="App to change runes to text when learning spells"/></a>' +
				"<br><b>Spell Runes:</b><br>" + (isRunes() ? "Runes" : "Text Names") + "</td>" + '<td style="width:33%"><a href="javascript:gameState.bAllowUndo=!gameState.bAllowUndo;usePhone(\'apps\')"><img style="width:95%" src="UI/undo.png" alt="UnDo" title="App to rnable undo in actions"/></a>' + "<br><b>Undo:</b><br>" + (gameState.bAllowUndo ? "Yes" : "No") + "</td>" + '<td style="width:33%"><a href="javascript:toggleBubble();usePhone(\'apps\')"><img style="width:95%" src="UI/textpos.png" alt="Bubbles" title="App to change the location of text bubbles"/></a>' +
				"<br><b>Bubbles:</b><br>" + (gameState.bCommentLL ? "Lower Left" : "Centered") + "</td>" + '</tr><tr style="vertical-align:top">' + '<td style="width:33%"><a href="javascript:perYou.setFlag(40,!perYou.checkFlag(40));usePhone(\'apps\')"><img style="width:95%" src="UI/pink.png" alt="Icon" title="App to generate pink noise for a mostly dreamless sleep"/></a>' + "<br><b>Pink Noise:</b><br>" + (perYou.checkFlag(40) ? "Few Dreams" : "Normal Sleep") + "</td>" + "</tr></table></div>" + addOptionLink("string", "Done", "usePhone()", undefined,
					"position:absolute;top:79%;top:calc(86% - 2.7em);width:36%;left:51%;margin-right:auto;border-left-width:0;padding-top:0.25em;padding-bottom:0.25em;")
		} else if (stype == "games") {
			s += '<img style="position:absolute;width:100%;height:100%;display:inline-block;border-width:0;border-style:none;top:0;left:0;margin:0px 0px 0px 0px;padding:0" src="UI/phone3p.png" alt="phone">' + '<div style="position:absolute;top:9%;left:6%;width:88%;height:77%;background-color:white"></div>' + '<div id="appsdiv" style="position:absolute;top:9%;left:6%;width:88%;height:72%;background-color:transparent;overflow-y:auto;overflow-x:hidden;margin-top:0.25em">' +
				'<table style="margin-left:5px;margin-right:5px;width:98%;vertical-align:top;border-collapse:collapse"><tr style="vertical-align:top">' + '<td style="width:33%"><a href="javascript:usePhone(\'game\',\'pacman\')"><img style="width:95%" src="UI/pacman.jpg" alt="Pacman" title="Play Pacman"/></a>' + "<br><b>Play Pacman</b></td>" + '<td style="width:33%"><a href="javascript:usePhone(\'game\',\'tetris\')"><img style="width:95%" src="UI/tetris.png" alt="Tetris" title="Play Tetris"/></a>' + "<br><b>Play Tetris</b></td>" +
				'<td style="width:33%"><a href="javascript:usePhone(\'game\',\'snake\')"><img style="width:95%" src="UI/snake.png" alt="Tetris" title="Play Snake"/></a>' + "<br><b>Play Snake</b></td>" + '</tr><tr style="vertical-align:top">' + '<td style="width:33%"><a href="javascript:usePhone(\'game\',\'pong\')"><img style="width:95%" src="UI/pong.jpg" alt="Pong" title="Play Pong"/></a>' + "<br><b>Play Pong</b></td>" + '</tr><tr style="vertical-align:top">' + '<td style="width:33%"><a href="javascript:bCheating=!bCheating;dispPlace();usePhone(\'games\')"><img style="width:95%" src="UI/cheat.png" alt="Cheat" title="Assistance to cheating in games"/></a>' +
				"<br><b>Cheat Helper</b><br>" + (bCheating ? "enabled" : "disabled") + "</td>" + '<td style="width:33%"><a href="javascript:setPuzzles(!isPuzzles());usePhone(\'games\')"><img style="width:95%" src="UI/puzzles.png" alt="Puzzles" title="App to make puzzles trivially easy"/></a>' + "<br><b>Puzzles Helper</b><br>" + (isPuzzles() ? "disabled" : "enabled") + "</td>" + '</tr></table></div><p style="position:absolute;top:80%;left:7%;color:black;text-shadow:-1px 0px black, 0px 1px white, 1px 0px white, 0px -1px white;font-size:large;width:43%;text-align:left"><b> ';
			hr = getHour();
			hm = hr > 12 ? hr - 12 : hr;
			min = getTime() - hr * 100;
			s += getDay(true) + " " + hm + ":" + (min < 10 ? "0" + min : min);
			if (hr > 12) s += "pm";
			else s += "am";
			s += " </b></p>";
			s += addOptionLink("string", "Done", "usePhone()", undefined, "position:absolute;top:79%;top:calc(86% - 2.7em);width:36%;left:51%;margin-right:auto;border-left-width:0;padding-top:0.25em;padding-bottom:0.25em;")
		} else if (stype == "alarm") {
			var tm = perYou.checkFlag(33) ? "7am" : perYou.checkFlag(34) ? "8am" : "6am";
			s += '<img style="position:absolute;width:100%;height:100%;display:inline-block;border-width:0;border-style:none;top:0;left:0;margin:0px 0px 0px 0px;padding:0" src="UI/phone3p.png" alt="phone">' +
				'<div style="position:absolute;top:9%;left:6%;width:80%;text-align:center;">' + '<p style="color:' + wpt + (perYou.extra[7] == 1 ? ";text-shadow:-1px 0px black, 0px 1px white, 1px 0px white, 0px -1px white;" : ";text-shadow:-1px 0px black, 0px 1px black, 1px 0px black, 0px -1px black;") + '"><b>Alarm Settings: ' + tm + "</b></p>" + addOptionLink("string", "6am", "perYou.setFlag(33,false);perYou.setFlag(34,false);usePhone()", "phoneblock", "position:relative") + addOptionLink("string", "7am", "perYou.setFlag(33);perYou.setFlag(34,false);usePhone()",
					"phoneblock", "position:relative") + addOptionLink("string", "8am", "perYou.setFlag(34);perYou.setFlag(33,false);usePhone()", "phoneblock", "position:relative") + "</div></div>"
		} else if (stype == "game") s += '<img style="position:absolute;width:100%;height:100%;display:inline-block;border-width:0;border-style:none;top:0;left:0;margin:0px 0px 0px 0px;padding:0" src="UI/phone3p.png" alt="phone">' + '<div style="position:absolute;top:9%;left:6%;width:88%;height:77%;background-color:black"></div>' + addGame(sno) + '<script type="text/javascript">playGame()\x3c/script>' +
			addOptionLink("string", "Finish", "finishPhoneGame()", "chatblock", "position:absolute;top:79%;top:calc(86% - 2.7em);width:20%;left:70%;margin-right:auto;border-left-width:0;padding-top:0.25em;padding-bottom:0.25em;");
		else {
			s += '<img style="border:none;position:absolute;width:100%;height:100%;border-width:0;border-style:none;top:0;left:0;margin:0px 0px 0px 0px;padding:0" src="UI/phone3p.png" alt="phone">' + '<p style="position:absolute;top:7vh;left:5%;color:' + wpt + (perYou.extra[7] == 1 ? ";text-shadow:-1px 0px black, 0px 1px white, 1px 0px white, 0px -1px white;" :
				";text-shadow:-1px 0px black, 0px 1px black, 1px 0px black, 0px -1px black;") + ';font-size:large;width:89%;text-align:right"><b> ';
			hr = getHour();
			hm = hr > 12 ? hr - 12 : hr;
			min = getTime() - hr * 100;
			s += getDay(true) + " " + hm + ":" + (min < 10 ? "0" + min : min);
			if (hr > 12) s += "pm";
			else s += "am";
			s += " </b></p>";
			if (arSMS.length > 0) {
				s += '<p style="position:absolute;top:8vh;left:9%;font-size:small"><a href="javascript:usePhone(\'sms\')"><img src="UI/sms' + wpt + '.png" style="float:left;height:2em;margin-right:0;margin-left:0" alt="SMS" title="View SMS"></a></p>';
				if (nUnreadSMS > 0) s += '<p onclick="usePhone(\'sms\')" style="position:absolute;top:10vh;left:12%;font-size:x-small;border:1px solid Blue;background-color:PowderBlue;cursor:pointer"><b>' + nUnreadSMS + " new</b></p>"
			}
			s += '<p style="position:absolute;top:76vh;left:11%;width:80%;font-size:small"><a href="javascript:usePhone(\'apps\')"><img src="UI/apps.png" style="height:8vh;width:19%;margin-right:0;margin-left:0" alt="Photos" title="Apps"></a></p>' + '<p style="position:absolute;top:76vh;left:27%;width:80%;font-size:small"><a href="javascript:usePhone(\'addressbook\')"><img src="UI/addressbook.png" style="height:8vh;width:19%;margin-right:0;margin-left:0" alt="Photos" title="Address Book"></a></p>' +
				'<p style="position:absolute;top:76vh;left:43%;width:80%;font-size:small"><a href="javascript:usePhone(\'photos\')"><img src="UI/camera.png" style=height:8vh;width:19%;margin-right:0;margin-left:0" alt="Photos" title="View Photos"></a></p>' + '<p style="position:absolute;top:76vh;left:59%;width:80%;font-size:small"><a href="javascript:usePhone(\'notes\')"><img src="UI/notes.png" style="height:8vh;width:19%;margin-right:0;margin-left:0" alt="Notes" title="View Notes"></a></p>' + '<p style="position:absolute;top:76vh;left:75%;width:80%;font-size:small"><a href="javascript:usePhone(\'map\')"><img src="UI/map.png" style="height:8vh;width:19%;margin-right:0;margin-left:0" alt="Map" title="Local Map"></a></p>';
			if (perYourBody.checkFlag(15)) s += '<p style="position:absolute;top:calc(67vh + 4px);left:75%;width:80%;font-size:small"><a href="javascript:usePhone(\'games\')"><img src="UI/games.png" style="height:8vh;width:19%;margin-right:0;margin-left:0" alt="Game" title="Play a Game"></a></p>';
			else s += '<p style="position:absolute;top:calc(67vh + 4px);left:75%;width:80%;font-size:small"><a href="javascript:dispPlace(Place, \'type=playagame\')"><img src="UI/games.png" style="height:8vh;width:19%;margin-right:0;margin-left:0" alt="Game" title="Play a Game"></a></p>'
		}
		s +=
			addOptionLink("string", "Off", "showRightBar(gameState.nRightBarState - 2)", "phoneblock", "top:87vh;left:9%;background-color:transparent;color:white;") + "</div>"
	} else if (stype === "notes") {
		s = '<script type="text/javascript">document.onkeypress = stopRKey;initLightbox();\x3c/script>' + '<div style="position:absolute;text-align:left;cursor:default;vertical-align:top;overflow-x:hidden;overflow-y:hidden;width:100%;height:100vh;min-height:100vh;z-index:46;border-style:none">' + '<div style="background-color:lightblue;width:95%;height:92%;margin-left:2%;margin-top:2%;"></div>' +
			"<img draggable='false' style='float:left;position:absolute;max-height:99%;vertical-align:top;padding:0;width:100%;position:absolute;max-height:100vh;height:100vh;border-left:2px;border-style:solid;border-bottom:none;border-top:none;border-right:none;left:0;top:0' src='UI/phone3l.png'>" + '<div id="notdiv" style="position:absolute;top:0px;left:0px;text-align:left;margin:' + (ha + 4) + "px " + (wa + 4) + "px " + ha + "px " + la + 'px;height:85vh;width:91%;overflow:auto;color:black">' + '<p style="font-size:large;margin-top:4px"><b>Your Notes:</b></p>';
		var perSarah = findPerson("Sarah");
		var perVamp = findPerson("Vampyre");
		s += '<p style="font-size:medium;margin-bottom:2px"><b>Things to do:</b></p>';
		if (nMoney < 0) s += "I owe Mom " + sCurrency + Math.abs(nMoney) + " and will pay her back any money I get.<br>";
		if (perYou.getExperience() > 0) s += showQuest(4, "Find the Book, " + perGates.getPersonName() + " has it");
		else s += showQuest(4, "Find the Book");
		if (!(isConspiracyPath() && !perSarah.checkFlag(3))) s += showQuest(1, isMurderPath() || isConspiracyPath() ? "Where can I find mana" :
			"Find a magic stone for " + perGates.getPersonName());
		if (isMurderPath()) s += showQuestF(perYou.isQuestStarted(1), perYou.FindItem(11) > 0, "How do I learn spells from the Book");
		s += showQuest(2, "Find an old key for " + perGates.getPersonName());
		s += showQuestF(checkPlaceFlag("Hotel", 8), getPersonOther("Jessica") > 0, "Find out what Davy wanted in the Hotel Cellar");
		s += showQuest(3, "Find a Magic Gem");
		s += showQuestF(getPersonOther("Mayor") > 0, getPersonOther("Mayor") > 3, "Get an appointment with Mayor Thomas");
		s += showQuestF(perKurndorf.getQuestSeance() >=
			16, perKurndorf.getQuestSeance() >= 50, "Summon the ghost of Kurndorf");
		s += showQuestF(perKurndorf.getQuestGhost() >= 100, perKurndorf.getQuestRitual() >= 200, "Perform the Ritual for Kurndorf");
		if (perKurndorf.getQuestGhost() >= 100) {
			s += "&nbsp;&nbsp;&nbsp;Needed: ";
			s += showQuestF(true, perKurndorf.checkFlag(17), "Chalk", true) + ", ";
			s += showQuestF(true, perKurndorf.checkFlag(15), "Candles", true) + ", ";
			s += showQuestF(true, perKurndorf.checkFlag(12), "Chalice", true) + ", ";
			s += showQuestF(true, perKurndorf.checkFlag(13), "Quartz Crystal",
				true) + ", ";
			s += showQuestF(true, perKurndorf.checkFlag(14), "Silver Dagger", true) + ", ";
			s += showQuestF(true, perKurndorf.checkFlag(11), "Salt", true) + ", ";
			s += showQuestF(true, perKurndorf.checkFlag(16), "Hemlock", true) + ", ";
			s += showQuestF(true, perKurndorf.checkFlag(8), "Human Skull", true) + ", ";
			s += showQuestF(true, perYourBody.FindItem(56) > 0, "Lock of your hair")
		}
		s += showQuestF(isDemonFreed(), isDemonQuestDone(), "Deal with Legion");
		findPerson("Desiree");
		s += showQuestF(per.getQuestRelic() > 0, per.getQuestRelic() >= 100, "Get a Catholic Relic for Legion");
		findPerson("Leanne");
		s += showQuest(5, "Save Leanne", per.isCharmedBy("Demon"));
		var bRitualReturn = per.checkFlag(8);
		if (perYou.isQuestStarted(5) && !perYou.isQuestComplete(5) && bRitualReturn) {
			s += "&nbsp;&nbsp;&nbsp;Needed: ";
			s += showQuestF(true, checkPersonFlag("Victoria", 9) || perVamp.checkFlag(2), "Mirror of Souls", true) + ", ";
			s += showQuestF(true, whereItem(35) !== 0, "Dragon Gem", true) + ", ";
			s += showQuestF(true, whereItem(35) == -53, "Dragon Gem Bound", true) + ", ";
			s += showQuestF(true, perYou.checkFlag(21), "Can Teleport another person",
				false)
		}
		if (isConspiracyPath()) {
			s += showQuest(6, "Visit 'Noble Ally', serphoni, midnight, Sacred Clearing");
			if (perYou.isQuestStarted(6) && !perYou.isQuestComplete(6)) {
				s += "&nbsp;&nbsp;&nbsp;Needed: ";
				findPerson("Bambi");
				if (per.checkFlag(5)) s += showQuestF(true, perYou.getQuestRustyKey() >= 999, "Find the Key (Park)", true) + ", ";
				s += showQuestF(true, perYou.FindItem(40) > 0, "Bottle of Fine Wine")
			}
		}
		var perAdele = findPerson("AdeleRoss");
		s += showQuestF(per.checkFlag(4) && (perSarah.other > 0 || isConspiracyPath() && perYou.isQuestStarted(6)),
			per.place != 16, "Get rid of the Police guard at the mansion");
		if (perSarah.isCharmedBy() && isMurderPath()) {
			findPerson("Lauren");
			s += showQuestF(true, per.flags[0] > 0 || whereItem(40) == 192, "Give Sarah a fine bottle of wine")
		}
		if (perYou.checkFlag(12)) {
			s += showQuestF(perYou.checkFlag(12), perYou.checkFlag(25), "Learn hypnosis techniques");
			if (!perYou.checkFlag(25)) {
				s += "&nbsp;&nbsp;&nbsp;Needed: ";
				s += showQuestF(true, perYou.checkFlag(24), "Study the basics", true) + ", ";
				s += showQuestF(true, perYou.checkFlag(25), "Learn from Mr. Beasley (" +
					(perYou.canUseExperience(true) ? "experience available" : "more experience needed") + ")")
			}
		}
		findPerson("Sofia");
		if (isMurderPath() && perYou.isQuestStarted(7)) {
			s += showQuest(7, "Charm Sofia", per.whereNow() == 999);
			if (perYou.isQuestStarted(7) && !perYou.isQuestComplete(7)) {
				s += showQuestF(true, per.checkFlag(11), "&nbsp;&nbsp;&nbsp;Find someone who can tell you more about Sofia");
				if (per.checkFlag(13)) s += showQuestF(true, per.checkFlag(14), "&nbsp;&nbsp;&nbsp;Discuss your plan with someone who has authority");
				if (per.checkFlag(14)) s +=
					showQuestF(true, per.checkFlag(15), "&nbsp;&nbsp;&nbsp;Break into Sofia\u2019s office and search for clues against her (only between 8-10 AM)");
				if (per.checkFlag(15)) s += showQuestF(true, perYou.isQuestComplete(7), "&nbsp;&nbsp;&nbsp;Return to Kerry Batton with the information you have collected on Sofia")
			}
		}
		findPerson("Catherine");
		if (perYou.isQuestStarted(8) && !perYou.isQuestComplete(8)) {
			s += showQuest(8, "Ross Sisters", false);
			if (per.checkFlag(4)) s += showQuestF(true, per.checkFlag(5), "&nbsp;&nbsp;&nbsp;Meet Catherine at the construction site at midday");
			if (per.checkFlag(5)) s += showQuestF(true, per.checkFlag(10), "&nbsp;&nbsp;&nbsp;Wait for Catherine's call");
			if (per.checkFlag(10) && !perAdele.checkFlag(6)) s += showQuestF(true, false, "&nbsp;&nbsp;&nbsp;Visit Adele and charm her");
			if (perAdele.checkFlag(8)) s += showQuestF(true, perAdele.isCharmedBy(), "&nbsp;&nbsp;&nbsp;Charm Adele again")
		}
		findPerson("Miku");
		if (per.other < 0) {
			showQuestF(true, per.isCharmedBy(), "Charm Miku");
			s += "Miku<br>";
			if (per.other <= -1) s += showQuestF(true, per.other < -1, "&nbsp;&nbsp;&nbsp;Research bloodlines");
			if (per.other < -1) s += showQuestF(true, per.other <= -10, "&nbsp;&nbsp;&nbsp;Speak to the Gates family");
			if (per.other <= -20) s += showQuestF(true, per.other == -100, "&nbsp;&nbsp;&nbsp;Transform Miku")
		}
		if (checkPersonFlag("Hannah", 8) && wherePerson("Camryn") !== 0) {
			findPerson("Camryn");
			s += "Rescue Camryn<br>";
			s += showQuestF(true, per.place != 801, "&nbsp;&nbsp;&nbsp;Possess Camryn");
			if (per.checkFlag(21) && !per.checkFlag(22)) s += showQuestF(true, per.checkFlag(22), "&nbsp;&nbsp;&nbsp;Report to the Police");
			if (per.place == 457) s += showQuestF(true,
				per.isCharmedBy(), "&nbsp;&nbsp;&nbsp;Charm Camryn")
		}
		if (checkPersonFlag("Bambi", 7)) {
			findPerson("Mia");
			if (!per.isCharmedBy()) {
				var dc = Math.floor((nTime - this.charmedTime) / 288);
				showQuestF(true, false, "Charm Mia after " + (7 - dc) + " days (or sooner)")
			} else showQuestF(true, per.isCharmedBy(), "Charm Mia")
		}
		var perMom = findPerson("Mom");
		findPerson("Gabby");
		if (perMom.checkFlag(34)) {
			s += "Mom and Gabby<br>";
			s += showQuestF(true, per.checkFlag(3) || per.checkFlag(4), "&nbsp;&nbsp;&nbsp;What is happening between Mom and Gabby");
			if (per.checkFlag(3) || per.checkFlag(4)) {
				s += showQuestF(true, per.checkFlag(8) || per.checkFlag(10), "&nbsp;&nbsp;&nbsp;Find out about the necklace");
				if (perMom.place == 1E3) s += "&nbsp;&nbsp;&nbsp;Mom and Gabby ran away together";
				else if (per.checkFlag(10))
					if (!per.isCharmedBy())
						if (per.checkFlag(13)) s += showQuestF(true, false, "&nbsp;&nbsp;&nbsp;Missed the press conference");
						else s += showQuestF(true, false, "&nbsp;&nbsp;&nbsp;Attend the press conference " + (per.checkFlag(23) ? "today" : "tomorrow") + " at 6pm");
				else s += showQuestF(true,
					true, "&nbsp;&nbsp;&nbsp;Attend the press conference");
				s += showQuestF(true, per.isCharmedBy(), "&nbsp;&nbsp;&nbsp;Charm Gabby")
			}
		}
		s += '<p style="font-size:medium;margin-bottom:2px"><b>Magic:</b></p>';
		if (perVamp.other >= 60) s += "The Sacred Clearing is dangerous at night<br>";
		if (perYou.checkFlag(10)) s += "Use magic stones in the Wild Ranges to get mana<br>";
		if (getPersonCharm("Tina") > 3) s += "Tina can drain the mana powering spells<br>";
		if (checkPersonFlag("Tina", 2)) s += "Witches bear a mark visible only to other witches, a small tattoo like mark<br>";
		if (whereItem(35) == -53) s += "The Hidden Room is a place of power<br>";
		if (perYou.checkFlag(11)) s += "The book seems to glow red when I can learn a new magical training<br>";
		if (checkPlaceFlag("Park", 6)) s += "I saw strange symbol that frightened me<br>";
		if (isCharmedBy("Ghost")) s += "Ghosts can be a source of mana<br>";
		if (perYou.checkFlag(45)) s += "You could teleport from the Sacred Clearing at night to Elian<br>";
		if (perYou.checkFlag(26)) s += "Magical Knowledge: I have fine control over the charm process<br>";
		if (perYou.checkFlag(17)) s +=
			"Magical Knowledge: Expensive spells are 1 to 2 points cheaper<br>";
		if (perYou.checkFlag(18)) s += "Magical Knowledge: I can use Mana to block spells cast on me, I need at least 20 mana to do it<br>";
		if (perYou.checkFlag(19)) s += "Magical Knowledge: I can charm men as well as women<br>";
		if (perYou.checkFlag(20)) s += "Magical Knowledge: I get more mana from magic stones<br>";
		if (perYou.checkFlag(21)) s += "Magical Knowledge: I can use teleport to more places and I can carve hexagrams<br>";
		if (perYou.checkFlag(22)) s +=
			"Magical Knowledge: Wealth spell gives more money for me<br>";
		if (perYou.checkFlag(23)) s += "Magical Knowledge: I can charm spirits and ghosts<br>";
		if (perYou.checkFlag(27)) s += "Magical Knowledge: I know the tricks of deciphering spells<br>";
		if (perYou.checkFlag(28)) s += "Magical Knowledge: I can stay invisible for longer<br>";
		if (perYou.checkFlag(29)) s += "Magical Knowledge: I can get visions of other places if I meditate on a pool of water and cast clairvoyance<br>";
		if (bRitualReturn) s += "Magical Knowledge: I know the Ritual of Return<br>";
		if (perYou.checkFlag(25)) s += "Hypnotic Knowledge: I can magically augment hypnosis<br>";
		else if (perYou.checkFlag(24)) s += "Hypnotic Knowledge: I understand the basics of hypnosis<br>";
		s += '<p style="font-size:medium;margin-bottom:2px"><b>General Notes:</b></p>';
		if (perBeasley.checkFlag(14)) s += "Read Mr. Beasley's lecture on Carl Kurndorf<br>";
		if (perYou.isQuestStarted(1) && (isCharmedPath() || isGoodPath())) s += "I am " + perGates.getPersonName() + "'s apprentice!<br>";
		else if (isConspiracyPath()) s += perSarah.checkFlag(1) ?
			"Sarah Gates is helping my researches<br>" : "I have an anonymous friend helping my researches<br>";
		else if (isMurderPath())
			if (perGates.other == 600) s += perGates.getPersonName() + " is dead, killed by Davy's woman!<br>";
			else s += perGates.getPersonName() + " is dead!<br>";
		if (perDavy.other > 0) s += "Davy Robbins and Mr. Beasley?<br>";
		if (perDavy.checkFlag(9)) s += "That bastard Davy Robbins tried to hurt me!!!<br>";
		findPerson("Kate");
		if (per.place === 3) s += "Remember to meet Kate to study in the library<br>";
		findPerson("MissLogan");
		if (per.other == 2) s += "I have to do the neurology assignment for Miss Logan. I need no more information to do it.<br>";
		else if (per.other >= 5) s += "I have to do the reproductive assignment for Miss Logan. I should check with her for more details.<br>";
		if (checkPlaceFlag("Hospital", 4)) s += "I have a key to the old hospital basement<br>";
		if (checkPlaceFlag("Museum", 8)) s += "The Mayor has closed the museum<br>";
		if (perSarah.other > 0) s += "Sarah Gates is now at the Mansion<br>";
		if (checkPersonFlag("Kristin", 9)) s += "Kristin has closed the bank<br>";
		if (checkPersonFlag("Kristin", 13)) s += "I have a low-limit credit card<br>";
		if (perYou.getBankBalance() !== 0) {
			var accountMax = perYou.checkFlag(9) ? -1 : Math.floor(nTime / 288) > 30 ? -1 : 200;
			if (accountMax === -1) s += "There is no limit on my bank account<br>";
			else s += "I can only deposit up to " + sCurrency + accountMax + " in my bank account<br>"
		}
		findPerson("Kylie");
		if (per.checkFlag(1)) s += "Kylie plays sports weekdays 12-2pm<br>";
		findPerson("MsTitus");
		if (per.isFreeSlave()) s += "Ms. Titus is my willing slave<br>";
		if (perYou.isQuestComplete(7)) s +=
			"Sofia, your personal chauffeur comes to your every morning. She can give you a lift anywhere around town. You can also call her anytime if you want her to come pick you up.<br>";
		else if (checkPersonFlag("Hannah", 17)) s += "Hannah can give you a ride anywhere you need, just visit her " + getShopStore() + " or apartment<br>";
		s += "<br></div>" + addOptionLink("string", "Close", "showRightBar(-1*gameState.nRightBarState);showLeftBar();dispPlace()", "chatblock", "position:absolute;margin-top:0;top:6px;left:5px;margin-left:4%;width:20%");
		s += '<span class="zoom-icon" style="position:absolute;top:0px;right:5px"><img draggable="false" style="cursor:pointer;" onclick="rotatePhone();return false" src="UI/rotate.png" width="48" alt="Rotate" title="Rotate"></span>';
		if (checkPersonFlag("Bambi", 7)) s += "Bambi is your night guard in the dungeon<br>"
	} else if (stype === "map") s = '<script type="text/javascript">document.onkeypress = stopRKey;initLightbox();\x3c/script>' + '<div style="position:absolute;text-align:left;cursor:default;vertical-align:top;overflow-x:hidden;overflow-y:hidden;width:100%;height:100vh;min-height:100vh;z-index:46">' +
		"<img draggable='false' style='float:left;position:absolute;max-height:99%;vertical-align:top;padding:0;width:100%;position:absolute;max-height:100vh;height:100vh;border-left:2px;border-style:solid;border-bottom:none;border-top:none;border-right:none;left:0;top:0' src='UI/phone3l.png'>" + '<div id="mapdiv" style="position:absolute;top:0px;left:0px;text-align:left;margin:' + (ha + 4) + "px " + (wa + 4) + "px " + ha + "px " + (la - 4) + 'px;height:85%;width:91%;overflow-y:auto;overflow-x:auto;background-image:url(UI/map/mapbg.jpg);background-size:cover">' +
		getMapHTML("100%", "100%") + "</div>" + addOptionLink("string", "Close", "showRightBar(-1*gameState.nRightBarState);showLeftBar();dispPlace()", "chatblock", "position:absolute;margin-top:0;top:6px;left:5px;margin-left:4%;width:20%") + '<span class="zoom-icon" style="position:absolute;top:0px;right:5px"><img draggable="false" style="cursor:pointer;" onclick="rotatePhone();return false" src="UI/rotate.png" width="48" alt="Rotate" title="Rotate"></span>' + "</div>";
	else if (stype == "photos") {
		s = '<script type="text/javascript">document.onkeypress = stopRKey;initLightbox();gameState.bLBNoShow=false;\x3c/script>' +
			'<div style="position:absolute;text-align:left;cursor:default;vertical-align:top;overflow-x:hidden;overflow-y:hidden;width:100%;height:100vh;min-height:100vh;z-index:46;border-style:none">' + '<div style="background-color:white;width:95%;height:92%;margin-left:2%;margin-top:2%;"></div>' + "<img draggable='false' style='float:left;position:absolute;max-height:99%;vertical-align:top;padding:0;width:100%;position:absolute;max-height:100vh;height:100vh;border-left:2px;border-style:solid;border-bottom:none;border-top:none;border-right:none;left:0;top:0' src='UI/phone3l.png'>" +
			'<div id="photosdiv" style="position:absolute;top:0px;left:0px;text-align:left;margin:' + (ha + 2) + "px " + wa + "px " + ha + "px " + la + 'px;height:85%;width:92%;overflow:auto">';
		var used = 99;
		for (i = 0; i < nPhoneWallpapers + 1 + arPhotos.length; i++) {
			if (used > 66) {
				used = 0;
				if (i !== 0) s += "</div>";
				s += '<div style="clear:both">'
			}
			if (i == nPhoneWallpapers) img = sPhoneImage;
			else if (i > nPhoneWallpapers) img = arPhotos[i - nPhoneWallpapers - 1];
			else img = "phonewallpaper" + (i + 1) + ".jpg";
			if (img !== "") {
				s += addImageString(img, "32%", "", "", i + " " + img, undefined,
					i >= nPhoneWallpapers ? "photo" + (i - nPhoneWallpapers + 1) * -1 : "wallpaper");
				used += 32
			}
		}
		for (id = 1; id < 353; id++) {
			if (!checkBitFlag(arSMSImages[Math.floor((id - 1) / 32)], (id - 1) % 32 + 1)) continue;
			sDec = "";
			for (k = 0; k < arPeople.length - 2; k++) {
				p = arPeople[k];
				sDec = p.getPersonSMS(id);
				if (sDec !== "") break
			}
			if (sDec === "") continue;
			ar = sDec.split("|");
			for (k = 0; k < ar.length; k++) {
				if (ar[k] === "") continue;
				bTo = ar[k].indexOf("~") != -1;
				if (bTo) sr = ar[k].split("~");
				else sr = ar[k].split("^");
				if (sr.length > 1 && sr[2] !== "")
					if (sr[2].indexOf("<img") == -1) {
						ir = sr[2].split("`");
						if (ir.length > 1) {
							if (used > 35) {
								used = 0;
								s += '</div><div style="clear:both">'
							}
							s += addImageString(p.getImg("!" + ir[0]), "65%", "", "", "", undefined, "photo" + id);
							used += 65
						} else {
							if (used > 66) {
								used = 0;
								s += '</div><div style="clear:both">'
							}
							s += addImageString(p.getImg("!" + sr[2]), "32%", "", "", "", undefined, "photo" + id);
							used += 32
						}
					} else {
						if (used > 66) {
							used = 0;
							s += '</div><div style="clear:both">'
						}
						s += sr[2].split("width:88").join("float:left;width:65");
						used += 32
					}
			}
		}
		s += "</div></div>" + addOptionLink("string", "Close", "showRightBar(-1*" + gameState.nRightBarState +
			");showLeftBar();dispPlace()", "chatblock", "position:absolute;margin-top:0;top:6px;left:5px;margin-left:4%;width:20%") + addOptionLink("string", "Clear", "usePhone('clearphotos')", "chatblock", "position:absolute;margin-top:0;top:6px;left:24%;margin-left:4%;width:20%") + '<span class="zoom-icon" style="position:absolute;top:0px;right:5px"><img draggable="false" style="cursor:pointer;" onclick="rotatePhone();return false" src="UI/rotate.png" width="48" alt="Rotate" title="Rotate"></span>' + "</div>"
	} else if (stype ===
		"gamebig") s = '<script type="text/javascript">document.onkeypress = stopRKey;initLightbox();\x3c/script>' + '<div style="position:absolute;text-align:left;cursor:default;vertical-align:top;overflow-x:hidden;overflow-y:hidden;width:100%;height:100vh;min-height:100vh;z-index:46">' + "<img draggable='false' style='float:left;position:absolute;max-height:99%;vertical-align:top;padding:0;width:100%;position:absolute;max-height:100vh;height:100vh;border-left:2px;border-style:solid;border-bottom:none;border-top:none;border-right:none;left:0;top:0' src='UI/phone3l.png'>" +
		'<div id="game" style="position:absolute;top:0px;left:0px;text-align:left;margin:' + (ha + 4) + "px " + (wa + 4) + "px " + ha + "px " + (la - 4) + 'px;height:85%;width:91%;overflow-y:auto;overflow-x:auto;background-color:white">' + addGame(sno) + "</div>" + addOptionLink("string", "Finish", "showRightBar(-1*gameState.nRightBarState);finishPhoneGame();dispPlace()", "chatblock", "position:absolute;margin-top:0;top:6px;left:5px;margin-left:4%;width:20%", "chatblock") + "</div>";
	if (isBritish()) s = s.split("Setting/").join("UK/");
	else s =
		s.split("Setting/").join("US/");
	if (stype === "" || stype === undefined || stype == "alarm" || stype == "sms" || stype == "clear" || stype == "delete" || stype == "addressbook" || stype == "apps") return s;
	if (!gameState.bPhoneLandscape) s += '<div id="commentdiv" class="comment_content_trans' + (gameState.bCommentLL ? "_ll" : "") + '" onclick="ClearComments();"></div><div id="fadeblack" class="black_overlay"></div>';
	return s
}
var currentGame;
var canvas;
var ctx;

function addGame(id) {
	if (id == "tetris") {
		currentGame = TETRIS;
		return '<div id="game" style="position:absolute;top:9%;left:6%;width:88%;height:71%;background-color:white;overflow-y:auto;overflow-x:hidden;margin-top:0.25em">' + '<audio id="clearsound" src="Sound/pop.mp3" preload="auto"></audio>' + '<canvas width="100" height="300"></canvas>' + "</div>"
	} else if (id == "snake") {
		currentGame = SNAKE;
		return '<div id="game" style="position:absolute;top:9%;left:6%;width:88%;height:71%;background-color:black;overflow-y:auto;overflow-x:hidden;margin-top:0.25em">' +
			'<canvas id="canvas" width="200" height="300" style="background-color:black"></canvas>' + "</div>"
	} else if (id == "pong") {
		currentGame = PONG;
		return "<style>#start-message, #game-over { color:yellow;position:absolute;top:50%;left:23%;text-align:center;font-weight: bold;}</style>" + '<div id="game" style="position:absolute;top:9%;left:6%;width:88%;height:71%;background-color:black;overflow-y:auto;overflow-x:hidden;margin-top:0.25em">' + '<div class="score" style="font-size:1.5em;margin-bottom:1%;color:yellow">Score: <span id="score">0</span></div>' +
			'<div id="playground" style="background:black;width:95%;height:90%;position:relative;overflow:hidden;border:2px solid yellow">' + '<div id="start-message">press any key to start<br/>move &#8592; &#8594;</div>' + '<div id="game-over" style="display:none;">game over<br/>press any key to play again</div>' + '<div id="ball" style="background:yellow;position:absolute;width:30px;height:30px;left:135px;top:100px;border-radius:15px"></div>' + '<div id="racket" style="background:yellow;left:110px;top:360px;position:absolute;width:80px;height:20px"></div>' +
			"</div></div>"
	} else {
		currentGame = PACMAN;
		return '<div id="game" style="position:absolute;top:9%;left:6%;width:88%;height:71%;background-color:black;overflow-y:auto;overflow-x:hidden;margin-top:0.25em"></div>'
	}
}

function playGame() {
	Save("Auto", "Autosave before game");
	currentGame.playGame()
}

function finishPhoneGame() {
	currentGame.finishGame();
	WaitHereOnly(6);
	usePhone("games");
	dispPlace()
}

function getPlaceName(plc) {
	switch (Math.abs(plc)) {
		case 141:
			return "Sacred Clearing";
		case 144:
			return "School Field";
		case 123:
			return "Broken Inn Hotel";
		case 325:
			return "Graveyard";
		case 44:
			return "Kollam Street";
		case 229:
			return "Rathdown Road";
		case 317:
			return "Lady of Our Heavenly Father";
		case 9:
			return "School";
		case 2:
			return "Library";
		case 194:
			return "Shopping Center";
		case 16:
			return perGates.getPersonName() + "' house";
		case 26:
			return "Wild Ranges";
		case 43:
			return "Yoolaroo Drive";
		case 53:
			return "Hidden Room";
		case 94:
			return "Town Hall";
		case 167:
			return "Police Station";
		case 215:
			return "Hospital";
		case 238:
			return "Museum";
		case 360:
			return "Aquarium";
		case 359:
			return "Radio & Television Station";
		case 47:
			return "Park Entrance";
		case 63:
			return "Park Pathway";
		case 38:
			return "Amaranth Place";
		case 37:
			return "Cherise Road";
		case 5:
			return "Dervish Road";
		case 42:
			return "Alley";
		case 87:
			return "Park Walkway";
		case 455:
			return "Celeste Road"
	}
	return ""
}

function getPlaceIdx(ps) {
	ps = ps + "";
	switch (ps.split(" ").join("").split("Glenvale").join("").split("Place").join("Pl").split("Drive").join("Dr").split("Road").join("Rd").split("Home").join("House").split(".").join("").split("'").join("").split("&rsquo;").join("").trim()) {
		case "GinasHouse":
			return 1;
		case "TownHall":
			return 2;
		case "FrenchClassroom":
			return 3;
		case "AnatomyClassroom":
			return 4;
		case "KurndorfsCrypt":
		case "Crypt":
			return 5;
		case "SacredClearing":
			return 6;
		case "RobbinsHouse":
			return 7;
		case "Alley":
		case "Alleyway":
			return 8;
		case "Museum":
			return 9;
		case "GrangersHouse":
		case "GrangerHouse":
			return 10;
		case "KellysHouse":
		case "KellyHouse":
			return 11;
		case "ShoppingCenter":
			return 12;
		case "BrokenInnHotel":
		case "Hotel":
			return 13;
		case "PoliceStation":
			return 14;
		case "Hospital":
			return 15;
		case "WildRanges":
			return 17;
		case "MechanicsShop":
			return 18;
		case "RathdownRd":
			return 19;
		case "CheriseRd":
			return 21;
		case "AmaranthPl":
			return 22;
		case "DervishRd":
			return 23;
		case "NewAgeStore":
			return 24;
		case "TVStation":
		case "RadioStation":
		case "TV&RadioStation":
			return 25;
		case "Aquarium":
			return 26;
		case "Park":
		case "ParkPathway":
		case "ParkBridge":
			return 27;
		case "LadyofOurHeavenlyFatherChurch":
		case "LadyofOurHeavenlyFather":
		case "Church":
			return 28;
		case "Graveyard":
			return 29;
		case "Library":
			return 30;
		case "HistoryClassroom":
			return 20;
		case "CelesteRd":
			return 31
	}
	return 0
}

function getPlaceNameIdx(idx) {
	switch (idx) {
		case 1:
			return "Gina's House";
		case 2:
			return "Town Hall";
		case 3:
			return "French Classroom";
		case 4:
			return "Anatomy Classroom";
		case 5:
			return "Kurndorf's Crypt";
		case 6:
			return "Sacred Clearing";
		case 7:
			return "Robbins House";
		case 8:
			return "Alley";
		case 9:
			return "Museum";
		case 10:
			return "Granger's House";
		case 11:
			return "Kelly House";
		case 12:
			return "Shopping Center";
		case 13:
			return "Broken Inn Hotel";
		case 14:
			return "Police Station";
		case 15:
			return "Hospital";
		case 17:
			return "Wild Ranges";
		case 18:
			return "Mechanic' Shop";
		case 19:
			return "Rathdown Rd";
		case 20:
			return "History Classroom";
		case 21:
			return "Cherise Rd";
		case 22:
			return "Amaranth Pl";
		case 23:
			return "Dervish Rd";
		case 24:
			return "New Age Store";
		case 25:
			return "TV & Radio Station";
		case 26:
			return "Aquarium";
		case 27:
			return "Park";
		case 28:
			return "Lady of Our Heavenly Father Church";
		case 29:
			return "Graveyard";
		case 30:
			return "Library";
		case 31:
			return "Celeste Rd"
	}
	return ""
}

function isPlaceKnown(ps) {
	var idx = getPlaceIdx(ps);
	if (idx == 30) return true;
	if (idx !== 0) return (arPlaces[idx] & 1) !== 0;
	if (typeof ps == "number") {
		ps = getPlaceName(ps);
		if (ps === "") return false;
		return isPlaceKnown(ps)
	}
	ps = ps.split(" ").join("").split("Glenvale").join("").split("Place").join("Pl").split("Drive").join("Dr").split("Road").join("Rd").split("Home").join("House").split(".").join("").split("'").join("").split("&rsquo;").join("").trim();
	if (ps == perGates.getPersonName().split(" ").join("") + "House") ps = "Mansion";
	switch (ps) {
		case "YoolarooDr":
			return isPlaceKnown("GrangerHouse") || isPlaceKnown("RobbinsHouse") || isPlaceKnown("TanikasHouse");
		case "SirRonaldGatesHouse":
		case "SirRonaldGateshouse":
		case "Mansion":
			return perYou.getExperience() > 0;
		case "DuckPond":
			return checkPlaceFlag("Park", 2);
		case "CatacombTunnel":
		case "ChurchTunnel":
			return checkPlaceFlag("Graveyard", 5);
		case "Mausoleum":
			return checkPlaceFlag("Graveyard", 7);
		case "DavysRoom":
			return checkPlaceFlag("RobbinsHouse", 7);
		case "TinasRoom":
			return checkPlaceFlag("RobbinsHouse",
				5);
		case "HiddenRoom":
			return checkPlaceFlag("Alley", 7);
		case "HotelCellar":
			return checkPlaceFlag("Hotel", 10);
		case "ChurchSecretDoor":
			return checkPlaceFlag("Church", 6);
		case "ChurchCourtyard":
			return checkPlaceFlag("Church", 10);
		case "MotherSuperiorsSecretRoom":
			return checkPlaceFlag("Church", 8);
		case "MotherSuperiorsRoom":
			return checkPlaceFlag("Church", 9);
		case "WitchesPrison":
			return getPersonOther("Jessica") > 0 && perKurndorf.getQuestRitual() < 200;
		case "Room113":
			return perJesse.whereNow() == 8 || isDemonQuestDone();
		case "AdamsHouse":
			return getPersonOther("Tess") >= 25 || checkPlaceFlag("RathdownRd", 2);
		case "AnitasLair":
			return checkPlaceFlag("FrenchClassroom", 2);
		case "DonnasRoom":
			return checkPlaceFlag("Hotel", 7);
		case "SchoolField":
			return checkPlaceFlag("HistoryClassroom", 4);
		case "NursesOffice":
			return checkPlaceFlag("HistoryClassroom", 13);
		case "KristinsHouse":
			return checkPlaceFlag("DervishRd", 2);
		case "BartelsHouse":
		case "BartelHouse":
			return checkPlaceFlag("DervishRd", 3);
		case "JohnAdamsOffice":
			return checkPlaceFlag("TownHall",
				2);
		case "BreakRoom":
			return checkPlaceFlag("TownHall", 3);
		case "HospitalICU":
			return checkPlaceFlag("Hospital", 5);
		case "AuntsHouse":
			return checkPlaceFlag("CheriseRd", 2);
		case "PoliceInterrogationRoom":
			return checkPlaceFlag("PoliceStation", 2);
		case "JailCell":
			return checkPlaceFlag("PoliceStation", 3);
		case "Tunnel":
			return checkPlaceFlag("WildRanges", 3);
		case "WalkingTrail":
			return checkPlaceFlag("WildRanges", 5);
		case "MsTitussHouse":
		case "MsTitusHouse":
			return checkPlaceFlag("RathdownRd", 3);
		case "Apartments":
			return checkPlaceFlag("CelesteRd",
				2) || checkPlaceFlag("CelesteRd", 4) || checkPlaceFlag("CelesteRd", 5) || checkPlaceFlag("CelesteRd", 6);
		case "CamrynsApartment":
			return checkPlaceFlag("CelesteRd", 2);
		case "MiasApartment":
			return checkPlaceFlag("CelesteRd", 4);
		case "AbbysApartment":
		case "AbbyApartment":
			return checkPlaceFlag("CelesteRd", 5);
		case "AngelasApartment":
		case "AngelaApartment":
			return checkPlaceFlag("CelesteRd", 6);
		case "TanikasHouse":
		case "TanikaHouse":
			return checkPersonFlag("MrsTanika", 3);
		case "HavenApartments":
			return checkPlaceFlag("ShoppingCenter",
				3);
		case "DianesApartment":
		case "DianeApartment":
			return checkPersonFlag("Diane", 30);
		case "GabbysHouse":
		case "GabbyHouse":
		case "HalliwayHouse":
			return checkPlaceFlag("AmaranthPl", 2);
		case "AvernusClub":
			return checkPlaceFlag("ShoppingCenter", 5);
		case "MayorsApartment":
		case "MayorApartment":
			return checkPlaceFlag("ShoppingCenter", 6);
		case "Campsite":
			return checkPersonFlag("Glenvale", 34)
	}
	return true
}

function setPlaceKnown(ps) {
	var idx = getPlaceIdx(ps);
	if (idx !== 0) {
		arPlaces[idx] = arPlaces[idx] | 1;
		if (idx == 58) setPlaceKnown("Hotel");
		else if (idx == 42) setPlaceKnown("TownHall");
		return
	}
	if (typeof ps == "number") ps = getPlaceName(ps);
	switch (ps.split(" ").join("").split("Glenvale").join("").split("Place").join("Pl").split("Drive").join("Dr").split("Road").join("Rd").split("Home").join("House").split(".").join("").split("'").join("").split("&rsquo;").join("").trim()) {
		case "DuckPond":
			setPlaceFlag("Park", 2);
			return;
		case "CatacombTunnel":
		case "ChurchTunnel":
			setPlaceFlag("Graveyard", 5);
			return;
		case "ChurchCourtyard":
			setPlaceFlag("Church", 10);
			return;
		case "Mausoleum":
			setPlaceFlag("Graveyard", 7);
			return;
		case "DavysRoom":
			setPlaceFlag("RobbinsHouse", 7);
			return;
		case "TinasRoom":
			setPlaceFlag("RobbinsHouse", 5);
			return;
		case "HiddenRoom":
			setPlaceFlag("Alley", 7);
			return;
		case "ChurchSecretDoor":
			setPlaceFlag("Church", 6);
			return;
		case "MotherSuperiorsSecretRoom":
			setPlaceFlag("Church", 8);
			return;
		case "MotherSuperiorsRoom":
			setPlaceFlag("Church",
				9);
			return;
		case "AnitasLair":
			setPlaceFlag("FrenchClassroom", 2);
			return;
		case "DonnasRoom":
			setPlaceFlag("Hotel", 7);
			return;
		case "SchoolField":
			setPlaceFlag("HistoryClassroom", 4);
			return;
		case "KristinsHouse":
			setPlaceFlag("DervishRd", 2);
			return;
		case "BartelsHouse":
		case "BartelHouse":
			setPlaceFlag("DervishRd", 3);
			return;
		case "JohnAdamsOffice":
			setPlaceFlag("TownHall", 2);
			return;
		case "BreakRoom":
			setPlaceFlag("TownHall", 3);
			return;
		case "AdamsHouse":
			setPlaceFlag("RathdownRd", 2);
			setPlaceFlag("RathdownRd", 1);
			return;
		case "HospitalICU":
			setPlaceFlag("Hospital",
				5);
			return;
		case "AuntsHouse":
			setPlaceFlag("CheriseRd", 2);
			return;
		case "PoliceInterrogationRoom":
			setPlaceFlag("PoliceStation", 2);
			return;
		case "JailCell":
			setPlaceFlag("PoliceStation", 3);
			return;
		case "Tunnel":
			setPlaceFlag("WildRanges", 3);
			return;
		case "WalkingTrail":
			setPlaceFlag("WildRanges", 5);
			return;
		case "MsTitussHouse":
		case "MsTitusHouse":
			setPlaceFlag("RathdownRd", 3);
			return;
		case "CamrynsApartment":
		case "CamrynApartment":
			setPlaceFlag("CelesteRd", 2);
			return;
		case "MiasApartment":
		case "MiaApartment":
			setPlaceFlag("CelesteRd",
				4);
			return;
		case "AbbysApartment":
		case "AbbyApartment":
			setPlaceFlag("CelesteRd", 5);
			return;
		case "AngelasApartment":
		case "AngelaApartment":
			setPlaceFlag("CelesteRd", 6);
			return;
		case "TanikasHouse":
		case "TanikaHouse":
			setPersonFlag("MrsTanika", 3);
			return;
		case "HavenApartments":
			setPlaceFlag("ShoppingCenter", 3);
			return;
		case "DianesApartment":
		case "DianeApartment":
			setPersonFlag("Diane", 30);
			setPlaceFlag("ShoppingCenter", 3);
			return;
		case "GabbysHouse":
		case "GabbyHouse":
		case "HalliwayHouse":
			setPlaceFlag("AmaranthPl",
				2);
			return;
		case "AvernusClub":
			setPlaceFlag("ShoppingCenter", 5);
			return;
		case "MayorsApartment":
		case "MayorApartment":
			setPlaceFlag("ShoppingCenter", 6);
			setPlaceFlag("ShoppingCenter", 3);
			return;
		case "NursesOffice":
			setPlaceFlag("HistoryClassroom", 13);
			return
	}
}

function isPlaceBreakIn(ps) {
	return checkPlaceFlag(ps, 31)
}

function setPlaceBreakIn(ps, nVal) {
	setPlaceFlag(ps, 31, nVal)
}

function checkPlaceFlag(ps, flg) {
	var idx = getPlaceIdx(ps);
	if (idx !== 0) return checkBitFlag(arPlaces[idx], flg);
	return false
}

function setPlaceFlag(ps, flg, nVal) {
	var idx = getPlaceIdx(ps);
	if (idx !== 0) arPlaces[idx] = setBitFlag(arPlaces[idx], flg, nVal)
}

function dispPlace(plc, params, txt, ps, click) {
	if (plc === undefined || plc === "") plc = Place;
	if (params === undefined) params = sPlaceParams;
	else sPlaceParams = params;
	if (plc !== undefined && !isNaN(plc)) {
		if (nFromPlace != Place) nFromPlace = Place;
		Place = plc
	}
	gameState.startPlace();
	bPopupShown = false;
	bNewSMS = false;
	bQuestionsShown = false;
	var ie = arPeople.length;
	for (var ir = 0; ir < ie - 1; ir++) {
		arPeople[ir].shown = false;
		arPeople[ir].infoid = 0
	}
	sType = getQueryParam("type");
	var p;
	var bEvt = false;
	for (var i = 0; i < ie; i++) {
		p = arPeople[i];
		bEvt = p.showEvent();
		if (bEvt) {
			if (sType == "momghcharmfail1") txt = "";
			break
		}
	}
	if (!bEvt && sType == "hydromancy") bEvt = CastingHydromancy();
	if (!bEvt) try {
		if (sType.indexOf("dream") != -1 && txt !== undefined) sComment = txt;
		eval("ShowPlace" + plc + "('" + sType + "')")
	} catch (e) {
		console.log("Error in at place " + Place);
		console.log(e)
	}
	if (sType.indexOf("dream") != -1) return;
	if (txt !== undefined && txt !== "") {
		bChat = ps !== "" && ps !== undefined;
		if (sComment !== "") WriteComments(txt + '<p class="gblock" style="width:99%;background-color:Gray;color:black">Additionally</p>' +
			sComment, ps, click);
		else WriteComments(txt, ps, click)
	} else if (sComment !== "")
		if (sComment.indexOf("conversebubble") != -1) WriteCommentsFooter(bChat, bChatLeft);
		else WriteComments(sComment);
	else bChat = false
}

function gotoPlace(plc, params, txt, ps, click) {
	if (gameState.bAllowUndo) gameState.sUnDo = getSaveString("UnDo");
	Leave(false);
	var stype = getQueryParam("type");
	if (stype.indexOf("threesome") != -1 || stype.indexOf("fuck") != -1 || stype.indexOf("sex") != -1 || stype.indexOf("bj") != -1 || stype.indexOf("lick") != -1 || stype.indexOf("strapon") != -1) {
		passTime(false, true);
		passTime(false, true)
	}
	sPlaceParams = "";
	dispPlace(plc, params, txt, ps, click)
}
var gt = "";

function gotoPlaceDelayed(plc, params, txt, ps, click) {
	gt = "gotoPlace(" + plc + ",'" + (params === undefined ? "" : params) + "','" + (txt === undefined ? "" : txt) + "','" + (ps === undefined ? "" : ps) + "'" + (click === undefined ? "" : "," + click) + ")";
	setTimeout(delayEV, 10)
}

function dispPlaceDelayed(plc, params, txt, ps, click) {
	gt = "dispPlace(" + plc + ",'" + (params === undefined ? "" : params) + "','" + (txt === undefined ? "" : txt) + "','" + (ps === undefined ? "" : ps) + "'" + (click === undefined ? "" : "," + click) + ")";
	setTimeout(delayEV, 10)
}

function delayEV() {
	eval(gt);
	gt = ""
}

function showGeneralPlace(title, img, desc, exitlabel, exitto, wid) {
	var md = WritePlaceHeader(false, wid);
	addPlaceTitle(md, title, img);
	if (desc !== undefined && desc !== "") md.write("<p>" + desc + "</p>");
	startQuestions();
	addLinkToPlace(md, exitlabel === undefined ? "exit" : exitlabel, exitto === undefined ? nFromPlace : exitto);
	WritePlaceFooter(md)
}

function addLinkToPlace(doc, lnk, plc, param, txt, ps, js, pclass, psty, nc) {
	if (plc === "" || plc === undefined) plc = "undefined";
	if (param !== undefined && param !== "") plc = plc + ",'" + param + "'";
	else if (txt !== undefined && txt !== "") plc = plc + ",''";
	if (txt !== undefined && txt !== "") {
		if (nc === true) plc = plc + ",'" + txt + "'";
		else plc = plc + ",'" + txt.split('"').join("&quot;").split("'").join("&rsquo;") + "'";
		if (ps !== undefined && ps !== "") plc = plc + ",'" + ps + "'"
	}
	if (js !== undefined && js !== "") js = js + ";";
	else js = "";
	return addOptionLink(doc, lnk, js + "gotoPlace(" + plc +
		");", pclass, psty)
}

function addLinkToPlaceC(doc, desc, plc, param, txt, ps, js, psty) {
	return addLinkToPlace(doc, desc, plc, param, txt, ps, js, "chatblock", psty)
}

function addLinkToPlaceO(doc, desc, plc, param, txt, ps, js, psty) {
	return addLinkToPlace(doc, desc, plc, param, txt, ps, js, "optionblock", psty)
}

function addPopupLinkToPlace(doc, lnk, plc, param, title, body, onclose, psty, blk, noclick, pclass) {
	return addPopupLink(doc, lnk, title, body, blk, (onclose === undefined ? "" : onclose + ";") + "gotoPlace(" + plc + (param === undefined ? "" : ',"' + param + '"') + ")", noclick, pclass, psty)
}

function addPopupLinkToPlaceC(doc, lnk, plc, param, title, body, onclose, psty, blk, noclick) {
	return addPopupLinkToPlace(doc, lnk, plc, param, title, body, onclose, psty, blk, noclick, "chatblock")
}

function addPopupLinkToPlaceO(doc, lnk, plc, param, title, body, onclose, psty, blk, noclick) {
	return addPopupLinkToPlace(doc, lnk, plc, param, title, body, onclose, psty, blk, noclick, "optionblock")
}

function Leave(noev) {
	if (sPossess == "cast") CancelPossession();
	if (Place != 375 && Place != 316) perJesse.setFlag(11, false);
	ClearComments();
	perYou.setFlag(16, false);
	checkInvisible();
	passTime(noev)
}
var arOutside = [481, 480, 465, 455, 421, 406, 360, 359, 344, 325, 324, 320, 319, 281, 238, 229, 216, 215, 194, 167, 144, 141, 123, 94, 87, 86, 63, 47, 44, 43, 42, 38, 37, 26, 25, 16, 15, 9, 5, 2];

function isOutside(plc) {
	if (plc === undefined) plc = Place;
	var op;
	for (var i = plc < 150 ? 20 : 0; i < 40; i++) {
		op = arOutside[i];
		if (op <= plc) return op == plc
	}
	return false
}

function addPlaceImage(doc, img, wid, alg, title, lit, nopeople) {
	if (wid === undefined || wid === "") wid = "95%";
	if (alg != "right") alg = "left";
	if (lit === undefined) {
		lit = true;
		if (!isDay() && Place == gameState.nLastOut) lit = false
	}
	var bgc = lit ? "transparent" : "black";
	var op = lit ? "" : ";filter:alpha(opacity=60);-moz-opacity:0.6;-khtml-opacity:0.6;opacity:0.6";
	if (img.indexOf("UI/") == -1) img = "Images/" + img;
	var s = "";
	if (!lit) {
		s = "<div style='clear:both;background:" + bgc + ";float:" + alg + ";vertical-align:top;max-height:99%;border-width:2px;border-style:solid;width:" +
			wid + ";margin: 0px 4px 0px 0px'>";
		wid = "100%;"
	} else wid += ";margin: 0px 4px 0px 0px;border-width:2px;border-style:solid;clear:both;";
	s += "<img draggable='false' style='float:" + alg + ";position:relative;max-height:99%;vertical-align:top;padding:0;width:" + wid + op + "' src='" + img + "' alt='" + img + "'";
	if (title !== undefined && title !== "") s += " title='" + title.split('"').join("&quot;") + "'>";
	else s += ">";
	if (!lit) s += "</div>";
	if (nopeople !== true) {
		var p;
		var sp;
		for (var i = 0, ie = arPeople.length - 1; i < ie; i++) {
			p = arPeople[i];
			sp = p.addPlaceImageLeft(lit);
			if (sp !== "") s += sp
		}
	}
	if (doc == "comments") addComments(s);
	else if (doc && doc != "string" && doc != "ss") doc.write(s);
	return s
}

function addPlaceTitle(doc, tit, img, taxichance, notable, clr, lit, wid) {
	gameState.plcTitle = tit;
	var p;
	var sp;
	var bAnyImg = false;
	for (var i = 0, ie = arPeople.length - 1; i < ie; i++) {
		p = arPeople[i];
		sp = p.addPlaceImageLeft(lit);
		if (sp !== "") {
			doc.write(sp);
			bAnyImg = true
		}
	}
	if (img !== undefined && img !== "" && !bAnyImg) addPlaceImage(doc, img, wid, "", gameState.plcTitle, lit);
	if (taxichance !== undefined && taxichance > 0)
		if (Math.random() * 100 < taxichance) showTaxi();
		else doc.write('<p style="font-size:small;margin-bottom:-1px"><img draggable="false" src="Images/' +
			(isBritish() ? "UK" : "US") + '/taxirank.png" style="margin: 5px 25px;" width="70" height="70" alt="Taxi Rank"><br>There is an <b>empty</b><br>taxi rank here</p>');
	if (clr !== undefined && clr !== "") gameState.pclr = clr;
	if (notable === undefined || notable === false)
		if (isScreenSmall()) doc.write('</td></tr><tr><td class="td-center">');
		else doc.write('</td><td class="td-center">');
	if (gameState.pclr !== "") doc.write('<p style="text-align:center;font-size:x-large;color:' + gameState.pclr + ';margin-bottom:-1px;margin-top:0px"><b>' +
		gameState.plcTitle + '</b></p><div style="color:' + gameState.pclr + '">');
	else doc.write('<p style="text-align:center;font-size:x-large;margin-bottom:-1px;margin-top:0px"><b>' + gameState.plcTitle + "</b></p>")
}

function WritePlaceHeader(nt, alg, clr, ss, bgimg, doc) {
	if (ss !== undefined && ss !== "") ss = "<style>" + ss + "</style>";
	else ss = "";
	this.nWidth = getWidth(document);
	var bgc;
	if (clr !== undefined) {
		bgc = clr;
		if (clr === "black") gameState.pclr = "white";
		else if (clr === "white") gameState.pclr = "black"
	} else if (nTheme === 0) {
		var hr = getHour();
		if (hr > 4 && hr < 8 || hr > 17 && hr < 21) {
			var tm = nTime % 288;
			if (tm > 144) tm = 312 - tm;
			tm = 216 + Math.sin(Math.PI * ((tm - 60) / 72)) * 32;
			bgc = "#" + byte2Hex(tm) + byte2Hex(tm) + "FF"
		} else bgc = hr > 5 && hr < 20 ? "#F8F8FF" : "#D8D8FF"
	}
	if (bgimg !==
		"" && bgimg !== undefined) bgc = (bgc === undefined ? "" : bgc) + ";background-image:url(" + bgimg + ");background-size:cover;";
	if (doc === undefined) doc = mdCache;
	doc.open();
	var rm = gameState.getRightBarWidth();
	var lm = gameState.getLeftBarWidth();
	doc.write(ss + '<script type="text/javascript">initLightbox();document.onkeypress = stopRKey;\x3c/script>' + "<div id='leftbar' class='sidebar' style='position:fixed;top:0px;left:0px;z-index:45;background-image:url(" + getThemeFolder() + "background.jpg);width:" + lm + "'>" + getLeftBarContents() +
		"</div>" + '<div id="lsdbig1" style="position:absolute;top:0px;left:25px;width:15%;min-width:100px;display:none;z-index:1000">' + getLSD() + "</div>");
	doc.write('<div style="position:fixed;z-index:-2;width:100%;height:100vh;top:0px;left:0px;;overflow-x:hidden;margin:0px 0px 0px 0px' + (bgc !== "" && bgc !== undefined ? ";background-color:" + bgc : "") + '"></div>' + '<div class="mainblock" id="mainbar" style="float:left;z-index:45;margin:0px ' + rm + " 0px " + lm + ";width:calc(100% - " + lm + " - " + rm + ')">');
	if (nt !== true) {
		if (isScreenSmall()) alg =
			'class="td-center"';
		else if (gameState.sLeftColSize !== "") alg = 'class="' + gameState.sLeftColSize + '"';
		else if (alg === undefined || alg === "") alg = 'class="td-left"';
		else if (alg.indexOf("td-") != -1) alg = 'class="' + alg + '"';
		doc.write('<table id="maintable" class="table-main"><tr><td ' + alg + ">")
	}
	return doc
}

function WritePlaceFooter(doc, credits, noitems, nopeople) {
	doc.write('<p style="font-size:0.5em;margin-top:0;margin-bottom:0">&nbsp;</p>');
	if (nopeople !== true) {
		ShowPeople();
		ShowPopupEvents()
	}
	if (noitems !== true) ShowItems();
	addCredits(doc, credits);
	if (gameState.pclr !== "") doc.write("</div>");
	doc.write('</td></tr></table></div><div style="height:100vh;width:100vw"><div id="commentdiv" class="comment_content_trans' + (gameState.bCommentLL ? "_ll" : "") + '" onclick="ClearComments();"></div><div id="fadeblack" class="black_overlay"></div></div>');
	var rm = gameState.getRightBarWidth();
	if (gameState.nRightBarState > 2 || !gameState.bInventoryPopup) doc.write('<div id="rightbar" class="sidebar inventbar" style="position:fixed;top:0px;right:0;z-index:45;' + (gameState.nRightBarState == 2 ? "overflow-y:hidden;" : "") + "width:" + rm + '">' + (gameState.nRightBarState < 3 ? getInventoryContents() : getPhoneContents()) + "</div>");
	else doc.write('<div id="rightbar" class="sidebar inventbar" style="position:fixed;top:0px;right:0;z-index:45;width:' + rm + ';display:none"></div>');
	doc.close()
}

function carRide(ps, askmsg, dropmsg) {
	Leave();
	findPerson(ps);
	var doc = WritePlaceHeader(false, per.uid == "sofia" ? "td-left-med" : "");
	if (dropmsg === undefined) dropmsg = ".";
	if (askmsg === undefined) dropmsg = per.getPersonNameShort() + " smiles and asks where you want to go?";
	per.showPerson(per.uid + "_driving.jpg");
	addPlaceTitle(doc, "Riding with " + per.getPersonNameShort());
	doc.write("<p>" + askmsg + "</p>");
	startQuestionsOnly("Rides:", "", doc);

	function RideTo(doc, plc, desc, param, msg) {
		if (!param) param = "";
		if (Place != plc && isPlaceKnown(desc)) addLinkToPlace(doc,
			desc, plc, param, msg == undefined ? "<b>" + per.getPersonNameShort() + "</b></p><p>" + per.getPersonNameShort() + " takes you to" + (plc != 16 ? " the " : " ") + desc + " and drops you off" + dropmsg : "", "", "", "travelblock")
	}
	if (per.uid == "sofia") {
		RideTo(doc, "", "Sofia in the backseat", "type=sofialimosex", "<b>" + per.getPersonNameShort() + "</b></p><p>" + per.getPersonNameShort() + " arrives but you ask her to join you in the backseat...");
		if (checkPlaceFlag("Hotel", 11)) RideTo(doc, 269, "The Hotel Pool for a Swim", "type=sofiapool")
	}
	RideTo(doc,
		9, "School");
	RideTo(doc, 2, "Library");
	RideTo(doc, 44, "Kollam Street");
	RideTo(doc, 194, "Glenvale Shopping Center");
	RideTo(doc, 43, "Yoolaroo Drive");
	RideTo(doc, 5, "Dervish Road");
	RideTo(doc, 37, "Cherise Rd");
	RideTo(doc, 38, "Amaranth Pl");
	RideTo(doc, 94, "Town Hall");
	RideTo(doc, 123, "Broken Inn Hotel");
	RideTo(doc, 238, "Museum");
	RideTo(doc, 167, "Police Station");
	RideTo(doc, 215, "Hospital");
	RideTo(doc, 317, "Lady of Our Heavenly Father Church");
	if (Place != 16 && Place != 64 && perYou.getExperience() > 0) RideTo(doc, 16, perGates.getPersonName() +
		"&rsquo; house");
	addLinkToPlace(doc, "forget it.", "");
	WritePlaceFooter(doc)
}
var Place;
var nFromPlace;
var sPlaceParams;
var arPlaces = {};

function initialisePlaces() {
	arPlaces = new MakeArray(31, 0);
	Place = 0;
	nFromPlace = 0;
	sPlaceParams = "";
	setPlaceKnown("Cherise Road");
	setPlaceEnscribed(144);
	setPlaceEnscribed(123);
	setPlaceEnscribed(325);
	setPlaceEnscribed(317);
	setPlaceEnscribed(9);
	setPlaceEnscribed(194);
	setPlaceEnscribed(16);
	setPlaceEnscribed(26);
	setPlaceEnscribed(43);
	setPlaceEnscribed(53);
	setPlaceEnscribed(141)
}
var nMaxSaves;
var nMaxQuickSaves;
var bCanUseCookies = cookieTest();
var bUseCookies = bCanUseCookies;
var bCanUseLocalStorage = localSTest();
var bCanUseIndexedDB = window.indexedDB !== undefined;
var bUseIndexedDB = bCanUseIndexedDB && !bUseCookies && !bCanUseLocalStorage;
var DB_STORE_NAME = "saves";
var db;
var SAVE_BASE = "LSD";

function localSTest() {
	try {
		localStorage.setItem(SAVE_BASE + "test", "abc");
		localStorage.removeItem(SAVE_BASE + "test");
		return true
	} catch (e) {
		return false
	}
}

function cookieTest() {
	var bw = get_browser_info();
	if (bw.name === "Firefox" && parseInt(bw.version, 10) > 56) return false;
	document.cookie = SAVE_BASE + "test=abc; path=/";
	if (document.cookie.indexOf(SAVE_BASE + "test=") == -1) return false;
	document.cookie = SAVE_BASE + "test=;Path=/;max-age=0;expires=Thu, 01 Jan 1970 00:00:01 GMT;";
	return true
}

function DoSave() {
	writeLoadSave("save")
}

function DoLoad() {
	bPopupShown = sGender;
	loadGlobalSettings(DoLoad2)
}

function DoLoad2() {
	sGender = bPopupShown;
	bPopupShown = false;
	writeLoadSave("load")
}

function loadUnDo() {
	if (gameState.sUnDo !== "") loadGlobalSettings(loadUnDo2)
}

function loadUnDo2() {
	loadString(gameState.sUnDo)
}

function writeLoadSave(loadorsave, order) {
	bPopupShown = order;
	bChatLeft = [];
	sComment = loadorsave;
	bChat = loadorsave == "load" ? 0 : 1;
	getAllSaves(undefined)
}

function getAllSaves(s) {
	if (s !== undefined) {
		bChatLeft.push(s === "" || s === null ? "" : saveVar(bChat) + s);
		bChat++
	}
	if (bChat <= nMaxSaves + nMaxQuickSaves) getSaveGame(SAVE_BASE + (bChat === 0 ? "Auto" : bChat), getAllSaves);
	else writeLoadSave2(sComment)
}

function writeLoadSave2(loadorsave) {
	var oLeft = gameState.nLeftBarState;
	var oRight = gameState.nRightBarState;
	var order = bPopupShown === undefined ? "time" : bPopupShown;
	bPopupShown = false;
	gameState.nLeftBarState = 2;
	gameState.nRightBarState = 0;
	showLeftBar();
	sComment = "";
	bChat = false;
	var md = WritePlaceHeader(true, undefined, undefined, "@media only screen and (max-width:600px){.savediv { float:left;width:100%;vertical-align:top }}" + "@media screen and (min-width:610px){.savediv { float:left;width:45%;padding:5px;vertical-align:top; }}");
	gameState.startPlace();
	bPopupShown = false;
	md.write("<script type='text/javascript'>function ExportSaveGame() {" + "document.getElementById('exportdata').value = getSaveString('Export');" + "showPopupWindowNowExport();" + "}" + "function ImportSaveGame() { showPopupWindowNowImport(); }" + "\x3c/script>");
	if (loadorsave === "load") md.write('<table style="width:100%;padding:2px;border-collapse:collapse;border-spacing:0"><tr><td class="inventbar" style="width:100%;vertical-align:top"><p style="font-size:xx-large;margin-top:0px;margin-bottom:0px"><b>Load a Saved Position in the Game</b></p></td></tr></table>');
	else md.write('<table style="width:100%;padding:2px;border-collapse:collapse;border-spacing:0"><tr><td class="inventbar" style="width:100%;vertical-align:top"><p style="font-size:xx-large;margin-top:0px;margin-bottom:0px"><b>Save the Game</b></p></td></tr></table>');
	md.write('<p style="font-size:medium">Note that you can have up to <b>' + nMaxSaves + "</b> games saved simultaneously with <b>" + nMaxQuickSaves + "</b> quick saves. Games are saved using <b>" + (bUseCookies ? "Cookies" : bUseIndexedDB ? "IndexedDB" :
		"Browser Local Storage") + "</b>");
	var nTypes = 0;
	if (bCanUseCookies) nTypes++;
	if (bCanUseLocalStorage) nTypes++;
	if (bCanUseIndexedDB) nTypes++;
	if (nTypes > 1) md.write(' <a href="" onClick="toggleCookies();writeLoadSave(\'' + loadorsave + "','" + order + "');return false;\">(click to change);</a>");
	md.write(".<br>You could also <a href=\"\" onClick=\"deleteSaveGame('all');writeLoadSave('" + loadorsave + "','" + order + "');return false;\"><b>delete all saves</b></a></p>");
	setTimeout("hideRightBar()", 10);
	ClearComments(true);
	md.write('<p style="font-size:medium"><b>');
	if (loadorsave === "load") md.write("You can load the following save games:");
	else md.write("You can save your current game over the existing saves or save to a new slot:");
	md.write('</b> (Sort by <a href="" onClick="writeLoadSave(\'' + loadorsave + "','name');return false;\">" + (order == "name" ? "<b>name</b>" : "name") + "</a>" + ' <a href="" onClick="writeLoadSave(\'' + loadorsave + "','time');return false;\">" + (order == "time" ? "<b>time</b>" : "time") + "</a>)" + "</p>");
	sortSaves(bChatLeft, order);
	var col1 = [];
	var col2 = [];
	var idx1 =
		0;
	var idx2 = 0;
	var clr;
	var ci;
	var arUsed = [];
	for (var i = 1; i < bChatLeft.length + 1; i++) {
		var s = bChatLeft[i - 1];
		bChatLeft[i - 1] = "";
		if (s !== "") {
			counter = 0;
			ci = GetNo(s);
			arUsed.push(ci);
			counter++;
			var te = GetStr(s);
			var pth = GetNoShort(s);
			var tn = getSaveTurns(s);
			clr = "";
			if (pth == 1 || pth == 2) {
				if (idx2 % 2 == 1) clr = ' class="savebg"'
			} else if (idx1 % 2 == 1) clr = ' class="savebg"';
			var pclr;
			switch (pth) {
				case 4:
				case 0:
					pclr = nTheme != 0 ? "lightgreen" : "green";
					break;
				case 1:
					pclr = nTheme != 0 ? "lightred" : "red";
					break;
				case 2:
					pclr = nTheme != 0 ? "red" : "darkred";
					break;
				case 3:
					pclr = nTheme != 0 ? "green" : "darkgreen";
					break
			}
			var lclr = "";
			if (ci === 0) lclr += ' style="color:red"';
			else if (ci > nMaxSaves) lclr += ' style="color:green"';
			s = "<td" + clr + ' style="width:40%">';
			if (loadorsave === "load") s += '&nbsp;&nbsp;-  <a href="" onClick="Load(' + (ci === 0 ? "'Auto'" : ci) + ');return false"' + lclr + ">" + te + ' <span style="font-size:x-small">';
			else s += '&nbsp;&nbsp;-  <a href="" onClick="promptAndSave(' + ci + ',1);return false"' + lclr + ">" + te + ' <span style="font-size:x-small">';
			s += "<span style='color:" + pclr +
				"'>Turn</span>" + "(" + tn + ")</span></a></td><td" + clr + ' style="width:10%"><a href="javascript:deleteSaveGame(\'' + SAVE_BASE + (ci === 0 ? "Auto" : ci) + "');writeLoadSave('" + loadorsave + "','" + order + '\')"><span style="font-size:small">(delete)</span></a></td>';
			if (pth == 1 || pth == 2) {
				col2.push(s);
				idx2++
			} else {
				col1.push(s);
				idx1++
			}
		}
	}
	bChatLeft = true;
	var tot = col1.length;
	var k;
	if (tot > 0) {
		md.write('<div class="savediv"><table style="width:100%">');
		for (k = 0; k < tot; k++) {
			md.write("<tr>");
			md.write(col1[k]);
			md.write("</tr>")
		}
		md.write("</table></div>")
	}
	tot =
		col2.length;
	if (tot > 0) {
		md.write('<div class="savediv"><table style="width:100%">');
		for (k = 0; k < tot; k++) {
			md.write("<tr>");
			md.write(col2[k]);
			md.write("</tr>")
		}
		md.write("</table></div>")
	}
	md.write('<div style="clear:both;width:75%;padding-top:1em">');
	if (loadorsave === "load") {
		if (tot === 0) md.write("<b>No current save games</b><br>");
		addOptionLink(md, "Import saved game", "ImportSaveGame()", "chatblock hailup");
		addPopupLink(md, "Load a File", "Select a Save File", '<br><b>Pick a file:</b> <input type="file" id="files" name="file"/>' +
			'<script type="text/javascript">document.getElementById("files").addEventListener("change", handleLoadSaveFile, false);\x3c/script>', true, undefined, true, "chatblock", "height:20vh;top:20vh")
	} else {
		arUsed.sort(function(a, b) {
			return a - b
		});
		var frs = 0;
		ci = 0;
		for (var ia = 0; ia < arUsed.length; ia++) {
			if (arUsed[ia] > ci + 1) {
				frs = arUsed[ia] - 1;
				break
			}
			ci = arUsed[ia]
		}
		if (frs === 0)
			if (arUsed.length === 0) frs = 1;
			else if (arUsed.length < nMaxSaves) frs = arUsed[arUsed.length - 1] + 1;
		if (frs !== 0 || tot === 0) addOptionLink(md, "New saved game", "promptAndSave(" +
			frs + ",0);", "chatblock");
		addOptionLink(md, "Export current game", "ExportSaveGame()", "chatblock");
		addOptionLink(md, "Save to File", "download(getSaveString('Export'),'" + SAVE_BASE + nTime + ".txt','text/plain')", "chatblock")
	}
	addOptionLink(md, sGender === "" ? "return" : "return to the game", "DoReturn()", "optionblock");
	md.write('</div><div id="lightexport" class="white_content" style="background-color:black;color:white;">' + '<a style="color:white;line-height:10px" href="javascript:closePopupWindowNowExport()">Close</a>' +
		"<p style='cursor:pointer;margin-top:-12px;text-align:center;font-size:x-large;margin-bottom:-8px;'><b>Exported Save</b></p>" + "<p style='text-align:left;font-size:large'>This is the save game, copy it to a text file</p>" + "<textarea onclick='this.select()' style='width:100%; height:72%;text-align:left' id='exportdata'></textarea>" + "</div>" + "<script type='text/javascript'>function showPopupWindowNowExport() { " + "document.getElementById('lightexport').style.display='block';" + "document.getElementById('fadeblack').style.display='block';" +
		"};function closePopupWindowNowExport(){" + "document.getElementById('fadeblack').style.display='none';" + "document.getElementById('lightexport').style.display='none';" + "};\x3c/script>" + '<div id="lightimport" class="white_content" style="background-color:black;color:white;">' + '<a style="color:white;line-height:10px" href="javascript:closePopupWindowNowImport()">Close</a>' + "<p style='cursor:pointer;margin-top:-12px;text-align:center;font-size:x-large;margin-bottom:-8px;'><b>Import a Save</b></p>" + "<p style='text-align:left;font-size:large'>Paste the save data below</p>" +
		"<textarea onclick='this.select()' style='width:100%; height:73%;text-align:left' id='importdata'></textarea>" + "<br><br>");
	addOptionLink(md, "Import", "closePopupWindowAndImport()", "hailblock");
	md.write("</div>" + "<script type='text/javascript'>function showPopupWindowNowImport() { " + "document.getElementById('lightimport').style.display='block';" + "document.getElementById('fadeblack').style.display='block';" + "};function closePopupWindowNowImport(){" + "document.getElementById('fadeblack').style.display='none';" +
		"document.getElementById('lightimport').style.display='none';" + "};function closePopupWindowAndImport(){" + "var s = document.getElementById('importdata').value;" + "var d = LZString.decompressFromEncodedURIComponent(s);" + "if (d === null) s = decodeURI(s);" + "else s = d;" + "if (s !== '')\tloadGameString(s);" + "};\x3c/script></div>");
	md.write('<div id="commentdiv" class="comment_content_trans' + (gameState.bCommentLL ? "_ll" : "") + '" onclick="ClearComments();"></div><div id="fadeblack" class="black_overlay"></div>');
	writePageFooter(md);
	gameState.nLeftBarState = oLeft;
	gameState.nRightBarState = oRight;
	updateCSS()
}

function handleLoadSaveFile(evt) {
	var files = evt.target.files;
	var f;
	for (var i = 0; f = files[i]; i++) {
		var reader = new FileReader;
		reader.onloadend = function(evt) {
			if (evt.target.readyState == FileReader.DONE) {
				var s = evt.target.result;
				var d = LZString.decompressFromEncodedURIComponent(s);
				if (d === null) s = decodeURI(s);
				else s = d;
				if (s !== "") loadGameString(s)
			}
		};
		reader.readAsText(f)
	}
}

function toggleCookies() {
	if (bUseCookies) {
		bUseCookies = false;
		if (!bCanUseLocalStorage)
			if (bCanUseIndexedDB) bUseIndexedDB = true;
			else bUseCookies = true
	} else if (bUseIndexedDB) {
		bUseIndexedDB = false;
		if (bCanUseCookies) bUseCookies = true;
		else if (!bCanUseLocalStorage) bUseIndexedDB = true
	} else if (bCanUseIndexedDB) bUseIndexedDB = true;
	else if (bCanUseCookies) bUseCookies = true;
	saveGlobalSettings()
}

function getSaveGame(name, callback) {
	var s;
	var d;
	if (!bUseCookies)
		if (bUseIndexedDB) {
			var store = getObjectStore("readonly");
			var req = store.get(name);
			req.onsuccess = function(evt) {
				var s;
				if (evt.target.result === undefined) s = "";
				else s = evt.target.result.save;
				if (s)
					if (s !== "") {
						d = LZString.decompressFromEncodedURIComponent(s);
						if (d === null || d === "" || d == "null") s = decodeURI(s);
						else s = d
					}
				callback(s)
			};
			req.onerror = function(event) {
				console.error("getSaveGame:Unable to retrieve daa from database!")
			};
			return
		} else {
			s = localStorage.getItem(name);
			if (s !== "") {
				d = LZString.decompressFromEncodedURIComponent(s);
				if (d === null || d === "" || d == "null") s = decodeURI(s);
				else s = d
			}
			if (s === null || s === "" || s == "null") s = "";
			callback(s);
			return
		}
	var arg = name + "=";
	var alen = arg.length;
	var clen = document.cookie.length;
	var i = 0;
	i = document.cookie.indexOf(arg);
	if (i == -1) {
		callback("");
		return
	}
	while (i < clen) {
		var j = i + alen;
		if (document.cookie.substring(i, j) == arg) {
			var endstr = document.cookie.indexOf(";", j);
			if (endstr == -1) endstr = document.cookie.length;
			s = document.cookie.substring(j, endstr);
			if (s !==
				"") {
				d = LZString.decompressFromEncodedURIComponent(s);
				if (d === null || d === "") d = decodeURI(s);
				if (callback !== undefined) callback(d);
				return
			}
		}
		i = document.cookie.indexOf(" ", i) + 1;
		if (i === 0) {
			callback("");
			return
		}
	}
	callback("")
}

function deleteSaveGame(name) {
	if (name == "all") {
		if (bUseIndexedDB) clearObjectStore();
		else {
			for (var i = 1; i <= nMaxSaves + nMaxQuickSaves; i++) deleteSaveGame(SAVE_BASE + i);
			deleteSaveGame(SAVE_BASE + "Auto")
		}
		return
	}
	if (bUseCookies) document.cookie = name + "=; Path=/; max-age=0; expires=Thu, 01 Jan 1970 00:00:01 GMT;";
	else if (bUseIndexedDB) {
		var store = getObjectStore("readwrite");
		var request = store.delete(name);
		request.onsuccess = function(event) {}
	} else localStorage.removeItem(name)
}

function setSaveGame(name, savedata) {
	if (!bUseCookies) {
		if (bUseIndexedDB) {
			var store = getObjectStore("readwrite");
			var request = store.put({
				id: name,
				save: savedata
			});
			request.onsuccess = function(event) {};
			request.onerror = function(event) {
				alert("Unable to add save to the database! ")
			}
		} else localStorage.setItem(name, savedata);
		return
	}
	var expdate = new Date;
	var base = new Date(0);
	var skew = base.getTime();
	if (skew > 0) expdate.setTime(expdate.getTime() - skew);
	expdate.setTime(expdate.getTime() + 300 * 25 * 60 * 60 * 1E3);
	document.cookie =
		name + "=" + savedata + (expdate ? "; expires=" + expdate.toGMTString() : "") + "; path=/"
}

function promptAndSave(no, exist) {
	sComment = SAVE_BASE + no;
	if (exist == 1) getSaveGame(sComment, promptAndSaveName);
	else promptAndSaveName("")
}

function promptAndSaveName(s) {
	var n = getSaveName(s);
	var na = prompt("Name of the saved game?", n);
	if (na !== null && na !== "") {
		saveGlobalSettings();
		s = getSaveString(na.substring(0, 2096));
		setSaveGame(sComment, s);
		gameState.sUnDo = "";
		sComment = "";
		showRightBar();
		dispPlace()
	} else {
		if (na === "") alert("Please choose a name for your saved game.");
		sComment = ""
	}
}

function Save(no, name) {
	saveGlobalSettings();
	setSaveGame(SAVE_BASE + no, getSaveString(name))
}

function QuickSave() {
	gameState.nCurrentQS = gameState.nCurrentQS >= nMaxQuickSaves ? 1 : gameState.nCurrentQS + 1;
	saveGlobalSettings();
	setSaveGame(SAVE_BASE + (nMaxSaves + gameState.nCurrentQS), getSaveString("Quick Save " + gameState.nCurrentQS))
}

function saveVar(no) {
	var t = (no === undefined ? "" : no) + "";
	var ln = t.length;
	if (ln > 35)
		if (ln >= 36 * 36) {
			var v3 = ln - Math.floor(ln / 36) * 36;
			var v2 = Math.floor(ln / 36);
			var v1 = Math.floor(ln / (36 * 36));
			return "#" + (v1.toString(36) + "") + (v2.toString(36) + "") + (v3.toString(36) + "") + t
		} else {
			var v = ln - Math.floor(ln / 36) * 36;
			var s = "!" + (v.toString(36) + "");
			v = Math.floor(ln / 36);
			return s + v.toString(36) + t
		}
	return ln.toString(36) + t
}

function saveVarShortNo(no) {
	return no.toString(36)
}
var counter;

function getSaveName(s) {
	counter = 1;
	return GetStr(s)
}

function getSaveTurns(s) {
	return GetNo(s) - 100
}

function GetNo(s) {
	var tem = parseInt(s.charAt(counter), 36);
	if (isNaN(tem)) return 0;
	counter++;
	var i = counter;
	counter += tem;
	return parseFloat(s.substr(i, tem))
}

function GetNoShort(s, def) {
	var tem = parseInt(s.charAt(counter), 36);
	counter++;
	return isNaN(tem) ? def === undefined ? 0 : def : tem
}

function GetStr(s) {
	var i = counter;
	var tem;
	if (s.charAt(i) == "!") {
		tem = parseInt(s.charAt(i + 1), 36) + parseInt(s.charAt(i + 2), 36) * 36;
		counter += 2
	} else if (s.charAt(i) == "#") {
		tem = parseInt(s.charAt(i + 1), 36) + parseInt(s.charAt(i + 2), 36) * 36 + parseInt(s.charAt(i + 3), 36) * (36 * 36);
		counter += 3
	} else tem = parseInt(s.charAt(i), 36);
	counter++;
	i = counter;
	counter += tem;
	return s.substr(i, tem)
}

function GetSingleChar(s) {
	counter++;
	return s.charAt(counter - 1)
}

function Load(no) {
	getSaveGame(SAVE_BASE + no, loadGameString)
}

function loadString(s) {
	var d = LZString.decompressFromEncodedURIComponent(s);
	if (d === null) s = decodeURI(s);
	else s = d;
	if (s !== "") loadGameString(s)
}

function loadGlobalSettings(callback) {
	sComment = callback;
	bUseCookies = bCanUseCookies;
	bUseIndexedDB = bCanUseIndexedDB && !bCanUseCookies && !bCanUseLocalStorage;
	getSaveGame(SAVE_BASE + "Global", loadGlobalSettingsLoaded)
}

function openDb() {
	var DB_NAME = "aspellforall";
	var DB_VERSION = 1;
	if (!bCanUseIndexedDB) return;
	var req = indexedDB.open(DB_NAME, DB_VERSION);
	req.onsuccess = function(evt) {
		db = this.result
	};
	req.onerror = function(evt) {
		console.error("openDb:", evt.target.errorCode)
	};
	req.onupgradeneeded = function(evt) {
		console.log("openDb.onupgradeneeded");
		evt.currentTarget.result.createObjectStore(DB_STORE_NAME, {
			keyPath: "id"
		})
	}
}
openDb();

function getObjectStore(mode) {
	return db.transaction(DB_STORE_NAME, mode).objectStore(DB_STORE_NAME)
}

function clearObjectStore() {
	var store = getObjectStore("readwrite");
	var req = store.clear();
	req.onsuccess = function(evt) {}
}

function sortSaves(ar, order) {
	ar.sort(function(sa, sb) {
		counter = 0;
		var cia = GetNo(sa);
		if (cia === 0 || cia > nMaxSaves) return -1;
		counter++;
		var sna = GetStr(sa);
		counter++;
		var nTimeA = GetNo(sa);
		counter = 0;
		var cib = GetNo(sb);
		if (cib === 0 || cib > nMaxSaves) return 1;
		counter++;
		var snb = GetStr(sb);
		counter++;
		var nTimeB = GetNo(sb);
		if (order == "time") return nTimeA - nTimeB;
		return sna.localeCompare(snb)
	})
}

function loadGlobalSettingsLoaded(s) {
	if (s !== "") {
		counter = 0;
		gameState.bCommentLL = GetNoShort(s) === 1;
		bUseCookies = GetNoShort(s) === 1;
		bUseIndexedDB = GetNoShort(s) === 1;
		gameState.nLeftBarState = GetNoShort(s);
		gameState.nRightBarState = GetNoShort(s);
		setPuzzles(GetNoShort(s, 1) === 1);
		sGender = GetSingleChar(s);
		if (sGender == "m") sGender = "man";
		else sGender = "woman";
		setExplicit(GetNoShort(s, 1) === 1);
		sCurrency = GetStr(s);
		bCheating = GetNoShort(s) === 1;
		setRunes(GetNoShort(s, 1) === 1);
		sAvatarFolder = GetStr(s);
		nTheme = GetNoShort(s);
		if (nTheme >
			gameState.nMaxThemes) nTheme = 0;
		gameState.bUseIcons = GetNoShort(s) === 1;
		gameState.bAllPlaces = GetNoShort(s) === 1;
		gameState.bAllowUndo = GetNoShort(s) === 1;
		gameState.bInventoryPopup = GetNoShort(s) === 1
	}
	var cb = sComment;
	sComment = "";
	cb()
}

function saveGlobalSettings() {
	var bOldUseCookies = bUseCookies;
	var bOldUseIndexedDB = bUseIndexedDB;
	bUseCookies = bCanUseCookies;
	bUseIndexedDB = bCanUseIndexedDB && !bCanUseCookies && !bCanUseLocalStorage;
	var s = saveVarShortNo(gameState.bCommentLL ? 1 : 0);
	s += saveVarShortNo(bOldUseCookies ? 1 : 0);
	s += saveVarShortNo(bOldUseIndexedDB ? 1 : 0);
	s += saveVarShortNo(gameState.nLeftBarState);
	s += saveVarShortNo(gameState.nRightBarState);
	s += saveVarShortNo(isPuzzles() ? 1 : 0);
	s += sGender.charAt(0);
	s += saveVarShortNo(isExplicit(true) ? 1 : 0);
	s += saveVar(sCurrency);
	s += saveVarShortNo(bCheating ? 1 : 0);
	s += saveVarShortNo(isRunes() ? 1 : 0);
	s += saveVar(sAvatarFolder);
	s += saveVarShortNo(nTheme);
	s += saveVarShortNo(gameState.bUseIcons ? 1 : 0);
	s += saveVarShortNo(gameState.bAllPlaces ? 1 : 0);
	s += saveVarShortNo(gameState.bAllowUndo ? 1 : 0);
	s += saveVarShortNo(gameState.bInventoryPopup ? 1 : 0);
	setSaveGame(SAVE_BASE + "Global", s);
	bUseCookies = bOldUseCookies;
	bUseIndexedDB = bOldUseIndexedDB
}

function getSaveString(name) {
	var s = "K" + saveVar(name);
	s += saveVarShortNo(isMurderPath() ? isMurderPath(true) ? 2 : 1 : isCharmedPath() ? isGoodPath() ? 4 : 0 : 3);
	var i, ie;
	s += saveVar(nTime);
	ie = arPlaces.length;
	s += saveVar(ie);
	for (i = 1; i <= ie; i++) s += saveVar(arPlaces[i]);
	ie = T.length;
	s += saveVar(ie);
	for (i = 0; i < ie; i++) {
		s += saveVar(T[i].item);
		s += saveVar(T[i].place)
	}
	ie = vTimedEvent.length;
	s += saveVar(ie);
	for (i = 0; i < ie; i++) {
		s += saveVar(vTimedEvent[i].evnt);
		s += saveVar(vTimedEvent[i].timer)
	}
	s += saveVar(Place);
	s += saveVar(nMana);
	s += saveVar(nMoney);
	s += sGender.charAt(0);
	s += saveVarShortNo(isExplicit(true) ? 1 : 0);
	s += saveVar(sPlaceParams);
	s += saveVar(nFromPlace);
	s += saveVar(sAvatarFolder);
	s += saveVar(sPossess);
	s += saveVar(sCurrency);
	s += saveVarShortNo(bCheating ? 1 : 0);
	s += saveVarShortNo(isRunes() ? 1 : 0);
	s += saveVar(nPhoneWallpapers);
	ie = arPeople.length;
	s += saveVar(ie);
	for (i = 0; i < ie; i++) s += arPeople[i].savePerson();
	s += saveVar(perYou.name);
	ie = arHexagrams.length;
	s += saveVar(ie);
	for (i = 0; i < ie; i++) {
		s += saveVar(arHexagrams[i].name);
		s += saveVar(arHexagrams[i].place)
	}
	s += saveVarShortNo(isPuzzles() ?
		1 : 0);
	ie = arSMS.length;
	s += saveVar(ie);
	for (i = 0; i < ie; i++) s += saveVar(arSMS[i]);
	s += saveVar(sPhoneImage);
	ie = arPhotos.length;
	s += saveVar(ie);
	for (i = 0; i < arPhotos.length; i++) s += saveVar(arPhotos[i]);
	ie = arSMSImages.length;
	s += saveVar(ie);
	for (i = 0; i < ie; i++) s += saveVar(arSMSImages[i]);
	s += saveVarShortNo(gameState.bPhoneLandscape ? 1 : 0);
	s += saveVarShortNo(gameState.bAllowUndo ? 1 : 0);
	s += saveVar(nUnreadSMS);
	return LZString.compressToEncodedURIComponent(s)
}

function loadGameString(s) {
	var oUse = gameState.bUseIcons;
	var oLeft = gameState.nLeftBarState;
	var oRight = gameState.nRightBarState;
	var oIPop = gameState.bInventoryPopup;
	initialiseGame();
	gameState.nLeftBarState = oLeft;
	gameState.nRightBarState = oRight;
	gameState.bUseIcons = oUse;
	gameState.bInventoryPopup = oIPop;
	var nType = parseInt(s.charAt(0), 36);
	counter = 1;
	GetStr(s);
	var plc;
	var i;
	var id;
	var j;
	counter++;
	nTime = GetNo(s);
	idx = GetNo(s);
	arPlaces = new MakeArray(31, 0);
	for (i = 1; i <= idx; i++)
		if (i > 31) GetNo(s);
		else arPlaces[i] = GetNo(s);
	var idx;
	idx = GetNo(s);
	T = [];
	for (i = 1; i <= idx; i++) {
		var itm = GetNo(s);
		plc = GetNo(s);
		T.push(new OutsideItem(itm, plc))
	}
	idx = GetNo(s);
	for (i = 0; i < idx; i++) {
		var se = GetStr(s);
		var t = GetNo(s);
		vTimedEvent.push(new TimedEvent(se, t))
	}
	Place = GetNo(s);
	nMana = GetNo(s);
	nMoney = GetNo(s);
	sGender = GetSingleChar(s);
	if (sGender == "m") sGender = "man";
	else if (sGender == "w") sGender = "woman";
	else sGender = "futa";
	setExplicit(GetNoShort(s) === 1);
	sPlaceParams = GetStr(s);
	nFromPlace = GetNo(s);
	sAvatarFolder = GetStr(s);
	sPossess = GetStr(s);
	sCurrency = GetStr(s);
	bCheating = GetNoShort(s) === 1;
	setRunes(GetNoShort(s) === 1);
	nPhoneWallpapers = GetNo(s);
	if (sPossess !== "" && sPossess != "cast") perYourBody = findPerson(sPossess);
	else perYourBody = perYou;
	if (perYourBody === null) perYourBody = perYou;
	idx = GetNo(s);
	for (i = 0; i < idx; i++) {
		id = GetStr(s);
		if (findPerson(id) !== null) per.loadPerson(s, nType);
		else alert("unable to load " + id)
	}
	perYou.name = GetStr(s);
	arHexagrams = new Array;
	idx = GetNo(s);
	for (i = 0; i < idx; i++) {
		var nm = GetStr(s);
		plc = GetNo(s);
		if (!isPlaceEnscribed(plc)) arHexagrams.push(new Hexagram(nm,
			plc))
	}
	setPuzzles(GetNoShort(s) === 1);
	idx = GetNo(s);
	arSMS = new Array;
	for (i = 0; i < idx; i++) arSMS.push(GetNo(s));
	sPhoneImage = GetStr(s);
	if (sPhoneImage.substr(0, 7) == "Images/") sPhoneImage = sPhoneImage.substr(7);
	idx = GetNo(s);
	arPhotos = new Array;
	for (i = 0; i < idx; i++) {
		var img = GetStr(s);
		for (j = 0; j < i; j++)
			if (img == arPhotos[j]) {
				img = "";
				break
			}
		if (img !== "") arPhotos.push(img);
		if (sPhoneImage !== "") {
			for (j = 0; j < idx; j++)
				if (sPhoneImage == arPhotos[j]) break;
			if (j < i) arPhotos.splice(j, 1)
		}
	}
	idx = GetNo(s);
	arSMSImages = new Array;
	for (i = 0; i < 11; i++)
		if (i <
			idx) arSMSImages.push(GetNo(s));
		else arSMSImages.push(0);
	gameState.bPhoneLandscape = GetNoShort(s) === 1;
	gameState.bPhoneLandscape = true;
	gameState.bAllowUndo = GetNoShort(s) === 1;
	nUnreadSMS = GetNo(s);
	gameState.sUnDo = s.substr(counter);
	if (nType < 19) {
		if (checkPersonFlag("MsTitus", 8)) setPersonFlag("MsTitus", 14);
		findPerson("MrsGranger");
		if (per.dress === "") per.dress = per.getNextDress();
		findPerson("Tina");
		if (per.dress === "") per.dress = "Normal";
		if (perJesse.getDemonPath() >= 50 && wherePerson("Seraphina") === 0) movePerson("Seraphina",
			282);
		findPerson("Mom");
		if (per.isCharmedBy()) {
			per.moveThem(154);
			per.unCharmThem()
		}
		if (per.checkFlag(14)) {
			per.setFlag(14, false);
			per.setFlag(15, false);
			per.setFlag(16, false);
			per.setFlag(26, false);
			per.setFlag(19, false);
			per.moveThem(154)
		}
		findPerson("Catherine");
		if (per.isCharmedBy()) per.setFlag(12);
		if (checkPersonFlag("Sarah", 2) && !isCharmedBy("Vampyre", "Sarah")) setPersonFlag("Sarah", 8);
		if (checkPersonFlag("Tess", 8) && per.place == 46) per.setFlag(6);
		if (isCharmedBy("Sarah")) per.setFlag(9);
		findPerson("JohnAdams");
		if (per.place !== 0 && per.place != 230) per.place = 230;
		if (per.dress === "") per.dress = "Male";
		per.setFlag(30, false);
		if (nPhoneWallpapers == 7) nPhoneWallpapers = 20;
		if (Place == 105) Place = 93;
		else if (Place == 309) Place = 371
	} else if (nType == 19) {
		findPerson("JohnAdams");
		if (per.dress === "") per.dress = "Male";
		if (Place == 105) Place = 93;
		else if (Place == 309) Place = 371;
		if (isCharmedBy("Tina") && isCharmedBy("MrsRobbins")) setPlaceKnown("TinasRoom");
		findPerson("Mom");
		if (per.place == 154 && per.checkFlag(2) && !per.checkFlag(3) && !per.isCharmedBy()) per.setFlag(1)
	}
	findPerson("Kate");
	if (per.isCharmedBy() && per.place == 139.5) per.place = 1;
	findPerson("NurseSandra");
	if (per.isCharmed() || per.other > 1) per.setFlag(2);
	findPerson("Angela");
	if (per.dress === "") per.dress = "Small";
	findPerson("Gabby");
	if (per.checkFlag(13) && per.isCharmedBy()) per.setFlag(13, false);
	findPerson("MrTanika");
	if (per.place == 460) per.place = 470;
	if (nPhoneWallpapers > 20) nPhoneWallpapers = 20;
	if (gameState.nRightBarState != 1 && gameState.nRightBarState != 2 && gameState.nRightBarState != 3 && gameState.nRightBarState != 4) gameState.nRightBarState =
		2;
	if (whereItem(38) == 1E3 && getItemName(37) != "String & Magnet") setItemName(37, "String & Magnet");
	if (isSpellKnown("Shielded Charm") && getItemName(14) != "Shielded Charm") setItemName(14, "Shielded Charm");
	if (isDemonBound()) getBaseItemObj(48).image = "artifact3.jpg";
	if (wherePerson("Ghost") == -64) getBaseItemObj(64).image = "crystalring-glow.jpg";
	updateLocale();
	updatePath();
	sComment = "";
	ClearComments();
	if (isScreenSmall()) gameState.nLeftBarState = 2;
	showSideBars();
	updateCSS();
	dispPlace()
}

function CastingTeleport() {
	if (Place == 241 && getQueryParam("type") !== "" || Place == 66) addComments("You are handcuffed and the metal seems to block the spell from working.");
	else if (Place == 142) {
		ShotByAnita();
		return "nofooter"
	} else if (perKurndorf.getQuestSeance() >= 50 && perKurndorf.getQuestSeance() < 100) addComments("You attempt to summon the power of Teleportation, but the spell fails to penetrate the power of the S\u00e9ance...");
	else if (nMana === 0) addComments("Not enough mana.");
	else if (isPossess()) addComments("You cannot teleport while possessing someone else's body.");
	else {
		var plc = Place;
		if (perYou.health === 0) plc = 999;
		switch (plc) {
			case 141:
				if (sType != "banshee" && sType != "monster") break;
			case 109:
			case 198:
			case 995:
			case 996:
			case 997:
			case 999:
				addComments('<p>"Alas, it is too late to teleport away, for your lips will no longer form the words necessary."</p>');
				return ""
		}
		TeleportTo();
		return "nofooter"
	}
}

function Hexagram(nm, plc) {
	this.name = nm;
	this.place = plc === undefined ? 0 : plc
}

function attuneHexagram(reset) {
	setPlaceAttuned(Place);
	WaitHereOnly(reset === true ? 2 : 6);
	dispPlace();
	bChat = false;
	if (reset === true) WriteComments("You spend some time and break the attunement for this place");
	else WriteComments("You spend some time and do the ritual of attunement")
}

function enscribeHexagram(plc, nm) {
	if (nMana > 0) {
		AddMana(-1);
		if (plc === undefined) plc = Place;
		setPlaceEnscribed(plc, nm);
		setPlaceAttuned(plc);
		WaitHereOnly(6);
		dispPlace();
		bChat = false;
		WriteComments("You spend some time and carve a hexagram into a tree using your pocketknife and then attune yourself to it")
	} else WriteComments("You do not have enough mana to power the hexagram")
}

function isPlaceAttuned(plc) {
	for (var i = 0, ie = arHexagrams.length; i < ie; i++)
		if (Math.abs(arHexagrams[i].place) == Math.abs(plc)) return arHexagrams[i].place < 0;
	return false
}

function setPlaceAttuned(plc) {
	for (var i = 0, ie = arHexagrams.length; i < ie; i++)
		if (arHexagrams[i].place == plc) {
			arHexagrams[i].place = plc * -1;
			return
		} else if (arHexagrams[i].place == -1 * plc) {
		arHexagrams[i].place = plc;
		return
	}
}

function isPlaceEnscribed(plc) {
	plc = Math.abs(plc);
	for (var i = 0, ie = arHexagrams.length; i < ie; i++)
		if (Math.abs(arHexagrams[i].place) == plc) return true;
	return false
}

function setPlaceEnscribed(plc, nm) {
	if (isPlaceEnscribed(plc)) return;
	var hx = new Hexagram(getPlaceName(plc) !== "" ? "" : nm, plc);
	arHexagrams.push(hx)
}

function CastTeleportSpell(sPlace, att) {
	showSideBars();
	if (nMana > 0) {
		setPlaceBreakIn("Aquarium", false);
		setPlaceBreakIn("Museum", false);
		setPlaceBreakIn("TownHall", false);
		setPlaceBreakIn("HistoryClassroom", false);
		setPlaceBreakIn("Library", false);
		if (isPossess("cast")) CancelPossession();
		checkInvisible();
		if (att === true) {
			if (Math.random() > .33) AddMana(-1)
		} else AddMana(-1);
		if (Place == 299 && getQueryParam("type") == "boundfree") {
			Leave();
			return
		}
		if (getPersonOther("OfficerSmith") == 100) {
			per.health = 0;
			per.other = 900
		}
		var s =
			"";
		var ps = "";
		if (Place == 202) Leave202();
		if (Place == 252 && wherePerson("Anita") === 0 && !isCharmedBy("Anita", "You")) LeaveLair();
		else if (Place == 247 && getPersonOther("Vampyre") == 60) setPersonOther("Vampyre", 1E3);
		else if (Place == 184 && getQueryParam("type") == "plan") {
			setPersonFlag("Kate", 4);
			movePerson("Kate", 184);
			s = "As you start to vanish Kate looks pissed off at your apparent cowardice! and runs toward the room Davy is in.<br>You read the spell and it works.";
			ps = "Kate"
		} else s = "You cast the spell and you fade out and then appear in the new place.";
		if (sPlace == 70 && !isShopOpen(2)) setPlaceBreakIn("HistoryClassroom");
		else if (sPlace == 177)
			if (isCharmedBy("MrsGranger") && per.dress === "") per.dress = per.getNextDress();
		if (!perYou.checkFlag(21))
			if (wherePerson("Vampyre") == -1) movePerson("Vampyre", Place == 325 ? 325 : 247);
			else if (wherePerson("Diane") == -1) movePerson("Diane", 168);
		else {
			if (wherePerson("Tina") == -1) movePerson("Tina", 163)
		} else if (sPlace == 319) {
			s = EnterChurch(319, true);
			if (s !== "") ps = per.name + " Screams"
		}
		gameState.nLastOut = 0;
		dispPlace(sPlace, "", s, ps)
	} else {
		WriteComments("You do not have enough mana to cast the spell.");
		dispPlace()
	}
}

function TeleportTo() {
	hideSidebars();
	var plc = Place;
	var nm = "";
	if (gameState.plcTitle !== "") nm = gameState.plcTitle.split("Glenvale ").join("");
	else nm = getPlaceName(Place);
	var bHere = false;
	var i;
	var ie;
	if (perYou.checkFlag(21)) {
		var p;
		for (i = 0, ie = arPeople.length - 2; i < ie; i++) {
			p = arPeople[i];
			if (p.isPlaceImageRight() && !p.shown && p.health !== 0) {
				bHere = true;
				break
			}
		}
	}
	var cols = isScreenSmall() ? 1 : bHere ? 3 : 2;
	var doc = WritePlaceHeader(true, "", nTheme === 0 ? "#FFFFFF" : "");
	gameState.plcTitle = "Teleport";
	doc.write('<table class="table-main">' + "<tr>" +
		"<td" + (cols > 1 ? ' colspan="' + cols + '"' : "") + " style=\"width:100%;background-image: url('" + getThemeFolder() + "background.jpg')\">" + '<p style="text-align:center;font-size:x-large;"><b>Teleport Spell</b></p>' + "</td>" + "</tr><tr><td" + (cols > 1 ? ' colspan="' + cols + '"' : "") + ">" + "<p>You murmur the words of Shio Stin Mur, causing a light mist to swirl around your feet. You can teleport " + (perYou.checkFlag(21) ? "yourself and other willing people" : "yourself only") + " to any of the places below for one mana:</p>" + '</td><tr><td style="' +
		(cols > 1 ? "width:15%;" : "") + 'vertical-align:top">' + "<b>Choose a location:</b><br>");

	function Teleports(doc, plc, desc) {
		if (isPlaceKnown(desc) && Place != plc) addOptionLink(doc, desc, "CastTeleportSpell(" + plc + ")", "travelblock", "width:90%")
	}
	var bHex = isPlaceEnscribed(Place);
	if (isOutside() && perYou.checkFlag(21) && !bHex) addOptionLink(doc, "enscribe and attune hexagram", "showSideBars();enscribeHexagram(" + Place + ",'" + nm.split("'").join("") + "')", "optionblock", "width:90%");
	if (bHex) addOptionLink(doc, (isPlaceAttuned(Place) ?
		"un-attune" : "attune") + " hexagram", "showSideBars();attuneHexagram(" + isPlaceAttuned(Place) + ")", "optionblock", "width:90%");
	if (Place == 141 && perYou.checkFlag(45) && !isDay()) Teleports(doc, 993, "<b>Elian</b>");
	Teleports(doc, 46, "Your bedroom");
	var arTemp = [];
	for (i = 0, ie = arHexagrams.length; i < ie; i++)
		if (arHexagrams[i].place < 0) arTemp.push(new Hexagram(arHexagrams[i].name === "" ? getPlaceName(arHexagrams[i].place * -1) : arHexagrams[i].name, arHexagrams[i].place * -1));
	if (perYou.checkFlag(21)) {
		arTemp.push(new Hexagram("Kurndorf's Crypt",
			247));
		arTemp.push(new Hexagram("Hotel Cellar", 161));
		arTemp.push(new Hexagram("Robbins' House", 176));
		arTemp.push(new Hexagram("Granger House", 177));
		arTemp.push(new Hexagram("Adams House", 230));
		arTemp.push(new Hexagram("School Hallway", 70))
	}
	arTemp.sort(function(a, b) {
		return a.name > b.name
	});
	for (i = 0; i < arTemp.length; i++) Teleports(doc, arTemp[i].place, arTemp[i].name);
	addOptionLink(doc, "Cancel the spell", "showSideBars();Leave(true);dispPlace()", "optionblock", "width:90%");
	doc.write("<br></td>");
	if (cols == 1) doc.write("</tr><tr>");
	doc.write('<td style="color:black;overflow-y:auto;overflow-x:auto' + (cols > 1 ? ";width:" + (bHere ? "70%" : "85%") : "") + ';background-image:url(UI/map/mapbg.jpg);background-size:cover">' + "<b>Click on a location with a hexagram to teleport to:</b>");
	doc.write(getMapHTML("100%", "100%", function(id) {
		var s;
		if (id == 123 && perYou.checkFlag(21) && isPlaceKnown("Hotel Cellar")) s = "WriteComments(&quot;" + "<div style='margin-top:1em;margin-bottom:1em;margin-left:2em;margin-right:2em;cursor:default'>" + "<table><tr><td width='80%'><p style='text-align:center'>Where in the Broken Inn Hotel do you focus the spell on?</p>" +
			addOptionLink("ss", "Outside", "CastTeleportSpell(123)") + addOptionLink("ss", "Cellar", "CastTeleportSpell(161)") + "</td><td width='20%'><img src='Images/hotel1.jpg' style='width:95%' alt='Hotel'></td></tr></table>" + "&quot;)";
		else if (id == 9 && perYou.checkFlag(21)) s = "WriteComments(&quot;" + "<div style='margin-top:1em;margin-bottom:1em;margin-left:2em;margin-right:2em;cursor:default'>" + "<table><tr><td width='80%'><p style='text-align:center'>Where in Glenvale High School do you focus the spell on?</p>" + addOptionLink("ss",
			"Outside", "CastTeleportSpell(9)") + addOptionLink("ss", "Hallway", "CastTeleportSpell(70)") + "</td><td width='20%'><img src='Images/school1.jpg' style='width:95%' alt='School'></td></tr></table>" + "&quot;)";
		else if (id == 317 && isPlaceAttuned(319))
			if (!isPlaceAttuned(317)) s = "CastTeleportSpell(319)";
			else s = "WriteComments(&quot;" + "<div style='margin-top:1em;margin-bottom:1em;margin-left:2em;margin-right:2em;cursor:default'>" + "<table><tr><td width='80%'><p style='text-align:center'>Where in the Church do you focus the spell on?</p>" +
				addOptionLink("ss", "Outside", "CastTeleportSpell(317)") + addOptionLink("ss", "Courtyard", "CastTeleportSpell(319)") + "</td><td width='20%'><img src='Images/church1.jpg' style='width:95%' alt='Church'></td></tr></table>" + "&quot;)";
		else if (id == 26 && perYou.checkFlag(21) && isPlaceKnown("KurndorfsCrypt"))
			if (!!isPlaceAttuned(26)) s = "CastTeleportSpell(247)";
			else s = "WriteComments(&quot;" + "<div style='margin-top:1em;margin-bottom:1em;margin-left:2em;margin-right:2em;cursor:default'>" + "<table><tr><td width='80%'><p style='text-align:center'>Where in the Wild Ranges do you focus the spell on?</p>" +
				addOptionLink("ss", "Outside", "CastTeleportSpell(26)") + addOptionLink("ss", "Kurndorf's Crypt", "CastTeleportSpell(247)") + "</td><td width='20%'><img src='Images/stones.jpg' style='width:95%' alt='Wild Ranges'></td></tr></table>" + "&quot;)";
		else if (id == 42 && !isPlaceAttuned(42)) s = "CastTeleportSpell(53)";
		else if (id == 9 && !isPlaceAttuned(9)) s = "CastTeleportSpell(70)";
		else s = "CastTeleportSpell(" + id + ")";
		return s.split('"').join("&quot;").split("<").join("&lt;").split(">").join("&gt;")
	}));
	if (perYou.checkFlag(21)) ShowPeople(true,
		"People who will teleport with you");
	WritePlaceFooter(doc, "", true, true);
	return true
}

function CastInvisibility(params, txt) {
	if (nMana >= 5) {
		AddMana(-5);
		perYou.extra[1] = Place;
		if (txt !== "" && txt !== undefined) addComments(txt);
		else if (txt === "") resetComments("");
		else addComments("You cast the spell of Invisibility and begin to fade from view.");
		dispPlace(Place, params);
		return true
	}
	addComments("You do not have enough mana to cast this spell.");
	return false
}

function isInvisible() {
	return perYou.extra[1] > 0
}

function checkInvisible() {
	if (perYou.extra[1] > 0 && !perYou.checkFlag(28)) perYou.extra[1] = 0
}

function CastWealthSpell() {
	if (nMana > 0) {
		AddMana(-1);
		var amt = perYou.checkFlag(22) ? 15 : 10;
		AddCash(amt);
		addComments("You recite the spell and you now have " + sCurrency + amt + " more money.");
		dispPlace();
		return true
	}
	addComments("You do not have enough mana to cast the spell.");
	return false
}

function CastTransform(amt, test) {
	if (nMana < 20) {
		addComments("You do not have enough mana to cast the spell.");
		return false
	}
	findPerson("Ghost");
	if (perYourBody.FindItem(52) === 0 && perYourBody.FindItem(64) === 0) {
		addComments("You do not have a soul-bound crystal");
		return false
	}
	if (perKurndorf.getQuestRitual() < 200 && per.place != -64) {
		addComments("You have a crystal, but it is not soul-bound");
		return false
	}
	if (test !== undefined && test === true) return true;
	if (perYourBody.FindItem(52) > 0 && perKurndorf.getQuestRitual() < 200) {
		AddMana(-20);
		perYou.addCorruption(5 * amt);
		perKurndorf.other += amt
	} else if (!per.checkFlag(7)) {
		AddMana(-10);
		per.setFlag(7)
	} else AddMana(-20);
	return true
}

function CastingCharm() {
	if (gameState.plcTitle == "Taxi Driver") {
		if (!perDavy.checkFlag(1)) addComments("<p>You try and cast the spell, but it seems to bounce off of him... Evidently he is already <i>charmed</i> by someone else.</p>");
		else addComments("<p>Oh come on. You set him free from Davy's control and now you want what?  To get free taxi rides?  Now you're just stooping to his level.</p>");
		return
	}
	var bShielded = isSpellKnown("Shielded Charm");
	var cost = perYou.checkFlag(17) ? 9 : 10;
	switch (Place) {
		case 17:
			if (wherePerson("Sarah") ==
				17 && getPersonOther("Sarah") == 1) addComments('You attempt to cast the spell nothing happens. Sarah waggles a finger, "Naughty apprentice, my uncle has protected me well"');
			else if (wherePerson("Sarah") == 17 && getPersonOther("Sarah") >= 100) addComments("It is too public with the two of them here, and do you really think a warlock like " + perGates.getPersonName() + " will not have defences for him and his niece?");
			else addComments("Do you really think a warlock like " + perGates.getPersonName() + " will not have defences for himself?");
			break;
		case 18:
			var marea = getQueryParam("area");
			var ws = wherePerson("Sarah");
			var so = getPersonOther("Sarah");
			if (marea == "appear") {
				addComments("You attempt to cast the spell on the maid Lauren, but it does nothing as if she cannot be affected by the spell.");
				break
			} else if (ws == 17 && so == 101 || marea == "locked") {
				addComments("You attempt to cast the spell the maid starts to react but then she shakes her head and touches a ring on one of her fingers. You realise she is protected in some way, a weak protection, but sufficient.");
				break
			} else if (ws == 192 && marea == "landing" || (so == 110 || so == 114 || so == 117 || so == 120))
				if (!(checkPersonFlag("Lauren", 8) || perGates.checkFlag(3))) addComments("You attempt to cast the spell the maid starts to react but then she shakes her head and touches a ring on one of her fingers. You realise she is protected in some way, a weak protection, but sufficient.");
				else if (nMana > 9) {
				dispPlace(Place, "charm=yes");
				return "nofooter"
			}
			addComments("You attempt to cast the spell, but it fizzles.");
			break;
		case 28:
			if (checkPlaceFlag("Library",
					1) || bShielded) CastCharmSpell("Tess", 29, 1);
			else addComments("Don't cast the spell here. Anyone could see you, with that door open.");
			break;
		case 53:
			if (wherePerson("Leanne") == 53) addComments("You attempt to cast the spell, but it seems there is something residual of the demon about her and it fails.");
			else addComments("You attempt to cast the spell, but if fizzles.");
			break;
		case 65:
		case 67:
			if (bShielded) CastCharmSpell("OfficerKhan", 126, 1);
			else if (getPersonOther("OfficerKhan") == 11) CastCharmSpell("OfficerKhan",
				126, 1);
			else addComments("Don't cast the spell here. There are too many people around.");
			break;
		case 87:
			if (bShielded && wherePerson("DebraKelly") == 87) CastCharmSpell("DebraKelly", 88, 1);
			else addComments("Don't cast the spell here. It is too public.");
			break;
		case 112:
			var perJ = findPerson("JanetKelly");
			var clvJ = perJ.getCharmedLevel();
			var perD = findPerson("DebraKelly");
			var clvD = perD.getCharmedLevel();
			var totpeople = perJ.place == 112 ? 1 : 0;
			if (perD.place == 112) totpeople++;
			if (totpeople == 1)
				if (perJ.place == 112) CastCharmSpell("JanetKelly",
					113, 1, "", "", "type=recharm1");
				else {
					if (perD.place == 112) CastCharmSpell("DebraKelly", 117, 2)
				}
			else if (clvD === 0 && clvJ === 0)
				if (bShielded) CastCharmSpell("JanetKelly", 113, 1, "", "You cast the spell on Janet while Debra is busy with some unpacking");
				else addComments("With the two sisters here you cannot cast the spell, you will have try something else.");
			else if (clvD === 0) CastCharmSpell("DebraKelly", 117, 2);
			else CastCharmSpell("JanetKelly", 113, 1, "", "", "type=recharm1");
			break;
		case 124:
			if (bShielded)
				if (isCharmedBy("Bambi"))
					if (perJesse.whereNow() ===
						0)
						if (!perJesse.checkFlag(10)) addComments("You do not know the girl's name, so the spell will not work.");
						else addComments("You cast the spell but it seems to bounce off of her, it is like she is immune somehow...  She seems so...  innocent.");
			else addComments("You have already <i>Charmed</i> Bambi.");
			else addComments("You should try to get her somewhere more private.");
			else addComments("Don't cast the spell here. It is too public.");
			break;
		case 139:
			if (!isCharmedBy("Kate", "You"))
				if (isCharmedBy("Kate",
						"Davy")) addComments("You attempt to cast the spell, but if fails to take effect... Evidently your target is already under the effects of a charm spell...  Someone <i>else's</i> spell.");
				else if (checkPersonFlag("Kate", 15)) addComments("You read a spell.... but nothing happens as Kate is wearing the necklace.");
			else if (checkPersonFlag("Kate", 22) || checkPersonFlag("Kate", 23)) {
				setCommentsNoClick('<div style="margin-top:1em;margin-bottom:1em;margin-left:2em;margin-right:2em;cursor:default;">' + "Really!! You went to all that effort and you just want to charm her?");
				addOptionLink("comments", "No", "dispPlace(undefined,'','No, Kate is fine as she is')");
				addOptionLink("comments", "Yes I do!", "CastCharmSpell('Kate',139,4,'type=charm1v','You cast the spell and you catch Kate by surprise...')")
			} else if (checkPersonFlag("Kate", 18))
				if (isInvisible() || perYou.checkFlag(16)) {
					CastCharmSpell("Kate", 139, 4, "type=charm1");
					return "nofooter"
				} else {
					gotoPlace(35, "type=clobberedvisible");
					return "nofooter"
				}
			else {
				gotoPlace(35, "type=clobbered");
				return "nofooter"
			} else addComments("Kate is already charmed by you!");
			break;
		case 144:
			if (bShielded) {
				if (getHour() >= 12 && getHour() < 14 && checkPersonFlag("Kylie", 1) && !isCharmedBy("Kylie")) CastCharmSpell("Kylie", 144, 1, "type=charm1")
			} else addComments("Don't cast the spell here. It is too public.");
			break;
		case 161:
			if (sType == "cutting" && !isCharmedBy("Hannah")) addComments("You should wait until after Hannah has done her job for you.");
			else if (sType == "cut1" || sType == "cut2") CastCharmSpell("Hannah", Place, 1, "type=charmhannah1", "You follow Hannah, hoping for a private place to <i>speak</i> to her. She reaches an area of the parking lot...");
			else if (isPersonHere("Jessica")) addComments("A spell of this magnitude has no effect on true witches. You will need something much more powerful!");
			else addComments("You read a spell.... but it fizzles.");
			break;
		case 168:
			if (getPersonOther("Diane") > 0 && getPersonOther("Diane") < 900)
				if (wherePerson("OfficerBatton") !== 168) CastCharmSpell("Diane", 221, 1);
				else if (isCharmedBy("Diane")) CastCharmSpell("OfficerBatton", 187, 1);
			else if (isCharmedBy("OfficerBatton")) CastCharmSpell("Diane", 221, 1);
			else if (bShielded) CastCharmSpell("Diane",
				221, 1);
			else addComments("Don't cast the spell here. It is too public.");
			else CastCharmSpell("OfficerBatton", 187, 1);
			break;
		case 185:
			if (isPersonHere("Donna")) addComments("You have already <i>Charmed</i> Donna");
			else addComments("You read a spell.... but it fizzles.");
			break;
		case 192:
			setPersonFlag("Sarah", 9);
			if (isMurderPath()) CastCharmSpell("Sarah", 199, 1);
			else if (isConspiracyPath()) addComments('You attempt to cast the spell but nothing happens. Sarah waggles a finger, "Naughty ally, my uncle has protected me well, and you cannot have Lauren"');
			else addComments('You attempt to cast the spell but nothing happens. Sarah waggles a finger, "Naughty apprentice, my uncle has protected me well"');
			break;
		case 225:
			addComments("You can't cast that here. Look at all the cameras!");
			if (bShielded) addComments(" Even with the Shielded Charm it would be most unwise to try and charm someone in a place like this.");
			if (!isCharmedBy("Ellie")) addComments(" You will have to try this on Ellie somewhere else.");
			else if (checkPersonFlag("Glenvale", 33)) addComments(" You will have to try this on the security guard somewhere else.");
			setPersonFlag("Kristin", 8);
			break;
		case 241:
		case 277:
		case 302:
			if (isPossess("Gina")) addComments("You are currently Possessing Gina, there is no-one else around.");
			else {
				findPerson("Gina");
				if (per.FindItem(43) > 0) addComments("You attempt to cast the spell...  And it seems to bounce off of her.  It's as if there is something protecting her from your magic.");
				else if (!checkPersonFlag("Gina", 2)) addComments("You do not know the guards name, so the spell will not work.");
				else CastCharmSpell("Gina", 311, 1)
			}
			break;
		case 260:
		case 261:
			if (getPersonOther("Diane") == 50) {
				if (CastCharmSpell("Diane", 221, 1)) {
					setPersonOther("Diane", 49);
					perYou.setArrested(0)
				}
			} else if (Place == 261) {
				if (wherePerson("Diane") == 261)
					if (CastCharmSpell("Diane", 221, 1)) {
						movePerson("Diane", 168);
						perYou.setArrested(0)
					}
			} else addComments("You read a spell.... but it fizzles.");
			break;
		case 258:
		case 269:
			if (wherePerson("NurseMegan") == 269) addComments("You do not either of their names, so the spell will not work.");
			else if (wherePerson("Donna") == 269 && !isCharmedBy("Donna"))
				if (!bShielded &&
					wherePerson("Lauren") == 269) addComments("Don't cast the spell here. It is too public.");
				else CastCharmSpell("Donna", 270, 20);
			else if (wherePerson("Lauren") == 269) addComments("You attempt to cast the spell on Lauren, but it does nothing as if Lauren cannot be affected by the spell.");
			else addComments("You attempt to cast the spell, but if fizzles.");
			break;
		case 279:
			if (bShielded) CastCharmSpell("Hannah", Place, 1, "type=charmhannah1");
			else addComments("Don't cast the spell here. It is too public.");
			break;
		case 290:
			if (isMurderPath()) CastCharmSpell("Lauren",
				291, 1);
			else if (getQueryParam("type") == "escort")
				if (nMana > 9) {
					dispPlace(Place, "type=escort&charm=yes");
					return "nofooter"
				} else addComments("You do not have enough mana to cast the spell.");
			else addComments("You read a spell.... but it fizzles.");
			break;
		case 318:
			if (wherePerson("Daria") == 318 || (checkPlaceFlag("Church", 5) || checkPlaceFlag("Church", 7)) && !isPossess("Daria") && !checkPersonFlag("Daria", 4)) addComments("You attempt to cast the spell on the meddlesome nun, but it bounces off of her - its as if her faith itself were protecting her.  Impressive... if not exceptionally annoying. Then again, you do not actually know her name, just what she is, her position not her name.");
			else addComments("You read a spell.... but it fizzles.");
			break;
		case 339:
			addComments("The magic of the s\u00e9ance disrupts the spell and it completely fails to have any affect.");
			break;
		case 348:
			findPerson("Victoria");
			if (!per.checkFlag(8)) addComments("You do not know her name, so the spell will not work.");
			else if (CastCharmSpell("Victoria", 349, 4)) {
				findPerson("Victoria");
				per.setFlag(8);
				if (perKurndorf.getQuestSeance() >= 16) per.setFlag(3, false)
			}
			break;
		case 362:
			if (bShielded) CastCharmSpell("Kristin", 363,
				1);
			else addComments("Even though she has her own office, the bank is still a <i>very</i> public place.  Perhaps if you had a more powerful spell...");
			break;
		case 382:
			if (wherePerson("Leanne") == 382) addComments("You try to cast the spell, but as you expected it has no effect at all on the thrall.");
			if (!isPossess())
				if (wherePerson("Daria") == 382) addComments("You try to cast the spell, but she <i>still</i> too strong willed and in such confusion and distress. It is pointless to try now.");
			break;
		case 384:
			if (isCharmedBy("Daria")) addComments("You have already charmed Daria.");
			else if (getQueryParam("trance") == "yes") CastCharmSpell("Daria", 384, 1, "type=charm1");
			else {
				setPersonFlag("Daria", 8);
				addComments('You try the spell but it fails, her will is still too strong for it to affect her. She looks at you curiously,</p><p>"What gibberish was that! I said get out!"</p>');
				return "refresh"
			}
			break;
		case 420:
			if (!isCharmedBy("Carol"))
				if (sType == "kristincarol2") CastCharmSpell("Carol", 420, 1, "type=kristincarol3");
				else addComments('<p>You recite the spell, but nothing at all happens!</p><p>You wonder if somehow the doorway is blocking the spell, you know the old legends about how vampires must be invited into a house. Also you heard stories about Chinese evil spirits not being able to cross certain doors with steps and you notice past the door is a sunken area for changing shoes. Carol looks puzzled and says "Bless you", clearly she misheard what you said</p><p>It looks like you are going to have to find a way into the house</p>');
			else addComments("You read a spell.... but it fizzles.");
			break;
		case 421:
			if (!bShielded) addComments("Don't cast the spell here. It is too public.");
			else if (wherePerson("Kate") == 421)
				if (!isCharmedBy("Kate", "Davy")) {
					gotoPlace(47, "type=clobbered");
					return "nofooter"
				} else addComments("<p>You recite the spell, it fails, it seems she is under the effect of a charm spell by someone else.</p>");
			else addComments("You read a spell.... but it fizzles.");
			break;
		default:
			addComments("You read a spell.... but it fizzles.");
			break
	}
}

function CastCharmSpell(ps, sPlace, nLike, params, txt, refine, noex) {
	var cost = perYou.checkFlag(17) ? 9 : 10;
	var pPerson = findPerson(ps);
	if (pPerson.isCharmedBy("You") && perYou.checkFlag(26)) cost = 5;
	if (nMana >= cost)
		if (pPerson.isCharmedBy("You"))
			if (refine !== undefined && refine !== "" && perYou.checkFlag(26)) {
				if (pPerson.hoursCharmed() < 12) addComments('<table><tr><td width="80%;margin-right:2em"><p>You have already charmed ' + pPerson.getPersonNameShort() + " but you feel you could alter the nature of the charm, for a price...</p><p>Trouble is you have only recently charmed " + pPerson.getPersonNameShort() +
					", you should leave them for a time for the effects of the spell to settle down. You are not sure how long, but dawn and midnight are important occult times, so you will leave it for a day and try again later.</p>");
				else {
					setCommentsNoClick('<div style="margin-top:1em;margin-bottom:1em;margin-left:4em;margin-right:2em;cursor:default;">' + '<table><tr><td width="80%;margin-right:2em"><p>You have already charmed ' + pPerson.getPersonNameShort() + " but you feel you could alter the nature of the charm, for a price...</p>");
					addOptionLink("comments", "No, they are fine as they are", "dispPlace(undefined,'', '" + pPerson.addPersonFace(true) + "The cost is not worth it, you leave " + pPerson.getPersonNameShort() + " unchanged.')");
					addOptionLink("comments", "Let's do it!", "checkInvisible();AddMana(-5);dispPlace(undefined,'" + refine + "')")
				}
				addComments('<br></td><td width="20%">' + pPerson.addPersonFace(false, "80%") + "</td></tr></table>");
				return true
			} else addComments("You have already <i>Charmed</i> " + pPerson.name + ".");
	else if (pPerson.isCharmed()) addComments("The spell fails, it seems someone else has already charmed " +
		pPerson.name + ".");
	else {
		checkInvisible();
		if (noex !== true) perYou.addExperience(1);
		perYou.addCorruption(1);
		updateRightBar();
		AddMana(cost * -1);
		pPerson.charmThem(nLike);
		if (txt !== "" && txt !== undefined) addComments(txt);
		else sComment = "";
		dispPlace(sPlace, params === undefined ? "" : params);
		return true
	} else addComments("You do not have enough mana to cast the spell.");
	return false
}

function isCharmed(ps) {
	if (findPerson(ps) !== null) return per.isCharmed();
	return false
}

function isCharmedBy(ps, who) {
	if (findPerson(ps) !== null) return per.isCharmedBy(who);
	return false
}

function getCharmedLevel(ps) {
	if (findPerson(ps) !== null) return per.getCharmedLevel();
	return 0
}

function charmPerson(ps, no, by, nreset) {
	if (findPerson(ps) !== null)
		if (no === 0) per.unCharmThem();
		else per.charmThem(no, by, nreset)
}

function unCharmPerson(ps, no) {
	charmPerson(ps, 0)
}

function getPersonCharm(ps) {
	if (findPerson(ps) !== null) return per.charmed;
	return 0
}

function getPersonHoursCharmed(ps, by) {
	if (findPerson(ps) === null) return 0;
	return per.hoursCharmed(by)
}

function CastUnlifeEnspelledSpell(sPlace, params) {
	var cost = perYou.checkFlag(17) ? 9 : 10;
	if (nMana >= cost) {
		checkInvisible();
		if (sType != "ghostcharmsex") perYou.addExperience(1);
		updateRightBar();
		AddMana(cost * -1);
		dispPlace(sPlace, params);
		return true
	}
	addComments("You do not have enough mana to cast the spell.");
	return false
}

function CastingClairvoyance() {
	if (!CastClairvoyanceSpell()) return "";
	if (gameState.plcTitle == "Taxi Driver" && !perDavy.checkFlag(1)) {
		addComments("<p>The spell reveals the taxi driver is under the influence of a charm spell.</p>");
		return
	}
	var b = false;
	var p;
	for (var i = 0, ie = arPeople.length - 5; i < ie; i++) {
		p = arPeople[i];
		if (p.isHere() && p.isCharmed()) {
			if (Place == 145) p.setFlag(17);
			if (p.sCharmedBy == "Demon") addComments("<p>The spell reveals that " + p.getPersonNameShort() + " is under some powerful spell.</p>");
			else if (p.sCharmedBy ==
				"You") addComments("<p>The spell reveals that " + p.getPersonNameShort() + " is under the influence of <b>your</b> charm spell.</p>");
			else addComments("<p>The spell reveals that " + p.getPersonNameShort() + " is under the influence of a charm spell.</p>");
			b = true
		}
	}
	if (perDavy.isHere()) {
		addComments("<p>The spell reveals Davy is under a powerful spell.</p>");
		return
	}
	if (Place == 176) {
		if (!isPlaceKnown("DavysRoom")) addComments("<p>The spell reveals the presence of magic in another room on the other side of a wall, but you are unsure how to get there. If only you knew a way to walk through walls.</p>")
	} else if (Place ==
		16 && !isPlaceKnown("SacredClearing")) {
		setPlaceKnown("SacredClearing");
		addComments("A sacred clearing is revealed.");
		return "refresh"
	} else if (Place == 26 && !checkPlaceFlag("WildRanges", 2)) {
		setPlaceFlag("WildRanges", 2);
		PlaceI(58, 26);
		addComments(" You find a small bush of Hemlock hidden behind an overgrown pine tree and break off a small branch.");
		return "refresh"
	} else if (Place == 35 && !checkPersonFlag("Kate", 7)) {
		setPersonFlag("Kate", 7);
		addComments(" The spell outlines a book lying under the bed, it appears to be a photo-album.");
		return "refresh"
	} else if (Place == 35 && checkPersonFlag("Kate", 8) && !checkPersonFlag("Kate", 9)) {
		setPersonFlag("Kate", 9);
		addComments(" The spell outlines another photo-album well concealed in a messy but not very full  wardrobe.");
		return "refresh"
	} else if (Place == 42 && !checkPlaceFlag("Alley", 2)) {
		setPlaceFlag("Alley", 2);
		addComments("A gutter grate is revealed.");
		return "refresh"
	} else if (Place == 53)
		if (!checkPlaceFlag("Alley", 8)) {
			setPlaceFlag("Alley", 8);
			addComments("<p>You see the eyes of the dragon sculpture glow and you can clearly see they are sockets intended to put something into.</p>");
			return
		} else {
			if (whereItem(35) == -53) {
				addComments("<p>The magic of the Dragon Gem has flooded this room, it is a <i>Place of Power</i>.</p>");
				return
			}
		}
	else if (Place == 77) {
		if (!perBeasley.checkFlag(4)) {
			addComments("The spell reveals something magical in the desk drawer");
			return "refresh"
		}
	} else if (Place == 95 && !isShopOpen(0) && checkPlaceFlag("Hotel", 2) && !checkPlaceFlag("Hotel", 4)) {
		addComments("A folder glows and you see it is the plans for the Broken Inn Hotel. You place them into your bag.");
		perYourBody.PutItem(23);
		setPlaceFlag("Hotel", 4);
		return "refresh"
	} else if (Place == 161 && getPersonOther("Jessica") === 0) {
		addComments("<p>The spell reveals something concealed behind a wall.</p>");
		return
	} else if (Place == 242 && !perYou.checkFlag(5)) {
		perYou.setFlag(5);
		AddCash(25);
		addComments(" You find " + sCurrency + "25 left by some teachers.");
		return
	} else if (Place == 322 && !isPlaceKnown("ChurchTunnel")) {
		addComments("Pulling down a torch reveals a hidden tunnel.");
		setPlaceKnown("ChurchTunnel");
		if (!isPossess()) {
			dispPlace(323, "");
			return
		} else {
			addComments(" Perhaps you should come back and check it out when not possessing the good Mother Superior.");
			return "refresh"
		}
	} else if (Place == 324 && checkPlaceFlag("Graveyard", 6) && !isPlaceKnown("ChurchTunnel")) {
		addComments("You see a flash and something shifts inside the Mausoleum. You peek inside and see the outline of a concealed door. You pry and the door opens with a creak, leading down into a dark tunnel.");
		setPlaceKnown("ChurchTunnel");
		return "refresh"
	} else if (Place == 325 && !isPlaceKnown("Mausoleum")) {
		setPlaceKnown("Mausoleum");
		addComments("Your attention is immediately drawn to a small mausoleum.");
		dispPlace(324,
			"");
		return
	} else if (Place == 382 && !isPlaceKnown("MotherSuperiorsSecretRoom")) {
		setPlaceKnown("MotherSuperiorsSecretRoom");
		addComments("The borders of a hidden door glow under the power of the spell, revealing a small hidden room.");
		dispPlace(383, "");
		return
	}
	if (!b) addComments("You try to cast a spell.... but it fizzles.");
	return ""
}

function CastClairvoyanceSpell(msg, cost) {
	if (cost === undefined) cost = 3;
	if (nMana >= cost) {
		AddMana(cost * -1);
		if (msg !== undefined) addComments(msg);
		return true
	} else addComments("You do not have enough mana to cast this spell.");
	return false
}
var oVisions;
var oVisionsExplicit;

function setVisionID(vis, id) {
	vis.id = id++;
	if (vis.event !== undefined) return setVisionID(vis.event, id);
	return id
}

function findVisionID(vis, id) {
	if (vis.id == id) return vis;
	if (vis.event !== undefined) return findVisionID(vis.event, id);
	return undefined
}

function CastingHydromancy() {
	var perGlenvale = findPerson("Glenvale");
	var idNew = 10;
	var ids = getQueryParam("id");
	var sChild = getQueryParam("child");
	var id = ids === "" ? 0 : parseInt(ids, 10);
	if (id === 0)
		if (wherePerson("Mom") === 1E3 && !perGlenvale.checkFlag(69)) id = 5;
		else if (perYou.isQuestStarted(2) && !perYou.isQuestComplete(2) && !perGlenvale.checkFlag(65)) id = 1;
	else if (isConspiracyPath() && perYou.isQuestStarted(6) && !perYou.isQuestComplete(6) && !perGlenvale.checkFlag(66) && perYou.getQuestRustyKey() < 999 && checkPersonFlag("Bambi",
			5)) id = 2;
	else if (isMurderPath() && !perGlenvale.checkFlag(66)) {
		var perSarah = findPerson("Sarah");
		if (perSarah.isCharmedBy()) {
			findPerson("Lauren");
			if (per.flags[0] > 0 || whereItem(40) == 192) id = 2
		}
	} else if (isDemonFreed() && !perGlenvale.checkFlag(67)) id = 3;

	function scanVisions(oBase, id, sTier) {
		var ar = [];
		var visionslist = Object.getOwnPropertyNames(oBase);
		for (var i = 0, ie = visionslist.length; i < ie; i++) {
			var tiername = visionslist[i];
			if (sTier !== "" && tiername != sTier) continue;
			var oTier = oBase[tiername];
			for (var j = 0, iej = oTier.length; j <
				iej; j++) {
				var oThis = oTier[j];
				if (oThis.id === undefined) {
					idNew = setVisionID(oThis, idNew);
					if (sTier === "") continue
				}
				if (id !== 0) {
					var oSel = findVisionID(oThis, id);
					if (oSel !== undefined) return oSel
				}
				if (perGlenvale.checkFlag(oThis.id + 64)) continue;
				if (oThis.available !== undefined)
					if (!oThis.available()) continue;
				ar.push(oThis)
			}
		}
		if (ar.length > 0) return ar[Math.floor(Math.random() * ar.length)];
		return undefined
	}
	var sTier = "";
	if (sTier === "")
		if (id > 0 && id < 10) sTier = "plot";
		else if (Place == 421) sTier = "light";
	else if (Place == 161) sTier = "hard";
	else sTier = "mixed";
	var bExplicit = isExplicit() && sTier !== "plot";
	var oSelected = scanVisions(bExplicit ? oVisionsExplicit : oVisions, id, sTier);
	if (idNew != 10) {
		scanVisions(isExplicit() ? oVisionsExplicit : oVisions, 0, "");
		scanVisions(isExplicit() ? oVisions : oVisionsExplicit, 0, "")
	}
	if (oSelected === undefined && bExplicit) {
		bExplicit = false;
		oSelected = scanVisions(oVisions, id, sTier)
	}
	if (oSelected === undefined) {
		for (var i = 75; i < perGlenvale.flags.length * 32; i++) perGlenvale.setFlag(i, false);
		return CastingHydromancy()
	}
	setQueryParams("type=hydromancy&id=" +
		oSelected.id);
	perGlenvale.setFlag(oSelected.id + 64);
	var imar = oSelected.image.split(",");
	var md = WritePlaceHeader(false, "td-left" + (oSelected.width !== undefined && oSelected.width !== "" ? "-" + oSelected.width : ""));
	if (oSelected.image.indexOf("Images/") == -1) {
		for (var im = 0; im < imar.length; im++) imar[im] = "Visions/" + imar[im];
		if (bExplicit) AddImageArrayX(imar, "", "", "", "", undefined, md, "none");
		else AddImageArray(imar, "", "", "", "", undefined, md, "none")
	} else AddImageArray(imar, "", "", "", "", undefined, md, "none");
	addPlaceTitle(md,
		oSelected.title);
	if (sChild === "" && oSelected.nostart !== true) md.write("<p>As you cast the spell a vision starts to form in the water, and it quickly expands and the vision is all you can see and hear.</p>");
	md.write("<p>" + oSelected.text + "</p>");
	if (oSelected.event === undefined && oSelected.noend !== true) md.write("<p>The vision starts to recede back and you can see normally and just see fragments in the pool of water that are slowly fading.</p>");
	startQuestions();
	if (oSelected.event === undefined) {
		addLinkToPlaceC(md,
			oSelected.button !== undefined ? oSelected.button : "the vision ends...", Place);
		if (nMana > 0 && oSelected.nomore !== true) addLinkToPlaceC(md, "focus on more visions...", Place, "type=hydromancy", "", "", "CastClairvoyanceSpell(undefined,1)")
	} else addLinkToPlaceC(md, oSelected.button !== undefined ? oSelected.button : "the vision changes...", Place, oSelected.event !== undefined ? "type=hydromancy&child=true&id=" + oSelected.event.id : "");
	WritePlaceFooter(md);
	return true
}

function CastingPassSpell() {
	if (isPossess()) addComments("You try to cast the spell, but for some reason it fails. Possibly it is a side-effect of the Possession spell?");
	else if (Place == 2 && !isShopOpen(2, 0, true)) {
		setPlaceBreakIn("Library");
		CastPassSpell(3)
	} else if (Place == 3 && !isShopOpen(2, 0, true)) CastPassSpell(2);
	else if (Place == 9 && !isShopOpen(2)) {
		setPlaceBreakIn("HistoryClassroom");
		CastPassSpell(70)
	} else if (Place == 141 && checkPersonFlag("Lauren", 10))
		if (getHour() !== 0) addComments("The spell fails, the 'shroud' protecting the mansion is too strong");
		else {
			if (wherePerson("Sarah") == 1) movePerson("Sarah", 192);
			if (getPersonOther("Sarah") < 50) setPersonOther("Sarah", 50);
			CastPassSpell(18, "area=appear")
		}
	else if (Place == 16 || Place == 141) {
		var perS = findPerson("Sarah");
		if (isConspiracyPath()) addComments("The spell fails, the mansion seems to be protected in some way");
		else if (isMurderPath() && wherePerson("AdeleRoss") !== 16 && perS.place > 0) {
			var perVamp = findPerson("Vampyre");
			if (perVamp.isCharmedBy("Sarah") && !perS.checkFlag(2) && perVamp.hoursCharmed("Sarah") > 36 && !isDay()) CastPassSpell(299,
				"", "You cast the spell, determined to enter the mansion even now at night. You appear somewhere inside the Mansion...");
			else CastPassSpell(192, "", "You cast the spell, determined to enter the mansion even now at night. You appear somewhere inside the Mansion...")
		} else if (!isMurderPath() && wherePerson("AdeleRoss") !== 16) CastPassSpell(perS.place == 192 && perS.other >= 100 ? 18 : 17, "", "You cast the spell, determined to enter the mansion even now at night. You appear somewhere inside the Mansion...")
	} else if (Place ==
		17 || Place == 18) CastPassSpell(16);
	else if (Place == 19) CastPassSpell(66);
	else if (Place == 37)
		if (wherePerson("Catherine") == 436 && wherePerson("AdeleRoss") != 436) gotoPlace(37, "", "The house is securely locked, there might be someone home but there is no answer to the door or their phones.");
		else addComments("You cast a spell.... but it fizzles.");
	else if (Place == 42)
		if (isPlaceKnown("HiddenRoom")) addComments("You already know how to enter the hidden room, you can just walk there!");
		else CastPassSpell(53, "", "A wall in the alley shimmers and you realise there is a door there. The spell has unlocked the door for you. The door is very well concealed but you can now enter the room whenever you like.");
	else if (Place == 43 && sType == "gate") CastPassSpell(480, "", "You cast the spell and step through the fence, avoiding the gate and the symbol. You appear near a road heading north.");
	else if (Place == 43)
		if (checkPlaceFlag("RobbinsHouse", 6)) CastPassSpell(93, "type=teleport");
		else addComments("You cast a spell.... but it fizzles.");
	else if (Place == 44) CastPassSpell(42);
	else if (Place == 65) addComments("There are too many police around, there is no way you can do this unseen.");
	else if (Place == 70 && !isShopOpen(2)) CastPassSpell(9);
	else if (Place == 77 && !checkPersonFlag("MrBeasley", 4)) {
		if (CastPassSpell()) {
			PlaceI(5, 77);
			setPersonFlag("MrBeasley", 4);
			addComments("Your spell opens Mr. Beasley's desk drawer. There is a stone inside.");
			dispPlace(77, "")
		}
	} else if (Place == 93) CastPassSpell(43);
	else if (Place == 94 && !isShopOpen(0)) {
		setPlaceBreakIn("TownHall");
		CastPassSpell(95)
	} else if (Place == 95 && !isShopOpen(0)) CastPassSpell(94);
	else if (Place == 130) CastPassSpell(43);
	else if (Place == 131)
		if (!isCharmedBy("OfficerKhan")) addComments("While you are alone here there are still too many police around, it is unlikely you can do this unseen.");
		else CastPassSpell(66);
	else if (Place == 145 && getPersonOther("Anita") >= 100 && getPersonOther("Anita") < 900 && isMurderPath()) CastPassSpell(252);
	else if (Place == 161)
		if (getPersonOther("Jessica") === 0) CastPassSpell(193);
		else if (perKurndorf.getQuestRitual() < 200) addComments("Why waste the mana when you can just walk there?");
	else addComments("The place that was once there is no more... Too bad, it could have made an awesome hideout.");
	else if (Place == 176) {
		if (!isCharmedBy("MrsRobbins", "You")) {
			addComments(per.addPersonFace() +
				'As you start to cast the spell Mrs. Robbins interrupts, "What are you doing, if you have no more business with me please leave, don\'t just speak gibberish"</p>' + "<p>You realise you will have to try casting this somewhere else, out of the sight of Mrs. Robbins.");
			setPlaceFlag("RobbinsHouse", 6)
		}
	} else if (Place == 191 && perYou.getQuestAftane() < 10) {
		if (CastPassSpell()) {
			addComments(" The sound of old rusted iron latch rings in the room as the safe door swings open.");
			perYou.setQuestAftane(10);
			PlaceI(41, 191);
			return "refresh"
		}
	} else if (Place == 276) addComments("You try and cast the spell... but it almost seems to <i>bounce</i> off of the safe.  Somehow it must be protected from magic.  You'll have to find another way.</p>");
	else if (Place == 229 && isPlaceKnown("GinasHouse")) CastPassSpell(302);
	else if (Place == 238) {
		setPlaceBreakIn("Museum");
		CastPassSpell(239)
	} else if (Place == 239 && !isPossess()) CastPassSpell(238);
	else if (Place == 281 && !isShopOpen(-2, -2, true, true)) CastPassSpell(282);
	else if (Place == 282 && !isShopOpen(-2, -2, true, true)) CastPassSpell(281);
	else if (Place == 303 && !checkPlaceFlag("GinasHouse", 7)) {
		if (CastPassSpell()) {
			setPlaceFlag("GinasHouse", 7);
			if (whereItem(34) === 0) PlaceI(34, 303);
			else setPlaceFlag("GinasHouse", 6);
			addComments("Your spell opens the jammed drawer.");
			return "refresh"
		}
	} else if (Place == 324 && !checkPlaceFlag("Graveyard", 6)) {
		if (CastPassSpell()) {
			addComments(" The sound of old rusted iron hinges accosts your ears, the mausoleum grate finally giving way to the power of the spell.");
			setPlaceFlag("Graveyard",
				6);
			return "refresh"
		}
	} else if (Place == 344 || Place == 345) addComments("The spell completely fails, and you see for a moment a faint glow about the " + getShopStore() + ". It seems the " + getShopStore() + " is warded in some way.");
	else if (Place == 360) {
		setPlaceBreakIn("Aquarium");
		CastPassSpell(361)
	} else if (Place == 361) CastPassSpell(360);
	else if (Place == 371 && !isDay()) CastPassSpell(372);
	else if (Place == 372 && !isDay()) CastPassSpell(371);
	else if (Place == 412 && checkPersonFlag("Diane", 21)) {
		if (wherePerson("Diane") == -1) movePerson("Diane",
			412);
		CastPassSpell(416)
	} else if (Place == 442) CastPassSpell(443);
	else if (Place == 443) CastPassSpell(442);
	else if (Place == 452 && sType == "gabbyhouseapproach") CastPassSpell(452, "type=gabbyhousestudy1");
	else if (Place == 480) CastPassSpell(43, "type=gate", "You cast the spell and step through the fence, avoiding the gate and the symbol. You appear on the edge of Yoolaroo Drive.");
	else addComments("You cast a spell.... but it fizzles.");
	return isCommentsShown() ? undefined : "nofooter"
}

function CastPassSpell(nPlace, type, msg) {
	if (nMana > 1) {
		AddMana(-2);
		if (type === undefined) type = "";
		if (msg !== undefined) addComments(msg);
		if (nPlace !== undefined) dispPlace(nPlace, type);
		return true
	}
	addComments("You do not have enough mana to cast this spell.");
	return false
}
var sPossess;

function isPossess(ps) {
	return ps === undefined ? sPossess !== "" && sPossess != "cast" : sPossess == ps
}

function CastPossession() {
	if (Place == 141 || Place == 53 && whereItem(35) == -53) {
		var cost = perYou.checkFlag(17) ? 18 : 20;
		if (nMana >= cost) {
			AddMana(cost * -1);
			sPossess = "cast";
			addComments("You cast the possession spell. Now add an ingredient of a personal affect.");
			dispPlace(undefined, "")
		} else addComments("The spell fizzles.")
	} else addComments("The spell refuses to work here.")
}

function Possession(ps) {
	var perP = findPerson(ps);
	if (perP === null) return;
	var was = Place;
	setQueryParams();
	WriteCommentsHeader();
	addComments("<p style='font-size:large'><b>Possession</b></p>");
	if (!per.possessThem()) {
		WriteCommentsFooter();
		return
	}
	sPossess = ps;
	perYou.place = was;
	perYourBody = perP;
	if (sComment !== "") addComments("<p>To dispossess their body click on the top left picture of their face.</p>");
	updateRightBar();
	dispPlace()
}

function Dispossession() {
	resetComments("");
	if (findPerson(sPossess) !== null)
		if (!per.dispossessThem()) {
			WriteCommentsFooter();
			return
		}
	perYourBody = perYou;
	sPossess = "";
	updateRightBar();
	gotoPlace(perYou.place, "", sComment === "" ? "You end the spell and after a moment of disorientation, you return to your own body" : sComment)
}

function CancelPossession() {
	sPossess = ""
}

function isRunes() {
	return gameState.bUseRuneMatching
}

function setRunes(val) {
	gameState.bUseRuneMatching = val === undefined ? !gameState.bUseRuneMatching : val
}
var Spells = {
	"DaiChu": {
		name: "Dai Chu",
		commonname: "Charm",
		cost: 10,
		getDescription: function() {
			var s;
			if (!isSpellKnown("Shielded Charm")) s = "<i>Charm</i> or <i>Dai Chu</i> is an ancient word for charm.<br> It means to increase another's desire and friendliness towards you, but only if the victim is not under the influence of someone else.";
			else s = "<i>Shielded Charm</i> or <i>Neo One</i> is an ancient word for <i>shielded</i> charm.<br> It means to increase anothers desire and friendliness towards you, but only if the victim is not under the influence of someone else.</p>" + "<p>Your knowledge of the shielded charm allows you to cast this spell when in public.";
			if (perYou.checkFlag(19)) s += " You know how to cast the spell on men and women alike.</p>";
			else s += " You only know how to cast the spell on women.</p>";
			s += "<p>A person's name is important in all forms of magic targeting a person and is a key part of casting this spell. ";
			if (perYou.checkFlag(26)) s += "The way you initially speak with the person under the affect of this spell will influence strongly how they feel and react to you from a devoted lover to an obsessed slave. It is possible to alter the nature of this at a later time by re-casting this spell at a reduced cost of 5 mana.</p>";
			else s += "You can only charm a person broadly, making them desire you and be obedient, largely based on their nature. You cannot guide this process in any detail.</p>";
			return s + "<p>In all references you have seen this is a <b>forbidden</b> spell due to the excesses of the Warlock Kurndorf and all copies were lost after his death."
		},
		isKnown: function() {
			return checkBitFlag(perYou.extra[3], 4)
		},
		learnSpell: function() {
			if (wherePerson("Kate") != 9999) {
				movePerson("Kate", 1E3);
				charmPerson("Kate", 1, "Davy")
			}
			movePerson("MsJones",
				242);
			if (getPersonOther("Kate") < 5) setPersonOther("Kate", 999);
			movePerson("MrBeasley", 1E3);
			perYou.MaxItems++;
			perYou.PutItem(14, true);
			perYou.extra[3] = setBitFlag(perYou.extra[3], 4);
			if (isCharmedPath()) return "</p><p>Maybe you should talk to " + perGates.getPersonNameShort() + " about this spell, unless that is you walk to use this spell and the power it gives you?"
		}
	},
	"ErtNau": {
		name: "Ert Nau",
		commonname: "",
		cost: 0,
		description: "",
		learnSpell: function() {},
		isKnown: function() {
			return false
		}
	},
	"NeoOne": {
		name: "Neo One",
		commonname: "Shielded Charm",
		cost: 10,
		getDescription: function() {
			return "<i>Shielded Charm</i> allows you to increase another's arousal and attraction towards you, but only if they are not under the influence of someone else.</p><p>Your knowledge of the shielded charm allows you to cast this spell when in public."
		},
		isKnown: function() {
			return checkBitFlag(perYou.extra[3], 9)
		},
		learnSpell: function() {
			perYou.extra[3] = setBitFlag(perYou.extra[3], 9);
			setItemName(14, "Shielded Charm");
			updateRightBar()
		}
	},
	"DertPher": {
		name: "Dert Pher",
		commonname: "Wealth",
		cost: 1,
		getDescription: function() {
			return "<i>Wealth</i> or <i>Dert Pher</i> is an ancient word for wealth.<br> It means to materialize money from magic.</p>" + "<p>Only a small amount of power (1 mana) is needed to cast this spell and receive " + sCurrency + "10."
		},
		isKnown: function() {
			return checkBitFlag(perYou.extra[3], 2)
		},
		learnSpell: function() {
			if (wherePerson("MrBeasley") !== 11 && !perYou.isBornMale()) movePerson("MrBeasley", 11);
			perYou.MaxItems++;
			perYou.PutItem(12, true);
			perYou.extra[3] = setBitFlag(perYou.extra[3],
				2)
		}
	},
	"Dest": {
		name: "Dest",
		commonname: "Invisibility",
		cost: 5,
		getDescription: function() {
			var s = '<i>Invisibility</i> or <i>Dest</i> is the very definition of the "unseen" in an ancient language no longer spoken in the living world.<br> Invoking its power cloaks the user from sight - but <i>only</i> sight - so one must be careful to not call too much attention to oneself while no longer visible to the naked eye.</p>' + "<p>While powerful in theory, for whatever reason its effect has diminished since the times of legend - now only able to cloak someone for a very short time. No matter what it will always fade at dawn and dusk. Your portrait shows if the spell is currently in effect.</p>";
			if (perYou.checkFlag(28)) s += "<p>You have learned to keep the effect for longer, now only dusk and dawn will end the spell.</p>";
			return s
		},
		isKnown: function() {
			return checkBitFlag(perYou.extra[3], 7)
		},
		learnSpell: function() {
			perYou.MaxItems++;
			perYou.PutItem(17);
			perYou.extra[3] = setBitFlag(perYou.extra[3], 7);
			perKurndorf.setQuestGhost(104)
		}
	},
	"MirDaru": {
		name: "Mir Daru",
		commonname: "Unlife Enspelled",
		cost: 10,
		getDescription: function() {
			var s = "<i>Mir Daru</i> or <i>Unlife Enspelled</i> is an ancient term like necromancy, the control of the dead.<br> It will bind the undead to the caster, making them the casters thrall.</p>" +
				"<p>Unlike the charm spell the beings name is not essential to the success of this spell. If you do know it then the effect is significantly more powerful.</p>";
			if (perYou.checkFlag(23)) return s += "<p>I also know how to charm ghosts and spirits with this spell.";
			return s
		},
		isKnown: function() {
			return checkBitFlag(perYou.extra[3], 8)
		},
		learnSpell: function() {
			perYou.MaxItems++;
			perYou.PutItem(10, true);
			perYou.extra[3] = setBitFlag(perYou.extra[3], 8);
			updateRightBar()
		}
	},
	"Serphoni": {
		name: "Serphoni",
		commonname: "Pass",
		cost: 2,
		getDescription: function() {
			return "<i>Pass</i> or <i>Serphoni</i> is an ancient word for pass.<br> It means to pass through doors and other entryways.</p>"
		},
		isKnown: function() {
			return checkBitFlag(perYou.extra[3], 1)
		},
		learnSpell: function() {
			if (Place != 192)
				if (!checkPersonFlag("Tess", 10)) setPersonFlag("Tess", 10);
			perYou.MaxItems++;
			perYou.PutItem(11, true);
			perYou.extra[3] = setBitFlag(perYou.extra[3], 1)
		}
	},
	"ShioStinMur": {
		name: "Shio Stin Mur",
		commonname: "Teleport",
		cost: 1,
		getDescription: function() {
			var s = "<i>Teleport</i> or <i>Shio Stin Mur</i> is an ancient word for teleport.<br> It means to transport anywhere you know about but there are some limitations where you can actually teleport to.";
			if (perYou.checkFlag(21)) s += " You have mastered this spell and can teleport to more places and bring other willing people with you.";
			else s += " You only basically know this spell and can only teleport yourself and no other person.";
			s += '</p><p><img style="float:right;width:10%" src="UI/themes/theme0/symbol1.png" alt="Hexagram" title="Hexagram">You can attune yourself to a enscribed Orichalcos Hexagram, or a Crowley Hexagram. This done by casting the teleport spell in a slightly different way, at no mana cost. ' +
				"If you do attune the hexagram then you may always teleport to the location of the hexagram and sometimes the mana cost will be reduced. ";
			if (perYou.checkFlag(21)) return s + "You now know how to carve a hexagram at a place, it must be carved into a living tree, or marked into a place of power. You still do not know the differences of the types of hexagram.</p>";
			return s + "No instructions on how to enscribe the hexagram are given, or what the differences of the types are.</p>"
		},
		isKnown: function() {
			return checkBitFlag(perYou.extra[3],
				3)
		},
		learnSpell: function() {
			perYou.MaxItems++;
			perYou.PutItem(13, true);
			perYou.extra[3] = setBitFlag(perYou.extra[3], 3);
			setPlaceKnown("SchoolField")
		}
	},
	"VilRas": {
		name: "Vil Ras",
		commonname: "",
		cost: 0,
		description: "",
		learnSpell: function() {},
		isKnown: function() {
			return false
		}
	},
	"TuoDuo": {
		name: "Tuo Duo",
		commonname: "Clairvoyance",
		cost: 3,
		getDescription: function() {
			var s = "<i>Clairvoyance</i> allows you to detect things that are normally hidden or even invisible.";
			if (perYou.checkFlag(29)) s += " You can get visions of other places if you meditate on a pool of water and cast this spell. The spell is a little cheaper in this case.";
			return s
		},
		isKnown: function() {
			return checkBitFlag(perYou.extra[3], 5)
		},
		learnSpell: function() {
			perYou.MaxItems++;
			perYou.PutItem(15, true);
			perYou.extra[3] = setBitFlag(perYou.extra[3], 5);
			if (perGates.other == 14 || perGates.other == 15) {
				perGates.other = 16;
				perYou.startQuest(2)
			}
		}
	},
	"UnstrHun": {
		name: "Unstr Hun",
		commonname: "Possession",
		cost: 20,
		getDescription: function() {
			return "<i>Possession</i> or <i>Unstr Hun</i> is an ancient word for possession.<br> It means to transport a spirit into another body, but only for a brief period of time.</p>" +
				"<p>In order for the spell to work properly, it must only be used in a <i>Place of Power</i> and with a personal item of the victim in question to <i>USE</i> as a focus, the vistim DOES NOT have to be present.</p>" + "<p>This spell drains a large amount of power (20 mana) when cast but if you have something of special importance to the person this cost can be majorly reduced."
		},
		isKnown: function() {
			return checkBitFlag(perYou.extra[3], 6)
		},
		learnSpell: function() {
			perYou.extra[3] = setBitFlag(perYou.extra[3],
				6);
			perYou.MaxItems++;
			perYou.PutItem(16, true);
			if (!perYou.isBornMale()) setPersonOther("MrBeasley", 10);
			else {
				var perT = findPerson("MsTitus");
				perT.setFlag(7)
			}
		}
	},
	"AlMass": {
		name: "Al Mass",
		commonname: "Transform",
		cost: 20,
		getDescription: function() {
			return "<i>Transform</i> or <i>Al Mass</i> is a spell of physical transformation</p>" + "<p>To cast this spell you need a soul-bound crystal and a large amount of power. The target will be physically transformed, but you will have no control over the process. Transformations are subject to the nature of the person you are casting it on and will not always work.</p>"
		},
		isKnown: function() {
			return checkBitFlag(perYou.extra[3], 10)
		},
		learnSpell: function() {
			perYou.MaxItems++;
			perYou.PutItem(18, true);
			perYou.extra[3] = setBitFlag(perYou.extra[3], 10)
		}
	}
};

function writeSpellMain(body) {
	var md = WritePlaceHeader(true, "", "", 'td.leftedge { background-image:url("UI/books/bookleftside.jpg");width:50px;height:100px; }' + "td.bookpage {\twidth:50px;height:100px; }" + 'td.rightedge { background-image:url("UI/books/bookrightside.jpg");width:50px;height:100px; }' + 'td.topleft { background-image:url("UI/books/booktopleft.jpg"); width:50px;height:25px; }' + 'td.topedge { background-image:url("UI/books/booktop.jpg");width:50px;height:25px; }' + 'td.topright { background-image:url("UI/books/booktopright.jpg");width:100px;height:25px; }' +
		'td.bottomleft { background-image:url("UI/books/bookbottomleft.jpg");width:50px;height:25px; }' + 'td.bottomedge { background-image:url("UI/books/bookbottom.jpg");width:50px;height:25px; }' + 'td.bottomright { background-image:url("UI/books/bookbottomright.jpg");width:100px;height:25px; }');
	md.write(body);
	md.write("</div>");
	writePageFooter(md)
}

function getSpellObj(spell) {
	if (Spells.hasOwnProperty(spell)) return Spells[spell];
	return undefined
}

function getSpell(s) {
	if (!isNaN(s)) s = getItemName(s);
	s = s.split(" ").join("");
	var spell = getSpellObj(s);
	if (spell === undefined) {
		s = s.toLowerCase().trim();
		var spellist = Object.getOwnPropertyNames(Spells);
		for (var i = 0; i < spellist.length; i++) {
			spell = Spells[spellist[i]];
			if (spell.commonname.split(" ").join("").toLowerCase() == s) return spell;
			spell = undefined
		}
	}
	return spell
}

function isSpellKnown(s) {
	var spell = getSpell(s);
	if (spell === undefined) return false;
	return spell.isKnown()
}

function learnSpell(s) {
	var spell = getSpell(s);
	if (spell === undefined) return;
	perYou.addExperience(3);
	spell.learnSpell();
	updateRightBar()
}

function getSpellDescription(s) {
	var spell = getSpell(s);
	if (spell === undefined) return;
	var cost = spell.cost;
	if (cost > 9 && perYou.checkFlag(17)) cost = Math.round(cost * .9);
	return '<img src="UI/spells/' + spell.name.split(" ").join("") + '_Meaning.png" style="max-width:90%" alt="Spell"><br>' + spell.getDescription() + "</p><p>It costs <b>" + cost + "</b> mana to cast this spell.</p>"
}

function getSpellbookTable(contextObj, plc, params) {
	var addColumns = function(columnClass, numColumns) {
		var result = "";
		for (var col = numColumns; col > 0; col--) result += '<td class="' + columnClass + '"></td>';
		return result
	};
	var MAX_COLUMNS = 3;
	var context = contextObj || {
		spell: "",
		type: "book"
	};
	var table;
	var nMul = isScreenSmall() ? 2 : 1.2;
	if (context.type == "research") {
		table = '<table style="width:55%;background-image: url(\'UI/books/bookbackground2.jpg\');"><tr><td class="topleft"></td>' + addColumns("topedge", MAX_COLUMNS) + '<td class="topright"></td></tr>';
		table += '<tr><td class="leftedge"><td class="bookpage"></td><td class="bookpage" style="border:none;background-color:transparent"><img src="UI/spells/' + context.spell + '_Gray.png" style="width:' + Math.ceil((Math.random() * nMul + .3) * 350) + "px;height:" + Math.ceil((Math.random() * nMul + .3) * 73) + 'px;max-width:50%;max-width:50vw"' + (Math.random() < .5 ? ' class="flip-horizontal"' : "") + ' alt="Spell" title="The Runes for the Spell you have found"></td><td class="bookpage"></td><td class="rightedge"></td></tr></table>';
		table +=
			'<table style="background-image: url(\'UI/books/bookbackground2.jpg\');width:89%;width:89vw"><tr><td class="topleft"></td>' + addColumns("topedge", MAX_COLUMNS) + '<td class="topright"></td></tr>'
	} else table = '<table style="width:89%;background-image: url(\'UI/books/bookbackground2.jpg\');"><tr><td class="topleft"></td>' + addColumns("topedge", MAX_COLUMNS) + '<td class="topright"></td></tr>';
	var col = 0;
	var displayType = "button";
	if (context.type == "book") displayType = "div";
	if (params === undefined) params = "";
	var js =
		"";
	var complete = true;
	var spellist = Object.getOwnPropertyNames(Spells);
	for (var i = 0; i < spellist.length; i++) {
		var spell = getSpellObj(spellist[i]);
		if (col === 0) {
			table += '<tr><td class="leftedge"></td>';
			complete = false
		}
		var bgimg = spell.isKnown() ? "UI/spells/" + spellist[i] + "_Meaning.png" : "UI/spells/" + spellist[i] + "_Gray.png";
		var bgimghover = spell.isKnown() ? "UI/spells/" + spellist[i] + "_Meaning.png" : "UI/spells/" + spellist[i] + "_Color.png";
		table += '<td class="bookpage" style="width:28%"><' + displayType + ' id = "' + spellist[i] +
			'" style="border:none;background-color:transparent;background-size:90% 90%;width:100%;width:28vw;height:73px;background-repeat:no-repeat;cursor:pointer" onmouseover="changeBgImage(\'' + bgimghover + "',this)\" onmouseout=\"changeBgImage('" + bgimg + "',this)\" " + " onClick=\"ResearchHelper('" + context.spell + "','" + spellist[i] + "'," + plc + ",'" + params + "')\"" + (context.type == "research" ? 'title="Is this the spell?"' : "") + "></" + displayType + "></td>";
		js += "changeBgImage('" + bgimg + "',document.getElementById('" + spellist[i] +
			"'));";
		col++;
		if (col >= MAX_COLUMNS) {
			table += '<td class="rightedge"></td></tr>';
			col = 0;
			complete = true
		}
	}
	if (!complete && col < MAX_COLUMNS) {
		table += addColumns("bookpage", MAX_COLUMNS - col);
		table += '<td class="rightedge"></td></tr>'
	}
	table += '<tr><td class="bottomleft"></td>' + addColumns("bottomedge", MAX_COLUMNS) + '<td class="bottomright"></td></tr></table><script type="text/javascript">' + js + "\x3c/script>";
	return table
}

function Research(sSource, sText, img, plc, params) {
	ClearComments(true);
	if (perYou.checkFlag(27)) return ResearchHelper(sText, sText, plc, params);
	switch (sSource) {
		case "Spell":
		case "C":
		case "T":
		case "W":
		case "P":
		case "H":
		case "S":
		case "X":
		case "I":
		case "SG":
			if (perYourBody.FindItem(4) > 0) writeSpellResearch(sText, img, plc, params);
			else {
				WriteComments("<p>You don't have the spellbook. You need the spellbook to make any progress in your research.</p>");
				dispPlace(plc, params)
			}
			break
	}
}

function ResearchHelper(targetSpell, chosenSpell, plc, params) {
	var sBody = "";
	var target = {
		name: "",
		image: "",
		cost: 0,
		getDescription: function() {
			return ""
		},
		learnSpell: function() {
			return
		}
	};
	target = getSpellObj(targetSpell);
	var chosen = getSpellObj(chosenSpell);
	if (chosen.name.toLowerCase() === target.name.toLowerCase()) {
		perYou.addExperience(3);
		sBody = getSpellDescription(targetSpell);
		var s = target.learnSpell();
		if (s != undefined) sBody += s;
		updateRightBar()
	} else sBody = "<p>You try the hand gestures you've discovered while whispering the incantations given in the book...a brief flash of heat and light along with the quickly fading smell of singed hair announce...no effect. Your gestures and incantations apparently didn't go together...you <i>think</i>. Thankfully, no one seems to have noticed the supernatural firecracker going off.</p>";
	ClearComments();
	if (!(target.name == "Tuo Duo" && isCharmedPath())) {
		bChat = false;
		WriteComments(sBody);
		bChatLeft = true
	}
	dispPlace(plc, params)
}

function ShowSpells() {
	if (!isRunes()) ShowSpellsOLD();
	else {
		var contextObj = {
			type: "book",
			spell: ""
		};
		var body = getSpellbookTable(contextObj, "undefined") + addLinkToPlace("string", "close the book", Place, sPlaceParams);
		writeSpellMain(body)
	}
}

function ShowSpellsOLD() {
	var doc = WritePlaceHeader(true);
	doc.write('<table><tr><td style="width:85%">' + '<p style="text-align:center;font-size:x-large"><b>Sacred Disciplines of Control</b></p>' + "<p>The devil's work accumulated into one book. A book of chaos or order, depending upon the spell caster." + "Whoever deciphers the ancient text will learn the power of magic." + "Whoever has the energy of mana will wield that magic. Beware, for every" + "time a spell is cast the wielder will draw those who want to destroy such power.</p>" +
		'<p> - <i><a href="javascript:dispPlace()">close the book</a></i><br>' + "<p>The book reads:</p>" + "</td><td>" + "<img src='UI/books/" + (isMurderPath() ? "book2.png" : "book1.png") + "' style='width:95%;float:right' alt='Book'>" + "</td>" + "</table>" + "<div style='text-align:left;color:black'>" + "<table style='width:100%;padding:0px;border-collapse:collapse;border-spacing:0;border-width:2px;background-image:url(UI/books/bookbackground2.jpg)'>" + "<tr><td>");
	doc.write("<p style='font-family:Wide Latin'><b>Serphoni");
	if (isSpellKnown("Pass")) doc.write(" (Pass)");
	doc.write("</b><p style='font-family:Wingdings;font-size:x-small;'>d gd rellkl hd nuiew hwoap hd i");
	doc.write("ajuie lel a lna eoeo eke ndna jduiqwq apooeikm<</p>");
	doc.write("<p style='font-family:Wide Latin'><b>Dert Pher");
	if (isSpellKnown("Wealth")) doc.write(" (Wealth)");
	doc.write("</b></p><p style='font-family:Wingdings;font-size:x-small;'>dhui reuie ;adsmdas");
	doc.write("kl;oe madnd leluiew dasdkl eioweqhn ds a mcl oe mald");
	doc.write("ellmm aldouern danlie dlaaioe</p>");
	doc.write("<p style='font-family:Wide Latin'><b>Shio Stin Mur");
	if (isSpellKnown("Teleport")) doc.write(" (Teleport)");
	doc.write("</b></p><p style='font-family:Wingdings;font-size:x-small;'>dasdh ui rytye uimge");
	doc.write(";as kfl;oe madnd leluiew dazness dkl eioweqhn ds a mcl oe");
	doc.write("mald ellmm aldasdAo uern danlie dlaASAE aioe</p>");
	doc.write("<p style='font-family:Wide Latin'><b>Dai Chu");
	if (isSpellKnown("Charm")) doc.write(" (Charm)");
	doc.write("</b></p><p style='font-family:Wingdings;font-size:x-small;'>vdf ah udi rdaljte");
	doc.write("udimge ;as k foe mucdnd leluiew dazness dkl eiowveqhn dbs");
	doc.write("a mcl oe moald eaql</font></p>");
	doc.write("<p style='font-family:Wide Latin'><b>Tuo Duo");
	if (isSpellKnown("Clairvoyance")) doc.write(" (Clairvoyance)");
	doc.write("</b><p style='font-family:Wingdings;font-size:x-small;'>pirn kein nbsg leiien");
	doc.write("abrd ;asdui nzvftui dllqpo h ndyuwn abd ;eonz; ldm");
	doc.write("mjebyuhn dbs a mcl oe moald eaql</p>");
	doc.write("<p style='font-family:Wide Latin'><b>Unstr Hun");
	if (isSpellKnown("Possession")) doc.write(" (Possession)");
	doc.write("</b></p><p style='font-family:Wingdings;font-size:x-small;'>opdsam ncjs dasd;nz");
	doc.write("xkebimn n fbsg leiien abrd ;asdui nzvftui dllqpo h");
	doc.write("ndfyuwn abd ffd;eo nz; ldm mjebyuhn dbs a mcl ovve moald");
	doc.write("eaq l</p>");
	doc.write("<p style='font-family:Wide Latin'><b>Neo One");
	if (isSpellKnown("Shielded Charm")) doc.write(" (Shielded Charm)");
	doc.write("</b></p><p style='font-family:Wingdings;font-size:x-small;'>pn dirn keinf nbsg");
	doc.write("leiien abrd ;asdd ui nzvftui dllqpo h ndyuwn abd ;eddzc;");
	doc.write("ldm mjebyuhn danbhklfx bs a mcl oe moald eapuql</p>");
	doc.write("<p style='font-family:Wide Latin'><b>Dest");
	if (isSpellKnown("Invisibility")) doc.write(" (Invisibility)");
	doc.write("</b></p><p style='font-family:Wingdings;font-size:x-small;'>Mj idrn kn nbsg leidin");
	doc.write("ard ;asdiui nzivftui dllqpo h ndyuwn abd ;eoxnz; ldm mjei ");
	doc.write("byuhn dbs a mdv cl oe moaild eaql</p>");
	doc.write("<p style='font-family:Wide Latin'><b>Al Mass");
	if (isSpellKnown("Transform")) doc.write(" (Transform)");
	doc.write("</b></p><p style='font-family:Wingdings;font-size:x-small;'>uM drn kn nbsg leidyin");
	doc.write("a rd ;asdiui nbzii dllqcplco h ndyuwn abdb ;eoxnz; ldm ");
	doc.write("bmjei byuhn bdbs a mdv cl oe mobaild ea</font></p>");
	doc.write("<p style='font-family:Wide Latin'><b>Mir Daru");
	if (isSpellKnown("Unlife Enspelled")) doc.write(" (Unlife Enspelled)");
	doc.write("</b></p><p style='font-family:Wingdings;font-size:x-small;'>thg wer dsfhd  qaewh");
	doc.write("iuyiy cvbc sfg tyu yhmnk trasd jhgj bnvcvbn rtyfwsj i9leda ");
	doc.write("huiw tyubv jlyefd yikhjmks</p>");
	doc.write("<p style='font-family:Wide Latin'><b>Ert Nau");
	doc.write("</b></p><p style='font-family:Wingdings;font-size:x-small;'>tyr jghfg w4rt rthy");
	doc.write("fth hvgjsd s56sa jghjgh ertertert vvnbn asdfasd w45d 456dg");
	doc.write("hgfgh tyry kjhkhfs jhgjhj</p>");
	doc.write("<p style='font-family:Wide Latin'><b>Vil Ras");
	doc.write("</b></p><p style='font-family:Wingdings;font-size:x-small;'>rth tityui xzdv jhg");
	doc.write("fef yuikuy xfvg wfgnbhym secd hjty zdwe zderg uyikmg xdrt");
	doc.write("ruy vhufg rtuir erytcgh ny</p>");
	doc.write("</td></tr></table></div><br>");
	startQuestions(undefined, "", doc);
	addOptionLink(doc, "close the book", "dispPlace()");
	WritePlaceFooter(doc, "", true, true)
}

function writeSpellResearch(sSpell, sImg, plc, params) {
	var contextObj = {
		type: "research",
		spell: sSpell
	};
	var body = "<p>Your research has yielded the following rune (along with some intricate gestures to make while speaking an incantation). Can you locate the actual rune in the book?</p>" + getSpellbookTable(contextObj, plc, params) + addLinkToPlace("string", "pause researching", plc);
	writeSpellMain(body)
}

function ResearchOLD(sSource, sText) {
	sText = sText.toLowerCase().trim();
	var sBody = "I can't find anything about that topic.";
	if (perYourBody.FindItem(4) > 0)
		if (sText == "tuo duo" && sSource == "C") {
			if (!isSpellKnown("Clairvoyance")) {
				learnSpell("Clairvoyance");
				sBody = getSpellDescription("Clairvoyance");
				updateRightBar()
			}
			if (isCharmedPath()) Place = 17;
			else Place = 192
		} else if (sText == "serphoni" && sSource == "T") {
		if (!isSpellKnown("Pass")) {
			learnSpell("Pass");
			sBody = getSpellDescription("Pass");
			updateRightBar()
		}
		bChatLeft = true;
		Place =
			28
	} else if (sText == "dert pher" && sSource == "W") {
		if (!isSpellKnown("Wealth")) {
			learnSpell("Wealth");
			sBody = getSpellDescription("Wealth");
			updateRightBar()
		}
		Place = 161
	} else if (sText == "shio stin mur" && sSource == "P") {
		if (!isSpellKnown("Teleport")) {
			learnSpell("Teleport");
			sBody = getSpellDescription("Teleport");
			updateRightBar()
		}
		Place = 93
	} else if (sText == "dai chu" && sSource == "H") {
		if (!isSpellKnown("Charm")) {
			learnSpell("Charm");
			sBody = getSpellDescription("Charm");
			updateRightBar()
		}
		Place = 53
	} else if (sText == "unstr hun" && sSource ==
		"S") {
		if (!isSpellKnown("Possession")) {
			learnSpell("Possession");
			sBody = getSpellDescription("Possession")
		}
		updateRightBar();
		if (!perYou.isBornMale()) {
			bChatLeft = true;
			Place = 11
		} else Place = 3;
		setQueryParams()
	} else if (sText == "neo one" && sSource == "X") {
		if (!isSpellKnown("Shielded Charm")) {
			learnSpell("Shielded Charm");
			sBody = getSpellDescription("Shielded Charm");
			updateRightBar()
		} else sBody = "I already know that spell";
		Place = 279
	} else if (sText == "dest" && sSource == "I") {
		if (!isSpellKnown("Invisibility")) {
			learnSpell("Invisibility");
			sBody = getSpellDescription("Invisibility");
			updateRightBar()
		}
		Place = 342
	} else if (sText == "mir daru" && sSource == "SG") {
		if (!isSpellKnown("Unlife Enspelled")) {
			learnSpell("Unlife Enspelled");
			sBody = getSpellDescription("Unlife Enspelled");
			updateRightBar()
		}
		Place = 192
	} else {
		if (sText == "al mass" && sSource == "AM") {
			if (!isSpellKnown("Transform")) {
				learnSpell("Transform");
				sBody = getSpellDescription("Transform");
				updateRightBar()
			}
			Place = 174;
			setQueryParams("type=answer2")
		}
	} else sBody = "You don't have the book. You can't research new spells without the book.";
	if (!(sText == "tuo duo" && isCharmedPath())) WriteComments("<p>" + sBody + "</p>");
	dispPlace()
}

function helpCreditsPage() {
	function addModel(md, nm, img, desc) {
		if (desc === undefined) desc = img.split(".")[0].split(" - ")[1];
		if (nm === "") nm = img.split(" - ")[0];
		md.write('<tr><td style="border:solid 1px;margin-left:5px;padding-left:5px"><b>' + nm + '</b><br><img style="width:80%" src="Credits/' + img + '" alt="' + img + '" title="' + nm + '"></td><td style="border: solid 1px;padding-left:5px"><p>' + desc + "</p></td></tr>")
	}
	var md = WritePlaceHeader(true);
	md.write('<table style="width:100%">' + '<tr><td colspan="3" class="inventbar" style="text-align:center;width:100%;vertical-align:top"><p style="font-size:xx-large;margin-top:0px;margin-bottom:0px"><b>Credits</b></p></td></tr>' +
		"<tr><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>" + "<tr>" + '<td style="text-align:center;width:75%" colspan="3">' + '<p style="font-size:x-large;margin-top:0;margin-bottom:0"><b>Compliments of HypnoPics Collective</b></p><blockquote>' + "<p><b>Plot & Programming</b><br>" + "FirstBorn<br>" + "cmacleod (expansion for 14.3 onward)<br>" + "Saglinus (ATM revision, rune spell learning and SVG map)<br>" + "marked20 (updated introductions, post enslavement events, collaborated on the SMS system, Sofia and more)<br>" +
		"Northwind (major rewrites for events, Miku, Camryn, Mom + Gabby)<br>" + "hjp766 (Nurse Tina)<br>" + "akkanero (image collection for male models including new wallpaper images)<br>" + "vestige, last_legion (image edits and fakes)<br>" + '<p style="font-size:x-large;margin-top:0;margin-bottom:0"><b>Compliments of the EMCA Project Group</b></p><blockquote>' + "<p><b>Plot:</b> Psi-Ki<br>" + "<b>Script Writer:</b> EH (Eternal Heart)<br>" + "<b>Puzzles:</b> David<br>" + "<b>Programmer:</b> Wizard<br>" + "<b>Tester:</b> Psi-Ki</p>" +
		"</blockquote>" + "</td>" + "</tr><tr><td>" + "</td></tr></table>" + '<p style="text-align:center;font-size:x-large;margin-top:0;margin-bottom:0"><b>Models used in the game</b></p>' + '<table style="border: solid 1px">' + '<tr><td style="width:25%;border: solid 1px;padding-left:5px;padding-left:5px"><b>Character</b></td><td style="border: solid 1px;padding-left:5px"><b>Model</b></td></tr>');
	addModel(md, "", "Abby - Agi H.jpg", "She goes by multiple psedonyms<br>Agi H, Agi B, Aggie, Agnes, Agnes B, Agnes Mirai, Agnes V, Agnes Zarra, Agness, Agnus, Agy, Aisha, Angiba, Ann-Lyz, Annie Ling, Dominique, Li Mei, Li Mei A, Mae, Ma\u00ef, Mai-Lin, Megan, Rakcadulam, Saruul A.");
	addModel(md, "", "Alison - Alison Tyler.jpg");
	addModel(md, "", "Amy Ross - Capri Carvalli.jpg");
	addModel(md, "", "Angela - Rebecca Linares.jpg");
	addModel(md, "", "Anita - Wanda Clooney.jpg", "Multiple Alternate names<br>Wanda Clooney, Valerie Rosen, Anita Vitus, Monica Vanda, Anita Vanoa, Monique Vanda, Anita V, Anita Lopez, Vanda Curtis, Vanda Vitus");
	addModel(md, "", "Aunt Brandi - Brandi Love.jpg");
	addModel(md, "", "Bambi - Kiki Vidis.jpg");
	addModel(md, "", "Beasley (Male) - Johnny Sinns.jpg");
	addModel(md, "",
		"Beasley (Bondage) - Dani Daniels.jpg");
	addModel(md, "", "Beasley (Bimbo 1) - Daphne Rosen.jpg");
	addModel(md, "", "Beasley (Bimbo 2) - Amy Anderssen.jpg");
	addModel(md, "Officer Becky Smith", "Becky Smith - Haley Cummings.jpg");
	addModel(md, "", "Camryn - Katie Banks.jpg");
	addModel(md, "", "Carol - Carol Goldnerova.jpg");
	addModel(md, "", "Catherine Ross - Jayden Jaymes.jpg");
	addModel(md, "", "Chief Batton (UK) - Katarina Nikita.jpg");
	addModel(md, "", "Chief Batton (US) - Breanne Benson.jpg");
	addModel(md, "", "Davy Robbins (Male) - Kyler Moss.jpg");
	addModel(md, "", "Davy Robbins (Female) - Paris Kennedy.jpg");
	addModel(md, "Diane White", "DA,CP White - Nicole Aniston.jpg");
	addModel(md, "Debra Kelly", "Debra - Lana Lopez.jpg");
	addModel(md, "", "Didi - Sophie Dee.jpg");
	addModel(md, "", "Donna - Elle Alexandra.jpg");
	addModel(md, "", "Ellie - Carla Onlycarla.jpg", "Carla OnlyCarla aka Carla Brown");
	addModel(md, "Esmeralda<br>New Age Store Owner", "Gypsy(New Age Shop) - Nikki Sinn.jpg");
	addModel(md, "", "Gabby Halliway - Gabriella Paltrova.jpg");
	addModel(md, "", "Ghost - Keana Moire.jpg",
		"Keana Moire<br>Some images are from the Bare Maidens image set 'Mysterious Cloth' and the model Jenniuva");
	addModel(md, "", "Gina - Shyla Stylez.jpg");
	addModel(md, "", "Hannah - Bryci.jpg");
	addModel(md, "", "Jade - Jade Tiger.jpg");
	addModel(md, "Janet Kelly", "Janet - Brianna Lee.jpg");
	addModel(md, "", "Jenny - Briana Banks.jpg");
	addModel(md, "", "Jesse - Allison Angel.jpg");
	addModel(md, "Witch Jessica", "Jessica(Witch) - Justine Joli.jpg");
	addModel(md, "John Adams (Male)", "John (Male) - Logan Reed.jpg");
	addModel(md,
		"John Adams (Female 1)", "John (Female 1) - Brandy Robbins.jpg");
	addModel(md, "John Adams (Female 2)", "John (Female 2) - Megan Rain.jpg");
	addModel(md, "Kate Granger", "Kate - Madison Ivy.jpg", "Madison Ivy<br>Some scenes with Phoenic Marie/Mrs Granger are using edited image from a set with Carter Cruise and some other undermined models");
	addModel(md, "Doctor Kristina Kay", "Doctor Kay - Tina Kay.jpg");
	addModel(md, "", "Kristin - Austin Kinkaid.jpg", "Austin Kinkaid<br>In one scene where Carol is charmed a model Jenny Badeau is used as a look-a-like model for Austin Kinkaid");
	addModel(md, "", "Kylie - Kylie Quinn.jpg");
	addModel(md, "", "Lauren - Shay Laren.jpg");
	addModel(md, "", "Leanne - Anna Tatu.jpg");
	addModel(md, "", "Louise - Monica Miller.jpg", "Monica Miller aka Monica Hajkova");
	addModel(md, "", "Madison - Maria Fowler.jpg");
	addModel(md, "Mayor Thomas", "Mayor - Rachel Roxxx.jpg");
	addModel(md, "Nurse Megan", "Megan - Sandra Shine.jpg", "Sandra Shine<br>In the pool scene she appears with a model credited as simply 'Jo'");
	addModel(md, "", "Melissa - Christy Marks.jpg");
	addModel(md,
		"", "Mia - Mia Robinson.jpg", "Mia Robinson<br>Note: Kiki Vidis/Bambi's actual mother");
	addModel(md, "", "Miku - Miku Himeno.jpg", "Miku Himeno<br>aka Mayura Serizawa");
	addModel(md, "", "Miss Logan - Kate Frost.jpg");
	addModel(md, "Your Mother", "Mom - Elexis Monroe.jpg");
	addModel(md, "", "Monique - Mariah Milano.jpg");
	addModel(md, "", "Mother Superior - Daria Glower.jpg", "Daria Glower<br>Also some uncredited images for other look-a-like models as a nun");
	addModel(md, "", "Mrs Granger - Phoenix Marie.jpg");
	addModel(md,
		"", "Mrs Robbins - Maria Bellucci.jpg");
	addModel(md, "", "Mrs Tanika - Diana Doll.jpg", "Diana Doll aka Sue Diamond");
	addModel(md, "", "Ms Jones - Dylan Ryder.jpg");
	addModel(md, "", "Nina - Lindsay Marie.jpg");
	addModel(md, "", "Officer Cheryl Khan (UK) - Louise Davis.jpg");
	addModel(md, "", "Officer Cheryl Khan (US) - Madison Parker.jpg");
	addModel(md, "", "Officer Ross (UK) - Adele Stephens.jpg");
	addModel(md, "", "Officer Ross (US) - Denise Milani.jpg", "Denise Milani<br>All nude/erotic images are edits/fakes");
	addModel(md,
		"", "Pamela - Piper Fawn.jpg", "Piper Fawn aka Ariel");
	addModel(md, "Player Avatar - Female 1", "Player - Female 1 - Eufrat.jpg", "Eufrat");
	addModel(md, "Player Avatar - Female 2", "Player - Female 2 - Teen Kasia.jpg", "Teen Kasia");
	addModel(md, "Player Avatar - Female 3", "Player - Female 3 - Taylor Sands.jpg", "Taylor Sands");
	addModel(md, "Player Avatar - Female 4", "Player - Female 4 - Beata Undine.jpg", "Beata Undine");
	addModel(md, "Player Avatar - Female 5", "Player - Female 5 - Arianna Roxx.jpg", "Arianna Roxx");
	addModel(md, "Player Avatar - Female 6", "Player - Female 6 - Natasha.jpg", "Natasha aka Larissa aka Natasha S");
	addModel(md, "Player Avatar - Male 1", "Player - Male 1 - James Deen.jpg", "James Deen");
	addModel(md, "Player Avatar - Male 2", "Player - Male 2 - Miles Pride.jpg", "Miles Pride");
	addModel(md, "Player Avatar - Male 3", "Player - Male 3 - Tommy (unknown more details).jpg", "Tommy<br>Found in an ImageFap folder, more details unknown");
	addModel(md, "Player Avatar - Male 4", "Player - Male 4 - Billy Frontier.jpg",
		"Billy Frontier");
	addModel(md, "Player Avatar - Male 5", "Player - Male 5 - Sammy Case.jpg", "Sammy Case");
	addModel(md, "Player Avatar - Male 6", "Player - Male 6 - Brent Corrigan.jpg", "Brent Corrigan");
	addModel(md, "Ms. Titus", "Receptionist - Kelly Madison.jpg");
	addModel(md, "Nurse Sandra (UK)", "Sandra (UK) - Shawna Lenee.jpg", "Shawna Lenee");
	addModel(md, "Nurse Sandra (US)", "Sandra (US) - Paige DDF.jpg", "Paige Delight");
	addModel(md, "Sarah Gates", "Sarah - Ashlynn Brooke.jpg");
	addModel(md, "Sir Ronald Gates",
		"Sir Ronald - Hill Thomas.jpg", "Hill Thomas<br>Images mostly from his role as Coreander in 'The Neverending Story'");
	addModel(md, "Sister Desiree", "Sister - Jana Cova.jpg", "Jana Cova<br>Some images edited from uncredited images of nuns");
	addModel(md, "", "Sofia - Missy Martinez.jpg");
	addModel(md, "Tess Adams", "Tess - Sam Cooke.jpg", "Sam Cooke<br>Some hardcore images use the model Cherry Jul. Others are edits including all parings with other characters");
	addModel(md, "", "Thrall 1 - Sarah Peachez.jpg", "Sarah Peachez, aka Real Peachez");
	addModel(md, "", "Thrall 2 - Lucie Lansen.jpg", "Lucie Lansen<br>She goes by many alternate names including Zoey McDonald, Lucinda A, Zoey Fox, Adele and quite a few more");
	addModel(md, "Tina Robbins (Mortal)", "Tina (Mortal) - Malta Flare.jpg", "Malta Flare<br>She is the model for Tina before she becomes a Vampyre");
	addModel(md, "Tina Robbins (Vampyre)", "Tina (Vampyre) - Cora Deitz.jpg", "Cora Deitz<br>Some images are from uncredited sources, notably any sex/bloody images");
	addModel(md, "Your sister, Tracy",
		"Tracy - Ariel Rebel.jpg");
	addModel(md, "", "Vampyre - Various.jpg", "Various models, mostly uncredited<br>Some by Melissa Lauren<br>Some by Leah Gotti");
	addModel(md, "", "Victoria - Little Caprice.jpg", "Caprice A. aka Little Caprice");
	addModel(md, "", "Zoey - Zoe Smieszek.jpg", "Zoe Smieszek aka Zoe OnlyTease");
	md.write('<tr><td style="border:solid 1px;padding-left:5px"><b>Reporter Julie</b></td><td style="border:solid 1px;padding-left:5px"><p>Julia De Lucia</p></td></tr>' + '<tr><td style="border:solid 1px;padding-left:5px"><b>Witch Wallpaper for Phone 6</b></td><td style="border:solid 1px;padding-left:5px"><p>Anita Dark</p></td></tr>' +
		'<tr><td style="border:solid 1px;padding-left:5px"><b>Sorceress Wallpaper for Phone 7</b></td><td style="border:solid 1px;padding-left:5px"><p>Zara via BareMaidens.com</p></td></tr>' + '<tr><td style="border:solid 1px;padding-left:5px"><b>Painting of Lady Elizabeth Ross</b></td><td style="border:solid 1px;padding-left:5px"><p>An edit of a washed out image of the painting "Ophelia" by Pierre Auguste Cot</p></td></tr>' + '<tr><td style="border:solid 1px;padding-left:5px"><b>Stained-glass Woman</b></td><td style="border:solid 1px;padding-left:5px"><p>Erin via BareMaidens.com</p></td></tr>' +
		'<tr><td style="border:solid 1px;padding-left:5px"><b>Bank Security Guard</b></td><td style="border:solid 1px;padding-left:5px"><p>Nella, Nelli, Nelly Hunter, Jana Miartusova</p></td></tr>' + '<tr><td style="border:solid 1px;padding-left:5px"><b>Student Teacher</b></td><td style="border:solid 1px;padding-left:5px"><p>Julian Smiles</p></td></tr>' + '<tr><td style="border:solid 1px;padding-left:5px"><b>Girl in the park wearing Daisy Dukes</b></td><td style="border:solid 1px;padding-left:5px"><p>credited as Melissa</p></td></tr>' +
		'<tr><td style="border:solid 1px;padding-left:5px"><b>Volleyball player at the sports fields</b></td><td style="border:solid 1px;padding-left:5px"><p>Teddi Rae</p></td></tr>' + '<tr><td style="border:solid 1px;padding-left:5px"><b>Dark haired girl at the sports fields</b></td><td style="border:solid 1px;padding-left:5px"><p>Miya</p></td></tr>' + '<tr><td style="border:solid 1px;padding-left:5px"><b>Campers</b></td><td style="border:solid 1px;padding-left:5px"><p>Shawna Lenee, Oklahoma, Erika Vuitton<br>A red haired Shawna Lenee is used as Nurse Sandra in the UK setting! These are restricted to the US setting. A UK varition will follow once sourced.</p></td></tr>' +
		'<tr><td style="border:solid 1px;padding-left:5px"><b>Dream of Ghosts in a Field</b></td><td style="border:solid 1px;padding-left:5px"><p>\'Day of the Dead\' photoshoot by Spencer Tunick</p></td></tr>' + '<tr><td style="border:solid 1px;padding-left:5px"><b>Succubus Dreams</b></td><td style="border:solid 1px;padding-left:5px"><p>Created/edited by GeistSD from the now dead GOTFanArt site</p></td></tr>' + '<tr><td style="border:solid 1px;padding-left:5px"><b>Demon Visions</b></td><td style="border:solid 1px;padding-left:5px"><p>Visions and bad-ending by cosplayer IscariotElian https://iscariotelian.deviantart.com of the character Catherine from a game of the same name.</p></td></tr>');
	md.write("</table>");
	addOptionLink(md, "return to the game", "DoReturn()");
	WritePlaceFooter(md, "", true, true)
}

function helpGamePlayPage() {
	var md = WritePlaceHeader(true);
	md.write('<table style="width:100%;padding:2px;border-collapse:collapse;border-spacing:0"><tr><td class="inventbar" style="text-align:center;width:100%;vertical-align:top"><p style="font-size:xx-large;margin-top:0px;margin-bottom:0px"><b>Game Play</b></p></td></tr></table>' + "<p>This is a guide to the game A Spell For All, updated for the <b>version 14.6</b> release (in progress)</p>" + '<span style="font-size:16pt"><b>General Tips</b></span><br>' +
		'<img src="data:image/gif;base64,R0lGODlhKAAoAOMKAKioqKmpqaqqqqurq6ysrLm5ubq6uru7u/39/f7+/v///////////////////////yH+EUNyZWF0ZWQgd2l0aCBHSU1QACH5BAEKAA8ALAAAAAAoACgAAAT+8Jkgqr046xzMO8JAbWR5BYMABqjpkuJothbLXuJrpqFc8zzdbOMTlooYpDFZQY2czaVrEGNRpcdaIKFQJG5R7OnU7fqUwmBvUFaI1OosJUCAvgXttcBZ3/tJMnEVeRlBaGE/eylUXF5XOTljOyGIbGWGFYs6KXMYKXlxnYKeI5ylFI0Jik0UPDQlIl5ts7RlXK87AbUKCF5cvbW4LrJdjcTGyAovQALJbQnGxbaU1LCITm1QYaOFpZSdeGVRrdTC3ThqhJlq5jiZJwBB6gMAPswbQa6R4V0/3u9ScuiCpmAONzEy1B1CWCEVIjE4fPhSlghiE0w1LOyz6AkgRw4jfs6E/JgRkI4WCy22QgGApIl431yCTFGgnUwRBSSk5NjhQQQAOw==" width="30"/> - these indicate that a bar can be expanded for more details.<br>' +
		'<img src="UI/themes/theme0/collapse.png" width="30"/> - these indicate the bar can be minimised.<br>' + '<img src="UI/apps.png" width="30"/> - Check your phone\'s apps for settings and your alarm clock. Check the themes to vary the game appearance.<br>' + '<img src="UI/addressbook.png" width="30"/> - In your phone this lists all the people you know, and can allow you to give them a phone call if the icon is blue.<br>' + '<img src="UI/walk.png" width="30"/> - these buttons move you to another place.<br>' +
		'<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAATwAAAE8CAMAAABq2/00AAAABGdBTUEAALGPC/xhBQAAAwBQTFRFAAAAAgICAwMDBAQEBQUFBgYGBwcHCAgICQkJCgoKCwsLDAwMDQ0NDg4ODw8PEBAQEREREhISExMTFBQUFRUVFhYWFxcXGBgYGRkZGhoaGxsbHBwcHR0dHh4eHx8fICAgISEhIiIiIyMjJCQkJSUlJiYmJycnKCgoKSkpKioqKysrLCwsLS0tLi4uLy8vMDAwMTExMjIyNDQ0NTU1NjY2Nzc3ODg4OTk5Ojo6Ozs7PDw8PT09Pj4+Pz8/QEBAQUFBQkJCQ0NDRERERUVFRkZGR0dHSEhISUlJSkpKS0tLTExMTU1NTk5OT09PUFBQUVFRUlJSU1NTVFRUVVVVVlZWWFhYWVlZWlpaW1tbXFxcXV1dXl5eX19fYGBgYWFhYmJiY2NjZGRkZWVlZmZmZ2dnaGhoaWlpampqa2trbGxsbW1tbm5ub29vcHBwcXFxcnJyc3NzdHR0dXV1dnZ2d3d3eHh4eXl5enp6e3t7fHx8fX19fn5+f39/gICAgYGBgoKCg4ODhISEhYWFhoaGh4eHiIiIiYmJioqKi4uLjIyMjY2Njo6Oj4+PkJCQkZGRkpKSk5OTlJSUlZWVlpaWl5eXmJiYmZmZmpqam5ubnJycnZ2dnp6en5+foKCgoaGhoqKio6OjpKSkpaWlpqamp6enqKioqampqqqqq6urrKysra2trq6ur6+vsLCwsbGxsrKys7OztLS0tbW1tra2t7e3uLi4ubm5u7u7vLy8vb29vr6+v7+/wMDAwcHBwsLCw8PDxMTExcXFxsbGx8fHyMjIycnJysrKy8vLzMzMzc3Nzs7Oz8/P0NDQ0dHR0tLS09PT1NTU1dXV1tbW19fX2NjY2dnZ2tra29vb3Nzc3d3d3t7e39/f4ODg4eHh4uLi4+Pj5OTk5eXl5ubm5+fn6Ojo6enp6urq6+vr7Ozs7e3t7u7u7+/v8PDw8fHx8vLy8/Pz9PT09fX19vb29/f3+Pj4+fn5+vr6+/v7/Pz8/f39/v7+////AAAAAAAAAAAAAAAAluOFBgAAAQB0Uk5T////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AFP3ByUAAAAJcEhZcwAADsEAAA7BAbiRa+0AAAAZdEVYdFNvZnR3YXJlAHBhaW50Lm5ldCA0LjAuMTXdYP5PAAAYR0lEQVR4Xu2deYAVxZnAawZQB5BLcbgcBC9EGBCIK7qYeG1WN8PhwSqSlVVxUUlAZTl0iGfUVTa4ImhURA2CUVcXRE0kJvEGBBEQBLmHYZiLGeZ6r6v6j9nvq/4ec7033e91V79uqF8MMK+r66vvN1Xd1edj9ZqU0fJcoOW5QMtzgZbnAi3PBVqeC7Q8F2h5LtDyXKDluUDLc4GW5wItzwVangu0PBdoeS7Q8lyg5blAy3OBlucCLc8FWp4LtDwXaHku0PJcoOW5QMtzQTrkjWLeM4rq9hWf5U3sRMmqoNNEiuIXfsqL9bgO51xx/aS7Z8x0zqxG0EcS/HnGXbdcf9XZJ1HdORTLF/yTl4u5dbrojqXfVwtTAKYp/3ICFD0KfSSxfjYFFzWblt4xorPP+nySl58DaZ10/oMbi6IxFbHk3SNMLrhp1hV/99DAE/E3REGV44u8bOwRHSd8VEXZKkMc+dPELIiVW19/J8VWiR/yclgm63nnHoHdQy3QA8XeX51m6VOPD/JgB9t2zLd1psENylEZ8PvhonbD2Hagz4ddr3J5UyGP4e/UGdgpPNrGJQZjAJG3hmb6sedQLa8DYyeML6XcfEOUjG+XwTKpDcpQLA92sl0WHVHe45rDRcWCbuoPO9TKg7nd6WsM9cO1OTB8+Ze9YINB7VCE0urhkOKszzk3/O95ZpSLz88Ee6NU7jdUyoMxO2yT8ulJIoTx3fAMlpGh0J5CeeCu7y7ue6+LAccd2/swlhlKeXkZrPfHsPGhXHwH5PGPezKWR+1RgDp5cCy7SsD0jnLxHWHATnfFCSp3GsqqZqzNvAjlkT6iTzKWQS3yHlXy8lnGpYfT1uticHEY9vhTqU2eo0oeYz03pG/IxoBDtfU91A1cdfKejao/i2KLENH56s4RKJLH2NAKPMcbAMqHKOt6aurNY+3e8+xEsUv4220zVHUR+ttbGLukCi9UUPvTy5ELVXU9JdXms7Z/wLN3gZDH+esZina4SuQxNqKYmp5+uCgarqjrKZL3WECGLADb3odCJG8iO2E3tTwAwPZjR1s1sxUV8hgbZQZgjkfguYmRarqeGnn/xYOxs4gxJzTy8ljWX4LlzlzdXsmZKQXyGOtXGJQ5HrG/r5Kup0TeWJ7+cwJN4OPCI+8+anNgEPeGR95z1ObAIBaER94qanNgEKtCIm8q6/QjtTkwiJ0dVRzeei9vFDttD7U5MIg9PVTce+G9vBzWt4DaHBxgrqLgpikV8gYcpCYHBlF4Xljk5RZRmwODODhEy0sVUZSbJnl5uTnJwNjgQ9TmwCCKBjNG7XNGrpNj4Vbl5bGUCGLPA3mp0LrCxPIm0vpt+w656MpfjBk9phmjAfpnU0bfU05tDgy8bNpYat1RErZ/zJi8Ky8ackYbyr+VKU4iefIZsY79bnx82TcFxSXllVVHnFJ1pCZYZwUQUe04AShYebi06MCGZY//a//20h85aUHcBbLTtR3x9KdFeP2Q42WAZAjYyTwAG0SNc4i8yYoXffrkcHwsIcFZ/HjysPT5938v7/7HE3PW4xNUqz1WWwMFtx4xSBZYjfMtsweikHyS05iW8nIZyxz0u4IIh5B49QRUJHk9IoCjNok24W9fdhUccXgFJFrwm8GZoI/8NKL5R/jMSdeFRWBN1qSRFD7bBfSRogaafTIK9hJ37cX+quU1gou9U2Df0Xzi0lQedLv+S2vxKQYtrzHgo2bpGS2GbpMfYel1W6PCgAFPa2kkMBQ534bHDGTKotFPsLnLml0RmIvVQUOIyplZTe01+gE2d09WB+dKf+AQvOrxpvYa/s1Yh7eieluXGJi8RN46qbG9o/9krP0ivZNtBXnEYCzo2Mhe7F85rO3jNVRMkwgh6h5u22CP/gE7kjk1emJsB0xDauY0nGgheYyNqIC9MZXRJADncOXDjj4WY8mDufE33NDy7IChKcSanNjAlX9NZO2WanEOEcZr7ehATcpjbOxhLc8hMFm+hroe/pnDuqzTOwuncBFd19Wyh38wNk1P8BwD+1XjnqPyGOu1MZmzhRpzY29pT8q7LwojmT7XOCB6H8nLYZ1+BHV6h5EE4sdOOFNm0PFG1+EJe00S1I3GrsdyWeZyPWSThS/PhMMMxli3Qi0vSYR54BToeiBvoJ7jJQvsIq6z5F2j5SWLEGKRJW9yMNxhK+SECVoG007rD/wbPoE5PBGQ+agQG7oyvJ/nHmxfMJB+0BR6s9zhTQuxD+CjYMiDBhVdAOoYm2O1KyAII3po2+dvzX90zvTbb77+5snTHnjkxVWfbyuNSocBaSq0IjpWynsgMPJEzYHVz8248uzeHWTDGujY8+yfz3hhdVF1cOSJfNmyB9I7FHBgwv9Mvn/F3Cu6yBYl4tSr5n5QKO/AwYFDIzldLJNNSnPPwxM6onzd7EutGwlj4FkLgj6xyL78/nVH5PhN81HR17I5+WmWZ/LDL17e0OXIWEtoOczqL19cIW8JSWu7d8i25Kf3N1i6/Dr5QnyENCWGyrGu498uS/OwPSgbkp+mNghhCF7w5ADZCID82EGl2YCnCzneuokbQKrRV2pkKx5IjzzY8PPShfKWVYDMOIPWGbyonKt/ZXoihGxDfnp+c4LveKiHbEBy5iysFXs8uEtOqdOCbEGahm3F4v4yfCrqEGvl/ovT9aq5WM/zFXmLuTC+HieDp6oOsSq4fg1ek0mDQBndZ3ny8tPuadaX9pCGVJF1dJi+F/Y9/k8ZZHCf5QnTqH1XfiGQW3WIrGfI+3XC/x2HDO33sBWHvel2FrKmDjMrj/2eB9s6IdZdKcNS8u6RtV2zHjd8FMYfZFwf5Qkuoit6y6iUuRfI+s74EI7zKIw/yLC+yiudKWNS2l4h65xbemzLM8uuliEpZ++QtY719+tyZEyf5MHhmFEkJ3eUsLdgxeOL/TzcwIh+yYMN+rbhGI+y9Rqs+sLtPs73MKBvPY9vH4LhKFfvwcqHbj825fGNcmZMmaoAqx++mcKpB8P5IQ+PZrfLF0xQnmrAAEN2+HXXEkbzQx4czRb9FGNRlqrAEFcU+3SohsH8kVco39FCOaoDg4wpPrZ6nqj4Z4xEGaoEw+RVUli1YCjV8nB7V/cIBqL81IKBnooYPmz3MJJyeXBAuwy/8JiyUw1EynrHj8myH/JMg2843T930l6f744ReZxH5DkoSk09GOzqSPjlYQa8+l6MQpn5AYabVY3nv6xWKALDKN/mrcCbACkvp8iGNUCfOgXW6LbSMBRfUpUtUyzvAN4SQFk5QjaqJbTUEVB88AHV36srW6VWnrgHY1BStsgGSbK6Zffu2y+nV3Y364IHQoXswcL3G/QGMVXIJqnc5gm+GW9UpJzskM0BOl82ZdHqDdv3FpUd3L19/epFk38qX+eHUEk7oGSHrYofvpbtUSqv/F8cZywbw9pf/OineP8d7GnkNgvn2EJU/u3BkdZy55VdWxbyYcufxwiUUKvIprAek78og50k+IJug/d+HoUf+nBSEre2QLGTloRbnijES2WUT2vIhrDuD/9giZJ3jcX+gx8B/OuH/G5WQVqrNaBU3xJqhhpkS1TJAwXGw44zZSxnXgWtmRBR/gR+R7yTOrHUk4bKPa5siCJ5+OLDgrOhfsqmFbAVWTdsdjCpFcZ3o7OwOK3ZClDovEMqzw9gM1TJw7H2P07TZP3eqnZwRAAj2qxeJjsfrdsKUOh5HO+qwFYolLcH78CjVBIi2zB6F27VHMjDPck2eXLQScXDChz05lSRjVAmz3zRWYqMTSt2PieDzcHBu+VaVENCoMgrCm/BkG1QJc+sHuQsw67zjCTuM8F78YzHTnZW9eDakPY8/oGzBLu/HjHk3MQZcuJSu7i7s8o/CmnPi9xunx/GfyOCOhzLw6Kc1yzGVamWRECJKRFazXuwAcrk7Tn6wqqEYPjHUryf+De4MtWTCMb678c5Nq3iLRhflTzjBdvkMPq0mhQnstX/gatTTQmAAi9B7eGTF2nxZtzmYPCrS/AhnlTghy7HCqiu+MDyayMO5o8pgdFVyfuqk4N+kb0XSqbW84TYeRrUQHUlAHbl63FmrQJl8qC9c+0yg+UnLXGxPRL8JdsrmrB8Qdi2ebiducJBYqOrUk8MOlSl7clCWH4NzqtVAHWrkWeKWrtRC5FP3+FiRMGUhW/tCbVQffFhrJuqq5DK5HHxuX1a7NGIm9v/wV4EH/Sn+uIDy7+h8l4DVSuSZzxhkxYs7u36W6r4PruuB4vnhWxvy3nVVfZdYrbrpIQxA+qhGuMDs6HqcMkT5s6zbJPqs9X1hlzwLb1s45y5N2RTFb4aKqbmxwUWT3V/5zoXUTzOoDrjAov/oub6LdSspueJ+fY5/c39aIJ9xsf2gRaGbNjifQLU+vgwNrDGg8mrENX224eZYZM31rY/zEn1oLYRONfDe7Co1rgwdkO4tnkiMtRW3koP5OEXs71jK29YuLZ5fF9nu4xO3m0angyn7Sfbheqs5ltPVckTXzT5upeWMHYZnk6n4q4QF9uFar+OinqLKnnmClt5k51canSCuNUu1IkfUVFvUSZvOdRLjY8HLH3co45n8odsY71LRb0FKlYj71XbhN6mku7BF9lRvfGApcuopLdAxWq2ec/bDaUum6ioa/jGDnbBFlNRb1ElD08jU9PjwljvbVTSNWJLtl2weVTUW1TJE9Pt8um3i4q6Z7vNJU6Yj1NJb1Em7w67fAbglR9v2HO2XbBfKzk+UyZvkl0+gw9QUdeIggF2waaES559z9tHRV0j9pxpF2x6uOTZnFSBbd5OKuoa8cPpdsHuD5e8R+3y6enZ3pZv6W4XbCEV9RZl8vCd/a3g5TxPbGhvFyxc8zzxGtRLbY8HLF1BRV0j3raNFa4jDPOPtgk9TCVdw22u3cLS96iot0DFSuTx90+0G0q3CevxKNeIW+xCheysCl/T7KvDm8PYKK8ehzUutAvVwbPtaxNUyRNFjb+9OQ6wx9jh0fxhq+1J6+xiKuotyuRFBtllxN716I7NN6EuqjUujF2kZJqnTp643lbevVEPLgAJwW+1lXdTuOSZ4t7WM4KUzq1yfwMO56Kyj+2vaVbIep65ECqm5scFFn/i/qZDzo1V9oFeCJk8vtY+pwl1rpMSog62DzaBstaF7KK3fGaPmh8fxnpscb3LEHy9zYEtxDlnT8h6nqgeZ5sUm+HBDsNudwFxxit6/kydPCe3SfXYBSVpjdQQ2/HJZaoxLrB4gUfXOJsDVSvaYfA1NllhWg9FXcqLznYQZaMad8rkgZOozTUtTKvrV+5u6OafwYGMXZTeityplGf+3D4vlleW+pASBi/B931TbfGB5WM9OpJpAdStRh609ykHiZ24JPWexwWfh82n2uIDy58JXc8DNnW1SQwz67I+9dTEGvvXozF2yrYwPjIa+Se71DD4pQeSeco7BugQxu5/sAuAEUZHFI1apfK4zQ04AEaf5uSVIC0AeUcm4epUUwKgwNtYWAkYXpU8s/Bcu9ykvelG8vLAXfQuXJnqSQRj5x+SxVWA8ZX1PJkeZZEIjL8wkvyRBq/5Ha5KtSQCSkyPykGuAmyAKnlCfGKfHubX/qkITNmcJ4hfJFT9GH6hK9WRECjyd0VjFoDa1fU8YQx1liCbUcWdv5QGX7hQOQ1XoxoSAkV+UkdrKQCboKzncfF7ZxnC4Dro/Kwy/FIK5fbOSdWLw/pGHy5KfuIgRalv8Brn8owvzsNVaO3EQJmRJercKZWHvOQkSWmv1/wyOM7F18bRqi0ADSIKZUqeli9wpHVbAQq9rrDjKZdXjl9fS7m0gmzGNZvRXuLtO27rYMyux2Nmh5VeUKFoRyuR7VAoz+krQ2U72k/eiAestGpLYCdrbJgkXz3osMpXW+vJrpENUSnvoLOuR/o6//rbGlqzJUJUf3OX9cpfWqdVoNiQMuHVwx7xkE1RKC/Kl+AroimfVpFNYd0nroShBoMXkoZBStVAhxTi8LsTnL9uFavLWqZwzAKyLSp7njhyi8NsY/pYj5uWf1uJWz/8T2KK8g1v3EDv+XVe2ZRqhXsLQLZGoTzD5D90cZxwTB/rNuK2R/64trCopKTkUOHaNx/99+HU55KpqeuPKne1gGyPyp4HM9oHMQblZI9sEdGpZ79eR99rjlAZe7DwEymcrEkK2SSF8pDiCyEGJeUI2aiW0FJHQPF/LFX9la2yVYrl8fc6J5m6hWwbQj8nAazUeZXcWqpENk6xPEM8h1EoLz/AcC+rOxUVA8OolgfzM3yhmX/2MNi4WpzthF8eTDi2JftlLK6AWIN2KhaH+CEP3y37of11Ls+ASD2+9OP7vX2Rxw1R+1sMRNmpBQPNi6j+/h8EI6mXZxpGVL6QnPJTCYa5tw7cHRs9DxHmYQcv5vUADHK3P9+T6Z88LorHYCzKURUY4toSH3odgsF8kQeboIJhGIyyVAMGuOyQ6ilKDIzmU88TfBNeTFNpD6sftkWezfcDDOeHPESIHWr7HlZ+4U5/xCEYzz95xsEbMR7l6jVY9S8PefNyL0dgQL/k4cgtvENGpHS9RNZ7VxFMiyicemRIv+QB0ZopMiRl7B2y1rtroXcfmz0P4Wbdf3fFmJSzV2CVpy6o8297h2BQP+XhrWF/ktf7vdQn6xv416hPU5QYMqyP8uRlsF0TZFjK3D2ytkl75UU3P5FxfR22OOc78qx1PYeSd4es6ZTnq+G34tP8LoaM7GfPQ4QZXYF3AAEkIHWsai563/DhFFRzZGj/5Zm85qkcGZscpIqso+8ztUpvq0iEDO63PNxtiOimX+K9na70yfU73LrZwC0p1e0jMrzv8uS2j9e9cr4Mn6o+a+Wh79Th1eF02JPx0yAPEWbNK/JgNyV91oojlvo8t2uMbEG65OHh2u8HyyYk6Y/WueCVIuh0VJ3/yDakSZ60x8tfu1g2AiAzdlBp9rNXD+NoPT7lWZkL01j3q3NkOwDykxgqxwZO3xiR95Gmz116ex4BCve+MS5bNkVCnppDS4Hu49/c7+MJgETItqRfHhfG7pdvp52vBRmzoM8kQyYv3sN9O1vcGrI56ZeHGz9RV7Fp4S/64aPbiTj53AmLNh+WjwsFwF0g5IE+3HJJh9GCL/8we/zIPrJdjTl95E2zln9dAIMVXxwHJdO5sSNkwx4IQEOaIvZ/9cn/LX/pmcfm/nb+y8tWrl67H3UFjYDKwyMQqzPC/7Gn4TEELQoOJC94WM7wP2kNN3PWguAQseQF67eKjcGOBn+jupjAwMkrtuQFr2FhYJeUlx+snhcWvpXydM9Lif+V8vK1u1TAl+4EbocRBsCYYV0DnBGAg+ywwUUZvhKHsTuDN4cKPnxrLynvWj1sk0aIZZlsIsi7QMtLFs75bYzhqbIhVVpeknCzKlfKy2i7SstLEiFWtWV59ThwJ0foM41DePR2PNmNfa9PKR580+caJ5TmsE4oD+zNC+AZn0AjnoYDM5I3aH8QTzYGmL2DWAZemKqvz83InK/lJcX8NizHkgddL2eflucU2D3sP8O6Nop/5DE2pzYA1/JCghGZw9jUmLx62HX83b/nF0IO53/tIgctyYOBe4ln3/p5rCMKLond0GD9NRW/3Z3rU1O2GNwUt2XAwYUk5pBlLomm4abokMEFj7ySGet4MXlgL3ulninbAR1vZY+j7o7KA3t9v9TybODis74N7hrkwXwl+xvY7GmBieDc5OuzWWyDBzRoBHtn/dnPRy5DBhyEGX8+q7G7RvLQXq8Veo+bCM75ip5N3DWWVz+KsS5zy6isphlGeX7HTJZLriSN5WHfa3PdPkPgTau6BxIwXPHWcb5vXBvGRpEpiyby4EfGzlxSpU+NNgJdcHHk9f6MZTTpdy3k1edC5xu5tlafHW0Ael3dWnxaJCefJMVoLk92vlMmb3H+LQHHOjBqv7/9VLBCfhoR5yPofKzdzR+UwuDFeR9yXG0BIVeZM3Q5/EfZhze2BSON97Ix4sjDU1Sgb+B/flEYMbmB9wPjPcLHC4308UjRZ7MGnJABI5bMNCWuvPr6TiyDZWYNvfmlbystbcfPKMZxJv9fsfHFCRe0+ir6RJ9PBXuSNn2vuPbf7rxv5qyZxw8z7p543c/OgJmJJH6vQxLJq6/Pn5pnPcp+PJNYHJJYHpHf5B3ZxxPyMkWr2MrTJEbLc4GW5wItzwVangu0PBdoeS7Q8lyg5blAy3OBlucCLc8FWp4LtDwXaHku0PJcoOW5QMtzgZbnAi3PBVqeC7Q8F2h5LtDyXKDluUDLc4GW5wItzwVaXsrU1/8/kJ1Yka/ScfEAAAAASUVORK5CYII=" width="30"/> - click this icon on images showing it to take a photo and set as your wallpaper image in your phone.<br>' +
		'<img src="UI/themes/theme0/bookred.png" width="30"/> - if the book turns red or blinks try looking at it.<br>' + '<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABAAgMAAADXB5lNAAAACVBMVEUAAAD+/v7///89+DgTAAAAAXRSTlMAQObYZgAAAVZJREFUeNptU7sVwyAMlClcMAIjeArPwxSMQJ3KhV8eaMqgk4RJXlSY8xn9zhIRvd5kpmhnrvpu6GBuShjiYUooCnIUeTcU5agWgvmi9O1yS6RBw+Rys0gx98uiZomwCTwlSicghoEncYtKXBKQ7GS2L4MoG5udAUG1Iq1Pgjb3YEA6bsnxLuElKVKjVIN2h2O/KZbdBBmeNVwUSpLSho1kdyj4Mi7s1QC6Hn0dDd2aUONe7o7kwDU8CmTpTmRIFU17hP9LJDxBxKGx00Y0EMWJYN6nE9uS3G5o8oWYJa3P/0T4JeIvcSDcQmQV60mrM+Jpi1fnWp1yjWbpaO5oNJtD+3ul2X7ymXMi+mR/a/pFdCeyVcNOzGqKvjtaR9tCzQVSsA7MulnPrvEzdDw3y8bS5mOxS10fa6i3P4RKePl6RP/ZvkD+s8lXjOAicvp6Q1rIqWsq+AM8u0pummQWSgAAAABJRU5ErkJggg==" width="30"/> - you wake at 6am, but you can change this in your phone in Apps and the alarm clock.<br>' +
		"<ul>" + "<li>You can only find one spell from each of the chosen locations. Once you have found a spell don't bother with more words but go to another place.</li>" + "<li>The scarce commodities are money and mana. Use what you have carefully or you could get trapped.</li>" + "<li>The game has many interwoven paths. You can not access the entire game in one playing. React differently to situations to see where it takes you.</li>" + "<li>The game is still being developed, therefore there is no fixed ending yet.</li>" +
		"<li>You HAVE to have the book IN your inventory to learn spells. You do not have to have it to cast spells.</li>" + "<li>You HAVE to have mana to cast spells. Talk to Sir Gates or Mr. Beasley about where to find Mana to get things rolling.</li>" + "<li>In general wander around and talk to anyone who will speak to you.</li>" + "<li>Charm the panties off anyone and everyone, but there is an optimal order.</li>" + "<li>Some events are timed, as in they will appear, a phone will ring, a knock on the door, and you have a certain number of actions to respond. The varies from <b>one</b> to ten actions.</li>" +
		"<li>Some events are timed based on the number of times you visit key locations, these are commonly <b>The Wild Ranges</b>, <b>Your Bedroom</b>, <b>The Library</b> and a follow-up event will one happen after a few visits to these key locations. There is an event that requires you to visit the <b>School Hallway</b> to trigger an event elsewhere (Sarah teaching Clairvoyance on the Murder path)</li>" + "<li>You can leave <b>any</b> item in your own bedroom.</li>" + "<li>The game will give you items like Old Stones at times but generally only if you do not have one in your inventory. It is best to use stones when they are found by visiting the Wild Ranges.</li>" +
		"<li>The exact order of some events are not required, you can charm one person then another or do the second one first, but as noted there can be an optimal order to see all possible content in the game.</li>" + "<li>Save regularly, the game does auto save every morning and evening.</li>" + "<li>Check the notes in your phone, it will remind you of things you have been asked to do.</li>" + "</ul>" + "<br>" + '<span style="font-size:16pt"><b>Themes and Game Settings</b></span><br>' + "The game has two themes that control the appeaance of the game windowns, black and white, and are set via the 'Themes' app in your phone. Use your phne, select the 'App' icon and click it to cycle through the available themes.<br>" +
		"<b>White Theme</b> - the background colour varies by the time of day, but is generally a lighter colour. Text is usually black. Icons are usually white. Icons are usually black.<br>" + "<b>Black Theme</b> - the background is uniformly back, except for some specific screens. Text is usually white.<br><br>" + "Also you can alter other parts of the user interface<br><br>" + "<b>Inventory:</b> the items shown can have icons shown for the actions you can select, or test labels. Use the Icons option in your phones Apps to change between these modes<br>" +
		"<b>Chat Bubbles</b> - The popup bubbles many conversation responses appear in are by default centered in the window. They can also be positioned at the lower left of the screen. Use the Test Pos App in your phone<br>" + '<b>Explicit Content</b> - Explciit images in the game can be disabled using the "Explicit content Filter" App in your phone<br>' + "<b>Runes</b> - You can change from the 'Rune Matching' system for learning spells to the older version of looking up text (spell names) in the Book.<br>" +
		"<b>Puzzles</b> - You can enable or disable puzzles at the start of the game or via the 'Puzzle Helper' App in your phone. In the walkthrough the answers to the puzzles are given. Each has a variation and each is given. If you disabled them then you automatically get the puzzle correct.<br>" + "Note: For many puzzles you can ask Monique at the library for the answer.<br>" + "<br>" + "<b>Side Bars</b> - the left bar and the right bar with your inventory/phone can both be minimised to show a minimal set of icons. Some of the icons will show useful information if you hover your mouse over them.<br><br>" +
		'<span style="font-size:16pt"><b>Cheating</b></span><br>' + "The game has a built in cheat mode. You can enable this at the start of the game. If you did not then open your phone and select the Apps icon. Enable it using the \"Cheat Helper\" app. The chear menu is then accessible in the Left Bar of the game, at the left of the game window. Expand the bar using the + icon and click the 'Cheat' link.<br><br>" + "Otherwise in the menu<br>" + "<b>View People</b> - allows you to edit details for yourself or other people in the game. Includes add/remove items from a person.<br>" +
		"<b>View Items</b> - allows you to add or move items in the game that are not in someones possession.<br>" + "<b>View Places</b> - allows you change flags for a place. Flag 1 indicates a place is known and visitable.<br><br>" + "Details on flags and other technical details are documented in the files in the folder<br>" + "Development<br><br>" + '<span style="font-size:16pt"><b>Gender Differences</b></span><br>' + "Male and female players do affect a number of events, notably how you learn the Possession Spell.<br>" +
		"One item, a strap-on is unique to female player and is only present in the Explicit version of the game.<br><br>" + 'In the walk-throughs male specific bits are colour coded <span style="color:blue">blue</span>, female <span style="color:red">red</span> (pink is not too visible)<br><br>' + "It is possible using the <b>Transform</b> spell (below) for a female player to become a hermaphrodite/futanari, a woman with a cock as well as a pussy. In most situations the game will treat you a a male for sex scenes except you will still be referred to using female pronouns like she/her etc<br><br>" +
		'<span style="font-size:16pt"><b>Transform Spell</b></span><br>' + "Currently the Transform spell will only affect your player character or six  other characters, Mother Superior, Louise, Jenny, Madison, Zoey and Davy Robbins. Only at certain places and based on some selected dialogue choices.<br><br>" + "To be able to transform people<br>" + "<ul>" + "<li>Correctly answer the 'Gold Worm' and it's puzzle to learn the spell</li>" + "<li>Defeat Kurndorf via the ritual and get the Quartz Crystal with Kurndorf's sould bound into it</li>" +
		"<li>You need to learn of the Mirrors of the Soul in the Hidden Room to be able to cast the spell on yourself, and then cast the spell there in the Hidden Room. The Vampyre or Ms. Jones will give this information.</li>" + "</ul>" + "For all people except yourself and Davy Robbins you must first cast Charm on the person before being able to transform them<br><br>" + "Some options are always available, but some require specific selections. When seeking the Relic and Jesse phones, answer 'cock' and then you can cast it on yourself (female Player) or Davy Robbins or one of the variations for Mother Superior, Louise and on Jenny. Male players can always cast it on themselves.<br>" +
		"<br>" + "You can change this choice, but not the effect of a transformation. Visit your room and open your storage chest. Look through the Explicit porn magazines and look for the magazine 'Erections' and select your interest in the magazine to alter this choice.<br>" + "<br>" + '<span style="font-size:16pt"><b>Paths</b></span><br>' + "These are major ways to play the game that considerably vary events in the game. There are two currently, each with variants.<br><br>" + '<span style="font-size:14pt"><b>Apprentice Path</b></span><br>' +
		"In this path you become Sir Ronald Gates' apprentice. In this path <b>no killing</b> will take place, outside of a few bad endings. The base version is<br><br>" + '<span style="font-size:12pt"><b>Charmed Path</b></span><br>' + "You accept his apprenticeship and Sir Roland teaches you the ways of magic and how yo deal with your rivals<br><br>" + "There is a major variant of the Charmed Path<br><br>" + '<span style="font-size:12pt"><b>Conspiracy Path</b></span><br>' + " In the path you refuse the apprenticeship and leave the mansion. You cannot return there <b>normally</b>. An anonymous benefactor will send you aid. Parts of the game are significantly reorganised, notably for money and the Clairvoyance spell.<br><br>" +
		'<span style="font-size:14pt"><b>Murder Path</b></span><br>' + "In this path Sir Roland Gates is killed and you are the prime suspect and can be the actual killer. In this path <b>people can be killed</b>, either by accident or design.<br><br>" + "There are two variants of this path<br>" + "<br>" + '<span style="font-size:12pt"><b>Hard Murder Path</b></span><br>' + "You demand Sir Ronald give you the Book, and argue over the book with Sir Roland and kill him by accident.<br>" + "<br>" + '<span style="font-size:12pt"><b>Soft Murder Path</b></span><br>' +
		"You demand the Book but leave before killing Sir Ronald but then witness another killing him and will be considered the murderer.<br>" + "Death can still take place in this path, you are just not personally responsible for Sir Ronald's death, maybe others, just not his.<br>" + "<br>" + '<span style="font-size:16pt"><b>Story Arcs</b></span><br>' + "There are major quests/story arcs in the game and common to all paths. These are semi independent, except some require the completion of others.<br><br>" + "<b>Seance</b> - to try to summon the ghost of Kurndorf and learn his secrets.<br>" +
		"<b>The Ritual</b> - the aftermath of the Seance and trying to banish or bind his ghost.<br>" + "<b>The Demon</b> - a demon unleashed in the Seance is stalking you.<br>" + "<b>Dragon Gem</b> - quest for a hidden spell and to get an item of magic power<br>" + "<b>Davy and Kate</b> - Davy is obssessed with Kate and it can be a key to controlling him<br>" + "<b>Vampyre</b> - there is a vampire in Glenvale, stalking the Gates family<br>" + "<b>A Witch Freed</b> - Jessica can be freed after the Seance, though many people just keep her as a slave<br>" +
		"<b>Ross Sisters</b> - To control the three Ross sisters, incomplete as Amy cannot be controlled yet<br><br>" + "These two arcs are interdependent and require <b>Dragon Gem</b> and <b>The Demon</b> to be completed<br>" + "<b>Free Leanne</b> - The Demon takes your friend Leanne as a souless Thrall. Can you save her<br>" + "<b>Corrupting Mother Superior</b> - The Church's Mother Superior is very stong willed, can you take her as a slave?<br><br>" + '<span style="font-size:16pt"><b>Trainings</b></span><br>' +
		"As your character gets more experienced you can learn improvements to your magical skills/spells. These are learned based on a point system.<br>" + "<br>" + "You earn 3 experience points per spell learned and 1 point for every person/being charmed. You start with 1 point once you pick up the book, and Tess's research and the Gold Worm give a small amount. Once you learn of the 'Mirror of Souls' you can look in it and see the current total of experience and total of experience spent so far.<br><br>" +
		"Every 9 points you get the option to learn a training and the Book will start blinking in your inventory, <b>examine it</b>. You can then consult with either Sir Ronald or Tess Adams to learn a new ability. On the <b>Conspiracy Path</b> Sarah can also teach you. You only need to examine the book once, the book will blink each time you get enough points. One hypnotic ability (key to Mother Superior) is learned separately from Mr Beasley, you still need the points to learn it. Another ability 'defending yourself with magic' is learnt from a person once you charm her.<br><br>" +
		"The trainings are<br>" + '"manipulative charms" - add variations to the charm process for selected people<br>' + '"defending yourself with magic" - protection from other magical attacks (<b>only learned after charming Alison</b>)<br>' + '"masculine cantrips" - ability to charm men<br>' + '"medium powers" - ability to charm ghosts<br>' + '"precision transitions" - can teleport with people and can enscribe your own hexagrams<br>' + '"conserving magic" - charm costs less<br>' + '"harnessing mana" - you get more mana from stones<br>' +
		'"golden gestures" - you get more money from the Wealth spell<br>' + '"unseen" - invisibilty lasts longs<br>' + '"augmented hypnosis" - instant hypnotic induction (<b>only learned from Mr. Beasley</b>)<br>' + "<br>" + '<b>NOTE</b>: avoid learning "conserving magic", "harnessing mana", "golden gestures", "unseen" until you known at least<br>' + '"maculine charms", "defending yourself with magic", "precision transitions",  "medium powers" and the hypnotic technique from Mr Beasley<br>' + "<br>" + "<b>Important</b><br>" +
		"At one point Mr Beasley will offer to teach you a hypnotic technique. First you need to find and read a book on hypnosis.<br>" + "<br>" + "The technique is a training like all of the above and costs points, and IS NOT taught by Tess, Sir Ronald or Sarah. So visit Mr Beasley when the Book is blinking/you can learn trainings.<br><br>" + "The same applies for 'defending yourself with magic' Alison can teach it once you charm her. but you need the experience to actually learn it.<br>" + "<br>" + '<span style="font-size:16pt"><b>Day and Night</b></span><br>' +
		"Time passes in the game at the rate of 10 minutes per action outside and 5 minutes inside. Some actions take no time like checking items or your phone. Options to relax for a while take 1 hour or 30 minutes, depending on the location you are in.<br>" + "<br>" + "Most shops open at 8am and close at 6pm but some places differ to this like the School and Restaurant.<br>" + "Some events are unique to day time or night time.<br>" + "<br>" + "Additionally there are days of the week, with the game starting on a Monday. Some places are not open on weekends, for instance the Town Hall and the Bank. Some events only happen on certain days of the week, the game does tell you these criteria but they are not noted in your phone.<br>" +
		"<br>" + "You can spend the night in your bedroom, waking at 6am. You can change your alarm setting in your phone to 6am, 7am or 8am, using the Alarm App. Some friendly (read charmed) people will allow you to spend the night at their home too.<br>" + "<br>" + "Some things you may wish to save for night time, like using stones or having sex <b>again</b> with charmed people. At night the spell 'Pass' can be your friend and allow entry to some places otherwise locked.<br>" + "<br>" + "The following guides do not note spending the night and some of the steps listed below can vary where you leave some for the night time.<br><br>" +
		"<b>Important</b>: some events are time critical and if night falls and closes a building it can prevent the completion of an event. Notably<br>" + "- Charming Tess and getting a free slave of Ms. Titus<br>" + "- events with Sarah if the Vampyre escapes<br><br>" + "<b>Tip:</b> Save before you go to sleep the first time in your own bed!!!<br><br>" + '<span style="font-size:16pt"><b>Walkthroughs</b></span><br>' + '<p>A fan made walk-through by Capacitor is available <a href="Help/walkthrough-capacitor.html">Here</a></p>' +
		"<p>The following are out of date, last updated for version 14.6 <b>except</b> Mom and Gabby story is detailed in the apprentice path below.<br>NOTE: You need a different defence if you confront Mr Beasley for the Book</p>" + '<p>A walk-through for the <b>Apprentice Path</b> is available <a href="Help/apprentice.html">Here</a></p>' + '<p>A walk-through for the <b>Murder Path</b> is available <a href="Help/murder.html">Here</a></p>' + '<p>A walk-through for the <b>Conspiracy Path</b> is available <a href="Help/conspiracy.html">Here</a></p>');
	addOptionLink(md, "return to the game", "DoReturn()");
	WritePlaceFooter(md, "", true, true)
}

function addCredits(doc, credits) {
	if (credits !== undefined && credits !== "") doc.write('<p style="position:absolute;top:0;right:10px;font-size:small;margin-top:5px">' + credits + "</p>")
}

function showTaxi(doc) {
	if (!doc) doc = mdCache;
	doc.write('<p style="margin-bottom:-1px"><img draggable="false" src="Images/' + (isBritish() ? "UK" : "US") + '/taxi1.png" style="margin: 5px 5px" width="109" height="50" alt="Taxi" title="A taxi is waiting at the taxi rank"></p>');
	addOptionLink(doc, "hail taxi", "boardTaxi()", "hailblock")
}

function boardTaxi() {
	Leave();
	var doc = WritePlaceHeader();
	var OutTown = false;
	var InTown = true;
	if (Place == 16 || Place == 64 || Place == 317) {
		OutTown = true;
		InTown = false
	}
	var bMoney = InTown && nMoney >= 5 || OutTown && (Place != 317 && isPlaceKnown("Church")) && nMoney >= 5 || OutTown && nMoney >= 10;

	function RideInTown(doc, lInTown, plc, desc) {
		if (Place != plc && isPlaceKnown(desc)) addLinkToPlace(doc, sCurrency + (!lInTown ? "10.00" : "5.00") + " - " + desc, plc, "", "", "", "AddCash(-" + (!lInTown ? "10" : "5") + ");", "travelblock")
	}
	if (wherePerson("Kurndorf") == 16 && Place ==
		16) {
		AddImage("taxi3.jpg");
		addPlaceTitle(doc, "Frightened Taxi Driver");
		md.write("<p>As you approach the taxi you see the driver is looking away and a glimpse of his face shows fear. You hear him whisper \"Nothing is there, ghosts do not exist\" and then he repeats it. You try to attract his attention to leave but he is 'freaked out'. As long as that ghost is there you will not be able to get him to drive you anywhere.</p>")
	} else {
		AddImage("Setting/taxi2.jpg");
		addPlaceTitle(doc, "Taxi Driver");
		if (isBritish()) doc.write('<p>The taxi driver smiles at you. "Anywhere you want to go, ' +
			(perYou.isMaleSex() ? "Gov" : "Ma'am") + '?" he asks with pound signs in his eyes.</p>');
		else doc.write('<p>The taxi driver smiles at you. "Anywhere you want to go, ' + (perYou.isMaleSex() ? "Mister" : "Miss") + '?" he asks with dollar signs in his eyes.</p>');
		doc.write("<p >Taxi fares are a quick way of using your money. Be careful so as not to get stranded somewhere.</p>");
		if (bMoney) {
			doc.write('<p id="taxi" class="gblock" style="padding-top:0;padding-bottom:0;margin-bottom:-6px;margin-top:-4px;font-size: medium"><b>Fares:</b></p>');
			RideInTown(doc, InTown, 9, "School");
			RideInTown(doc, InTown, 2, "Library");
			RideInTown(doc, InTown, 44, "Kollam Street");
			RideInTown(doc, InTown, 194, "Glenvale Shopping Center");
			RideInTown(doc, InTown, 43, "Yoolaroo Drive");
			RideInTown(doc, InTown, 5, "Dervish Rd");
			RideInTown(doc, InTown, 37, "Cherise Rd");
			RideInTown(doc, InTown, 38, "Amaranth Pl");
			RideInTown(doc, InTown, 94, "Town Hall");
			RideInTown(doc, InTown, 123, "Broken Inn Hotel");
			RideInTown(doc, InTown, 238, "Museum");
			RideInTown(doc, InTown, 167, "Police Station");
			RideInTown(doc,
				InTown, 215, "Hospital");
			RideInTown(doc, OutTown, 317, "Lady of Our Heavenly Father Church");
			RideInTown(doc, OutTown, 16, perGates.getPersonName() + "' house")
		} else doc.write('<p id="taxi">"You don\'t have enough money!" he yells.  "Get out of my car!"</p>')
	}
	addLinkToPlace(doc, "Get back out of the taxi.", "");
	WritePlaceFooter(doc)
}
var nTime;
var vTimedEvent;

function getTime() {
	var tm = nTime % 288;
	return Math.ceil((tm + 1) / 12 - 1) * 100 + (tm - Math.ceil((tm + 1) / 12 - 1) * 12) * 5
}

function getHour() {
	return Math.ceil((nTime % 288 + 1) / 12 - 1)
}

function getDay(shrt) {
	var arDays;
	if (shrt === true) arDays = ["Mon", "Tues", "Wed", "Thurs", "Fri", "Sat", "Sun"];
	else arDays = ["Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday"];
	return arDays[Math.floor(nTime / 288) % 7]
}

function getTimeOfDay() {
	if (isNight()) return "night";
	if (!isDay()) return "evening";
	var hr = Math.ceil((nTime % 288 + 1) / 12 - 1);
	if (hr < 12) return "morning";
	if (hr < 16) return "day";
	return "afternoon"
}

function isWeekDay() {
	return Math.floor(nTime / 288) % 7 < 5
}

function passTime(noev, out) {
	var nOut = out === true || isOutside() ? 2 : 1;
	var tm = nTime % 288;
	var bDay = tm > 71 && tm < 240;
	nTime += nOut;
	if (isDay() != bDay) {
		if (perYou.extra[1] > 0) perYou.extra[1] = 0;
		var s;
		if (bDay) s = passTimeNight();
		else s = passTimeDay();
		if (s !== "") WriteComments(s)
	}
	if (noev !== true) checkTimedEvents()
}

function passTimeNight() {
	Save("Auto", "Autosave at night of day " + Math.ceil(nTime / 288));
	var tm = nTime % 288;
	if (tm < 240) nTime += 242 - tm;
	var s = "";
	for (var i = 0, ie = arPeople.length; i < ie; i++) {
		var sp = arPeople[i].passTimeNight();
		if (!sp) s += sp
	}
	return s
}

function passTimeDay(hr) {
	Save("Auto", "Autosave at morning of day " + Math.ceil(nTime / 288));
	if (hr === undefined) hr = 0;
	var tm = nTime % 288;
	var mt = perYou.checkFlag(33) || hr == 7 ? 84 : perYou.checkFlag(34) || hr == 8 ? 96 : 72;
	if (tm < mt) nTime += mt - tm;
	else if (tm > 239) nTime += mt + (288 - tm);
	var s = "";
	var p;
	for (var i = 0, ie = arPeople.length; i < ie; i++) {
		p = arPeople[i];
		var sp = p.passTimeDay();
		if (!sp) s += sp;
		if (p.health > 0 && p.health < 100 && Math.floor(p.place) != 275) {
			p.health += 5;
			if (p.health >= 100) p.health = 99
		} else if (p.isVampyre())
			if (p.health < 0) {
				p.health +=
					20;
				if (p.health > -1) p.health = -1
			} else {
				p.health -= 20;
				if (p.health < 1) p.health = 1
			}
	}
	return s
}

function isDay() {
	var tm = nTime % 288;
	return tm > 71 && tm < 240
}

function isNight(late) {
	var tm = nTime % 288;
	if (late === true) return tm < 72;
	return tm < 72 || tm > 263
}

function isShopOpen(extc, exto, bWeekEnds, bNight) {
	if (extc === undefined) extc = 0;
	if (exto === undefined) exto = 0;
	if (bWeekEnds === undefined || bWeekEnds === false)
		if (Math.floor(nTime / 288) % 7 > 4) return false;
	var tm = nTime % 288;
	if (bNight === true) return tm >= 240 - exto * 12 || tm < 72 + extc * 12;
	return tm >= 96 - exto * 12 && tm < 216 + extc * 12
}

function WaitforForDayNight(st, plc, param) {
	var s;
	if (isDay()) s = passTimeNight();
	else s = passTimeDay();
	if (gameState.nRightBarState > 2) usePhone();
	if (s !== "") st = s;
	gotoPlace(plc, param, st)
}

function WaitHereOnly(no) {
	if (no === undefined) no = 1;
	if (no < 0) {
		nTime += (no + 1) * 2;
		passTime(false, true)
	} else
		for (var i = 0; i < no; i++) passTime(false, true);
	if (gameState.nRightBarState > 2) usePhone()
}

function WaitHere(no) {
	WaitHereOnly(no);
	dispPlace()
}

function addSleepLink(md, lnk, title, body, img, white, plc, params, txt, sty) {
	if (isDay()) return;
	if (!gameState.bSleepLink) {
		addTextForQuestions(md, "Then again, night is falling...");
		gameState.bSleepLink = true
	}
	if (sty === undefined) sty = "";
	else sty = ";" + sty;
	if (img !== undefined && img !== "") {
		if (isBritish()) img = img.split("Setting/").join("UK/");
		else img = img.split("Setting/").join("US/");
		sty += ";background-image:url(Images/" + img + ");background-size:100%;background-repeat:no-repeat;background-position:left bottom"
	}
	addPopupLinkC(md,
		lnk, title, body, true, "sleepForNight(" + (plc !== undefined && plc !== "" ? plc : "") + (txt !== undefined && txt !== "" ? ",'" + txt + "'" : params !== undefined && params !== "" ? "''," : "") + (params !== undefined && params !== "" ? "," + params : "") + ");", false, "top:10vh;left:5%;width:85%;height:80vh;padding:0" + (white === true ? ";background-color:white;color:black;text-shadow:-1px 0px white, 0px 1px white, 1px 0px white, 0px -1px white" : "") + sty)
}

function sleepForNight(plc, s, param) {
	var tm = nTime % 288;
	var mt = perYou.checkFlag(33) ? 84 : perYou.checkFlag(34) ? 96 : 72;
	var wt = 0;
	if (isDay()) {
		if (tm < 240) wt = 242 - tm
	} else if (tm < mt) wt = mt - tm;
	else if (tm > 239) wt = mt + (288 - tm);
	var p;
	for (var i = 0, ie = arPeople.length; i < ie; i++) {
		p = arPeople[i];
		if (p.showEventSleep(wt, plc, s, param)) return
	}
	WaitforForDayNight(s, plc, param)
}

function TimedEvent(evt, time) {
	this.timer = time;
	this.evnt = evt;
	this.checkEvent = function() {
		if (this.timer <= nTime) {
			try {
				eval(this.evnt)
			} catch (e) {
				console.log("Error in event: " + this.evnt);
				console.log(e)
			}
			return true
		}
		return false
	}
}

function startTimedEvent(evt, cnt, reset) {
	if (evt.length > 1295) alert("Game error: startTimedEvent event string is too long");
	if (reset === true) removeTimedEvent(evt);
	var ev = new TimedEvent(evt, nTime + cnt);
	vTimedEvent.push(ev)
}

function checkTimedEvents() {
	for (var i = 0, ie = vTimedEvent.length; i < ie; i++)
		if (vTimedEvent[i].checkEvent()) {
			vTimedEvent.splice(i, 1);
			break
		}
}

function removeTimedEvent(evt) {
	for (var i = 0, ie = vTimedEvent.length; i < ie; i++)
		if (vTimedEvent[i].evnt == evt) {
			vTimedEvent.splice(i, 1);
			break
		}
}

function setPersonFlagAfterTime(ps, flg, val, cnt) {
	startTimedEvent("setPF('" + ps + "'," + flg + (val === undefined ? "" : "," + val) + ")", cnt)
}

function setPlaceFlagAfterTime(ps, flg, val, cnt) {
	startTimedEvent("setPlaceFlag('" + ps + "'," + flg + (val === undefined ? "" : "," + val) + ")", cnt)
}

function initialiseTime() {
	nTime = 100;
	vTimedEvent = []
}
(function(root, factory) {
	if (typeof define === "function" && define.amd) define([], factory);
	else if (typeof exports === "object") module.exports = factory();
	else root.download = factory()
})(this, function() {
	return function download(data, strFileName, strMimeType) {
		var self = window,
			defaultMime = "application/octet-stream",
			mimeType = strMimeType || defaultMime,
			payload = data,
			url = !strFileName && !strMimeType && payload,
			anchor = document.createElement("a"),
			toString = function(a) {
				return String(a)
			},
			myBlob = self.Blob || self.MozBlob || self.WebKitBlob ||
			toString,
			fileName = strFileName || "download",
			blob, reader;
		myBlob = myBlob.call ? myBlob.bind(self) : Blob;
		if (String(this) === "true") {
			payload = [payload, mimeType];
			mimeType = payload[0];
			payload = payload[1]
		}
		if (url && url.length < 2048) {
			fileName = url.split("/").pop().split("?")[0];
			anchor.href = url;
			if (anchor.href.indexOf(url) !== -1) {
				var ajax = new XMLHttpRequest;
				ajax.open("GET", url, true);
				ajax.responseType = "blob";
				ajax.onload = function(e) {
					download(e.target.response, fileName, defaultMime)
				};
				setTimeout(function() {
					ajax.send()
				}, 0);
				return ajax
			}
		}
		if (/^data\:[\w+\-]+\/[\w+\-]+[,;]/.test(payload))
			if (payload.length >
				1024 * 1024 * 1.999 && myBlob !== toString) {
				payload = dataUrlToBlob(payload);
				mimeType = payload.type || defaultMime
			} else return navigator.msSaveBlob ? navigator.msSaveBlob(dataUrlToBlob(payload), fileName) : saver(payload);
		blob = payload instanceof myBlob ? payload : new myBlob([payload], {
			type: mimeType
		});

		function dataUrlToBlob(strUrl) {
			var parts = strUrl.split(/[:;,]/),
				type = parts[1],
				decoder = parts[2] == "base64" ? atob : decodeURIComponent,
				binData = decoder(parts.pop()),
				mx = binData.length,
				uiArr = new Uint8Array(mx);
			for (var i = 0; i < mx; ++i) uiArr[i] =
				binData.charCodeAt(i);
			return new myBlob([uiArr], {
				type: type
			})
		}

		function saver(url, winMode) {
			if ("download" in anchor) {
				anchor.href = url;
				anchor.setAttribute("download", fileName);
				anchor.className = "download-js-link";
				anchor.innerHTML = "downloading...";
				anchor.style.display = "none";
				document.body.appendChild(anchor);
				setTimeout(function() {
					anchor.click();
					document.body.removeChild(anchor);
					if (winMode === true) setTimeout(function() {
						self.URL.revokeObjectURL(anchor.href)
					}, 250)
				}, 66);
				return true
			}
			if (/(Version)\/(\d+)\.(\d+)(?:\.(\d+))?.*Safari\//.test(navigator.userAgent)) {
				url =
					url.replace(/^data:([\w\/\-\+]+)/, defaultMime);
				if (!window.open(url))
					if (confirm("Displaying New Document\n\nUse Save As... to download, then click back to return to this page.")) location.href = url;
				return true
			}
			var f = document.createElement("iframe");
			document.body.appendChild(f);
			if (!winMode) url = "data:" + url.replace(/^data:([\w\/\-\+]+)/, defaultMime);
			f.src = url;
			setTimeout(function() {
				document.body.removeChild(f)
			}, 333)
		}
		if (navigator.msSaveBlob) return navigator.msSaveBlob(blob, fileName);
		if (self.URL) saver(self.URL.createObjectURL(blob),
			true);
		else {
			if (typeof blob === "string" || blob.constructor === toString) try {
				return saver("data:" + mimeType + ";base64," + self.btoa(blob))
			} catch (y) {
				return saver("data:" + mimeType + "," + encodeURIComponent(blob))
			}
			reader = new FileReader;
			reader.onload = function(e) {
				saver(this.result)
			};
			reader.readAsDataURL(blob)
		}
		return true
	}
});
var loadingImage = "UI/loading.gif";
var closeButton = "UI/themes/theme1/delete.png";
var ldoc;

function getPageScroll() {
	var yScroll;
	if (ldoc.pageYOffset) yScroll = ldoc.pageYOffset;
	else if (ldoc.documentElement && ldoc.documentElement.scrollTop) yScroll = ldoc.documentElement.scrollTop;
	else if (ldoc.body) yScroll = ldoc.body.scrollTop;
	var arrayPageScroll = new Array("", yScroll);
	return arrayPageScroll
}

function getPageSize() {
	var xScroll, yScroll;
	if (window.innerHeight && window.scrollMaxY) {
		xScroll = ldoc.body.scrollWidth;
		yScroll = window.innerHeight + window.scrollMaxY
	} else if (ldoc.body.scrollHeight > ldoc.body.offsetHeight) {
		xScroll = ldoc.body.scrollWidth;
		yScroll = ldoc.body.scrollHeight
	} else {
		xScroll = ldoc.body.offsetWidth;
		yScroll = ldoc.body.offsetHeight
	}
	var windowWidth, windowHeight;
	if (ldoc.innerHeight) {
		windowWidth = ldoc.innerWidth;
		windowHeight = ldoc.innerHeight
	} else if (ldoc.documentElement && ldoc.documentElement.clientHeight) {
		windowWidth =
			ldoc.documentElement.clientWidth;
		windowHeight = ldoc.documentElement.clientHeight
	} else if (ldoc.body) {
		windowWidth = ldoc.body.clientWidth;
		windowHeight = ldoc.body.clientHeight
	}
	var pageHeight;
	var pageWidth;
	if (yScroll < windowHeight) pageHeight = windowHeight;
	else pageHeight = yScroll;
	if (xScroll < windowWidth) pageWidth = windowWidth;
	else pageWidth = xScroll;
	var arrayPageSize = new Array(pageWidth, pageHeight, windowWidth, windowHeight);
	return arrayPageSize
}

function pause(numberMillis) {
	var now = new Date;
	var exitTime = now.getTime() + numberMillis;
	while (true) {
		now = new Date;
		if (now.getTime() > exitTime) return
	}
}

function getKey(e) {
	var keycode;
	if (e === null) keycode = event.keyCode;
	else keycode = e.which;
	var key = String.fromCharCode(keycode).toLowerCase();
	if (key == "x") hideLightbox()
}

function listenKey() {
	ldoc.onkeypress = getKey
}

function showLightbox(objLink) {
	if (gameState.bLBNoShow) return;
	gameState.bSidebarsHiddenLB = gameState.bSidebarsHidden;
	if (!gameState.bSidebarsHidden) hideSidebars();
	var objOverlay = ldoc.getElementById("overlay");
	var objLightbox = ldoc.getElementById("lightbox");
	var objCaption = ldoc.getElementById("lightboxCaption");
	var objImage = ldoc.getElementById("lightboxImage");
	var objLoadingImage = ldoc.getElementById("loadingImage");
	var objLightboxDetails = ldoc.getElementById("lightboxDetails");
	var arrayPageSize = getPageSize();
	var arrayPageScroll = getPageScroll();
	if (objLoadingImage) {
		objLoadingImage.style.top = arrayPageScroll[1] + (arrayPageSize[3] - 35 - objLoadingImage.height) / 2 + "px";
		objLoadingImage.style.left = (arrayPageSize[0] - 20 - objLoadingImage.width) / 2 + "px";
		objLoadingImage.style.display = "block"
	}
	objOverlay.style.height = arrayPageSize[1] + "px";
	objOverlay.style.display = "block";
	var imgPreload = new Image;
	imgPreload.onload = function() {
		objImage.src = objLink.href;
		var lightboxTop = arrayPageScroll[1] + (arrayPageSize[3] - 35 - imgPreload.height) /
			2;
		var lightboxLeft = (arrayPageSize[0] - 20 - imgPreload.width) / 2;
		objLightbox.style.top = lightboxTop < 0 ? "0px" : lightboxTop + "px";
		objLightbox.style.left = lightboxLeft < 0 ? "0px" : lightboxLeft + "px";
		objLightboxDetails.style.width = imgPreload.width + "px";
		if (objLink.getAttribute("title")) {
			objCaption.style.display = "block";
			objCaption.innerHTML = objLink.getAttribute("title")
		} else objCaption.style.display = "none";
		if (navigator.appVersion.indexOf("MSIE") != -1) pause(250);
		if (objLoadingImage) objLoadingImage.style.display = "none";
		objLightbox.style.display =
			"block";
		arrayPageSize = getPageSize();
		objOverlay.style.height = (arrayPageSize[1] < imgPreload.height + 45 ? imgPreload.height + 45 : arrayPageSize[1]) + "px";
		listenKey();
		return false
	};
	imgPreload.src = objLink.href
}

function hideLightbox() {
	var objOverlay = ldoc.getElementById("overlay");
	var objLightbox = ldoc.getElementById("lightbox");
	objOverlay.style.display = "none";
	objLightbox.style.display = "none";
	ldoc.onkeypress = "";
	if (!gameState.bSidebarsHiddenLB) showSideBars(gameState.sPhoneState)
}

function initLightbox() {
	ldoc = document;
	if (!ldoc.getElementsByTagName) return;
	var anchors = ldoc.getElementsByTagName("a");
	for (var i = 0; i < anchors.length; i++) {
		var anchor = anchors[i];
		if (anchor.getAttribute("href") && anchor.getAttribute("rel") == "lightbox") anchor.onclick = function() {
			showLightbox(this);
			return false
		}
	}
	var objBody = ldoc.getElementsByTagName("body").item(0);
	var objOverlay = ldoc.createElement("div");
	objOverlay.setAttribute("id", "overlay");
	objOverlay.onclick = function() {
		hideLightbox();
		return false
	};
	objOverlay.style.display =
		"none";
	objOverlay.style.position = "absolute";
	objOverlay.style.top = "0";
	objOverlay.style.left = "0";
	objOverlay.style.zIndex = "90";
	objOverlay.style.width = "100%";
	objBody.insertBefore(objOverlay, objBody.firstChild);
	var imgPreloader = new Image;
	imgPreloader.onload = function() {
		var objLoadingImageLink = ldoc.createElement("a");
		objLoadingImageLink.setAttribute("href", "#");
		objLoadingImageLink.onclick = function() {
			hideLightbox();
			return false
		};
		objOverlay.appendChild(objLoadingImageLink);
		var objLoadingImage = ldoc.createElement("img");
		objLoadingImage.src = loadingImage;
		objLoadingImage.setAttribute("id", "loadingImage");
		objLoadingImage.style.position = "absolute";
		objLoadingImage.style.zIndex = "150";
		objLoadingImageLink.appendChild(objLoadingImage);
		imgPreloader.onload = function() {};
		return false
	};
	imgPreloader.src = loadingImage;
	var objLightbox = ldoc.createElement("div");
	objLightbox.setAttribute("id", "lightbox");
	objLightbox.style.display = "none";
	objLightbox.style.position = "absolute";
	objLightbox.style.zIndex = "100";
	objBody.insertBefore(objLightbox,
		objOverlay.nextSibling);
	var objLink = ldoc.createElement("a");
	objLink.setAttribute("href", "#");
	objLink.setAttribute("title", "Click to close");
	objLink.onclick = function() {
		hideLightbox();
		return false
	};
	objLightbox.appendChild(objLink);
	var imgPreloadCloseButton = new Image;
	imgPreloadCloseButton.onload = function() {
		var objCloseButton = ldoc.createElement("img");
		objCloseButton.src = closeButton;
		objCloseButton.setAttribute("id", "closeButton");
		objCloseButton.style.position = "absolute";
		objCloseButton.style.zIndex = "200";
		objLink.appendChild(objCloseButton);
		return false
	};
	imgPreloadCloseButton.src = closeButton;
	var objImage = ldoc.createElement("img");
	objImage.setAttribute("id", "lightboxImage");
	objLink.appendChild(objImage);
	var objLightboxDetails = ldoc.createElement("div");
	objLightboxDetails.setAttribute("id", "lightboxDetails");
	objLightbox.appendChild(objLightboxDetails);
	var objCaption = ldoc.createElement("div");
	objCaption.setAttribute("id", "lightboxCaption");
	objCaption.style.display = "none";
	objLightboxDetails.appendChild(objCaption);
	var objKeyboardMsg = ldoc.createElement("div");
	objKeyboardMsg.setAttribute("id", "keyboardMsg");
	objKeyboardMsg.innerHTML = "press <kbd>x</kbd> to close";
	objLightboxDetails.appendChild(objKeyboardMsg)
}
var LZString = function() {
	var f = String.fromCharCode;
	var keyStrBase64 = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";
	var keyStrUriSafe = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$";
	var baseReverseDic = {};

	function getBaseValue(alphabet, character) {
		if (!baseReverseDic[alphabet]) {
			baseReverseDic[alphabet] = {};
			for (var i = 0; i < alphabet.length; i++) baseReverseDic[alphabet][alphabet.charAt(i)] = i
		}
		return baseReverseDic[alphabet][character]
	}
	var LZString = {
		compressToBase64: function(input) {
			if (input ==
				null) return "";
			var res = LZString._compress(input, 6, function(a) {
				return keyStrBase64.charAt(a)
			});
			switch (res.length % 4) {
				default:
					case 0:
					return res;
				case 1:
						return res + "===";
				case 2:
						return res + "==";
				case 3:
						return res + "="
			}
		},
		decompressFromBase64: function(input) {
			if (input == null) return "";
			if (input == "") return null;
			return LZString._decompress(input.length, 32, function(index) {
				return getBaseValue(keyStrBase64, input.charAt(index))
			})
		},
		compressToUTF16: function(input) {
			if (input == null) return "";
			return LZString._compress(input,
				15,
				function(a) {
					return f(a + 32)
				}) + " "
		},
		decompressFromUTF16: function(compressed) {
			if (compressed == null) return "";
			if (compressed == "") return null;
			return LZString._decompress(compressed.length, 16384, function(index) {
				return compressed.charCodeAt(index) - 32
			})
		},
		compressToUint8Array: function(uncompressed) {
			var compressed = LZString.compress(uncompressed);
			var buf = new Uint8Array(compressed.length * 2);
			for (var i = 0, TotalLen = compressed.length; i < TotalLen; i++) {
				var current_value = compressed.charCodeAt(i);
				buf[i * 2] = current_value >>>
					8;
				buf[i * 2 + 1] = current_value % 256
			}
			return buf
		},
		decompressFromUint8Array: function(compressed) {
			if (compressed === null || compressed === undefined) return LZString.decompress(compressed);
			else {
				var buf = new Array(compressed.length / 2);
				for (var i = 0, TotalLen = buf.length; i < TotalLen; i++) buf[i] = compressed[i * 2] * 256 + compressed[i * 2 + 1];
				var result = [];
				buf.forEach(function(c) {
					result.push(f(c))
				});
				return LZString.decompress(result.join(""))
			}
		},
		compressToEncodedURIComponent: function(input) {
			if (input == null) return "";
			return LZString._compress(input,
				6,
				function(a) {
					return keyStrUriSafe.charAt(a)
				})
		},
		decompressFromEncodedURIComponent: function(input) {
			if (input == null) return "";
			if (input == "") return null;
			input = input.replace(/ /g, "+");
			return LZString._decompress(input.length, 32, function(index) {
				return getBaseValue(keyStrUriSafe, input.charAt(index))
			})
		},
		compress: function(uncompressed) {
			return LZString._compress(uncompressed, 16, function(a) {
				return f(a)
			})
		},
		_compress: function(uncompressed, bitsPerChar, getCharFromInt) {
			if (uncompressed == null) return "";
			var i, value, context_dictionary = {},
				context_dictionaryToCreate = {},
				context_c = "",
				context_wc = "",
				context_w = "",
				context_enlargeIn = 2,
				context_dictSize = 3,
				context_numBits = 2,
				context_data = [],
				context_data_val = 0,
				context_data_position = 0,
				ii;
			for (ii = 0; ii < uncompressed.length; ii += 1) {
				context_c = uncompressed.charAt(ii);
				if (!Object.prototype.hasOwnProperty.call(context_dictionary, context_c)) {
					context_dictionary[context_c] = context_dictSize++;
					context_dictionaryToCreate[context_c] = true
				}
				context_wc = context_w + context_c;
				if (Object.prototype.hasOwnProperty.call(context_dictionary,
						context_wc)) context_w = context_wc;
				else {
					if (Object.prototype.hasOwnProperty.call(context_dictionaryToCreate, context_w)) {
						if (context_w.charCodeAt(0) < 256) {
							for (i = 0; i < context_numBits; i++) {
								context_data_val = context_data_val << 1;
								if (context_data_position == bitsPerChar - 1) {
									context_data_position = 0;
									context_data.push(getCharFromInt(context_data_val));
									context_data_val = 0
								} else context_data_position++
							}
							value = context_w.charCodeAt(0);
							for (i = 0; i < 8; i++) {
								context_data_val = context_data_val << 1 | value & 1;
								if (context_data_position == bitsPerChar -
									1) {
									context_data_position = 0;
									context_data.push(getCharFromInt(context_data_val));
									context_data_val = 0
								} else context_data_position++;
								value = value >> 1
							}
						} else {
							value = 1;
							for (i = 0; i < context_numBits; i++) {
								context_data_val = context_data_val << 1 | value;
								if (context_data_position == bitsPerChar - 1) {
									context_data_position = 0;
									context_data.push(getCharFromInt(context_data_val));
									context_data_val = 0
								} else context_data_position++;
								value = 0
							}
							value = context_w.charCodeAt(0);
							for (i = 0; i < 16; i++) {
								context_data_val = context_data_val << 1 | value & 1;
								if (context_data_position ==
									bitsPerChar - 1) {
									context_data_position = 0;
									context_data.push(getCharFromInt(context_data_val));
									context_data_val = 0
								} else context_data_position++;
								value = value >> 1
							}
						}
						context_enlargeIn--;
						if (context_enlargeIn == 0) {
							context_enlargeIn = Math.pow(2, context_numBits);
							context_numBits++
						}
						delete context_dictionaryToCreate[context_w]
					} else {
						value = context_dictionary[context_w];
						for (i = 0; i < context_numBits; i++) {
							context_data_val = context_data_val << 1 | value & 1;
							if (context_data_position == bitsPerChar - 1) {
								context_data_position = 0;
								context_data.push(getCharFromInt(context_data_val));
								context_data_val = 0
							} else context_data_position++;
							value = value >> 1
						}
					}
					context_enlargeIn--;
					if (context_enlargeIn == 0) {
						context_enlargeIn = Math.pow(2, context_numBits);
						context_numBits++
					}
					context_dictionary[context_wc] = context_dictSize++;
					context_w = String(context_c)
				}
			}
			if (context_w !== "") {
				if (Object.prototype.hasOwnProperty.call(context_dictionaryToCreate, context_w)) {
					if (context_w.charCodeAt(0) < 256) {
						for (i = 0; i < context_numBits; i++) {
							context_data_val = context_data_val << 1;
							if (context_data_position == bitsPerChar - 1) {
								context_data_position =
									0;
								context_data.push(getCharFromInt(context_data_val));
								context_data_val = 0
							} else context_data_position++
						}
						value = context_w.charCodeAt(0);
						for (i = 0; i < 8; i++) {
							context_data_val = context_data_val << 1 | value & 1;
							if (context_data_position == bitsPerChar - 1) {
								context_data_position = 0;
								context_data.push(getCharFromInt(context_data_val));
								context_data_val = 0
							} else context_data_position++;
							value = value >> 1
						}
					} else {
						value = 1;
						for (i = 0; i < context_numBits; i++) {
							context_data_val = context_data_val << 1 | value;
							if (context_data_position == bitsPerChar - 1) {
								context_data_position =
									0;
								context_data.push(getCharFromInt(context_data_val));
								context_data_val = 0
							} else context_data_position++;
							value = 0
						}
						value = context_w.charCodeAt(0);
						for (i = 0; i < 16; i++) {
							context_data_val = context_data_val << 1 | value & 1;
							if (context_data_position == bitsPerChar - 1) {
								context_data_position = 0;
								context_data.push(getCharFromInt(context_data_val));
								context_data_val = 0
							} else context_data_position++;
							value = value >> 1
						}
					}
					context_enlargeIn--;
					if (context_enlargeIn == 0) {
						context_enlargeIn = Math.pow(2, context_numBits);
						context_numBits++
					}
					delete context_dictionaryToCreate[context_w]
				} else {
					value =
						context_dictionary[context_w];
					for (i = 0; i < context_numBits; i++) {
						context_data_val = context_data_val << 1 | value & 1;
						if (context_data_position == bitsPerChar - 1) {
							context_data_position = 0;
							context_data.push(getCharFromInt(context_data_val));
							context_data_val = 0
						} else context_data_position++;
						value = value >> 1
					}
				}
				context_enlargeIn--;
				if (context_enlargeIn == 0) {
					context_enlargeIn = Math.pow(2, context_numBits);
					context_numBits++
				}
			}
			value = 2;
			for (i = 0; i < context_numBits; i++) {
				context_data_val = context_data_val << 1 | value & 1;
				if (context_data_position ==
					bitsPerChar - 1) {
					context_data_position = 0;
					context_data.push(getCharFromInt(context_data_val));
					context_data_val = 0
				} else context_data_position++;
				value = value >> 1
			}
			while (true) {
				context_data_val = context_data_val << 1;
				if (context_data_position == bitsPerChar - 1) {
					context_data.push(getCharFromInt(context_data_val));
					break
				} else context_data_position++
			}
			return context_data.join("")
		},
		decompress: function(compressed) {
			if (compressed == null) return "";
			if (compressed == "") return null;
			return LZString._decompress(compressed.length, 32768,
				function(index) {
					return compressed.charCodeAt(index)
				})
		},
		_decompress: function(length, resetValue, getNextValue) {
			var dictionary = [],
				next, enlargeIn = 4,
				dictSize = 4,
				numBits = 3,
				entry = "",
				result = [],
				i, w, bits, resb, maxpower, power, c, data = {
					val: getNextValue(0),
					position: resetValue,
					index: 1
				};
			for (i = 0; i < 3; i += 1) dictionary[i] = i;
			bits = 0;
			maxpower = Math.pow(2, 2);
			power = 1;
			while (power != maxpower) {
				resb = data.val & data.position;
				data.position >>= 1;
				if (data.position == 0) {
					data.position = resetValue;
					data.val = getNextValue(data.index++)
				}
				bits |= (resb >
					0 ? 1 : 0) * power;
				power <<= 1
			}
			switch (next = bits) {
				case 0:
					bits = 0;
					maxpower = Math.pow(2, 8);
					power = 1;
					while (power != maxpower) {
						resb = data.val & data.position;
						data.position >>= 1;
						if (data.position == 0) {
							data.position = resetValue;
							data.val = getNextValue(data.index++)
						}
						bits |= (resb > 0 ? 1 : 0) * power;
						power <<= 1
					}
					c = f(bits);
					break;
				case 1:
					bits = 0;
					maxpower = Math.pow(2, 16);
					power = 1;
					while (power != maxpower) {
						resb = data.val & data.position;
						data.position >>= 1;
						if (data.position == 0) {
							data.position = resetValue;
							data.val = getNextValue(data.index++)
						}
						bits |= (resb > 0 ? 1 :
							0) * power;
						power <<= 1
					}
					c = f(bits);
					break;
				case 2:
					return ""
			}
			dictionary[3] = c;
			w = c;
			result.push(c);
			while (true) {
				if (data.index > length) return "";
				bits = 0;
				maxpower = Math.pow(2, numBits);
				power = 1;
				while (power != maxpower) {
					resb = data.val & data.position;
					data.position >>= 1;
					if (data.position == 0) {
						data.position = resetValue;
						data.val = getNextValue(data.index++)
					}
					bits |= (resb > 0 ? 1 : 0) * power;
					power <<= 1
				}
				switch (c = bits) {
					case 0:
						bits = 0;
						maxpower = Math.pow(2, 8);
						power = 1;
						while (power != maxpower) {
							resb = data.val & data.position;
							data.position >>= 1;
							if (data.position ==
								0) {
								data.position = resetValue;
								data.val = getNextValue(data.index++)
							}
							bits |= (resb > 0 ? 1 : 0) * power;
							power <<= 1
						}
						dictionary[dictSize++] = f(bits);
						c = dictSize - 1;
						enlargeIn--;
						break;
					case 1:
						bits = 0;
						maxpower = Math.pow(2, 16);
						power = 1;
						while (power != maxpower) {
							resb = data.val & data.position;
							data.position >>= 1;
							if (data.position == 0) {
								data.position = resetValue;
								data.val = getNextValue(data.index++)
							}
							bits |= (resb > 0 ? 1 : 0) * power;
							power <<= 1
						}
						dictionary[dictSize++] = f(bits);
						c = dictSize - 1;
						enlargeIn--;
						break;
					case 2:
						return result.join("")
				}
				if (enlargeIn == 0) {
					enlargeIn =
						Math.pow(2, numBits);
					numBits++
				}
				if (dictionary[c]) entry = dictionary[c];
				else if (c === dictSize) entry = w + w.charAt(0);
				else return null;
				result.push(entry);
				dictionary[dictSize++] = w + entry.charAt(0);
				enlargeIn--;
				w = entry;
				if (enlargeIn == 0) {
					enlargeIn = Math.pow(2, numBits);
					numBits++
				}
			}
		}
	};
	return LZString
}();
if (typeof define === "function" && define.amd) define(function() {
	return LZString
});
else if (typeof module !== "undefined" && module != null) module.exports = LZString;
else if (typeof angular !== "undefined" && angular != null) angular.module("LZString", []).factory("LZString", function() {
	return LZString
});
var Pacman = {};
Pacman.FPS = 30;
Pacman.sound = true;
Pacman.NONE = 4;
Pacman.UP = 3;
Pacman.LEFT = 2;
Pacman.DOWN = 1;
Pacman.RIGHT = 11;
Pacman.WAITING = 5;
Pacman.PAUSE = 6;
Pacman.PLAYING = 7;
Pacman.COUNTDOWN = 8;
Pacman.EATEN_PAUSE = 9;
Pacman.DYING = 10;
Pacman.Ghost = function(game, map, colour) {
	var position = null,
		direction = null,
		eatable = null,
		eaten = null,
		due = null;

	function getNewCoord(dir, current) {
		var speed = isVunerable() ? 1 : isHidden() ? 4 : 2,
			xSpeed = dir === Pacman.LEFT && -speed || dir === Pacman.RIGHT && speed || 0,
			ySpeed = dir === Pacman.DOWN && speed || dir === Pacman.UP && -speed || 0;
		return {
			"x": addBounded(current.x, xSpeed),
			"y": addBounded(current.y, ySpeed)
		}
	}

	function addBounded(x1, x2) {
		var rem = x1 % 10,
			result = rem + x2;
		if (rem !== 0 && result > 10) return x1 + (10 - rem);
		else if (rem > 0 && result < 0) return x1 -
			rem;
		return x1 + x2
	}

	function isVunerable() {
		return eatable !== null
	}

	function isDangerous() {
		return eaten === null
	}

	function isHidden() {
		return eatable === null && eaten !== null
	}

	function getRandomDirection() {
		var moves = direction === Pacman.LEFT || direction === Pacman.RIGHT ? [Pacman.UP, Pacman.DOWN] : [Pacman.LEFT, Pacman.RIGHT];
		return moves[Math.floor(Math.random() * 2)]
	}

	function reset() {
		eaten = null;
		eatable = null;
		position = {
			"x": 90,
			"y": 80
		};
		direction = getRandomDirection();
		due = getRandomDirection()
	}

	function onWholeSquare(x) {
		return x %
			10 === 0
	}

	function oppositeDirection(dir) {
		return dir === Pacman.LEFT && Pacman.RIGHT || dir === Pacman.RIGHT && Pacman.LEFT || dir === Pacman.UP && Pacman.DOWN || Pacman.UP
	}

	function makeEatable() {
		direction = oppositeDirection(direction);
		eatable = game.getTick()
	}

	function eat() {
		eatable = null;
		eaten = game.getTick()
	}

	function pointToCoord(x) {
		return Math.round(x / 10)
	}

	function nextSquare(x, dir) {
		var rem = x % 10;
		if (rem === 0) return x;
		else if (dir === Pacman.RIGHT || dir === Pacman.DOWN) return x + (10 - rem);
		else return x - rem
	}

	function onGridSquare(pos) {
		return onWholeSquare(pos.y) &&
			onWholeSquare(pos.x)
	}

	function secondsAgo(tick) {
		return (game.getTick() - tick) / Pacman.FPS
	}

	function getColour() {
		if (eatable)
			if (secondsAgo(eatable) > 5) return game.getTick() % 20 > 10 ? "#FFFFFF" : "#0000BB";
			else return "#0000BB";
		else if (eaten) return "#222";
		return colour
	}

	function draw(ctx) {
		var s = map.blockSize,
			top = position.y / 10 * s,
			left = position.x / 10 * s;
		if (eatable && secondsAgo(eatable) > 8) eatable = null;
		if (eaten && secondsAgo(eaten) > 3) eaten = null;
		var tl = left + s;
		var base = top + s - 3;
		var inc = s / 10;
		var high = game.getTick() % 10 > 5 ? 3 : -3;
		var low =
			game.getTick() % 10 > 5 ? -3 : 3;
		ctx.fillStyle = getColour();
		ctx.beginPath();
		ctx.moveTo(left, base);
		ctx.quadraticCurveTo(left, top, left + s / 2, top);
		ctx.quadraticCurveTo(left + s, top, left + s, base);
		ctx.quadraticCurveTo(tl - inc * 1, base + high, tl - inc * 2, base);
		ctx.quadraticCurveTo(tl - inc * 3, base + low, tl - inc * 4, base);
		ctx.quadraticCurveTo(tl - inc * 5, base + high, tl - inc * 6, base);
		ctx.quadraticCurveTo(tl - inc * 7, base + low, tl - inc * 8, base);
		ctx.quadraticCurveTo(tl - inc * 9, base + high, tl - inc * 10, base);
		ctx.closePath();
		ctx.fill();
		ctx.beginPath();
		ctx.fillStyle =
			"#FFF";
		ctx.arc(left + 6, top + 6, s / 6, 0, 300, false);
		ctx.arc(left + s - 6, top + 6, s / 6, 0, 300, false);
		ctx.closePath();
		ctx.fill();
		var f = s / 12;
		var off = {};
		off[Pacman.RIGHT] = [f, 0];
		off[Pacman.LEFT] = [-f, 0];
		off[Pacman.UP] = [0, -f];
		off[Pacman.DOWN] = [0, f];
		ctx.beginPath();
		ctx.fillStyle = "#000";
		ctx.arc(left + 6 + off[direction][0], top + 6 + off[direction][1], s / 15, 0, 300, false);
		ctx.arc(left + s - 6 + off[direction][0], top + 6 + off[direction][1], s / 15, 0, 300, false);
		ctx.closePath();
		ctx.fill()
	}

	function pane(pos) {
		if (pos.y === 100 && pos.x >= 190 && direction ===
			Pacman.RIGHT) return {
			"y": 100,
			"x": -10
		};
		if (pos.y === 100 && pos.x <= -10 && direction === Pacman.LEFT) return position = {
			"y": 100,
			"x": 190
		};
		return false
	}

	function move(ctx) {
		var oldPos = position,
			onGrid = onGridSquare(position),
			npos = null;
		if (due !== direction) {
			npos = getNewCoord(due, position);
			if (onGrid && map.isFloorSpace({
					"y": pointToCoord(nextSquare(npos.y, due)),
					"x": pointToCoord(nextSquare(npos.x, due))
				})) direction = due;
			else npos = null
		}
		if (npos === null) npos = getNewCoord(direction, position);
		if (onGrid && map.isWallSpace({
				"y": pointToCoord(nextSquare(npos.y,
					direction)),
				"x": pointToCoord(nextSquare(npos.x, direction))
			})) {
			due = getRandomDirection();
			return move(ctx)
		}
		position = npos;
		var tmp = pane(position);
		if (tmp) position = tmp;
		due = getRandomDirection();
		return {
			"new": position,
			"old": oldPos
		}
	}
	return {
		"eat": eat,
		"isVunerable": isVunerable,
		"isDangerous": isDangerous,
		"makeEatable": makeEatable,
		"reset": reset,
		"move": move,
		"draw": draw
	}
};
Pacman.User = function(game, map) {
	var position = null,
		direction = null,
		eaten = null,
		due = null,
		lives = null,
		score = 5,
		keyMap = {};
	keyMap[KEY.ARROW_LEFT] = Pacman.LEFT;
	keyMap[KEY.ARROW_UP] = Pacman.UP;
	keyMap[KEY.ARROW_RIGHT] = Pacman.RIGHT;
	keyMap[KEY.ARROW_DOWN] = Pacman.DOWN;

	function addScore(nScore) {
		score += nScore;
		if (score >= 1E4 && score - nScore < 1E4) lives += 1
	}

	function theScore() {
		return score
	}

	function loseLife() {
		lives -= 1
	}

	function getLives() {
		return lives
	}

	function initUser() {
		score = 0;
		lives = 3;
		newLevel()
	}

	function newLevel() {
		resetPosition();
		eaten = 0
	}

	function resetPosition() {
		position = {
			"x": 90,
			"y": 120
		};
		direction = Pacman.LEFT;
		due = Pacman.LEFT
	}

	function reset() {
		initUser();
		resetPosition()
	}

	function keyDown(e) {
		if (typeof keyMap[e.keyCode] !== "undefined") {
			due = keyMap[e.keyCode];
			e.preventDefault();
			e.stopPropagation();
			return false
		}
		return true
	}

	function getNewCoord(dir, current) {
		return {
			"x": current.x + (dir === Pacman.LEFT && -2 || dir === Pacman.RIGHT && 2 || 0),
			"y": current.y + (dir === Pacman.DOWN && 2 || dir === Pacman.UP && -2 || 0)
		}
	}

	function onWholeSquare(x) {
		return x % 10 === 0
	}

	function pointToCoord(x) {
		return Math.round(x /
			10)
	}

	function nextSquare(x, dir) {
		var rem = x % 10;
		if (rem === 0) return x;
		else if (dir === Pacman.RIGHT || dir === Pacman.DOWN) return x + (10 - rem);
		else return x - rem
	}

	function next(pos, dir) {
		return {
			"y": pointToCoord(nextSquare(pos.y, dir)),
			"x": pointToCoord(nextSquare(pos.x, dir))
		}
	}

	function onGridSquare(pos) {
		return onWholeSquare(pos.y) && onWholeSquare(pos.x)
	}

	function isOnSamePlane(due, dir) {
		return (due === Pacman.LEFT || due === Pacman.RIGHT) && (dir === Pacman.LEFT || dir === Pacman.RIGHT) || (due === Pacman.UP || due === Pacman.DOWN) && (dir === Pacman.UP ||
			dir === Pacman.DOWN)
	}

	function move(ctx) {
		var npos = null,
			nextWhole = null,
			oldPosition = position,
			block = null;
		if (due !== direction) {
			npos = getNewCoord(due, position);
			if (isOnSamePlane(due, direction) || onGridSquare(position) && map.isFloorSpace(next(npos, due))) direction = due;
			else npos = null
		}
		if (npos === null) npos = getNewCoord(direction, position);
		if (onGridSquare(position) && map.isWallSpace(next(npos, direction))) direction = Pacman.NONE;
		if (direction === Pacman.NONE) return {
			"new": position,
			"old": position
		};
		if (npos.y === 100 && npos.x >= 190 &&
			direction === Pacman.RIGHT) npos = {
			"y": 100,
			"x": -10
		};
		if (npos.y === 100 && npos.x <= -12 && direction === Pacman.LEFT) npos = {
			"y": 100,
			"x": 190
		};
		position = npos;
		nextWhole = next(position, direction);
		block = map.block(nextWhole);
		if ((isMidSquare(position.y) || isMidSquare(position.x)) && block === Pacman.BISCUIT || block === Pacman.PILL) {
			map.setBlock(nextWhole, Pacman.EMPTY);
			addScore(block === Pacman.BISCUIT ? 10 : 50);
			eaten += 1;
			if (eaten === 182) game.completedLevel();
			if (block === Pacman.PILL) game.eatenPill()
		}
		return {
			"new": position,
			"old": oldPosition
		}
	}

	function isMidSquare(x) {
		var rem = x % 10;
		return rem > 3 || rem < 7
	}

	function calcAngle(dir, pos) {
		if (dir == Pacman.RIGHT && pos.x % 10 < 5) return {
			"start": .25,
			"end": 1.75,
			"direction": false
		};
		else if (dir === Pacman.DOWN && pos.y % 10 < 5) return {
			"start": .75,
			"end": 2.25,
			"direction": false
		};
		else if (dir === Pacman.UP && pos.y % 10 < 5) return {
			"start": 1.25,
			"end": 1.75,
			"direction": true
		};
		else if (dir === Pacman.LEFT && pos.x % 10 < 5) return {
			"start": .75,
			"end": 1.25,
			"direction": true
		};
		return {
			"start": 0,
			"end": 2,
			"direction": false
		}
	}

	function drawDead(ctx, amount) {
		var size =
			map.blockSize,
			half = size / 2;
		if (amount >= 1) return;
		ctx.fillStyle = "#FFFF00";
		ctx.beginPath();
		ctx.moveTo(position.x / 10 * size + half, position.y / 10 * size + half);
		ctx.arc(position.x / 10 * size + half, position.y / 10 * size + half, half, 0, Math.PI * 2 * amount, true);
		ctx.fill()
	}

	function draw(ctx) {
		var s = map.blockSize,
			angle = calcAngle(direction, position);
		ctx.fillStyle = "#FFFF00";
		ctx.beginPath();
		ctx.moveTo(position.x / 10 * s + s / 2, position.y / 10 * s + s / 2);
		ctx.arc(position.x / 10 * s + s / 2, position.y / 10 * s + s / 2, s / 2, Math.PI * angle.start, Math.PI * angle.end, angle.direction);
		ctx.fill()
	}
	initUser();
	return {
		"draw": draw,
		"drawDead": drawDead,
		"loseLife": loseLife,
		"getLives": getLives,
		"score": score,
		"addScore": addScore,
		"theScore": theScore,
		"keyDown": keyDown,
		"move": move,
		"newLevel": newLevel,
		"reset": reset,
		"resetPosition": resetPosition
	}
};
Pacman.Map = function(size) {
	var height = null,
		width = null,
		blockSize = size,
		pillSize = 0,
		map = null;

	function withinBounds(y, x) {
		return y >= 0 && y < height && x >= 0 && x < width
	}

	function isWall(pos) {
		return withinBounds(pos.y, pos.x) && map[pos.y][pos.x] === Pacman.WALL
	}

	function isFloorSpace(pos) {
		if (!withinBounds(pos.y, pos.x)) return false;
		var peice = map[pos.y][pos.x];
		return peice === Pacman.EMPTY || peice === Pacman.BISCUIT || peice === Pacman.PILL
	}

	function drawWall(ctx) {
		var i, j, p, line;
		ctx.strokeStyle = "#0000FF";
		ctx.lineWidth = 5;
		ctx.lineCap =
			"round";
		for (i = 0; i < Pacman.WALLS.length; i += 1) {
			line = Pacman.WALLS[i];
			ctx.beginPath();
			for (j = 0; j < line.length; j += 1) {
				p = line[j];
				if (p.move) ctx.moveTo(p.move[0] * blockSize, p.move[1] * blockSize);
				else if (p.line) ctx.lineTo(p.line[0] * blockSize, p.line[1] * blockSize);
				else if (p.curve) ctx.quadraticCurveTo(p.curve[0] * blockSize, p.curve[1] * blockSize, p.curve[2] * blockSize, p.curve[3] * blockSize)
			}
			ctx.stroke()
		}
	}

	function reset() {
		map = Pacman.MAP.clone();
		height = map.length;
		width = map[0].length
	}

	function block(pos) {
		return map[pos.y][pos.x]
	}

	function setBlock(pos, type) {
		map[pos.y][pos.x] = type
	}

	function drawPills(ctx) {
		if (++pillSize > 30) pillSize = 0;
		for (i = 0; i < height; i += 1)
			for (j = 0; j < width; j += 1)
				if (map[i][j] === Pacman.PILL) {
					ctx.beginPath();
					ctx.fillStyle = "#000";
					ctx.fillRect(j * blockSize, i * blockSize, blockSize, blockSize);
					ctx.fillStyle = "#FFF";
					ctx.arc(j * blockSize + blockSize / 2, i * blockSize + blockSize / 2, Math.abs(5 - pillSize / 3), 0, Math.PI * 2, false);
					ctx.fill();
					ctx.closePath()
				}
	}

	function draw(ctx) {
		var i, j, size = blockSize;
		ctx.fillStyle = "#000";
		ctx.fillRect(0, 0, width *
			size, height * size);
		drawWall(ctx);
		for (i = 0; i < height; i += 1)
			for (j = 0; j < width; j += 1) drawBlock(i, j, ctx)
	}

	function drawBlock(y, x, ctx) {
		var layout = map[y][x];
		if (layout === Pacman.PILL) return;
		ctx.beginPath();
		if (layout === Pacman.EMPTY || layout === Pacman.BLOCK || layout === Pacman.BISCUIT) {
			ctx.fillStyle = "#000";
			ctx.fillRect(x * blockSize, y * blockSize, blockSize, blockSize);
			if (layout === Pacman.BISCUIT) {
				ctx.fillStyle = "#FFF";
				ctx.fillRect(x * blockSize + blockSize / 2.5, y * blockSize + blockSize / 2.5, blockSize / 6, blockSize / 6)
			}
		}
		ctx.closePath()
	}
	reset();
	return {
		"draw": draw,
		"drawBlock": drawBlock,
		"drawPills": drawPills,
		"block": block,
		"setBlock": setBlock,
		"reset": reset,
		"isWallSpace": isWall,
		"isFloorSpace": isFloorSpace,
		"height": height,
		"width": width,
		"blockSize": blockSize
	}
};
Pacman.Audio = function(game) {
	var files = [],
		endEvents = [],
		progressEvents = [],
		playing = [];

	function load(name, path, cb) {
		var f = files[name] = document.createElement("audio");
		progressEvents[name] = function(event) {
			progress(event, name, cb)
		};
		f.addEventListener("canplaythrough", progressEvents[name], true);
		f.setAttribute("preload", "true");
		f.setAttribute("autobuffer", "true");
		f.setAttribute("src", path);
		f.pause()
	}

	function progress(event, name, callback) {
		if (event.loaded === event.total && typeof callback === "function") {
			callback();
			files[name].removeEventListener("canplaythrough", progressEvents[name], true)
		}
	}

	function disableSound() {
		for (var i = 0; i < playing.length; i++) {
			files[playing[i]].pause();
			files[playing[i]].currentTime = 0
		}
		playing = []
	}

	function ended(name) {
		var i, tmp = [],
			found = false;
		files[name].removeEventListener("ended", endEvents[name], true);
		for (i = 0; i < playing.length; i++)
			if (!found && playing[i]) found = true;
			else tmp.push(playing[i]);
		playing = tmp
	}

	function play(name) {
		if (!game.soundDisabled()) {
			endEvents[name] = function() {
				ended(name)
			};
			playing.push(name);
			files[name].addEventListener("ended", endEvents[name], true);
			files[name].play()
		}
	}

	function pause() {
		for (var i = 0; i < playing.length; i++) files[playing[i]].pause()
	}

	function resume() {
		for (var i = 0; i < playing.length; i++) files[playing[i]].play()
	}
	return {
		"disableSound": disableSound,
		"load": load,
		"play": play,
		"pause": pause,
		"resume": resume
	}
};
var PACMAN = function() {
	var state = Pacman.WAITING,
		audio = null,
		ghosts = [],
		ghostSpecs = ["#00FFDE", "#FF0000", "#FFB8DE", "#FFB847"],
		eatenCount = 0,
		level = 0,
		tick = 0,
		ghostPos, userPos, stateChanged = true,
		timerStart = null,
		lastTime = 0,
		ctx = null,
		timer = null,
		map = null,
		user = null,
		stored = null;

	function getTick() {
		return tick
	}

	function drawScore(text, position) {
		ctx.fillStyle = "#FFFFFF";
		ctx.font = "12px BDCartoonShoutRegular";
		ctx.fillText(text, position["new"]["x"] / 10 * map.blockSize, (position["new"]["y"] + 5) / 10 * map.blockSize)
	}

	function dialog(text) {
		ctx.fillStyle =
			"#FFFF00";
		ctx.font = "14px BDCartoonShoutRegular";
		var width = ctx.measureText(text).width,
			x = (map.width * map.blockSize - width) / 2;
		ctx.fillText(text, x, map.height * 10 + 8)
	}

	function soundDisabled() {
		return Pacman.sound
	}

	function startLevel() {
		user.resetPosition();
		for (var i = 0; i < ghosts.length; i += 1) ghosts[i].reset();
		audio.play("start");
		timerStart = tick;
		setState(Pacman.COUNTDOWN)
	}

	function startNewGame() {
		setState(Pacman.WAITING);
		level = 1;
		user.reset();
		map.reset();
		map.draw(ctx);
		startLevel()
	}

	function keyDown(e) {
		if (e.keyCode ===
			KEY.N) startNewGame();
		else if (e.keyCode === KEY.S) {
			audio.disableSound();
			Pacman.sound = !Pacman.sound
		} else if (e.keyCode === KEY.P && state === Pacman.PAUSE) {
			audio.resume();
			map.draw(ctx);
			setState(stored)
		} else if (e.keyCode === KEY.P) {
			stored = state;
			setState(Pacman.PAUSE);
			audio.pause();
			map.draw(ctx);
			dialog("Paused")
		} else if (state !== Pacman.PAUSE) return user.keyDown(e);
		return true
	}

	function loseLife() {
		setState(Pacman.WAITING);
		user.loseLife();
		if (user.getLives() > 0) startLevel()
	}

	function setState(nState) {
		state = nState;
		stateChanged =
			true
	}

	function collided(user, ghost) {
		return Math.sqrt(Math.pow(ghost.x - user.x, 2) + Math.pow(ghost.y - user.y, 2)) < 10
	}

	function drawFooter() {
		var topLeft = map.height * map.blockSize,
			textBase = topLeft + 17;
		ctx.fillStyle = "#000000";
		ctx.fillRect(0, topLeft, map.width * map.blockSize, 30);
		ctx.fillStyle = "#FFFF00";
		for (var i = 0, len = user.getLives(); i < len; i++) {
			ctx.fillStyle = "#FFFF00";
			ctx.beginPath();
			ctx.moveTo(140 + 25 * i + map.blockSize / 2, topLeft + 1 + map.blockSize / 2);
			ctx.arc(140 + 25 * i + map.blockSize / 2, topLeft + 1 + map.blockSize / 2, map.blockSize /
				2, Math.PI * .25, Math.PI * 1.75, false);
			ctx.fill()
		}
		ctx.fillStyle = !soundDisabled() ? "#00FF00" : "#FF0000";
		ctx.font = "bold 16px sans-serif";
		ctx.fillText("s", 10, textBase);
		ctx.fillStyle = "#FFFF00";
		ctx.font = "14px BDCartoonShoutRegular";
		ctx.fillText("Score: " + user.theScore(), 30, textBase);
		ctx.fillText("Level: " + level, 245, textBase)
	}

	function redrawBlock(pos) {
		map.drawBlock(Math.floor(pos.y / 10), Math.floor(pos.x / 10), ctx);
		map.drawBlock(Math.ceil(pos.y / 10), Math.ceil(pos.x / 10), ctx)
	}

	function mainDraw() {
		var diff, u, i, len, nScore;
		ghostPos = [];
		for (i = 0, len = ghosts.length; i < len; i += 1) ghostPos.push(ghosts[i].move(ctx));
		u = user.move(ctx);
		for (i = 0, len = ghosts.length; i < len; i += 1) redrawBlock(ghostPos[i].old);
		redrawBlock(u.old);
		for (i = 0, len = ghosts.length; i < len; i += 1) ghosts[i].draw(ctx);
		user.draw(ctx);
		userPos = u["new"];
		for (i = 0, len = ghosts.length; i < len; i += 1)
			if (collided(userPos, ghostPos[i]["new"]))
				if (ghosts[i].isVunerable()) {
					audio.play("eatghost");
					ghosts[i].eat();
					eatenCount += 1;
					nScore = eatenCount * 50;
					drawScore(nScore, ghostPos[i]);
					user.addScore(nScore);
					setState(Pacman.EATEN_PAUSE);
					timerStart = tick
				} else if (ghosts[i].isDangerous()) {
			audio.play("die");
			setState(Pacman.DYING);
			timerStart = tick
		}
	}

	function mainLoop() {
		var diff;
		if (state !== Pacman.PAUSE) ++tick;
		map.drawPills(ctx);
		if (state === Pacman.PLAYING) mainDraw();
		else if (state === Pacman.WAITING && stateChanged) {
			stateChanged = false;
			map.draw(ctx);
			dialog("Press N to start a New game")
		} else if (state === Pacman.EATEN_PAUSE && tick - timerStart > Pacman.FPS / 3) {
			map.draw(ctx);
			setState(Pacman.PLAYING)
		} else if (state === Pacman.DYING)
			if (tick -
				timerStart > Pacman.FPS * 2) loseLife();
			else {
				redrawBlock(userPos);
				for (i = 0, len = ghosts.length; i < len; i += 1) {
					redrawBlock(ghostPos[i].old);
					ghostPos.push(ghosts[i].draw(ctx))
				}
				user.drawDead(ctx, (tick - timerStart) / (Pacman.FPS * 2))
			}
		else if (state === Pacman.COUNTDOWN) {
			diff = 5 + Math.floor((timerStart - tick) / Pacman.FPS);
			if (diff === 0) {
				map.draw(ctx);
				setState(Pacman.PLAYING)
			} else if (diff !== lastTime) {
				lastTime = diff;
				map.draw(ctx);
				dialog("Starting in: " + diff)
			}
		}
		drawFooter()
	}

	function eatenPill() {
		audio.play("eatpill");
		timerStart = tick;
		eatenCount = 0;
		for (i = 0; i < ghosts.length; i += 1) ghosts[i].makeEatable(ctx)
	}

	function completedLevel() {
		setState(Pacman.WAITING);
		level += 1;
		map.reset();
		user.newLevel();
		startLevel()
	}

	function keyPress(e) {
		if (state !== Pacman.WAITING && state !== Pacman.PAUSE) {
			e.preventDefault();
			e.stopPropagation()
		}
	}

	function init(wrapper) {
		state = Pacman.WAITING;
		ghosts = [];
		eatenCount = 0;
		level = 0;
		tick = 0;
		stateChanged = true;
		timerStart = null;
		lastTime = 0;
		timer = null;
		stored = null;
		var i, len, ghost;
		var blockSize = wrapper.offsetWidth / 19;
		var canvas = document.createElement("canvas");
		canvas.setAttribute("width", blockSize * 19 + "px");
		canvas.setAttribute("height", blockSize * 22 + 30 + "px");
		wrapper.appendChild(canvas);
		ctx = canvas.getContext("2d");
		audio = new Pacman.Audio({
			"soundDisabled": soundDisabled
		});
		map = new Pacman.Map(blockSize);
		user = new Pacman.User({
			"completedLevel": completedLevel,
			"eatenPill": eatenPill
		}, map);
		for (i = 0, len = ghostSpecs.length; i < len; i += 1) {
			ghost = new Pacman.Ghost({
				"getTick": getTick
			}, map, ghostSpecs[i]);
			ghosts.push(ghost)
		}
		map.draw(ctx);
		dialog("Loading ...");
		var audio_files = [
			["start",
				"Sound/opening_song.mp3"
			],
			["die", "Sound/die.mp3"],
			["eatghost", "Sound/eatghost.mp3"],
			["eatpill", "Sound/eatpill.mp3"],
			["eating", "Sound/eating.short.mp3"],
			["eating2", "Sound/eating.short.mp3"]
		];
		load(audio_files, function() {
			loaded()
		})
	}

	function load(arr, callback) {
		if (arr.length === 0) callback();
		else {
			var x = arr.pop();
			audio.load(x[0], x[1], function() {
				load(arr, callback)
			})
		}
	}

	function loaded() {
		dialog("Press N to Start");
		document.addEventListener("keydown", keyDown, true);
		document.addEventListener("keypress", keyPress,
			true);
		timer = window.setInterval(mainLoop, 1E3 / Pacman.FPS)
	}

	function finishGame() {
		window.clearInterval(timer);
		document.removeEventListener("keydown", keyDown, true);
		document.removeEventListener("keypress", keyPress, true)
	}

	function playGame() {
		init(document.getElementById("game"))
	}
	return {
		"playGame": playGame,
		"finishGame": finishGame
	}
}();
var KEY = {
	"BACKSPACE": 8,
	"TAB": 9,
	"NUM_PAD_CLEAR": 12,
	"ENTER": 13,
	"SHIFT": 16,
	"CTRL": 17,
	"ALT": 18,
	"PAUSE": 19,
	"CAPS_LOCK": 20,
	"ESCAPE": 27,
	"SPACEBAR": 32,
	"PAGE_UP": 33,
	"PAGE_DOWN": 34,
	"END": 35,
	"HOME": 36,
	"ARROW_LEFT": 37,
	"ARROW_UP": 38,
	"ARROW_RIGHT": 39,
	"ARROW_DOWN": 40,
	"PRINT_SCREEN": 44,
	"INSERT": 45,
	"DELETE": 46,
	"SEMICOLON": 59,
	"WINDOWS_LEFT": 91,
	"WINDOWS_RIGHT": 92,
	"SELECT": 93,
	"NUM_PAD_ASTERISK": 106,
	"NUM_PAD_PLUS_SIGN": 107,
	"NUM_PAD_HYPHEN-MINUS": 109,
	"NUM_PAD_FULL_STOP": 110,
	"NUM_PAD_SOLIDUS": 111,
	"NUM_LOCK": 144,
	"SCROLL_LOCK": 145,
	"SEMICOLON": 186,
	"EQUALS_SIGN": 187,
	"COMMA": 188,
	"HYPHEN-MINUS": 189,
	"FULL_STOP": 190,
	"SOLIDUS": 191,
	"GRAVE_ACCENT": 192,
	"LEFT_SQUARE_BRACKET": 219,
	"REVERSE_SOLIDUS": 220,
	"RIGHT_SQUARE_BRACKET": 221,
	"APOSTROPHE": 222
};
(function() {
	for (var i = 48; i <= 57; i++) KEY["" + (i - 48)] = i;
	for (i = 65; i <= 90; i++) KEY["" + String.fromCharCode(i)] = i;
	for (i = 96; i <= 105; i++) KEY["NUM_PAD_" + (i - 96)] = i;
	for (i = 112; i <= 123; i++) KEY["F" + (i - 112 + 1)] = i
})();
Pacman.WALL = 0;
Pacman.BISCUIT = 1;
Pacman.EMPTY = 2;
Pacman.BLOCK = 3;
Pacman.PILL = 4;
Pacman.MAP = [
	[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
	[0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0],
	[0, 4, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0, 0, 0, 1, 0, 0, 4, 0],
	[0, 1, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0, 0, 0, 1, 0, 0, 1, 0],
	[0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0],
	[0, 1, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 1, 0],
	[0, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1, 1, 1, 0],
	[0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0],
	[2, 2, 2, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 2, 2, 2],
	[0, 0, 0, 0, 1, 0, 1, 0, 0, 3, 0, 0, 1, 0, 1, 0, 0, 0, 0],
	[2, 2, 2, 2, 1, 1, 1, 0, 3, 3, 3, 0, 1, 1, 1, 2, 2, 2, 2],
	[0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0],
	[2, 2, 2, 0,
		1, 0, 1, 1, 1, 2, 1, 1, 1, 0, 1, 0, 2, 2, 2
	],
	[0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0],
	[0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0],
	[0, 1, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0, 0, 0, 1, 0, 0, 1, 0],
	[0, 4, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 4, 0],
	[0, 0, 1, 0, 1, 0, 1, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 0],
	[0, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1, 1, 1, 0],
	[0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0],
	[0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0],
	[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
];
Pacman.WALLS = [
	[{
		"move": [0, 9.5]
	}, {
		"line": [3, 9.5]
	}, {
		"curve": [3.5, 9.5, 3.5, 9]
	}, {
		"line": [3.5, 8]
	}, {
		"curve": [3.5, 7.5, 3, 7.5]
	}, {
		"line": [1, 7.5]
	}, {
		"curve": [.5, 7.5, .5, 7]
	}, {
		"line": [.5, 1]
	}, {
		"curve": [.5, .5, 1, .5]
	}, {
		"line": [9, .5]
	}, {
		"curve": [9.5, .5, 9.5, 1]
	}, {
		"line": [9.5, 3.5]
	}],
	[{
		"move": [9.5, 1]
	}, {
		"curve": [9.5, .5, 10, .5]
	}, {
		"line": [18, .5]
	}, {
		"curve": [18.5, .5, 18.5, 1]
	}, {
		"line": [18.5, 7]
	}, {
		"curve": [18.5, 7.5, 18, 7.5]
	}, {
		"line": [16, 7.5]
	}, {
		"curve": [15.5, 7.5, 15.5, 8]
	}, {
		"line": [15.5, 9]
	}, {
		"curve": [15.5, 9.5, 16, 9.5]
	}, {
		"line": [19, 9.5]
	}],
	[{
		"move": [2.5, 5.5]
	}, {
		"line": [3.5, 5.5]
	}],
	[{
		"move": [3, 2.5]
	}, {
		"curve": [3.5, 2.5, 3.5, 3]
	}, {
		"curve": [3.5, 3.5, 3, 3.5]
	}, {
		"curve": [2.5, 3.5, 2.5, 3]
	}, {
		"curve": [2.5, 2.5, 3, 2.5]
	}],
	[{
		"move": [15.5, 5.5]
	}, {
		"line": [16.5, 5.5]
	}],
	[{
		"move": [16, 2.5]
	}, {
		"curve": [16.5, 2.5, 16.5, 3]
	}, {
		"curve": [16.5, 3.5, 16, 3.5]
	}, {
		"curve": [15.5, 3.5, 15.5, 3]
	}, {
		"curve": [15.5, 2.5, 16, 2.5]
	}],
	[{
		"move": [6, 2.5]
	}, {
		"line": [7, 2.5]
	}, {
		"curve": [7.5, 2.5, 7.5, 3]
	}, {
		"curve": [7.5, 3.5, 7, 3.5]
	}, {
		"line": [6, 3.5]
	}, {
		"curve": [5.5, 3.5, 5.5, 3]
	}, {
		"curve": [5.5, 2.5, 6, 2.5]
	}],
	[{
		"move": [12,
			2.5
		]
	}, {
		"line": [13, 2.5]
	}, {
		"curve": [13.5, 2.5, 13.5, 3]
	}, {
		"curve": [13.5, 3.5, 13, 3.5]
	}, {
		"line": [12, 3.5]
	}, {
		"curve": [11.5, 3.5, 11.5, 3]
	}, {
		"curve": [11.5, 2.5, 12, 2.5]
	}],
	[{
		"move": [7.5, 5.5]
	}, {
		"line": [9, 5.5]
	}, {
		"curve": [9.5, 5.5, 9.5, 6]
	}, {
		"line": [9.5, 7.5]
	}],
	[{
		"move": [9.5, 6]
	}, {
		"curve": [9.5, 5.5, 10.5, 5.5]
	}, {
		"line": [11.5, 5.5]
	}],
	[{
		"move": [5.5, 5.5]
	}, {
		"line": [5.5, 7]
	}, {
		"curve": [5.5, 7.5, 6, 7.5]
	}, {
		"line": [7.5, 7.5]
	}],
	[{
		"move": [6, 7.5]
	}, {
		"curve": [5.5, 7.5, 5.5, 8]
	}, {
		"line": [5.5, 9.5]
	}],
	[{
		"move": [13.5, 5.5]
	}, {
		"line": [13.5, 7]
	}, {
		"curve": [13.5,
			7.5, 13, 7.5
		]
	}, {
		"line": [11.5, 7.5]
	}],
	[{
		"move": [13, 7.5]
	}, {
		"curve": [13.5, 7.5, 13.5, 8]
	}, {
		"line": [13.5, 9.5]
	}],
	[{
		"move": [0, 11.5]
	}, {
		"line": [3, 11.5]
	}, {
		"curve": [3.5, 11.5, 3.5, 12]
	}, {
		"line": [3.5, 13]
	}, {
		"curve": [3.5, 13.5, 3, 13.5]
	}, {
		"line": [1, 13.5]
	}, {
		"curve": [.5, 13.5, .5, 14]
	}, {
		"line": [.5, 17]
	}, {
		"curve": [.5, 17.5, 1, 17.5]
	}, {
		"line": [1.5, 17.5]
	}],
	[{
		"move": [1, 17.5]
	}, {
		"curve": [.5, 17.5, .5, 18]
	}, {
		"line": [.5, 21]
	}, {
		"curve": [.5, 21.5, 1, 21.5]
	}, {
		"line": [18, 21.5]
	}, {
		"curve": [18.5, 21.5, 18.5, 21]
	}, {
		"line": [18.5, 18]
	}, {
		"curve": [18.5, 17.5, 18,
			17.5
		]
	}, {
		"line": [17.5, 17.5]
	}],
	[{
		"move": [18, 17.5]
	}, {
		"curve": [18.5, 17.5, 18.5, 17]
	}, {
		"line": [18.5, 14]
	}, {
		"curve": [18.5, 13.5, 18, 13.5]
	}, {
		"line": [16, 13.5]
	}, {
		"curve": [15.5, 13.5, 15.5, 13]
	}, {
		"line": [15.5, 12]
	}, {
		"curve": [15.5, 11.5, 16, 11.5]
	}, {
		"line": [19, 11.5]
	}],
	[{
		"move": [5.5, 11.5]
	}, {
		"line": [5.5, 13.5]
	}],
	[{
		"move": [13.5, 11.5]
	}, {
		"line": [13.5, 13.5]
	}],
	[{
		"move": [2.5, 15.5]
	}, {
		"line": [3, 15.5]
	}, {
		"curve": [3.5, 15.5, 3.5, 16]
	}, {
		"line": [3.5, 17.5]
	}],
	[{
		"move": [16.5, 15.5]
	}, {
		"line": [16, 15.5]
	}, {
		"curve": [15.5, 15.5, 15.5, 16]
	}, {
		"line": [15.5,
			17.5
		]
	}],
	[{
		"move": [5.5, 15.5]
	}, {
		"line": [7.5, 15.5]
	}],
	[{
		"move": [11.5, 15.5]
	}, {
		"line": [13.5, 15.5]
	}],
	[{
		"move": [2.5, 19.5]
	}, {
		"line": [5, 19.5]
	}, {
		"curve": [5.5, 19.5, 5.5, 19]
	}, {
		"line": [5.5, 17.5]
	}],
	[{
		"move": [5.5, 19]
	}, {
		"curve": [5.5, 19.5, 6, 19.5]
	}, {
		"line": [7.5, 19.5]
	}],
	[{
		"move": [11.5, 19.5]
	}, {
		"line": [13, 19.5]
	}, {
		"curve": [13.5, 19.5, 13.5, 19]
	}, {
		"line": [13.5, 17.5]
	}],
	[{
		"move": [13.5, 19]
	}, {
		"curve": [13.5, 19.5, 14, 19.5]
	}, {
		"line": [16.5, 19.5]
	}],
	[{
		"move": [7.5, 13.5]
	}, {
		"line": [9, 13.5]
	}, {
		"curve": [9.5, 13.5, 9.5, 14]
	}, {
		"line": [9.5, 15.5]
	}],
	[{
		"move": [9.5, 14]
	}, {
		"curve": [9.5, 13.5, 10, 13.5]
	}, {
		"line": [11.5, 13.5]
	}],
	[{
		"move": [7.5, 17.5]
	}, {
		"line": [9, 17.5]
	}, {
		"curve": [9.5, 17.5, 9.5, 18]
	}, {
		"line": [9.5, 19.5]
	}],
	[{
		"move": [9.5, 18]
	}, {
		"curve": [9.5, 17.5, 10, 17.5]
	}, {
		"line": [11.5, 17.5]
	}],
	[{
		"move": [8.5, 9.5]
	}, {
		"line": [8, 9.5]
	}, {
		"curve": [7.5, 9.5, 7.5, 10]
	}, {
		"line": [7.5, 11]
	}, {
		"curve": [7.5, 11.5, 8, 11.5]
	}, {
		"line": [11, 11.5]
	}, {
		"curve": [11.5, 11.5, 11.5, 11]
	}, {
		"line": [11.5, 10]
	}, {
		"curve": [11.5, 9.5, 11, 9.5]
	}, {
		"line": [10.5, 9.5]
	}]
];
var PONG = function() {
	this.interval;
	STATUSES = {
		STOPED: "STOPED",
		RUNNING: "RUNNING",
		GAMEOVER: "GAMEOVER"
	};
	var pong = {
		status: STATUSES.STOPED,
		pressedKeys: [],
		score: 0,
		ball: {
			speed: 5,
			x: 135,
			y: 100,
			directionX: -1,
			directionY: -1
		},
		isRunning: function() {
			return this.status === STATUSES.RUNNING
		}
	};
	var KEYS = {
		LEFT: 37,
		RIGHT: 39
	};

	function moveRacket(racketHTML, pong) {
		var left = racketHTML.offsetLeft;
		if (pong.pressedKeys[KEYS.LEFT]) return left - 5;
		else if (pong.pressedKeys[KEYS.RIGHT]) return left + 5
	}

	function drawRacket(racketHTML, pixelPos) {
		racketHTML.style.left =
			pixelPos + "px"
	}

	function nextPosition(currentPosition, speed, direction) {
		return currentPosition + speed * direction
	}

	function moveBallDirectionX(playgroundHTML, ball) {
		var width = playgroundHTML.offsetWidth,
			directionX = ball.directionX;
		var positionX = nextPosition(ball.x, ball.speed, ball.directionX);
		if (positionX > width - 30) directionX = -1;
		if (positionX < 0) directionX = 1;
		return directionX
	}

	function moveBallDirectionY(playgroundHTML, ball) {
		var height = playgroundHTML.offsetHeight,
			directionY = ball.directionY;
		var positionY = nextPosition(ball.y,
			ball.speed, ball.directionY);
		if (positionY > height) directionY = -1;
		if (positionY < 0) directionY = 1;
		return directionY
	}

	function moveBallPosition(ball, direction) {
		return ball.speed * direction
	}

	function changeBallPosition(ball, dirX, posX, dirY, posY) {
		ball.directionX = dirX;
		ball.directionY = dirY;
		ball.x += posX;
		ball.y += posY
	}

	function drawBall(ballHTML, ball) {
		ballHTML.style.left = ball.x + "px";
		ballHTML.style.top = ball.y + "px"
	}

	function racketPositionY(racketHTML, ballHTML) {
		var ballSize = ballHTML.offsetHeight;
		return racketHTML.offsetTop -
			ballSize / 2
	}

	function isRacketHit(racketHTML, ballHTML, ball) {
		var racketBorderLeft = racketHTML.offsetLeft;
		var racketBorderRight = racketBorderLeft + racketHTML.offsetWidth;
		var posX = nextPosition(ball.x, ball.speed, ball.directionX);
		var posY = nextPosition(ball.y, ball.speed, ball.directionY);
		var racketPosY = racketPositionY(racketHTML, ballHTML);
		return posX >= racketBorderLeft && posX <= racketBorderRight && posY >= racketPosY
	}

	function counter(racketHTML, ballHTML, ball) {
		return isRacketHit(racketHTML, ballHTML, ball)
	}

	function computeScore(hit,
		score) {
		return hit ? score + 1 : score
	}

	function changeScore(pong, newScore) {
		pong.score = newScore
	}

	function drawScore(scoreHTML, score) {
		scoreHTML.innerHTML = score
	}

	function changeDirectionY(ball, hit) {
		if (hit) ball.directionY = -1
	}

	function isGameOver(racketHTML, ballHTML, ball) {
		var bottomPos = racketHTML.offsetHeight;
		var posY = nextPosition(ball.y, ball.speed, ball.directionY) - bottomPos;
		var racketPosY = racketPositionY(racketHTML, ballHTML);
		return posY > racketPosY
	}

	function endGame(pong, isOver) {
		if (isOver) pong.status = STATUSES.GAMEOVER
	}

	function drawEndGame(gameOverHTML, isOver) {
		if (isOver) {
			pong.status = STATUSES.STOPED;
			gameOverHTML.style.display = "block"
		}
	}

	function loop(playgroundHTML, racketHTML, ballHTML, scoreHTML, gameOverHTML) {
		if (pong.isRunning()) {
			var ball = pong.ball,
				score = pong.score;
			var newDirX = moveBallDirectionX(playgroundHTML, ball);
			var newDirY = moveBallDirectionY(playgroundHTML, ball);
			var newPosX = moveBallPosition(ball, newDirX);
			var newPosY = moveBallPosition(ball, newDirY);
			changeBallPosition(ball, newDirX, newPosX, newDirY, newPosY);
			drawBall(ballHTML,
				ball);
			var pixelPos = moveRacket(racketHTML, pong);
			drawRacket(racketHTML, pixelPos);
			var hit = counter(racketHTML, ballHTML, ball);
			var newScore = computeScore(hit, score);
			changeDirectionY(ball, hit);
			changeScore(pong, newScore);
			drawScore(scoreHTML, pong.score);
			var isOver = isGameOver(racketHTML, ballHTML, ball);
			endGame(pong, isOver);
			drawEndGame(gameOverHTML, isOver)
		}
	}

	function restart() {
		var startHTML = document.getElementById("start-message"),
			gameOverHTML = document.getElementById("game-over");
		pong.status = STATUSES.RUNNING;
		startHTML.style.display =
			"none";
		gameOverHTML.style.display = "none";
		pong.score = 0;
		pong.ball.speed = 5;
		pong.ball.x = 135;
		pong.ball.y = 100;
		pong.ball.directionX = -1;
		pong.ball.directionY = -1
	}

	function load() {
		var playgroundHTML = document.getElementById("playground"),
			racketHTML = document.getElementById("racket"),
			ballHTML = document.getElementById("ball"),
			scoreHTML = document.getElementById("score"),
			gameOverHTML = document.getElementById("game-over");
		this.interval = setInterval(function executeLoop() {
			loop(playgroundHTML, racketHTML, ballHTML, scoreHTML,
				gameOverHTML)
		}, 16);
		document.addEventListener("keydown", function startGame(event) {
			if (pong.status === STATUSES.STOPED) restart();
			else pong.pressedKeys[event.which] = true
		});
		document.addEventListener("keyup", function markAsNotPressed(event) {
			pong.pressedKeys[event.which] = false
		})
	}

	function finishGame() {
		clearInterval(this.interval);
		document.removeEventListener("keydown", function startGame(event) {
			if (pong.status === STATUSES.STOPED) restart();
			else pong.pressedKeys[event.which] = true
		});
		document.removeEventListener("keyup",
			function markAsNotPressed(event) {
				pong.pressedKeys[event.which] = false
			})
	}
	return {
		"playGame": load,
		"finishGame": finishGame
	}
}();
var SNAKE = function() {
	var WIDTH;
	var HEIGHT;
	var dx = 20;
	var dy = 20;
	var dr = 10;
	var sdirection;
	var snake;
	var size;
	var food;
	var gameStarted = false;
	this.id;

	function initSnake() {
		var gdiv = document.getElementById("game");
		canvas = document.getElementsByTagName("canvas")[0];
		WIDTH = Math.floor(gdiv.clientWidth / 20) * 20;
		HEIGHT = Math.floor(gdiv.clientHeight / 20) * 20;
		canvas.width = WIDTH;
		canvas.height = HEIGHT;
		ctx = canvas.getContext("2d");
		createsnake();
		newfood();
		sdirection = 0;
		size = 1;
		this.id = setInterval(step, 100)
	}

	function onKeyDown(evt) {
		if (evt.keyCode ===
			undefined || evt.keyCode === 0) return;
		if (gameStarted == false && evt.keyCode == 32) {
			gameStarted = true;
			initSnake();
			return
		}
		if (evt.keyCode == 32) return;
		newdir = evt.keyCode - 37;
		if (newdir != sdirection && newdir != sdirection + 2 && newdir != sdirection - 2) sdirection = newdir
	}

	function createsnake() {
		snake = Array();
		var head = Array();
		head.x = Math.floor(WIDTH / 2 / 20) * 20;
		head.y = Math.floor(HEIGHT / 2 / 20) * 20;
		snake.push(head)
	}

	function collision(n) {
		if (n.x < 0 || n.x > WIDTH - 1 || n.y < 0 || n.y > HEIGHT - 1) return true;
		for (var i = 0; i < snake.length; i++)
			if (snake[i].x ==
				n.x && snake[i].y == n.y) return true;
		return false
	}

	function newfood() {
		var wcells = WIDTH / dx;
		var hcells = HEIGHT / dy;
		var randomx = Math.floor(Math.random() * wcells);
		var randomy = Math.floor(Math.random() * hcells);
		food = Array();
		food.x = randomx * dx;
		food.y = randomy * dy;
		food.r = dr;
		size = size + 1
	}

	function meal(n) {
		return n.x == food.x && n.y == food.y
	}

	function movesnake() {
		h = snake[0];
		var n = Array();
		switch (sdirection) {
			case 0:
				n.x = h.x - dx;
				n.y = h.y;
				break;
			case 1:
				n.x = h.x;
				n.y = h.y - dy;
				break;
			case 2:
				n.x = h.x + dx;
				n.y = h.y;
				break;
			case 3:
				n.x = h.x;
				n.y = h.y + dy;
				break
		}
		if (collision(n)) return false;
		snake.unshift(n);
		console.log(food.x + " " + food.y + " " + n.x + " " + n.y);
		if (meal(n)) newfood();
		else snake.pop();
		return true
	}

	function die() {
		if (this.id) clearInterval(this.id);
		gameStarted = false
	}

	function circle(x, y, r) {
		ctx.beginPath();
		ctx.arc(x, y, r, 0, Math.PI * 2, true);
		ctx.closePath();
		ctx.fill()
	}

	function rect(x, y, w, h) {
		ctx.beginPath();
		ctx.rect(x, y, w, h);
		ctx.closePath();
		ctx.fill()
	}

	function screenclear() {
		ctx.fillStyle = "#000000";
		ctx.clearRect(0, 0, WIDTH, HEIGHT);
		rect(0, 0, WIDTH, HEIGHT)
	}

	function drawsnake() {
		ctx.fillStyle =
			"#FFFFFF";
		snake.forEach(function(p) {
			rect(p.x, p.y, dx, dy)
		})
	}

	function drawfood() {
		ctx.fillStyle = "#FF0000";
		circle(food.x + food.r, food.y + food.r, food.r)
	}

	function newGame() {
		showIntro();
		document.addEventListener("keydown", onKeyDown, true);
		document.addEventListener("keypress", onKeyDown, true)
	}

	function step() {
		update();
		draw()
	}

	function update() {
		if (!movesnake()) {
			die();
			showConclusion(size)
		}
	}

	function draw() {
		if (gameStarted) {
			screenclear();
			drawsnake();
			drawfood()
		}
	}

	function showIntro() {
		var canvas = document.getElementById("canvas");
		ctx = canvas.getContext("2d");
		var gdiv = document.getElementById("game");
		canvas.width = gdiv.clientWidth;
		canvas.height = gdiv.clientHeight;
		ctx.font = "30px Arial";
		ctx.fillStyle = "white";
		ctx.textAlign = "center";
		ctx.fillText("SNAKE", canvas.width / 2, canvas.height / 2);
		ctx.font = "20px Arial";
		ctx.fillText("press space to start", canvas.width / 2, canvas.height / 2 + 40)
	}

	function showConclusion(score) {
		screenclear();
		var canvas = document.getElementById("canvas");
		ctx = canvas.getContext("2d");
		var gdiv = document.getElementById("game");
		canvas.width = gdiv.clientWidth;
		canvas.height = gdiv.clientHeight;
		ctx.font = "30px Arial";
		ctx.fillStyle = "white";
		ctx.textAlign = "center";
		ctx.fillText("GAME OVER", canvas.width / 2, canvas.height / 2);
		ctx.fillText("score: " + score, canvas.width / 2, canvas.height / 2 - 40);
		ctx.font = "20px Arial";
		ctx.fillText("press space to start", canvas.width / 2, canvas.height / 2 + 80)
	}

	function finishGame() {
		clearInterval(this.id);
		document.removeEventListener("keydown", onKeyDown, true);
		document.removeEventListener("keypress", onKeyDown, true)
	}
	return {
		"playGame": newGame,
		"finishGame": finishGame
	}
}();
var TETRIS = function() {
	this.interval;
	this.renderinterval;
	var COLS = 10,
		ROWS = 20;
	var board = [];
	var lose;
	var current;
	var currentX, currentY;
	var shapes = [
		[1, 1, 1, 1],
		[1, 1, 1, 0, 1],
		[1, 1, 1, 0, 0, 0, 1],
		[1, 1, 0, 0, 1, 1],
		[1, 1, 0, 0, 0, 1, 1],
		[0, 1, 1, 0, 1, 1],
		[0, 1, 0, 0, 1, 1, 1]
	];
	var colors = ["cyan", "orange", "blue", "yellow", "red", "green", "purple"];

	function newShape() {
		var id = Math.floor(Math.random() * shapes.length);
		var shape = shapes[id];
		current = [];
		for (var y = 0; y < 4; ++y) {
			current[y] = [];
			for (var x = 0; x < 4; ++x) {
				var i = 4 * y + x;
				if (typeof shape[i] != "undefined" &&
					shape[i]) current[y][x] = id + 1;
				else current[y][x] = 0
			}
		}
		currentX = 5;
		currentY = 0
	}

	function init() {
		for (var y = 0; y < ROWS; ++y) {
			board[y] = [];
			for (var x = 0; x < COLS; ++x) board[y][x] = 0
		}
	}

	function tick() {
		if (valid(0, 1)) ++currentY;
		else {
			freeze();
			clearLines();
			if (lose) {
				init();
				newShape();
				lose = false;
				return false
			}
			newShape()
		}
	}

	function freeze() {
		for (var y = 0; y < 4; ++y)
			for (var x = 0; x < 4; ++x)
				if (current[y][x]) board[y + currentY][x + currentX] = current[y][x]
	}

	function rotate(current) {
		var newCurrent = [];
		for (var y = 0; y < 4; ++y) {
			newCurrent[y] = [];
			for (var x =
					0; x < 4; ++x) newCurrent[y][x] = current[3 - x][y]
		}
		return newCurrent
	}

	function clearLines() {
		for (var y = ROWS - 1; y >= 0; --y) {
			var rowFilled = true;
			for (var x = 0; x < COLS; ++x)
				if (board[y][x] == 0) {
					rowFilled = false;
					break
				}
			if (rowFilled) {
				document.getElementById("clearsound").play();
				for (var yy = y; yy > 0; --yy)
					for (var x = 0; x < COLS; ++x) board[yy][x] = board[yy - 1][x];
				++y
			}
		}
	}

	function keyPress(key) {
		switch (key) {
			case "left":
				if (valid(-1)) --currentX;
				break;
			case "right":
				if (valid(1)) ++currentX;
				break;
			case "down":
				if (valid(0, 1)) ++currentY;
				break;
			case "rotate":
				var rotated =
					rotate(current);
				if (valid(0, 0, rotated)) current = rotated;
				break
		}
	}

	function valid(offsetX, offsetY, newCurrent) {
		offsetX = offsetX || 0;
		offsetY = offsetY || 0;
		offsetX = currentX + offsetX;
		offsetY = currentY + offsetY;
		newCurrent = newCurrent || current;
		for (var y = 0; y < 4; ++y)
			for (var x = 0; x < 4; ++x)
				if (newCurrent[y][x])
					if (typeof board[y + offsetY] == "undefined" || typeof board[y + offsetY][x + offsetX] == "undefined" || board[y + offsetY][x + offsetX] || x + offsetX < 0 || y + offsetY >= ROWS || x + offsetX >= COLS) {
						if (offsetY == 1) lose = true;
						return false
					}
		return true
	}
	var W,
		H;
	var BLOCK_W, BLOCK_H;

	function newGame() {
		var gdiv = document.getElementById("game");
		canvas = document.getElementsByTagName("canvas")[0];
		W = gdiv.clientWidth;
		H = gdiv.clientHeight;
		BLOCK_W = W / COLS;
		BLOCK_H = H / ROWS;
		canvas.width = W;
		canvas.height = H;
		ctx = canvas.getContext("2d");
		document.addEventListener("keydown", keyDown, true);
		clearInterval(this.interval);
		clearInterval(this.renderinterval);
		init();
		newShape();
		lose = false;
		this.interval = setInterval(tick, 250);
		this.renderinterval = setInterval(render, 30)
	}

	function drawBlock(x,
		y) {
		ctx.fillRect(BLOCK_W * x, BLOCK_H * y, BLOCK_W - 1, BLOCK_H - 1);
		ctx.strokeRect(BLOCK_W * x, BLOCK_H * y, BLOCK_W - 1, BLOCK_H - 1)
	}

	function render() {
		ctx.clearRect(0, 0, W, H);
		ctx.strokeStyle = "black";
		for (var x = 0; x < COLS; ++x)
			for (var y = 0; y < ROWS; ++y)
				if (board[y][x]) {
					ctx.fillStyle = colors[board[y][x] - 1];
					drawBlock(x, y)
				}
		ctx.fillStyle = "red";
		ctx.strokeStyle = "black";
		for (var y = 0; y < 4; ++y)
			for (var x = 0; x < 4; ++x)
				if (current[y][x]) {
					ctx.fillStyle = colors[current[y][x] - 1];
					drawBlock(currentX + x, currentY + y)
				}
	}

	function keyDown(e) {
		var keys = {
			37: "left",
			39: "right",
			40: "down",
			38: "rotate"
		};
		if (typeof keys[e.keyCode] != "undefined") {
			keyPress(keys[e.keyCode]);
			render()
		}
	}

	function finishGame() {
		clearInterval(this.renderinterval);
		clearInterval(this.interval);
		document.removeEventListener("keydown", keyDown, true)
	}
	return {
		"playGame": newGame,
		"finishGame": finishGame
	}
}();

function initialiseAbby() {
	addPerson("Abby", 394, "Abby");
	per.getQuestDragonGem = function() {
		return this.extra[0]
	};
	per.setQuestDragonGem = function(no) {
		this.extra[0] = no
	};
	per.isPersonInfo = function() {
		return true
	};
	per.getPersonInfo = function() {
		if (!this.isCharmedBy()) return "<img src='Images/People/Abby/abby0.jpg' class='imgpopup' alt='Abby'>" + "The Aquarium\u2019s receptionist is a youthful woman of asian ancestry named Abby. When you ask about directions and exhibitions in the Aquarium she gladly helps you out. " +
			"Maybe a little too much; it is clear that she is a talkative one and very open on helping others, but her non stop monologues about nothing can be frustrating after a while.<br><br>" + "Also, she\u2019s suspiciously open and positive about offering help to the visitors, including you of course. She told you she can escort you to the exhibitions you are interested in and she can be a guide if you would like that. She\u2019s an overly attached girlfriend type, but something in you keeps interested in her. You have to figure that out." +
			(isSpellKnown("Charm") ? 'Maybe you could "persuade" her to join the hordes of slaves following you? You have to be careful though, it\u2019s a public place after all!' : "");
		else return "<img src='Images/People/Abby/abby3d.jpg' class='imgpopup' alt='Abby'>" + "Yep, just what you thought. Abby is an overly attached girl who\u2019s emotions lead her instead of her mind. The tiny asian girl is way in over her head when you come to check on her. She throws herself into your open arms and strikes up a conversation with you where you usually listen to her problems. She only stops for a few short breaks asking you if you need anything or how could she serve you. You usually refuse and let her continue her rant which is mostly about her working conditions and everyday life.<br><br>" +
			"You admit to yourself; you\u2019re only here because she works naked! You can see her body exposed to everyone and everything! You made her transfer herself to an another department in the Aquarium so now she works alone and you don\u2019t have to worry about getting caught visiting her!<br><br>" + "Abby is tossing some papers around on her table when you arrive at her room. She stands up, bows and comes to you to talk. All while she plays with her completely naked body to your pleasure!"
	};
	per.getPersonAddress =
		function() {
			return isPlaceKnown("AbbysApartment") ? "Apartment 8, 42 Celeste Rd" : ""
		};
	per.whereNow = function() {
		if (isShopOpen(2, 0, true)) return this.place;
		if (isDay()) return 459;
		return 459
	};
	per.addPlaceImageLeft = function(lit) {
		if (Place == 459 && this.isHere() && sType === "") return this.showPerson("abby-home1.jpg", "", "", "", "", false, "string");
		return ""
	};
	per.isPlaceImageRight = function() {
		return Place == 279 && sType == "abbygem"
	};
	per.showPlaceImageRight = function(md) {
		this.showPerson("abby11a.jpg")
	};
	per.showPersonTextHere = function(md) {
		if (Place ==
			279 && sType == "abbygem") md.write("<p>Abby is looking around curiously, uncharacteristicly quiet.</p>");
		else if (Place == 459 && this.isHere()) md.write("<p>Abby seductively greets you, but then spoils the moment a bit as she starts chatting about her neighbours.</p>")
	};
	per.showEventPopup = function() {
		if (sType !== "") return false;
		if (Place == 394 && !this.checkFlag(1)) {
			this.setFlag(1);
			this.showPersonInfo(mdCache);
			return true
		}
		return false
	};
	per.showEvent = function() {
		var md;
		if (Place == 394 && sType == "gem") {
			md = WritePlaceHeader();
			this.showPerson("abby1d.jpg", "", "", "", "Information Girl");
			addPlaceTitle(md, "Dragon Gem");
			if (this.checkFlag(7)) md.write("<p>You again ask Abby about Dragon Gem and if she can move it for you to help save Leanne.</p>" + '<p>"Yes of course, let\'s go!"');
			else md.write("<p>You ask Abby if she has heard of the Dragon Gem and why it is so hot and untouchable.</p>" + "<p>\"Yes the legends of my family mention how the dragon used a gem to store it's power. The fate of the gem was not told of, and lost to history, but if you have found it, then you are truly the descendant of the hero!<br><br>" +
				'The power of the dragon would infuse the gem, and you could not touch it. But I think I might know how, let me try?"</p>' + "<p>It would seem Abby can help you, but she makes it difficult to decide, as she continues to happily talk, nothing related to this, just telling you about nothing and everything.</p>");
			startQuestions();
			addLinkToPlaceC(md, "\"let's go to the Mechanic's Workshop\"", 279, "type=abbygem", "Abby happily agrees and starts to follow you, still completely naked. You suggest she might like to get dressed, and she replies, &quot;No I wouldn&rsquo;t!&quot; and patiently waits for you. You give up and you both head to the workshop");
			addLinkToPlaceC(md, '"no need, I will look after it for now"', 394, "", "Abby looks at you happily, and resumes chatting about everything and nothing", "Abby", "setPersonFlag('Abby',7)");
			addLinkToPlace(md, "return to the front hall", 361);
			WritePlaceFooter(md);
			return true
		}
		if ((Place == 459 || Place == 394) && this.isHere())
			if (sType == "abbyfuck") {
				md = WritePlaceHeader(false, !perYou.isMaleSex() ? isExplicit() ? "td-left-large" : "" : "td-left-large");
				if (Place == 394)
					if (perYou.isMaleSex()) {
						this.showPerson("abby-home-sex-b.jpg");
						addPlaceTitle(md,
							"Abby's Office Help")
					} else {
						this.showPersonRorX("abby-home-sex-g.jpg");
						addPlaceTitle(md, "Abby's Office Help")
					}
				else if (perYou.isMaleSex()) {
					this.showPerson("abby-home-sex-b.jpg");
					addPlaceTitle(md, "Abby's Home Help")
				} else {
					this.showPersonRorX("abby-home-sex-g.jpg");
					addPlaceTitle(md, "Abby's Home Help")
				}
				md.write("<p>There are very few ways to get Abby to be quiet for a moment, but this one has so far never failed:</p>" + "<p>You pull Abby close to you, simply press your lips against hers, and after a brief grunt of protest, she quickly melts into the shared kiss, her naked body eagerly nestling against you.</p>" +
					"<p>\u201cWow... \u201cAbby looks at you wide-eyed as you break the kiss. \u201cYou... needed my help with something?\u201d</p>" + "<p>\u201cYes, and I also wanted to enjoy the quiet for a while.\u201d</p>" + "<p>\u201cOh...\u201d</p>" + "<p>There is a moment of silence where Abby doesn't seem to quite know what to do with you, now that she isn't talking. She is still remaining close, but occasionally looks around and pulls her lower lip in, as if she wants to say or ask something, but doesn't.</p>" + "<p>Finally, you move to the couch and pull her into your lap. The two of you share another brief kiss, and before Abby is able to say more, you press two fingers to her lips to silence her and guide her head down to your hip.</p>" +
					"<p>Abby nods to you with a wide smile and opens your pants, extending her tongue and slowly running it " + (perYou.isMaleSex() ? "along the entire length of your manhood" : "over your folds, finishing off with a playful flick over your clit") + ".</p>");
				if (perYou.isMaleSex()) md.write("<p>From then on, you not only enjoy the silence, but also the feel of Abby's lips wrapped around your manhood as her head moves back and forth.</p>" + "<p>You occasionally give her a small pointer, and while she is inexperienced, she is a fast learner and very eager to please you. It doesn't take long for you to reach your peak, and she eagerly swallows your load, happy to have indeed been able to help you.</p>");
				else md.write("<p>From then on, you not only enjoy the silence, but also the feel of Abby's tongue tracing your folds and slowly circling your clit.</p>" + "<p>You occasionally give her a small pointer, and while she is inexperienced, she is a fast learner and very eager to please you. It doesn't take long for you to reach your peak, and as you do, you press her head firm against your hip, telling her to make sure to clean you well, and she eagerly follows suit, happy to have indeed been of help.</p>");
				startQuestions();
				addLinkToPlaceC(md, "unavoidably talk more with Abby", Place);
				if (Place != 394) addLinkToPlace(md, "exit the apartment", 456);
				WritePlaceFooter(md);
				return true
			}
		if (Place != 279) return false;
		if (sType == "abbygem2") {
			md = WritePlaceHeader(false, "td-left-med");
			this.showPerson("abby11b.jpg");
			this.setFlag(8);
			this.setFlag(9);
			setPlaceFlag("Alley", 9);
			AddMana(5);
			addPlaceTitle(md, "Abby and the Gem");
			md.write("<p>Abby kneels down to look at the gem, and cheekily looks back at you to ensure you get a good view of her shapely rear.</p>" +
				"<p>She reaches out and casually picks up the gem, no discomfort showing on her face and she looks at the gen closely, turning it over. She throws it from one hand to the other, smiling and tells you,</p>" + '<p>"It\'s not hot at all to me, but I did feel a tingle, like when we first chatted <i>personally</i>."</p>' + "<p>She steps over to you and kisses you on the lips and you feels a surge of power, as some magic floods into you." + ' She tells you "The gem is shaped to fit into some sort of socket.", and then she then says,</p><p>"Anything more, or shall I return to work?".');
			if (checkPlaceFlag("Alley", 8) && checkPlaceFlag("Alley", 9)) md.write("Maybe you could ask her to relocate the gem?</p>");
			else md.write("You cannot think of anything more and ask her to return and promise to visit later.</p>");
			startQuestions();
			if (checkPlaceFlag("Alley", 8) && checkPlaceFlag("Alley", 9) && whereItem(35) == 279) addLinkToPlaceC(md, '"Can you move the dragon gem for me"', 53, "type=movegem");
			addLinkToPlace(md, "exit the workshop?", 194);
			WritePlaceFooter(md);
			return true
		}
		return false
	};
	per.showPersonChat =
		function(bGeneral, md) {
			if (Place == 279 && sType === "abbygem")
				if (!this.checkFlag(9)) addLinkToPlaceC(md, "ask Abby to check the gem", 279, "type=abbygem2");
				else {
					if (checkPlaceFlag("Alley", 8) && checkPlaceFlag("Alley", 9) && whereItem(35) == 279) addLinkToPlaceC(md, '"Can you move the dragon gem for me"', 53, "type=movegem")
				}
			else if (Place == 459 && this.isHere() && sType === "") {
				addLinkToPlaceC(md, "ask Abby for some help", Place, "type=abbyfuck");
				addSleepLink(md, "bed Abby", "Sleeping with Abby", '<p style="position:absolute;left:10%;top:10%;cursor:pointer;font-size:1.1em;width:40%"><b>You take Abby to bed, though it takes a while before she runs out of things to say!</b>',
					this.getImg("abby-bed.jpg"), true, "", "", "", "overflow-y:hidden")
			} else if (Place == 394 && sType === "" && this.isCharmedBy() && !isPersonHere("Miku")) addLinkToPlaceC(md, "ask Abby for some help", Place, "type=abbyfuck")
		};
	per.handleItem = function(no, cmd) {
		if (no == 14 && cmd == 2)
			if (Place == 394 && this.place == 394 && (!this.isCharmedBy() || !isPersonHere("Miku"))) {
				if (!isSpellKnown("Shielded Charm")) addComments("Don't cast the spell here. It is too public.");
				else CastCharmSpell("Abby", 395, 1);
				return "handled"
			}
		return ""
	};
	per.addPersonPhoneCall =
		function() {
			if (!this.isCharmedBy()) return false;
			if (!isDay() && checkPersonFlag("Miku", 4) && !this.checkFlag(2)) {
				if (makeCall(true, 260)) {
					this.setFlag(2);
					setPlaceKnown("AbbysApartment")
				}
			} else if (this.checkFlag(2) && !this.checkFlag(3))
				if (makeCall(true, 261)) this.setFlag(3);
			return false
		};
	per.getPersonSMS = function(id) {
		switch (id) {
			case 260:
				return receiveSMS("Abby", "Doing some work around my apartment, care to help me out my hero?", "abbysms1.jpg") + replyToSMS("At least you are wearing an apron") + receiveSMS("Abby",
					"Had to!") + replyToSMS("Who is taking the photo?") + receiveSMS("Abby", "A neighbour.");
			case 261:
				return receiveSMS("Abby", "Do you think the ladder is like a wooden horse? We do! I sent you my address, it is in the apartments on Celeste Rd. Come soon and have a ride!", "abbysms2.jpg")
		}
		return ""
	}
}

function examinePainting() {
	bChat = false;
	WriteComments('<table><tr><td style="vertical-align:top;width:40%"><img src="Images/amyancestor1.jpg" style="width:95%;" alt="Painting"></td><td><p>The painting is of a young woman, whom you assume is Lady Elizabeth Ross. She is holding a small book, and on the cover you can just make out some symbols, they look very much like those in the Sacred Book of Control!</p><p>The symbols are too fragmentary to reveal anything except that it appears Lady Elizabeth must have been a witch!</p></td></tr></table>')
}

function initialiseAdeleRoss() {
	addPerson("Adele Ross");
	per.getPersonAddress = function() {
		return this.getCharmedLevel() == 4 ? "5 Cherise Rd, Glenvale" : ""
	};
	per.whereNow = function() {
		if (sType == "pretrance") return 901;
		if (Place == 439 && this.isCharmedBy() && this.place == 436) return Place;
		return this.place
	};
	per.passTimeDay = function() {
		if (this.checkFlag(9) && !this.checkFlag(10) && nTime - this.charmedTime > 300) this.setFlag(10);
		if (this.getCharmedLevel() == 4 || this.place == 436 && !this.isCharmedBy() && this.checkFlag(7) && isDay()) {
			this.place =
				900;
			if (Place == 436 || Place == 439 || Place == 438) return (this.getCharmedLevel() == 4 ? "Your slave " : "") + "Adele leaves to attend her duties as a police officer"
		}
		return ""
	};
	per.passTimeNight = function() {
		if (this.place == 900) {
			this.place = 436;
			if (Place == 436 || Place == 439 || Place == 438) return (this.getCharmedLevel() == 4 ? "Your slave " : "") + "Adele returns home from her duties as a police " + getOfficer(false) + " and resumes her duties as your slave"
		}
		return ""
	};
	per.showEventPopup = function() {
		if (Place == 436 && this.isHere() && this.checkFlag(7) &&
			!this.checkFlag(8)) {
			this.setFlag(8);
			showPopupWindow("Adele Back Home?", "<img src='Images/Setting/adele7.jpg' class='imgpopup' alt='Adele'>" + "<p>You see Adele is home from her shift as a police officer, this is despite her being charmed as your slave! She looks at you and you expect some major confrontation, and she smiles,<p>" + '<p>"Hi ' + perYou.getPersonName() + ' nice to see you. Catherine is in her room for once, sorry but Amy is staying with a friend and is not home now.". She waves and she walks away. Ummm..what was that?</p>' +
				"<p>Catherine joins you and explains,</p>" + '<p>"Adele seems a bit confused, she has forgotten about protecting Amy and myself, and about you and the slime Beasley. She just remembers you as a family friend, and bears no hostility to you. She seems to be staying here now and has taken one of the spare bedrooms. I tried to talk to her about magic and slaves, but she just refused to talk about it. I did catch her masturbating one time, and she just smiled at me. She has never been so open about sex before."</p>' +
				"<p>It would seem Adele has somehow been freed from the spell, but she is affected in some way, her memory is confused in some way and she probably still wants to protect her sisters but she is not sure from what. So she has decided to stay in the house for sometime.</p>");
			return true
		}
		if (sType == "recharmfail") {
			this.setFlag(9);
			this.charmedTime = nTime;
			setQueryParams();
			showPopupWindow("Trying to Charm Adele", "<img src='Images/Setting/adele7.jpg' class='imgpopup' alt='Adele'>" + "<p>You cast the spell again on Adele, but nothing happens, nothing at all! Adele does not seem to notice and but looks at you and smiles, so maybe she noticed a little.<p>" +
				"<p>You ask Catherine if she remembers anything more about how Adele seems to have freed herself,</p>" + '<p>"No nothing. Let me see if I can find anything. She is more talkative recently. I\'ll give you a call when I find something out."</p>' + "<p>You will have to leave it to Catherine to see what she can find.</p>");
			return true
		}
		return false
	};
	per.showEvent = function() {
		var md;
		var perCatherine;
		if (Place == 269 && sType == "adelepool") {
			WaitHereOnly(6);
			md = WritePlaceHeader();
			this.showPerson("Setting/adele-pool.jpg");
			addPlaceTitle(md, "Swimming with Adele");
			md.write("<p>Adele arrives dressed in a bikini, you are alway impressed with her figure, well cleavage. You go for a pleasant swim with the police officer.</p>");
			startQuestions();
			addLinkToPlaceC(md, "say goodbye to Adele", Place);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "adelecall") {
			WaitHereOnly(1);
			md = WritePlaceHeader();
			this.showPerson("Setting/adele-call.jpg");
			addPlaceTitle(md, "Adele On-Call");
			md.write("<p>Adele meets you in the open, she is on foot as well. As she arrives she starts to remove her clothing without you saying a word.</p>" +
				"<p>It is a bit too public here so you instruct her to get dressed again, and she asks how she can help you? You just explain that you wanted to see her and there was nothing in particular you wanted.</p>");
			startQuestions();
			addLinkToPlace(md, "let Adele return to her duties", Place);
			WritePlaceFooter(md);
			return true
		}
		if (Place == 438 && sType == "catherineadelethreesome") {
			if (!isExplicit()) {
				md = WritePlaceHeader(false, isBritish() ? "td-left-med" : "");
				this.showPersonRorX("Setting/adelecatherineyou.jpg")
			} else if (perYou.isMaleSex()) {
				md =
					WritePlaceHeader(false, "td-left-large");
				if (isBritish()) this.showPersonRandomX("Setting/adelecatherineyou-b", 2);
				else this.showPersonX("Setting/adelecatherineyou-b.jpg")
			} else {
				md = WritePlaceHeader(false, isBritish() ? "td-left-large" : "");
				this.showPersonX("Setting/adelecatherineyou-g.jpg")
			}
			addPlaceTitle(md, "Catherine and Adele");
			if (perYou.isMaleSex()) md.write("<p>You have a threesome with Catherine and Adele.</p>");
			else md.write("<p>You have a threesome with Catherine and Adele.</p>");
			startQuestionsOnly();
			addLinkToPlace(md, "leave the bedroom", 436);
			addLinkToPlace(md, "leave the house", 37);
			WritePlaceFooter(md);
			return true
		}
		if (Place !== 436) return false;
		if (sType == "trance") {
			perCatherine = findPerson("Catherine");
			AddMana(-1);
			md = WritePlaceHeader();
			this.showPerson("Setting/adele8.jpg");
			addPlaceTitle(md, "Adele In a Trance");
			if (isBritish()) md.write("<p>Catherine leads you to a small room that is set aside as a library. It has books from many generations of the family, from old dusty tomes, to trashy romance novels. If you did not already know you would thing the romance novels were Catherine's but some time ago Amy confessed having a guilty pleasure reading trashy novels.</p>" +
				'<p>You see Adele is there reading a book, one of the old tomes but as you enter the room she closes the book and stands, looking at you curiously as if to ask "why are you here?"</p>' + '<p>Before she asks you call out "Look an Aardvark" and grab her arm and use the magically augment hypnotic technique. Instantly she falls into a trance.</p>');
			else md.write("<p>Catherine leads you to a large very white bathroom and you see Adele in in her black underwear putting on her make-up. You are quite impressed by the display of her impressive cleavage.</p>" +
				'<p>You touch her elbow and say "It\'s raining cucumbers" and use the magically augment hypnotic technique. Instantly she falls into a trance.</p>');
			md.write("<p>She starts to some words, they sound a little like those from the Book, but they are incoherent. You start talking to her in a firm and measured way, focusing her attention on you. Using the methods you learned of hypnosis you talk to her about her self-hypnosis and what she was doing. She answers quickly, she must be very easy to hypnotise,</p>" +
				'<p>"It helps me to focus on my objectives and cut though distractions"</p>' + "<p>That is it, you need now the cast the spell and use this hypnotic state and her words here to shape her mind to your desires.</p>");
			startQuestions();
			addLinkToPlace(md, "or you could let the trance end", 37);
			AddPeopleColumn(md);
			perCatherine.showPerson(perCatherine.isCharmedBy() ? "catherine-watching1c.jpg" : "catherine-watching1.jpg");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "charmadele2x1") {
			perCatherine = findPerson("Catherine");
			md = WritePlaceHeader(false, !isBritish() ? "td-left-med" : "");
			this.showPerson("Setting/adele9.jpg");
			addPlaceTitle(md, "Adele Under A Hypnotic Charm Spell");
			md.write("<p>You are certainly not going to pass up this opportunity by letting the trance end, so you cast the charm spell again on Adele. She definitely reacts, and you see her eyes begin to take on a green tint, but she starts to say the words again like a mantra.</p>" + "<p>You calmly interrupt, continuing the hypnotic trance and talking to her about the objectives she mentioned. She starts to talk about protecting her sisters, and you reassure her that they are safe and you will ensure they are always protected. She sighs and starts to say how she has to protect them, and you instead talk to her about her desires aside from this.</p>" +
				'<p>Adele says, "Learn magic like Lady Elizabeth and use it to defend my family". Again you ask what else she wants, she is not only a police officer, a protector, she is also a woman with desires and wants. You emphasise this as hopefully the arousal of the spell is affecting her.</p>' + '<p>Adele reacts strongly, "I am not a slut like Catherine...but I do have desires..." ');
			if (isBritish()) md.write(" Adele undoes her skirt and it drops to the floor, then she opens her top to remove it. For someone who looked so prim and proper as she was reading, her underwear and stockings are rather sexy. Her nickers are almost transparent!</p>");
			else md.write("Adele almost collapses and kneels on the bathroom floor, one hand tracing along her very ample cleavage.</p>");
			md.write("<p>Catherine starts to speak, in her defense or to argue, it does not matter what. You gesture for her to stop, you need Adele to focus on you and only you. Catherine stops after a few words.</p>" + "<p>You continue talking calmly and firmly to maintain the hypnotic trance, and you talk more about her desires. Clearly Catherine's sexuality, or over-sexuality, is a sore point for Adele. You focus on her desires and lusts and <i>never</i> mention protecting anyone.</p>");
			startQuestions();
			addLinkToPlaceC(md, "Adele listens", 436, "type=charmadele2x2");
			AddPeopleColumn(md);
			perCatherine.showPerson(perCatherine.isCharmedBy() ? "catherine-watching1c.jpg" : "catherine-watching1.jpg");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "charmadele2x2") {
			perCatherine = findPerson("Catherine");
			md = WritePlaceHeader(false, !isBritish() ? "td-left-med" : "");
			this.showPerson("Setting/adele10.jpg");
			addPlaceTitle(md, "Adele Under A Hypnotic Charm Spell");
			md.write("<p>You build on the talk of her desires and her needs and directly talk about her <b>sexual</b> desires and needs.</p>" +
				"<p>You can immediately see the spell is fully affecting her and the arousal of the magic is flooding through her body.</p>");
			if (isBritish()) md.write("<p>Adele pulls off her bra and sits on the desk she was just earlier at reading. She cries out as her body shudders in an involuntary orgasm and she slumps against the bookshelf.</p>");
			else md.write("<p>Adele grasps her breasts and leans back against the bathroom wall. She cries out as her body shudders in an involuntary orgasm and she slumps against the wall.</p>");
			md.write("<p>You push on in the afterglow of her orgasm, telling her about how she can rely on you to protect <b>her</b> and all she has to do is agree to be your <i>slave</i>, your lovely and beautiful <i>slave</i>.</p>");
			startQuestions();
			addLinkToPlaceC(md, "Adele agrees", 436, "type=charmadele2x3");
			AddPeopleColumn(md);
			perCatherine.showPerson(perCatherine.isCharmedBy() ? "catherine-watching2c.jpg" : "catherine-watching2.jpg");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "charmadele2x3") {
			perCatherine = findPerson("Catherine");
			this.setFlag(12, false);
			md = WritePlaceHeader(false, !isBritish() ? "td-left-med" : "");
			this.showPerson("Setting/adele11.jpg");
			addPlaceTitle(md, "Adele Under A Hypnotic Charm Spell");
			if (isBritish()) md.write('<p>Adele removes the rest of her clothing and looks at you, "Yes ' + perYou.getMaster() + '"</p>');
			else md.write('<p>Adele leans towards you almost on all fours, and her breasts almost falling out of her bra, "Yes ' + perYou.getMaster() + '"</p>');
			md.write("<p>You have her, she is your slave and you doubt she will get free again. The hypnosis should of reinforced your control to the level that she cannot break it. She respectfully asks you,</p>" +
				'<p>"' + perYou.getMaster() + ", being a Police " + getOfficer() + ' is important to me, and in my duties may be able to help you. You can <b>call me</b> anytime you need me. May I keep my duties and also stay in the police?" You consider for a moment and Catherine adds in,</p>' + '<p>"' + perYou.getPersonName() + ', Adele has always loved being in the police, please allow it". You were not really considering refusing, another police-slave seems an excellent idea. You pretend reluctance,</p>' + '<p>"Well Adele, you will have to do something to pay for this. Alright, you must be naked when at home <b>always</b>, and of course...." You start removing your clothing.</p>' +
				'<p>Catherine tries something as she says, "Obey me as well as ' + perYou.getPersonName() + '!". You look to see if Adele objects but she just looks at you, and you allow Catherine this, "Yes, obey Catherine"<p>' + '<p>You take Adele for the first time, finally she allows you to satisfy yourself with her body. As you step away Catherine says "Now for my turn"</p>');
			startQuestions();
			addLinkToPlaceC(md, "let Catherine enjoy Adele and then talk to them", 436);
			AddPeopleColumn(md);
			perCatherine.showPerson(perCatherine.isCharmedBy() ?
				"catherine-watching3c.jpg" : "catherine-watching3.jpg");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "pretrance" || Place == 436 && this.isHere() && this.checkFlag(11) && !this.isCharmedBy()) {
			setQueryParams("type=pretrance");
			perCatherine = findPerson("Catherine");
			md = WritePlaceHeader();
			perCatherine.showPerson(perCatherine.isCharmedBy() ? "catherine-watching4c.jpg" : "catherine-watching4.jpg");
			addPlaceTitle(md, "Catherine and Adele");
			md.write("<p>Catherine greets you, and tells you Adele is in the ");
			if (isBritish()) md.write("library reading some of the old books");
			else md.write("bathroom getting ready to go out with some friends");
			md.write(" and asks if you are ready? Catherine being who she is gives you a flash of her underwear, silently asking if you are ready for her too.</p><p>");
			if (perYou.checkFlag(25))
				if (nMana > 10) md.write("You are sure you are and tell Catherine to lead you to her.</p>");
				else md.write("You are sure you could, if you had enough mana.</p>");
			else md.write("You have nothing else than the normal charm spell so there is no use in trying anything now.</p>");
			startQuestions();
			if (perYou.checkFlag(25) && nMana > 10) addLinkToPlace(md, "hypnotise Adele", 436, "type=trance");
			addLinkToPlace(md, "not now", 37);
			WritePlaceFooter(md, "", true, true);
			return true
		}
		if (sType == "initialmeeting" || Place == 436 && this.isHere() && !this.checkFlag(5)) {
			setQueryParams("type=initialmeeting");
			this.setFlag(5);
			perYou.startQuest(8);
			md = WritePlaceHeader();
			this.showPerson("Setting/adele2.jpg");
			addPlaceTitle(md, "Adele Protecting Her Sisters");
			if (wherePerson("Catherine") == 436) md.write("<p>You decide to visit Amy and Catherine to see how they are after the incident with Mr. Beasley, so you knock on the door. There is a brief delay and the door is opened by a police officer, for a moment you feel worried for them, but you immediately recognise her as their older sister Adele. She looks at you suspiciously,</p>" +
				'<p>"Hello...ummm..' + perYou.getPersonName() + ', we are not receiving visitors, please leave."</p>' + "<p>She then gestures for you to leave the house, but you ask after Amy and Catherine telling her you know they were...had a problem with Mr. Beasley,</p>" + '<p>"Catherine told me when she returned home that something strange happened. I called Amy, and she just told me to speak to Catherine, but that you had helped them."</p>' + "<p>She looks at you uncertain,</p>" + '<p>"Still, for now you cannot see them, I want to keep them safe from any other sort of magical assault."</p>' +
				"<p>What, did she say magical? She notices your reaction, and smiles,</p>" + '<p>"Did you think I am ignorant of the ways of magic? Or that you are a novice ' + perYou.getWitch() + '? People now days dismiss magic as a thing of fairy tales and fiction, but I am a descendant of Lady Elizabeth Ross, a sorceress of power. Some of her secrets were passed down through the years, my sisters ignored these, more interested in school or sex. I did not, especially when I found about some rare crimes of sorcery and that there was no way to prosecute them."</p>' +
				'<p>She touches her earring, "I am well protected, and I will protect my sisters from slavery, either by a lecherous teacher, or a lustful friend!"</p>' + "<p>You try to argue you were just concerned for your friends, but she clearly does not believe your <i>lie</i>.</p>");
			else md.write("<p>You decide to visit Amy and Catherine as you overheard their sister Adele concerned for Amy, so you knock on the door. There is a brief delay and the door is opened by a police officer, for a moment you feel worried, but you immediately recognise her as the older sister Adele. She looks at you suspiciously,</p>" +
				'<p>"Hello...ummm..' + perYou.getPersonName() + ', I am busy at the moment, please leave."</p>' + "<p>She then gestures for you to leave the house, but you ask after Amy, saying you heard there was a problem,</p>" + '<p>"Yes, there is, I heard from Amy at work but that issue should be sorted now."</p>' + "<p>She looks at you uncertain,</p>" + '<p>"Still, for now it is best that you do not see Amy or Catherine, I want to keep them safe from any other sort of magical assault."</p>' + "<p>What, did she say magical? She notices your reaction, and smiles,</p>" +
				'<p>"Did you think I am ignorant of the ways of magic? Or that you are a novice ' + perYou.getWitch() + '? People now days dismiss magic as a thing of fairy tales and fiction, but I am a descendant of Lady Elizabeth Ross, a sorceress of power. Some of her secrets were passed down through the years, my sisters ignored these, more interested in school or sex. I did not, especially when I found about some rare crimes of sorcery and that there was no way to prosecute them."</p>' + '<p>She touches her earring, "I am well protected, and I will protect my sisters from slavery, either by a lecherous teacher, or a lustful friend!"</p>' +
				"<p>You try to argue you were just concerned for Amy, but she clearly does not believe your <i>lie</i>.</p>" + '<p style="font-size:small">nothing more available yet for the Ross sisters</p>');
			startQuestions();
			addLinkToPlace(md, "leave the house", 37);
			WritePlaceFooter(md, "", true);
			return true
		}
		if (sType == "charmadele1x1") {
			perCatherine = findPerson("Catherine");
			md = WritePlaceHeader();
			this.setFlag(6);
			this.setFlag(12, false);
			this.showPerson("Setting/adele3.jpg");
			addPlaceTitle(md, "Adele Under A Charm Spell");
			md.write("<p>You recite the spell and Adele looks at you annoyed,</p>" +
				'<p>"I told you before, I am protec...ted...what...you ' + (perYou.isBornMale() ? "bastard" : "bitch") + '! How..."</p>' + "<p>You notice Catherine has entered the room, just dressed in a nightie, looking quite pleased. You decide to try to make things a little easier for them, and tell Adele a lie,</p>" + '<p>"Yes, I worked out how to bypass your protection, so stop questioning how, and accept that you are now my slave!"</p>' + '<p>Catherine cannot help commenting, "Slave to ' + (perYou.isBornMale() ? "his cock" :
					"her pussy") + '!". You look at her a bit annoyed.</p>' + "<p>You look back at Adele and you see she has pulled down the top of her uniform, the spell is taking effect, <b>but</b> you cannot see any effect in her eyes...</p>");
			startQuestions();
			addLinkToPlaceC(md, "Adele struggles...", 436, "type=charmadele1x2");
			AddPeopleColumn(md);
			perCatherine.showPerson(perCatherine.isCharmedBy() ? "catherine-watching1c.jpg" : "catherine-watching1.jpg");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "charmadele1x2") {
			perCatherine =
				findPerson("Catherine");
			md = WritePlaceHeader();
			this.showPerson("Setting/adele4.jpg");
			addPlaceTitle(md, "Adele Under A Charm Spell");
			md.write("<p>Adele knows what is happening to her and is struggling against the spell, trying to ignore you as you try to instruct her and shape the spell. Catherine meanwhile calls out,</p>" + '<p>"Adele, Adele, calm down, it will be fun and you will make a lovely sex-toy!", you look at her, "Catherine, you are not helping!"</p>' + "<p>Adele has been unable to resist part of the effects and has removed some more of her clothing, and she looks at you, a mixture of lust and hatred,</p>" +
				'<p>"I am not a sex-toy, I am a Police ' + getOfficer() + " and I will arrest you for this...but first I have to...No! I do not have to, I am not like 'Cat in Heat' there\". A nickname for Catherine you guess, and then Catherine confirms,</p>" + '<p>"Ice Queen Adele, I told you not to call me that, how about we call you..", and you interrupt, it is for you to shape this, not Catherine,</p>' + '<p>"Enough Catherine, Adele is mine to shape and use as I want"</p>');
			startQuestions();
			addLinkToPlaceC(md, "Adele looks at you with hatred",
				436, "type=charmadele1x3");
			AddPeopleColumn(md);
			perCatherine.showPerson(perCatherine.isCharmedBy() ? "catherine-watching2c.jpg" : "catherine-watching2.jpg");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "charmadele1x3") {
			perCatherine = findPerson("Catherine");
			md = WritePlaceHeader();
			this.showPerson("Setting/adele5.jpg");
			addPlaceTitle(md, "Adele Under A Charm Spell");
			md.write("<p>Adele looks at you in hatred and is about to say something but you stop her,</p>" + '<p>"Quiet slave! Your lust and desire for me is all that matters now. Pleasuring my body is all you need to work on, and your only duty"</p>' +
				"<p>Adele removes more of her clothing, and starts to kneel, reaching out towards your pants, but she pulls back. She is firmly under the spell, but she is still resisting. Again you try to make her submit sexually, but again she almost does but pulls back. You decide you may have to leave it for now.</p>" + '<p>Catherine looks at you seductively, "You can always have me instead! I will talk to Adele and convince her that everything is ok and to accept her place, under you, <i>and me</i>"</p>' + "<p>Alright, it is a matter of time before Adele submits, and Catherine should be able to help, you will have to check back at a later time.</p>");
			startQuestions();
			addLinkToPlaceC(md, '"have" Catherine', 438, "type=catherinefuck");
			addLinkToPlaceC(md, "talk to the sisters", 436);
			AddPeopleColumn(md);
			perCatherine.showPerson(perCatherine.isCharmedBy() ? "catherine-watching3c.jpg" : "catherine-watching3.jpg");
			WritePlaceFooter(md);
			return true
		}
		return false
	};
	per.addPlaceImageLeft = function(lit) {
		if (Place == 436 && this.isHere() && (sType === "" || sType == "gabbyaskadele2" || sType == "gabbyaskadele3")) {
			if (this.isCharmedBy()) {
				gameState.plcTitle = "Adele, your Slave";
				if (this.checkFlag(7)) return this.showPerson("Setting/adele12.jpg",
					"", "", "", "", false, "string");
				else return this.showPerson("Setting/adele6.jpg", "", "", "", "", false, "string")
			}
			if (this.checkFlag(7)) {
				gameState.plcTitle = "Adele is Home";
				return this.showPerson("Setting/adele7.jpg", "", "", "", "", false, "string")
			}
			gameState.plcTitle = "Adele Protecting Her Sisters";
			return this.showPerson("Setting/adele2.jpg", "", "", "", "", false, "string")
		}
		return ""
	};
	per.showPersonTextHere = function(md) {
		if (Place == 436 && sType === "" && this.isHere())
			if (this.isCharmedBy())
				if (this.checkFlag(7)) md.write("<p>Adele is waiting here, naked and accepting of her role in the house.</p>");
				else md.write("<p>Adele is waiting here, looking troubled and completely naked.</p>");
		else if (this.checkFlag(7)) md.write("<p>Adele is home from her duties, and in passing comments,</p>" + '<p>"Hi there ' + perYou.getPersonName() + ', here to see Catherine again? Sorry, Amy is not home, <i>still</i>"</p>');
		else md.write("<p>Adele is still here, barring you from visiting her sisters.</p>");
		else if (Place == 439 && sType === "") {
			if (!this.isHere() && !checkPlaceFlag("CheriseRd", 4)) setPlaceFlag("CheriseRd", 3);
			if (checkPlaceFlag("CheriseRd",
					3) && !checkPlaceFlag("CheriseRd", 4)) {
				md.write('<p style="clear:both">');
				AddImage("UI/books/kybalionbook.jpg", "20%", "left", "", "", undefined, md, "none");
				md.write('Adele has many other books on occult topics but few attract your attention, only one seems possibly interesting, you think you have heard of it, "The Kybalion".</p>')
			}
		}
	};
	per.showPersonChat = function(bGeneral, md) {
		if (Place != 436 && Place != 439 || sType !== "") return;
		if (!checkPersonFlag("Catherine", 11)) return;
		if (this.place !== 900 && !this.checkFlag(12))
			if (this.isCharmedBy())
				if (this.getCharmedLevel() ==
					1) addQuestionR(md, "ask Adele about Amy", "You ask Adele about where is Amy, but she just shakes her head. You are not sure if this means she does not know or will not answer.</p>", "AdeleRoss", "setPersonFlag(\\'AdeleRoss\\',12)");
				else addQuestionR(md, "ask Adele about Amy", "You ask Adele about where is Amy? She answers</p>" + "<p>&quot;" + perYou.getMaster() + ", I have spoken to her on the phone and once in person. She is staying with her employer She claimed to not trust Catherine and was in fear of Mr. Beasley. She asked me to thank you for your help, what-ever it was you did.&quot;</p>" +
					"<p>Alright, you will have to check at the Gym! <b>not implemented</b></p>", "AdeleRoss", "setPersonFlag(\\'AdeleRoss\\',12)");
		else addQuestionR(md, "ask Adele about Amy", "You ask Adele about where is Amy? She answers casually,</p>" + "<p>&quot;Amy? I think she is at work, don't worry she will be home soon&quot;</p>" + "<p>Her memory must be confused, she does not realise Amy has left and seems to be hiding.</p>", "AdeleRoss", "setPersonFlag(\\'AdeleRoss\\',12)");
		if (Place == 439 && checkPlaceFlag("CheriseRd",
				3) && !checkPlaceFlag("CheriseRd", 4) && sType === "") addPopupLinkC(md, "read the book", "The Kybalion", "<p><img src='UI/books/kybalionbook.jpg' style='width:30%;float:right;margin-left:5px' alt='Book'>" + "You pick up the book try reading it, it is hard going! It describes the seven principals of Hermetic Philospphy and should be something you enjoy. Actually you found it uninteresting with clues and glimpses of useful knowledge. Despite this you finish the book and put it down, never to read it again!", false,
			"setPlaceFlag('CheriseRd',4);WaitHere(6)")
	};
	per.handleItem = function(no, cmd) {
		if (cmd != 2) return "";
		if (no == 14)
			if (Place == 186) {
				if (isMurderPath())
					if (!isSpellKnown("Shielded Charm")) addComments("There are a couple of other officers around doing some work on the scene, it is just too public.");
					else addComments("You attempt to cast the spell and nothing happens. You notice the " + getOfficer() + "absently scratch one of her ears and you see a glint of an earring.");
				else addComments("You attempt to cast the spell and nothing happens. You notice the " +
					getOfficer() + " absently scratch one of her ears and you see a glint of an earring.");
				return "handled"
			} else if (Place == 436) {
			var perCatherine = findPerson("Catherine");
			if (this.isHere() && !perCatherine.checkFlag(10)) {
				addComments("You attempt to cast the spell and nothing happens. You notice Adele absently scratch one of her ears and you see a glint of an earring.");
				return "handled"
			}
			if (this.isHere() && perCatherine.checkFlag(10) && !this.isCharmedBy() && !this.checkFlag(7)) {
				CastCharmSpell("AdeleRoss", 436, 1, "type=charmadele1x1");
				return "handled"
			}
			if (this.isHere() && perCatherine.checkFlag(10) && !this.isCharmedBy() && this.checkFlag(7)) {
				if (sType == "trance") CastCharmSpell("AdeleRoss", 436, 4, "type=charmadele2x1");
				else if (!this.checkFlag(9)) {
					dispPlace(436, "type=recharmfail");
					return "nofooterrefresh"
				} else addComments("Once again the spell fails, you will need something different to charm her.");
				return "handled"
			}
		}
		return ""
	};
	per.isPhoneable = function() {
		return this.place == 900 || checkPlaceFlag("Hotel", 11) && Place == 269 && this.isCharmedBy()
	};
	per.callThem =
		function() {
			if (Place == 269) {
				gotoPlace(Place, "type=adelepool");
				receiveCall("", "You call Adele to invite her to join you at the pool for a swim, and she happily agrees.");
				WriteCommentsFooter(bChat, bChatLeft)
			}
			if (isOutside()) {
				gotoPlace(Place, "type=adelecall");
				receiveCall("", "You call Adele, and she answers promptly, promising to be there soon.<br><br>" + "15 minutes later she arrives...");
				WriteCommentsFooter(bChat, bChatLeft)
			} else {
				receiveCall("", "You call Adele but you are getting a bad signal, maybe try again outside?");
				WriteCommentsFooter(bChat, bChatLeft)
			}
		};
	per.addPersonPhoneCall = function() {
		if (Place != 436 && Place != 438 && this.checkFlag(6) && !this.checkFlag(7) && Math.random() < .1 && getHour() < 9 && getHour() > 6 && this.hoursCharmed() > 9)
			if (makeCall(true, 166)) {
				this.unCharmThem();
				this.setFlag(7);
				this.setFlag(12, false)
			}
		if (Place != 436 && Place != 438 && this.checkFlag(10) && !this.checkFlag(11))
			if (makeCall(true, 167)) this.setFlag(11);
		return false
	}
}

function initialiseAlison() {
	addPerson("Alison", 0, "Alison");
	per.getPersonName = function(full) {
		if (full === true) return this.name;
		return this.isCharmedBy() ? "Alison, Your Fuckbuddy" : "Alison, Your Waitress"
	};
	per.isPersonInfo = function() {
		return this.place != 435
	};
	per.getPersonInfo = function() {
		var s = "<p><img src='Images/People/Alison/" + (this.isCharmedBy() ? "alison2a" : "alison1a") + ".jpg' style='width:30%;float:right;margin-left:5px' alt='Alison'>Alison, the waitress of the Bavaria Hut who works the weekend shifts, ";
		if (this.isCharmedBy()) return s + "your fuckbuddy.";
		else return s + "the beautiful weekend idol of the restaurant."
	};
	per.whereNow = function() {
		if (this.place === 0) return 0;
		var d = getDay(true);
		if (this.isCharmedBy()) {
			if (d == "Sat" || d == "Sun") {
				if (!isShopOpen(4, 0, true)) return 0;
				if (Place == 203) return Place;
				return this.place
			} else if (d == "Tues" || d == "Thurs")
				if (isShopOpen(4, 2, true) && getHour() > 11 && !this.checkFlag(2)) return 435;
			return 0
		} else {
			if (!isShopOpen(4, 0, true)) return 0;
			if (d != "Sat" && d != "Sun" && this.place != 435) return 0
		}
		if (Place ==
			203) return Place;
		return this.place
	};
	per.isPlaceImageRight = function() {
		return Place == 435 && this.whereNow() == 435
	};
	per.showPlaceImageRight = function(md) {
		if (this.place == 435) this.showPerson("alison0b.jpg");
		else this.showPerson("alison-gym1.jpg")
	};
	per.showEventPopup = function() {
		if (sType !== "") return false;
		if (getHour() == 12) this.setFlag(2, false);
		if (Place == 435 && this.place === 0 && getPersonOther("Jenny") > 0) {
			var d = getDay(true);
			if (d != "Sat" && d != "Sun") {
				this.place = 435;
				setPersonFlag("Jenny", 3);
				showPopupWindow("I Love Gyms",
					"<img src='Images/People/Alison/alison0a.jpg' style='width:34%;float:right;margin-left:5px' alt='Cute'>" + "A really hot woman flashes you a smile as you are walking through the gym. She has a curvy figure and has a number of tatoos. She is older than you, but that does not matter, she is hot!<br><br>" + "You take a step towards her but before you get close another young woman speaks to her,<br>" + "\"Enough flirting sister, remember you have that interview for the weekend shift at the Bavaria Hut soon. You had better get the job, you can help me to 'meet' that blonde hottie working there...\"<br><br>" +
					"The woman looks annoyed at her friend and then smiles at you regretfully and shakes her head. She starts to work-out, wanting to finish her session before she has to leave for her appointment. You will have to see if she gets her new job.");
				return true
			}
		}
		return false
	};
	per.showEvent = function() {
		var md;
		if (this.place == 435 && Place != 435) this.place = 196;
		else if (Place == 269 && sType == "alisonpool") {
			WaitHereOnly(4);
			md = WritePlaceHeader();
			this.showPerson("alison-pool.jpg");
			addPlaceTitle(md, "Swimming with Alison");
			md.write('<p>Alison joins you wearing a lovely bikink and she sitd sone and asks, well tells you, "Hey cutie, model for me your sexy figure!". You plans were the other way round, but Alison always takes the lead, and it do not matter really, so you make a play of posing for her.</p>' + '<p>She comments, "Nice, now how about I model for you but in something less...more naked"</p>');
			startQuestions();
			addLinkToPlaceC(md, '"Of course!"', Place, "type=alisonpoolsex");
			addLinkToPlaceC(md, "say goodbye to Alison",
				Place, "", "Alison looks a bit annoyed that you do not take it further, and leaves you alone at the pool");
			WritePlaceFooter(md);
			return true
		}
		if (Place == 269 && sType == "alisonpoolsex") {
			md = WritePlaceHeader(false, "td-left-med");
			this.showPerson("alison-pool-sex.jpg");
			addPlaceTitle(md, "Being Discrete and Private with Alison");
			md.write("<p>You ask your nervous librarian to play with you more privately, and she seductively removes most of her bikini, ready for you!</p>");
			startQuestions();
			addLinkToPlaceC(md, "later...say goodbye to Alison",
				Place);
			WritePlaceFooter(md);
			return true
		} else if (Place == 203 && this.isHere())
			if (sType == "bj" || sType == "fuck" || sType == "titsfuck") {
				this.setFlag(2);
				md = WritePlaceHeader(false, isExplicit() ? "" : "td-left-large");
				if (sType == "bj")
					if (perYou.isMaleSex()) {
						this.showPersonRandomRorX("alison6b", isExplicit() ? 2 : 1);
						addPlaceTitle(md, "An Energetic Chat");
						md.write("</p><p>You instead ask Alison to use her mouth to pleasure you. She eagerly agrees and she is not inexperienced and skillfully pleasures you until you release into her mouth. She happily swallows as the good slave she is.")
					} else {
						this.showPersonRandomRorX("alison6g",
							2);
						addPlaceTitle(md, "An Energetic Chat");
						md.write("</p><p>You accept Alison' suggestion and ask her to use her fingers and tongue to pleasure you. To your surprise and delight she appears quite skilled at this and you enjoy her attentions until you cry out your pleasure.")
					}
				else if (sType == "fuck") {
					this.showPersonRandomRorX("alison5b", isExplicit() ? 2 : 1);
					addPlaceTitle(md, "An Energetic Chat");
					md.write("</p><p>You accept Alison's offer, and you energetically discuss matters of your cock and her pussy.</p>")
				} else if (sType ==
					"titsfuck") {
					if (isExplicit()) this.showPerson("alison7b.jpg");
					else this.showPersonRandomX("alison7b", 2);
					addPlaceTitle(md, "An Energetic Chat");
					md.write("<p>You ask Alison to play with her tits, but instead she plays with them around your cock, once again taking control, but you your considerable pleasure.</p>")
				}
				md.write("<p>Afterwards Alison chats with you on less sexual matters but she avoids discussing her mother or chants before she has to leave and return to work.</p>");
				startQuestions();
				addLinkToPlace(md,
					"exit the restaurant", 194);
				WritePlaceFooter(md);
				return true
			} else if (sType == "chant") {
			md = WritePlaceHeader();
			this.showPerson("alison2c.jpg");
			addPlaceTitle(md, "Alison's Chant");
			md.write("<p>You ask Alison about the chant she used that she said her mother taught her. She looks at you with some mixed feelings,.</p>" + '<p>"If we must, I am sure there is something else we could be doing orally of more interest."</p>' + "<p>She avoids talking about her mother and instead just recites the chant to you as best as she can remember. She definitely has it a little garbled in places, the words are wrong so you have to concentrate on her words.</p>");
			if (!perYou.canUseExperience(true)) md.write("<p>Trouble is you cannot quite work out what it should be. You just cannot concentrate with this beautiful woman in front of you, but probably it is more you are just not experienced enough with magic to work it out. Once you have practiced more with magic maybe you should return and try again.</p>");
			else {
				perYou.setFlag(18);
				perYou.extra[11] += 9;
				md.write("<p>That is it, you have worked out the words and you think they are a way to summon mana you have to block a spell cast on you. It requires you to have a substantial reserve of mana, at least 20 points. What she actually said may of been a slight protection, or maybe she just did not have the mana before.</p>")
			}
			md.write("<p>Alison looks at you a little impatiently,</p>" +
				'<p>"Enough fucking around with this, let\'s actually fuck around! You want to pick how?"</p>');
			startQuestions();
			addLinkToPlace(md, "exit the restaurant", 194);
			updateRightBar();
			WritePlaceFooter(md);
			return true
		} else if (sType == "charmalison1") {
			md = WritePlaceHeader();
			this.showPerson("alison3.jpg");
			addPlaceTitle(md, "Alison Under a Spell?");
			md.write('<p>You cast the charm spell on Alison, and she just smiles brightly at you and says "Just a minute", and steps over to the bar. She exchanges a few words and you hear something about taking a break. A moment later a young man steps out the back and starts serving the tables.</p>' +
				"<p>Alison returns to you, takes you by the hand and leads you into a small room at the back. It is a brightly lit store area, but it also seems to double as a change room. There is a large couch there and she sits you down. As you do she rearranges her top, exposing her breasts. Alright, the spell must be affecting her and you start to tell her about how she dreams about submission as the start of making her your slave. Alison smiles and laughs,</p>" + '<p>"Very funny, we came here because I wanted to, now you are a cute ' +
				perYou.getSex() + " and you like me. I like you, while I am not asking to date you, yet, for now let's be fuckbuddies. I have some free time and all this running around flashing my cleavage and panties at the customers really turns me on.\"</p>" + "<p>Ummm, what is happening, is she actually under the effects of the spell? Her eyes have changed, but she is not reacting otherwise, unless this offer of being fuckbuddies is part of the arousal the spell causes? You try to exert some control here and talk about being your girlfriend, how she wants to date you...and she interrupts,</p>" +
				'<p>"Look cutie, I barely know you but I want you. Don\'t put words in my mouth, but you are welcome to put something else there"</p>' + "<p>Well, this is strange, she is under the spell, you think, but your words mean nothing. She is though willing and ready to fuck your brains out...</p>");
			startQuestions();
			addLinkToPlaceO(md, "Alison starts to strip...", 203, "type=charmalison2");
			WritePlaceFooter(md);
			return true
		} else if (sType == "charmalison2") {
			md = WritePlaceHeader();
			this.showPerson("alison4.jpg");
			addPlaceTitle(md,
				"Alison Under a Spell, Probably");
			md.write("<p>Alison stands, but doing do in such a way to show off her figure and her delicious ass,</p>" + "<p>\"Don't get me wrong cutie, I'm not some kind of nympho, it is just today has been particularly stimulating. I do not want to ride this issue of dating, I would prefer to be riding your " + (perYou.isMaleSex() ? "cock" : "face") + ' now."</p>' + "<p>Right? The spell has affected her, she is just very resistant in some way. As you think this Alison looks at you,</p>" +
				'<p>"Come on cutie, if you are not turned on yet let me dance a little for you. Tell me about yourself a bit, the potted summary"</p>' + "<p>You tell her a little, your name, about your interest in Kurndorf and the cults and Alison brightly interrupts again,</p>" + '<p>"When I was a girl I loved that stuff, my Mum too, she always talked about occult stuff, but it was beyond me. Mental disciplines blah blah blah, psychic defences blah blah blah, save your virginity till marriage blah blah blah. I grew out of it once she...left...Anyway, enough for now, it\'s time!"</p>');
			startQuestions();
			addLinkToPlaceC(md, 'Time you ask? "Time to fuck" she says', 203, "type=charmalison3");
			WritePlaceFooter(md);
			return true
		} else {
			if (sType == "charmalison3") {
				this.setFlag(2);
				md = WritePlaceHeader(false, !isExplicit() ? "td-left-large" : "");
				this.showPersonRandomRorX(perYou.isMaleSex() ? "alison5b" : "alison6g", isExplicit() ? 2 : perYou.isMaleSex() ? 1 : 2);
				addPlaceTitle(md, "Alison Under a Spell-ish");
				if (perYou.isMaleSex()) md.write('<p>Alison steps over and starts to pull down your trousers telling you "It\'s time to get to the point, your point cutie".</p>' +
					'<p>In short order you are unclothed enough and Alison mounts herself on you, riding you and fucking herself on you. While she is very skilled and it feels wonderful, she is firmly in control. At one point you try to exert some control yourself, but she moans "No, no, let me, I\'m the experienced older woman..."</p>');
				else md.write('<p>Alison steps over and starts to pull down your pants telling you "It\'s time to get to the nub of this matter, your nub cutie".</p>' + '<p>In short order you are unclothed enough and Alison hesitates, "Cutie, I am the experienced older woman, so let me show you some tricks. You can replay me another time". She plays with and licks you, and has you mount her face as she lick you urgently. Despite this or because of this, she is firmly in control of your passion and hers.</p>');
				md.write("<p>A little before the end, both yours and hers, you hear her whisper some incoherent words, but to your surprise they sound like the strange words in the Book! Your attention is distracted from the words by urgent feelings...</p>" + "<p>Afterwards she is sitting straddling your lap and kissing you. You pull back and ask about the words,</p>" + '<p>"Those are a little chant my mother taught me, I am not sure what it was for, but it makes things really nice, doesn\'t it cutie?"</p>' + '<p>You have to agree and try to ask more but she kisses you and then stands and starts dressing, "I\'ve really got to get back to my shift. Come and visit for a another break anytime.". She gestures to a door, "You can take the side door if you want to avoid the crowd in the restaurant, see you!" She finishes dressing, flashes you a smile and returns to the restaurant.</p>' +
					"<p>Those words...did they protect her a little...she is definitely under the spell, but she is no lust-filled slave, well maybe lust-filled but the spell may not be responsible for that!</p>");
				startQuestions();
				addLinkToPlace(md, "exit the restaurant", 194);
				WritePlaceFooter(md);
				return true
			}
		} else if (sType == "alisoncatherine1" || Place == 436 && checkPersonFlag("AdeleRoss", 6) && isWeekDay() && !isDay() && this.isCharmedBy() && !this.checkFlag(4) && sType === "") {
			this.setFlag(4);
			setQueryParams("type=alisoncatherine1");
			var perAdele =
				findPerson("AdeleRoss");
			md = WritePlaceHeader();
			if (perAdele.isCharmedBy()) perAdele.showPerson("Setting/adele12.jpg");
			else perAdele.showPerson("Setting/adele6.jpg");
			addPlaceTitle(md, "Adele but no Catherine");
			if (perAdele.isCharmedBy()) md.write("<p>Adele is sitting reading as you enter the house, completely naked as you had ordered. She immediately puts her book down and stangs to pose for you. She gestures toward Catherine's room,</p>" + "<p>" + perYou.getMaster() + ' I am ready for your commands, but Catherine is currently enjoying herself with a friend, or a stranger most likely. She told me to join them but this is for you to choose, not her"</p>' +
				"<p>You can see she is still resisting Catherines advances, this is something you will have to address later.</p>");
			else md.write("<p>Adele is sitting reading a book as you enter the house. She waves to you, and says with a slight sound of frustration in her voice,</p>" + "<p>\"If you are here to see Catherine she is currently 'entertaining' a friend or more likely a stranger she picked up, <i>again</i>. It's her hobby, but I would of appreciated her not inviting me to join then...\"</p>" + "<p>She glances towards Catherine's room and returns yo reading, but you see a flush on her cheeks.</p>");
			md.write("<p>You know Catherine will not mind if you watch, join in, or leave them alone.</p>");
			startQuestions();
			addLinkToPlaceC(md, "check Catherine's room", 438, "type=alisoncatherine2");
			if (perAdele.getCharmedLevel() == 4) addLinkToPlaceC(md, "forget it and visit Adele's room", 439);
			addLinkToPlace(md, "forget it, leave the house", 37);
			WritePlaceFooter(md);
			return true
		} else if (Place == 438 && sType == "alisoncatherine2") {
			md = WritePlaceHeader(false, "td-left-med");
			this.showPerson("alisoncatherine1a.jpg");
			addPlaceTitle(md,
				"Catherine and Alison");
			md.write("<p>You quietly enter Catherine's room intending to check what is happening. Whle Catherine will not mind, whoever she is with might object to your presence. To your surpise you see Alison, she is in the process of stipping off Catherine's clothing. Catherine is enjoying herself and does not notice you but Alison does and calls out,</p>" + '<p>"Hi there Cutie! You know Catherine too?", Catherine looks over and says "' + perYou.getPersonName() + ' you also know Alison, is she one of yours or are you another of her fuckbuddies?"</p>' +
				'<p>You tell her "Both!" and Alison laughs,</p>' + '<p>"Well, whatever that means! So we all know each other, let\'s <i>know</i> each others brains out! Or if you want sit back and enjoy the show!"</p>' + "<p>It had not crossed your mind before, Alison and Catherine have a lot in common, both have a <i>very</i> healthy sex-drive and of course <b>you</b>. Well do you want to join them or watch these two beautiful women?</p>");
			startQuestions();
			addLinkToPlaceC(md, "watch them", 438, "type=alisoncatherine3");
			addLinkToPlaceC(md, "join them", 438, "type=alisoncatherine4");
			addLinkToPlace(md, "leave them and the bedroom", 436);
			addLinkToPlace(md, "leave them and the house", 37);
			WritePlaceFooter(md);
			return true
		} else if (Place == 438 && sType == "alisoncatherine3") {
			md = WritePlaceHeader();
			this.showPerson("alisoncatherine1b.jpg");
			addPlaceTitle(md, "Watching Catherine and Alison");
			md.write("<p>You tell them that you would like to watch this time, and Alison shrugs,</p>" + '<p>"Your loss, jump in and grab some ass if you change your mond"</p>');
			startQuestions();
			addLinkToPlace(md, "leave the bedroom", 436);
			addLinkToPlace(md, "leave the house", 37);
			WritePlaceFooter(md);
			return true
		} else if (Place == 438 && sType == "alisoncatherine4") {
			md = WritePlaceHeader(false, perYou.isMaleSex() && isExplicit() || !perYou.isMaleSex() ? "td-left-large" : "");
			if (perYou.isMaleSex()) this.showPersonRorX("alisoncatherine1c.jpg");
			else this.showPerson("alisoncatherine1d.jpg");
			addPlaceTitle(md, "Joining Catherine and Alison");
			md.write("<p>That is a no-brainer, you shed your clothes and join the beautiful pair.</p>");
			startQuestions();
			addLinkToPlace(md, "leave the bedroom", 436);
			addLinkToPlace(md, "leave the house", 37);
			WritePlaceFooter(md);
			return true
		} else if (Place == 435) {
			if (sType == "chant") {
				md = WritePlaceHeader();
				this.setFlag(2);
				this.showPerson("alison-gym2.jpg");
				addPlaceTitle(md, "Alison's Chant");
				md.write("<p>You ask Alison about the chant she used that she said her mother taught her. She looks at you with some mixed feelings,.</p>" + '<p>"If we must, I am sure there is something else we could be doing orally of more interest."</p>' +
					"<p>She avoids talking about her mother and instead just recites the chant to you as best as she can remember. She definitely has it a little garbled in places, the words are wrong so you have to concentrate on her words.</p>");
				if (!perYou.canUseExperience(true)) md.write("<p>Trouble is you cannot quite work out what it should be. You just cannot concentrate with this beautiful woman in front of you, but probably it is more you are just not experienced enough with magic to work it out. Once you have practiced more with magic maybe you should return and try again.</p>");
				else {
					perYou.setFlag(18);
					perYou.extra[11] += 9;
					md.write("<p>That is it, you have worked out the words and you think they are a way to summon mana you have to block a spell cast on you. It requires you to have a substantial reserve of mana, at least 20 points. What she actually said may of been a slight protection, or maybe she just did not have the mana before.</p>")
				}
				md.write("<p>Alison looks at you a little impatiently,</p>" + '<p>"Enough fucking around with this, let\'s actually fuck around!"</p>');
				startQuestions();
				addLinkToPlace(md, "exit the gym", 37);
				updateRightBar();
				WritePlaceFooter(md);
				return true
			}
			if (sType == "gymsex") {
				this.setFlag(2);
				md = WritePlaceHeader();
				if (perYou.isMaleSex()) this.showPersonRandomRorX("alison-gym3b", 2);
				else if (isExplicit()) this.showPersonRandomX("alison6g", 2);
				else this.showPersonRandom("alison-gym3b", 2);
				addPlaceTitle(md, "An Energetic Break");
				md.write("<p>You ask Alison if she is up for a break and she replies");
				if (perYou.isMaleSex()) md.write(" looking at you groin,</p><p>\"Sure cutie, as long as you are 'up' as well!\"</p>");
				else md.write(',</p><p>"Sure, anytime cutie!"</p>');
				md.write("<p>You try to find a secluded area in the gym, though Alison does not really seem to care if anyone or everyone watched. You try to have her keep her cries of passion down, but it seems to encourage her to become more enthusiastic and 'pornstar' like.</p>" + '<p>Afterwards, Alison gives you a kiss, "I have had plenty of a work-out, see you for another, here or at work!"</p>');
				startQuestions();
				addLinkToPlace(md, "exit the gym after her", 37);
				WritePlaceFooter(md);
				return true
			}
		}
		return false
	};
	per.passTimeDay = function() {
		this.setFlag(2, false);
		return ""
	};
	per.handleItem = function(no, cmd) {
		if (no == 14 && cmd == 2) {
			if (Place == 435 && this.place == 435) {
				addComments("She is certainly cute, but what is her name again? The spell will not work if you do not know her name.");
				return "handled"
			}
			if (Place == 196 && this.isHere()) {
				if (!isSpellKnown("Shielded Charm")) addComments("Don't cast the spell here.  Its too public.");
				else if (!this.checkFlag(1)) addComments("You do not know her name, so the spell will not work.");
				else CastCharmSpell("Alison", 203, 1, "type=charmalison1");
				return "handled"
			}
			if (Place == 203 && this.isHere()) {
				if (!this.checkFlag(1)) addComments("You do not know her name, so the spell will not work.");
				else CastCharmSpell("Alison", 203, 1, "type=charmalison1");
				return "handled"
			}
		}
		return ""
	};
	per.addPlaceImageLeft = function(lit) {
		if (Place == 203 && this.isHere() && sType === "") {
			if (this.isCharmedBy()) return this.showPerson("alison2b.jpg", "", "", "", "", false, "string");
			return this.showPerson("alison1b.jpg", "", "", "", "", false, "string")
		}
		if (Place ==
			196 && this.isHere()) {
			if (this.isCharmedBy()) return this.showPerson("alison2a.jpg", "", "", "", "", false, "string");
			return this.showPerson("alison1a.jpg", "", "", "", "", false, "string")
		}
		return ""
	};
	per.showPersonTextHere = function(md) {
		if (Place == 203 && this.isHere())
			if (this.isCharmedBy()) {
				md.write("<p>The back room is a small storeroom and break area, well lit with some large windows and a large couch/collapsible bed. Alison flashes you her bright smile and asks,</p>" + '<p>"Hi there ' + perYou.getPersonName() + ' did you want to have a chat, or me?"</p>' +
					"<p>She seems to have already decided your answer as she starts stripping off her clothing.</p>");
				if (!perYou.checkFlag(18)) md.write("<p>You are reminded by the chant she used when you first...chatted...with her.</p>")
			} else md.write("<p>Alison asks you to step into a small backroom to discuss this out of the noise of the restaurant.</p>" + '<p>"Sorry about this ' + perYou.getPersonName() + ', here have a free replacement"</p>' + "<p>She gives you another bratwurst to replace the one you were given. She takes the old one and puts it way, probably in a bin.</p>");
		else if (Place == 196 && this.isHere())
			if (this.isCharmedBy()) {
				md.write("<p>You enter the Bavaria Hut and you notice Alison is waiting on customers, the restaurant is still busy.</p>" + "<p>When she sees you, she flashes you a bright smile, and joins you as soon as she finished her current order. She gives you a quick flash of her tits, and whispers to you, ");
				if (!this.checkFlag(2)) md.write('"I can take a quick break ' + perYou.getPersonName() + " so we can have a chat, and maybe something else. The restaurant is so busy recently, let's go to the backroom.\"</p>");
				else md.write('"Sorry I can\'t take another break, I am allowed one in the morning and one in the afternoon. We can have a chat and you know another time"')
			} else md.write("<p>You enter the cafe and look around for a seat. The restaurant is very busy, they have some sort of promotion on and just about every table is full.</p> " + "<p>The waitress approaches you from the front of the restaurant.</p>");
		else if (Place == 435)
			if (this.place == 435) md.write("<p>The woman you almost met is just finishing up her work-out with her friend.</p>");
			else if (this.isHere()) md.write("<p>Alison is taking a break from her work-out, and she invites you to join her.</p>")
	};
	per.showPersonChat = function(bGeneral, md) {
		if (Place == 203 && this.isHere()) {
			if (this.isCharmedBy() && (sType === "" || sType == "chant")) {
				if (sType != "chant" && !perYou.checkFlag(18)) addLinkToPlaceC(md, '"Ask about the chant"', 203, "type=chant");
				if (perYou.isMaleSex()) {
					addLinkToPlaceC(md, '"You"', 203, "type=fuck");
					addLinkToPlaceC(md, '"Your breasts"', 203, "type=titsfuck");
					addLinkToPlaceC(md, '"Let\'s chat in a different way"',
						203, "type=bj")
				} else addLinkToPlaceC(md, '"You"', 203, "type=bj")
			}
		} else if (Place == 196 && this.isHere())
			if (this.isCharmedBy()) {
				if (!this.checkFlag(2) && sType === "") addLinkToPlaceC(md, '"Have a break?"', 203)
			} else if (sType === "" && !this.checkFlag(1)) addPopupLinkC(md, "talk to the waitress", "Your Waitress, Alison", "<img src='Images/People/Alison/alison0c.jpg' class='imgpopup' alt='Alison'>" + "As you approach you recognise the waitress as the young woman you saw in the Gym, so she did get the job!<br><br>" + 'She smiles at you brightly, "We meet again, I am Alison and I will be your waitress, or at least I will be when a table opens up. I think table 6 will be free in 5 or 10 minutes. Why not take a seat at the bar and have a drink on the house while you wait"<br><br>' +
			"She is very cheerful and you think she is actually interested in you, or she is a very good waitress. Then again from the Gym before she did look interested, and interesting.<br><br>" + "You take a seat at the bar for a little, but ignore the offer of a drink, more thinking about other things Alison could offer you.", false, "setPersonFlag('Alison', 1);dispPlace();");
		else {
			if (getPersonOther("Jenny") >= 3) addLinkToPlaceC(md, '"There was something wrong with the bratwurst I bought..."', 203)
		} else if (Place ==
			435 && this.isHere() && this.isCharmedBy()) {
			if (sType != "chant" && !perYou.checkFlag(18)) addLinkToPlaceC(md, '"Ask about the chant"', Place, "type=chant");
			addLinkToPlaceC(md, '"Alison, Let\'s take a break"', Place, "type=gymsex")
		}
	};
	per.isPhoneable = function() {
		return checkPlaceFlag("Hotel", 11) && Place == 269 && this.isCharmedBy()
	};
	per.callThem = function() {
		if (Place == 269)
			if (this.whereNow() == 196) WriteComments("You call Alison to invite her to join you at the pool for a swim, but someone else picks up and says Alison is busy serving customers and for you to call back later.");
			else {
				gotoPlace(Place, "type=alisonpool");
				receiveCall("", "You call Alison to invite her to join you at the pool for a swim, and she answers conifdently, \"I'd love to see you in your swimwear, I'll be there\".");
				WriteCommentsFooter(bChat, bChatLeft)
			}
	};
	per.addPersonPhoneCall = function() {
		if (!this.checkFlag(3) && this.isCharmedBy()) {
			if (makeCall(true, 130)) this.setFlag(3)
		} else if (this.isCharmedBy() && !this.checkFlag(5) && this.whereNow() == 435)
			if (makeCall(true, 131)) this.setFlag(5);
		return false
	};
	per.getPersonSMS =
		function(id) {
			if (id == 130) return receiveSMS("Alison", "Hey cutie, like this picture I took on my last holiday!", "alisonsms1.jpg");
			if (id == 131) return receiveSMS("Alison", "Hey cutie, I'm working out, I do a couple of times a week, why not join me and work up a sweat!", "alisonsms2.jpg");
			return ""
		}
}

function initialiseAmyRoss() {
	addPerson("Amy Ross", 0, "Amy");
	per.getPersonAddress = function() {
		return "5 Cherise Rd, Glenvale"
	};
	per.visitThem = function() {
		this.extra[0] = nTime
	};
	per.showEventPopup = function() {
		if (sType !== "") return false;
		if (Place == 435 && !this.checkFlag(2) && !this.checkFlag(1) && !this.isCharmedBy("MrBeasley")) {
			this.setFlag(2);
			this.visitThem();
			showPopupWindow("Amy", "<img src='Images/People/Amy/amy0.jpg' style='position:absolute;width:100%;bottom:0' alt='Amy'>" + "</p><p style='position:absolute;top:5%;left:1%;cursor:pointer;line-height:0.9em'><b>The gym is busy at the moment, then again it is always busy. There is the sound of grunts and some music in another room, probably 'Eye of the Tiger'.<br><br>" +
				"You see to one side your friend Amy from school. She works here part-time running simple classes or working at the desk. She does not get very much money but gets a free membership and unrestricted use of the gym for her family.<br><br>" + "While you have never dated Amy and she is strictly a friend, you can still admire the view as she works out!</b>", undefined, "background-color:#8FC1C0;padding:0 0 0 0");
			return true
		}
		return false
	};
	per.addPersonPhoneCall = function() {
		if (nTime - this.extra[0] > 25 && this.checkFlag(2) &&
			!this.checkFlag(3))
			if (makeCall(true, 30)) this.setFlag(3);
		return false
	};
	per.getPersonSMS = function(id) {
		if (id == 30) return receiveSMS("Amy", "Here I am with my last client. She asked about special services, stop telling people that", "amysms1.jpg") + receiveSMS("Amy", "Oops &#128517; sorry " + perYou.getPersonName() + " I sent last 2 wrong no 2 yours. A job thing pls delete &#128540;") + replyToSMS("ok but was that Kates mum") + receiveSMS("Amy", "Yeah a massage at home &#128513; delete ok you know private");
		return ""
	}
}

function RepliesAngela(nR) {
	var bCharm = per.isCharmedBy();
	var myName = per.getYourNameFor();
	if (nR == 100) {
		per.setFlag(7);
		if (bCharm) {
			setPlaceKnown("JohnAdamsOffice");
			addComments('"' + myName + ' it is down that hall, second left and 3rd door on the right!"');
			if (wherePerson("Tess") == 230) {
				setPlaceKnown("AdamsHouse");
				addComments('"' + myName + ' if you were after the lovely Mrs. Adams, she left last night to return home. I believe she might still be there."</p><p>Angela then gives you the address, on Rathdown Rd. not far from the Broken Inn Hotel')
			}
		} else addComments('"I am sorry, unless you have an appointment I cannot help you, and Mr. Adams has told me he is not accepting appointments for the indefinite future.')
	} else if (nR ==
		101) {
		addComments('You ask Angela for John Adam\'s home address, and she quickly looks it up and shows you the address one her computer screen "2121 Rathdown Rd, Glenvale"');
		setPlaceKnown("AdamsHouse")
	} else if (nR == 702) {
		per.setFlag(9);
		if (perYourBody.FindItem(5) === 0) PlaceI(5, 141);
		if (!isPlaceKnown("SacredClearing")) setPlaceKnown("SacredClearing");
		addComments('"Let me look up the historical files, ' + myName + ".  Here is something. According to these records a sacred clearing is located near " + perGates.getPersonNameShort() +
			"' estate. The sacred clearing was once a place of devil worship. You could try there, " + myName + '."')
	} else if (nR == 800) {
		per.other = 1;
		addComments('"Hello ' + myName + '. Please state your business. We are very busy here and I have no time to waste. Do you have any questions about the town?"')
	} else if (nR == 801) {
		if (!bCharm) addComments('"My business is none of your business, but if you must know, I am the personal assistant of Mayor Thomas."');
		else addComments('"' + myName + ', I am the personal assistant of Mayor Thomas."');
		per.other = 2
	} else if (nR == 802) {
		if (!bCharm) addComments('"There is absolutely nothing strange about this town. If there is any criminal activity then I suggest that you');
		else addComments('"If there is any criminal activity, ' + myName + ", then you may wish to");
		addComments(' contact the police. The police station is nearby." and she gives <i>very</i> brief directions to get there.');
		per.other = 3;
		if (!isPlaceKnown("PoliceStation")) setPlaceKnown("PoliceStation")
	} else if (nR == 1600) {
		if (!bCharm) addComments('"Mayor Thomas is out at the moment. If you leave me your details and why you need to see her I will organise a meeting for you. I will call you when the meeting is possible."');
		else addComments('"Mayor Thomas is out at the moment, ' + myName + ".  I'll set up a meeting as soon as she returns.  I'll make up a reason, and call when you can get in to see her.\" she says, winking.");
		setPersonOther("Mayor", 1)
	} else if (nR == 2600) {
		setPlaceKnown("CelesteRd");
		setPlaceKnown("AngelasApartment");
		addComments('"Oh, ' + myName + ', it is apartment 9 at the Celeste Apartments, please come and visit any evening!"')
	} else if (nR == 4201) {
		addComments('"Of course, ' + myName + ". City Hall has plans on all municipal buildings.  There is a " +
			sCurrency + '30 duplication fee, of course."');
		setPlaceFlag("Hotel", 2)
	} else if (nR == 4202) {
		setPlaceFlag("Hotel", 3);
		if (!bCharm) addComments('"I am sorry but that is the price for planning permits. If there is nothing else, then I suggest you leave this office."');
		else {
			addComments('"Please, forgive my disobedience, my love.  I... I mean... ' + perYou.getMaster() + ",\" she says, realizing her true role in your 'relationship'.");
			if (perYourBody.FindItem(23) === 0) {
				per.charmThem(4);
				perYourBody.PutItem(23);
				setPlaceFlag("Hotel",
					4)
			}
		}
	} else if (nR == 4203) {
		setPlaceFlag("Hotel", 3);
		addComments('"Of course, my love!" she says, and hands the plans over to you with a kiss.');
		if (perYourBody.FindItem(23) === 0) {
			perYourBody.PutItem(23);
			setPlaceFlag("Hotel", 4)
		}
	} else if (nR == 4230)
		if (nMoney < 30) addComments("\"I'm afraid there's not enough here to cover the " + sCurrency + "30 fee.  I'm sorry, " + myName + '."');
		else {
			addComments('"Thank you, ' + myName + '." She says, filing away your ' + sCurrency + '30. "Here is your copy of the Broken Inn Hotel Plans."');
			if (perYourBody.FindItem(23) === 0) {
				AddCash(-30);
				perYourBody.PutItem(23);
				setPlaceFlag("Hotel", 4)
			}
		}
	else if (nR == 999)
		if (!bCharm) addComments('"I\'m sorry?" she says, not at all happy with your attitude. "As I told you before, there is a ' + sCurrency + '30 fee for the plans.  Now, if there is nothing else, please leave."');
		else {
			addComments('"Of course' + myName + '. I have the plans right here."');
			perYourBody.PutItem(23)
		}
	return true
}

function initialiseAngela() {
	addPerson("Angela", 95, "Angela", "Small");
	per.Replies = RepliesAngela;
	per.getPersonAddress = function() {
		return isPlaceKnown("AngelasApartment") ? "Apartment 9, 42 Celeste Rd" : ""
	};
	per.getPersonName = function(full) {
		if (full === true) return this.name;
		var clv = this.getCharmedLevel();
		if (clv > 0) {
			if (clv == 4) return "Angela Enslaved";
			return "Angela Enamoured"
		} else return "Angela at Reception"
	};
	per.getPossessionFace = function() {
		return "!angela-face"
	};
	per.whereNow = function() {
		if (!isShopOpen(0)) return 460;
		if (Place == 97) return true;
		return this.place
	};
	per.isPersonInfo = function() {
		return true
	};
	per.getPersonInfo = function() {
		switch (this.getCharmedLevel()) {
			case 0:
				return "<img src='Images/People/Angela/Small/angela1b.jpg' style='width:30%;float:right;margin-left:5px' alt='Angela'>" + "Angela, the secretary to Mayor Thomas. A dark haired beauty, her stiff and serious appearance tells you that she's the type of girl who lives for her work. However you feel aroused just by looking at her, Angela's soft and slim body makes you fantasize about having her as your own secretary.";
			case 4:
				return "<img src='Images/People/Angela/Small/angela8a.jpg' style='width:40%;float:right;margin-left:5px' alt='Angela'>" + "Making her your slave was a great idea. Not only that she can support you with any kind of information you need on basically anything via the database she has on the computer but her being the secretary to the Mayor means that she knows every news and rumours around town.<br><br>" + "Not even mentioning that she\u2019s an eager little slave who\u2019s pretty good in bed too. Now she\u2019s patiently sitting on the chair, her ass up in the air just as you like it. She knows her place and job and she does them flawlessly.";
			default:
				return "<img src='Images/People/Angela/Small/angela8c.jpg' style='width:40%;float:right;margin-left:5px' alt='Angela'>" + "Angela, your ever loving girlfriend ( well, one of the many girlfriends ) is waiting at her desk when you arrive at the Mayor\u2019s office. She told you last time that she can\u2019t focus on her work anymore, her mind is always filled thoughts of you. You asked her to work for you instead of the Mayor and do your paperwork and bills, but still hold the position she has as the  head secretary of the office, because she can provide you with valuable information here.<br><br>" +
					"She was disappointed at first, but she understood that you can\u2019t be always with her. When she sees you now, she bursts into a big laugh and assumes the position that you like the best; her ass up in the air. So all you have to do is reach out and touch her."
		}
	};
	per.addPlaceImageLeft = function(lit) {
		if (Place == 97 && isShopOpen(0) && sType === "") return this.showPersonRandom("!angela11", 4, "", "", "", "", 0, false, "string");
		if (Place == 460 && this.isHere() && sType === "") return this.showPerson("angela-home1.jpg", "",
			"", "", "", false, "string");
		return ""
	};
	per.showPersonTextHere = function(md) {
		if (Place == 97 && isShopOpen(0) && sType === "") md.write("<p>Angela joins you and gets a cup of coffee for herself.</p>");
		else if (Place == 460 && this.isHere()) md.write("<p>Angela greets you, and invites you in for a drink, or something else, or someone else.</p>")
	};
	per.showEventPopup = function() {
		if (Place != 95 || sType !== "") return false;
		if (!this.checkFlag(1)) {
			this.setFlag(1);
			showPopupWindow("Town Hall Receptionist", "<img src='Images/People/Angela/Small/angela1b.jpg' class='imgpopup' alt='Angela'>" +
				"When you enter the building you see before you a dark haired beauty. By the way she's dressed you immediately recognise her as the secretary around here. The white blouse, the skirt, silk stockings and the high heels give that away. " + "You see a nametag on her desk; <b>Angela</b>.<br><br>Her stiff and serious appearance tells you that she's the type of girl who lives for her work. However you feel aroused just by looking at her, Angela's soft and slim body makes you fantasize about having her as your own secretary. " +
				"A servant who would be always well informed about you and your needs and ready to do any kind of chores you'd give to her and would know you personally.<br><br>" + "While you daydream about her, she doesn't seem to notice you, she's clearly into her work and just types something casually on the computer.");
			return true
		} else if (this.checkFlag(2) && !this.checkFlag(3) && this.isCharmedBy()) {
			showPopupWindow(this.getPersonName(), "<img src='Images/People/Angela/Small/angela1c.jpg' class='imgpopup' alt='Angela'>" +
				'"So, tell me, how do you like working for the Mayor?", you ask your slave while you hop down in one of the chairs in the office.<br><br>' + '"It is a frustrating job, ' + perYou.getMaster() + ". Mayor Thomas is a pain in the neck. She's constantly barking to anyone who doesn't do one hundred percent on their work. She says her biggest achievement will be when her office will be filled with workaholics like her not with lazy assholes as she likes to call us. So we all are afraid of her and try our best.\", Angela answers obediently. Then suddenly she walks in front of the chair where you sit and gently grabs your hand and motions it between her tits.<br><br>" +
				'"I would be the happiest girl in the world if I could be <b>your</b> personal secretary and servant than that harlot\u2019s underpaid worker. If I could be with you all day, follow you around everywhere you go, make you happy\u2026.", she says in husky voice while she slowly starts to unbutton her blouse.<br><br>' + "You grope her tits for a little, both of you silently enjoying each other for a few seconds, but you know her wish can\u2019t happen so you stand up and hush her away from you.<br><br>" +
				'"Nahh, I need you here. Be my eyes and ears, tell me everything you hear, any interesting info or detail about events or people. Update me regularly, do you understand?"<br><br>' + '"Of course, ' + perYou.getMaster() + '. Whatever you say I will do it perfectly for you!", she quickly fixes her dress and sits back to her desk. She gives you an ear to ear smile and waits for your further commands.', "setPersonFlag('Angela',3)");
			return true
		} else if (this.checkFlag(5) && !this.checkFlag(4)) {
			showPopupWindow("Angela with Mayor Thomas",
				"<img src='Images/mayor6b.jpg' class='imgpopup' alt='Mayor'>" + "Angela comes to you and after you greet each other with a kiss she starts.<br><br>" + '"' + perYou.getPersonName() + '!  Ms Thomas wanted to talk to you about something. It seemed important!", she tell you and gives you short kiss on your cheek and goes back to her work. You hurry up to the mayor\u2019s office, you notice she has removed her clothing in anticipation. After Ms Thomas gives you an obedient bow and asks you to sit down.<br><br>' +
				'"' + (perYou.isMaleSex() ? "Sir" : "Ma'am") + '! I have received this email a few hours ago and I just wanted to tell you that I feel this relationship will be a long and productive one! I\u2019m sure of it!", she seems excited than the usual and after she sees your confused face she turns her computer screen to you. It\u2019s an email from ' + getPoliceChief() + " Batton.<br><br>" + '<div style="color:black;background-color:white;text-shadow:-1px 0px white, 0px 1px black, 1px 0px white, 0px -1px white"><b>Subject: ' +
				perYou.getMaster() + "</b><br>Dear Ms Thomas,<br>" + "or sister slave, it's more appropriate. It has come to my knowledge that you are also a member of " + perYou.getPersonName() + "'s harem. " + perYou.getPersonName() + " just opened my eyes to a new reality ; the world of obedience and giving pleasures. I feel like I am burning with pride knowing that I am " + (perYou.isMaleSex() ? "his" : "hers") + " forever and I constantly have an urge to do something to our " + perYou.getMaster() + ". Do you feel the same way too? What do you recommend? What should I do to gain " +
				perYou.getPersonName() + "'s favor?<br><br>" + "Also, I suppose we will work together in the future a lot and I am so relieved that we don\u2019t have to hide behind lies! Our first common mission is to find out more about Kurndorf as the " + perYou.getMaster() + " has interest in him and the tales surrounding him. You look after the files and documents and I shall be the one who ensures " + perYou.getPersonName() + "'s safety and protection.<br><br>" + "Have a great day, dear sister and may we serve " + perYou.getPersonName() +
				" forever!<br>" + "<hr><b>" + getPoliceChief() + " Kerry Batton</b></div><br>" + "You smile a sly smile and ask her the important question.<br><br>" + '"That\'s great, now I can have you two collaborate on anything without any problem! How has your investigation gone?", you ask.<br><br>' + '"I\u2019ve just recently started it ' + perYou.getMaster() + '! I am going to search through the old mails and papers of the Town Hall! I will call you if I learn anything!", she answers, duty and passion coming from her voice.',
				"setPersonFlag('Angela',4)");
			return true
		}
		return false
	};
	per.showEvent = function() {
		var md;
		if (Place == 269 && sType == "angelapool") {
			WaitHereOnly(6);
			md = WritePlaceHeader();
			this.showPerson("angela-pool.jpg");
			addPlaceTitle(md, "Swimming with Angela");
			md.write("<p>Angela arrives, dressed in a pink and white bikini, and she seductively poses for you.</p>");
			startQuestions();
			addLinkToPlaceC(md, "it is fairly private here...", Place, "type=angelapoolsex");
			addLinkToPlaceC(md, "say goodbye to Angela", Place);
			WritePlaceFooter(md);
			return true
		}
		if (Place == 269 && sType == "angelapoolsex") {
			md = WritePlaceHeader();
			this.showPerson("angela-pool-sex.jpg");
			addPlaceTitle(md, "Being Discrete and Private with Angela");
			md.write("<p>You ask the cute secretary to play with you more privately, and she seductively removes most of her swimsuit and lies back waiting for you.</p>");
			startQuestions();
			addLinkToPlaceC(md, "later...say goodbye to Angela", Place);
			WritePlaceFooter(md);
			return true
		}
		if (Place == 97 && sType == "coffee") {
			md = WritePlaceHeader();
			this.showPerson(this.checkFlag(11) ?
				"!angela11b.jpg" : "!angela11a.jpg");
			addPlaceTitle(md, "Coffee Break");
			passTime(false, true);
			passTime(false, true);
			setPlaceKnown("BreakRoom");
			md.write("<p>Angela leads to to the nearby break room and gestures to the coffee machine. You poke the coffee machine with your finger. It\u2019s filled with still hot, freshly mixed coffee. It\u2019s a newer model, an automatic, the easiest one to use. She grabs a mug from the shelf and pours some of the container\u2019s content into the mug. Angela hands it to your hands, kneeling like a good slave in front of you. After you grab the offering, without a word, she takes off her dress only leaving on her underwear and stockings. You slurp the hot brew down your throat in just a few minutes while she stands before, mutely, but happily waiting for you to say something.<p>");
			startQuestions();
			addLinkToPlaceC(md, "follow Angela back to reception", 95);
			WritePlaceFooter(md);
			return true
		}
		if (Place == 460)
			if (sType == "angelafuck") {
				md = WritePlaceHeader();
				this.showPerson("angela-home-sexa.jpg");
				addPlaceTitle(md, "Angela");
				md.write("<p>You enjoy yourself with Angela's body</p>");
				startQuestions();
				addLinkToPlaceC(md, "talk more with Angela", Place);
				addLinkToPlace(md, "exit the apartment", 456);
				WritePlaceFooter(md);
				return true
			}
		if (this.isHere() && sType == "transformbreasts") {
			CastTransform(1);
			this.setFlag(11);
			this.dress = "Large";
			md = WritePlaceHeader(true, "", "black");
			showPopupWindow("Transformation", '<img src="Images/GenericSex/be c.gif" style="width:50%;float:left;margin-right:6px;margin-top:1em;margin-bottom:2em" alt="BE">' + '<p>You cast the spell and Angela groans, "Ah ' + perYou.getLord() + ' what is this?" and pulls apart her top. You see her breasts swelling, growing larger and larger, her modest sized breasts growing to quite large.</p>' + "<p>As she groans you thought you heard some laughing, " + (Place ==
				95 ? "the Mayor" : "a neighbour") + "? Angela sighs as her breasts stop growing, and she says, panting a little,<p>" + '<p>"My love, these will have to take some getting used to...maybe you would like to help me?"</p>');
			setQueryParams("");
			WritePlaceFooter(md, "", true, true);
			return true
		}
		if (Place != 95) return false;
		if (sType == "angelamore") {
			var rnd = Math.random() < .5;
			md = WritePlaceHeader(false, perYou.isMaleSex() && rnd || this.checkFlag(11) && !perYou.isMaleSex() && !isExplicit() ? "" : "td-left-large");
			if (perYou.isMaleSex())
				if (rnd) this.showPersonRorX("angela7ba.jpg");
				else this.showPersonRorX(!perYou.isMaleSex() ? "angela7g.jpg" : "angela7bb.jpg");
			else if (isExplicit()) this.showPersonX("angela7g.jpg");
			else this.showPerson("angela10.jpg");
			addPlaceTitle(md, "Angela's Service");
			md.write("<p>With a surprisingly quick reaction time from Angela, she positions herself on the chair and shoves her legs into the air. She is quite the looker already, but she reveals her pussy to you. It\u2019s one fine, tight vagina! There\u2019s a pen in her hand which somehow lands into her beaver. She twists and twirls the pen around which eventually makes her gasp for air. Not much time has to pass when you decide to join in her fun. You touch her skin, notably, her face and tits while she is pleasuring herself.  Angela\u2019s already occupied with upcoming orgasms and she doesn\u2019t mind you touching her. You play with her tits through her blouse and carefully let her suck one of your thumb. Her tongue wets your palm as she licks it like a thirsty dog, Angela\u2019s eagerness is unquestionable.</p>");
			startQuestions();
			if (wherePerson("Mayor") == 110) addLinkToPlace(md, "visit the Mayor", 110);
			addLinkToPlace(md, "talk to Angela", 95);
			addLinkToPlace(md, "exit the Town Hall", 94);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "charmangela1") {
			md = WritePlaceHeader();
			this.setFlag(7, false);
			this.showPerson("angela2.jpg");
			addPlaceTitle(md, "Angela Under a Spell");
			md.write("<p>You cast the charm spell on Angela. She hears you mumble the incantation but ignores the words.</p>" + "<p>&quot;I really have no time for nonsense,&quot; she says sternly before the first signs of the spell's effects begin to show. " +
				"&quot;I... I have a lot to do.&quot;</p>");
			startQuestions();
			addLinkToPlace(md, "wait for the spell to take effect", Place, "type=charmangela2");
			addLinkToPlace(md, "exit the town hall", 94, "", "You leave the town hall and Angela to deal with the spell.<br/>She will be affected by the spell but you have chosen to not try to reinforce or guide her so the effect will be minimal.");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "charmangela2") {
			md = WritePlaceHeader();
			this.charmThem(2);
			this.showPerson("angela3.jpg");
			addPlaceTitle(md, "Angela Under a Spell");
			md.write("<p>&quot;Oh god!&quot; exclaims Angela. &quot;What a rush. My body is on fire. " + "You really must forgive me but I feel so excited at the moment. I'm not normally attracted to other people so quickly.&quot;</p>" + "<p>You smile back at the young lady. &quot;That's alright, Angela. I sometimes have " + "this effect on people and I think that we can be very good friends.&quot;</p>");
			startQuestions();
			addLinkToPlace(md, "tell Angela to enjoy herself", Place,
				"type=charmangela3");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "charmangela3") {
			md = WritePlaceHeader();
			this.showPerson("angela4.jpg");
			addPlaceTitle(md, "Angela Under a Spell");
			md.write("<p>Angela's clothes start to fall away from her body as the desire increases. Her " + "attraction to you is obviously growing by the minute.</p>" + "<p>&quot;You are so kind to think of me enjoying myself but it would not be right if you didn't enjoy yourself too. I would love to bring you " + "happiness, my dear. Nobody is here so why don't we... You know...&quot; says Angela, her voice taking on a husky tone.</p>");
			startQuestions();
			addLinkToPlace(md, "accept Angela's offer", Place, "type=charmangela4");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "charmangela4") {
			md = WritePlaceHeader();
			this.showPerson("angela5.jpg");
			addPlaceTitle(md, "Angela Under a Spell");
			md.write("<p>&quot;Thank you my love.&quot; Angela replies. &quot;You are such a " + "considerate lover. After all, we have only just met but you " + "want me anyway. You must think that I'm a slut doing this " + "but I promise I have never felt this way before. In fact " +
				"my boyfriend says that I am a cold fish. If only he could see me now.&quot;</p>" + "<p>The secretary is a fine catch for your net. Your own arousal grows as you watch her undress and you want to take her.</p>");
			startQuestions();
			addLinkToPlaceC(md, "tell Angela that she is very hot", Place, "type=charmangela5");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "charmangela5") {
			md = WritePlaceHeader();
			this.showPerson("angela6.jpg");
			addPlaceTitle(md, "Angela Under a Spell");
			md.write("<p>Your words send a shiver down the secretary's spine. She shudders with what could be her first orgasm, then starts to moan to herself.</p>" +
				"<p>You ask, &quot;Are you alright Angela? You sound kind of funny.&quot;</p>" + "<p>&quot;Hmm funny,&quot; she replies to herself. &quot;I feel fucking fantastic you adorable " + perYou.getSex() + ". Why don't we get on with it? I want it right now.&quot;</p>");
			startQuestions();
			addLinkToPlaceC(md, "order Angela to remove the last of her clothes", Place, "type=charmangela6");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "charmangela6") {
			md = WritePlaceHeader();
			if (perYou.isMaleSex()) this.showPersonRorX("angela7ba.jpg",
				"height:max");
			else this.showPerson("angela7g.jpg", "height:max");
			addPlaceTitle(md, "Angela Under a Spell");
			md.write("<p>Angela opens herself to you. She warmly welcomes you into her arms and breasts. " + "Her passion is tireless and demanding even after you are spent. Awkwardly you climb off her as she begs for more.</p>");
			startQuestions();
			addLinkToPlaceC(md, "talk to Angela more", 95);
			addLinkToPlace(md, "exit the town hall", 94);
			WritePlaceFooter(md);
			return true
		}
		return false
	};
	per.showPersonChat = function(bGeneral,
		md) {
		if (Place == 460 && this.isHere() && sType === "") {
			addLinkToPlaceC(md, 'ask for "someone"', Place, "type=angelafuck");
			addSleepLink(md, "bed Angela", "Sleeping with Angela", '<p style="position:absolute;left:10%;top:10%;cursor:pointer;font-size:1.1em;width:40%"><b>You take Angela to bed for the night.</b>', this.getImg("angela-bed1.jpg"), true, "", "", "", "overflow-y:hidden")
		}
	};
	per.handleItem = function(no, cmd) {
		if (no == 14 && cmd == 2) {
			if (Place == 95 && this.isHere()) {
				CastCharmSpell("Angela", 95, 1, "type=charmangela1");
				return "handled"
			}
		} else if (no ==
			18 && cmd == 2)
			if (this.isHere()) {
				if (this.checkFlag(11)) {
					addComments("You have already transformed Angela!");
					return "handled"
				}
				if (!this.isCharmedBy()) {
					addComments("The spell washes over her but nothing happens, you seem to need a magical link to her");
					return "handled"
				}
				if (!CastTransform(1, true)) return "handled";
				ClearComments();
				dispPlace(Place, "type=transformbreasts");
				return "nofooter"
			}
		return ""
	};
	per.addPersonPhoneCall = function() {
		var perMT;
		var nt;
		var nm;
		var nk;
		if (isShopOpen(0) && getPersonOther("Mayor") === 3 && wherePerson("Mayor") ===
			0) {
			if (makeCall(true, 112)) movePerson("Mayor", 110)
		} else if (isShopOpen(0) && this.isCharmedBy()) {
			perMT = findPerson("Mayor");
			nt = this.hoursCharmed();
			nm = perMT.hoursCharmed();
			if (!this.checkFlag(6) && perMT.isCharmedBy("You") && isCharmedBy("Kristin") && perMT.place === 110 && Place != 95 && Place != 110) {
				nk = getPersonHoursCharmed("Kristin");
				if (nt > 24 && nm > 24 && nk > 24)
					if (makeCall(true, 110)) this.setFlag(6)
			}
			if (!this.checkFlag(5) && perMT.isCharmedBy("You") && nt > 0 && this.checkFlag(3) && nm > 24 && isCharmedBy("OfficerBatton") && Place != 95 && Place !=
				110)
				if (makeCall(true, 111)) this.setFlag(5);
			if (!this.checkFlag(10)) {
				perMT = findPerson("Mayor");
				if (perMT.checkFlag(4)) {
					var perEllie = findPerson("Ellie");
					if (!perEllie.checkFlag(3)) {
						var perBatton = findPerson("OfficerBatton");
						nt = this.hoursCharmed();
						nm = perMT.hoursCharmed();
						if (perEllie.isCharmedBy("You") && perBatton.isCharmedBy("You") && perMT.isCharmedBy("You") && isCharmedBy("Kristin") && perMT.place === 110 && Place != 95 && Place != 110) {
							nk = getPersonHoursCharmed("Kristin");
							var tm = 72 + Math.floor(Math.random() * 5);
							if (nt > tm &&
								nm > tm && nk > tm)
								if (makeCall(true, 113)) this.setFlag(10)
						}
					}
				}
			}
		}
		return false
	};
	per.isPhoneable = function() {
		return checkPlaceFlag("Hotel", 11) && Place == 269 && this.isCharmedBy()
	};
	per.callThem = function() {
		if (Place == 269)
			if (isShopOpen(0)) WriteComments('You call Angela to invite her to join you at the pool for a swim, but she replies, "Sorry, ' + this.getYourNameFor() + ', things are real busy here in the Town Hall!". She apologies and promises to another time. ');
			else {
				gotoPlace(Place, "type=angelapool");
				receiveCall("", "You call Angela to invite her to join you at the pool for a swim, and she happily agrees.");
				WriteCommentsFooter(bChat, bChatLeft)
			}
	};
	per.getPersonSMS = function(id) {
		switch (id) {
			case 110:
				return receiveSMS("Angela", perYou.getMaster() + "! I have to inform you that Miss Thomas would like to have a talk with you. She says it\u2019s important. We are waiting for your arrival anytime, please come when your time permits.");
			case 111:
				if (this.getCharmedLevel() == 4) return receiveSMS("Angela", perYou.getMaster() + "! I have to inform you that your slave, Mayor Thomas would like to speak with you privately about something important. Please visit us if you have the time and not too tired of your quest yet!");
				return receiveSMS("Angela", "My love! Your little mayor slut just told me that she has some interesting information that she wants to share with you! I had to make her sit down because she was hyperventilating. Come check us out soooon pleaaaasee because she wants to tell you first and I\u2019m super curious !!!");
			case 112:
				if (this.getCharmedLevel() === 0) return receiveSMS("Town Hall", "Hi! This is Angela, the Mayor\u2019s secretary. I have tried calling you on your home phone, but I could not contact you so I am sending this message too! Mayor Thomas wants to see you and is ready to greet you personally!");
				if (this.getCharmedLevel() == 2) return receiveSMS("Angela", "My love! Mayor Thomas is back and wants to meet you personally! That witch will finally gets what she deserves and learn her place, won\u2019t she my love?! :)");
				return receiveSMS("Angela", perYou.getMaster() + "! I hope I\u2019m not disturbing you, but I did as you have commanded and learned that Mayor Thomas is ready to greet you! I am soo happy, soon she will be yours\u2026like me\u2026:)");
			case 113:
				return receiveSMS("Angela", "Angela here, " +
					this.getYourNameFor() + "! Mayor Thomas, " + getPoliceChief() + " Batton and Kristin are waiting for you in the Thomas\u2019s office for a group meeting. They won\u2019t start without their " + perYou.getMaster() + " so come by whenever you feel like it! With my deepest regards, Angela!.")
		}
		return ""
	}
}

function MoveAnitaToBedroom() {
	findPerson("Anita");
	if (per.place != 46) per.place = per.checkFlag(9) ? 46 : 45
}

function MoveAnitaToCellar() {
	movePerson("Davy", 999);
	movePerson("Bambi", 124)
}

function initialiseAnita() {
	addPerson("Anita");
	per.getYourNameFor = function() {
		return perYou.isMaleSex() ? "Sir" : "Ma'am"
	};
	per.getPersonName = function(full) {
		if (full === true) return this.name;
		return this.getCharmedLevel() == 3 ? "your slut" : this.sCharmedBy == "You" ? "Slave " + this.name : this.name
	};
	per.whereNow = function() {
		if (Place == 142) return Place;
		var p = per;
		if (this.place == 161 && !isShopOpen(3, 2, true) && checkPersonFlag("Bambi", 7)) {
			per = p;
			return 46
		}
		per = p;
		return this.place
	};
	per.passTimeDay = function() {
		if (this.place == 1E3 && !this.checkFlag(10)) {
			this.setFlag(11);
			this.place = 195
		}
		return ""
	};
	per.showEventPopup = function() {
		if (sType !== "") return false;
		if (Place == 46 && this.place === 46 && this.checkFlag(8) && !this.checkFlag(6)) {
			this.setFlag(6);
			showPopupWindow("Anita is here?", "<img src='Images/" + this.getImg("anita9b.jpg") + " class='imgpopup' alt='Anita'>" + '<p>"' + this.getYourNameFor() + ', I did as you ordered, I removed the traitor Davy and took him into the deep woods and killed him. He is now in a shallow grave where he will never be fpund."</p>' + "<p>As I ordered, I told her to take care of Davy...this violent woman must have took that in the way of such people and thought I meant to eliminate the threat, and the person! Another body now in your quest for the magic of the Book!</p>" +
				"<p>Well, you do not know what to do here, Anita is looking at you confused, so you think it best to calm her down. You congratulate her on completing her mission and otherwise tell her to remain here so you can monitor her better, and prevent any similar misunderstandings. Also she looks darned cute in that lingerie.");
			return true
		}
		return false
	};
	per.showEvent = function() {
		var md, hs, myName;
		if (Place == 269 && sType == "anitapool") {
			WaitHereOnly(6);
			md = WritePlaceHeader();
			this.showPerson("anita-pool.jpg");
			addPlaceTitle(md,
				"Swimming with Anita");
			md.write('<p>Anita arrives, oddly she is dressed partly in a wet-suit, not a swimsuit. She apologises, "Sorry ' + this.getYourNameFor() + ', I do not have anything for recreation, but I do have this for water operations." and she salutes.</p>' + "<p>Odd, but that's Anita, and you cannot do much about that, so you order her to go swimming with you.</p>");
			startQuestions();
			addLinkToPlaceC(md, "it is fairly private here, order her to do more", Place, "type=anitapoolsex");
			addLinkToPlaceC(md,
				"say goodbye to Anita", Place);
			WritePlaceFooter(md);
			return true
		}
		if (Place == 269 && sType == "anitapoolsex") {
			md = WritePlaceHeader();
			this.showPerson("anita-pool-sex.jpg");
			addPlaceTitle(md, "Private with Anita");
			md.write("<p>You order Anita to do a more personal operation, and she seductively removes most of her wet-suit and lies back waiting for you.</p>");
			startQuestions();
			addLinkToPlaceC(md, "later...say goodbye to Anita", Place);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "charmanitastore1") {
			myName = this.getYourNameFor();
			md = WritePlaceHeader();
			removeTimedEvent("movePerson('Anita',1000)");
			this.place = 9999;
			this.showPerson("anita10b.jpg");
			addPlaceTitle(md, "Shopper Under A Charm Spell");
			md.write("<p>You are a little argry at the way this woman insulted you, and you recite the spell, and tell her,</p>" + '<p>"The only slut I see here is you!"</p>' + '<p>She looks at you angrily, "Fuck off...' + myName + "...I means you " + (perYou.isMaleSex() ? "bastard" : "bitch") + '...you are not my commander..."</p>' + "<p>She hesitates as the spell takes affect, but it would seem she is a member of the military, but something there seems wrong from how she was acting before, and you suspect she is more member of some sort of para-military group or militia. She starts to reach into her handbag as you firmly tell her,</p>" +
				'<p>"Shut up! I will call you a slut, a bitch or whatever I choose, you are mine to command and do not forget it!"</p>' + "<p>She starts to take something from her handbag, you are sure it was a pistol of some sort, but she drops it and turns to face you. Her expression a mixture of anger and lust,</p>" + '<p>"' + myName + '...sorry...what, I am not that, I am a <b>patriot</b> and I follow my orders, and you are not my commander!"</p>' + "<p>You could hear the way she said <b>patriot</b> that is was key to her identity and was almost shouted. You think you should take it easier on trying to dominate her until the spell has influenced her more. You ask her,</p>" +
				'<p>"Yes, you are a loyal patriot, but why then are you wearing <i>that</i> dress?"</p>' + "<p>She hesitates and runs her hands over her dress, pulling at the hem of her short and tight dress. You see then why when wearing such a dress you did not see the lines of underwear, she is not wearing any. Her pussy is bare and clean shaven. She shivers, your think more a small orgasm than the cold of exposing herself. As she does the straps of her dress slip. She looks at you confused,</p>" + '<p>"' + myName +
				"..." + (perYou.isMaleSex() ? "bastard" : "bitch") + '...I am in public, umm undercover, and have to wear normal clothing, and this is all I had available. I need provisions for the rest of my journey..."</p>' + "<p>That is enough, you have given her enough time, but do you want go hard or soft?</p>");
			startQuestions();
			addLinkToPlaceC(md, '"Look at yourself slut!"', Place, "type=charmanitastore2&hard=true");
			if (perYou.checkFlag(26)) addLinkToPlaceC(md, '"Well done fellow patriot"', Place, "type=charmanitastore2&hard=false");
			addLinkToPlace(md, "return to the front of the " + getShopStore(), 195);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "charmanitastore2") {
			myName = this.getYourNameFor();
			hs = getQueryParam("hard");
			md = WritePlaceHeader();
			this.showPerson("anita10c.jpg");
			if (hs == "true") {
				this.charmThem(3);
				addPlaceTitle(md, "Dominating a Slut");
				md.write("<p>You can feel her intense arousal and forcibly tell her,</p>" + '<p>"You are not wearing any underwear and you are exposing yourself to me. You are a slut who wants nothing more than sex."</p>' +
					"<p>Despite her arousal she starts to deny your words, but makes no effort to cover herself. You ignore her words. You step towards her and with a light touch pull on the dislodged straps of her dress and it falls down to her waist.</p>" + '<p>"Embrace being a slut, there is nothing wrong with it. Sex is fun and you really enjoy it, don\'t you?"</p>' + "<p>She slumps to the ground and replies in confusion,</p>" + '<p>"Well, of course I love fucking...but I am a..."</p>' + "<p>You quickly interrupt her, it is clear she is about to say <b>patriot</b>,</p>" +
					'<p>"slut! OF course you are, it is your only wish and desire, to be someone\'s sex-toy and plaything, with no concern other than sex!"</p>' + "<p>She starts to mutter something about her mission, and you tell her,</p>" + '<p>"Like any slut your mission is to have as much sex as you can."</p>' + "<p>The spell has not completely controlled her, yet, and you can see some sense of her duty still trying to surface. You make a last push,</p>");
				startQuestions();
				addLinkToPlaceC(md, '"Enough talk, let\'s fuck"',
					Place, "type=charmanitastore3&hard=" + hs)
			} else {
				addPlaceTitle(md, "A Patriot Under <i>Your</i> Command");
				md.write("<p>She looks confused at your words, and you continue to reinforce,</p>" + '<p>"You resisted my intimidation well patriot, I was sent here to test your resolve and loyalty"</p>' + "<p>Suddenly she looks immensely relieved and she slumps to the floor,</p>" + '<p>"I have done well ' + myName + ', thank you, thank you, I am...was feeling so arous...angry."</p>' + "<p>She stretches her arms up in her relief and her dress starts to slip down, the straps had already fallen away from her shoulders. She does not seem to care in the mizture of her relief and the arousal coursing though her from the spell. You decide to exert your authority more,</p>" +
					'<p>"Well patriot...what is your given name?", she looks up at you, "Anita ' + myName + ' as you know, another test?.", and you continue, "I have been been told to assign you to a new duty. Your previous task has been compromised, so you are now assigned to my command!"</p>' + "<p>She sits up smiling, her dress falls almost completely down, and she asks</p>" + '<p>"What will my duties be ' + myName + ", is there anything you need 'handled' now?\"</p>");
				startQuestions();
				addLinkToPlaceC(md, '"Yes, there is..."',
					Place, "type=charmanitastore3&hard=" + hs)
			}
			addLinkToPlace(md, "return to the front of the " + getShopStore(), 195);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "charmanitastore3") {
			myName = this.getYourNameFor();
			hs = getQueryParam("hard");
			md = WritePlaceHeader();
			if (perYou.isMaleSex()) this.showPerson("anita10db.jpg");
			else this.showPerson("anita10dg.jpg");
			var subo;
			if (hs == "true") {
				subo = "slut";
				addPlaceTitle(md, "A Sluts' Mission");
				md.write("<p>For a moment you are unsure what she is going to do, but she smiles as she drops to her knees ")
			} else {
				subo =
					"subordinate";
				addPlaceTitle(md, "Anita's New Duty");
				md.write("<p>Anita eagerly moves to do her new duty as she drops to her knees ")
			}
			if (perYou.isMaleSex()) md.write("and undoes your trousers and takes your stiff cock into her mouth. She proceeds to give you a skilled blowjob until you explode in her mouth. She swallows and then asks,</p>" + '<p>"Would ' + myName + ' now like my ass or pussy?"</p>' + '<p>You of course reply "Both!"</p>' + "<p>You sate yourself on your new " + subo + "s body, and she also experiences considerable pleasure, both from the effects of the spell and also as she seems to very, very much like sex!</p>");
			else md.write("and undoes your pants and with a little hesitation licks your pussy. She is probably not experienced with a woman but still she makes you come quickly to a shuddering climax. She then asks,</p>" + '<p>"Would ' + myName + ' now like my ass or pussy or shall I do that again?"</p>' + '<p>You of course reply "All of them!"</p>' + "<p>You sate yourself on your new " + subo + "s body, and she also experiences considerable pleasure, despite, or maybe because of her lack of experience with women.</p>");
			if (hs == "true") {
				this.moveThem(45);
				md.write("<p>After, you tell her,</p>" + '<p>"You are a true slut. Why don\'t you go back to my home and wait for me in my bedroom, make sure to put something sexy on."</p>' + '<p>As you say this you realise you do not know her name, and briefly consider asking it. You then think "Fuck it, she is a slut, and needs no other name".</p>' + "<p>You tell her your address and remind her to dress before leaving. She looks at you, and you realise the spell has fully taken control of her, she is now your personal slut.</p>")
			} else {
				if (whereItem(47) ==
					252) moveItem(47, 195);
				else if (whereItem(47) === 0) PlaceI(47, 195);
				setPlaceKnown("AnitasLair");
				this.moveThem(252);
				md.write("<p>After, you ask Anita where she is currently staying, and she mentions she has found an abandoned storeroom at the school near the French classroom and she is bunking down there now. You tell her to return there and you will meet her there later to discuss her duties.</p>" + '<p>She smiles, "Like my last \'duty\'?", and you gravely nod your head, "And more".</p>' + "<p>Anita quickly redresses, not that she has much to put on, and she leaves the " +
					getShopStore() + " with her groceries.</p>" + "<p>As you follow her out, you notice there are some new items for sale in the " + getShopStore() + ", a range of sporting goods, it looks like Leanne is expanding the range of items for sale.</p>")
			}
			startQuestions();
			addLinkToPlace(md, "return to the front of the " + getShopStore(), 195);
			WritePlaceFooter(md);
			return true
		}
		if (Place != 46 && Place != 161 || !this.isHere()) return false;
		var herName = this.getPersonName();
		var bC = Math.random() < .5;
		if (sType == "anitaprivate") {
			md = WritePlaceHeader();
			this.showPerson("anita13.jpg");
			addPlaceTitle(md, herName + " In Your Bedroom");
			md.write("<p>" + capitalizeFirstLetter(herName) + " kneels on the bed, making herself available for her " + perYou.getMaster() + ".</p>");
			startQuestions();
			if (perYou.isMaleSex()) addLinkToPlaceO(md, "order her that you will fuck her", Place, "type=anitafuck");
			addLinkToPlaceO(md, "order her to " + (perYou.isMaleSex() ? "give you a blowjob" : "lick you"), Place, "type=anitabj");
			if (!isDay()) addPopupLink(md, "take " + herName + " to bed for the night",
				"Bedding " + herName, '</p><img src="Images/anita12.jpg" style="position:absolute;width:100%;bottom:0" alt="Anita">' + '<p style="position:absolute;left:50%;top:70%;cursor:pointer;font-size:1.1em;width:50%;color:white">As you prepare to go to bed for the night you order ' + herName + " to join you in bed.", true, "sleepForNight(46)", false, undefined, "background-color:#48250F;color:white;top:10%;left:5%;width:85%;height:80%;padding:0");
			addLinkToPlaceO(md, "finish talking to Anita", 46);
			WritePlaceFooter(md);
			return true
		}
		if (sType ==
			"anitafuck") {
			md = WritePlaceHeader(false, !isExplicit() && bC ? "td-left-large" : "");
			this.setFlag(7);
			if (isExplicit()) this.showPersonRandomX("anita15b", 2);
			else if (bC) this.showPerson("anita15bb.jpg");
			else this.showPerson("anita15ba.jpg");
			addPlaceTitle(md, "Fucking " + herName);
			md.write("<p>Sex with Anita is a very straightforward affair. You make room on the bed, undress each other and go at it.</p>" + "<p>Anita doesn't really like excessive tenderness and once called foreplay an \u201cinefficient waste of time\u201d, since she is always wet and ready for you to begin with, but she is slowly opening up to the idea that there is more to it than a quick way to get off.</p>" +
				"<p>You pin Anita onto the bed and both of you sate your desires on each others bodies. Your " + (perYou.isMaleSex() ? "manhood slides into her wetness" : "your sex grinds against hers") + " with rough, rapid motions, and you grin every time the stoic shell of your subordinate cracks a little more and she allows herself to softly moan or dig her fingers into the bed-sheet under another wave of pleasure.</p>" + "<p>In the end, both of you finally collapse on top of each other after sharing a mutual climax, and you even get to see one of Anita's rare smiles when you confirm to her that she fulfilled her \u201cduty\u201d to your fullest approval.</p>");
			startQuestions();
			addLinkToPlaceO(md, "finish talking to Anita", 46);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "anitabj") {
			md = WritePlaceHeader(false, !isExplicit() ? "td-left-large" : "");
			this.setFlag(7);
			if (isExplicit())
				if (perYou.isMaleSex()) this.showPersonX("anita14b.jpg");
				else this.showPersonX("anita14g.jpg");
			else if (perYou.isMaleSex()) this.showPerson("anita14b.jpg");
			else this.showPerson("anita14g.jpg");
			addPlaceTitle(md, "Anita Serving You");
			md.write("<p>\u201cSoldier!\u201d You address Anita, and she immediately jumps off the bed and stands at attention.</p>" +
				"<p>\u201c" + this.getYourNameFor() + "!\u201d</p>" + "<p>\u201cI need you to get on your knees and " + (perYou.isMaleSex() ? "suck my cock" : "lick my pussy") + ", it's a delicate mission, but I am sure you are up to the task.\u201d</p>" + "<p>\u201cDelicate indeed, " + this.getYourNameFor() + "!\u201d Anita has a wide grin on her face as she pulls you closer and opens your pants, her eyes lingering on your " + (perYou.isMaleSex() ? "half erect shaft" : "exposed sex") + " for a second before her lips finally wrap around " +
				(perYou.isMaleSex() ? "the tip" : "your clit") + " and she begins to go to work.</p>" + "<p>Anita is very direct in her approach. She knows how to please a " + (perYou.isMaleSex() ? "man" : "woman") + ", but is usually focused on the \u201cMission results\u201d rather than enjoying herself on the way there. Always eager to bring you to climax as quickly as possible and get her \u201creward\u201d.</p>" + "<p>It might be a good idea for the future to train a little, so she will drag things out, maybe act a little more slutty. But for now you enjoy her attentions while she quickly brings you to climax and " +
				(perYou.isMaleSex() ? "takes a load of her reward into her mouth" : "licks her reward from your folds") + ".</p>");
			startQuestions();
			addLinkToPlaceO(md, "finish talking to Anita", 46);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "recharmanita1") {
			clv = this.getCharmedLevel();
			if (clv != 4) this.charmThem(4);
			else this.charmThem(3);
			md = WritePlaceHeader();
			this.showPerson("anita14g.jpg");
			addPlaceTitle(md, "Re-assigning Anitas Ass");
			md.write("<p>You decide to give Anita a new set of orders, and as the spell courses through her again you tell her.</p>" +
				'<p>"Remember Anita, I will call you a slut, a bitch, patriot or whatever I choose, you are mine to command and do not forget it!"</p>' + "<p>She starts to take something from her handbag, you are sure it was a pistol of some sort, but she drops it and turns to face you. Her expression a mixture of anger and lust,</p>" + '<p>"' + this.getYourNameFor() + '...sorry...yes, I follow my orders, and you are my commander!"</p>' + "<p>That is enough, you have given her enough time, but do you want go hard or soft?</p>");
			startQuestions();
			if (clv != 3) addLinkToPlaceC(md, '"Look at yourself slut!"', Place, "type=recharmanita2");
			if (clv != 4) addLinkToPlaceC(md, '"Well done fellow patriot"', Place, "type=recharmanita2");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "recharmanita2") {
			clv = this.getCharmedLevel();
			md = WritePlaceHeader();
			this.showPerson("anita-recharm2.jpg");
			addPlaceTitle(md, "Anita Re-assigned");
			switch (this.getCharmedLevel()) {
				case 3:
					md.write("<p>You can feel her intense arousal and forcibly tell her,</p>" + '<p>"You are not wearing any underwear and you are exposing yourself to me. You are a slut who wants nothing more than sex."</p>' +
						"<p>Despite her arousal she starts to deny your words, but makes no effort to cover herself. You ignore her words. You step towards her and with a light touch pull on the dislodged straps of her lingerie and it falls down to her waist.</p>" + '<p>"Embrace being a slut, there is nothing wrong with it. Sex is fun and you really enjoy it, don\'t you?"</p>' + "<p>She slumps to the ground and replies in confusion,</p>" + '<p>"Well, of course I love fucking...but I am a..."</p>' + "<p>You quickly interrupt her, it is clear she is about to say <b>patriot</b>,</p>" +
						'<p>"slut! OF course you are, it is your only wish and desire, to be someone\'s sex-toy and plaything, with no concern other than sex!"</p>' + "<p>She starts to mutter something about her mission, and you tell her,</p>" + '<p>"Like any slut your mission is to have as much sex as you can."</p>');
					break;
				case 4:
					md.write('<p>"You have been serving me well patriot, I was sent here to test your resolve and loyalty"</p>' + "<p>Suddenly she looks immensely relieved and she slumps to the floor,</p>" + '<p>"I have done well ' +
						this.getYourNameFor() + ', thank you, thank you, I am...was feeling so arous...angry."</p>' + "<p>She stretches her arms up in her relief and her lingerie starts to slip down, the straps had already fallen away from her shoulders. She does not seem to care in the mizture of her relief and the arousal coursing though her from the spell. You decide to exert your authority more,</p>" + '<p>"Well patriot...what is your given name?", she looks up at you, "Anita ' + this.getYourNameFor() + ' as you know, another test?.", and you continue, "I have been been told to assign you to a new duty. Your previous task has been compromised, so you are now assigned to my command!"</p>' +
						"<p>She sits up smiling, her lingerie falls almost completely down, and she asks</p>" + '<p>"What will my duties be ' + this.getYourNameFor() + ", is there anything you need 'handled' now?\"</p>");
					break
			}
			startQuestionsOnly();
			addLinkToPlaceC(md, "that is enough for now", Place);
			WritePlaceFooter(md);
			return true
		}
		return false
	};
	per.showPersonChat = function(bGeneral, md) {
		if (Place == 45 || !this.isCharmedBy("You") || !this.isHere()) return;
		if ((sType == "anitaprivate" || Place != 46) && isDavyDefeated() && perDavy.place == 184 && !perDavy.isDead() &&
			this.checkFlag(7) && !this.checkFlag(8) && isCharmedBy("Bambi")) {
			setPlaceFlag("Hotel", 8);
			startAlternatives(md, "You consider if Anita can help you with Davy");
			if (isMurderPath()) addPopupLinkC(md, '"Anita I want you to <i>take care</i> of Davy"', "Anita Leaves", "<img src='Images/anita1.jpg' class='imgpopup' alt='Anita'>" + "You decide it would be a good idea to have Anita guard Davy now you are confident of her loyalty. While she was his slave, you are now sure she will obey you only, so you tell her to go and take care of Davy and tell her where she is and if Bambi questions her to ask her to contact yourself. Anita answers with a salute,</p>" +
				'<p>"Yes ' + this.getYourNameFor() + ', I will take care of that bastard who pretended to be my commander!"</p>' + "<p>There was a lot of venom in her words, you are assured that she has no residual loyalty for him. You are worried she might be a little rough, but then again Davy deserves some rough treatment!</p>" + "<p>With that Anita dresses in her fatigues and packs her gear and guns and with no further words she leaves.", false, 'setPersonFlag("Anita",8);perDavy.health=0;perDavy.moveThem(1000);movePerson("Anita",999);movePerson("Bambi",124);startTimedEvent("MoveAnitaToBedroom()", 36);dispPlace();',
				undefined, "background-color:white;color:black;text-shadow:-1px 0px white, 0px 1px white, 1px 0px white, 0px -1px white;");
			else addPopupLinkC(md, '"Anita I want you to <i>take care</i> of Davy"', "Anita Obeying...", "<img src='Images/anita1.jpg' class='imgpopup' alt='Anita'>" + "You decide it would be a good idea to have Anita guard Davy now you are confident of her loyalty. While she was his slave, you are now sure she will obey you only, so you tell her to go and take care of Davy and tell her where she is and if Bambi questions her to ask her to contact yourself. Anita answers with a salute,</p>" +
				'<p>"Yes ' + this.getYourNameFor() + ', I will take care of that bastard who pretended to be my commander!"</p>' + "<p>There was a lot of venom in her words, you are assured that she has no residual loyalty for him. You are worried she might be a little rough and ask her to confirm her assignment,</p>" + '<p>"Yes ' + this.getYourNameFor() + ', I will kill the bastard, dispose of the body and return here!"</p>' + "<p>Ummm, that is not it, and you realise she is probably a bad choice to watch over him and leave that task to Bambi. You order Anita to forget the order and remain here. You had forgotten how casually violent Anita is...",
				false, 'setPersonFlag("Anita",8);dispPlace();', undefined, "background-color:white;color:black;text-shadow:-1px 0px white, 0px 1px white, 1px 0px white, 0px -1px white;");
			addPopupLinkC(md, '"Anita I want you to <i>look after</i> Davy"', "Anita Leaves", "<img src='Images/anita9a.jpg' class='imgpopup' alt='Anita'>" + "You decide it would be a good idea to have Anita guard Davy now you are confident of her loyalty. While she was his slave, you are now sure she will obey you only, so you tell her to go and take care of Davy and tell her where she is and if Bambi questions her to ask her to contact yourself. Anita answers with a salute,</p>" +
				'<p>"Yes ' + this.getYourNameFor() + ', I will take care of that bastard who pretended to be my commander, and ensure he will not interfere with you!"</p>' + "<p>There was a lot of venom in her words, you are assured that she has no residual loyalty for him. You are worried she might be a little rough and ask her to confirm her assignment,</p>" + '<p>"Yes ' + this.getYourNameFor() + ', I will speak to Bambi and arrange to imprison that bastard. I will ensure he never interfere with you!"</p>' + "<p>You confirm with her that you so not want him harmed and she acknowledges. With that Anita dresses in a tight green dress only, with no underwear at all. She makes sure you can see this clearly, and as she packs her gear she invites you to visit and inspect her more, and how she secures Davy. She salutes and leaves, her dress barely covering her privates, a private's privates.",
				false, 'setPersonFlag("Anita",8);movePerson("Anita",999);startTimedEvent("MoveAnitaToCellar()", 12);dispPlace();', undefined, "background-color:white;color:black;text-shadow:-1px 0px white, 0px 1px white, 1px 0px white, 0px -1px white;");
			endAlternatives(md)
		}
		if (Place == 161 && perDavy.isHere() && sType === "") addLinkToPlace(md, 'Anita "Show me how Bambi has trained you"', 161, "type=playdavyanita")
	};
	per.showPersonTextHere = function(md) {
		if (Place == 161 && this.isHere() && perDavy.isHere() && wherePerson("Bambi") != 161) md.write("<p>Your rival Davy is bound against one wall, guarded by your loyal slave Anita.</p>");
		else if (this.whereNow() == 46 && (sType == "tessplaymore" || sType == "tanikafuck" || sType == "tanikabj")) md.write("<p>Anita stands at the door, dutifully making sure that no one is able to bust in and try to assassinate you or disturb your sexy-time. She is surprisingly stern and focused for someone under the Dai chu, but you do occasionally catch her giving you wistful looks, hoping that it will be her turn soon.</p>")
	};
	per.handleItem = function(no, cmd) {
		if (no == 14 && cmd == 2)
			if (Place == 142) {
				ShotByAnita();
				return "nofooter"
			} else if (Place ==
			195 && this.isHere()) {
			if (!isSpellKnown("Shielded Charm")) addComments("Don't cast the spell here, the " + getShopStore() + " is still open and it's too public.");
			else if (!this.checkFlag(5)) addComments("You do not know her name, so the spell will not work.");
			else CastCharmSpell("Anita", Place, 4, "type=charmanitastore1");
			return "handled"
		} else if (Place == 46 && this.isHere()) {
			CastCharmSpell("Anita", Place, 4, "type=recharmanita1", "", "type=recharmanita1");
			return "handled"
		} else if (Place == 252 && this.isHere()) {
			if (!this.isCharmedBy("You") &&
				!this.isCharmedBy("Davy")) CastCharmSpell("Anita", 252, 4, "type=anita5");
			else if (!this.isCharmedBy("You") && this.isCharmedBy("Davy")) gotoPlace(252, "type=shotcharm");
			else addComments("You read a spell.... but it fizzles.");
			return "handled"
		}
		return ""
	};
	per.isPhoneable = function() {
		return checkPlaceFlag("Hotel", 11) && Place == 269 && this.isCharmedBy()
	};
	per.callThem = function() {
		if (Place == 269 && (this.place == 46 || this.place == 161))
			if (this.whereNow() != 46) WriteComments("You reconsider asking Anita, she is on her guard duty and she would never take time off for a swim, you will have to try another time.");
			else {
				gotoPlace(Place, "type=anitapool");
				receiveCall("", 'You call Anita to order her to join you at the pool for a swim, and she answers, "Yes ' + this.getYourNameFor() + ".");
				WriteCommentsFooter(bChat, bChatLeft)
			}
	}
}

function initialiseAuntBrandi() {
	addPerson("Brandi", 433, "AuntBrandi");
	per.getPersonAddress = function() {
		return isPlaceKnown("AuntsHouse") ? "12 Cherise Rd, Glenvale" : ""
	};
	per.showEvent = function() {
		var md;
		if (sType == "seebrandi1") {
			md = WritePlaceHeader();
			this.setFlag(1);
			this.showPerson("brandi0a.jpg");
			addPlaceTitle(md, "Working Out");
			md.write("<p>You see through a large set of windows an athletic woman doing stretching exercises. A damned fine looing woman with a toned, well-built body. As you look admiringly you think she is familiar...and then Kylie says,</p>" +
				"<p>\"Mom's working out again, we both like to keep fit!\", and you recognise her, it is been a long while, she is your Aunt Brandi, your mother's younger sister and Kylie's mother. You feel Kylie's hand on your shoulder pulling you back literally and figuratively as she demands your attention.</p>" + "<p>You talk and joke around with Kylie for a bit longer, but your thoughts do keep drifting back to her mother. Again you suggest visiting her home, but Kylie shakes her head and avoids discussing it. She leaves you shortly after, clearly there is some tension there and you will have to find another way to visit.</p>");
			startQuestions();
			addLinkToPlace(md, "return to Cherise Rd.", Place);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "seebrandi2") {
			md = WritePlaceHeader(false, "td-left-large");
			this.setFlag(2);
			this.showPerson("brandi0b.jpg");
			addPlaceTitle(md, "Aunt Brandi Sun-bathing");
			md.write("<p>You look and see Aunt Brandi sun-bathing on a lounge in their backyard. There are some high shrubs and trees making the yard private, but not entirely as you can see in.</p>" + "<p>The reason privacy came to mind, aside from what you had just been doing with Kylie, is that Aunt Brandi is completely naked, going for that full-body tan you guess. She is smiling at Kylie and said something, but you are a little too far for conversation aside from a yelled 'Hi', or spells for that matter...if you felt so inclined, but looking at her fit body how could they not come to mind...</p>" +
				"<p>It strikes you that Aunt Brandi has some things in common with your mother, an almost complete lack of modesty...and a fine figure.</p>");
			startQuestions();
			addLinkToPlace(md, "say goodbye to Kylie for now", Place);
			WritePlaceFooter(md);
			return true
		}
		return false
	}
}

function RepliesBambi(nR) {
	var bCharm = per.isCharmedBy();
	var myLord = per.getYourNameFor();
	if (nR == 922) {
		if (!perYou.checkInjury(7)) {
			perYou.setInjury(7);
			moveItem(4, 76);
			if (wherePerson("MrBeasley") !== 11) movePerson("MrBeasley", 11);
			perYou.setFlag(8)
		}
		perYou.setInjury(8);
		if (!bCharm) addComments('<p>"The teacher Mr. Beasley told me he saw you lying unconscious in the cellar. I immediately called an ambulance to take you to the hospital. I do not like to talk ill of customers so I will not further talk of Mr. Beasley."</p>');
		else addComments('<p>"Oh, ' + myLord + ', Mr. Beasley the teacher found you lying unconscious and and told me. I immediately called an ambulance and then had him leave the Hotel. Mr. Beasley is one of my customers I wish to see as little as I can outside of professional matters."</p>');
		addComments("<p>You ask about the Book but all Bambi mentions is seeing Mr. Beasley carrying a large bag when he left.")
	} else if (nR == 1E3) {
		bChatLeft = false;
		per.setFlag(5);
		setPersonFlag("Mia", 5);
		addComments('"We have a wide range of wines, ' +
			myLord + ' but only a limited number of truly fine vintages. We have a wine rack in the cellar but one of the hotels owners recently lost the key to the rack and we have not yet got in a locksmith to sort it out. The silly person was hiking in Glenvale Park somewhere and lost it!"')
	} else if (nR == 2206) {
		perKurndorf.setQuestCrypt(10);
		addComments('"Kurndorf, ' + myLord + '? Yes. Everyone in this town knows about <i>him</i>.  I even heard he was buried somewhere around here."<br>')
	} else if (nR == 2210) {
		perKurndorf.setQuestCrypt(17);
		addComments("\"I can't say for sure, " + myLord + ". I remember something about him being buried in a crypt.  I'm sorry " + myLord + ", I'm afraid I didn't pay much attention in history class.  Please forgive me.  Is there <i>anything</i> I can do to make it up to you " + myLord + '?" she asks, glimmers of desire in her eyes as she looks at you.')
	} else if (nR == 11900) {
		movePerson("Donna", 269);
		addComments('"Oh yes, ' + myLord + '," she says with a wicked grin.</p><p>"A voluptuous girl about your age just checked in. She has quite an attitude and I would <i>love</i> to see you teach the little thing her rightful place in this world...  <i>as your slave</i>.  I believe that she is in the swimming pool at the moment, ' +
			myLord + ', her name is Donna.", she says with a wicked grin, very pleased with herself.')
	} else if (nR == 11901) {
		per.setFlag(6);
		startTimedEvent("movePerson('NurseMegan',275);", 12);
		movePerson("NurseMegan", 269);
		addComments('"Oh, ' + myLord + '," she says "The hotel pool is available to the general public for a modest fee. A lovely pair of slaves-to-be are there now. I think one is a nurse from the hospital and possibly the other one too, but I do not know their names they were wearing nurses uniforms when they arrived. Of course they may just be exotic performers visiting a customer with a fetish for nurses!"')
	} else if (nR ==
		6010) {
		moveDavyToHotel2();
		bChatLeft = false;
		if (bCharm) addComments('"Why yes, ' + myLord + ".  I saw Davy Robbins enter room 101 with a pretty young girl. Oh! Could you enslave her, " + myLord + "?  I'm sure she would make a nice <i>pet</i> for you...\"");
		else addComments('"Davy Robbins?  Is he a friend of yours?" She asks, giving you a warm smile.  "Now don\'t go spreading it around that I give out stuff like this...  But he just rented room 101 a little bit ago."</p>')
	} else if (nR == 10701) {
		if (!per.checkFlag(8))
			if (perYourBody.NoItems <
				perYourBody.MaxItems) {
				perYourBody.PutItem(6);
				per.setFlag(8);
				addComments('<p>"Is there anything <i>else</i> you would like, ' + myLord + '?" She asks, kneeling at your feet, then daring to look up at you with desire in her eyes.</p>')
			} else addComments("<p>You reach for the stone, but realize that you don't have room for it in your bag.</p>")
	} else if (nR == 10702) {
		per.setFlag(4);
		per.showPerson("bambimother.jpg", "25%", "left;margin-bottom:1em;margin-right:5px", "", "", false, "comments");
		addComments('<p>"' + myLord +
			', that is my mother, we did some photo-shoots for some magazines and websites sometime ago.", she somewhat proudly explains, kneeling at your feet.</p>' + '<p>"I am sorry ' + myLord + " if you desire her you will have to wait, she is currently on holiday in New Zealand. I will present her to you once she returns home!\". You are surprised at her complete lack of reservation at offering her mother to be enslaved, and actually sounding eager for it! Bambi's loyalty and perversion seem boundless.</p>")
	} else if (nR ==
		10801) {
		bChatLeft = false;
		if (!bCharm)
			if (isBritish())
				if (nMoney > 4) {
					addComments('"Sure that will be ' + sCurrency + "5\" She says with a wink. You hand over the money, it is a bit expensive, and you can't keep down more than a sip.  Why do people <i>drink</i> these?");
					AddCash(-5)
				} else addComments('"Sure that will be ' + sCurrency + '5" She says with a wink. Unfortunately you do not have enough money!');
		else addComments('"Scotch, eh?" she says, amused at your courage and taking a close look at you. "Are you sure you\'re even old enough to drink?  Why don\'t you come back when you have a few more... <i>years</i> on you." She says with a wink.');
		else if (isBritish()) addComments('"Sure thing" she says as she whips up your scotch.  "Anything else, ' + myLord + "?\" She whispers as she hands you the drink.  You can't keep down more than a sip.  Why do people <i>drink</i> these?");
		else addComments('"Aren\'t you a little young for that?" She asks loud enough to keep up appearances as she whips up your scotch.  "Anything else, ' + myLord + "?\" She whispers as she hands you the drink.  You can't keep down more than a sip.  Why do people <i>drink</i> these?")
	} else if (nR ==
		10802) {
		bChatLeft = false;
		addComments("\"You're a little forward, aren't you? I don't usually give customers extra service " + myLord + ', but in your case..." She eyes you up and down and you suddenly feel as if you\'re nothing more than a piece of meat. Then she continues, "I think ' + sCurrency + '100 should buy you some of my time."');
		per.other = 5
	} else if (nR == 10805) {
		AddCash(-100);
		per.setFlag(33);
		addComments('<p>She raises an eyebrow but still takes your money.  "Follow me." She says, leading you up to her room.</p>');
		Place = 133
	} else if (nR == 10806) {
		AddCash(-50);
		per.setFlag(34);
		addComments('<p>"Thank you, ' + myLord + ", it'll be worth it,\" She says as you dig into your pocket for the cash.</p>");
		Place = 183
	} else if (nR == 10900) {
		setPersonFlag("DoctorKay", 4);
		setPlaceFlag("Hotel", 12);
		bChatLeft = Place != 124;
		if (isDay()) addComments("You ask Bambi.</p>" + "<p>\u201cIs there any news from around town or any new arrivals at the hotel that are worth knowing about?\u201d</p>" + "<p>\u201cWell, there is the new nurse of course, she is staying here in Room 205 but she is not here that often. I believe during the day she is covering for the High School nure and if not she\u2019s normally at the Hospital or Pool.\u201d");
		else addComments("You ask Bambi,</p>" + "<p>\u201cIs there any news from around town or any new arrivals at the hotel that are worth knowing about?\u201d</p>" + "<p>\u201cWell, there is the new nurse of course, she is staying here in Room 205 but she is not here that often. I saw her walk out of the hotel not long ago but I don\u2019t know where she went.\u201d")
	}
	return true
}

function initialiseBambi() {
	addPerson("Bambi", 124);
	per.Replies = RepliesBambi;
	per.getYourNameFor = function() {
		return perYou.getLord()
	};
	per.getPersonName = function(full) {
		if (full === true) return "Bambi";
		return this.isCharmedBy() ? "Slave Bambi" : "Bambi, the Barmaid"
	};
	per.isPersonInfo = function() {
		return this.isCharmedBy()
	};
	per.getPersonInfo = function() {
		if (Place == 161 && this.checkFlag(7)) return "<img src='Images/bambiguard1.jpg' class='imgpopup' alt='Bambi'>" + "Bambi became a loyal soldier in your regiment of slaves. She explained that she knows that the Hotel will be an important place in your quest. The cunning redhead reassured you that she feels stupid that she tried to outsmart you and understands now that resistance against you is futile. Bambi is a smart lady and has a great deal of information about Davy that she is ready to give you anytime you wish. She told you that Davy is regularly visiting the Hotel for reasons still unknown. She already tried to seduce him, but Davy wasn\u2019t interested in her which is strange because not many people can resist the charms of Bami.<br><br>" +
			"Bambi is watching over your slaves in the dungeon. She acknowledges your presence and offers you a riding crop to use on a slave's ass.<br><br>" + '"How can I serve you ' + perYou.getLord() + '!?", she grins mischievously.';
		return "<img src='Images/bambi11a.jpg' class='imgpopup' alt='Bambi'>" + "Bambi became a loyal soldier in your regiment of slaves. She explained that she knows that the Hotel will be an important place in your quest. The cunning redhead reassured you that she feels stupid that she tried to outsmart you and understands now that resistance against you is futile. Bambi is a smart lady and has a great deal of information about Davy that she is ready to give you anytime you wish. She told you that Davy is regularly visiting the Hotel for reasons still unknown. She already tried to seduce him, but Davy wasn\u2019t interested in her which is strange because not many people can resist the charms of Bami.<br><br>" +
			"Bambi is standing behind the bar table serving drinks to guests. She acknowledges your presence and guides you to a free chair. She runs a hand through your shoulders and back, but quickly returns to other side of the bar table so no one can see your intimate moment with her.<br><br>" + '"How can I serve you ' + perYou.getLord() + '!?", she grins mischievously.'
	};
	per.getPersonAddress = function() {
		return this.isCharmedBy() ? "Broken In Hotel" : ""
	};
	per.getPossessionFace = function() {
		if (this.isCharmedBy()) return "bambi9";
		return "bambi8"
	};
	per.whereNow = function() {
		if (Place == 182) return Place;
		if (this.place == 124 && this.checkFlag(7) && !isDay()) {
			var nSlaves = wherePerson("Jessica") == 161 ? 1 : 0;
			if (perDavy.whereNow() == 161) nSlaves++;
			if (nSlaves > 0) return 161
		}
		return this.place
	};
	per.passTimeDay = function() {
		this.setFlag(12, false);
		this.setFlag(15, false);
		return ""
	};
	per.showEventPopup = function() {
		if (sType !== "") return false;
		if (this.isCharmedBy() && Place == 123 && !this.checkFlag(1)) this.setFlag(1);
		if (this.isHere() && this.isCharmedBy()) {
			var perJessica =
				findPerson("Jessica");
			if (perJessica.getRivalry() > 0 && !checkPlaceFlag("Hotel", 9)) {
				var s = "<img src='Images/bambi11b.jpg' class='imgpopup' alt='Bambi'>" + "You speak to Bambi and ask her to secure the cellar, and let no one into it except for yourself.";
				if (!perJessica.isRival()) s += "<br><br>You also tell her about Jessica who is bound and chained there and ask her to look after Jessica while you sort out how to free her.<br><br>Bambi smiles,<br>" + '"Of course, everyone needs a slave in a basement. I will take care of her with all my skill. This is an opportunity to tidy and refit the cellar for a better use."';
				showPopupWindow("Bambi and the Cellar", s, "setPlaceFlag('Hotel', 9);")
			}
			if (isDavyDefeated() && perDavy.place != 184 && !this.checkFlag(9) && !checkPersonFlag("Anita", 6) && checkPersonFlag("Anita", 8)) {
				this.setFlag(9);
				if (perDavy.isDead()) {
					showPopupWindow("Anita is here?", "<img src='Images/bambi11b.jpg' style='width:30%;float:right;margin-left:5px' alt='Bambi'>" + "You are curious about Davy and Anita and head towards the hotel room Davy is in but Bambi stops you respectfully,</p>" + '<p>"' + this.getYourNameFor() + ", if you are after the guest Davy Robbins, he is no longer in the room. I noticed recently when I checked on him that he was gone, but I cannot locate him. I was about to call you, even though I know I would disappoint you with my failure.</p>" +
						"<p>A strange young woman was at the bar recently, I suspected she may of been one of your servants but she did not want to talk, she just had a few drinks and then left sometime later.</p>" + "<p>I am sorry " + this.getYourNameFor() + ', please punish me for allowing him to escape, I can suggest many interesting ways of punishment and offer a wide range of tools?"</p>' + "<p>You realise Anita has taken Davy somewhere, you are just not sure where? You reassure Bambi that she has done well as always and that the young woman was working on your orders. Bambi looks disappointed, commenting that you can still punish her if you wish, now to reward her for doing well!");
					MoveAnitaToBedroom()
				} else {
					movePerson("Anita", 161);
					movePerson("Davy", 161);
					showPopupWindow("Anita is here?", "<img src='Images/bambi18.jpg' style='width:30%;float:left;margin-right:5px' alt='Bambi'>" + "You are curious about Davy and Anita and head towards the hotel room Davy is in but Bambi stops you respectfully,</p>" + '<p>"' + this.getYourNameFor() + ', if you are after the guest Davy Robbins, your servant Anita visited recently to guard him. I made some suggestions of a more effective way to watch over him and I have give her a change of clothing and some useful equipment. They are downstairs in the cellar"</p>' +
						'<p>She gestures, "If you would wait a few minutes ' + this.getYourNameFor() + ' I will check and then take you to them." You agree and she ' + (!checkPlaceFlag("Hotel", 9) ? 'hesitates and says "' + this.getYourNameFor() + " I did some improvements to the cellar that would improve the experience, I hope that meet your approval." : "leaves.") + "</p><p>A little while later one of the other staff tells you Bambi would like to see you. This does remind you that Bambi is not the only employee here, but there is no time so you head down to the cellar...",
						"dispPlace(161)")
				}
				return true
			}
		}
		return false
	};
	per.showEvent = function() {
		var md;
		if (Place == 269 && sType == "bambipool") {
			WaitHereOnly(6);
			md = WritePlaceHeader();
			this.showPerson("bambi-pool.jpg");
			addPlaceTitle(md, "Swimming with Bambi");
			md.write('<p>Bambi arrives, dressed in a striped bikini, and she seductively poses for you, "' + this.getYourNameFor() + ' like what you see?"</p>' + "<p>You swim for a little with Bambi, but you can clearly see that she is more interested in something else more private.</p>");
			startQuestions();
			addLinkToPlaceC(md, "it is fairly private here...", Place, "type=bambipoolsex");
			addLinkToPlaceC(md, "say goodbye to Bambi", Place);
			WritePlaceFooter(md);
			return true
		}
		if (Place == 269 && sType == "bambipoolsex") {
			md = WritePlaceHeader(false, "td-left-large");
			this.showPerson("bambi-pool-sex.jpg");
			addPlaceTitle(md, "Being Discrete and Private with Bambi");
			md.write("<p>Bambi knows all the private places here, so you retire to a discrete place for some pool-side alone-time with your lovely bar-maid.</p>");
			startQuestions();
			addLinkToPlaceC(md, "later...say goodbye to Bambi", Place);
			WritePlaceFooter(md);
			return true
		}
		if (Place == 161 && this.whereNow() == 124 && isDavyDefeated() && perDavy.place != 184 && this.checkFlag(9) && !checkPersonFlag("Anita", 6)) {
			setPersonFlag("Anita", 6);
			md = WritePlaceHeader(false, "td-left-med");
			perDavy.showPerson("davycellar.jpg");
			addPlaceTitle(md, "Davy in the Cellar");
			if (!checkPlaceFlag("Hotel", 9)) {
				setPlaceFlag("Hotel", 9);
				md.write("<p>You descend the stairs into the cellar and you see Bambi has arranged a quick refit so it is more a dungeon of some sort of BDSM fantasy. You are always surprised at the skill and depravity of Bambi.</p>")
			} else md.write("<p>The cellar or more accurately now the hotel dungeon is mostly dark, but with spot lighting on selected areas and people.</p>");
			md.write("<p>You see Davy securely bound and gagged against one wall of the cellar. Standing in front of him are Bambi and Anita dressed in revealing leather outfits, a fantasy of dominatrix pleasures. Bambi you have no doubt has such an outfit, but Anita? Then you realised, of course Bambi has loaned Anita something from her collection.</p>" + '<p>Bambi greets you "' + perYou.getLord() + ' your servant Anita is somewhat lacking in skills to properly restrain and punish your slave here. I will train her with all my skill to become the best possible guardian of your slave."</p>' +
				'<p>Anita asks you "Are you sure ' + (perYou.isBornMale() ? "Sir" : "Ma'am") + ' that this is what you want? Surely it would be simpler to beat him and then...", you stop her,</p>' + '<p>"No soldier! I want him here and controlled, not tortured. In all matters of guarding your prisoner you will obey Bambi, she is your superior for this duty." Anita salutes you and address Bambi,</p>' + '<p>"Ma\'am I am your to command!", you notice a mischievous glint in Bambi\'s eye and you caution her "Bambi, for this duty, remember that"</p>' +
				'<p>"Of course ' + perYou.getLord() + '", but you know how "imaginative" she is so you will have to check on things here occasionally.</p>');
			startQuestions();
			addLinkToPlace(md, "check the rest of the cellar dungeon", 161);
			addLinkToPlace(md, "go back up to the hotel bar", 124);
			WritePlaceFooter(md);
			return true
		}
		if (Place == 182 && sType == "talkmia1") {
			md = WritePlaceHeader();
			this.setFlag(15);
			this.showPerson("bambi19.jpg");
			addPlaceTitle(md, "Bambi's Request");
			this.showPerson("bambimother.jpg", "25%", "right");
			md.write("<p>You ask Bambi about her message and the other familiar woman, and she gestures for you to follow. She takes you to her private room and as usual starts to remove her clothing. To your surprise she is not stripping for your pleasure but to change her clothing. Well also for your delight but not as the main reason. She gestures at the picture of her mother and herself you have noticed before, and you almost smack yourself. The woman in the SMS message is Bambi's Mother! Bambi addresses you in her customary respectful fashion,</p>" +
				'<p>"' + perYou.getLord() + " I see you recognise her now. My mother Mia is visiting town and I have been trying to convince her to stay here in town. She is a free-spirit, a wanderer who never stays long in one place, earning her way as a model, a dancer, a waitress and other odd jobs. She does not do the sort of work I do aside from my work at the bar, though her dancing can be quite 'exotic' if you know what I mean.\"</p>" + "<p>You take that to mean she does some stripping but does not prostitute herself. Bambi continues dressing, putting on some characteristically skimpy clothes that could be considered athletic, hot pants and a bikini type top, but tight enough for athletic wear. Bambi continues,</p>" +
				'<p>"Of course ' + perYou.getLord() + ' you want us to become your incestuous mother/daughter sex slaves, something I welcome eagerly! My mother has danced with me in the past but nothing more despite a cautious suggestion I made."</p>' + "<p>She finishes dressing and looks at you with some determination in her eyes,</p>" + '<p>"I will now take you to her, we are meeting at the Gym to workout together, and it is your right to take her then and there. Except, please I ask you to delay for a while. I want to spend some time to convince her to stay here of her own free will, to be with her daughter. I can promise you payment to delay, just for one week ' +
				perYou.getLord() + ". I can train and guard your slaves in the dungeon");
			if (wherePerson("Anita") == 161) md.write(" allowing your slave Anita to attend you in your bed");
			md.write(". While teaching your slaves how to better serve you my mother can tend the bar. " + perYou.getLord() + ' these are yours no matter what, I am your loyal servant, but again please give me the time?"</p>' + "<p>She is determined, but she will also serve you even if you take her mother immediately. Still, can delaying a week hurt? She gestures towards the door and says one last thing,</p>" +
				'<p>"Shall we leave for the Gym, I have called a taxi to take us there. Before we go, there is one more thing, my mother does own a small gem, set in a ring, that is said to have once been owned by the Warlock Kurndorf. It will be yours once she joins us"</p>');
			startQuestions();
			addLinkToPlace(md, "follow her to the Gym", 435, "type=bambimiagym1");
			addLinkToPlaceC(md, '"Not now Bambi', 124, "", "You tell Bambi you will think about it and will meet her another time. Bambi looks disappointed but redresses and returns with you to the bar");
			WritePlaceFooter(md);
			return true
		}
		if (Place == 182 && sType == "talkmia2") {
			md = WritePlaceHeader();
			this.setFlag(15);
			var perMia = findPerson("Mia");
			var dc = Math.floor((nTime - perMia.charmedTime) / 288);
			if (!checkPersonFlag("Mia", 6) && dc < 7) dc = 1;
			else if (dc == 1 && checkPersonFlag("Mia", 6)) dc = 2;
			setPersonFlag("Mia", 6);
			switch (dc) {
				case 1:
					this.showPerson("bambi17.jpg");
					addPlaceTitle(md, "About Bambi's Mother");
					md.write("<p>You ask Bambi about how things are going with her mother, she smiles,</p>" + '<p>"Do not worry, she will be your slave soon enough"</p>' +
						"<p>You explain you were not just asking about <i>that</i>, and Bambi smiles again,</p>" + '<p>"' + this.getYourNameFor() + ' I know, I was just kidding. Having my mother around has put me in a good mood!"</p>' + "<p>You ask her to tell you some more about Mia. Bambi replies,</p>" + "<p>\"Mia has always been a free-soul, care-free and uninhibited, a flower-child in spirit if not in actual time. As a mother she was the 'cool mom' laying few restrictions on me. I love her but she seldom stays in one place for long, easily getting tired of experiences, jobs, people.\"</p>" +
						"<p>You ask about her jobs, how Bambi had mentioned dancing and modeling?</p>" + '<p>"Mia has done a range of exotic dancing, mainly burlesque and stripping. She has modeled in glamour and soft-nude type shoots."</p>' + "<p>You talk a little more to Bambi but nothing more important is discussed.</p>");
					break;
				case 2:
					this.showPerson("bambi17.jpg");
					addPlaceTitle(md, "About Bambi's Mother");
					md.write("<p>You ask Bambi about how things are going with her mother, she smiles,</p>" + '<p>"Do not worry, she will be your slave soon enough"</p>' +
						"<p>You explain you were not just asking about <i>that</i>, and you talk a little more to Bambi but nothing more important is discussed.</p>");
					break;
				case 3:
					this.showPerson("miabambi3.jpg");
					addPlaceTitle(md, "Bambi and Mia");
					if (Place == 124) md.write("<p>You ask Bambi about how things are going with her mother, and with a smile suggest you discuss this in her room. She takes your hand and when you get there you ask again, ");
					else md.write("<p>You ask Bambi about how things are going with her mother, and she smiles, ");
					md.write("and then you hear a voice from another room,</p>" + "<p>\"Nosy one is't " + perYou.HeShe() + ' Bambi?"</p>' + '<p>Bambi calls out "Yes Mum, but no more than you are!", and Mia steps out of the bathroom and joins the two of you.</p>' + '<p>Bambi explains, "Mum is just visiting to catch up a bit". You have a chat with them both, but find out very little, but have a pleasant time with the mother and daughter pair.</p>');
					break;
				case 4:
					this.showPerson("miabambi2.jpg");
					addPlaceTitle(md, "Happy Birthday");
					if (Place == 124) md.write("<p>You ask Bambi about how things are going with her mother, and with a smile suggest you discuss this in her room. As you approach her room, ");
					else md.write("<p>");
					md.write('<p>Bambi explains Mai is here again, it is Mia\'s birthday and she start to remove her clothing. You look at her curiously, and puts a finger to her mouth to say "not now"</p>' + '<p>You follow her into the bedroom and Mia is sitting on the bed with some packages, and Bambi joins her. Mia notices you and says "Hi there, Bambi said you might join us"</p>' +
						'<p>They start opening the presents and you see it is lingerie, underwear and some sex-toys. Mia grins, "Gifts we can all enjoy. Maybe sometime I\'ll model them for you". She glances at Bambi she smiles and says "Go for it, why not now?"</p>' + '<p>Mia seems to consider it, but shakes her head, "Not now, another time", and changes the subject. Not long later she excuses herself and leaves. Bambi explains,</p>' + '<p>"Mum avoids anything overtly sexual with me around, such a shame!". You otherwise leave things there for now!</p>');
					break;
				case 5:
					this.showPerson("bambi17.jpg");
					addPlaceTitle(md, "About Bambi's Mother");
					md.write("<p>You ask Bambi about how things are going with her mother, she smiles,</p>" + '<p>"Do not worry, she will be your slave soon enough"</p>' + "<p>You explain you were not just asking about <i>that</i>, and you talk a little more to Bambi but nothing more important is discussed.</p>");
					break;
				case 6:
					this.showPerson("miabambi1.jpg");
					addPlaceTitle(md, "Mother and Daughter");
					if (Place == 124) md.write("<p>You ask Bambi about how things are going with her mother, and with a smile suggest you discuss this in her room. As you approach her room, ");
					else md.write("<p>");
					md.write("<p>Bambi explains Mai is here again, and as she does Mia steps out, completely naked. As you look appreciatively you see out of the corner of your eye Bambi stripping, and then she joins her mother. Before you a pair of beautiful women, all the more attractive as they are mother and daughter.</p>" + '<p>You hope this will lead somewhere physical, but Mia shakes her head gently, and you know this still means "not with Bambi". Still they remain completely naked and sit down and expect you to have a pleasant chat with them, not mentioning why the nakedness.</p>');
					break;
				default:
				case 7:
					this.showPerson("bambi17.jpg");
					addPlaceTitle(md, "About Bambi's Mother");
					md.write("<p>You ask Bambi about how things are going with her mother, she smiles,</p>" + '<p>"' + this.getYourNameFor() + ', thank you, I have had enough time. I was unable to convince my mother to stay in town. Please will you make her your slave so she stays here?"</p>' + "<p>You ask about the promised reward, and she says she will give it once Mia is your slave.</p>");
					if (!isPlaceKnown("MiasApartment")) {
						setPlaceKnown("MiasApartment");
						md.write('<p>She continues, "My mother has an apartment on Celeste Rd" and she gives you the address. "You could visit her there to \'convince\' her to stay"</p>')
					}
					break
			}
			startQuestions();
			addLinkToPlace(md, "talk to Bambi about other things", 182);
			WritePlaceFooter(md);
			return true
		}
		if (this.isHere() && sType == "transformbreasts") {
			CastTransform(1);
			this.setFlag(16);
			md = WritePlaceHeader(true, "", "black");
			showPopupWindow("Transformation", '<img src="Images/GenericSex/be c.gif" style="width:50%;float:left;margin-right:6px;margin-top:1em;margin-bottom:2em" alt="BE">' +
				'<p>You cast the spell and Bambi groans, "Ah ' + perYou.getLord() + ' what is this?" and pulls apart her top. You see her breasts swelling, growing larger and larger, her modest sized breasts growing to quite large.</p>' + "<p>As she groans you thought you heard some laughing, a customer elsewhere in the hotel maybe. Bambi sighs as her breasts stop growing, and she says, panting a little,<p>" + '<p>"' + perYou.getLord(true) + ' I am yours anyway, but I had always liked my breasts as they were. If I thought customers wanted more I would of sought augmentation. I know men prefer larger generally, but not all. Still, if you could do this on demand, you could make a fortune!."</p>' +
				"<p>A business doing magical augmentations? You do not think you could control the spell enough to do this reliably, and there is the question of mana. You look at Bambi, she seems to have recovered and accepted her new attributes, and is weighing up the possibilities.</p>");
			setQueryParams("");
			WritePlaceFooter(md, "", true, true);
			return true
		}
		return false
	};
	per.showPersonChat = function(bGeneral, md) {
		if (sType !== "" || !this.isHere()) return;
		var myLordB = this.getYourNameFor();
		if (Place == 124 && !this.isCharmedBy("You")) {
			if (this.other ===
				0) addPopupLinkC(md, "introduce yourself to the barmaid", "Bambi", "<img src='Images/bambi11a.jpg' class='imgpopup' alt='Bambi'>" + '"Well hello there, ' + myLordB + ".  My name's Bambi.  What would you like to drink " + (isDay() ? "today" : "tonight") + '" She asks with a smile.<br><br>' + "You look at the barmaid, she is dressed rather scantily for a good quality hotel as you understand the 'Broken Inn Hotel' is <b>now</b>. She spoke formally, she is an odd mixture of the polite and the erotic.<br><br>" + (isBritish() ?
					"You could order a drink, but so far you have not really developed a taste for it" : "You are not yet old enough to legally drink, but you could try to order a drink, you look old enough...hopefully") + ".<br><br>" + "As you consider you notice on one of the shelves a riding crop, you had not heard there was any horse riding in the immediate area. The barmaid notices your glance,<br><br>" + '"A gift from a grateful customer, for a lesson", so you ask her if she gives riding lessons. She smiles,<br><br>"Yes ' +
				myLordB + ', <i>riding</i> and also other lessons too"', false, "setPersonOther('Bambi', 1);dispPlace();");
			if (this.other == 1) addQuestionC(md, 'tell Bambi "Is there any way I could get to know you a little better?"', "Bambi", 10802);
			if (this.other == 5 && nMoney >= 100) addQuestionC(md, "slip " + sCurrency + '100 across the bar - "This enough?"', "Bambi", 10805);
			return
		}
		if (Place == 161 || Place == 124) addLinkToPlace(md, "take your slave Bambi to her room", 182);
		if (Place == 161 || Place == 124 || Place == 182) {
			if (perDavy.checkFlag(5) && (!perDavy.checkFlag(7) &&
					!perDavy.checkFlag(8))) addLinkToPlaceC(md, '"Can you help me with Davy"', 184, "type=restrainlater");
			if (perYou.checkInjury(5) && !perYou.checkInjury(8)) addQuestionC(md, "ask Bambi what happened in the cellar", "Bambi", 922);
			if (Place != 124 && this.checkFlag(7) && !this.checkFlag(15) && !isCharmedBy("Mia")) addLinkToPlaceC(md, '"Bambi, how are things with your mother?"', 182, "type=talkmia2");
			if (perGates.checkFlag(6) && !isPlaceKnown("AvernusClub")) addQuestionR(md, '"Is there a gentlemans club in Glenvale?"', "You ask Bambi about the gentlemans's club you were told about, it seems likely she would know given her side business entertaining customers. Bambi promptly answers,</p>" +
				'<p>"Of course, I used to work there reguarly as a dancer. I had a falling out with someone there, <font size="-1"><i>that bitch</i></font> so I no longer work there."</p>' + "<p>She gives you directions to the club, it is located in a side street off the shopping center. The club is open late at night until the early hours and is by invitation only. She quickly makes a phone call, and tells you,</p>" + '<p>"I still have friends there, you are now my personal guest for the club, you can visit any time you want"',
				"Bambi", "setPlaceKnown(\\'AvernusClub\\')" + (Place == 124 ? ";bChatLeft=false" : ""));
			if (checkPersonFlag("Catherine", 10) && !checkPersonFlag("DoctorKay", 4)) addQuestionC(md, "ask Bambi if there is anyone new around", "Bambi", 10900);
			var perAnita = findPerson("Anita");
			if (!isDay() && this.checkFlag(7) && isDavyCaptive() && perDavy.place == 184 && (perAnita.place == 9999 || perAnita.other >= 900 || perAnita.checkFlag(8) && perAnita.place == 46)) addPopupLinkC(md, '"Could we do something different with Davy?"', "Relocating Davy", "<img src='Images/bambiguard2.jpg' class='imgpopup' alt='Bambi'>" +
				"You decide ask Bambi about doing something else with Davy, just leaving him in a hotel room seems a bit risky. You both go into the room with Davy and Bambi suggests moving him to the cellar, and how she could take care of him there now Mia is around to help out.</p>" + "<p>You both take Davy down to the cellar and Bambi secures him in this, well a dungeon than a cellar now.", false, 'movePerson("Davy",161);setPlaceFlag("Hotel",9);dispPlace(161);', undefined, "background-color:white;color:black;text-shadow:-1px 0px white, 0px 1px white, 1px 0px white, 0px -1px white;")
		}
		if (Place ==
			124)
			if (this.checkFlag(11) && wherePerson("Mia") === 0) addLinkToPlaceC(md, '"Bambi, about your message?"', 182, "type=talkmia1");
			else {
				if (this.checkFlag(7) && !this.checkFlag(12) && isShopOpen(4, 2, true)) addLinkToPlaceC(md, '"Bambi, do you plan to go to the Gym today?"', 435, "type=bambimiagym2")
			}
		else if (Place == 182) {
			if (this.checkFlag(1) && !this.checkFlag(2)) addLinkToPlaceC(md, "ask Bambi about her career", 182, "type=bambichat1")
		} else if (Place == 161)
			if (perDavy.isHere()) {
				addLinkToPlace(md, "have Bambi train Davy", 161, "type=playdavybambi");
				if (wherePerson("Anita") == 161) addLinkToPlace(md, "have Bambi and Anita team up to train Davy", 161, "type=playdavyteam")
			}
	};
	per.showPersonTextHere = function(md) {
		if (Place == 124 && this.isHere())
			if (this.other === 0) md.write("<p>At this time of the day there are only a few patrons at the bar. The barmaid welcomes you to the hotel and asks what you would like.</p><p>");
			else md.write("<p>At this time of the day there are only a few patrons at the bar. Bambi welcomes you to the hotel and asks what you would like.</p><p>");
		else if (Place == 161 && this.isHere() && perDavy.isHere())
			if (wherePerson("Anita") == 161) md.write("<p>Your rival Davy is bound against one wall, guarded by your loyal slaves Bambi and Anita.</p>");
			else md.write("<p>Your rival Davy is bound against one wall, guarded by your loyal slave Bambi.</p>")
	};
	per.handleItem = function(no, cmd) {
		if (cmd == 1 && (no == 52 || no == 64)) {
			var s = getSoulBoundCrystal(no);
			if (s != "")
				if (this.isHere() && !this.checkFlag(16)) {
					if (!this.isCharmedBy()) examineItem(no, "The " + s + " trembles weakly, you suspect you need a magical link to Bambi before it will work.");
					else if (Place != 182) examineItem(no, "The " + s + " trembles slightly, maybe it would react better in another location with Bambi.");
					else examineItem(no, "The " + s + " vibrates softly the closer you get to Bambi.");
					return "handled"
				}
		} else if (no == 14 && cmd == 2) {
			if (Place == 133 || Place == 134 || Place == 183 || Place == 182) {
				CastCharmSpell("Bambi", 135, 1);
				return "handled"
			}
		} else if (no == 18 && cmd == 2)
			if (Place == 182 || Place == 124 && this.isHere()) {
				if (this.checkFlag(16)) {
					addComments("You have already transformed Bambi!");
					return "handled"
				}
				if (!this.isCharmedBy()) {
					addComments("The spell washes over her but nothing happens, you seem to need a magical link to her");
					return "handled"
				}
				if (Place == 124) {
					addComments("The spell washes over her but nothing happens, for some reason it does not work in such a public place as the bar.");
					return "handled"
				}
				if (!CastTransform(1, true)) return "handled";
				ClearComments();
				dispPlace(Place, "type=transformbreasts");
				return "nofooter"
			}
		return ""
	};
	per.isPhoneable = function() {
		return checkPlaceFlag("Hotel", 11) && Place == 269 && this.isCharmedBy()
	};
	per.callThem = function() {
		if (Place == 269) {
			receiveCall("", 'While you could just walk out and talk to Bambi you call her anyway to invite her to join you at the pool for a swim, and she answers, "Yes ' +
				per.getYourNameFor() + ', I will take a break and join you.". A couple of minutes later she joins you..');
			gotoPlace(Place, "type=bambipool");
			WriteCommentsFooter(bChat, bChatLeft)
		}
	};
	per.addPersonPhoneCall = function() {
		if (this.checkFlag(3))
			if (makeCall(true, 80)) {
				this.setFlag(3, false);
				this.setFlag(10)
			}
		if (isDay() && this.checkFlag(4) && !this.checkFlag(11) && Place != 124 && Place != 133) {
			var perAnita = findPerson("Anita");
			if (perAnita.place == 161 || perAnita.place == 9999 || perAnita.other >= 900 || perAnita.checkFlag(8) && perAnita.place ==
				46 || perDavy.place == 9999) {
				var perJessica = findPerson("Jessica");
				var jr = perJessica.getRivalry();
				if (perJessica.isRival() || !perJessica.isRival() && perJessica.getRivalry() < 0 || isDavyDefeated())
					if (makeCall(true, 81)) this.setFlag(11)
			}
		}
		if (this.checkFlag(11) && this.checkFlag(7) && !this.checkFlag(13) && !isCharmedBy("Mia"))
			if (Math.floor((nTime - per.charmedTime) / 288) > 6)
				if (makeCall(true, 82)) this.setFlag(13);
		if (this.checkFlag(7) && !this.checkFlag(14) && this.whereNow() == 161 && Place != 161)
			if (makeCall(true, 83)) this.setFlag(14);
		return false
	};
	per.getPersonSMS = function(id) {
		if (id == 80) return receiveSMS("Broken Inn Hotel", "Congratulations you have been selected to receive a free nights accommodation at the historic Broken Inn Hotel. Our friendly staff will be happy to cater to all your needs. Ask about our wedding packages! ", "hotel3.jpg");
		if (id == 81) return receiveSMS("DevotedBambi", this.getYourNameFor() + " may I see you when you have some time? I have something to offer, in return for a small favour", "bambisms1.jpg") + replyToSMS("Who is the woman with you Bambi, she looks familiar? A customer?") +
			receiveSMS("DevotedBambi", "No, she can have anything I offer for free. She is what I want to discuss, but please, in person");
		if (id == 82) return receiveSMS("DevotedBambi", this.getYourNameFor() + ", thank you, it has been enough, she can be yours now", "bambisms2.jpg");
		if (id == 83) return receiveSMS("DevotedBambi", "Guarding can be so hot and hard, want to show me the ropes?", "bambisms3.jpg");
		return ""
	}
}
var perBeasley;

function RepliesBeasley(nR) {
	var perB = per;
	var myName = perB.getYourNameFor();
	var perKate = findPerson("Kate");
	var nm = perB.getPersonName();
	var a = Math.random();
	var ret = true;
	if (nR == 190) {
		if ((isMurderPath() || perGates.other == 700) && perB.other < 3) perB.other = 1;
		perB.setFlag(7);
		addComments('<img src="UI/books/book1.png" style="float:left;width:15%;margin:0 5px 5px 0">"The book? Oh yes the book. Where did you... never mind. Only a person who has mana can use the book. Perhaps, if you give it to me, I can help you?"</p>' +
			"<p>He looks at the book again, and continues,</p>" + '<p>"Give me the book to study, together we can discover the secrets it contains. I am an expert in the occult and magical practises, more so than someone like ' + perGates.getPersonName() + '"</p>' + "<p>He seems to be trying hard to convince you...</p?")
	} else if (nR == 187) {
		WriteCommentsHeader();
		perB.setFlag(6);
		addComments('You tell him, "No way, I have the book and I will keep it!"')
	} else if (nR == 189) {
		if ((isMurderPath() || perGates.other == 700) && perB.other <
			3) perB.other = 1;
		perB.setFlag(8);
		WriteCommentsHeader();
		if (perGates.other == 700) addComments("<p>Then again, you are not sure you trust Mr. Beasley.</p>");
		else addComments("<p>Then again, you are " + perGates.getPersonName() + "'s apprentice, and he should be able to give you all the help you need.</p>")
	} else if (nR == 191) {
		perB.other = 2;
		addComments('"You do not know what mana is! Don\'t you listen in class? It is the power of magic. Without it, a warlock is powerless."')
	} else if (nR == 192) {
		if (isMurderPath() || isConspiracyPath()) perYou.completeQuest(1);
		perB.other = 3;
		if (perGates.other == 9) perGates.other = 10;
		setPlaceKnown("WildRanges");
		setPlaceKnown("Park");
		PlaceI(5, 26);
		addComments('"Rumour has it," he says with an overly dramatic sigh, "that mana can be found at the stones in the wild ranges, to the north of the park. Oh, and usually is stored in special stones of some kind. Now please let me get on with my work."')
	} else if (nR == 193) {
		perB.other = 4;
		addComments("\"It is a complex spell called 'Possession', one that has cost me a lot of money to research. I would, of course, require compensation for all of this effort on your behalf.\"")
	} else if (nR ==
		194) {
		perB.other = 5;
		addComments('"Oh..." he says, eyeing you up and down in a way that makes even you feel uncomfortable. "I would imagine ' + sCurrency + "100 should cover my expenses.  Sound good to you, " + myName + '?"')
	} else if (nR == 195)
		if (nMoney < 100) addComments('"What is this?" He asks.  "There is only ' + sCurrency + nMoney + ' here.  Come back when you have enough."');
		else {
			perB.other = 6;
			AddCash(-100);
			addComments('"Pleasure doing business with you, ' + myName + '," he says as he slips your cash into his wallet.');
			if (!isRunes()) {
				bChatLeft = false;
				setQueryParams("type=learnpossession")
			} else {
				Research("Spell", "UnstrHun");
				ret = false
			}
		}
	else if (nR == 196) {
		addComments('"Go ahead and give it a try..."');
		if (!isRunes()) {
			bChatLeft = false;
			setQueryParams("type=learnpossession")
		} else {
			Research("Spell", "UnstrHun");
			ret = false
		}
	} else if (nR == 1931) {
		addComments('"Yes Mistress, of course," ' + perBeasley.getHeShe() + ' says, groveling before you. "Tell me how I may serve you."');
		if (perB.other == 6) {
			addComments("Suddenly remembering something, he frantically begins rummaging through his pockets and desk drawers.<br>");
			addComments('"Ah, here..." he mumbles.  "Please take back your ' + sCurrency + '100, Mistress, I should not have dared ask you for it."<br>');
			addComments("Mr. Beasley gives you " + sCurrency + "100.");
			AddCash(100)
		} else perB.other = 7
	} else if (nR == 579) {
		addComments('"I have no idea where the book is. Leave me alone or you will regret it."');
		setPersonOther("Diane", 10)
	} else if (nR == 700) {
		addComments("You ask Mr. Beasley if he knows about demonology and how to free someone from being enslaved by a demon,</p>" + '<p>"Well ' +
			myName + ', I know the basics of how to summon a demon at certain <i>thin</i> or powerful places. They will then do you will, both carnal and mundane, but you must be very careful. They will obey any deal to the letter, but will try to twist and corrupt it for their pleasure where possible."</p>' + '<p>This is not quite what you wanted and ask again on freeing a person, and he shakes his head "No, nothing on freeing a person"</p>');
		setPersonFlag("Leanne", 11)
	} else if (nR == 5501) {
		moveDavyToHotel2();
		addComments('"Davy has taken Kate Granger to the hotel, ' +
			myName + '. There he stays at room 101."<br>')
	} else if (nR == 5502)
		if (perYourBody.NoItems < perYourBody.MaxItems) {
			if (perYourBody.FindItem(4) === 0) perYourBody.PutItem(4);
			addComments('"Of course, ' + myName + '," ' + perBeasley.getHeShe() + ' says with an evil grin.  "You can have anything you\'d like."')
		} else addComments('"I would love to, ' + myName + ", but - and I mean no offense - I don't think you could carry any more.\"");
	else if (nR == 5503) {
		perYou.setFlag(25);
		perYou.extra[11] += 9;
		addComments("<img src='UI/hypnosis.jpg' style='width:20%;float:right;margin-bottom:1em;margin-left:5px' alt='Hypno'>" +
			nm + " teaches you a simple technique, a combination of a gesture, a touch and some words that augments hypnosis. It costs 1 mana, and does an instant induction, putting the person into a trance in a few seconds. They are also a little more receptive of your suggestions.");
		updateRightBar()
	} else if (nR == 5504) {
		perYou.setFlag(12);
		setComments('<span onclick="ClearComments();dispPlace()" class="zoom-icon" style="color:black;top:0.5em;right:5%">&#215;</span><div class="conversebubble">' + '<p style="margin-top:0em; margin-bottom: 0.5em;font-size:large;cursor: pointer"><b>' +
			perB.getPersonName() + "</b></p>" + "<img src='Images/" + this.getPossessionFace() + ".jpg' style='width:20%;float:right;margin-bottom:1em;margin-left:5px' alt='Beasley'>" + "You order " + nm + " to tell more about the nature of hypnotism and altering peoples behaviours,</p>" + '<p>"A combination of light hypnosis combined with a magical technique I had learned from my family archives can prepare people for many things. I have been working on the Ross sisters recently, Amy thought it was to help focus on her studies, and her sister Catherine wanted help with her fear of spiders and I offered to help. I was actually trying to bring out their inner slut, to get them to focus on my coc..orders, and it had been remarkably easy."</p>' +
			"<p>A thought crosses your mind as " + perBeasley.getHeShe() + " says this, that your friend, Amy's sister Catherine has no inner slut, from how she talks about her relationships she is <b>all</b> slut! You are surprised about Amy though, but she is always reluctant to talk about relationships, changing the conversation and getting Catherine to talk about some racy details of her last lover.</p>" + "<p>You then ask " + perBeasley.getHimHer() + " to tell you more about the hypnotic technique he mentioned,</p>" +
			'<p>"' + perYou.getMaster() + ' do you understand the basics of hypnosis?", to which you tell him you do not, "Then please study the basics and come back to me for a lesson. The lesson will be the same as other <b>magical techniques</b> and will require some magical experience to learn."');
		alterComments("10%", "85%", function() {
			ClearComments();
			dispPlace()
		});
		return false
	} else if (nR == 5505) {
		perB.setFlag(9);
		if (perB.isCharmedBy()) {
			setComments('<span onclick="ClearComments();dispPlace()" class="zoom-icon" style="color:black;top:0.5em;right:5%">&#215;</span><div style="margin-top:1.5em;margin-bottom:2em;margin-left:4.5em;margin-right:4.5em;margin-left:5vw;margin-right:5vw">' +
				'<p style="margin-top:0em; margin-bottom: 0.5em;font-size:large;cursor: pointer"><b>' + perB.getPersonName() + "</b></p>" + "<img src='Images/" + this.getPossessionFace() + ".jpg' style='width:20%;float:right;margin-bottom:1em;margin-left:5px' alt='Beasley'>" + "You order " + nm + " to tell how he was able to charm both Amy and Catherine, there is no way he knew anything more than the basic Charm spell,</p>" + '<p>"I had been preparing those two for a while now, using light hypnosis combined with a magical technique I had learned from my family archives. Amy thought it was to help focus on her studies, and her sister Catherine wanted help with her fear of spiders and I offered to help. I was actually trying to bring out their inner slut, to get them to focus on my coc..orders, and it had been remarkably easy."</p>' +
				"<p>A thought crosses your mind as " + perBeasley.getHeShe() + " says this, that your friend, Amy's sister Catherine has no inner slut, from how she talks about her relationships she is <b>all</b> slut! You are surprised about Amy though, but she is always reluctant to talk about relationships, changing the conversation and getting Catherine to talk about some racy details of her last lover.</p>" + "<p>You then ask " + perBeasley.getHimHer() + " to tell you more about the hypnotic technique he mentioned,</p>" +
				'<p>"' + perYou.getMaster() + ' do you understand the basics of hypnosis?", to which you tell him you do not, "Then please study the basics and come back to me for a lesson. The lesson will be the same as other <b>magical techniques</b> and will require some magical experience to learn."');
			alterComments("10%", "85%", function() {
				ClearComments();
				dispPlace()
			});
			return false
		} else addComments('"Hypnosis can be deceptively useful, many think it is a trick used by performers to make people act like chickens. It is a powerful psychological tool and with care it can be a useful gateway to memories and to altering peoples behavior...as in to treat fears and the such...Still anything more is too advanced for a student such as yourself."')
	} else if (nR ==
		5600) {
		addComments("You ask " + nm + "about the Book and where it is. With some reluctance " + perBeasley.getHeShe() + " opens the desk drawer and places the book on " + perBeasley.getHisHer() + " desk.</p>");
		if (whereItem(4) == 76) moveItem(4, 11)
	} else if (nR == 1E3) {
		if (a < .2) addComments('"It is not in my research," he replies.');
		else if (a < .6) addComments('"You should look it up yourself," he replies.');
		else addComments('"I am too busy to do your work for you," he replies.');
		perB.setFlag(2)
	}
	return ret
}

function initialiseBeasley() {
	perBeasley = addPerson("Mr Beasley", 11, "Beasley");
	perBeasley.Replies = RepliesBeasley;
	perBeasley.getPersonGender = function() {
		return this.checkAnyFlags(10, 12) ? "woman" : "man"
	};
	perBeasley.getGenderSuffix = function() {
		if (this.checkFlag(10)) return "-bimbo1";
		if (this.checkFlag(11)) return "-bimbo2";
		if (this.checkFlag(12)) return "-bondage";
		return "-male"
	};
	perBeasley.isBornMale = function() {
		return true
	};
	perBeasley.isPersonInfo = function() {
		return true
	};
	perBeasley.getPersonInfo = function() {
		if (!this.isCharmedBy()) return "<img src='Images/People/Beasley/beasley11.jpg' style='width:28%;float:right;margin-left:5px' alt='Mr Beasley'>" +
			"Your least favourite teacher, Mr Beasley. It is not that he is nasty or harsh, you just cannot but help to feel he is a bit slimy; a creep." + "<br><br>" + "While there is nothing you can pin down, aside from his occasional leers at female students, and you have heard he has been reprimanded by the principal for it. It is probably more that he is so assured that he is superior to everybody, descended from the aristocracy and financially well-off." + "<br><br>" + "Yet, with all that, he is brilliant, an expert on science and oddly also matters of the occult, especially where it involves the history of Glenvale. As long as you deal with him carefully and tolerate his ways, then he could be a valuable ally.";
		else {
			if (perBeasley.checkFlag(10)) return "<img src='Images/People/Beasley/beasley-transform-bimbo1.jpg' class='imgpopup' alt='Miss Beasley'>" + "The once mysterious teacher of yours, now a good natured, air-headed bimbo.";
			else if (perBeasley.checkFlag(11)) return "<img src='Images/People/Beasley/beasley-transform-bimbo2.jpg' class='imgpopup' alt='Miss Beasley'>" + "The once mysterious teacher of yours, now a sex-obsessed bimbo slut.";
			else if (perBeasley.checkFlag(12)) return "<img src='Images/People/Beasley/beasley-transform-bondage.jpg' class='imgpopup' alt='Miss Beasley'>" +
				"The once mysterious teacher of yours, now transformed into a cute woman, who seems submissive, but this seems to be on the surface only.";
			return "<img src='Images/People/Beasley/beasley11.jpg' class='imgpopup' alt='Mr Beasley'>" + "The mysterious teacher of yours has finally given in to your powers. He will no longer be an obstacle to your quest, instead he will be more than helpful with anything you wish of him. He admitted that He and Davy had been plotting against you when they first heard about that you came in contact with the power of magic. After apologizing for his previous behaviour Mr Beasley offered his vast knowledge of mind control to you. Your bald headed slave added that he can even teach you hypnotism if you can prove that you are ready for that training."
		}
	};
	perBeasley.getPossessionFace = function() {
		return "beasleyface" + this.getGenderSuffix()
	};
	perBeasley.getPersonName = function(full) {
		return this.getPersonGender() == "man" ? "Mr. Beasley" : "Miss Beasley"
	};
	perBeasley.getYourNameFor = function() {
		if (this.checkFlag(12)) return perYou.getMaster();
		return perYou.getPersonName()
	};
	perBeasley.showEventPopup = function() {
		if (Place == 11 && this.place === 11)
			if (!perBeasley.checkFlag(1)) {
				perBeasley.setFlag(1);
				perBeasley.showPersonInfo(mdCache);
				return true
			}
		if (sType == "pickupbeasleypaper") {
			this.setFlag(14);
			showPopupWindow("Lecture Notes", "<img src='Images/phonenotes.jpg' class='imgpopup' alt='Notes'>" + "This lecture is a good starting point, you have to go and study it somewhere, unfortunately your phone is useless for anything like that.<br><br>" + "Your phone is at least good enough to keep a good set of notes and you regularly record important events and pieces of information in the <b>Notes</b> app there.<br><br>" + "Mind you, that recent problem you had reset your phone, so all previous notes were lost, you will rapidly make up for that! You will have to refill your address book as well!");
			return true
		}
		return false
	};
	perBeasley.showEvent = function() {
		var md;
		if (sType == "learnpossession") {
			md = WritePlaceHeader(false, "td-none");
			addPlaceTitle(md, "What is the Possession Phrase?");
			md.write("<p>Enter the correct phrase for the possession spell:</p>" + '<form method="POST" name="FormChar">' + '<p><input type="text" size="20" name="research">' + '<input type="button" name="button" value="enter" onClick="ResearchOLD(\'S\',document.FormChar.research.value)"></p>' + "</form>" + "</p>");
			startQuestions();
			if (perYou.isBornMale()) addLinkToPlace(md,
				"try again later", 3);
			else addLinkToPlace(md, "try again later", 11);
			AddRightColumnLarge(md);
			if (perYou.isBornMale()) findPerson("MsTitus").showPerson("titus25.jpg");
			else if (perBeasley.isCharmedBy()) this.addPersonFace();
			else this.showPerson("beasley6.jpg");
			WritePlaceFooter(md);
			return true
		}
		if (Place == 11 && sType == "service") {
			var sfx = this.getGenderSuffix();
			md = WritePlaceHeader(false, !isExplicit() && (sfx == "-bimbo1" && perYou.isMaleSex() || (sfx == "-bondage" || sfx == "-bimbo2") && !perYou.isMaleSex()) ? "td-left-large" : "");
			if (this.getCharmedLevel() == 1) this.charmThem(2);
			if (isExplicit() && sfx == "-bimbo1" && !perYou.isMaleSex()) this.showPerson("beasley8g-bimbo1.jpg");
			else if (isExplicit() && sfx == "-male") this.showPerson("beasley8b-male.jpg");
			else this.showPersonRorX(perYou.isMaleSex() ? "beasley8b" + this.getGenderSuffix() + ".jpg" : "beasley8g" + this.getGenderSuffix() + ".jpg");
			if (sfx == "-male") {
				addPlaceTitle(md, "Mr. Beasley's Kiss");
				if (perYou.isMaleSex()) md.write("<p>With a smirk you order Mr. Beasley to give you his chair. The lecherous teacher's mind altered from the effects of your spell have altered his attraction to you, specifically. You see little reason not to capitalize on this situation and enjoy turning the tables on him. Casually you pull down your pants and sit in his chair, leaving your enthralled teacher staring at your cock hungrily.</p>" +
					"<p>Coyly you ask, \u201cSee something you like, Mr. Beasley?\u201d</p>" + "<p>He is swift to reply, \u201cOh yes, " + perYou.getPersonName() + ". Your cock is so beautiful...,\u201d he trails off as if lost in thought.</p>" + "<p>\u201cThen perhaps you should show me how much you admire it with your mouth,\u201d you absently comment as you lean back in his chair. Almost the instant you settle into a relax position your teacher wraps his lips around your cock. His tongue brushes up along the underside vein before tracing lavishly stroking across the head. With a satisfied groan you taunt him, \u201cDespite lusting for all those girls in school you are an eager cocksucker, aren't you?\u201d</p>" +
					"<p>Mr. Beasley responds by moaning at your taunt. Absently his head bobs on your cock in a circular motion. His tongue sweeping across the underside of your cock and slides in similar motion up to the very tip. His hands grab hold of your hips as he worships your cock as if he were one of the girls he once lusted after.</p>" + "<p>\u201cI asked you a question, Mr. Beasley,\u201d you remind him. His mouth lifts itself from your cock as he responds barely an inch from your cock, \u201cYes " + perYou.getPersonName() +
					", I am your eager cocksucker.\u201d You find a bit of amusement in this situation. You press further for reasons unknown, \u201cThat is because deep down you are a cocksucking faggot who has been waiting for a real man to put you in your proper place. On your knees sucking his cock. Isn't that right, Mr. Beasley?\u201d</p>" + "<p>His voice takes a husky tone as he replies, \u201cOh god yes, " + perYou.getPersonName() + ". I want to be on my knees worshiping your glorious cock. I need to feel it in my mouth... I want,\u201d his voice trails off again.</p>" +
					"<p>\u201cTo be my little cocksucking whore, just like a girl. Don't lie to me, you've always been jealous of the fact they could suck a cock while you denied that you craved to be on your knees sucking one,\u201d your own voice taking on a more forceful tone in response.</p>" + "<p>\u201cOnly your cock, " + perYou.getPersonName() + ". I want to suck your cock like the cocksucking whore I am. Please, let me!\u201d</p>" + "<p>You absently allow your teacher to finish what he started. A bit of a surprise comes as his tongue lavishly bathes your balls as his right hand absently wraps around your shaft and begins to stroke it. A satisfied moan leaves your lips as you relax and enjoy the devoted worship of your very manhood. A satisfied smile crosses your lips as he licks up your length and once again engulfs the head.</p>" +
					"<p>With shameless abandon Mr. Beasley proves true to his word, having been converted into a cocksucking whore at that very moment. His head continues to bob itself down your cock as he works his tongue over the sensitive flesh as he moans in pleasure from the warm feeling of your cock gliding in his mouth. His hand encircles the base to milk it as though you had already cum. His other hand cups and massages your balls, hoping to coax his reward from the cock of his glorious student.</p>" + "<p>Your hips thrust upward as the barrage of pleasure from Mr. Beasley's mouth brings you to climax. Your cock pumping cum into his awaiting mouth while his hand attempts to milk it for every last drop. His reward for dedicated worship. Without thinking your teacher swallows very drop before bathing the head with his tongue to clean up every bit of your cum. Once he is finished the man stares up at you, \u201cPlease let me know whenever you need your cocksucker's mouth on your cock, " +
					perYou.getPersonName() + ".\u201d</p>");
				else md.write("<p>Mr. Beasley does not hesitate, dropping to his knees and diving into your crotch.  He begins to lick and it feels like it lasts forever. You enjoy the control over the teacher who will serve you better than any other slave could.</p>")
			} else {
				addPlaceTitle(md, "Fucking Miss Beasley");
				switch (sfx) {
					case "-bimbo1":
						md.write("<p>You answer Miss Beasley, \"Yeah, let's 'Do you' and your wonderful big tits\", and she giggles. Previously <i>he</i> may of chuckled or laughed but never giggled. She start to peel off her top,</p>" +
							'<p>"You mean these massive, all massive, ali mass, funbags?" and she giggles again. You reply, "Yes, these magical tits"</p>' + "<p>She removes the rest of her clothing and kneels down before you, and");
						if (perYou.isMaleSex()) md.write(' pulls down your pants. She uses her hands, mouth and tits to arouse you. It would be hard to call it just a tit-fuck, your cock gets so enveloped by her tits! She asks "Do me now?" and you take her, and fuck your teacher until she squeals in orgasm as you cum into her.</p>');
						else md.write(' lowers you pant and pulls down your panties. She uses her tongue, tits and hands to pleasure you. So strange as she uses her huge tits against your pussy! She asks "Do me too?" and you rub, lick and finger her until you both orgasm.</p>');
						break;
					case "-bimbo2":
						md.write('<p>There seems little need to explain, you pull off the little clothing Miss Beasley is wearing. You know she badly, badly wants this, she seems to think about sex and little else. She groans "Hurry and fuck me!"</p>');
						if (perYou.isMaleSex()) md.write('<p>You pull off your clothing and push her down on her desk, the slut looks up at you, begging you with her eyes. You fuck her, hard and rough, no pretense of foreplay or doing anything other than pleasuring yourself. She cries out and orgasms almost immediately, her pussy contracting around your cock. You fuck her harder as she moans lewdly, and then you cry out "Take it you slut" as you cum hard into her. You feel her orgasm again as you do, and then you pull out, your cum leaking from her pussy.</p>');
						else md.write('<p>You pull off your clothing and push her down on her desk, the slut looks up at you, begging you with her eyes. You straddle her face and tell her "Lick slut!" and she frantically licks you. You glance around and see she is furiously masturbating and feel her hesitate in her licking. You see her body shaking in a self-induced orgasm, but she quickly resumes both licking and masturbating. You play with your breasts as she licks and quickly reach your own orgasm while riding her face. You step off and see she is orgasming again.</p>');
						md.write("<p>You look at your slut of a teacher as she sits up from your fucking, and you can tell she is ready for more.</p>");
						break;
					case "-bondage":
						md.write("<p>You tell Miss Beasley to strip, but she still seems to be reluctant to obey, strange for someone under your charm spell. You order her again, and this time she obeys immediately, but her face shows this is the magic, and totally against her will.</p>" + "<p>Well Miss Beasley is your slave, so she will have to learn to obey and enjoy it. You remove your clothing and order her to ");
						if (perYou.isMaleSex()) md.write('suck your cock to get you ready. She does for a while, in a reasonably skilled way, but you tell her to get up and "It\'s time for your fucking". You fuck her and try to focus on the magic in her and try to enhance her arousal. You feel a change in her, she starts to moan in arousal. You fuck her harder and just as you start to cum you order her to orgasm now! She cries out and you feel her cumming on your cock.</p>');
						else md.write('lick you. She does, surprisingly expertly, and as she does you focus on the magic in her and try to enhance her arousal. You see she starts to play with her pussy and breasts and licks faster. After a while you reach your orgasm and call out to her "Orgasm now!" and you can see she shaking in her orgasm as well.</p>');
						break
				}
			}
			startQuestions();
			if (perDavy.other == 6) addQuestionCO(md, "ask Beasley where Davy has gone", "MrBeasley", 5501);
			addLinkToPlace(md, "exit the room?", 70);
			WritePlaceFooter(md);
			return true
		}
		if (!this.isHere()) return false;
		if (sType == "transformbimbo1") {
			CastTransform(1);
			this.setFlag(10);
			md = WritePlaceHeader(true, "", "black");
			showPopupWindow("Transformation", '<img src="Images/People/Beasley/beasley-transform-bimbo1.jpg" class="imgpopup" alt="TG">' + "<p>You cast the spell and Mr. Beasley gasps and as you watch his chest swells and grows into a huge pair of breasts. Hair grows from his previously bald head and his figure changes to a curvy female form. He..no..she cries out as <i>her</i> shirt rips open as her breasts grow much too large for the male shirt. Her breasts are huge, probably larger even than Ms. Titus's are!</p>" +
				'<p>She asks you raggedly, "What did you do? Was this...umm...what is it called...Ali Massive...Al..Mass...yeah thats it." and she laughs, but it sounds nearer a giggle. She tries to cover up her exposed breasts but it looks more like she is offering them to you. You tell her it was and ask how she is feeling,</p>' + "<p>\"Amazing...it's..whats that word...like...weird and so nice and big...\" she squeezes her breasts. The spell seems to be clouding her mind, but then again you were thinking about bimbo's so maybe this is how <i>Miss. Beasley</i> is now, a good humoured air-head!</p>" +
				"<p>(further content not implemented)</p>");
			setQueryParams("");
			WritePlaceFooter(md, "", true, true);
			return true
		}
		if (sType == "transformbimbo2") {
			CastTransform(1);
			this.setFlag(11);
			md = WritePlaceHeader(true, "", "black");
			showPopupWindow("Transformation", '<img src="Images/People/Beasley/beasley-transform-bimbo2.jpg" class="imgpopup" alt="TG">' + "<p>You cast the spell and Mr. Beasley gasps and as you watch his chest swells and grows into a large pair of inflated, almost balloon-like breasts. Hair grows from his previously bald head and his figure changes to a curvy female form, his lips swell into an exaggerated pout. He..no..she cries out as <i>her</i> shirt rips open as her breasts grow much too large for the male shirt. Her pants rip as her ass out-grows her previously tight pants, and she tears off her pants and shirt. Somehow her underwear has also transformed, into stockings and a garter-belt. You doubt that he was previously wearing these!</p>" +
				'<p>She unsteadily runs out of the classroom, her breast and ass swaying and throwing off her stride. The hallway is fortunately empty at the moment and she slumps down, squatting almost completely naked and exposing her new pussy. She moans and looks terribly distracted and starts the massage her breasts in a sexual fashion. She looks at you, "Fuck me...now...fuck me!", the last is almost yelled.</p>' + "<p>You drag her back into the classroom and " + (perYou.isMaleSex() ? "fuck her as she demanded, hard and fast in her new pussy" :
					"lick her for a few moments until she explosively climaxes. You then make her lick you and she furiously masturbates as she does") + '.</p><p>After, your teacher slumps against her desk and looks up at you, "Again, I still need it..." and she starts masturbating. You remember thinking about bimbo sluts as you cast the spell, and your teacher seems to now be a sex-obsessed bimbo. You are not sure how helpful she will be in future, except as a fuck-toy. Still, you give her again what she asks for.</p>' +
				"<p>(further content not implemented)</p>");
			setQueryParams("");
			WritePlaceFooter(md, "", true, true);
			return true
		}
		if (sType == "transformbondage") {
			CastTransform(1);
			this.setFlag(12);
			md = WritePlaceHeader(true, "", "black");
			showPopupWindow("Transformation", '<img src="Images/People/Beasley/beasley-transform-bondage.jpg" class="imgpopup" alt="TG">' + "<p>You cast the spell and Mr. Beasley gasps and as you watch his chest swells and hair grows from his previously bald head. His figure changes to a slim female form and he unbuttons his shirt in disbelief exposing <i>her</i> breasts. She drops her pants showing a delightful ass and you see a glimpse of a new pussy.</p>" +
				'<p>She asks you incredulously, "You cast Al Mass on me? How did you learn it, it is lost, a spell of legend, not even Kurndorf was supposed to know it!". You tell her yes it was and she advances, intent on hitting you despite the charm spell. You call out for her to stop and instantly she stops moving, a look of disbelief on her face. She demands, "What is this, why can\'t I move?"</p>' + '<p>You have no idea, and for an experiment you tell her to expose herself more. She immediately strips more and looks at you angrily. It seems she must obey your physical orders, interesting! You tell her to do what she wants, and she quick retreats behind her desk. She seems to be able to act normally now, but before despite being charmed she tried to hit you before! To be safe you tell her, "You can never hit me, harm me or work against me in any way" and she answers with her eyes glowing slightly,</p>' +
				'<p>"Yes ' + perYou.getMaster() + '"</p>' + "<p>(further content not implemented)</p>");
			setQueryParams("");
			WritePlaceFooter(md, "", true, true);
			return true
		}
		return false
	};
	perBeasley.handleItem = function(no, cmd) {
		if (cmd == 1 && (no == 52 || no == 64)) {
			var s = getSoulBoundCrystal(no);
			if (s != "")
				if (this.isHere() && !this.checkAnyFlags(10, 12)) {
					if (!this.isCharmedBy()) examineItem(no, "The " + s + " trembles weakly, you suspect you need a magical link to Mr. Beasley before it will work.");
					else if (!perYou.checkFlag(25) || !checkPersonFlag("Catherine",
							5)) examineItem(no, "The " + s + " trembles slightly, something is needed before it will work.");
					else examineItem(no, "The " + s + " vibrates softly the closer you get to Mr. Beasley.");
					return "handled"
				}
		} else if (no == 14 && cmd == 2) {
			if (Place == 11 || Place == 71) {
				if (perYou.isCharmed()) addComments("Why would you try to do that to your Master?");
				else if (perYou.checkFlag(19)) CastCharmSpell("MrBeasley", 179, 1);
				else addComments("The spell fails to work on Mr. Beasley as the spell only affects the feminine.");
				return "handled"
			}
			if (Place ==
				74 || Place == 75) {
				addComments("The spell fails, it is difficult to cast it on just one of the three and the girls are clearly under the influence of Mr. Beasley's charm spell.");
				return "handled"
			}
			if (Place == 76) {
				if (this.checkFlag(3)) addComments("You realise that trying to charm them here with Mr. Beasley present would be a very bad idea and you cannot target Mr. Beasley only.");
				else addComments("The spell fails, the girls are clearly under the influence of Mr. Beasley's charm spell and it is diffuclt to only target Mr. Beasley.");
				return "handled"
			}
		} else if (no == 18 && cmd == 2)
			if (this.isHere()) {
				if (this.checkAnyFlags(10, 12)) {
					addComments("You have already transformed Mr. Beasley!");
					return "handled"
				}
				if (!this.isCharmedBy()) {
					addComments("The spell washes over him but nothing happens, you seem to need a magical link to him");
					return "handled"
				}
				if (!CastTransform(1, true)) return "handled";
				setCommentsNoClick('<div class="conversebubble" style="cursor:default">' + '<table><tr><td width="80%"><p>You remember Catherine\'s desire for revenge and you feel you should try to control Mr. Beasley more. Catherine wanted him "fucked up" and with this in mind you cast the spell. As you do different thoughts cross your mind, different things Catherine had said or shown you at times,</p>');
				addOptionLink("comments", "...huge breasted bimbo's", "ClearComments();dispPlace(" + Place + ",'type=transformbimbo1')");
				addOptionLink("comments", "...sexy bimbo sluts", "ClearComments();dispPlace(" + Place + ",'type=transformbimbo2')");
				addOptionLink("comments", "...that bondage image of Catherine", "ClearComments();dispPlace(" + Place + ",'type=transformbondage')");
				addComments('</td><td width="20%"><img src="Images/People/Beasley/beasleyface-male.jpg" style="width:95%;" alt="Transform"></td></tr></table>');
				return "handled"
			}
		return ""
	}
}

function CamrynDoAction(ontrue) {
	findPerson("Camryn");
	per.other++;
	if (per.charmedTime < 100) per.charmedTime--;
	if (per.other > 17) {
		dispPlace(801, "type=camrynbadend&time=out");
		return false
	}
	if (!per.checkFlag(15))
		if (per.charmedTime < 0)
			if (per.checkFlag(17)) {
				dispPlace(801, "type=livingroombeer");
				return false
			} else {
				per.setFlag(17);
				per.charmedTime = 2;
				dispPlace(801, "type=livingroom&beer=call");
				return false
			}
	if (ontrue !== undefined) dispPlace(801, ontrue);
	return true
}

function initialiseCamryn() {
	addPerson("Camryn");
	per.isPersonInfo = function() {
		return this.isCharmedBy()
	};
	per.getPersonInfo = function() {
		if (isPersonHere("Hannah")) return "<img src='Images/hannahcamryn5.jpg' class='imgpopup' alt='Hannah/Camryn'>" + "<p>Hannah and Camryn turned out to be more alike than even they thought, at least in how much they enjoy having sex.</p>" + "<p>The two of them didn't always see eye to eye in the past, and while recent events and their shared devotion to you made them grow closer, there is still a bit of a rivalry going on between them. Both girls occasionally try to one up the other when it comes to eagerness, dedication or inventiveness, and you do enjoy the benefits of this.</p>" +
			"<p>The two like to put on little shows for you, but this is where their sexual interest in each other ends. They are happy to have both \u201cfound\u201d something they really enjoy doing together and eager to explore their common interest, but treat it more like an eccentric hobby and are usually both happy to focus fully on you.";
		return "<img src='Images/camryn8.jpg' class='imgpopup' alt='Camryn'>" + "<p>Camryn has come to greatly enjoy the double life she is leading ever since you have put her under your spell.</p>" +
			"<p>She is not really all that submissive, but has a laundry list of kinks she always wanted to try, but never dared to, always fearing she would lose her families approval if her tastes came out.</p>" + "<p>Now that she is under your spell, though, this no longer matters. She is able to freely indulge in her newly \u201cfound\u201d promiscuity and the only approval she really craves is yours.</p>" + "<p>And damn, you approve.</p>" + "<p>On the outside, she has redoubled her efforts to give the impression of being a morally upright and slightly prudish girl to her family, friends and coworkers and the only other person she confides in is her similarly enslaved sister Hannah.</p>" +
			"<p>The two have a rough past with each other, but having found common ground in their love for you, they are slowly mending their relationship and growing closer again. Very close at times."
	};
	per.getPersonAddress = function() {
		return isPlaceKnown("CamrynsApartment") ? "Apartment 21, 42 Celeste Rd" : ""
	};
	per.passTimeDay = function() {
		if (this.checkFlag(23) && this.place == 801) this.place = 457;
		return ""
	};
	per.possessThem = function() {
		setQueryParams("type=storeroom");
		setComments("");
		Place = 801;
		return true
	};
	per.dispossessThem =
		function() {
			if (sType == "camrynbadend" || sType == "camrynbadend2") return false;
			if (this.place === 801)
				if (this.checkFlag(21)) {
					movePerson("Hannah", 168);
					addComments("You end the spell and after a moment of disorientation, you return to your own body.</p>" + "<p>You hope that Camryn is still out of it long enough to stay put in the safe-room, but you don't have any time to waste before the rest of the group returns and immediately call Hannah after the possession ended.</p>" + "<p>You have to dissuade Hannah from trying to have phone sex at first, but the moment you mention her sister, she is once again focused, listens to your explanations and agrees to meet you at the police station.")
				} else {
					this.moveThem(1E3);
					movePerson("Hannah", 279);
					addComments("You end the spell and after a moment of disorientation, you return to your own body.</p>" + "<p>You have failed to help Camryn and her fate from now is something you would prefer to not think about.")
				}
			return true
		};
	per.showEventPopup = function() {
		if (Place == 801 && !this.checkFlag(1)) {
			this.setFlag(1);
			this.charmedTime = 100;
			showPopupWindow("Possessing Camryn", "<img src='Images/camryn1.jpg' class='imgpopup' alt='Camryn'>" + "It takes you a while to get adjusted to your new surroundings, and the first thing you notice that you, well, that Camryn must be horribly hungover.</p>" +
				"<p>Your head is pounding, your vision a little blurry, and it seems like Camryn herself was barely conscious before you took over her body.</p>" + "<p>You can always end the possession at any time, <i>click on the portrait or use the end possession link</i>, but what will that mean for Camryn?", "dispPlace(801,'type=storeroom')");
			return true
		}
		if (sType === "") return false;
		if (Place == 801 && sType == "room1invis") {
			showPopupWindow("Invisibility", "<img src='Images/thug1.jpg' class='imgpopup' alt='Thug'>" + "You finish the incantation and hide next to the door just before it opens.</p>" +
				"<p>The man is clearly shocked to see the empty room and immediately checks the sides of the door to make sure you are not hiding here. You have to hold your breath, hoping that your plan works out.</p>" + "<p>He calls out to Camryn, and finally moves into the room to check behind the Cardboard stacks, giving you the chance to slip out, quickly close the door and lock him inside.", "CamrynDoAction('type=livingroom')");
			return true
		}
		if (Place == 801 && sType == "camrynbadend" && getQueryParam("time") == "out") {
			showPopupWindow("Too Slow",
				"<img src='Images/thug3.jpg' class='imgpopup' alt='Thug'>" + "You freeze as you hear a key turn in the door-lock. You must wasted too much time, and as you turn around, you see the very surprised faces of the rest of the group.</p>" + "<p>\u201cBabe?\u201d One of the men steps towards, and you can feel fear from Camryn's mind. \u201cWhat are you doing here?\u201d</p>" + "<p>You try to make up a story to weasel yourself out, but it only takes a little look around for him to realize that you tried to escape. \u201cDon't worry Baby, I'm not mad at you, this misunderstanding was probably my fault.\u201d</p>" +
				"<p>He smiles down to you, and before you are able to say anything, he suddenly presses a piece of cloth with a weird smell against your mouth and your senses begin to cloud over.</p>" + "<p>You struggle against his grasp at first, more by reflex, then you realize you need to get out of Camryn's body, you need to end the \u2026 the... the what again?</p>" + "<p>Your mind is weirdly foggy, there was... something you urgently needed to do, but you don't know what. Good thing Gabe is here and holding you. He whispers sweet words to you about being there for him and tending to his needs...</p>" +
				"<p>They oddly make a lot of sense and you feel your body relaxing and melting in his arms. You listen to him speak, and even after he removes the cloth, you can't help but smile to him and listen to his oh so relaxing voice while your mind happily absorbs everything he tells you...", "dispPlace(801,'type=camrynbadend')", "", true);
			return true
		}
		if (Place == 801 && sType == "livingroom" && getQueryParam("beer") == "call") {
			showPopupWindow("Bad, Really Bad!", "You are startled by a voice from the Garage: \u201cHey Jack, can you get me my beer?\u201d</p>" +
				"<p>Only silence answers, and you realize that this is bad for you.", "dispPlace(801,'type=livingroom')");
			return true
		}
		if (Place == 801 && sType == "livingroom" && getQueryParam("act") == "ridehim") {
			showPopupWindow("Subdued", "<img src='Images/" + (isExplicit() ? "Explicit/" : "") + "camryn21.jpg' class='imgpopup' alt='Riding'>" + "You conjure memories of your many sex filled encounters in the last days to occupy Camryn's mind, and focus on making her see how much she wants to do this and how great it will feel. Her resistance falters enough to allow you to take off your pants and lower your hip on the mans cock.</p>" +
				"<p>There is a brief burst of defiance from her mind as you force him into your, well, her sex, but it is no use now, and her resistance breaks as you begin to roll your hip up and down and lean back to push him against your sensitive areas.</p>" + "<p>It's better than you had imagined, the sensation of being filled, of his shaft grinding against your inner walls... you are suddenly not sure why you ever preferred women to begin with, and while you quickly reach your first climax, you find that you want more... well, -need- more.</p>" +
				"<p>The change is subtle enough for you not to notice it... is it the remainder of Camryn's drug filled escapades last night or the way you subdued her mind?</p>" + "<p>In the end, it doesn't matter, the cock remains rockhard even after the man comes into you, and you just keep riding him, touching your clit, your breasts your hair... everything feels so much more intense right now that you won't even stop as you hear the door behind you and several voices begin talking... male voices.... from men, with more cocks.</p>" +
				"<p>Something in you believes that this is a very bad thing for you, but you are not sure why, more cocks mean more of this great feeling, and the moment one of them gets close enough, you draw him towards you and rub your face against the bulge in his pants.</p>" + "<p>There is more talking about things you don't care about, and you protest at first as they drag you off  that cock, but lucky for you, two others are willing to take his place and they spend the rest of the day taking turns on you before getting ready to leave.",
				"dispPlace(801,'type=camrynbadend')", "", true);
			return true
		}
		return false
	};
	per.showEvent = function() {
		var md;
		if (Place == 269 && sType == "camrynpool") {
			WaitHereOnly(6);
			md = WritePlaceHeader();
			this.showPerson("camryn-pool.jpg");
			addPlaceTitle(md, "Swimming with Camryn");
			md.write("<p>Camryn arrives, dressed in a white bikini, and she takes a seat on the side of the pool to chat with you before going for a swim.</p>");
			startQuestions();
			addLinkToPlaceC(md, "it is fairly private here...", Place, "type=camrynpoolsex");
			addLinkToPlaceC(md,
				"say goodbye to Camryn", Place);
			WritePlaceFooter(md);
			return true
		}
		if (Place == 269 && sType == "camrynpoolsex") {
			md = WritePlaceHeader();
			this.showPerson("camryn-pool-sex.jpg");
			addPlaceTitle(md, "Being Discrete and Private with Camryn");
			md.write("<p>After swimming, you ask Camryn to play with you more privately, and she seductively removes all of her swimsuit and leans against the side of the pool waiting for you to embrace her.</p>");
			startQuestions();
			addLinkToPlaceC(md, "later...say goodbye to Camryn", Place);
			WritePlaceFooter(md);
			return true
		}
		if (Place == 237 && this.place === 0)
			if (isDemonFreed() && Math.floor(nTime / 288) > 5 && isSpellKnown("Possession") && isCharmedBy("Monique") && isCharmedBy("Hannah")) {
				movePerson("Hannah", 457);
				this.moveThem(801);
				return false
			}
		if (Place == 172 && sType == "waithannah") {
			md = WritePlaceHeader();
			movePerson("OfficerBatton", 168);
			WaitHereOnly(12);
			AddImage("police-waitingroom.jpg");
			addPlaceTitle(md, "Waiting with Hannah");
			md.write("<p>In the next 30 minutes, the police station is abuzz, with several officers seemingly being called in from other assignments to assists with the operation while both you and Hannah are being led into a waiting room. You can see both " +
				getOfficer() + " Kahn and Ross arrive at the station to gear up and get into a police van with several other policemen, while only " + getPoliceChief() + " Batton and a core team stays behind to coordinate the operation.</p>" + "<p>The wait is grueling, and especially Hannah is often standing up from her seat and pacing through the room, occasionally asking officers passing by about any news but always getting the same answer that the operation is still underway and she will need to wait.</p>" + "<p>To your surprise, though, she not once asks you for sex. " +
				(checkPersonFlag("Hannah", 13) ? "She speaks to you, and sometimes makes a suggestive comment what  she would like to do with her and you once this is over to take her mind away from the worry," : "She sometimes leans on your shoulder and definitely sees you as her emotional support,") + "but it does seem like there are limits to the extend the spell is able to make you the center of someones world.</p>" + "<p>Finally, after almost 2 hours, " + getPoliceChief() + " Batton enters the room.</p>");
			if (isCharmedBy("OfficerBatton")) md.write("<p>We did it " +
				perYou.getPersonName() + "!\u201d Kerry looks at you with pride as she enters the room. \u201cThe operation has been a full success. We managed to arrest all 5 members of the group and Ms Gifford is well and on her way to the station. We will have to keep her for a day to make sure she is fine and take her testimony, but after that, you will be able to meet her.\u201d</p>" + "<p>Hannah looks like a load has been taken off her mind thanking you with a deep hug (And whispering the promise of far more later into your ear) before doing the same for Kerry and apparently apologizing for what she called her during an incident a few months back.</p>" +
				"<p>Kerry uses the opportunity to cop a feel of Hannah's butt while giving a playful wink to you, and gladly accepts the apology. \u201cWe are all sisters under " + perYou.getPersonName() + "'s care now, right? No need to hold on to old grudges.\u201d</p>");
			else md.write("<p>\u201cMs. Gifford?\u201d She smiles To Hannah. \u201cThe operation has been a full success. Your sister is unharmed and being taken care off, and we managed to arrest all 5 members of the group.\u201d</p>" + "<p>The news takes a load of  Hannah's mind, and she seems close to tears as she gives you a hug and thanks the " +
				getOfficer(false) + " for her help, also mentioning an incident a while back she is apparently really sorry for, now.</p>" + "<p>" + getPoliceChief() + " Batton gladly accepts the apology and explains that Camryn will have to remain in police custody for two more days to make sure she is fine and record her testimony, but Hannah will be able to see her as soon as she arrives at the station, and she thanks you for your help in finding the girl as well.</p>");
			startQuestions();
			addLinkToPlaceC(md, "Return to the station main hall",
				168);
			WritePlaceFooter(md);
			return true
		}
		if (Place == 457) {
			if (sType == "charmcamryn1") {
				md = WritePlaceHeader();
				this.showPerson("camryn11.jpg");
				addPlaceTitle(md, "Camryn Under a Charm Spell");
				md.write("<p>You tell her it'll be easy to explain and ask for a cup of tea as you do, and while Camryn prepares it, you focus on her and quickly recite the spell in well practiced motions. \u201cDai Chu, Camryn!\u201d</p>" + "<p>\u201cBless you!\u201d She shouts from the kitchen nook, and as she returns to you, you already see the first effects of the spell as her nipples begin to press against the fabric of her top.</p>" +
					"<p>\u201cYou know, Hannah really speaks highly of you, and she told me what a big help you were in finding me.\u201d She places the tea on the table and sits down.</p>" + "<p>\u201cI know you are her " + (perYou.isBornMale() ? "boyfriend" : "girlfriend") + ", but if there is -any- way I could properly thank you...\u201d She begins to play with her pants' belt loops, her eyes focused on you as she wets her lips.</p>");
				startQuestions();
				addLinkToPlaceC(md, "ask what she is implying", 457, "type=charmcamryn2");
				WritePlaceFooter(md);
				return true
			}
			if (sType == "charmcamryn2") {
				md = WritePlaceHeader();
				this.showPerson("camryn12.jpg");
				addPlaceTitle(md, "Camryn Under a Charm Spell");
				md.write("<p>\u201cNothing!\u201d Camryn shakes her head. \u201cI would never dare to try to seduce my sisters lover, even if they are... really... " + (perYou.isBornMale() ? "handsome" : "beautiful") + ".\u201d</p>" + "<p>Camryn pulls in her lower lip and begins to pull her pants down a little, but stops herself midway.</p>" + "<p>\u201cNo, no, I really shouldn't be doing this... it's not right... is it?\u201d She looks at you longingly.</p>");
				startQuestions();
				addLinkToPlaceC(md, "not if she wants to be a \u201cgood girl\u201d", 457, "type=charmcamryn3");
				WritePlaceFooter(md);
				return true
			}
			if (sType == "charmcamryn3") {
				md = WritePlaceHeader();
				this.showPerson("camryn13.jpg");
				addPlaceTitle(md, "Camryn Under a Charm Spell");
				md.write("<p>\u201cRight... right...\u201d She nods. \u201cTrying to be the bad girl didn't really work out so well, did it? And trying to seduce my own sisters gorgeous lover, now that would be naughty, would it?\u201d</p>" + "<p>You point out to her that she had actually pulled down her pants completely while she spoke, and that realization seems to take her completely off guard.</p>" +
					"<p>\u201cI'm... just very hot! Warm! I mean, why else would I expose my long sexy legs to you?\u201d She over-crosses her legs, slowly draws her fingers along them and straightens her body, but you can clearly see her twitch nervously as the spell alters her perception into accepting this behavior as normal. \u201cI hope you don't mind the view, I've been working out, you know?\u201d</p>");
				startQuestions();
				addLinkToPlaceC(md, "tell her to cut the charade", 457, "type=charmcamryn4");
				WritePlaceFooter(md);
				return true
			}
			if (sType == "charmcamryn4") {
				md = WritePlaceHeader();
				this.showPerson("camryn14.jpg");
				addPlaceTitle(md, "Camryn Under a Charm Spell");
				md.write("<p>\u201cYou know what I think, Camryn?\u201d She shivers as you speak her name. \u201cI think you like being a bad girl. I think you actually enjoy showing your naked skin to your sisters lover and tease " + perYou.getHimHer() + ".\u201d You lean forward and rest your chin on both hands. \u201cI think you actually are trying to seduce me, are you, Camryn?\u201d</p>" +
					"<p>\u201cWhat? No I...\u201d</p>" + "<p>\u201cShow me your tits.\u201d You interrupt her, and Camryn doesn't waste a second before she almost tears her top open, her voice desperate as she looks at you. \u201cY...you are right... \u201cShe whispers. \u201cI know I shouldn't... why am I doing this?\u201d</p>");
				startQuestions();
				startAlternatives(md);
				addLinkToPlaceC(md, "tell her it's because she likes it", 457, "type=charmcamryn5a");
				addLinkToPlaceC(md, "tell her it's because you command her to", 457, "type=charmcamryn5b");
				endAlternatives(md);
				WritePlaceFooter(md);
				return true
			}
			if (sType == "charmcamryn5a") {
				md = WritePlaceHeader();
				this.showPerson("camryn15.jpg");
				addPlaceTitle(md, "Camryn Under a Charm Spell");
				md.write("<p>\u201cBecause you enjoy it.\u201d You tell her. \u201cAll your life, you have been the \u201cgood girl\u201d, have you not? Pleasing others and watching from afar while Hannah had all the fun, am I right?\u201d</p>" + "<p>Camryn nods sheepishly.</p>" + "<p>\u201cAnd you like it, you like the praise you get, you like the thought of setting a good example, meeting expectations... but deep down, you long to misbehave, to do all the naughty things Hannah got away with all her life, and not be judged for it.\u201d</p>" +
					"<p>\"Yes....\u201d She whispers. \u201cYes, I do...\u201d You watch as her eyes loose focus and the spell capitalizes on the weakness you exposed, the last of her resistance fading away.  As you rise to your feet, you see her body sliding down the chair, helplessly looking up to you. \u201cI want you so much, I know it's wrong but I want you to take me and do all the naughty things with me you are doing with my sister!\u201d She sobs. \u201cOh " + perYou.getPersonName() + ", what should I do?\u201d</p>");
				startQuestions();
				addLinkToPlaceC(md, "give her one last push", 457, "type=charmcamryn6a");
				WritePlaceFooter(md);
				return true
			}
			if (Place == 457 && sType == "charmcamryn5b") {
				this.charmThem(4);
				md = WritePlaceHeader();
				this.showPerson("camryn17.jpg");
				addPlaceTitle(md, "Camryn Under a Charm Spell");
				md.write("<p>\u201cYou are doing this, because I want you to, Camryn. And now, I want you to turn around and present your ass to me.\u201d Camryn seems startled by your admission, even more when she realizes that she indeed is doing as you tell her.</p>" +
					"<p>\u201cHow are you...\u201d</p>" + "<p>You motion her to be quiet and rise to your feet.</p>" + "<p>\u201cWell, first off, I am not Hannah's lover, I am her " + perYou.getMaster() + ", and she is my slave, just as you will be.\u201d You drive your fingers over Camryn's ass and she gasps as you suddenly pull her panties up into her pussylips.</p>" + "<p>\u201cYou can feel it, too, can you? That burning desire you can't explain, the rising need to be touched by me, kissed by me...\u201d You take her hair and roughly pull back her head, your lips close to her ear. \u201cFucked by me.\u201d</p>" +
					"<p>Camryn breathes faster, her heart pounding in her chest as she tries to say something, but only manages to breath out a single word. \u201cHow?\u201d</p>");
				startQuestions();
				addLinkToPlaceC(md, "tell her", 457, "type=charmcamryn6b");
				WritePlaceFooter(md);
				return true
			}
			if (sType == "charmcamryn6a") {
				md = WritePlaceHeader();
				this.showPerson("camryn16.jpg");
				addPlaceTitle(md, "Camryn Under a Charm Spell");
				md.write("<p>\u201cBe yourself, I happen to like bad girls.\u201d You caress her cheek and she nuzzles into your touch. \u201cYou can be the \u201cgood girl\u201d for your parents, your coworkers or your boss... but for me, you'll be my personal, naughty little slut, able to do all the nasty things you always wanted to while knowing with certainty that I not only won't disapprove, but love you for it.\u201d</p>" +
					"<p>\u201cBut Hannah...\u201d You place a finger on her lips. \u201cDoes not mind, in fact, she'll be delighted to finally have something in common with you.\u201d You move your lips close to hers. \u201dThis is about what you want, and you want to be mine, do you?\u201d</p>" + "<p>There is a short moment of hesitation, but soon, a radiant smile forms on Camryn's lips as the spell claims her fully. \u201cYou are right...\u201d She nods. \u201cI want to be yours, I don't know why but I do! So please... don't make me wait any longer...\u201d</p>");
				startQuestions();
				addLinkToPlaceC(md, "kiss her", 457, "", "The two of you share a long passionate kiss, and as your lips untangle, you see a naughty gleam in Camryn's eyes, the spell having completed its work.</p><p>\u201cI'll slip into something more... naughty for you, \u201d" + perYou.getMaster() + "\u201d, just give me a moment.\u201d She says in a teasing voice and vanishes in her bedroom to change out of what is left of her clothes while you sit down and happily finish your tea.");
				WritePlaceFooter(md);
				return true
			}
			if (sType == "charmcamryn6b") {
				md = WritePlaceHeader();
				this.showPerson("camryn18.jpg");
				addPlaceTitle(md, "Camryn Under a Charm Spell");
				md.write("<p>\u201cBecause I'm a " + perYou.getWitch() + ", and I have placed a spell on your sisters mind.\u201d You push down her panties, and give her a good slap on the rear. \u201cShe belongs to me with body, mind and soul, and after she asked me to use my magic to safe you, you became mine by right as well.\u201d</p>" + "<p>You are not entirely sure how you keep coming up with these lines, but as always, you enjoy the rush of power during these games, the sensation of Mana flowing between you and her, feeling her mind struggle fruitlessly against your influence and slowly give in...</p>" +
					"<p>Camryn pleads with you for a last time, but the spell has already claimed her Mind. All you need to do is give her a light push by pulling her body close to yours, placing one hand on her clit, and focusing on the mana within her to push her into a powerful climax.</p>" + "<p>Her body bends and twitches in your grasp, convulsing with every pulse of pleasure you send into her, and as she finally calms down and looks up to you, her eyes only show blissful obedience.</p>");
				startQuestions();
				addLinkToPlaceC(md,
					"order her to wear something sexy and get ready for you", 457, "", "\u201cOf course, " + perYou.getMaster() + "!\u201d Camryn smiles happily. \u201cEverything for you!\u201d She quickly vanishes inside her bedroom to find something more appropriate for her new role to wear, and you calmly sit down and take sip of your tea as you await her return. ");
				WritePlaceFooter(md);
				return true
			}
			if (sType == "charmcamrynwithhannah1") {
				md = WritePlaceHeader();
				this.showPerson("camryn23.jpg");
				addPlaceTitle(md, "Camryn Under a Charm Spell");
				md.write("<p>The three of you talk about the recent happenings, Camryn's role in it and how sorry she is, and finally, the topic falls on you and Hannah, with Camryn curiously asking how you managed to make her sister, who was never interested in " + (perYou.isBornMale() ? "long term relationships" : "women") + " fall for you like that.</p>" + "<p>\u201cAh, that's easy.\u201d Hannah says before you are able to answer. \u201cI knew that I loved " + perYou.getHimHer() + " the moment " + perYou.getHeShe() + " finished casting a spell on me which dominated my mind and bound me to " +
					perYou.getHimHer() + " as a sexslave.\u201d</p>" + "<p>There is a brief moment of silence in which Hannah grins to you and Camryn tries hard to figure out if this was supposed to be a joke.</p>" + "<p>\u201cSo, you met " + perYou.getHimHer() + " at one of these Larp things you used to go to, yes?\u201d Camryn blushes slightly. \u201cI didn't know they get so... kinky.\u201d</p>");
				startQuestions();
				addLinkToPlaceC(md, "show her that Hannah was quite serious", 457, "type=charmcamrynwithhannah2");
				WritePlaceFooter(md);
				return true
			}
			if (sType == "charmcamrynwithhannah2") {
				md = WritePlaceHeader();
				this.showPerson("camryn24.jpg");
				addPlaceTitle(md, "Camryn Under a Charm Spell");
				md.write("<p>You tell Camryn that you indeed bound her sister to your will, and since she does not seem to believe you, you offer a demonstration and cast the spell before she is able to answer. \u201cDai Chu, Camryn!\u201d</p>" + "<p>Camryn eyes the two of you suspiciously, but does not interfere as you guide your mana into her body and finally just breathes out an annoyed sigh. \u201cSorry, I'm not sure what you are trying to do here, but I'm really not into that \u201ckink\u201d and \u201csexy roleplay\u201d stuff.\u201d Her nipples begin to press against the thin fabric of her shirt as she speaks, a fact she does her best to ignore. \u201cEven less when my big sister and her... rather sexy lover are doing it.\u201d Her face flushes some more and you can see her briefly pulling her lower lip inside, as if contemplating something.</p>");
				startQuestions();
				addLinkToPlaceC(md, "she doesn't look like she is not into it", 457, "type=charmcamrynwithhannah3");
				WritePlaceFooter(md);
				return true
			}
			if (sType == "charmcamrynwithhannah3") {
				md = WritePlaceHeader(false, "td-left-med");
				this.showPerson("hannahcamryn7.jpg");
				addPlaceTitle(md, "Camryn Under a Charm Spell");
				md.write("<p>\u201cYou really need to stop lying to yourself about these things, Cam. \u201cHannah suddenly pulls of her pants, rises from the couch and walks towards her sister before you are able to say something. \u201cI know how you always pretended to be annoyed when I told you about my sex-life and yet never stopped me.\u201d She sits down next to her sister and grins to you, playing with the zipper of Camryn's shorts.</p>" +
					"<p>\u201cAnd " + perYou.getPersonName() + " was pretty much in your head recently, I bet " + perYou.getHeShe() + " saw all your dirty little secrets, right?\u201d She looks at you, and give her a confirming nod. Well, it's not like you were able to really probe her mind, but she doesn't need to know that.</p>" + "<p>\u201cWhat? No!\u201d Camryn is clearly startled by her sisters boldness. \u201dI mean, I'm not exactly saving myself for marriage, but I would never engage in the more... deviant acts...\u201d</p>");
				startQuestions();
				addLinkToPlaceC(md, "let Hannah do this", 457, "type=charmcamrynwithhannah4");
				WritePlaceFooter(md);
				return true
			}
			if (sType == "charmcamrynwithhannah4") {
				md = WritePlaceHeader();
				this.showPerson("hannahcamryn8.jpg");
				addPlaceTitle(md, "Camryn Under a Charm Spell");
				md.write("<p>You can't help but think that Hannah has kind of taken control of the situation from you, but she knows her sister better than anyone, and you admit, you like the idea of watching the pair.</p>" + "<p>\u201cThen why are you not stopping me now?\u201d Hannah asks in a teasing voice as she pulls down her sisters shorts and cops a feel of her breasts. \u201cI'm undressing you in front of my lover, no, my " +
					perYou.getMaster() + ", can it get any more \u201cdeviant\u201d than that?\u201d</p>" + "<p>Camryn gasps in shock as she realizes what is happening and tries to push Hannah away. \u201cWhat... what are you doing with me?\u201d</p>");
				startQuestions();
				addLinkToPlaceC(md, "no harm in telling her now", 457, "type=charmcamrynwithhannah5");
				WritePlaceFooter(md);
				return true
			}
			if (sType == "charmcamrynwithhannah5") {
				md = WritePlaceHeader();
				this.showPerson("hannahcamryn9.jpg");
				addPlaceTitle(md, "Camryn Under a Charm Spell");
				md.write("<p>\u201cIt is as your sister said.\u201d You explain to the confused girl. \u201cI have used a spell to turn your sister into my slave, and you will soon be mine as well.\u201d</p>" + "<p>\u201cThat's not... please...\u201d</p>" + "<p>\u201cYou can feel it, can you?\u201d Hannah interrupts her sister and pulls down her shirt. \u201cYour thoughts slowly changing as it takes over your mind? Just relax and let it happen, trust me, it feels really good.\u201d</p>");
				startQuestions();
				addLinkToPlaceC(md,
					"watch the pair", 457, "type=charmcamrynwithhannah6");
				WritePlaceFooter(md);
				return true
			}
			if (sType == "charmcamrynwithhannah6") {
				md = WritePlaceHeader(false, "td-left-med");
				this.showPerson("hannahcamryn10.jpg");
				addPlaceTitle(md, "Camryn Under a Charm Spell");
				md.write("<p>There is a feeble whimper from Camryn's lips, but she does not fight back as Hannah pushes her down onto the couch and straddles her.</p>" + "<p>\u201cYou can't do this, please sis...\u201c Camryn looks up to her sister with her eyes wide open as Hannah pushes her panties down, her voice turning into barely a whisper. \u201cI... don't want to be a slave.\u201d</p>" +
					"<p>\u201cYou already are, Cam.\u201d Hannah's hands caress her sisters breasts and slide down her sides, luring a tender moan from her lips. \u201cYou can finally live out all those dirty little fantasies you always tried to hide from me, Mom and Dad, and we'll finally have something we enjoy doing together.\u201d Hannah grins. \u201dSo just give in, look at " + perYou.getHimHer() + " and tell " + perYou.getHimHer() + " what you are.\u201d</p>");
				startQuestions();
				addLinkToPlaceC(md, "wait for her to speak",
					457, "type=charmcamrynwithhannah7");
				WritePlaceFooter(md);
				return true
			}
			if (sType == "charmcamrynwithhannah7") {
				md = WritePlaceHeader(false, "td-left-med");
				this.showPerson("hannahcamryn11.jpg");
				addPlaceTitle(md, "Slave Camryn");
				md.write("<p>Camryn hesitates, her chest heaving under heavy breathing as she turns to you and allows her eyes to linger.</p>" + "<p>\u201cI... I am...\u201d She pulls her lower lip inside, and Hannah gives her a little push \u201d" + capitalizeFirstLetter(perYou.getHisHer()) + " Slave...\u201d</p>" +
					"<p>\u201cYour slave...\u201d She speaks the words as if tasting them, and you smile in approval.</p>" + "<p>\u201cSay it again.\u201d</p>" + "<p>\u201cI am your slave, " + (perYou.isBornMale() ? "Sir" : "Ma'am") + ".\u201d Camryn repeats, her voice more firm now that the idea takes hold in her mind, and her lips form a wide smile.</p>" + "<p>\u201cHannah is right, " + perYou.getPersonName() + ", I am already yours, please allow me to serve you at my sisters side, my " + perYou.getMaster() + "\u201d</p>");
				startQuestions();
				addLinkToPlaceC(md, "of course she may", 457, "", "Camryn seems overjoyed as you accept her as your own, and the two sisters look at you expectantly.</p><p>\u201cThank you, " + perYou.getPersonName() + ". She gives her sister a tender hug. \u201cI will happily do whatever you want of me.\u201d</p><p>\u201cAnd don't hold back on her, she's more kinky than one might think.\u201d</p><p>\u201cHannah!\u201d</p><p>You chuckle at the banter between the two and rise from your seat, ordering the pair to head into the bedroom and prepare themselves for you.");
				WritePlaceFooter(md);
				return true
			}
			if (sType == "ggshow") {
				md = WritePlaceHeader();
				this.showPerson("camryn5.jpg");
				addPlaceTitle(md, "Good Girl's Show");
				var sm = perYou.isBornMale() ? "sir" : "ma'am";
				md.write("<p>You move close to Camryn and drive your fingers down her side, whispering to her. \u201cI want you in your bedroom and on your knees, and I want your pussy to be wet when I join you, understood?\u201d</p>" + "<p>You give her ass a light slap, and she makes sure to playfully wiggle it for you as she turns around. \u201cYes, " +
					sm + "!\u201d</p>" + "<p>You make sure to wait for a few seconds to allow her to get ready, and when you finally join her, you make a bit of a show inspecting her.</p>" + "<p>\u201cLovely, and rather naughty to put yourself on display like that, is it not?\u201d</p>" + "<p>\u201cYes " + sm + "!\u201d Camryn chuckles softly, her body shivering in excitement as your eyes wander over it.</p>" + "<p>\u201cAnd you love it.\u201d You grin. \u201cPut both hands on your ass and push your hip forward, let me see that pussy.\u201d</p>" +
					"<p>Camryn doesn't even hesitate before following your order and eagerly puts her most private parts on display for you, her sex coated in a thick layer of wetness.</p>" + "<p>\u201cLook how wet you are...\u201d You tell her and drive two fingers up and down her nether-lips. \u201cImagine people seeing you like this. \u201cShe moans as you flick your fingers over her clit. \u201cImagine them seeing you present your naughty, wet, pussy to them, hearing you moan like in heat...\u201d Your voice slowly drifts into a sensual whisper as you move behind her, pressing one knee against her hip to keep it pushed forward. \u201cImagine they might watch you as you begin to finger yourself, putting on a show for them, would that be naughty?\u201d</p>" +
					"<p>\u201cY...yes " + sm + "... very much...\u201d Camryn shivers under your touch, her breath erratic and her hip twitching as she moves one hand to her sex.</p>" + "<p>\u201cThen do it, show me all that passion you like to hide so much and cum for me.\u201d</p>" + "<p>\u201cY...yes...! Oh God...\u201d It takes her surprisingly little effort to actually reach that point. Her eyes remain close as she winds herself on the bed, feverishly driving her fingers in and out of her sex while she twitches in your arms.</p>" +
					"<p>Within moments, her body begins to tremble, her breasts bouncing with every hasty gasp until she finally explodes into a long, drawn out moan and comes to rest on your shoulder, her fingers soaked in her juices, and she wastes no time to lick them clean and make sure you have a good view of it.</p>" + "<p>\u201cGood Girl.\u201d</p>");
				if (isPersonHere("Hannah")) md.write("<p><i>You notice that Hannah has been watching the two of you the whole time with a grin on her lips and her fingers resting between her folds. She looks like she had a good time as well and certainly liked what she saw.</i></p>");
				startQuestions();
				addLinkToPlaceC(md, "talk more to Camryn", 457);
				WritePlaceFooter(md);
				return true
			}
			if (sType == "gggirls") {
				md = WritePlaceHeader();
				this.showPerson("camryn7.jpg");
				addPlaceTitle(md, "Good Girl's Are Not Into Girls");
				md.write("<p>\u201cI... don't think I really know what to do with another girl.\u201d Camryn admits as you lead her into the bedroom and the two of you begin to undress each other. \u201cYou are the first I fell for...\u201d</p>" + "<p>\u201cJust follow my lead.\u201d You remove the last of her clothes and push her onto the bed. \u201cI've taught Hannah, too, and she learned marvelously.\u201d</p>" +
					"<p>\u201cOf course she did...\u201d There is a chuckle from her as you mention her sister, and her eyes narrow in determination. \u201cIf she can do it, I can as well! So, uhm, what do I do?\u201d</p>" + "<p>\u201cFor now, lie back, and enjoy.\u201d You focus on the mana inside her and use it to send a wave of pleasure into Camryn's body the moment your tongue flicks over her clit, startling her. \u201cHow did you... oooh...\u201d</p>" + "<p>Her body bends and twitches under your assault, the sensations amplified by your spell to ease her into the new situation, though you are sure you have gotten pretty good at this without relying on the spell alone, too, and soon, her body begins to tense into an arch with a loud groan as she reaches her first climax.</p>" +
					"<p>\u201cWow...\u201d She slumps down, panting heavily. \u201cYou are good at... this...\u201d</p>" + "<p>\u201cAt what?\u201d You ask and tickle her clit.</p>" + "<p>\u201cLicking pussy, ma'am!\u201d She blurts out, and the two of you share a laughter.</p>" + "<p>\u201cGood,\u201d You crawl up the bed and straddle her face.\u201d And now let's see how fast you really learn....\u201d</p>");
				if (isPersonHere("Hannah")) md.write("<p><i>You notice that Hannah has been watching the two of you the whole time with a grin on her lips and her fingers resting between her folds. She looks like she had a good time as well and certainly liked what she saw.</i></p>");
				startQuestions();
				addLinkToPlaceC(md, "talk more to Camryn", 457);
				WritePlaceFooter(md);
				return true
			}
			if (sType == "ggswear") {
				md = WritePlaceHeader();
				this.showPersonRorX("camryn6.jpg");
				addPlaceTitle(md, "Good Girl's Don't Swear");
				md.write("<p>Camryn leads you into the bedroom and the two of you undress each other sharing hot kisses.</p>" + "<p>\u201cI still can't believe I'm making love to my sisters lover... how naughty.\u201d</p>" + "<p>You chuckle and remind her how they are pretty much sharing you, and she just grins. \u201cEven more naughty this way.\u201d</p>" +
					"<p>She crawls onto the bed and lies down on her stomach, presenting her rear to you. \u201cPlease don't make me wait, I long to feel you in my... in me.\u201d</p>" + "<p>\u201cIn your what?\u201d You smirk at her blunder and teasingly align your hip with hers, stroking your cock.\u201d</p>" + "<p>\u201cIn my...\u201d She pulls her lower lip inside for a brief moment, then just gives up in a giggle. \u201cIn my pussy!\u201d</p>" + "<p>\u201cWait!\u201d</p>" + "<p>\u201cIn my cunt! I want you to ram your thick, hard cock into my wet, needy cunt, sir!\u201d</p>" +
					"<p>There is a brief moment of silence before the two of you share a loud laughter.</p>" + "<p>\u201cYou are a positively filthy woman, Ms. Gifford.\u201d You say as you align the tip of your cock with her folds, and she grins over her shoulder.</p>" + "<p>\u201cThank you, sir, I agh...\u201d You interrupt her by pushing her hip down to the bed and luring a sharp gasp from her as you enter her sex and start rolling your hip against her body roughly.</p>" + "<p>\u201cOh.. yes... fuck me... \u201d She breathes out the words, pushing her hip back and bracing herself for you. \u201cPlease fuck me, sir!\u201d</p>" +
					"<p>Camryn reacts to every stroke with a stream of expletives, and you enjoy seeing her cut loose like that, your lips moving close to her ears as you whisper to her how much she enjoys being fucked like this, reminding her again and again that she loves being your bitch and letting you do all these nasty things to her until you both collapse on her bed in exhaustion, basking in the afterglow of your climaxes.</p>");
				if (isPersonHere("Hannah")) md.write("<p><i>You notice that Hannah has been watching the two of you the whole time with a grin on her lips and her fingers resting between her folds. She looks like she had a good time as well and certainly liked what she saw.</i></p>");
				startQuestions();
				addLinkToPlaceC(md, "talk more to Camryn", 457);
				WritePlaceFooter(md);
				return true
			}
			if (sType == "sistersbedroom") {
				md = WritePlaceHeader(false, "td-left-med");
				this.showPerson(perYou.isMaleSex() ? "hannahcamryn4.jpg" : "hannahcamryn3.jpg");
				addPlaceTitle(md, "Bedding the Sisters");
				if (perYou.isMaleSex()) md.write("<p>The two sisters lead you into the bedroom and you pull Hannah close to you to taste her lips for a few seconds before doing the same with Camryn, both sisters trading passionate kisses with you and finally sharing one among themselves.</p>" +
					"<p>Hannah and Camryn eagerly follow as you lead them to the bed and sit down, and soon, both their lips begin to cover your neck in soft kisses, while their fingers caress your legs and drive over your abdomen, finally meeting in the middle.</p>" + "<p>You exhale softly as they both begin to massage your manhood and slowly let yourself fall back and   enjoy their attentions.</p>" + "<p>Hannah is more bold in her movements, more certain about what she needs to do after spending so much time under your care. She almost immediately begins to work on your shaft to get you fully hard and covers your entire length in her saliva while her sister watches her.</p>" +
					"<p>Camryn mostly copies her more experienced sister most of the times you are together, but she is definitely a fast learner, and occasionally surprises you with a few kinky ideas, and when you order the pair to get ready for you, she is also the one to flip Hannah on her back and straddle her, pinning her sister down for you to have some fun.</p>" + "<p>You take turns enjoying the sisters bodies, starting by pushing into Camryn's tight sex before switching to Hannah and back, always making sure to use the spell to keep their arousal at peak so none of them feels neglected, and soon, both of their bodies are heavily intertwined, their lips close to each other as they gasp and moan under your care, lost in a haze of magic and pleasure until you finally feel your own peak approach and send them over the edge. All three of you enjoying a strong, and fairly loud, climax.</p>");
				else md.write("<p>The two sisters lead you into the bedroom and you pull Hannah close to you to taste her lips for a few seconds before doing the same with Camryn, both sisters trading passionate kisses with you and finally sharing one among themselves.</p>" + "<p>Hannah and Camryn eagerly follow as you lead them to the bed and sit down, and soon, both their lips begin to cover your neck in soft kisses, while their fingers caress your legs and drive over your abdomen.</p>" + "<p>You allow your body to lean back and close your eyes, a soft gasp leaving your lips as you feel their lips trail over your shoulders and their hands cup your breasts, their naked bodies pressed against your side and their tongues finally flicking over your nipples.</p>" +
					"<p>Hannah is more bold in her movements, more certain about what she needs to do after spending so much time under your care, but while Camryn mostly copies her more experienced sister, she is definitely a fast learner, and you expect her to surprise both of you soon.</p>" + "<p>It's also Camryn who is the one to finally push you onto your back and her lips on yours for another deep kiss, and you enjoy the taste of her tongue while Hannah spreads your legs and flicks hers over your clit.</p>" + "<p>You spread out your arms and dig your fingers into the pillow behind you while the two sisters tend to all your needs, caressing your skin, kissing your neck and softly playing with your nipples, Both of them take turns tending yo your most sensitive spots, and as you reach your climax, Hannah's fingers are buried deeply within your sex while her sisters lips have closed around your clit. Your body tenses up under their combined touch, and both of them greatly enjoy seeing you cum.</p>");
				startQuestions();
				addLinkToPlaceC(md, "talk more to Camryn and Hannah", 457);
				WritePlaceFooter(md);
				return true
			}
			if (sType == "sistersshower") {
				md = WritePlaceHeader();
				this.showPerson(Math.random() < .5 ? "hannahcamryn1.jpg" : "hannahcamryn2.jpg");
				addPlaceTitle(md, "Hot Shower");
				md.write("<p>\u201cThe bathroom is right over there.\u201d Camryn answers quickly. \u201cWould you like us to... help you?\u201d</p>" + "<p>\u201cOf course " + perYou.getHeShe() + " would.\u201d Hannah interjects with a chuckle. \u201c" + capitalizeFirstLetter(perYou.getHeShe()) +
					" never just wants to take a shower alone, right?\u201d</p>" + "<p>Hannah winks to you, and while there are moments where you prefer to shower in solitude, you admit that she was spot-on when it came to guessing your intentions.</p>" + "<p>\u201cWe'll get everything ready, " + (perYou.isBornMale() ? "Sir" : "Ma'am") + "!\u201d Camryn jumps to her feet in excitement, and Hannah quickly follows her. \u201cJust leave this to us.\u201d</p>" + "<p>You hear some rustling and running water from the bathroom, and you use the time to undress until the two call you in, and you are greeted with quite a sight.</p>" +
					"<p>The air is humid, steam from the shower has filled the bathroom and your nose takes in a very pleasant smell you can't quite place, but most of your attention is taken by the two sisters, their naked bodies pressed against each other as they share a deep and passionate kiss the moment you enter.</p>" + "<p>Your body tingles all over from the sight alone, and you enjoy the show a little longer before they both turn to you with a smile and beckon you into the shower to join them.</p>" + "<p>And of course you do.</p>" +
					"<p>The three of you spend far longer in the shower than you should, but you don't care, you are sandwiched between two beautiful women who use their whole bodies to cover you in soap, touch every sensitive part of your skin and waste no opportunity to share passionate kisses with you.</p>" + "<p>It's truly something you could get used to.</p>");
				startQuestions();
				addLinkToPlaceC(md, "talk more to Camryn and Hannah", 457);
				WritePlaceFooter(md);
				return true
			}
		}
		if (Place != 801) return false;
		if (sType == "storeroom") {
			md =
				WritePlaceHeader();
			AddImage("emptystorageroom.jpg");
			addPlaceTitle(md, "Storage Room");
			md.write("<p>You are inside a dark storage room.</p>");
			startQuestions();
			if (!this.checkFlag(2)) addQuestionR(md, "check your surroundings", "You are on a makeshift bed in a windowless room, there is a small lamp offering a little light, it hurts your eyes at first as you turn it on, but they adjust.</p>" + "<p>You see a set of boxes, rolled up wallpaper and cans of paint, it looks like a storage room no one used until recently.</p>" +
				"<p>There is a single door, light shines through the cracks and you hear voices talking outside.", "", "setPersonFlag(\\'Camryn\\',2)");
			if (!this.checkFlag(3)) addQuestionR(md, "check yourself", "Camryn is wearing shorts and a top, but no underwear. She has no bruises, but clearly an eventful time behind her.", "", "setPersonFlag(\\'Camryn\\',3)");
			if (!this.checkFlag(4)) addQuestionR(md, "focus on Camryn's thoughts", "You feel confusion and fear. Camryn is apparently not sure herself what has happened in the last days.</p>" +
				"<p>As you dig deeper, you feel guilt and regret, she is thinking of her sister and what her boyfriend has done, it looks like she no longer wants to be here, but is unable to leave.</p>" + "<p>There is a sense of urgency, as if someone is about to return and you don't have a lot of time to get away. You should possible make sure to not waste time while you possess her.", "", "setPersonFlag(\\'Camryn\\',4)");
			if (this.checkFlag(2) && this.checkFlag(3) && this.checkFlag(4)) {
				addQuestionR(md, "check the boxes",
					"Wallpaper paste, paint rollers, brushes... someone is apparently in the middle of renovating this house, but none of the tools look like they are of use to you.", "", "setPersonFlag(\\'Camryn\\',5);CamrynDoAction()");
				addQuestionR(md, "look for secret doors", "You spend a few minutes checking the walls for drafts or secret mechanisms, but soon realize you are just wasting precious time here. Why should a storage room have a secret entrance to begin with?", "", "setPersonFlag(\\'Camryn\\',6);CamrynDoAction()");
				addPopupLinkC(md, "masturbate", "", "<img src='Images/camryn2.jpg' class='imgpopup' alt='Camryn'>" + "This might be the least efficient way to spend your limited time, but you have to admit you are curious what it will feel like " + (perYou.isBornMale() ? "to do this as a girl" : "in the body of someone else") + ".</p>" + "<p>You pull down Camryn's top and squeeze your, well, her breasts with both hands, sliding your fingers over the smooth orbs and gasping softly as you touch her nipples.</p>" + "<p><i>\u201cWhy am I doing this?\u201d</i></p>" +
					"<p>You feel Camryn's thoughts resonate through your body as you pull down her shorts, her mind still dominated by the possession, but somewhat growing aware of what you are doing.</p>" + "<p><i>\u201cNo... someone might come in and see me...\u201d</i></p>" + "<p>You ignore her thoughts and begin to touch your... her clit " + (perYou.isBornMale() ? "the way you have learned it from your many girls" : "in well practiced motions,") + " and a shiver runs through your body.</p>" + "<p>\u201cNo, they'll see me... need to stop, why does it feel so much better than usual...\u201d</p>" +
					"<p>You feel a sense of rising arousal from Camryn's mind as you begin and it only emboldens you further, so you spread your legs widely and shift your position to face the door, making sure that whoever might come in would have a good view, and you feel Camryn's body shiver, her mind in a frenzy, clearly heavily aroused.</p>" + "<p>It doesn't take you long like this to bring Camryn's body to orgasm, a different feeling to what you are used to, but very much a pleasant one, your body still trembling softly as you put the shorts back on and rise to your feet.",
					false, "setPersonFlag('Camryn',7);CamrynDoAction();dispPlace(801,'type=" + sType + "')");
				addQuestionR(md, "try to open the door", "The door is locked. Whoever put Camryn in here, doesn't want her to leave.", "", "setPersonFlag(\\'Camryn\\',8)");
				addLinkToPlaceC(md, "try to eavesdrop on the conversation outside", 801, "type=storeroomlisten", "", "", "CamrynDoAction()")
			}
			WritePlaceFooter(md);
			return true
		}
		if (sType == "storeroomlisten" || sType == "room1invis") {
			md = WritePlaceHeader();
			AddImage("emptystorageroom.jpg");
			addPlaceTitle(md,
				"Storage Room");
			md.write("<p>You almost fall over as you stand up, but manage to steady yourself enough to make it to the door and focus on the voices outside.</p>" + "<p>\u201c....still don't like it. Sure, the bike will fetch a pretty penny from those wannabe-military weirdos, but she knows his face and might call the police on us.\u201d A clearly male voice speaks, and someone else answers.</p>" + "<p>\u201cShe dislikes the police, and even if, we'll be out of town before they start searching. It's just a pity the bike only had room to bring one of them, she'd have had fun here, after a dose of this stuff.\u201d</p>" +
				"<p>You are not sure what \u201cthis stuff\u201d is, but you feel a shiver run though Camryn's body as it is mentioned.</p>" + "<p>\u201cBah, bad enough he brought one girl to begin with. We agreed that he may have his comfort bitches in every town as long as he keeps them from the stash, and now he's jeopardizing the whole operation to get revenge on some biker chick for trying to cockblock him?\u201d</p>" + '<p><i>\u201c<b>Comfort Bitches?</b> That... that... Jerk!</i>"</p>' + "<p>\u201cYou know what he's like, he tried hitting on our contact, too. Never saw him back away that fast, though.\u201d</p>" +
				"<p>\u201cYou likely never saw someone put a shotgun barrel to his crotch, ether. This \u201cAnita\u201d seems to be pretty violent.\u201d</p>" + "<p>\u201cRight.\u201d The two laugh. \u201cBut he knows how to pick them, the girl in the storage likely still thinks her sis is just being taught a lesson and will get her bike back soon.\u201d</p>" + "<p><i>\u201cNo...\u201d</i></p>" + "<p>\u201cAfter what she drank last night I doubt she is thinking anything right now. Good thing, too, we don't want her to start a ruckus before we decide what to do with her. Now stop chatting, we have a lot of work to do and I want to be ready to leave this town by tonight.\u201d</p>" +
				"<p><i>\u201cWhat have I done?!? Nono, please, no...\u201d</i></p>" + "<p>You can faintly feel Camryn's thoughts now, her consciousness is still barely there, but hearing these two talk must have brought some of it to the forefront.</p>" + "<p><i>\u201cI can't let them do this to Hannah, where is my phone... why am I not able to move...?\u201d</i></p>" + "<p>You can feel her desperation and attempts to move her body, but after a few seconds, her consciousness fades into the background again, leaving you in full control once more.</p>");
			startQuestions();
			if (!this.checkFlag(5)) addQuestionRO(md, "listen some more", "\u201cRight, there's still a few things to catalog before we are able to start loading, I'll take care of it here, and you get the Van ready.\u201d</p>" + "<p>\u201cFine with me, just don't touch my beer until I'm back...\u201d</p>" + "<p>You hear footsteps and a door open, it seems one of the men is alone now.", "", "setPersonFlag(\\'Camryn\\',5);CamrynDoAction()");
			else if (!this.checkFlag(18)) addQuestionRO(md, "start knocking on the door",
				"You heavily  knock on the door a few more times, asking if anyone is there for effect, and finally hear footsteps closing in and the door unlocking", "", "setPersonFlag(\\'Camryn\\',18)");
			else addLinkToPlace(md, "wait for the door to open", 801, "type=storeroomthug", "", "", "CamrynDoAction()");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "storeroomthug") {
			md = WritePlaceHeader();
			AddImage("thug1.jpg");
			addPlaceTitle(md, "Storage Room");
			md.write("<p>The door opens and a man eyes you suspiciously.</p>" + "<p>\u201cDamn Girl, you have an elephant's constitution to be up already... Gable's gone for a bit, he said you should stay here 'till he's back so none of the guys get any strange ideas.\u201d</p>");
			startQuestions();
			if (!this.checkFlag(7)) {
				if (perYou.checkFlag(25) && nMana > 0) addPopupLinkToPlace(md, "use hypnotic suggestion on him", 801, "type=livingroom", "Hypnosis", "<img src='Images/thug1.jpg' class='imgpopup' alt='Thug'>" + "<img src='Images/hypnotize1.gif' style='position:absolute;margin:0 0 0 0;filter:alpha(opacity=30);-moz-opacity:0.3;-khtml-opacity:0.3;opacity:0.3;top:13%;right:13%;height:20vh;background-color:transparent' alt='Hypno'>" + "You reach out for his hand and quickly utter the phrase to hypnotize the man.</p>" +
					"<p>His eyes go blank, and knowing full well you only have seconds, you order him to go into the room as you quickly run outside and lock the door behind him.", "AddMana(-1)");
				addPopupLinkToPlace(md, "attack him", 801, "type=camrynbadend", "Bad Idea", "You try to ram your knee into his crotch, but quickly find out that Camryn, more so in her current state, does not really have the muscles or reflexes to be of any danger to him.</p>" + "<p>He effortlessly blocks all your attempts to hit him and doesn't even bother to strike you back.</p>" +
					"<p>\u201cThat's it...\u201d He grunts and takes out a small vial. \u201cGabe should have done this yesterday!\u201d</p>" + "<p>Before you are able to react, he forces you to drink the blue liquid inside, and your world begins to spin, you need to end the... you are not sure what, but you are feeling really hot... Your thoughts are fading fast as he closes the door again and leaves you in the room for his friends to pick you up later.");
				addQuestionRO(md, "seduce him", "\u201cBut I'm bored and it's cold in here...\u201d You say, trying your best doe eyes. \u201cDo you think you could keep me warm for at least a bit?\u201d</p>" +
					"<p>He seems taken aback as you approach him and place one hand on his crotch with a suggestive smile. \u201cI have been so... aroused since last night... and I don't even know why...\u201d</p>" + "<p>\u201cGirl, he really did a number on you, but I... don't think we should...\u201d</p>" + "<p>You silence him by moving your lips close to his and softly whisper \u201cplease...\u201d to him, and he does not fight back as you slip on your knees, open his pants and let them drop to the ground.", "", "setPersonFlag(\\'Camryn\\',7);CamrynDoAction()")
			} else {
				addLinkToPlace(md,
					"use the opportunity to trip him and get out", 801, "type=livingroom", "This is a chance you won't get again and you are sure to use it. You pretend to move your lips close to his manhood, only to suddenly rush behind the man and give him a harsh shove.</p><p>Camryn probably wouldn't have the strength to push him over normally, but with his pants literally down, his legs are tangled up and he falls to the ground, giving you just enough time to close the door and lock him inside.");
				addLinkToPlace(md,
					"Well, while you are down here...", 801, "type=storeroomthugnaughty", "", "", "CamrynDoAction()")
			}
			WritePlaceFooter(md);
			return true
		}
		if (sType == "storeroomthugnaughty") {
			md = WritePlaceHeader();
			this.showPersonRorX("camryn25.jpg");
			addPlaceTitle(md, "Naughtiness in the Storage Room");
			md.write("<p>You feel resistance from Camryn's Mind as your lips move closer to the mans cock, but it's not enough to deter you.</p>" + "<p><i>\u201cWhy am I doing this...?\u201d</i></p>" + "<p>You flick your tongue over his tip and he groans in approval as you carefully massage his manhood with your hands to get him hard.</p>" +
				"<p>You can't really claim that you have a lot of experience handling one of those, ");
			if (perYou.isBornMale()) md.write("aside from your own, of course, but you have seen, and felt, quite enough experienced woman by now to have a good grasp of what to do.");
			else md.write("but Catherine once gave you a pretty good demonstration and a few tips, and while it was mostly meant to embarrass you, it should help now.");
			md.write("</p><p>His cock grows in your hands, and you can feel a shiver run through Camryn's body, her subdued mind racing when he finally reaches his full size.</p>" +
				"</p><i>He's... big... and the others might see me... why does this turn me on...?</i></p>" + "</p>You hesitate for a moment, but finally wrap your lips around him and begin to move your head back and forth.</p>" + "</p>It's... different. The taste, the sensation in your mouth the way he twitches... It takes you a bit to find a good rhythm and turn that theoretical knowledge into practical application, but if the noises from above are any indication, he quite enjoys your work, and for some reason this fills you with a certain amount of pride... or is it Camryn's feeling? You are really unsure.</p>" +
				"</p><i>This is so naughty...</i></p>" + "</p>He groans loudly and you can feel him twitch in your mouth as his climax approaches, but as you try to pull back a little, he suddenly takes a hold of your hair, forces the tip against your throat and unloads himself into your mouth.</p>" + "</p>You gag and cough, and some of it runs down your chin, but that doesn't really deter him, possibly even turn him on, and as he finally lets go, you need a moment to catch your breath</p>");
			startQuestions();
			addLinkToPlace(md,
				"use the opportunity to trip him and get out", 801, "type=livingroom", "This has probably gone on long enough, and while a part of you enjoyed the experience, well, aside from the finale, you have also wasted precious time and need to make up for it.</p><p>The mans eyes are closed as he basks in the afterglow of his climax and it doesn't look like he is paying any attention to you, so you suddenly rush past him and give him a harsh shove from behind.</p><p>Camryn probably wouldn't have the strength to push him over normally, but with his pants literally down, his legs are tangled up and he falls to the ground, giving you just enough time to close the door and lock him inside.");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "livingroom") {
			if (this.charmedTime == 100)
				if (this.other >= 10) this.charmedTime = 2;
				else this.charmedTime = 10 - this.other;
			md = WritePlaceHeader();
			AddImage("emptylivingroom.jpg");
			addPlaceTitle(md, "Living Room");
			md.write("<p>You are in what may soon be the living room of a rather large house, though it does not seem like anyone has really moved in yet.</p>" + "<p>The walls are covered in simple, white wallpaper and there are barely any furniture or decorative elements to be found. Heavy curtains obscure the windows and the only source of light is a single bulb on a wire attached to the ceiling.</p>" +
				"<p>Crates are scattered all over the room and there is a single table surrounded by five folding chairs in the middle.</p>" + "<p>You hear noises from an open door possibly leading into the garage, the 2nd man must be there.</p>");
			startQuestions();
			addQuestionR(md, "check the front door", "It's locked, would have been too easy, you guess.", "", "CamrynDoAction()");
			addQuestionR(md, "check for other rooms", "You find most of the rooms locked and the few that are not, like the kitchen and bathroom, bare of any furniture except for some folding chairs, tables and rolled up sleeping bags.</p>" +
				"<p>One room stands out, though, the door looks sturdy, made to withstand even intense punishment, as do the walls. It's likely meant to become a safe-room, and you could easily lock it from the inside. ", "", "setPersonFlag(\\'Camryn\\',8);CamrynDoAction()");
			addQuestionR(md, "check the windows", "Apparently, whoever build this house has a strict focus on security. The window handles are lockable, which must be great for families with lively kids or fear of burglars, but is really annoying when you try to escape from this place.</p>" +
				"<p>At least you are able to get a look outside at what seems to be a street lined with expensive looking buildings in various states of completion on the outskirts of town.", "", "CamrynDoAction()");
			addQuestionR(md, "check the crates", "They are full of electronic devices, watches, jewelry and other goods.</p>" + "<p>You remember news about a string of successful burglaries in the last two weeks, and feel Camryn's heart beating faster.</p>" + "<p><i>\u201cGabriel... I can't believe this... what have I gotten into here...\u201d</i>",
				"", "CamrynDoAction()");
			if (this.checkFlag(8))
				if (this.checkFlag(20)) addLinkToPlaceC(md, "head for the Safe-room and lock yourself in", 801, "type=saferoom");
				else if (!this.checkFlag(10)) addQuestionR(md, "enter the safe room", "No use locking Camryn in here as long as you don't know where she is, and time is running out, so you better not idle.", "", "setPersonFlag(\\'Camryn\\',10);");
			if (!this.checkFlag(9)) addQuestionR(md, "check the table", "There's a half empty bottle of beer, a Laptop, a vial of strange blue liquid and some papers and brochures.",
				"", "setPersonFlag(\\'Camryn\\',9);");
			else {
				if (!this.checkFlag(16))
					if (!this.checkFlag(11)) addQuestionR(md, "check the laptop", "The Laptop is a newer model, sleek in appearance and from the looks of it rarely used. It seems the burglars use a prepaid web and walk stick to access the internet, but you can't find it.</p>" + "<p>It's also password protected... damn.", "", "setPersonFlag(\\'Camryn\\',11);CamrynDoAction()");
					else addQuestionR(md, "check the laptop", "You check again and see if there is a password written down nearby, nothing",
						"", "CamrynDoAction()");
				if (!this.checkFlag(12) && !this.checkFlag(11)) addQuestionR(md, "check the papers", "You find pointless notes, a few receipts and tourist brochures advertising Glenvale and listing the cities many achievements and rich history. One stands out, as it seems to promote a newly developed area on the city outskirts where Mayor Thomas builds expensive housing, hoping to attract wealthy citizens into the town.</p>" + "<p>You remember seeing in the local news that it's quite an important project for her, but not without controversy.</p>" +
					"<p>It might be where you are, right now.", "", "setPersonFlag(\\'Camryn\\',12);CamrynDoAction()");
				else addQuestionR(md, "check the papers", "You check the papers to see if anything looks like it is a password noted down, but you see nothing.", "", "CamrynDoAction()");
				if (!this.checkFlag(13)) addQuestionR(md, "check the vial", "It's a strange, blue liquid, you twist the bottle in your fingers in search of a label, but find nothing, however you feel a shiver building up in Camryn's body and, focusing on her thoughts, \u201cremember\u201d taking a small sip and ending up completely uninhibited. You remember \u201cGabe\u201d enjoying it too and decide to not dig further into the memories.",
					"", "setPersonFlag(\\'Camryn\\',13);CamrynDoAction()");
				else if (!this.checkFlag(19)) addPopupLinkToPlaceC(md, "drink the liquid", 801, "type=camrynbadend", "Drinking a Strange Vial?", "<img src='Images/camryn20.jpg' class='imgpopup' alt='Camryn'>" + "Curious at what this stuff may do, you down the entire bottle in one gulp and realize too late that this might not have been one of your smartest moves.</p>" + "<p>The effects are instant, you feel your, well, Camryn's folds dampen and your heart beating faster while your entire body is slowly taken over by rather pleasant tingles, and as you squeeze Camryn's breasts, which suddenly seemed like the natural thing to do, you are amazed by how sensitive they have become.</p>" +
					"<p>\u201cHey, what are you doing here?\u201d You attention is taken away from your gorgeous breasts by the man you heard earlier, and you smile as you answer his question.</p>" + "<p>\u201cDrinking... stuff, and touching my boobs.\u201d</p>" + "<p>\u201cPlease tell me you did not drink the entire vial...\u201d</p>" + "<p>\u201cSure!\u201d That's an easy order to follow. \u201cI did not drink the entire vial.\u201d</p>" + "<p>You are not sure why he slaps his hand on his forehead, but Come to think of it, your mind is strangely foggy in general, it's so hard to concentrate on... thoughts.</p>" +
					"<p>\u201cFuck, girl, you are one stupid Bimbo...\u201d</p>" + "<p>\u201cI am?\u201d You ask, and it looks like the man just realized something... which is good, because you certainly didn't.</p>" + "<p>\u201cYes... a dumb Bimbo, who has just enough brains to know she likes to have sex and show her tits.\u201d</p>" + "<p>You take these words in and ponder them. It certainly sounds compelling. You know you really like sex and right now you are horny as hell. And you do like your boobs, even if they are not technically yours because of... reasons.</p>" +
					"<p>\u201cSo, I like getting fucked a lot?\u201d You ask, and he nods.</p>" + "<p>\u201cYes, and you really dislike thinking about anything more complicated than being fucked, like covering yourself.</p>" + "<p>His words again seep into your mind, and you giggle as you pull of your top and throw it away, it didn't feel right wearing it anyway.</p>" + "<p>\u201cGreat! So like, do we fuck now?\u201d He shakes his head and you feel a crushing wave of disappointment.</p>" + "<p>\u201cNo, we have to wait for the others and explain what happened, then, you'll be fucked, in more than one way.\u201d</p>" +
					"<p>You happily nod and giggle again, certain that you are about to have a lot of fun.");
				if (!this.checkFlag(14)) addQuestionR(md, "check the beer", "It's a local brand, the bottle is still half-full.", "", "setPersonFlag(\\'Camryn\\',14);CamrynDoAction()");
				else if (this.checkFlag(13) && !this.checkFlag(19) && !this.checkFlag(15)) addQuestionR(md, "spike the beer with the contents of the vial", "You fill about half of the liquid into the beer-bottle, now you just need to find a way to make him drink it.", "", "setPersonFlag(\\'Camryn\\',19);CamrynDoAction()")
			}
			if (!this.checkFlag(15)) {
				addQuestionR(md,
					"peek into the garage", "The front door is closed, you see the other man loading crates into a van, it's best to not disturb him.", "", "CamrynDoAction()");
				if (this.checkFlag(17) && this.checkFlag(9))
					if (this.checkFlag(19)) addPopupLink(md, "Bring him the beer", "Beer", "<img src='Images/thug2.jpg' class='imgpopup' alt='Thug'>" + "You quickly get the bottle, place it on the floor and knock on the door to signal him.</p>" + "<p>You can't afford to be seen, but with some luck you don't have to be. You make sure to hide behind the Crates and hope he doesn't see you as he peaks through the door-frame.</p>" +
						"<p>\u201cYou suddenly shy or what?\u201d You hear him call out and take a large gulp from the Bottle. \u201cJack?\u201d</p>" + "<p>\u201cJack... where... uhhh... hell, that stuff is...\u201d You hear a loud \u201cthud\u201d and as you peak over the crates, he has fallen onto his back like a wet sack.</p>", true, "setPersonFlag('Camryn',15);per.charmedTime=0;CamrynDoAction('type=livingroom')");
					else addPopupLinkToPlace(md, "Bring him the beer", 801, "type=camrynbadend", "Beer", "<img src='Images/thug2.jpg' class='imgpopup' alt='Thug'>" +
						"You quickly get the bottle, place it on the floor and knock on the door to signal him.</p>" + "<p>You can't afford to be seen, but with some luck you don't have to be. You make sure to hide behind the Crates and hope he doesn't see you as he peaks through the door-frame.</p>" + "<p>\u201cYou suddenly shy or what?\u201d You hear him call out and take a large gulp from the Bottle. \u201cJack?\u201d</p>" + "<p>\u201cOh, please tell me you are not amusing yourself with Gabe's Girl, he's gonna kill ya, man...\u201d</p>" +
						"<p>You realize in panic that he is heading straight to the room where you locked his friend in, and that there is nothing you can do to stop him now. Soon, he has freed the other man and the two don't take long to spot you.</p>" + "<p>There is a short scuffle as you try to get away, but weakened as you are, they overpower you and douse you in a strange blue liquid, your thoughts fade....</p>")
			} else {
				addQuestionR(md, "search the garage", "The Van is halfway loaded with crates and boxes, but it would take far more time than you have to search all of these.</p>" +
					"<p>The front door to the garage is once again locked, and the van itself has no keys.</p>" + "<p>This room is a dead end, too.", "", "CamrynDoAction()");
				addQuestionR(md, "examine the man", "That dose might have been too large, his eyes are still open but unfocused and every attempt to speak to him results in gibberish. At least he is breathing steadily and... sporting a gigantic bulge in his pants.</p>" + "<p>You check his pockets, hoping to find keys, but you only find some pocket change and a... note.</p>" +
					"<p>\u201cDon't forget, the Password to the laptop is R0ughL4nd!ng\u201d</p>" + "<p>Well, that's better than nothing. ", "", "setPersonFlag(\\'Camryn\\',16);CamrynDoAction()");
				if (this.checkFlag(16) && !this.checkFlag(26)) addPopupLinkC(md, "ride him", "Ride'em Cowgirl", "<p>You free the mans massive erection from his pants and he groans lustfully as you draw your fingers along the entire length.</p>" + "<p>You are not sure what compels you to do this, maybe the drugs affecting Camryn's body are getting to you as well, or maybe her own subconscious desires are affecting you, but you have to ride that dick while you have the chance.</p>" +
					"<p>You try take of your shorts, but for the first time, Camryn's presence is actually strong enough to stop you.</p>" + "<p>\u201cNo!\u201d</p>" + "<p>You can feel her reluctance, and while you know she is not strong enough to overpower you, she is wasting time, well, more time than you are wasting already.</p>" + addOptionLink("string", "...abort", "setPersonFlag('Camryn',26);dispPlace(801,'type=livingroom','In retrospect, this idea was stupid to begin with, and as you step away from the man, you feel Camryn&rsquo;s presence recede.</p><p>With the possession spell, you are able to experiment as much as you like without risking the life of someone else, and you really need to focus on getting out...')") +
					addOptionLink("string", "...subdue her", "dispPlace(801,'type=livingroom&act=ridehim')"), false, "setPersonFlag('Camryn',26);CamrynDoAction()", true);
				if (this.checkFlag(16)) addLinkToPlaceC(md, "unlock the laptop", 801, "type=livingroomlaptop")
			}
			WritePlaceFooter(md);
			return true
		}
		if (sType == "livingroomlaptop") {
			md = WritePlaceHeader();
			this.setFlag(21);
			addPlaceTitle(md, "Laptop", "laptop.jpg");
			md.write("<p>The password has been accepted and the screen comes to life, maybe you can get a clue about your whereabouts from here.</p>");
			startQuestions();
			addQuestionR(md, "check browser history", "City maps and tourist information about Glenvale and a few YouTube links. Nothing really helpful.", "", "CamrynDoAction()");
			if (getQueryParam("emails") === "") addLinkToPlaceC(md, "check emails", 801, "type=livingroomlaptop&emails=true", "There aren't many emails, they either don't communicate that way often or clear it out regularly, a few stand out, though.");
			else {
				startAlternatives(md, "Emails");
				addQuestionR(md, "read: Re: Re: Housing", "<b>It's the Address! Now you just need to get Camryn to a safe place.</b></p><br/>" +
					"<p>From: Wilhelm<br/>" + "My pleasure. It's Petras Road 11, you'll find the keys under the doormat</p>" + "<p>From: Gabe<br/>" + "Do it. I'll transfer payment as usual.</p>" + "<p>From: Wilhelm<br/>" + "I've scouted out Glenvale and found the perfect place.</p>" + "<p>Looks like the mayor is building homes for rich assholes in the outskirts of town. Some of them are mostly done, but work has to rest for at least a few weeks thanks to protesters and contract disputes, and they are all empty. " + "You'll have water and electricity, lots of space and if you make sure your van looks somewhat like an outside contractor no one is going to be suspicious of your presence.</p>" +
					"<p>One word and I'll organize Keys.", "", "setPersonFlag(\\'Camryn\\',20);CamrynDoAction()");
				addQuestionR(md, "read: Re: Meeting", "From: BaldEagle7<br>" + "<p>Command confirms interest in merchandise.<br/>" + "<p>Scheduled meeting with operative code-named Anita at designated meeting spot.<br/>" + "<p>Time: fourteen double-O. Do not be late or deal is off.", "", "CamrynDoAction()");
				addQuestionR(md, "read: Meeting with contact", isCharmedBy("Anita") ? "From: Angelo<br>This \u201cAnita\u201d failed to show up, no idea why, she's usually not that unreliable. We are on our way back now and will get in touch with the buyer, no need to panic just yet, but we should get ready to skip town soon if need be." :
					"From: Angelo<br>The meeting with \u201cAnita\u201d was a success, they are interested in buying as long as we are able to get everything out of town.We are on our way back, bringing beer and pizza to celebrate.", "", "CamrynDoAction()");
				endAlternatives(md)
			}
			addQuestionR(md, "check private folders", "You find a simple list of houses where the group suspects to find wealthy people living alone or out of town. You don't recognize most of the names, but it looks like the residence of the local bank manager, Kristin Kincaid, is on that list, as well as one of her direct neighbors, Sally Barthel.</p>" +
				"<p>The Gates mansion has been marked with a question-mark.</p>" + "<p>There's another list of 50 reasons why beer is better than a girlfriend and a few similarly \u201cfunny\u201d texts but nothing of use to you.", "", "CamrynDoAction()");
			addLinkToPlace(md, "close the laptop", 801, "type=livingroom");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "livingroombeer") {
			md = WritePlaceHeader();
			AddImage("thug2.jpg");
			addPlaceTitle(md, "Living Room");
			md.write("<p>The door opens and a man eyes you suspiciously.</p>" + "<p>\u201cDamn Girl, you have an elephant's constitution to be up already... Gable's gone for a bit, he said you should stay here 'till he's back so none of the guys get any strange ideas.\u201d</p>");
			startQuestions();
			addPopupLinkToPlace(md, "try to fend off the attack", 801, "type=camrynbadend", "Attacked", "<img src='Images/thug2.jpg' class='imgpopup' alt='Thug'>" + "You try to block him, but the man very easily overpowers you, you try to reach for the vial of the Drug, and in the scuffle, he spills the ingredients on you.</p>" + "<p>A wave of warmth rushes through your body and your thoughts begin to fade, it's suddenly getting so much harder to think... you need to end the possession, but you can't... remember... how...");
			if (this.checkFlag(13))
				if (perYou.checkFlag(25) && nMana > 0) addPopupLinkToPlace(md, "use hypnotic suggestion to make him drink the drug", 801, "type=livingroom", "Hypnosis", "<img src='Images/thug2.jpg' class='imgpopup' alt='Thug'>" + "<img src='Images/hypnotize1.gif' style='position:absolute;margin:0 0 0 0;filter:alpha(opacity=30);-moz-opacity:0.3;-khtml-opacity:0.3;opacity:0.3;top:13%;right:13%;height:20vh;background-color:transparent' alt='Hypno'>" + "You wait for the man to get closer, and the moment he touches you, you utter the activation phrase and use the Hypnotic Technique on him.</p>" +
					"<p>You don't rally have a lot of options here, the trance will wear off in seconds, so you tell him to take the vial and gulp it down.</p>" + "<p>He follows suit without hesitation, and his mind clears just in time to realize in horror what he has done. He turns and prepares to grab you but then simply falls down like a wet sack.", "AddMana(-1);setPersonFlag('Camryn',15);per.charmedTime=0");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "saferoom") {
			md = WritePlaceHeader();
			AddImage("saferoom.jpg");
			addPlaceTitle(md,
				"Safe Room");
			md.write("<p>You can't get out without the keys and you don't know what they will do with Camryn after what you did to the guards. Not to mention she'll likely pass out again once you end the possession.</p>" + "<p>You, however, have an exact address now, so you'll be able to send help once you are back in your own body. You just need a way to keep her safe, and the Safe-room looks like the best bet for that.</p>" + "<p>You scribble a note telling her that help is on the way and to not open the door under any circumstances and hope she'll adhere to it. Now you just need to end the possession.</p>");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "camrynbadend") {
			md = WritePlaceHeader();
			this.showPersonRorX("camryn3.jpg");
			addPlaceTitle(md, "3 Weeks Later");
			md.write("<p>Your tongue eagerly trails along the cock before you, covering it fully in your spit before your lips close around the tip and the guy begins to push it into your mouth.</p>" + "<p>You are not quite sure how long you have been with the boys now, but you have started to enjoy your life with them.</p>" + "<p>Sure, you were confused at first. Gabe insisted on dyeing your hair blond and change your appearance, nothing seemed to make sense and there were a lot of confusing thoughts and memories, but every time you drank the blue liquid, they were nice enough to explain things to you, and slowly you began to realize your place as the groups personal bitch and how much you enjoy helping them unwind after a long day.</p>" +
				"<p>The man groans in pleasure as the tip of his cock presses against your throat, a sign that you are doing good work, and you are proud how well you managed to overcome your gag reflex in the past days and keep yourself focused.</p>" + "<p>Sometimes, your mind still drifts off. You somewhat remember being a " + (perYou.isBornMale() ? "guy" : "lesbian") + ", and you remember an entire harem of girls at your disposal. Or did you recently move into your own apartment and got a job on your own? You had sister, you think. Was her name Hannah? No wait, Tracy? It's confusing.</p>" +
				"<p>You also remember hearing about a comatose " + (perYou.isBornMale() ? "guy" : "girl") + " found " + (perYou.place == 141 ? "in the sacred clearing" : "") + " in Glenvale and felt like this was really important somehow...</p>");
			startQuestions();
			addLinkToPlace(md, "snap out of your memories", 801, "type=camrynbadend2");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "camrynbadend2") {
			md = WritePlaceHeader();
			this.showPersonRorX("camryn4.jpg");
			addPlaceTitle(md, "3 Weeks Later");
			md.write("<p>Of course, this is nothing you should focus on, now. Maybe Gabe is able to explain these things to you, later.</p>" +
				"<p>The mans cock plops free from your lips with a loud noise and you take the moment to breath in and focus back on your task You are here to give him a good time, and it would be unfair to them to slack off after they are taking such good care off you.</p>" + "<p>You lie down on the bed and enticingly spread your legs for him. Your pussy" + (perYou.isBornMale() ? ", it still feels as if your are not supposed to have one," : "") + " has been wet for hours, and you feel your entire body shivering in anticipation at the thought of what is to come next.</p>" +
				"<p>For a second, there is this weird presence in your mind again, subdued and equally aroused, but clearly there, but the thought fades the moment he enters your waiting folds and begins to grind his hip against you.</p>" + "<p>You lean back and let him take you, moaning lustfully as all the strange thoughts and memories fade into obscurity again. What matters is what is here and now. And right now, you enjoy being fucked. Maybe you are able to convince the others to have a go later, as well.</p>");
			startQuestionsOnly();
			addRestartLink(md);
			WritePlaceFooter(md);
			return true
		}
		return false
	};
	per.showPersonChat = function(bGeneral, md) {
		if (Place == 168) {
			if (wherePerson("OfficerBatton") == 168 && wherePerson("Hannah") == 168 && this.checkFlag(21) && !this.checkFlag(22))
				if (isCharmedBy("OfficerBatton")) addQuestionR(md, "tell " + getPoliceChief() + " Batton about Camryn's whereabouts", '"' + perYou.getPersonName() + "! Kerry looks excited to see you, quickly wetting her lips and unbuttoning her shirt. I knew Miss Gifford was one of yours as soon as I saw her eyes, she said that you have vital information about the burglaries of the last 2 weeks?</p>" +
					"<p>She takes out a pen and begins to seductively run it over her lips. \u201cI will of course do anything I can to help you, just say the word and we move out!\u201d</p>" + "<p>You give Kerry as much information about the group's hideout, size and Camryn's hiding place as you can, and she dutifully makes notes about everything, always looking at you in amazement.</p>" + "<p>\u201cYour magic is so useful, It's no wonder that you are my " + perYou.getMaster() + ".\u201d She salutes you.\u201d We will begin the operation immediately, just leave the rest to us.\u201d",
					"", "setPersonFlag(\\'Camryn\\',22);movePerson(\\'OfficerBatton\\',801)");
				else addQuestionR(md, "tell " + getPoliceChief() + " Batton about Camryn's whereabouts", "\u201cMiss Gifford already told us about her sister, and now she claims you have found evidence that her disappearance is connected to the latest string of burglaries and know where to find her and the perpetrators, yes?\u201d</p>" + "<p>You make up a story about Camryn managing to contact you on the phone and how you guided her to find out the address, and also tell the " +
					getOfficer(false) + " about the size of the group and Camryn's hiding place. While the " + getOfficer(false) + " seems a little suspicious of your story how you acquired the information, she does take the case itself seriously.</p>" + "<p>\u201cThank you for this information, it seems like we have little time to waste, so I will get to it. If this checks out and we find the girl, we will contact the two of you immediately.\u201d", "", "setPersonFlag(\\'Camryn\\',22);movePerson(\\'OfficerBatton\\',801)");
			if (wherePerson("OfficerBatton") ==
				801 && wherePerson("Hannah") == 168 && this.checkFlag(22) && !this.checkFlag(23)) addLinkToPlace(md, "wait for news with Hannah", 172, "type=waithannah");
			else if (wherePerson("OfficerBatton") == 168 && wherePerson("Hannah") == 168 && this.checkFlag(22)) addQuestionR(md, "Camryn returns to the police station", "It doesn't take long until Camryn arrives at the station, and after a tearful hug between the sisters, she is taken away to be examined by a doctor and questioned for her testimony.</p>" + "<p>Right now, there is no easy way to meet with her, but you figured that she deserves a bit of rest after all she has been through.</p>" +
				(checkPersonFlag("Hannah", 13) ? "<p>You tell Hannah that you intent to collect your price soon, and order her to inform you the moment Camryn is available at home, and she dutifully agrees to do so.</p>" + "<p>Hannah seems... annoyed by your earlier attitude as she leaves the station, as much as the spell allows her to be, at least. She is still obedient but certainly not as enthusiastic as before, though you are sure that, come time, the spell will make her forget your behavior and she'll be back to her old, happily charmed self.</p>" :
					"<p>You ask Hannah to inform you once she is back at her home, and knowing full well what you likely plan to do, she happily agrees, telling you that you've earned it.</p>" + "<p>The two of you talk for a bit longer. Hannah seems very affectionate and jokingly suggests that you should use your powers to help people for a change more often, before giving you a kiss and returning to her workshop.</p>"), "", "setPersonFlag(\\'Camryn\\',23);movePerson(\\'Hannah\\',279)");
			else if (wherePerson("OfficerBatton") ==
				168 && wherePerson("Hannah") != 168 && this.checkFlag(23) && !this.checkFlag(24)) {
				var bShot = getPersonOther("Anita") >= 100 && perYou.isShot();
				addQuestionR(md, "ask " + getPoliceChief() + " Batton for details about the operation", isCharmedBy("OfficerBatton") ? "\u201cIt is actually confidential information we are not supposed to share with citizens, but of course that does not include you.\u201d Kerry smiles brightly, jumping at another chance to please you.</p>" + "<p>\u201cWe are still trying to find out more about the members of the group, but it seems they have been operating in other towns as well, and the fact that we caught them is probably going to get Glenvale a bit of media attention. We have secured large amounts of goods they had stolen in the past weeks before they were able to bring them out of town, as well as what appears to be a very small stash of a new Synthetic drug, most of which has been destroyed, though.\u201d</p>" +
					"<p>\u201cThe raid went off without casualties, all thanks to your Intel, of course, but the followup investigation will keep us busy for a while and...Oh! This has got to interest you!\u201d</p>" + (bShot ? "<p>They wanted to meet a woman by the name of Anita, and we think she's that vile harpy who shot you! We are of course investigating that lead with everyone available.</p>" : "<p>They were supposed to meet with a woman named Anita who is still on the run. She is supposedly armed and very dangerous, so you might want her on your side before someone else gets her!</p>") +
					"<p>You make mental notes of everything and ask if there is anything else of interest, and Kerry has to think for a moment.</p>" + '<p>"Well, Officer Ross distinguished herself when she chased and detained the leader of the group, ' + (!isCharmed("AdeleRoss") ? "you were interested in her, right?\u201d Kerry smiles knowingly. \u201cShe seems to be a little suspicious of me recently, and I'm not sure she knows about us, so if you want to get her, be careful, yes?\u201d" : "\u201cI know she is one of us, and I am always trying to keep tabs on the other girls to make sure they are safe and able to serve you.\u201d") :
					"\u201cI'm Sorry, but that information is confidential and we are not permitted to share it with citizens.\u201d</p>" + "<p>\u201cI'm sure the newspapers will bring the whole story, soon, though.\u201d", "OfficerBatton", "setPersonFlag(\\'Camryn\\',24)")
			}
		} else if (Place == 457 && this.isHere())
			if (!this.checkFlag(25) && !this.isCharmedBy()) addQuestionR(md, "ask if she is well", "\u201cYes, Thank you for asking, but I'm still not entirely sure what happened.\u201d Camryn scratches the back of her head.</p>" + "<p>\u201cThe police found me passed out in a safe-room and... congratulated me on my quick thinking.\u201d</p>" +
				"<p>\u201cApparently, I have locked in one of the thugs, knocked out another, hid away and called them.\u201d She shakes her head in disbelieve. I even remember bits of it, but it's more like I'm watching someone else doing all these... things.\u201d She breathes out.</p>" + "<p>\u201cI told Hannah about it and she said you might be able to shed light on things, and that I really should meet you.\u201d", "Camryn", "setPersonFlag(\\'Camryn\\',25)");
			else if (this.isCharmedBy() && sType === "") {
			addLinkToPlaceC(md,
				'"Good Girls do not show their bodies"', 457, "type=ggshow");
			if (perYou.isMaleSex()) addLinkToPlaceC(md, '"Good girls do not swear"', 457, "type=ggswear");
			else addLinkToPlaceC(md, '"Good girls are not sleeping with other girls"', 457, "type=gggirls");
			if (isPersonHere("Hannah")) {
				addLinkToPlaceC(md, "take the sisters into the bedroom", 457, "type=sistersbedroom");
				addLinkToPlaceC(md, "ask to take a shower", 457, "type=sistersshower")
			}
			if (!this.checkFlag(27)) addQuestionR(md, 'ask "How did she end up with these Guys anyway?"',
				"The topic seems to be a wholly uncomfortable one for Camryn, and she hesitates for a while before answering your questions.</p>" + "<p>\u201cI've met Gabe at the Gym. He was a bit of a Jerk, but in a charming way, at least I thought so back then, and I was kind of frustrated with... everything at the time.\u201d She explains.</p>" + "<p>\u201cSo we went out, had a few drinks, ended up in my bed, and started dating. I finally had a \u201cBad-Boy\u201d Boyfriend, and one my sister despised, no less, and relished it. So I've overlooked a lot of warning signs, and we all know what it led to.\u201d She smiles to you suggestively.</p>" +
				"<p>\u201cAt least it led to meeting you, I bet Hannah would have kept you for herself if not for the trouble I was in.\u201d", "Camryn", "setPersonFlag(\\'Camryn\\',27)");
			if (!this.checkFlag(28)) addQuestionR(md, "ask about Hannah", "\u201cWe have a lot of catching up to do, but it's great to finally share a common interest with her!\u201d Camryn answers, clearly exited. \u201cI fear she's still so much more experienced than me with things like " + (perYou.isMaleSex() ? "deepthroating" : "cunnilingus") + ", or rough sex in general... it makes me a little jealous, and I feel like I shouldn't be.\u201d</p>" +
				"<p>You assure her that you intent to close the gap of experience between the two of them, and a wide smile forms on the spellbound girls lips.</p>" + "<p>\u201cThank you " + (perYou.isBornMale() ? "Sir" : "Ma'am") + ", I promise I'm not going to lose to her!\u201d", "Camryn", "setPersonFlag(\\'Camryn\\',28)");
			if (!isDay()) {
				addSleepLink(md, "spend the night with Camryn", "Going to Bed with Camryn", '<p style="position:absolute;left:2%;top:2em;cursor:pointer;font-size:1.1em;width:66%;color:black"><b>Camryn is excited as you mention you want to spend the night with her and quickly slips into a set of lingerie just for you, to make your night even more pleasant.</b>',
					"camryn22.jpg", true);
				if (isPersonHere("Hannah")) addSleepLink(md, "spend the night with the sisters", "Going to Bed with Hannah and Camryn", '<p style="position:absolute;left:2%;top:2em;cursor:pointer;font-size:1.1em;width:66%"><b>You crawl into bed with one sister in each arm, greatly enjoying their warm, naked bodies snuggled up against yours.</b>', "hannahcamryn6.jpg", true)
			}
		}
	};
	per.addPlaceImageLeft = function(lit) {
		if (Place == 457 && this.isHere() && sType === "") {
			if (this.isCharmedBy()) {
				if (isPersonHere("Hannah")) return this.showPerson("hannahcamryn5.jpg",
					"", "", "", "", false, "string");
				return this.showPersonDN("camryn9.jpg", "", "", "", "", false, "string")
			}
			if (isPersonHere("Hannah")) return this.showPerson("camryn19.jpg", "", "", "", "", false, "string");
			return this.showPerson("camryn10.jpg", "", "", "", "", false, "string")
		}
		return ""
	};
	per.showPersonTextHere = function(md) {
		if (Place == 457 && this.isHere())
			if (this.isCharmedBy()) {
				if (!isPersonHere("Hannah")) md.write("<p>By the time you have reached the right floor, Camryn has already slipped out of most of her clothes, lasciviously offering her body to you with a wicked smile on her face.</p>")
			} else md.write("<p>Camryn looks like she is doing well as she lets you in. the two of you sit down and she thanks you for checking up on her, asking if she may offer you a drink.</p>")
	};
	per.handleItem = function(no, cmd) {
		if (no == 63 && cmd == 2 && this.place == 801)
			if (isPossess("cast")) {
				if (this.checkFlag(21)) addComments("You have already resued Camryn so there seems little reason to re-possess her");
				else Possession("Camryn");
				return "handled"
			}
		if (no == 14 && cmd == 2)
			if (Place == 457 && this.isHere()) {
				CastCharmSpell("Camryn", 457, 2, isPersonHere("Hannah") ? "type=charmcamrynwithhannah1" : "type=charmcamryn1");
				return "handled"
			}
		if (no == 17 && cmd == 2)
			if (Place == 801 && this.checkFlag(18) && sType.indexOf("livingroom") == -1) {
				CastInvisibility("type=room1invis",
					"");
				return "handled"
			}
		return ""
	};
	per.isPhoneable = function() {
		return checkPlaceFlag("Hotel", 11) && Place == 269 && this.isCharmedBy()
	};
	per.callThem = function() {
		if (Place == 269) {
			gotoPlace(Place, "type=camrynpool");
			receiveCall("", "You call Camryn to invite her to join you at the pool for a swim, and she happily agrees.");
			WriteCommentsFooter(bChat, bChatLeft)
		}
	}
}

function initialiseCarol() {
	addPerson("Carol", 420);
	per.getPersonName = function(full) {
		if (full !== true) {
			var clv = this.getCharmedLevel();
			if (clv > 0) {
				if (clv == 2) return "playful Carol";
				if (clv == 4) return "Slave Carol";
				return "Carol"
			}
		}
		return "Carol Bartel"
	};
	per.getPersonAddress = function() {
		return this.checkFlag(1) ? "12 Dervish Rd, Glenvale" : ""
	};
	per.whereNow = function() {
		if (Place == 424) return Place;
		return this.place
	};
	per.isPersonInfo = function() {
		return true
	};
	per.getPersonInfo = function() {
		if (Place == 420 && this.isCharmedBy() &&
			isCharmedBy("Ellie")) return "<img src='Images/carolellie1.jpg' style='width:38%;float:right;margin-left:5px' alt='Carol and Ellie'>" + "Carol and Ellie Bartel, the beautiful mother and daughter, are now yours.";
		else {
			if (this.isCharmedBy()) return "<img src='Images/carol1d-day.jpg' style='width:35%;float:right;margin-left:5px' alt='Carol'>" + "Carol turned out to be quite energetic, to say at least. You rarely can get her to sit still for a while without her trying to strike up a conversation or do something silly to amuse you, and by now, you have pretty much stopped trying.<br><br>" +
				"She is obedient to you in a very playful manner, tending to your needs when you visit as nether a submissive slave nor devoted lover, but as a great companion always ready to have Sex. Fun, lighthearted and rather inventive Sex, often involving Kristin and/or, her rather large collection of Sextoys, and occasionally lasting through the entire night.<br><br>" + "You have begun to mediate between her and Ellie to get the two to fix their strained relationship, and so far, the \u201cbonding exercises\u201d you thought up bear great fruits... with a little magical help.<br><br>" +
				"The only thing keeping her from devoting herself to you fully is the thought of her wife, who, as Carol in varying degrees of subtlety often hints at, would apparently be a great asset to your harem as well.<br><br>" + "Once she bothers to return home, that is...<br><br>";
			return "<img src='Images/carol1d-day.jpg' style='width:35%;float:right;margin-left:5px' alt='Carol'>" + "Carol Bartel is... not what you expected her to be.<br><br>" + "Ellie's mother looks like she had fallen straight out of a magazine cover: Tall and blonde with a perfectly shaped figure, large natural breasts and wearing clothes that cover just enough to not seem cheap while leaving plenty for people to look at... and speaking of:<br><br>" +
				"She definitely notices the way you look at her and doesn't seem to mind at all, greeting you with a warm smile and a faint accent in her voice that you would place somewhere into Slavic or Russian territories."
		}
	};
	per.passTimeDay = function() {
		this.setFlag(4, false);
		return ""
	};
	per.showEvent = function() {
		var md, idx;
		if (Place == 423 && sType == "carolpool") {
			WaitHereOnly(6);
			md = WritePlaceHeader();
			this.showPerson("carol-pool.jpg");
			addPlaceTitle(md, "Pool-side with Carol");
			md.write("<p>Carol changes in to her bikini and sits on a recliner at the pool-side, looking beatiful and sexy. She comments how they often entertain guests here. While she does not quite say it, you get the impression she plays the beautiful hostess but that the guests were seldom her friends.</p>" +
				"<p>You take her mind of her thoughts with a kiss and then insist she join you for a playfull swim.</p>");
			startQuestions();
			addLinkToPlaceC(md, "leave the pool", 420);
			WritePlaceFooter(md);
			return true
		}
		if (Place == 424) {
			var sw = perYou.isMaleSex() ? "Volkhov" : "Vedma";
			var herName = capitalizeFirstLetter(this.getPersonName());
			if (sType == "fuck") {
				if (isExplicit()) {
					md = WritePlaceHeader(perYou.isMaleSex() ? "td-any" : "td-left-med");
					if (perYou.isMaleSex()) this.showPersonX("carol9b.jpg", "height:max");
					else this.showPersonX("carol7g.jpg")
				} else {
					idx =
						Math.floor(Math.random() * 2);
					md = WritePlaceHeader(perYou.isMaleSex() && idx == 1 ? "" : "td-left-med");
					if (perYou.isMaleSex()) this.showPerson(idx === 0 ? "carol7ba.jpg" : "carol7bb.jpg");
					else this.showPerson("carol6g.jpg")
				}
				addPlaceTitle(md, herName);
				md.write("<p>You take a translucent pink dildo you find close to the door and curiously spin it in your fingers while an idea begins to form in your mind.</p>" + "<p>\u201cI think we will use this one today.\u201d Carol crawls closer to the edge of the bed and you watch as her tongue begins to playfully cover the toys entire length in her saliva.</p>" +
					"<p>\u201cAn excellent choice.\u201d She assures you with a wide grin, her eyes focusing on you. \u201cAnd just what would you compel me do today, my naughty " + sw + "?\u201d</p>" + "<p>You order her to turn around onto her back bend both her legs back and, as always, you are impressed by her flexibility as she holds them both in place easily with a smug grin on her lips.</p>" + "<p>You trace the toy over her exposed folds teasingly, luring an impatient purr from her lips before pushing it in and, one quickly applied dose of lube later, following up by pressing your cock into her rear.</p>" +
					"<p>Carol moans in approval, her eyes focused on you as you begin to grind your hip against her body, enjoying her tightness, and even more the increasingly lustful noises every stroke lures form her lips. Soon, you feel barely able to hold back and lean forward to press both hands firmly against her ankles. You focus on the spell binding her to you, increasing her sensitivity and arousal by the second until she seems barely able to think straight under your continued assault. Finally, feeling your own climax approach, you order her to cum together with you, hammering the words into her mind until you both share an intense orgasm.</p>");
				startQuestions();
				addLinkToPlaceC(md, "talk more with Carol", 424);
				addLinkToPlace(md, "leave the house", 5);
				WritePlaceFooter(md);
				return true
			} else if (sType == "bj") {
				md = WritePlaceHeader();
				if (isExplicit())
					if (perYou.isMaleSex()) this.showPersonRandomX("carol6b", 2, "30vw,40vw");
					else this.showPersonRandomX("carol6g", 2, "45vw,45vw");
				else if (perYou.isMaleSex()) this.showPerson("carol6b.jpg");
				else this.showPerson("carol6g.jpg", "50vw");
				addPlaceTitle(md, herName);
				if (perYou.isMaleSex()) md.write("<p>" + herName + " gives you a blowjob</p>");
				else md.write("<p>" + herName + " licks you</p>");
				startQuestions();
				addLinkToPlaceC(md, "talk more with Carol", 424);
				addLinkToPlace(md, "leave the house", 5);
				WritePlaceFooter(md);
				return true
			}
		}
		return false
	};
	per.showPersonChat = function(bGeneral, md) {
		if (!this.isHere() || sType !== "") return;
		var sw = perYou.isMaleSex() ? "Volkhov" : "Vedma";
		if (Place == 424 || Place == 420)
			if (this.checkFlag(12)) addLinkToPlaceO(md, "play with her body", 423, "type=carolpool");
		if (Place == 424) {
			if (perYou.isMaleSex()) {
				addLinkToPlaceO(md, "play with her body",
					424, "type=bj");
				addLinkToPlaceO(md, "play with her toys", 424, "type=fuck")
			} else {
				addLinkToPlaceO(md, "have her use her tongue", 424, "type=bj");
				addLinkToPlaceC(md, '"Let\'s put that collection to good use"', 424, "type=fuck")
			}
			if (!this.checkFlag(4)) addQuestionR(md, "ask her if she is well", "&quot;I have a beautiful lover, a smart and kindhearted daughter and lots of naughty dreams about blissfully serving my little " + sw + ". You are often wearing a black cape and high collar in them and order me to capture other woman for you to fuck, though.&quot; She laughs playfully.</p>" +
				"<p>&quot;Maybe we could visit Kristin one of these days? I may have an idea for an interesting roleplay.&quot;", "Carol", "setPersonFlag(\\'Carol\\',4)");
			if (!this.checkFlag(5) && isCharmedBy("Ellie")) addQuestionR(md, "ask about Ellie", getCharmedLevel("Ellie") == 4 ? "&quot;I would never have thought that she could be so Kinky, did you cast your spell on her as well, my naughty " + sw + "?&quot; Carol chuckles.</p>" + "<p>&quot;She has been surprisingly accepting of both my affair with Kristin and yourself. We don&rsquo;t really argue anymore and she has even been a great help in the house.&quot;</p>" +
				"<p>&quot;I... sometimes wonder if something is off, but it passes. I&rsquo;m happy that she is happy with you.&quot;" : "<p>We have argued over Kristin for so long, it&rsquo;s almost eerie to have her accept, even encourage it...&quot; Carol muses.</p>" + "<p>&quot;I always understood her anger. I had raised her to be faithful and yet, started an affair with her boss... even asked her to keep it a secret from Sally.&quot;</p>" + "<p>&quot;With you, it&rsquo;s different, no secrets, no shame. She thinks it&rsquo;s great that Kristin is part of the Family now and I will come clear with Sally as well... whenever she is back. We still sometimes argue but it&rsquo;s a lot less intense." +
				(perYou.isMaleSex() ? "" : "&quot;Oh, she has also become rather curious  about how to please a woman, too.&quot; Carol winks"), "Carol", "setPersonFlag(\\'Carol\\',5)");
			if (!this.checkFlag(6)) addQuestionR(md, "ask about her collection", "&quot;Sally and I loved to experiment, and we usually had money to spare. So, what began with a handful of toys grew over time and when things began to cool down between us, I often bought new toys to spice things up... it even sometimes worked.&quot;</p>" + "<p>Carol laughs and rolls onto her back to present her body to you invitingly.</p>" +
				"<p>&quot;Feel free to use whatever you like, including myself.&quot; She winks.", "Carol", "setPersonFlag(\\'Carol\\',6)");
			if (!perYou.isMaleSex() && perYou.FindItem(45) === 0 && !this.checkFlag(7) && this.checkFlag(6)) addQuestionR(md, '"anything you would recommend?"', "&quot;This might be entirely self-serving, but I&rsquo;d like you to have this.&quot;</p>" + "<p>She takes out a strap-on dildo and hands it to you.</p>" + "<p>&quot;It&rsquo;s nearly new, probably one of my favorite designs, and I&rsquo;d love to hear tales of you using it to please your other women as well. It&rsquo;ll be like a piece of me is with you when you fuck them.&quot;",
				"Carol", "setPersonFlag(\\'Carol\\',7);PlaceI(45)");
			if (!this.checkFlag(8)) addQuestionR(md, "ask about her marriage", "&quot;Curious, are you?&quot;</p>" + "<p>&quot;Sally and I have been married for over 20 years, but the fire is kind of... gone.&quot;</p>" + "<p>&quot;She is a pretty successful businesswoman and often traveling. We decided early that I stay at home to raise Ellie and tend to the house, but these days, when she is at home, everything is just one huge routine, even sex.</p>" + "<p>&quot;I wouldn&rsquo;t mind sharing her, by the way, you do have a way to make sex exiting, little " +
				sw + ".&quot;", "Carol", "setPersonFlag(\\'Carol\\',8)");
			if (!this.checkFlag(9) && this.checkFlag(8)) addQuestionR(md, "ask how they met", "&quot;I was working the reception desk of a hotel in Kiev while she was staying there on one of her Business trips, and well, while it wasn&rsquo;t exactly love at first sight, we got along well, spoke often, finally went on a date and... well we pretty much never left her room.&quot;</p>" + "<p>Carol seems to think back for a moment and continues.</p>" + "<p>&quot;I was taken by her charm and lavish lifestyle, and as time passed, she visited more often, we spoke  on the phone, and in the end, I decided to take her invitation to move here, learn the language and finally get married as a loving mother and housewife in a land where lesbians aren&rsquo;t seen as mentally disordered.&quot;",
				"Carol", "setPersonFlag(\\'Carol\\',9)");
			if (!this.checkFlag(10)) addQuestionR(md, "ask about Kristin", "&quot;I know what you are getting at.&quot; Carol chuckles</p>" + "<p>&quot;Kristin is a good friend, but we are not in love and I know of at least one other woman she is regularly seeing, not to mention her understandable devotion to you.&quot;</p>" + "<p>&quot;The affair... well it just developed over time and I remember I often had doubts before I met you...&quot;</p>" + "<p>&quot;Now, it all seems clear, though, we are all united in servitude to our wonderful little " +
				sw + " and how can this possibly be wrong?", "Carol", "setPersonFlag(\\'Carol\\',10)");
			if (!this.checkFlag(11) && this.checkFlag(10)) addQuestionR(md, "ask who Kristin is seeing?", "&quot;Her name is Karen and she&rsquo;s working at the Library, just look for the biggest pair of jugs in the place and you can&rsquo;t possibly miss her.&quot; Carol laughs.</p>" + "<p>&quot;But be careful, if you stare at them too long, Ms. Adams will likely bump into you with a stack of books or accidentally run you over with a book mobile.&quot;",
				"Carol", "setPersonFlag(\\'Carol\\',11)");
			addSleepLink(md, "go to bed for the night with Carol", "Going to Bed with Carol", '<p style="position:absolute;left:50%;top:80%;cursor:pointer;font-size:1.1em;width:45%">As night falls Carol simply tells you "Time for bed my naughty ' + sw + ", and she lies down, ready for you to enchant her more.", Math.random() < .5 ? "carol10a.jpg" : "carol10b.jpg", true)
		}
	};
	per.handleItem = function(no, cmd) {
		if (no == 14 && cmd == 2)
			if (Place == 422) {
				if (sType == "seecarol") {
					CastCharmSpell("Carol", 422,
						1, "type=carol2");
					return "handled"
				}
				return ""
			}
		return ""
	};
	per.isPhoneable = function() {
		return checkPlaceFlag("Hotel", 11) && Place == 269 && this.isCharmedBy("You") && !this.checkFlag(12)
	};
	per.callThem = function() {
		if (Place == 269) {
			this.setFlag(12);
			dispPlace();
			receiveCall("", 'You call Carol to invite her to join you at the pool for a swim, and she immediately answers, "Naughtly little ' + perYou.getWitch(true, true) + ", you want to see me in my bikini don't you? Why no come here, and we can play in my pool\" That invitation sounded a little suggestive but you would guess there is a language thing so you do not quite get it. Still, you get it enough and agree to visit her for a swim.");
			WriteCommentsFooter(bChat, bChatLeft)
		}
	}
}

function initialiseCatherineRoss() {
	addPerson("Catherine");
	per.getPersonName = function(full) {
		return full === true ? "Catherine Ross" : this.name
	};
	per.getPersonAddress = function() {
		return "5 Cherise Rd, Glenvale"
	};
	per.whereNow = function() {
		if (Place == 438) return Place;
		return this.place
	};
	per.showEventPopup = function() {
		if (Place == 70 && !this.checkFlag(2) && isShopOpen(2) && getPersonOther("MrBeasley") > 0) {
			this.setFlag(2);
			showPopupWindow("Catherine", "<img src='Images/catherine0.jpg' class='imgpopup' alt='Catherine'>" + "You see Catherine walking down the hall, and she waves at you. She is the older sister of your friend Amy and she works at the school part-time in the administration offices. She also doubles as school-nurse when needed and she is available.<br><br>" +
				"You have gotten to know her quite well, she is a friendly and outgoing person, and you have become friends with her since you met her visiting Amy's home. Catherine is, well, sexually liberated, enjoying a <i>wide</i> range of lovers and experiences, and enjoys chatting about them with Amy or yourself. You do know she keeps this side of her life separate from work, she strictly takes no students or teachers as lovers. She has not approached you, not wanting to damage her relationship with her sister Amy, but has commented that you are cute!<br><br>" +
				"You say 'Hi' to her, but she only has a moment to chat. She mentions something about an appointment with 'that slime Beasley', and then going to have a coffee with her other sister Adele. You have only once met Adele in passing, she never seems to be home when you visit, you assume she lives somewhere else.");
			return true
		}
		if (Place == 438 && !this.checkFlag(15) && sType === "") {
			this.setFlag(15);
			showPopupWindow("Catherine's Book", "<img src='Images/catherine-shoot1.jpg' class='imgpopup' alt='Catherine'>" + 'You follow Catherine into her bedroom and she goes and sits on her bed, but as she does she knocks a glossy book onto the floor with a rather theatrical "Oops, silly me" and she gestures for you to pick it up for her.</p>' +
				"<p>The book is an adult photoshoot, artistic and beautifully done, but full on lesbian erotica starring your friend Catherine here! You did not realise she had ever done this sort of thing, not that it surprises you in the least!</p>" + "<p>You compliment the shoot and of course Catherine and she explains that she did a few of these sort of shoots for the fun. She smiles and gestures to a shelf and some videos...", "dispPlace(Place,'type=catherineshoot2')");
			return true
		}
		if (Place == 438 && sType === "catherineshoot2") {
			showPopupWindow("Catherine's Videos",
				"<img src='Images/catherine-shoot2.jpg' class='imgpopup' alt='Catherine'>" + 'Catherine shows you a video, "I also did a few videos, some for money, others with some friends just for the fun"</p>' + "<p>Once again you are not surprised in the least, Catherine has always done whatever she wanted and can always look after herself. You are just surprised she had never bragged about it in the past!</p>" + "<p>She shows you a few of the titles and suggest that you could always watch one with her sometime.");
			return true
		}
		return false
	};
	per.showEvent = function() {
		var md;
		if (Place == 269 && sType == "catherinepool") {
			WaitHereOnly(6);
			md = WritePlaceHeader();
			this.showPerson("catherine-pool.jpg");
			addPlaceTitle(md, "Swimming with Catherine");
			md.write('<p>Catherine arrives and for a moment you are surprised at how conservative she is dressed, a red one piece. Then you see how it is almost transparent and you can only think "That\'s Catherine for you". Maybe swimming is a bad idea, then again it would be a lovely sight!</p>' +
				"<p>You also know she will not let you leave without something more physical than a swim...</p>");
			startQuestions();
			addLinkToPlaceC(md, "...Catherine has no modesty...", Place, "type=catherinepoolsex");
			WritePlaceFooter(md);
			return true
		}
		if (Place == 269 && sType == "catherinepoolsex") {
			md = WritePlaceHeader(false, "td-left-large");
			this.showPerson("catherine-pool-sex.jpg");
			addPlaceTitle(md, "Openly Fucking Catherine");
			md.write("<p>Discetion has never been Catherine's way, so there is little neef to find an out of the way place, aside from your own modesty that is. You do your best to not scandalise those few people around, but Catherine is vocal and obviously enjoying the attention and trying to attract attention!</p>");
			startQuestions();
			addLinkToPlaceC(md, "later...say goodbye to Catherine", Place);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "catherinebusy" || !this.checkFlag(9) && (Place == 10 || Place == 242) && nFromPlace != Place && nTime > 288 && Math.random() < .25) {
			if (!checkPersonFlag("MrBeasley", 3))
				if (Place == 10 && wherePerson("Monique") != 10 || Place == 242 && wherePerson("MrsTanika") != 242) {
					setQueryParams("type=catherinebusy");
					this.setFlag(9);
					md = WritePlaceHeader();
					this.showPerson("catherine1.jpg");
					addPlaceTitle(md, "Catherine's Busy");
					md.write("<p>You step into the " +
						(Place == 10 ? "classroom" : "lounge") + " and you see it is occupied. Catherine is here with a friend, well you assume a friend, you have never seen the man before. He does not work at the school and he is too old to be a student, then again you know Catherine has her rules about mixing work and play.</p>" + '<p>The man is enthusiastically fucking Catherine, so lost in his passion he does not notice you. Catherine does see you and smiles, then she gestures with one hand, a waggle to say "he is so-so".</p>' +
						'<p>She returns her attention to her lover, and you back away not wanting to interrupt them. You know based on previous experience with Catherine that you will likely never see the man again, a "so-so" means he is history!</p>');
					startQuestions();
					addLinkToPlaceC(md, "leave them alone", 70);
					WritePlaceFooter(md);
					return true
				}
		} else if (Place == 481) {
			if (sType === "catherinehere") {
				this.setFlag(5);
				md = WritePlaceHeader(false, "td-left-med");
				this.showPerson("catherine2a.jpg");
				addPlaceTitle(md, "Catherine's Here As Promised");
				md.write("<p>You turn around and there is Catherine standing next to a bulldozer dressed in some alluring shorts and top. She poses for you for a moment, and then quickly gives you a kiss,</p>" + '<p>"Thank you ' + perYou.getPersonName() + " for saving Amy and me from that slimy bastard Beasley! Adele has been telling me about Kurndorf, forbidden magics and a whole lot of things. " + "She make you sound like a 'Kurndorf-in-training', an aspiring " + (perYou.isBornMale() ? "warlock" : "witch") + ' seeking everyone to be their sextoys and slaves", she laughs, but she has hit a bit close to the bone. While you would not ever think of the excesses or Kurndorf, a lot of that...</p>' +
					'<p>Unaware of your thoughts Catherine continues, "I don\'t care, I love being a sextoy or playing with them, both plastic or flesh and blood. If you want to rule this town then so what. I know you and trust you will not go too far."</p>' + '<p>She pauses, "If you want you can use your magic on me, but from what Adele says it is a sort of super-aphrodisiac that makes you really susceptible. Well, it won\'t change a thing in me, you know I am a nymphomaniac already, and I will do anything you want, you saved us!"</p>' +
					'<p>Again she pauses, "I have never approached you in respect for Amy, but she can share, and my rule of never fucking at school I can break for you...But I ask two things of you...", she hesitates, and you ask her what,</p>' + '<p>"I do not care how you do it, make Beasley pay, fuck him up! ' + (isMurderPath() ? "I do not mean hurt him or kill him, punish him!" : "") + '", you had never seen this vengeful side of Catherine before! She continues,</p>' + '<p>"While I would prefer if you leave Amy alone, I doubt you will, so please just be nice to her!". Well, the protective big sister emerges from Catherine you see. You ask her about Adele,</p>' +
					"<p>\"Oh Adele, that stuck-up, over-protective prude! Let's turn her into a " + (perYou.isMaleSex() ? "cock-sleeve, an orgasming cock-ornament" : "pussy-slave, a cunt-licker") + '...", you interrupt her, you get the point. You are curious, she wants to protect Amy, but not Adele, and Catherine explains,</p>' + '<p>"She has always tried to interfere with my hobby", you know she means fucking, "and thinks that as she is the oldest she is in charge always. She needs to loosen up, get fucked a lot, become a nice little sex-addicted slave!", you stop her again, you get her point, and again see her vengeful side.</p>' +
					"<p>Catherine smiles, she was probably just got carried away a bit, but it seems you have a new and completely willing ally. She closes her eyes and says,</p>" + '<p>"Ok, so waste your magic on me if you want some sort of completeness, if not let me reward you in the way I do best" and she starts unbuttoning her shorts.</p>');
				startQuestions();
				addLinkToPlaceC(md, "accept her reward", 481, "type=reward1");
				WritePlaceFooter(md);
				return true
			}
			if (sType === "meeting" || !this.checkFlag(5) && this.checkFlag(6) && getHour() ==
				12) {
				setQueryParams("type=meeting");
				md = WritePlaceHeader();
				addPlaceTitle(md, "Catherine is not here?", "accessroad-site.jpg");
				md.write("<p>You look around the site, it is the agreed time but Catherine is not here! You are surprised, Catherine is usually quite punctual, except where her libido gets in the way...Possibly she met someone cute, but it is unlike her to be late and not to call or SMS.</p>" + "<p>You suppose you could give her a phone call, you have her number in your phone's <b>address book</b>...or leave and return another day.</p>");
				startQuestions();
				addLinkToPlaceC(md, "leave disappointed", 481, "", "You wait for a while, and then leave disappointed", "WaitHereOnly(3)");
				WritePlaceFooter(md);
				return true
			}
			if (sType == "charmcatherine1") {
				md = WritePlaceHeader();
				this.setFlag(12);
				this.showPerson("catherine3c.jpg");
				addPlaceTitle(md, "Catherine Under A Charm Spell");
				md.write("<p>You recite the spell and explain to Catherine that there is always an advantage to the spell, both in what you can learn from it, and that it protects her from others casting it on her themselves. She sighs,</p>" +
					'<p>"Wow ' + perYou.getPersonName() + ' that is one hell of a rush! Adele told me it was like a super aphrodisiac and she was not kidding!", as she talks she removes her shorts and unbuttons her top. You see her eyes start to change, taking on a greenish tint as she says, "So ' + perYou.getPersonName() + ' fuck me!"</p>' + "<p>Now it is how do you want to proceed, Catherine is a friend, she has always been a bit of a nymphomaniac, now a highly aroused nymphomaniac. It will be difficult to talk to her about much more than sex. You decide that just enslaving her just does not quite seem right, she is a friend, but she did show that image of her in bondage.</p>");
				startQuestions();
				addLinkToPlaceC(md, "talk about domination and submission", 481, "type=charmcatherine2");
				WritePlaceFooter(md);
				return true
			}
			if (sType == "charmcatherine2") {
				md = WritePlaceHeader();
				this.showPerson("catherine4c.jpg");
				addPlaceTitle(md, "Catherine Under A Charm Spell");
				md.write("<p>You ask Catherine to talk about that bondage picture she sent and about embracing that sort of relationship with you,</p>" + '<p>"If that is the sort of games you want to play ' + perYou.getPersonName() + ' that is great with me, but variety is the spice of life. Fuck me in as many ways as you can, in as many places as you can!"</p>' +
					"<p>Well that sounds like the Catherine you have always known. As you consider, she strips the rest of her clothing and poses in front of the bulldozer and continues,</p>" + '<p>"I told you, fuck up Beasley and be nice to Amy and I will do anything, absolutely anything for you. I\'ll be your devoted slave girl, your fucktoy, anything you want!"</p>' + "<p>It seems the spell is only affecting her a little, aside from her talk about it's aphrodisiac properties, but your words are not shaping her thoughts and mind very much. Then again you are not really trying, she will give you anything you want!</p>" +
					'<p>She urgently asks, "Come on fuck me already!!"</p>');
				startQuestions();
				addLinkToPlaceC(md, "take her", 481, "type=charmcatherine3");
				WritePlaceFooter(md);
				return true
			}
			if (sType == "charmcatherine3") {
				md = WritePlaceHeader(false, perYou.isMaleSex() && isExplicit() ? "td-left-large" : "");
				if (perYou.isMaleSex()) this.showPersonRorX("catherine5b.jpg");
				else this.showPerson(perYou.isMaleSex() ? "catherine5b.jpg" : "catherine5gc.jpg");
				addPlaceTitle(md, "Catherine Under A Charm Spell");
				md.write("<p>You have often fantasised about a sexual encounter with Catherine, but you have always considered it impossible. Now now!</p>" +
					"<p>You start to remove your clothes, and Catherine almost jumps on you in her eagerness to help. Quickly she strips you naked");
				if (perYou.isMaleSex()) md.write("and takes your manhood in hand and expertly licks and sucks you to a full erection, not that you needed much after so many daydreams.</p>" + '<p>She tells you that she is more than ready, pushes you down and mounts herself on your cock. She gasps as she does, her hips jerking and she groans "cumming so quickly...". After a brief pause she starts to move, commenting "...but the more the merrier..."</p>' +
					"<p>She fucks herself on you, and you fuck her, changing her mounted to you on top as she has several orgasms. She is an amazing lover, skilled and passionate and you reach your peak and cum into her as she has yet another orgasm.</p>" + '<p>After she comments, "Wow that is one amazing aphrodisiac, if it lasts then I am not sure I will be able to concentrate on anything besides sex!", than again you are not sure if she ever did before</p>');
				else md.write("she kneels to start licking and playing with your pussy, to arouse you, not that you needed much after so many daydreams.</p>" +
					'<p>She tells you that she is more than ready, and eagerly licks your pussy and clit while furiously masturbating herself. She rapidly has an orgasm, gasping into your pussy as she does, "cumming so quickly...". After a brief pause she continues licking, commenting "...but the more the merrier..."</p>' + "<p>She licks you to an incredible orgasm, she is an amazing lover, skilled and passionate, and you are sure she orgasms as well, again.</p>" + '<p>After she comments, "Wow that is one amazing aphrodisiac, if it lasts then I am not sure I will be able to concentrate on anything besides sex!", than again you are not sure if she ever did before</p>');
				startQuestions();
				addLinkToPlaceC(md, '"Let\'s discuss Adele"', 481, "type=planadele");
				WritePlaceFooter(md);
				return true
			}
			if (sType == "reward1") {
				md = WritePlaceHeader(false, "td-left-med");
				this.showPerson("catherine3r.jpg");
				addPlaceTitle(md, "Catherine's Reward");
				md.write("<p>You agree, there is no need to waste mana, Catherine is true to her word and you want to deal with Mr. Beasley. There is no problem beingcareful around Amy, she is your friend as well. You tell Catherine that you agree to her conditions and that there is no need to use the spell, you trust her.</p>" +
					'<p>Catherine looks at you with her best seductive expression, "Well then, this is something we have both thought about so let\'s do it!"</p>');
				startQuestions();
				addLinkToPlaceC(md, '"yes please"', 481, "type=reward2");
				WritePlaceFooter(md);
				return true
			}
			if (sType == "reward2") {
				md = WritePlaceHeader();
				this.showPerson("catherine4r.jpg");
				addPlaceTitle(md, "Catherine's Reward");
				md.write("<p>Catherine starts to strip the rest of her clothing, doing so in a exaggerated stripperish way, ending with one leg resting on the blade of the bulldizer. She looks at you and asks,</p>" +
					'<p>"Am I the only one going to be naked here?", you realise you had been so fascinated with her strip that you are still clothed. You quickly remove your clothing as well, more a quick rush than a performance like she did. As you do Catherine comments,</p>' + '<p>"It has been so difficult to stop myself from seducing you. It is what I do, but I have my code and there is Amy. You do know she likes you? I mean more than friends but not quite love but it was a possibility.". Your clothes are now removed and Catherine beckons to you,</p>' +
					'<p>"I had thought you were so obsessed with magic and that girl Kate, the idea of you becoming some sort of ' + perYou.getMaster() + ' of a harem...Well call me a harem-girl!"</p>');
				startQuestions();
				addLinkToPlaceC(md, "take your harem girl", 481, "type=reward3");
				WritePlaceFooter(md);
				return true
			}
			if (sType == "reward3") {
				md = WritePlaceHeader(false, perYou.isMaleSex() && isExplicit() ? "td-left-large" : "");
				if (perYou.isMaleSex()) this.showPersonRorX("catherine5b.jpg");
				else this.showPerson(perYou.isMaleSex() ? "catherine5b.jpg" :
					"catherine5gc.jpg");
				addPlaceTitle(md, "Catherine's Reward");
				if (perYou.isMaleSex()) md.write("<p>Catherine takes your manhood in hand and expertly licks and sucks you to a full erection, not that you needed much after so many daydreams.</p>" + '<p>She tells you that she is more than ready, pushes you down and mounts herself on your cock. She gasps as she does, and then she starts to move, commenting "...fells like you are ready..."</p>' + "<p>She fucks herself on you, and you fuck her, changing her mounted to you on top as she has several orgasms. She is an amazing lover, skilled and passionate and you reach your peak and cum into her as she has yet another orgasm.</p>" +
					'<p>After she comments, "Wow, I guess magic is not the only thing you are good at!"</p>');
				else md.write("<p>Catherine kneels to start licking and playing with your pussy, to arouse you, not that you needed much after so many daydreams.</p>" + '<p>She tells you that she is more than ready, and eagerly licks your pussy and clit while furiously masturbating herself. She rapidly has an orgasm, gasping into your pussy as she does, "cumming so quickly...". After a brief pause she continues licking, commenting "...but the more the merrier..."</p>' +
					"<p>She licks you to an incredible orgasm, she is an amazing lover, skilled and passionate, and you are sure she orgasms as well, again.</p>" + '<p>After she comments, "Wow, I guess magic is not the only thing you are good at!"</p>');
				startQuestions();
				addLinkToPlaceC(md, '"Let\'s discuss Adele"', 481, "type=planadele");
				WritePlaceFooter(md);
				return true
			}
			if (sType == "planadele") {
				md = WritePlaceHeader();
				this.showPerson(this.isCharmedBy() ? "catherine6c.jpg" : "catherine6r.jpg");
				addPlaceTitle(md, "Now For Adele!");
				md.write("<p>You start to redress, but Catherine makes no such move, just holding her breasts, clearly for your pleasure.</p>");
				if (this.isCharmedBy()) md.write("<p>Catherine's eyes are closed, she seems to be concentrating on the feelings of the spell as it saturates her body, \"Wow " + perYou.getPersonName() + ' this magic is such a rush. Adele is going to love and hate this, she is a bit of the control freak, and she will hate becoming just a sextoy. She will love this feeling, she once told me she loved sex! It was nice to hear we had something in common!"</p>');
				else md.write('<p>Catherine is smiling at you, "' + perYou.getPersonName() +
					', Adele is going to love and hate being your little harem-girl, you will have to use your magic on her. She is a bit of the control freak, and she will hate becoming just a sextoy. She will love the extreme aphrodisiac feeling, she one told me she loved sex! It was nice to hear we had something in common!"</p>');
				md.write("<p>You explain that Adele had mentioned that she is protected from magic, probably some item descended from their ancestor Lady Elizabeth Ross. You think it is probably the earrings she was wearing but you cannot be sure. Catherine thinks for a moment,</p>" +
					'<p>"Probably, those earrings are very old, handed down the female line of our family. I think I can do something, there are some very similar ones we also have, I can swap them around and it should make her available to become your ' + (this.isCharmedBy() ? "slave" : "harem-slave") + '. It will take a while, at the very earliest tonight or tomorrow morning. I will give you a call when it is setup"</p>' + "<p>You ask Catherine about Amy, explaining it is more you are concerned if she is alright, and you immediately realise you should not of. It will just sound like you want to charm Amy as well...maybe you do but that is not what you meant. Catherine cautiously answers,</p>" +
					'<p>"She is tougher than you think. She is handling it well, but she did not return home. She is staying with a friend for now...friend, well sort of a friend...I would probably use a different word...Look once Adele is out of the way as such, I\'ll tell you more."</p>' + "<p>What was that? You thought you knew all of Amy's friends but it sounds complicated. You agree to leave the question of Amy alone for now, and ask Catherine to call you when things are ready for Adele.</p>");
				startQuestions();
				addLinkToPlaceC(md,
					"say goodbye for now", 481);
				WritePlaceFooter(md);
				return true
			}
		}
		if (Place != 438) return false;
		if (sType == "charmcatherinelater1") {
			md = WritePlaceHeader();
			this.showPerson("catherine-charmlater1.jpg");
			addPlaceTitle(md, "Catherine Under A Charm Spell");
			md.write("<p>You recite the spell and explain to Catherine that there is always an advantage to the spell, both in what you can learn from it, and that it protects her from others casting it on her themselves. She sighs,</p>" + '<p>"Wow ' + perYou.getPersonName() + ' that is one hell of a rush! Adele told me it was like a super aphrodisiac and she was not kidding!", as she talks she removes most of her underwear. You see her eyes start to change, taking on a greenish tint as she says, "So ' +
				perYou.getPersonName() + ' fuck me!"</p>' + "<p>Now it is how do you want to proceed, Catherine is a friend, she has always been a bit of a nymphomaniac, now a highly aroused nymphomaniac. It will be difficult to talk to her about much more than sex. You decide that just enslaving her just does not quite seem right, she is a friend, but she did show that image of her in bondage.</p>");
			startQuestions();
			addLinkToPlaceC(md, "talk about domination and submission", Place, "type=charmcatherinelater2");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "charmcatherinelater2") {
			md = WritePlaceHeader();
			this.showPerson("catherine-charmlater2.jpg");
			addPlaceTitle(md, "Catherine Under A Charm Spell");
			md.write("<p>You ask Catherine to talk about that bondage picture she sent and about embracing that sort of relationship with you,</p>" + '<p>"If that is the sort of games you want to play ' + perYou.getPersonName() + ' that is great with me, but variety is the spice of life. Fuck me in as many ways as you can, in as many places as you can!"</p>' +
				"<p>Well that sounds like the Catherine you have always known. As you consider, she takes out a few things from the table besides her bed, a ball-gag and a collar. She puts the collar on, and tells you,</p>" + '<p>"' + perYou.getMaster() + ', I am your slave to fuck whenever you want!", and with that she puts on the ball-gag and poses sexily for you!</p>' + "<p>Well, withthat Catherine is your charmed slave, a perfectly willing slave and friend!</p>");
			startQuestions();
			addLinkToPlaceC(md, "talk to 'Charmed' Catherine",
				Place);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "catherinebj") {
			var cb = this.isCharmedBy() ? "catherine-bedroomc" : "catherine-bedroom";
			if (perYou.isMaleSex()) {
				if (isExplicit()) {
					md = WritePlaceHeader(false, "td-left-med");
					this.showPersonX(cb + "-sex-bjb.jpg")
				} else {
					md = WritePlaceHeader();
					this.showPerson(cb + "-sex-bjb.jpg")
				}
				addPlaceTitle(md, "Catherine");
				md.write("<p>Catherine gives you a blowjob.</p>")
			} else {
				md = WritePlaceHeader();
				this.showPerson("catherine-bedroom-sex-bjg.jpg");
				addPlaceTitle(md, "Catherine");
				md.write("<p>Catherine licks you.</p>")
			}
			startQuestionsOnly();
			addLinkToPlace(md, "leave the bedroom", 436);
			addLinkToPlace(md, "leave the house", 37);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "catherinefuck") {
			if (perYou.isMaleSex()) {
				md = WritePlaceHeader();
				this.showPersonRorX("catherine-bedroom-sex-fuckb.jpg");
				addPlaceTitle(md, "Catherine");
				md.write("<p>You fuck Catherine.</p>")
			} else {
				md = WritePlaceHeader(false, "td-left-med");
				this.showPerson("catherine-bedroom-sex-fuckg.jpg");
				addPlaceTitle(md, "Catherine");
				md.write("<p>Catherine and you have a 69</p>")
			}
			startQuestionsOnly();
			addLinkToPlace(md, "leave the bedroom", 436);
			addLinkToPlace(md, "leave the house", 37);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "catherinestraponfuck") {
			md = WritePlaceHeader(false, "td-left-large");
			this.showPersonRorX("catherine-bedroom-sex-straponfuckg.jpg");
			addPlaceTitle(md, "Catherine");
			md.write("<p>You fuck Catherine with your strap-on.</p>");
			startQuestionsOnly();
			addLinkToPlace(md, "leave the bedroom", 436);
			addLinkToPlace(md, "leave the house", 37);
			WritePlaceFooter(md);
			return true
		}
		return false
	};
	per.passTimeDay =
		function() {
			if (this.checkFlag(4) && !this.checkFlag(5)) this.setFlag(6);
			return ""
		};
	per.showPersonTextHere = function(md) {
		if (Place == 436 && this.isHere() && checkPersonFlag("AdeleRoss", 6) && sType === "")
			if (wherePerson("AdeleRoss") == 436) md.write("<p>Catherine has joined Adele in the living room to greet you.</p>");
			else md.write("<p>Catherine is in the living room to greet you.</p>")
	};
	per.showPersonChat = function(bGeneral, md) {
		if (Place != 436 && Place != 438 || sType !== "") return;
		if (!checkPersonFlag("AdeleRoss", 6)) return;
		if (!isPlaceKnown("NursesOffice") &&
			checkPersonFlag("DoctorKay", 1)) addQuestionR(md, "ask Catherine about the Nurse you saw at school", "You ask Catherine about the nurse you saw at school,</p>" + "<p>&quot;Yes, she is a friend of mine from a club we both hang-out at, she is a doctor at the hospital but she works limited hours there. As a favour I asked if she could handle my shifts as the school nurse until that slime is dealt with&quot;</p>" + "<p>You have almost never been to the Nurses Office at school and ask Catherine where it is again, and she shakes her head in frustration at your idiocy and gives you directions.",
			"Catherine", "bChatLeft=false;setPlaceKnown(\\'NursesOffice\\');setPersonFlag(\\'DoctorKay\\',2)");
		if (!this.checkFlag(11)) addQuestionR(md, "ask Catherine about Amy", "You ask Catherine about where is Amy? Catherine answers,</p>" + "<p>&quot;When we came home after..that slime Beasley..she grabbed a bag and immediately left. She refused to talk about what happened. I am fairly sure she went to stay with someone but I do not know who. She is refusing to take my phone calls. I think she blames me, thinking I was angling for a threesome or something, never with <i>him</i>, she should have known that!&quot;</p>" +
			"<p>She is clearly hurt and worried about Amy but there is nothing more you can ask really.</p>", "Catherine", (Place == 436 ? "bChatLeft=false;" : "") + "setPersonFlag(\\'Catherine\\',11)");
		if (perGates.checkFlag(6) && !isPlaceKnown("AvernusClub")) addQuestionR(md, '"Catherine, is there a gentlemans club in Glenvale?"', "You ask Catherine about the gentlemans's club you were told about, if anyone knows Catherine has to. Catherine answers,</p>" + '<p>"Of course, I have attended a number of BDSM parties there. That image I accidentally sent you was sort of related. Take care, some of the Mistresses play rough!"</p>' +
			"<p>She gives you directions to the club, it is located in a side street off the shopping center. The club is open late at night until the early hours and is by invitation only. She quickly makes a phone call, and tells you,</p>" + '<p>"All set, you are now my personal guest for the club, you can visit any time you want"', "Catherine", "bChatLeft=false;setPlaceKnown(\\'AvernusClub\\')");
		if (Place != 438) return;
		if (this.checkFlag(15)) {
			var ex = isExplicit() && Math.random() < .6;
			var img = (ex ? "Explicit/" : "") + "catherine-video" +
				Math.ceil(Math.random() * (ex ? 13 : 3)) + ".gif";
			addWatchTVLink(md, "watch one of Catherine's videos", "Catherine's Video", img.indexOf("video4") != -1 || img.indexOf("video5") != -1 || img.indexOf("video6") != -1 ? "You watch a scene of one of Catherine's videos, a threesome scene, but the other woman is very familar, you could swear she is Mrs. Granger? You ask Catherine and she says</p>" + '<p>"You mean Kate Granger\'s mother? Well she did not use that name when we shot this video, but then again I used a different name too!"' :
				"You watch one of Catherine's videos, she certainly did a wide range of different scenes, but we are talking here about Catherine!", img)
		}
		if (perYou.isMaleSex()) {
			addLinkToPlace(md, "take her", 438, "type=catherinefuck");
			addLinkToPlace(md, "take her mouth", 438, "type=catherinebj")
		} else {
			addLinkToPlace(md, "ask her to lick you", 438, "type=catherinebj");
			addLinkToPlace(md, "lick each other", 438, "type=catherinefuck");
			if (perYou.FindItem(45) > 0) addLinkToPlace(md, "fuck her with your strap-on", 438, "type=catherinestraponfuck")
		}
		if (getCharmedLevel("AdeleRoss") ==
			4 && wherePerson("AdeleRoss") == 436) addLinkToPlace(md, "call for Adele to join you", 438, "type=catherineadelethreesome");
		addSleepLink(md, "sleep with Catherine", "Sleeping with Catherine", '<p style="position:absolute;left:25%;top:5%;cursor:pointer;font-size:1.1em;width:40%"><b>You talk to Catherine about sleeping with her, and you mean sleeping, not having sex, well not <i>only</i> having sex.</b>', (this.isCharmedBy() ? "catherine-bedroomc" : "catherine-bedroom") + "-sleep.jpg", true)
	};
	per.handleItem = function(no,
		cmd) {
		if (cmd != 2) return "";
		if (no == 14) {
			if (sType == "catherinebusy") {
				addComments("There are too many people here and the spell will not work on any one person here.");
				return "handled"
			}
			if (Place == 481) {
				if (sType == "catherinehere") {
					CastCharmSpell("Catherine", 481, 1, "type=charmcatherine1");
					return "handled"
				}
				if (sType == "reward1" || sType == "reward2" || sType == "reward3" || sType == "planadele") {
					if (!this.isCharmedBy()) addComments("Change your mind? Well, maybe, but how about another time?");
					else addComments("Catherine is already charmed!");
					return "handled"
				}
			} else if (Place == 438) CastCharmSpell("Catherine", Place, 1, "type=charmcatherinelater1", "", "", this.checkFlag(13));
			else if (Place == 436 && !this.isCharmedBy()) {
				addComments("It would be better to do this in the privacy of her bedroom");
				return "handled"
			}
		}
		return ""
	};
	per.isPhoneable = function() {
		return sType == "meeting" && Place == 481 || checkPlaceFlag("Hotel", 11) && Place == 269 && this.checkFlag(10)
	};
	per.callThem = function() {
		if (sType == "meeting" && Place == 481) {
			gotoPlace(481, "type=catherinehere");
			receiveCall("", "You call Catherine, and she immediately picks up,<br><br>" +
				'"Hi ' + perYou.getPersonName() + ', count to three and turn around!" and she hangs up.');
			WriteCommentsFooter(bChat, bChatLeft)
		} else if (!isDay()) WriteComments('You call Catherine to invite her to join you at the pool for a swim, and she answers enthusiasticaly, "I\'d love to, but how about in the daytime so I get get some sun as well?" You have no problems and agree to do this another time.');
		else {
			gotoPlace(Place, "type=catherinepool");
			receiveCall("", 'You call Catherine to invite her to join you at the pool for a swim, and she answers enthusiasticaly, "I thought you\'d never ask!" and she says she will be there soon.');
			WriteCommentsFooter(bChat, bChatLeft)
		}
	};
	per.addPersonPhoneCall = function() {
		if (this.checkFlag(2) && getHour() > 19 && !this.checkFlag(14))
			if (makeCall(true, 160)) this.setFlag(14);
		if (Place != 436 && checkPersonFlag("AdeleRoss", 5) && !this.checkFlag(4))
			if (makeCall(false, "", "The call is from Catherine's number! You answer the call and yes, it is her,<br><br>" + "<b>Catherine</b><br>" + '"Hey there ' + perYou.getPersonName() + " I heard you talking to Adele, she wouldn't let me see you. She is being an overprotective older sister, except I am the oldest. She thinks I am some sort of irresponsible slut...and I can be.<br><br>" +
					"And if you listen to her, you are some sort of figure from the old days of Kurndorf's coven, an evil sorcerer bent on sex and domination! " + "Well so am I, well not the sorcerer part, but I do like either submission or domination, the whole range of the B and D and S and M. I just sent you an image to demonstrate and you got that one before!<br><br>" + "Look, I don't care, you are a friend and I have to properly thank you. Meet me tomorrow midday, I should be able to get away from Adele then. You know that road-works that leads off Yoolaroo Dr and runs along side the park? Take the access road for trucks off Yoolaroo, you might have to climb a fence or something.<br><br>" +
					'Take care and look forward to me"<br><br>' + "With that she hangs up.")) {
				this.setFlag(4);
				addSMS(161);
				setPlaceFlag("Park", 4);
				setTimeout("usePhone('sms')", 10);
				return true
			}
		if (this.checkFlag(6) && getHour() > 12 && !this.checkFlag(5))
			if (makeCall(true, this.checkFlag(7) ? 163 : 162)) {
				this.setFlag(6, false);
				if (this.checkFlag(7)) this.setFlag(8);
				else this.setFlag(7)
			}
		if (this.checkFlag(5) && !this.checkFlag(10) && getHour() < 10)
			if (makeCall(true, this.isCharmedBy() ? 164 : 165)) this.setFlag(10);
		return false
	};
	per.getPersonSMS = function(id) {
		if (id ==
			160) return receiveSMS("Catherine", "I gasp as you grab my hair and force your cock into my slutty mouth, lewdly smacking my lips and  sucking you off.<br><br>" + "\u201cFuck me, sir!\u201d I beg. \u201cFuck my throat and slap me like the slut I am!\u201d", "catherinesms1.jpg") + replyToSMS("WTF? O_O") + receiveSMS("Catherine", "Shit! That wasn't meant for you!") + replyToSMS("You don't say") + receiveSMS("Catherine", "You can keep the pic. And if you don't show it around I might have another later. ;)");
		if (id ==
			161) return receiveSMS("Catherine", "A bit of fun", "catherinesms2.jpg");
		if (id == 162) return receiveSMS("Catherine", "I missed you, I gotta leave or Adele will get suspicious. See what you missed!", "catherinesms3.jpg");
		if (id == 163) return receiveSMS("Catherine", "I missed you again, Not sure how many more times we can do this before she stops me. You are really missing out!!", "catherinesms4.jpg");
		if (id == 164) return receiveSMS("Catherine", "It is done", "catherinesms4c.jpg");
		if (id == 165) return receiveSMS("Catherine",
			"It is done", "catherinesms4r.jpg");
		if (id == 166) return receiveSMS("Catherine", perYou.getPersonName() + " Adele is acting strange, she just went to work. She seems to have forgotten what you did. This is her getting ready for work. Don't know where she is, check back tonight", "Setting/adelesms1.jpg");
		if (id == 167) return receiveSMS("Catherine", perYou.getPersonName() + " found something, not an item but Adele talked about self-hypnosis. Could you turn that against her?", "catherinesms5.jpg");
		return ""
	}
}
var perDavy;

function isDavyDefeated() {
	return perDavy.isDead() || perDavy.getQuestBlueBottle() == 20 || perDavy.getQuestBlueBottle() == 21 || perDavy.other == 8 || perDavy.checkFlag(8)
}

function isDavyCaptive() {
	return perDavy.place != 9999 && !perDavy.checkFlag(6) && !perDavy.checkFlag(7) && (perDavy.getQuestBlueBottle() == 20 || perDavy.getQuestBlueBottle() == 21 || perDavy.other == 8 || perDavy.checkFlag(8))
}

function DavyEscapes() {
	if (!perDavy.checkFlag(8)) perDavy.setFlag(6)
}

function moveDavyToHotel1() {
	if (!isPlaceKnown("Hotel")) setPlaceKnown("Hotel");
	if (perDavy.other < 5) perDavy.other = 5;
	perDavy.place = 124;
	if (!checkPersonFlag("Bambi", 10)) setPersonFlagAfterTime("Bambi", 3, undefined, Math.ceil(Math.random() * 6))
}

function moveDavyToHotel2() {
	if (isDavyDefeated() || perDavy.checkFlag(6)) return;
	if (!isPlaceKnown("Hotel")) setPlaceKnown("Hotel");
	setPlaceFlag("Hotel", 8);
	if (perDavy.other != 8) perDavy.other = 10;
	perDavy.place = 184;
	movePerson("Kate", 184);
	setPersonOther("Kate", 99)
}

function initialiseDavyRobbins() {
	perDavy = addPerson("Davy", 9);
	per.extra = [0, 0, 0];
	per.getPersonName = function(full) {
		return "Davy Robbins"
	};
	per.getPersonAddress = function() {
		return isPlaceKnown("RobbinsHouse") ? "36 Yoolaroo Dr, Glenvale" : ""
	};
	per.getPersonGender = function() {
		return this.checkFlag(11) ? "woman" : "man"
	};
	per.isBornMale = function() {
		return true
	};
	per.getPossessionFace = function() {
		return Place == 124 ? "davy1" : "davy2"
	};
	per.getQuestBlueBottle = function() {
		return this.extra[1]
	};
	per.setQuestBlueBottle = function(no) {
		this.extra[1] =
			no
	};
	per.getPathHellgate = function() {
		return this.extra[2]
	};
	per.setPathHellgate = function(no) {
		this.extra[2] = no
	};
	per.passTimeDay = function() {
		this.setFlag(13);
		return ""
	};
	per.showEvent = function() {
		var md;
		var idx;
		if (Place == 144 && sType == "follow") {
			setPlaceKnown("SchoolField");
			md = WritePlaceHeader();
			addPlaceTitle(md, "Davy at the School Sports Fields", "schoolfield1.jpg");
			md.write("<p>You realise Davy is taking a shortcut to the school sporting fields so you hurry along a slightly different path to avoid being seen by him. You quickly get a clear view of the playing fields, but Davy is nowhere to be seen. You quickly double back, and for a moment you thought you saw him, but you lose sight of him. A moment later you hear him speak to you from off to one side,</p>" +
				'<p>"' + perYou.getPersonName() + ", he warned me about you, to stay away from you. But I had to tell you, " + (isCharmedBy("Kate", "Davy") ? "they are both mine, I didn't lie" : "she will be mine as well") + ' and you cannot stop me."</p>' + "<p>You see him vaguely in the trees and then he steps out of sight. You think he says something but you cannot hear it clearly.</p>" + "<p>Strange how he spoke, like he was taunting you.</p>");
			startQuestions();
			startAlternatives(md, "How do you react?");
			addLinkToPlaceO(md, "approach Davy",
				Place, "type=followhurt");
			if (perGates.other == 600) addLinkToPlaceO(md, "retreat, this might be an ambush", 9, "", "Davy might have his woman hiding around here somewhere, so you quickly retreat to the public areas in front of the school. Nothing happens, there is no sign that you were followed");
			addLinkToPlaceO(md, "what was that he said?", Place, "type=followok");
			endAlternatives(md);
			WritePlaceFooter(md);
			return true
		}
		if (Place == 144 && (sType == "followok" || sType == "followhurt")) {
			md = WritePlaceHeader();
			perDavy.setFlag(9);
			addPlaceTitle(md, "Stormwater Drain", "drain.jpg");
			if (sType == "followok") md.write("<p>You hesitate, Davy said something odd it sounded like an arcane word, maybe. Suddenly you feel a hand on your back shove you but you just stumble a little. You notice in front of you a stormwater drain, open with no protective grate! You look around to see Davy somehow now standing behind you. He looks disappointed and says after a pause,</p>" + '<p>"Look out for the drain", and before you can react he just walks away. You try to follow and you hear him say the words again and lose sight of him, you look around but Davy is gone, you have no idea where he went. You wonder if the slime was trying to push you into the drain?</p>' +
				"<p>You move the protective grate mostly back in place over the drain, and then make a quick phone call to the school admin office to report the problem.</p>");
			else {
				perYou.health = 90;
				perDavy.setFlag(10);
				md.write("<p>You step towards Davy to confront him about what he was talking about and stumble on the edge of an open stormwater drain right in front of you, you almost fell in! Suddenly you feel a hand on your back shove you but while you fall, you do not fall in to the drain. There is a sharp pain in your ankle and you look around to see Davy, somehow now standing behind you. He looks disappointed and says after a pause,</p>" +
					'<p>"Look out for the drain", and before you can react or stand he walks away. With some pain you get back to your feet, it does not feel like anything is broken or seriously hurt but you will have a bit of a limp for a while. Davy is gone, you have no idea where he went, but the slime pushed you! You would not be surprised if her opened the drain as well, there should be a protective grate over it, but you see it has been pushed aside.</p>' + "<p>With some pain you move the protective grate mostly back in place over the drain, and then make a quick phone call to the school admin office to report the problem.</p>")
			}
			md.write('<p><img style="float:right;width:5%;margin-left:5px" src="' +
				getThemeFolder() + 'symbol1.png" alt="Hexagram" title="Hexagram">After a quick but nervous check of the area, all you can find is carved on an ancient tree near to where you think you saw him a glyph of some sort, a symbol you think you have seen in a book somewhere but do not recognise. It is very old, the bark has almost grown back over it, but it does appear to have been crudely re-cut more recently.</p>');
			startQuestions();
			if (isShopOpen(2)) addLinkToPlace(md, "enter the School", 70);
			if (isPlaceKnown("Park")) addLinkToPlace(md,
				"walk into the park", 63);
			addLinkToPlace(md, "return to the front of the school", 9);
			WritePlaceFooter(md);
			return true
		}
		if (Place == 184 && sType === "checkphone") {
			md = WritePlaceHeader(false, "td-left-med");
			for (var i = 241; i < 250; i++) addSMSToPhotos(i);
			AddImage(perYou.isBornMale() ? "phoneb.jpg" : "phoneg.jpg");
			addPlaceTitle(md, "Checking Davy's Phone");
			md.write("<p>You pickup Davy's phone, he seems to have been taking photos and it is still active. You quickly check and see he has a few of his mother and sister, and a lot of photos and short videos of Kate, though he does seems to have been fascinated with photographing her submissive to him");
			if (isExplicit()) md.write(" and showing it...orally");
			md.write("</p><p>You quickly send copies of the more interesting images to your phone. You then try checking other things, like his SMS's or other data but as you do his phone locks up asking for a code. You doubt you will get it from him, so give up for now. You leave the phone here with the rest of his items.</p>");
			startQuestions();
			addLinkToPlace(md, "go back to the bar", 124);
			WritePlaceFooter(md);
			return true
		}
		if (Place != 161) return false;
		if (sType ==
			"playdavyanita") {
			if (perDavy.isMan()) {
				md = WritePlaceHeader();
				if (isExplicit()) this.showPersonRandomX("davycellar-male-train2", 2);
				else this.showPerson("davycellar-male-train2.jpg")
			} else {
				idx = String.fromCharCode(Math.floor(Math.random() * 4) + 97);
				md = WritePlaceHeader(false, idx == "a" ? "td-left-med" : "");
				this.showPerson("davycellar-female-train1" + idx + ".jpg")
			}
			addPlaceTitle(md, "Anita with Davy");
			if (perDavy.isMan()) md.write("<p>Davy is clearly afraid of Anita, and you can't really blame him for it. Hell, you are, too at times, and she is your devoted slave, but it is probably this fear that makes him fall in line so easily. Anita doesn't so much \u201ctrain\u201d him as that she is throwing him around, dragging him from place to place all while spitting demeaning expletives in his face.</p>" +
				"<p>You know that Bambi has restricted usage of the more painful and probably damaging tools in her arsenal, and Anita often makes her frustration about that known. Her hands are tightly wrapped around Davy's balls while she sits on his face and explains what she will do to him if he is unable to bring her to climax, and you have to admit you occasionally feel sorry for the poor guy, but not much.</p>");
			else md.write("<p>Davy is clearly afraid of Anita, and you can't really blame her for it. Hell, you are, too at times, and she is your devoted slave, but it is probably this fear that makes her fall in line so easily. Anita doesn't so much \u201ctrain\u201d her as that she is throwing her around, dragging her from place to place all while spitting demeaning expletives in her face.</p>" +
				"<p>You know that Bambi has restricted usage of the more painful and probably damaging tools in her arsenal, and Anita often makes her frustration about that known. She sits on Davy's face and explains what she will do to her if she is unable to bring her to climax, and you have to admit you occasionally feel sorry for the poor girl, but not much.</p>");
			if (isMurderPath()) md.write("<p>Still, it makes you think. Anita very clearly hates Davy for what he did to her and is pretty much only held back from doing him serious harm by your orders. The thought that she might ever be freed off the spell and that hatred shifts to you is... chilling.</p>");
			else md.write("<p>Still, it makes you think. Davy is Anita's enemy because you told her he is, and that order alone seems to be enough to make her hate him with scary passion. The thought that she might ever be freed off the spell and that hatred shifts to you is... chilling.</p>");
			startQuestions();
			addLinkToPlaceC(md, "that is all for now", 161);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "playdavybambi") {
			if (perDavy.isMan())
				if (isExplicit()) {
					md = WritePlaceHeader("td-left-med");
					this.showPersonRandomX("davycellar-male-train1",
						3)
				} else {
					idx = String.fromCharCode(Math.floor(Math.random() * 2) + 97);
					md = WritePlaceHeader(idx == "a" ? "td-left-med" : "");
					this.showPerson("davycellar-male-train1" + idx + ".jpg")
				}
			else {
				idx = String.fromCharCode(Math.floor(Math.random() * 4) + 97);
				md = WritePlaceHeader(false, idx == "a" ? "td-left-med" : "");
				this.showPerson("davycellar-female-train1" + idx + ".jpg")
			}
			addPlaceTitle(md, "Bambi with Davy");
			md.write("<p>\u201cI know you are still unwilling to submit to our " + perYou.getLord() + ", my " + this.getSex() + ".\u201d Bambi's fingers tenderly touch Davy's naked chest, slide over " +
				this.getHisHer() + " neck and caress " + this.getHisHer() + " cheek. \u201cBut I am sure you will not mind if we perform a little... show for " + perYou.getHimHer() + ", do you?\u201d</p>" + "<p>Davy's body trembles under her touch" + (this.isMaleSex() ? ", and you can see his cock twitching a little" : "") + ", yet " + this.getHeShe() + " remains hesitant. " + capitalizeFirstLetter(this.getHisHer()) + " eyes spitefully rest on you and " + this.getHeShe() + " refuses to answer.</p>" + "<p>\u201cI see.\u201d Bambi smiles cruelly. \u201cPerhaps I should get miss Anita to...\u201d</p>" +
				"<p>\u201cNo!\u201d Davy shouts hastily. \u201cN... no need...\u201d</p>" + "<p>Bambi's frowns at " + this.getHimHer() + (this.isMaleSex() ? ", her fingers starting to constrict around Davy's scrotum without a word" : ", her fingers starting to paifully pinch her nipple without a word") + ".</p>" + "<p>\u201cNo need, Ma'am!\u201d " + capitalizeFirstLetter(this.getHeShe()) + " quickly adds, and Bambi's fingers relax. \u201cI... play along.\u201d</p>" + "<p>\u201cGood " + capitalizeFirstLetter(this.getSex()) + ".\u201d</p>");
			if (this.isMaleSex()) md.write("<p>Bambi's lips barely touch Davy's in a fleeting kiss before she gives you a wink and turns away to get a few items, and even though Davy is less than pleased with his treatment, you can see his manhood already standing halfway at attention and his body trembling all over as he follows the sway of her hip.</p>" + "<p>In the next minutes, Bambi demonstrates the depths of her skills and experience. Her whip strikes Davy's shoulders, chest and tights with finesse and precision, never breaking skin or leaving lasting marks but definitely letting " +
				this.getHimHer() + " feel the sting of its impact.</p>" + "<p>Davy twitches, screams, and occasionally moans in pleasure whenever Bambi grants " + this.getHimHer() + " a moment of respite to tenderly caress his by now rockhard cock or place soft kisses to his skin, and as the scene goes on, his body seems to fall deeper into a haze of pain and pleasure.</p>" + "<p>Clamps are being attached to his nipples and other parts, a flogger hits his increasingly reddened skin... You expect him to protest when Bambi gets the strap on for the grand finale. But his mind seems barely there when she uses it to finally bring him to climax and force him to shoot his load all over his own body.</p>");
			md.write("<p>When Bambi is done with " + this.getHimHer() + ", " + this.getHeShe() + " looks as if slowly awakening from a weird dream, " + this.getHisHer() + " eyes glassy and watching her in a mix of fear and adoration as she tends to " + this.getHisHer() + " bruises, " + this.getHisHer() + " resistance broken down a little more.</p>");
			startQuestions();
			addLinkToPlaceC(md, "that is all for now", 161);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "playdavyteam") {
			if (perDavy.isMan()) {
				md = WritePlaceHeader();
				this.showPerson("davycellar-male-train3a.jpg")
			} else {
				md =
					WritePlaceHeader(false, "td-left-med");
				this.showPerson("davycellar-female-train3a.jpg")
			}
			addPlaceTitle(md, "Bambi and Anita with Davy");
			md.write("<p>Anita and Davy team up to train Davy</p>" + '<p style="font-size:x-small">Actual scenes to be implemented</p>');
			startQuestions();
			addLinkToPlaceC(md, "that is all for now", 161);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "transformgender") {
			CastTransform(1);
			this.setFlag(11);
			md = WritePlaceHeader(true, "", "black");
			showPopupWindow("Transformation", '<img src="Images/GenericSex/tg a.gif" style="width:50%;float:left;margin-right:6px;margin-top:1em;margin-bottom:2em" alt="TG">' +
				"<p>You cast the spell and Davy cries out, muffled by his gag. As you watch his body changes, growing thinner and your see his cock shrinking. His chest expands as you see breasts grow and his face softens to a feminine appearance.</p>" + "<p>After some time you can no longer call Davy a <b>he</b>, now <b>she</b> is very definitely female, nothing masculine is left, she is completely a woman! <i>She</i> looks at you shocked at the transformation.");
			setQueryParams("");
			WritePlaceFooter(md, "", true, true);
			return true
		}
		return false
	};
	per.handleItem = function(no, cmd) {
		if (cmd == 1 && (no == 52 || no == 64)) {
			var s = getSoulBoundCrystal(no);
			if (s != "")
				if (this.isHere() && !this.checkFlag(11)) {
					if (Place != 161) examineItem(no, "The " + s + " trembles slightly, maybe it would react better in another location with Davy.");
					else examineItem(no, "The " + s + " vibrates softly the closer you get to Davy.");
					return "handled"
				}
		}
		if (no == 18 && cmd == 2) {
			if (Place == 161 && this.place == 161) {
				if (this.checkFlag(11)) {
					addComments("You have already transformed <b>her</b>!");
					return "handled"
				}
				if (!CastTransform(1, true)) return "handled";
				ClearComments();
				dispPlace(Place, "type=transformgender");
				return "nofooter"
			}
			if (this.isHere()) {
				if (!CastTransform(1, true)) return "handled";
				addComments("The spell does not work, but there is an effect, you believe it may work at another time.");
				return "handled"
			}
		}
		if (no == 14 && cmd == 2)
			if (Place == 184) {
				addComments("You read the spell, but nothing happens.  Davy must have some sort of magical protection.");
				return "handled"
			}
		return ""
	}
}

function RepliesDebra(nR) {
	var myName = per.getYourNameFor();
	if (nR == 4E3) {
		addComments('"Really?  I live in number 22.  Why don\'t you come to visit my sister and me sometime? You will have to excuse the mess, we are still unpacking and setting up the house."');
		setPlaceKnown("KellyHouse");
		per.setFlag(1);
		addComments("You now know Debra & Kelly's address.")
	}
	if (nR == 6501) {
		addComments("Whatever you say, my " + myName + ".  If I find anything that may be magical I will return here and wait for you.");
		per.setFlag(3);
		per.place = 1E3
	} else if (nR == 6006) {
		moveDavyToHotel2();
		addComments('"I met someone by the name of Davy about ten minutes ago. He mentioned something about the school sporting grounds and then going to a hotel."');
		setPlaceKnown("SchoolField")
	} else if (nR == 7E3) {
		setQueryParams();
		per.place = 87;
		bChat = false;
		addComments("You tell your puppy to enjoy herself, and leave her playing in the park.");
		Place = 63
	}
	return true
}

function initialiseDebraKelly() {
	addPerson("Debra Kelly", 87);
	per.Replies = RepliesDebra;
	per.getPersonName = function(full) {
		if (full === true) return this.name;
		var clv = this.getCharmedLevel();
		if (clv == 2) return "Debra";
		if (this.checkFlag(8)) return "Puppy Debbie";
		return this.isCharmedBy() ? "Puppy Debra" : this.name
	};
	per.getPersonAddress = function() {
		return isPlaceKnown("KellyHouse") ? "22 Kollam St, Glenvale" : ""
	};
	per.isPersonInfo = function() {
		return this.isCharmedBy()
	};
	per.getPersonInfo = function() {
		if (this.getCharmedLevel() ==
			1) return "<img src='Images/debra11b.jpg' style='width:38%;float:right;margin-left:5px' alt='Debra'>" + "Debby really likes to be your pet, quite literally! She showed great interest in becoming your lapdog and so you fulfilled her wishes! Kind of! You can always bring her out of this puppy personality, but why should you? Both of you really enjoy this, you have your very own human pet and Debra can focus on her " + perYou.getMaster() + ". She has a sister, Janet, who is the one who looks after the two of them. Debra said that her sister is interested in their family\u2019s heritage and legacy. There are some hints that their family has something to do with Kurndorf. You should definitely check her out and talk about it!<br><br>" +
			"You fondle Deb\u2019s hazelbrown hair as she is sitting on your lap, naked. Perfectly obedient, like a dog. She knows that you need some quiet time to yourself, so she doesn\u2019t bother you with her questions. You love these relaxing minutes, without anything to worry about. Just you and a beautiful naked girl on your lap, waiting to serve you, her " + perYou.getMaster() + ".";
		else return "<img src='Images/debra11d-night.jpg' style='width:35%;float:right;margin-left:5px' alt='Debra'>" + "Debra is the lovely young woman you met in the Park. She is now your lovely girlfriend, happy to spend time with you in conversation or in a more intimate way."
	};
	per.whereNow = function() {
		if (!isDay() && this.place === 87) return 0;
		if (Place == 107) return Place;
		return this.place
	};
	per.showEvent = function() {
		var md;
		if (Place == 269 && sType == "debrapool") {
			WaitHereOnly(4);
			md = WritePlaceHeader();
			this.showPerson("debra-pool.jpg");
			addPlaceTitle(md, "Swimming with Debra");
			md.write("<p>Debra arrives, dressed in a pink and white bikini, and happily waits for you, to chat or something else.</p>");
			startQuestions();
			addLinkToPlaceC(md, "it is fairly private here...", Place, "type=debrapoolsex");
			addLinkToPlaceC(md, "chat and say goodbye to Debra", Place);
			WritePlaceFooter(md);
			return true
		}
		if (Place == 269 && sType == "debrapoolsex") {
			md = WritePlaceHeader();
			this.showPerson("debra-pool-sex.jpg");
			addPlaceTitle(md, "Being Discrete and Private with Debra");
			md.write("<p>You ask your large breasted security guard to play with you more privately, and she seductively removes most of her swimsuit and lies back waiting for you.</p>");
			startQuestions();
			addLinkToPlaceC(md, "later...say goodbye to Debra", Place);
			WritePlaceFooter(md);
			return true
		}
		if (Place == 87) {
			if (sType === "parkwalkies") {
				WaitHereOnly(3);
				md = WritePlaceHeader(false, isExplicit() ? "td-left-med" : "");
				this.showPersonRorX("debra10c.jpg");
				addPlaceTitle(md, "Taking Your Pet To Play In the Park");
				md.write("<p>You tell your loyal little pet that you will go back to the park to have a run and play. You both walk back to the park, she follows contentedly behind you, completely naked except her her shoes.</p>" + "<p>You pass a few people who look shocked, at both her nudity and her clear submission to you.</p>" +
					"<p>At the park Debra plays around, happy to have your complete attention and to be out at the Park again.</p>");
				if (isExplicit()) md.write("<p>After a little she gives you a nice little show of how she likes to play, using a dildo to play with her hot pussy!</p>");
				startQuestions();
				addQuestionCO(md, "leave your puppy to play here in the park", "DebraKelly", 7E3);
				addLinkToPlace(md, "return to the Kelly's home", 112);
				WritePlaceFooter(md);
				return true
			}
		} else if (Place == 107)
			if (sType === "walkies") {
				md = WritePlaceHeader();
				this.setFlag(2);
				this.showPersonRandom("debra10", 2);
				addPlaceTitle(md, "Taking Your Pet, " + this.getPersonName() + " for a Walk");
				md.write("<p>You tell your loyal little pet that it is time to walk her like a good little puppy. You both walk for a while around the area, she follows contentedly behind you, completely naked except her her shoes.</p><p>You pass a few people who look shocked, at both her nudity and her clear submission to you.</p>");
				startQuestions("Where will you walk to:");
				addLinkToPlace(md,
					"walk her back to the path where you met her", 87);
				WritePlaceFooter(md);
				return true
			} else {
				if (sType === "home") {
					md = WritePlaceHeader();
					this.place = 112;
					this.showPersonRandom("debra10", 2);
					addPlaceTitle(md, "Taking Your Pet, " + this.getPersonName() + " home");
					md.write("<p>You tell your loyal little pet that it is time to go back home, she looks excited at the idea of returning to her house. She happily follows you as you leave the park, still completely naked except her shoes, but she does pick her her clothing the bring back with her, the thought of wearing them does not seen to cross her mind.</p>" +
						"<p>You arrive with her to her house on Kollam Street and she eagerly runs into the house ahead of you...</p>");
					startQuestions("Where will you walk to:");
					addLinkToPlace(md, "follow her inside", 112);
					addLinkToPlace(md, "leave her for now", 44);
					WritePlaceFooter(md);
					return true
				}
			}
		else if (Place == 112)
			if (sType === "walkies") {
				md = WritePlaceHeader();
				this.setFlag(2);
				this.showPersonRandom("debra10", 2);
				addPlaceTitle(md, "Taking Your Pet, " + this.getPersonName() + " for a Walk");
				md.write("<p>You tell your loyal little pet that it is time to walk her like a good little puppy. You both walk for a while around the area, she follows contentedly behind you, completely naked except her her shoes.</p><p>You pass a few people who look shocked, at both her nudity and her clear submission to you.</p>");
				startQuestions("Where will you walk to:");
				addLinkToPlace(md, "return to the Kelly's home", 112);
				WritePlaceFooter(md);
				return true
			} else if (sType == "incest") {
			md = WritePlaceHeader(false, isExplicit() ? "td-left-large" : "");
			var perJ = findPerson("JanetKelly");
			perJ.showPersonRorX("janet11.jpg");
			addPlaceTitle(md, "Sisterly Affections");
			var clvJ = perJ.getCharmedLevel();
			var hJ = "";
			if (clvJ == 2) hJ = "your lover ";
			else if (clvJ == 3) hJ = "your bimbo ";
			else if (clvJ == 4) hJ = "your slave ";
			else if (clvJ == 5) hJ = "your pet ";
			if (this.getCharmedLevel() ==
				2) {
				md.write("<p>You ask " + hJ + "Janet and " + this.getPersonName() + " to put on a show for you, and kiss each other. You smile, and ");
				if (clvJ != 2) md.write(hJ + "Janet is perfectly happy to!. Debra looks at you reluctantly, until Janet tells her,</p>" + "<p>\"You know, you are totally hot, let's put on a show for " + perYou.getPersonName() + '!"</p>' + "<p>This seems to convince Debra and they kiss, every so often looking over at you, but their passion quickly builds, and they concentrate in each other more and more. A little later they are licking each other to mutual orgasms, while calling out for you!</p>");
				else md.write("they both look reluctant, and you remind them it is just a little show for you, a game. Janet looks at Debra and tells her,</p>" + "<p>\"Why not, you know we have practised together before. Let's put on a show for " + perYou.getPersonName() + '!"</p>' + "<p>The seems to decide Debra and they kiss, every so often looking over at you, but their passion quickly builds, and they concentrate in each other more and more. A little later they are licking each other to mutual orgasms, while calling out for you! You wonder how much they have 'practised' in the past.</p>")
			} else {
				md.write("<p>You ask " +
					hJ + "Janet to play with her sister. At this Debra looks brightly at you and Janet, playing the part of a good puppy ");
				if (clvJ != 2) md.write("and " + hJ + "Janet is perfectly happy to!. Initially they just actually play, and wrestle a little, but quickly their lips meet, and play turns to passionate kisses. As you watch them enthusiastically lick each other to mutual orgasms, you wonder if they have some history of mutual exploration.</p>");
				else md.write("and " + hJ + 'Janet looks a bit embarrassed, blushing but it does not stop her from patting Debra on her head, and telling her, "Good girl!". With Janet clearly in charge, they just actually play, and wrestle a little, but quickly their lips meet, and play turns to passionate kisses. As you watch them enthusiastically lick each other to mutual orgasms, you wonder if they have some history of mutual exploration.</p>')
			}
			startQuestions();
			addLinkToPlace(md, "return to the Kelly's home", 112);
			WritePlaceFooter(md);
			return true
		} else if (sType == "debrafuck") {
			md = WritePlaceHeader(false, isDay() && this.getCharmedLevel() == 2 ? "td-left-large" : "");
			this.setFlag(2);
			this.showPersonRandomDN(this.getCharmedLevel() == 2 ? "debra12l" : "debra12d", 2, this.getCharmedLevel() == 2 ? "" : "30vw,50vw");
			if (this.getCharmedLevel() == 2) {
				addPlaceTitle(md, isDay() ? "Join " + this.getPersonName() + " in the Garden" : "Join " + this.getPersonName() + " in the TV Room");
				if (isDay()) md.write('<p>You join Debra in the garden, and she looks at you expectantly and quietly undoes her clothing and whispers "Janet is just inside". You are not sure if this is a warning to be quiet or an expression of voyeuristic arousal.</p>');
				else md.write('<p>You join Debra in the TV Room, and she looks at you expectantly and quietly undoes her nightie and whispers "Janet is just outside". You are not sure if this is a warning to be quiet or an expression of voyeuristic arousal.</p>');
				if (perYou.isMaleSex()) md.write("You embrace your lover and make love to her until you cum into her orgasming body.</p>");
				else md.write("You embrace your lover and make love to her until your mutual orgasms.</p>")
			} else {
				addPlaceTitle(md, "Taking Your Pet, " +
					this.getPersonName());
				md.write("<p>You tell your loyal little pet that it is time breed her like the good little bitch she is. ");
				if (perYou.isMaleSex()) md.write("You mount her and fuck her hard until you cum into your hot little bitch.</p>");
				else md.write("You put on your strap-on and mount her. You fuck her hard until you both orgasm loudly.</p>")
			}
			startQuestions();
			addLinkToPlace(md, "return to the Kelly's home", 112);
			WritePlaceFooter(md);
			return true
		}
		return false
	};
	per.showPersonChat = function(bGeneral,
		md) {
		if (sType !== "" || !this.isHere() || Place != 87) return;
		if (!isPlaceKnown("KellyHouse")) addQuestionC(md, "tell her you live on Kollam St too", "DebraKelly", 4E3);
		else if (!this.checkFlag(7) && !this.isCharmedBy()) addPopupLinkC(md, "chat with Debra", "Chatting with Debra", "<img src='Images/debra1c.jpg' class='imgpopup' alt='Debra'>" + "You talk to Debra for a while about little that matters, of Glenvale and about her, really just getting to know her a little better.</p> " + "<p>While you talk you notice she has a habit of tugging on the hem of her dress, enphasising how short it is and to a lesser degree her figure and cleavage. You are unsure if the is a deliberate ploy or just some old habit.</p>" +
			"<p>She does seem to know Glenvale quite well as she deftly and politely refuses your offer of a tour, or at least a walk around town. She does seem pleased with the offer but mentions something vague about things she has to do.</p>" + '<p>She changes the topic a points out a person walking a pair of dogs and she comments "Nice puppies". A crude or is it flirtaceous...no crude...thought crosses your mind about saying how her puppies are nicer...but you refrain from saying it.', true, "setPersonFlag('DebraKelly',7);WaitHere();");
		if (perDavy.other === 6) addQuestionC(md, "ask " + this.getPersonName() + " if she has seen Davy Robbins", "DebraKelly", 6006);
		if (this.isCharmedBy()) {
			if (!this.checkFlag(3)) addQuestionC(md, '"fetch magic artifacts ' + this.getPersonName() + '"', "DebraKelly", 6501);
			addLinkToPlace(md, "tell " + this.getPersonName() + " she has been a GOOD GIRL", 107)
		} else if (checkPersonFlag("JanetKelly", 1) && !this.checkFlag(6)) {
			startAlternatives(md, "You are undecided what to tell Debra...");
			addPopupLinkC(md, '"I met your sister, she needs help unpacking"',
				"Debra returning home", "<img src='Images/debra1b.jpg' style='width:40%;float:right;margin-left:5px' alt='Debra'>" + 'Debra frowns a little, "I suppose I have been avoiding it a little, ok, enough then for this walk. Why not visit sometime to help us?"' + "<br><br>With that she starts to leave, though she briefly hesitates as she gets her dress caught on a bush. She re-adjusts her dress and you see a lovely glimpse of her thigh.", true, "setPersonFlag('DebraKelly', 6);movePerson('DebraKelly',112);dispPlace();");
			addTextForQuestions(md, "then again as you notice a man walking his dog nearby...", "center");
			addLinkToPlaceC(md, '"It is a lovely day here in the park!"', 87, "", "&quot;Yes it is, I think I will walk around for a bit more&quot; You also mention the dog-walker and how you like dogs, she smiles and agrees.", "Debra", "setPersonFlag('DebraKelly', 6);");
			endAlternatives(md)
		}
	};
	per.isPhoneable = function() {
		return checkPlaceFlag("Hotel", 11) && Place == 269 && this.isCharmedBy()
	};
	per.callThem = function() {
		if (Place == 269) {
			gotoPlace(Place,
				"type=debrapool");
			receiveCall("", 'You call Debra to invite her to join you at the pool for a swim, and she answers enthusiasticaly, "Yes please!" and hangs up. You take that to mean she will be there soon.');
			WriteCommentsFooter(bChat, bChatLeft)
		}
	}
}

function RepliesDAWhite(nR) {
	var perDA = per;
	var bCharm = perDA.isCharmedBy();
	var myName = perDA.getYourNameFor();
	var bCharmBatton = isCharmedBy("OfficerBatton");
	var plcBatton = wherePerson("OfficerBatton");
	bChatLeft = plcBatton != 168;
	if (nR == 5701) {
		perDA.other = 2;
		addComments('<p>"I\'m glad to hear that you want to help," says the ' + getProsecutor() + '.</p><p>"We have evidence that you have been involved in criminal activity.');
		if (perYou.getArrested() == 3)
			if (wherePerson("MrsGranger") == 177) addComments(' The security guard at the museum gave a statement that you tried to attack her.  What do you have to say to this?"</p>');
			else addComments(' The security guard at the museum gave a statement that you ordered Mrs. Granger to attack her.  What do you have to say to this?"</p>');
		else addComments(' We found property, a book, on you that we have been led to believe was stolen from the Gates Estate. Can you explain how you obtained that property?"</p>')
	} else if (nR == 5702) {
		perDA.other = 10;
		if (perYou.getArrested() === 0)
			if ((whereItem(4) === 999 || whereItem(4) === 76) && isBeasleyServant())
				if (isMurderPath()) perYou.setArrested(2);
				else perYou.setArrested(1);
		else perYou.setArrested(3);
		addComments('<p>"Trying to run away, are we? I don\'t think so," says the DA, motioning for ' + getPoliceChief() + ' Batton to handcuff you.</p><p>"You are under arrest. You have the right to..."')
	} else if (nR == 5703) {
		if (perDA.other === 15 || perDA.other === 3) perDA.other += 1;
		if (!perYou.checkFlag(8)) perYou.setFlag(8);
		if (!bCharm) {
			addComments('"Oh, I spoke to Mr. Beasley, the school teacher and occult expert about the Book, even I have heard the rumours about it.</p><p>' + "I was about to return the Book to the evidence locker and he offered to take the book to ");
			if (isMurderPath()) addComments("Miss Gates at the Estate. ");
			else addComments(perGates.getPersonName() + ". ");
			addComments(' He pointed out that an artifact of that value must have been stolen in the first place. I agreed to give him the Book...what...why did I do that it is against proceedures..."' + ", the " + getProsecutor() + " says a little confused.");
			if (perDA.other > 10) addComments('</p><p>"Now please go, you have no business here."');
			if (perDA.other < 4) perDA.other = 4;
			if (whereItem(4) === 999) moveItem(4, 76);
			if (wherePerson("MrBeasley") !== 11) {
				movePerson("MrBeasley", 11);
				moveDavyToHotel1()
			}
		} else if (whereItem(4) == 76 || whereItem(4) == 999) {
			if (whereItem(4) == 999) moveItem(4, 76);
			addComments('"I spoke to Mr. Beasley, the school teacher and occult expert about the Book, even I have heard the rumours about it.</p><p>' + "I was about to return the Book to the evidence locker and he offered to take the book back to its original owner, " + myName + ".  Please forgive me, " + 'I agreed to give him the Book...what...why did I do that it is against proceedures...I never should have given away what was rightfully yours.",' +
				", the " + getProsecutor() + " says a little confused.");
			if (wherePerson("MrBeasley") !== 11) {
				movePerson("MrBeasley", 11);
				moveDavyToHotel1()
			}
		} else {
			moveItem(4, 168);
			addComments('"I kept it safe for you ' + perYou.getMaster() + '.  I knew you would come to get it and I did not want anyone else to have a chance of stealing it away from you," she says, smiling.  "Have I done well?"')
		}
	} else if (nR == 5704) {
		perDA.other = 15;
		DAReturnItems();
		perYou.setArrested(0);
		setPlaceKnown("Hospital");
		addComments(getProsecutor() + ' White glares at you. "I suppose it\'s just her word against yours since the only other witness, Mrs. Granger, is in ICU at the hospital."  She turns away from you dismissively.</p><p>"You\'re free to go, ' +
			perYou.getPersonName() + " but don't leave town. Collect your possessions on the way out.\"")
	} else if (nR == 5705) {
		perDA.other = 10;
		if (perYou.getArrested() === 0) perYou.setArrested(3);
		if (plcBatton === 168) addComments('<p>"A likely story," says the ' + getProsecutor() + ", motioning for " + getPoliceChief() + ' Batton to handcuff you. "You are under arrest. You have the right to..."');
		else addComments('<p>"A likely story," says the ' + getProsecutor() + ', moving to handcuff you. "You are under arrest. You have the right to..."');
		if (!bCharmBatton) Place = 260
	} else if (nR == 5710) {
		perDA.other = 10;
		if (perYou.getArrested() === 0)
			if ((whereItem(4) === 999 || whereItem(4) === 76) && isBeasleyServant())
				if (isMurderPath()) perYou.setArrested(2);
				else perYou.setArrested(1);
		else perYou.setArrested(3);
		if (plcBatton === 168) addComments('<p>"A likely story," says the ' + getProsecutor() + ", motioning for " + getPoliceChief() + ' Batton to handcuff you. "You are under arrest. You have the right to..."');
		else addComments('<p>"A likely story," says the ' + getProsecutor() +
			', moving to handcuff you. "You are under arrest. You have the right to..."');
		if (!bCharmBatton) Place = 260
	} else if (nR == 5711)
		if (!isMurderPath()) {
			addComments('"Let me verify that," says the ' + getProsecutor() + ". She calls " + perGates.getPersonNameShort() + ' on her phone. After a brief discussion she hangs up and turns to you. "Yes, ' + perGates.getPersonNameShort() + " says that it is true ");
			if (checkPersonFlag("MrsGranger", 4)) {
				perDA.other = 10;
				perYou.setArrested(3);
				addComments(' but there is still the matter of your attempt to steal the Dragon Vase from the museum and we have the guards testimony." She stands ');
				if (plcBatton === 168) addComments("motioning for " + getPoliceChief() + ' Batton to handcuff you. "You are under arrest. You have the right to..."');
				else addComments('moving to handcuff you. "You are under arrest. You have the right to..."')
			} else {
				addComments('. You may go without further questioning."');
				perDA.other = 15
			}
		} else {
			perDA.other = 10;
			if (perYou.getArrested() === 0)
				if (isMurderPath()) perYou.setArrested(2);
				else if (perYourBody.FindItem(4) === 0 && (whereItem(4) == 76 || whereItem(4) == 46)) perYou.setArrested(3);
			else perYou.setArrested(1);
			addComments('<p>"A likely story," says the ' + getProsecutor() + ", motioning for " + getPoliceChief() + ' Batton to handcuff you. "You are under arrest. You have the right to..."');
			if (!bCharmBatton) Place = 260
		}
	else if (nR == 5712) {
		bChat = false;
		addComments("You allow the " + getProsecutor() + " to escort you to the jail cell.");
		Place = 260
	} else if (nR == 5713) {
		bChat = false;
		addComments(getPoliceChief() + " Batton moves up, slaps cuffs on your wrists, and escorts you rather unceremoniously to the jail cell.");
		Place = 260
	} else if (nR ==
		5714) {
		bChat = false;
		addComments(getPoliceChief() + ' Batton moves up and puts cuffs loosely around your wrists.  "You have the right to remain silent, and any time you say I will hold you against me..." she whispers into your ear as you move towards the cells.');
		Place = 260
	} else if (nR == 5750);
	else if (nR == 6E3) {
		if (wherePerson("MrsGranger") == 261) {
			movePerson("MrsGranger", 177);
			addComments('"Of course ' + myName + ' she is free to go and all charges are dropped"')
		} else {
			addComments('"Of course ' + myName + ' all charges are dropped and the police guarding her is recalled"');
			if (isCharmedBy("OfficerKhan")) movePerson("OfficerKhan", 168);
			else movePerson("OfficerKhan", 999)
		}
		setPersonFlag("MrsGranger", 3, false)
	} else if (nR == 7E3) {
		perDA.other = 15;
		DAReturnItems();
		perYou.setArrested(0);
		addComments("Diane White apologises and returns your possessions to you")
	} else if (nR == 9002) {
		if (perYou.isShot()) {
			addComments('"I know that you do not have the book. It was taken from you after you were shot and taken to the hospital. That is why I am questioning you."');
			perYou.setInjury(3)
		} else addComments('"I know, we confiscated it from you when you were arrested for attempting to steal the vase from the museum."');
		perDA.other = 3
	}
	return true
}

function DAReturnItems() {
	var perDA = findPerson("Diane");
	perDA.DropAllItems("You")
}

function initialiseDianeWhite() {
	addPerson("Diane");
	per.extra = [0, 0, 0];
	per.Replies = RepliesDAWhite;
	per.getPersonName = function(full) {
		return full !== true && this.isCharmedBy() ? "Slave Diane" : getProsecutor() + " Diane White"
	};
	per.getPersonAddress = function() {
		return this.checkFlag(30) ? "Apartment 2, Haven Apartments" : ""
	};
	per.getQuestArrested = function() {
		return this.extra[2]
	};
	per.setQuestArrested = function(no) {
		this.extra[2] = no
	};
	per.whereNow = function() {
		if (this.place == -1 || !this.checkFlag(30)) return this.place;
		if (isNight()) return 467;
		return this.place
	};
	per.isPersonInfo = function() {
		return true
	};
	per.getPersonInfo = function() {
		if (this.isCharmedBy())
			if (isCharmedBy("Gina")) return "<img src='Images/" + this.getImg("diane9.jpg") + "' class='imgpopup' alt='Diane'>" + "The " + getProsecutor() + " sure has changed a lot since her becoming your pet. Gone are her fears and suspicions of you, instead she looks at you with sheer devotion and joy. Her knowledge of the law and order will come in handy in the fights you will face.<br><br>" + "She asked for a small room in the building so she can work privately without anyone to disturb her. She told you she wants to live here, close to you, so she\u2019s always in reach if you need her.";
			else return "<img src='Images/" + this.getImg("diane9.jpg") + "' class='imgpopup' alt='Diane'>" + "The " + getProsecutor() + " sure has changed a lot since her becoming your pet. Gone are her fears and suspicions of you, instead she looks at you with sheer devotion and joy. Her knowledge of the law and order will come in handy in the fights you will face.<br><br>" + "She asked for a small room in the building so she can work privately without anyone to disturb her. She told you she wants to live here, close to you, so she\u2019s always in reach if you need her. She mentioned that she\u2019s working on a case involving you. Gina, the museum guard filed a report against you, she wants to stop you from entering the museum area. Ms. White assured you that she will fix this little issue, but it can take some time\u2026";
		else return "<img src='Images/" + this.getImg("diane1.jpg") + "' style='width:40%;float:right;margin-left:5px' alt='Diane'>The " + getProsecutor() + " investigating you, a smug-looking cool blonde lawyer."
	};
	per.passTimeDay = function() {
		if (this.checkFlag(30)) this.setFlag(31);
		return ""
	};
	per.getPossessionFace = function() {
		if (!this.isCharmedBy()) return "diane8";
		return isOutside() ? "diane7-out" : "diane7-in"
	};
	per.isPlaceImageRight = function() {
		if (this.place == -1) {
			SetRightColumnSize("");
			return true
		}
		return false
	};
	per.showPlaceImageRight =
		function(md) {
			this.showPerson(isOutside() ? "diane7-out.jpg" : "diane7-in.jpg", undefined, undefined, undefined, undefined, undefined, md);
			if (sType !== "" && sType != "victoriascar") return;
			md.write('<div style="clear:both;">');
			addOptionLink(md, "talk to Diane", "gotoPlace(" + Place + ",'type=chatdiane" + (sType == "victoriascar" ? "&car=true" : "") + "')", "chatblock", "width:90%;max-width:90%;position:relative;top:-0.5em");
			md.write("</div>")
		};
	per.addPlaceImageLeft = function(lit) {
		if (Place == 467 && this.isHere() && sType === "") return this.showPerson("diane-home.jpg",
			"", "", "", "", false, "string");
		return ""
	};
	per.showEventPopup = function() {
		if (Place != 168) return false;
		if (getQueryParam("arrest") == "true") {
			if (this.isCharmedBy() || this.other == 900 && isCharmedBy("OfficerBatton")) {
				if (this.other == 900) showPopupWindow("Under Arrest, No You're Not!", "<img src='Images/Setting/polb6.jpg' style='width:35%;float:right' alt='Batton'>" + "Kerry Batton greets you are you are brought in to the Police Station,<br><br>" + '"Welcome ' + perYou.getMaster() + ' I see you have been getting into trouble again!"<br><br>' +
					"She gives orders that you are to be released and your arrest was a mistake.<br><br>" + '"Sorry ' + perYou.getMaster() + ", " + (wherePerson("MrsGranger") == 275.5 ? 'Mrs. Granger, is in ICU at the hospital."' : ' please enjoy your visit here, and me."'), "setPersonFlag('OfficerBatton',4);dispPlace()");
				else showPopupWindow("Under Arrest, No You're Not!", "<img src='Images/" + this.getImg("diane9.jpg") + "' style='width:35%;float:right' alt='DA'>" + getProsecutor() + " White greets you are you are brought in to the Police Station,<br><br>" +
					'"Welcome ' + perYou.getMaster() + ' I see you have been getting into trouble again!"<br><br>' + "She gives orders that you are to be released and your arrest was a mistake.<br><br>" + '"Sorry ' + perYou.getMaster() + ", " + (wherePerson("MrsGranger") == 275.5 ? 'Mrs. Granger, is in ICU at the hospital."' : ' please enjoy your visit here, and me."'), "setPersonFlag('OfficerBatton',4);dispPlace()");
				DAReturnItems();
				perYou.setArrested(0);
				setPlaceKnown("Hospital");
				return true
			}
			return false
		}
		if (sType == "daappears") {
			this.other =
				31;
			this.place = 168;
			showPopupWindow(getProsecutor() + " White", "<img src='Images/" + this.getImg("diane0.jpg") + "' class='imgpopup' alt='Diane'>" + getPoliceChief() + " Batton looks behind you as you give the order, and you hear a voice behind you. You turn and see a smug looking blond-haired woman,<br><br>" + '"Well I thought I was the ' + getProsecutor() + ' here, and I thought I knew all the people in the police force here. Why are you ordering my Officer here around?"<br><br>' + "You recognise her, Ms. Diane White the " +
				getProsecutor() + ", she lives in a bigger city not far away from here, but this town is still under her supervision, that means every homicide case in the area comes directly to her. She seems suspicious of you, maybe you can alter her attitude towards you and show her a new world\u2026the world of servitude.<br><br>" + "You apologise, explaining it was bad phrasing, and that you were requesting the removal of the " + getOfficer() + " so you can visit a friend at the Mansion.<br><br>" + "While you doubt she believes a word of what you said, she dismisses you, with terse words about police procedures and it is none of your business.");
			return false
		}
		if (sType == "daappears2") {
			this.other = 31;
			this.place = 168;
			showPopupWindow(getProsecutor() + " White", "<img src='Images/" + this.getImg("diane0.jpg") + "' class='imgpopup' alt='Diane'>" + getPoliceChief() + " Batton looks behind you as you give the order, and you hear a voice behind you. You turn and see a smug looking blond-haired woman,<br><br>" + '"Well I thought I was the ' + getProsecutor() + ' here, and I thought I knew all the people in the police force here. Why are you ordering my Officer here around?"<br><br>' +
				"You recognise her, Ms. Diane White the " + getProsecutor() + ", she lives in a bigger city not far away from here, but this town is still under her supervision, that means every homicide case in the area comes directly to her. She seems suspicious of you, maybe you can alter her attitude towards you and show her a new world\u2026the world of servitude.<br><br>" + "You apologise, explaining you were just joking around with Kerry.<br><br>" + "While you doubt she believes a word of what you said, she dismisses you, with terse words about how this is a police station not a <i>high-school</i> playground.");
			return false
		}
		if (sType !== "") return false;
		if (this.isCharmedBy() && this.checkFlag(1) && !this.checkFlag(2)) {
			showPopupWindow("Diane White", "<img src='Images/" + this.getImg("diane9.jpg") + "' class='imgpopup' alt='Batton'>" + '"Talk to me, who are you? I haven\u2019t seen you around here before\u2026", you ask your ever loving lawyer.<br><br>' + '"My boss and friend offered me the case about you. She told me it was an easy case and it would gain me fame and reputation quickly.", Ms. White tells you and she stops working on her paperwork and seductively runs her finger through her hair.<br><br>' +
				'"Who\u2019s this boss of yours?", you ask while you instruct her to lift her skirt and show you her panty.<br><br>' + '"She\u2019s Helena Stone, ' + perYou.getMaster() + '. She\u2019s well known and recognised in our community because she had some famous cases involving celebrities. The thing is; she always won no matter what side she was on, so in a few years she became a household name.", she smiles while she\u2019s giving you a clear show of her panty and pussy. Her skirt is no longer on her.<br><br>' +
				'"Yeah, I\u2019ve heard about her on the news. How did you become her assistant attorney?", you clap her for the show she put on for you and laughly ask.<br><br>' + '"It was simple, ' + perYou.getMaster() + ". She was looking for help and I was looking for a job. We became close friends and she says she doesn\u2019t want to get rid of me because of the dedication she sees in me, " + perYou.getMaster() + '.", your lawyer slave answers you, putting back the skirt and fixing her dress as you have ordered.<br><br>' +
				'"Hmm\u2026 could she be a problem? Won\u2019t it be suspicious to her that you don\u2019t want to return and want to live here?", you speculate.<br><br>' + '"Don\u2019t worry for even a second, my ' + perYou.getMaster() + '! I will call her up and have a long chat with her. I\u2019m going to cook up a great story to distract her!", Ms. White answers, her face is full of eagerness and passion to you .<br><br>' + "You wave your hand to continue her work, but you don\u2019t feel all that relieved. You should return and ask her again about this problem later.",
				"setPersonFlag('Diane',2)");
			return true
		}
		if (this.other == 30) {
			this.other = 31;
			this.place = 168;
			showPopupWindow(getProsecutor() + " White", "<img src='Images/" + this.getImg("diane0.jpg") + "' class='imgpopup' alt='Diane'>" + "You see a tall blond haired woman talking to " + getPoliceChief() + " Batton, you recognise her as Ms. Diane White the " + getProsecutor() + ", she lives in a bigger city not far away from here, but this town is still under her supervision, that means every homicide case in the area comes directly to her. She seems suspicious of you, maybe you can alter her attitude towards you and show her a new world\u2026the world of servitude.<br><br>");
			return true
		}
		return false
	};
	per.showEvent = function() {
		var md;
		if (Place == 269 && sType == "dianepool") {
			WaitHereOnly(6);
			md = WritePlaceHeader();
			this.showPerson("diane-pool.jpg");
			addPlaceTitle(md, "Swimming with Diane");
			md.write("<p>Diane arrives and changes into a brightly coloured bikini and lays a towel and kneels while waiting for you to join her. She asks you,</p>" + '<p>"It is late and few are here, we could do more than just swim?"</p>');
			startQuestions();
			addLinkToPlaceC(md, "well it is fairly private here",
				Place, "type=dianepoolsex");
			addLinkToPlaceC(md, "say goodbye to Diane", Place);
			WritePlaceFooter(md);
			return true
		}
		if (Place == 269 && sType == "dianepoolsex") {
			md = WritePlaceHeader(false, "td-left-large");
			this.showPerson("diane-pool-sex.jpg");
			addPlaceTitle(md, "More Than Swimming With Diane");
			md.write("<p>You accept Diane's invitation to play here near the pool, just not in the water!</p>" + "<p>Later you do go for a swim with her, for a break as such.</p>");
			startQuestions();
			addLinkToPlaceC(md, "say goodbye to Diane",
				Place);
			WritePlaceFooter(md);
			return true
		}
		if (Place == 168 && sType == "askaboutgina") {
			md = WritePlaceHeader();
			this.setFlag(17);
			this.moveThem(-1);
			this.extra[1] = 0;
			this.showPerson("diane5.jpg");
			addPlaceTitle(md, "Ginas Case");
			md.write('<p>You ask, "Diane, how\u2019s those charges against me holding up?"</p>' + '<p>Diane replies "Not well, ' + perYou.getMaster() + "! I\u2019m trying my best here, to somehow smother it, but Gina seems relentless about it! That stupid woman thinks she can mess with you! Don\u2019t worry, " +
				perYou.getMaster() + '. I\u2019m still working on it and I will find a sollution."</p>' + '<p>You ask, "You don\u2019t need to\u2026I have paid Gina a visit and let\u2019s just say that I have reasoned with her and she decided to give in to my powers."</p>' + '<p>Diane replies "Wonderful, ' + perYou.getMaster() + '! That\u2019s why you\u2019re our leader after all. You solve every problem so quickly. So that bitch finally understands that you are the power around here!- the blonde bombshell beams at you with a proud look."</p>' +
				'<p>You ask, "That means I don\u2019t have to worry about that anymore, right?"</p>' + '<p>Diane replies "Not quite, ' + perYou.getLord(false) + "! She could have already sent the required papers to the police or someone else before you brainwashed her! You did not her ask about that, right " + perYou.getLord(false) + '?"</p>' + '<p>From the worried look on your face and your headshake she understands and continues."</p>' + '<p>Diane replies "You have to talk to her. Ask her\u2026and maybe punish her for her arrogance! You must act quickly ' +
				perYou.getMaster() + '! If this blows wide open you are going to be in trouble and I won\u2019t allow that! I\u2019m going to fight for you till my last breath, but it would be convenient if we could prevent it!"</p>' + '<p>You ask, "Okay, I\u2019m going to pay Gina a visit right now.- you notice Diane\u2019s odd smirk and strange mimicry as if she is expecting something."</p>' + '<p>Diane replies "' + perYou.getMaster() + "! Please, take me with you. I could be useful to you! I will be your silent servant who watches your back and aid you, just what a servant does. Follows her " +
				perYou.getMaster() + ' to the end of the world. Please, I need to be around! I can\u2019t help it!"</p>' + '<p>You ask, "All right, tag along! Just for now! And we have to be very discreet, I don\u2019t want to attract anymore unnecessary attention. Let\u2019s go!</p>');
			startQuestions();
			addLinkToPlace(md, "let's go", 167);
			WritePlaceFooter(md);
			return true
		}
		if (Place == 467 && this.isHere())
			if (sType == "fuck") {
				md = WritePlaceHeader(false, isExplicit() && !perYou.isMaleSex() ? "" : "td-left-large");
				if (perYou.isMaleSex()) {
					if (isExplicit()) this.showPersonRandomX("diane-home-sex-b",
						2);
					else this.showPerson("diane-home-sex-b.jpg");
					addPlaceTitle(md, "Diane's Advice");
					md.write("<p>You fully enjoy the body of Diane</p>")
				} else {
					this.showPersonRorX("diane-home-sex-g.jpg");
					addPlaceTitle(md, "Diane's Advice");
					md.write("<p>You fully enjoy the body of Diane</p>")
				}
				startQuestions();
				addLinkToPlaceC(md, "talk more with Diane", Place);
				addLinkToPlace(md, "exit the apartment", 466);
				WritePlaceFooter(md);
				return true
			}
		if (this.place != -1) return false;
		var perGina = findPerson("Gina");
		var perVictoria = findPerson("Victoria");
		if (sType == "victoriascar") {
			md = WritePlaceHeader();
			perVictoria.showPerson("victoria_inside_car_beforesexscene.jpg");
			addPlaceTitle(md, "Victoria's Car");
			md.write("<p>The car is a comfortable looking, simple, yet elegant black BMW. The three of you have easily enough space to yourselves without feeling claustrophobic.</p>" + '<p>"At last! I could use a rest! All this for a little paper that shouldn\u2019t have to exist in the first place!", you say to your slaves as you drive through the town. Victoria, who silently watched over you the whole time, opens her mouth to ask something. She\u2019s your personal secretary and closest slave, so you left her with a bit a free will, you know she uses that to serve you even better. That\u2019s why she can ask questions anytime to you.</p>' +
				'<p>Victoria replies, "Ohh, ' + perYou.getMaster() + '! You look so tired! You definitely need a good sleep! I will take care of you. What\u2019s this all about?" she politely asks, the look of sympathy and compassion on her face tells that she worried a lot while driving to you.</p>' + '<p>"Long story short, Gina, a security guard at the museum reported me for stealing an old artefact. She sent the compromising files to the media headquarters and I\u2026 had to retrieve myself\u2026", you glance over to Diane who cast down her eyes to car\u2019s floor in embarrassement.</p>' +
				'<p>You continue, "But at least Diane proved to be useful, she helped me out a lot." you add and you can see the hope coming back to Diane\u2019s eyes. Without a word, she tenderly caresses your back and puts her head to back of your seat. She seems sentimental and emotional for a moment. You let her rest.</p>' + '<p>"So, when can I greet this Gina into our fold?" Victoria wickedly smiles. She knows you have already charmed Gina, she doesn\u2019t rob your time to ask silly questions like that. How thoughtful of her!</p>' +
				'<p>You answer, "Soon, I guess. First, we have finish this what we started!"  Victoria thinks for a second and asks.</p>');
			startQuestionsOnly();
			addLinkToPlaceC(md, '"How about a little fun for the end of the day?"', 194, "type=victoriascarsex1");
			WritePlaceFooter(md);
			return true
		}
		if (sType.indexOf("victoriascarsex") != -1) {
			var id = sType.substr(15);
			md = WritePlaceHeader(false, perYou.isMaleSex() && id != "5" || id == "4" ? "td-left-large" : "");
			if (perYou.isMaleSex())
				if (id == "1" || id == "3") perVictoria.showPerson("victoria_male" +
					id + ".jpg");
				else if (isExplicit()) perVictoria.showPersonX("victoria_male" + id + ".jpg");
			else if (id == "2") perVictoria.showPerson("victoria_male1.jpg");
			else perVictoria.showPerson("victoria_male3.jpg");
			else perVictoria.showPerson("victoria_female" + id + ".jpg");
			addPlaceTitle(md, "Sex in Victoria's Car");
			if (perYou.isMaleSex()) switch (id) {
				case "1":
					md.write('<p>Victoria asks "How about a little fun for the end of the day? ' + perVictoria.getPersonName() + '! I know what you need right now!". Victoria bends over and starts to unbutton your jeans.</p>' +
						'<p>"Humph\u2026you read my mind Victoria!", you ease yourself, open the up the safety belt and let yourself into Victoria\u2019s capable hands!</p>' + '<p>Victoria says, "That\u2019s why I\u2019m your personal servant after all\u2026", she sexily grins and tapes her mouth around your already erect penis. She is as gentle as an angel. She carefully adjust her body to not disturb you while you drive.</p>');
					startQuestionsOnly();
					addLinkToPlaceC(md, '"Hmh\u2026Diane\u2026whatcha doing back there?!"', 194,
						"type=victoriascarsex2");
					break;
				case "2":
					md.write("<p>You ask Diane without turning your head.</p>" + '<p>Diane answers, "I watch and learn, ' + perYou.getMaster() + '. I\u2019m learning from Victoria on how to be a better slave for you!". Diane watched the whole show without interfering. You think she only needs a paper and a pen and she would even draw the postures to herself to later memorize them for you. That\u2019s more than passion!</p>');
					startQuestionsOnly();
					addLinkToPlaceC(md, '"All\u2026right\u2026! We are here\u2026!"',
						194, "type=victoriascarsex3");
					break;
				case "3":
					md.write("<p>You can\u2019t hold yourself anymore. You quickly find a place at the parking lot and finish your encounter with Victoria. You pull Victoria up and let her ride you.</p>" + '<p>Victoria says, "I\u2019ve read some books about how to satisfy a men. Look!" Victoria doesn\u2019t stop and takes you to the top, the two of you kiss. You let her off of your penis and fuck her on car\u2019s seat. The elegant dress she was wearing is no longer visible, she pulled it down to her legs. Victoria starts to moan like a baby cat.</p>');
					startQuestionsOnly();
					addLinkToPlaceC(md, '"I can see that! Diane, go see to that we are not disturbed!"', 194, "type=victoriascarsex4");
					break;
				case "4":
					md.write("<p>You bark over to Diane, who was still in the car. She jumps out of the car and starts to patrol around the car casually. A normal person would think she\u2019s waiting for someone.</p>" + '<p>Diane says, "Take your time, ' + perYou.getMaster() + '! Let yourself loose!" she encourages you from the other side of the car.</p>');
					startQuestionsOnly();
					addLinkToPlaceC(md, '"That\u2019s it! I can\u2019t take it anymore!"', 194, "type=victoriascarsex5");
					break;
				case "5":
					md.write("<p>You put Victoria to her knees and let your load onto her face. She smiles and swallows evertyhing she can!</p>" + '<p>"Did I do good? Tell me what to change next, anything!" she eagerly plays with a bit of drool left in her hair and starts to pull her dress up.</p>');
					startQuestionsOnly();
					addLinkToPlaceC(md, "You finish up", 348, "type=afterquest1", "<p>You hop out of the car and tell Victoria to show you the way to her place. You and Diane follow her, until the three of you are in her home at last. Victoria immediately pulls your hand and drags you into the bedroom, where she frees you from your clothes and puts you into bed. She even tugs you in. It all happens so fast, you can\u2019t even react to it. You find yourself in your slaves\u2019s oddly comfortable bed in a minute.</p>" +
						'<p>"I will take care of everything ' + perYou.getPersonName() + "! You just rest now. Diane and I will sort out the files and we are going to find the one you need! You need to sleep, you\u2019ve been through a lot lately.</p>" + '<p>"Gee, okay Mom\u2026" you laugh at the bit absurd situation you are in.</p>' + '<p>"He even has time for jokes\u2026I can\u2019t believe it\u2026 I have the best ' + perYou.getMaster() + ' in the world!" she dreamily says, like some kind of a fangirl.</p>' + "<p>Victoria closes the door and you sleep in a few moments later. You really were that tired!</p>",
						"", "if (isDay()) { passTimeNight(); };passTimeDay(8);");
					break
			} else switch (id) {
				case "1":
					md.write('<p>Victoria asks "How about a little fun for the end of the day? ' + perVictoria.getPersonName() + '! I know what you need right now!". and within a single second, Victoria is already vigorously masturbating next to you.</p>' + '<p>"Darling\u2026what you are doing\u2026turns me on so much!", you can\u2019t take your eyes off her. Your beautiful slave puts up a lust-filled show for you. Right next to you!</p>' +
						'<p>"I know Mistress! Just enjoy it! This is what I live for\u2026to please you!", she pulls up her black, silk dress revealing to you that she doesn\u2019t wear panties. You just understand now how that dress fits her so well.</p>');
					startQuestionsOnly();
					addLinkToPlaceC(md, '"What\u2019s with this dress? Why are so elegant?"', 194, "type=victoriascarsex2");
					break;
				case "2":
					md.write('<p>"What\u2019s with this dress? Why are so elegant?" you ask, gathering all your willpower to focus on the road, while often glancing at Victoria.</p>' +
						'<p>Victoria answers "Ohh\u2026 I\u2019m\u2026I\u2019m always\u2026this elegant\u2026needs\u2026.to\u2026be for you, Mistress! I\u2019m your\u2026closest slave\u2026after all\u2026I\u2026need to be\u2026 pretty for you anytime\u2026" she spits out the words, struggling to maintain herself, she touches your crotch with her other hand.</p>');
					startQuestionsOnly();
					addLinkToPlaceC(md, '"Turn over, show me that round ass of yours! "', 194, "type=victoriascarsex3");
					break;
				case "3":
					md.write("<p>You order Victoria and she does as you have told so. Her legs are now in your lap, you can hardly control the wheel anymore.</p>" +
						'<p>"Hmphm\u2026yesss\u2026- she teases you more. Luckily, for the safety of you and your slaves, you arrive to your destination. You find a good spot to park the car and turn your attention to your slaves.</p>');
					startQuestionsOnly();
					addLinkToPlaceC(md, '"That was\u2026intense! Intense and dangerous. We could have crashed!"', 194, "type=victoriascarsex4");
					break;
				case "4":
					md.write("<p>You tell them a bit, while recover yourself from the experience.</p>" + "<p>Victoria: Don\u2019t worry " + perYou.getPersonName() +
						'! Diane was watching over us, am I right?" Victoria winks at Diane, who hasn\u2019t said a word on the way.</p>' + '<p>Diane answers, "That\u2019s right, Mistress! Victoria and I shared a glance when she started her act to you! No harm would have come to you as I was looking to the road and would have grabbed the wheel from you in any risky case.". Diane answers truthfully. They both reassure you that you were safe the whole time. Victoria pulls you even closer, looks into your eyes and gives you a mouthfull kiss.</p>');
					startQuestionsOnly();
					addLinkToPlaceC(md, '"It was a wild ride then! Let\u2019s go, we\u2019ve got things to do!"', 348, "type=afterquest1", "<p>You hop out of the car and tell Victoria to show you the way to her place. You and Diane follow her, until the three of you are in her home at last. Victoria immediately pulls your hand and drags you into the bedroom, where she frees you from your clothes and puts you into bed. She even tugs you in. It all happens so fast, you can\u2019t even react to it. You find yourself in your slaves\u2019s oddly comfortable bed in a minute.</p>" +
						'<p>"I will take care of everything ' + perYou.getPersonName() + "! You just rest now. Diane and I will sort out the files and we are going to find the one you need! You need to sleep, you\u2019ve been through a lot lately.</p>" + '<p>"Gee, okay Mom\u2026" you laugh at the bit absurd situation you are in.</p>' + '<p>"He even has time for jokes\u2026I can\u2019t believe it\u2026 I have the best ' + perYou.getMaster() + ' in the world!" she dreamily says, like some kind of a fangirl.</p>' + "<p>Victoria closes the door and you sleep in a few moments later. You really were that tired!</p>",
						"", "if (isDay()) { passTimeNight(); };passTimeDay(8);");
					break
			}
			WritePlaceFooter(md);
			return true
		}
		if (sType.indexOf("afterquest") != -1) {
			setPlaceKnown("DianesApartment");
			var ida = sType.substr(10);
			md = WritePlaceHeader(false, ida == "1" || ida == "3" || ida == "6" || ida == "7" ? "td-left-med" : "");
			this.showPerson("diane_victorias_home" + ida + ".jpg");
			addPlaceTitle(md, "Diane in Victorias Home");
			switch (ida) {
				case "1":
					md.write("<p>Victoria\u2019s home is a fancy and cozy apartment in the same time. It\u2019s not too big, but it\u2019s more than enough for one person. It\u2019s a place of elegancy and style, with lots and lots of contemporary paintings and furniture. There\u2019s only one bedroom, a living room, another single room and a medium-sized balcony, but they\u2019re all designed perfectly.</p>" +
						"<p>After you wake up, you only find Diane in the living room, she looks tired. There\u2019s documents scattered around the sofa she\u2019s sitting in, she\u2019s holding one in hand. Victoria is nowhere to be seen.</p>" + '<p>"Heyy Diane! Where\u2019s Victoria?"</p>' + '<p>Diane answers "Good Morning sleepy-head! Ohh\u2026I\u2019m sorry, I didn\u2019t want to call you sleepy-head, forgive me\u2026you are the perfect ' + perYou.getManWoman() + " in the world! Victoria is at the Antique " + getShopStore(true) +
						', attending to customers. She left me here to look after you.". Diane looks amazing, even when she\u2019s exhausted from staying all night and working. She looks around nervously, bowing her to you in shame.</p>' + '<p>"Come on, you are now a bit too submissive\u2026 You don\u2019t have to be, you\u2019ve earned that yesterday, you\u2019ve done well. And where\u2019s all the naughtiness in you, I liked it when you\u2019ve sent me all those slutty SMS\'s."</p>' + '<p>Diane exclaims "' + perYou.getMaster() +
						'! It\u2019s complicated\u2026it\u2019s different when I\u2019m around you, as if the arua around you commands me to behave like any other slaves."</p>');
					startQuestions();
					addLinkToPlaceC(md, "\"I\u2019m ordering you then, to behave like yourself and not like 'any other servant'\"", 348, "type=afterquest2");
					break;
				case "2":
					md.write('<p>You then ask "Now, what about those papers?"</p>' + '<p>Diane answers, "I\u2019m holding the ones in my hand, ' + perYou.getMaster() + '. Gina wrote some nasty things about you\u2026 Here they are!". Diane hands you the documents.</p>' +
						'<p>You ask "I don\u2019t want to read them. I don\u2019t care\u2026destroy them. I charge you to destroy them and be careful about it!</p>' + '<p>Diane answers "As you wish, ' + perYou.getPersonName() + '! I\u2019m going to collect my things and return to police station\u2026"</p>');
					startQuestions();
					addLinkToPlaceC(md, '"No-no\u2026Let\u2019s celebrate first, if you know what I mean!"', 348, "type=afterquest3");
					break;
				case "3":
					md.write('<p>"Ohh, yes! I\u2019ve been waiting for you saying that!" Diane answers your order with confidence. She stands up and goes to window.</p>' +
						'<p>Diane continues "I don\u2019t like it when others are watching. This body is only yours to watch and enjoy!" she rolls up the shutters on the window.</p>');
					startQuestions();
					addLinkToPlaceC(md, '"I can\u2019t believe my eyes! That\u2019s roundest ass I\u2019ve ever seen!"', 348, "type=afterquest4");
					break;
				case "4":
					md.write('<p>Diane replies, "Well! I do work out a lot at the gym! You could get a couple of nice asses like this there if you can\u2019t get enough of mine!" She is dead serious and she drops her bra to the floor.</p>');
					startQuestions();
					addLinkToPlaceC(md, '"Hmm\u2026continue!"', 348, "type=afterquest5");
					break;
				case "5":
					md.write('<p>"Let\u2019s get rid of these knickers, shall we, ' + perYou.getMaster() + '?" Diane drops her knickers on the floor too, next to her bra. She\u2019s wearing only stockings and high heels.</p>');
					startQuestions();
					addLinkToPlaceC(md, '"Daaamn, I\u2019m the luckiest ' + perYou.getManWoman() + ' in the world! Weren\u2019t you a model or something before I met you?"', 348, "type=afterquest6");
					break;
				case "6":
					md.write('<p>"No, I always wanted to keep myself to the perfect man. I never thought it would be you, but here you are and I\u2019m naked. I can be YOUR model if you want." Diane lays down on the sofa, covering her naked breasts.</p>');
					startQuestions();
					addLinkToPlaceC(md, '"I knew you had a good body back at the police station..."', 348, "type=afterquest7");
					break;
				case "7":
					md.write('<p>You tell her "I knew you had a good body back at the police station, when I first met you, but boy, did you topped my expectations!"</p>' + '<p>Diane replies, "Feast your eyes on me as long as you want. I\u2019m not going anywhere, my love! This is your victory show!". Diane shows her pussy to you at last.</p>');
					startQuestions();
					addLinkToPlaceC(md, '"Oh, well\u2026 sit up Diane. I like how the sun lights your body."',
						348, "type=afterquest8");
					break;
				case "8":
					this.place = 168;
					md.write('<p>Diane answers "A true artist\u2026' + perYou.getMaster() + ', what AREN\u2019T you? You are so perfect!" she casually sits on the sofa, modeling for you.</p>' + '<p>You tell her, "Okay, that was enough! I have to go now, but don\u2019t worry I will be watching you\u2026and maybe bang you once in a while." you know this creepy and weird at the same time, but you don\u2019t care and you know she certainly doesn\'t!</p>' + '<p>Before you lean Diane quicly take a card from her purse, "' +
						perYou.getMaster() + ' I work long hours but please visit some night at my home. I live in the Haven Apartments, in the Glenvale town center. Bang me up as much as you want there!". The card is a keycard type of access for an expensive security system, and she also writes down a password for you if needed.</p>');
					startQuestions();
					addLinkToPlaceC(md, "leave the apartment", 194);
					break
			}
			WritePlaceFooter(md);
			return true
		}
		if (Place == 302 && this.checkFlag(16) && !this.checkFlag(18) && !this.checkFlag(15) && !this.checkFlag(19)) {
			md =
				WritePlaceHeader();
			perGina.showPerson("ginaathome" + (this.extra[1] + 1) + ".jpg");
			addPlaceTitle(md, "Gina and Diane");
			md.write("<p>You and Diane enter Gina\u2019s front door. You call out for Gina, hoping that she\u2019s home in this late hour. After a few seconds of silence and darkness, Gina turns on the light\u2019s switch in the ante-room. She doesn\u2019t recognise you first, but you can see her face changes from cautious to surprised then finally, delighted. She\u2019s wearing only some underwear, it\u2019s obvious you woke her up from her sleep. But you don\u2019t care, you have business with her at once. Gina bows down in front of her " +
				perYou.getMaster() + ", you hastily nod to that and order her to stand up. Gina smiles at you, but realizes your shadowy face.</p>" + "<p>" + perYou.getMaster() + "! To what do I owe the pleasure of having you in my home? How can I serve? \u2013 she doesn\u2019t take her eyes from yours, but she quickly nods to Diane, greeting her fellow slave.</p>" + "<p>I\u2019m in no mood for chit-chat! I have some questions and you have the answers! So just be on with it. \u2013 your sullen attitude makes her realize the urgency of this meeting. She leads you and Diane into her bedroom and offers you her bed to sit on it. You accept and lay down on her comfortable king-sized bed. Diane stands in attention, wordlessly waiting for an order, while Gina sits on the other size of the bed.</p>");
			startQuestions();
			switch (this.extra[1]) {
				case 0:
					addQuestionR(md, '"Where are those documents?"', '"Where are those documents, Gina? The ones you have sent to the police!" you ask impatiently from Gina.</p>' + '<p>Gina replies, "Oh, damn it! I knew it that it will cause me trouble\u2026' + perYou.getMaster() + ", please understand me\u2026 I already gave them to the TV station, to have the media broadcast it in the news. It was all before you\u2026before you changed me, my " + perYou.getMaster() + "! Please forgive me!</p>",
						"Gina", "setPersonOther(\\'Diane\\',1,2)");
					break;
				case 1:
					addQuestionR(md, '"What? Why the TV station?"', '"The Police wasn\u2019t convinced by the proof I brought, they said I was lying and to mind my own business. So I thought no other way than to go to the media. So people would talk about you and your actions."</p>', "Gina", "setPersonOther(\\'Diane\\',2,2)");
					break;
				case 2:
					addQuestionR(md, '"So the police ' + getOfficer(false) + ' hushed you away?"', '"Yes, ' + perYou.getMaster() + '. They were already your servants at the time and I knew you had some magical powers, some wizardry was going on\u2026"</p>' +
						'<p>You ask, "How?"</p>' + '<p>Gina replies, "My family is close with magic, my ancestors knew of mages and warlocks who possesed such powers, but my family members didn\u2019t. So they only knew how to protect themselves from them. With amulets, trinkets and such. My mother used to tell stories of powerful wizards who controlled entire villages and they were ' + perYou.getMaster() + 's to thousands of slaves. I knew I had to expose your doings, because you are a magic handler yourself."</p>' + '<p>You ask, "Whew! Aaand you almost got me\u2026 Who is this pretty girl who took these papers?"</p>' +
						'<p>Gina replies, "Her name is Madison I believe\u2026and yes it\u2019s such a luck that you turned me into a slave before I could make my actions possible. If you would have waited a little longer, my terrible, bitchy old self would have caused you a lot of trouble. I regret anything I have done in the past\u2026please, let me make try to fix them. I\u2019m a good slave, I promise!"</p>' + '<p>You ask, "I know you are, but not now, I have to fix this mess you caused. Then I want to talk to you about your family and your history with magics."</p>' +
						'<p>Gina replies, "Of course! Anytime ' + perYou.getPersonName() + '! Anything to make it up to you!"</p>' + "<p>With that, you stand up and leave Gina\u2019s house. You got all the info needed you needed, but you promised the lovely museum guard that you will return to her. Diane follows your trail, she is a bit occupied in her mind, maybe you should discuss it with her.", "Gina", "setPersonFlag(\\'Diane\\',19);gotoPlace(229)");
					break
			}
			WritePlaceFooter(md);
			return true
		}
		if (Place == 412 && this.place == -1 && !this.checkFlag(20)) {
			md =
				WritePlaceHeader();
			var perMadison = findPerson("Madison");
			this.setFlag(20);
			perMadison.showPerson(perMadison.checkFlag(13) ? "madison17be.jpg" : "madison17.jpg");
			addPlaceTitle(md, "Madison and Diane");
			md.write('<p>When you see Madison you call out, "Ahh, it\u2019s good that you are here! I need you to help me out, now!", you don\u2019t want to take your time with formalities like her kneeling before you. You get straight to the point just as you come into Madison\u2019s room.</p>' + '<p>Madison answers, "Yes, I see ' +
				perYou.getPersonName() + "! How can I help " + perYou.getMaster() + '?", she was packing her bag, she must have wanted to leave soon. It\u2019s of great luck that you have catched her!"</p>' + '<p>You tell her, "Gina, the security guard at the museum has dropped a package full of records and papers at the post office and said you brought them here. I need them!"</p>' + '<p>Madison exclaims, "Ohh, yes! I didn\u2019t know they were important to you, so I put them away to our storage area. It\u2019s right behind my office, but the door\u2019s closed and the TV station manager has the key to it.", she doesn\u2019t hesitate a lot and doesn\u2019t rave on about unimportant details. She\u2019s straight on point. You can see she\u2019s really trying to help.</p>' +
				'<p>You get to the point, "Right, where can I find the manager?"</p>' + '<p>Madison says, "She rarely comes. Once a week, and she already came by yesterday. I\u2019m sorry ' + perYou.getMaster() + ", but no one else has keys to storage. Maybe we could pry the door open? Just tell me what to do " + perYou.getMaster() + '." Madison smile is washed away, she\u2019s serious and is ready to follow any instructions you give her.</p>' + "<p>She can\u2019t help anymore, Diane, on the other hand, seems like wants to talk to you. Perhaps it would be wise to discuss with her on how to progress further\u2026</p>");
			startQuestions();
			addLinkToPlace(md, "return to the station reception", 371);
			WritePlaceFooter(md);
			return true
		}
		if (Place == 412 && this.place == -1 && !this.checkFlag(20) && sType == "askdocuments") {
			md = WritePlaceHeader();
			var perMadison = findPerson("Madison");
			this.setFlag(20);
			perMadison.showPerson(perMadison.checkFlag(13) ? "madison17be.jpg" : "madison17.jpg");
			addPlaceTitle(md, "Madison and Diane");
			md.write('<p>"Now, will you help me now, slut?!" you deliver the words with anger, you are mad because Madison\u2019s just wasting your time.</p>' +
				'<p>Madison replies, "Ohh, of course, ' + perYou.getMaster() + '! So sorry, for me being so ignorant! I did pick up the documents, but they\u2019re in the storage room, right behind my office. The door to is closed though, and only the manager has the rights to open it."</p>' + '<p>You ask, "Aww, come on! Where\u2019s this manager then?!"</p>' + '<p>Madison tells you, "She rarely comes. Once a week and she already came by yesterday. I am\u2026so terribly sorry. If I can be useful in any way, just tell me, let me try to correct my previous behavior. I will stand guard until you come up with something, ' +
				perYou.getMaster() + '!"</p>');
			startQuestions();
			addLinkToPlace(md, "return to the station reception", 371);
			WritePlaceFooter(md);
			return true
		}
		if (Place == 304 && this.checkFlag(16) && !this.checkFlag(18) & !this.checkFlag(15) && !this.checkFlag(19)) {
			md = WritePlaceHeader();
			perGina.showPerson("ginamuseum" + (this.extra[1] + 1) + ".jpg");
			addPlaceTitle(md, "Gina and Diane");
			md.write("<p>Diane opens the Museum entrance doors for you and follows you inside. You nervously look around for Gina, but all you see are a few tourists and visitors. Diane points to the security office and you rush towards there. You open the door and enter the somewhat small, yet oddly comfortable room. Gina is sitting in her chair, reviewing some papers. She turns around to check on who came in. When Gina notices you, she jumps from her chair and hurries to you. The curvy blonde museum guard stops right in front of you, kneels down and greets you.</p>" +
				"<p>" + perYou.getMaster() + ', you caught me off guard! I didn\u2019t sense you were coming! How can I be of help to you?" she is like in heaven, you can feel it. Interestingly she is wearing a different uniform than usual. However you are still mad at her the things she done, so you order her to stand up.</p>');
			startQuestions();
			switch (this.extra[1]) {
				case 0:
					addQuestionR(md, '"Where are those documents?"', '"Where are those documents, Gina? The ones you have sent to the police!" you ask impatiently from Gina.</p>' +
						'<p>Gina answers, "Ohh, so this is about the lawsuit\u2026my ' + perYou.getMaster() + '\u2026I think\u2026 I think I failed you. Please! Don\u2019t be angry at me, but I have already forwarded the papers to TV station! A pretty girl from there previously picked them up from the post office and took them with her. It all happened before you have put me under your spell, but please\u2026 I was reckless and stupid\u2026."</p>', "Gina", "setPersonOther(\\'Diane\\',1,2)");
					break;
				case 1:
					addQuestionR(md, '"What? Why the media instead of the police?"',
						'"They acted strange, I knew something was not right. You see, ' + perYou.getMaster() + ", my family has a history with magic, we are not users of it, but we can sense when someone uses it. My family members could only protect themselves from magic by using enchanted necklaces, rings, bracelets and such.", "Gina", "setPersonOther(\\'Diane\\',2,2)");
					break;
				case 2:
					addLinkToPlaceC(md, '"So you knew that ' + getPoliceChief() + ' Batton was in my power?"', 238, "", '<p>You ask, "So you knew that ' + getPoliceChief() + ' Batton was in my power? And I also  see why you could see through Diane\u2019s lies\u2026"</p>' +
						'<p>Gina replies, "Yes, ' + perYou.getMaster() + '. Excuse this worthless slave for wanting to expose your actions. This all happened before you made me realize what\u2019s important in life; You."</p>' + '<p>You ask, "We will have to talk about your family\u2019s history later\u2026 it\u2019s interesting. However, let\u2019s not change the subject, where can I get the documents? I need to destroy any evidence of the crime\u2026"</p>' + '<p>Gina replies, "I understand. A pretty delivery girl from the TV station picked them up from the post office. I believe her name was Madison. Can I come with you, ' +
						perYou.getMaster() + '? I could protect you from any harm\u2026 I\u2019m a skilled fighter."</p>' + '<p>You ask, "Of course not, I have enough unwanted attention as it is. And I already have Diane, who doesn\u2019t leave my side a for second.", you half-jokingly grumble to yourself and sign to Diane to get ready to leave.</p>' + '<p>Gina replies, "I\u2019m sorry, ' + perYou.getMaster() + '! I want to make it up to you! I promise I will come up with something!"</p>' + "<p>You let Gina kiss your hand and leave her office. It\u2019s time to stop by at the TV station. Maybe Diane has a plan\u2026",
						"Gina", "setPersonFlag('Diane',19)");
					break
			}
			WritePlaceFooter(md);
			return true
		}
		if (sType == "chatdiane") {
			md = WritePlaceHeader();
			this.showPerson("dianechat1.jpg");
			addPlaceTitle(md, "Chatting with Diane");
			md.write("<p>You stop for a moment to talk to Diane.</p>");
			startQuestionsOnly();
			if (!this.checkFlag(24)) addQuestionR(md, '"Can\u2019t we just put a bail on this one?"', 'You ask Diane, "Can\u2019t we just put a bail on this one? I mean I practically own the police, so no harm would come to me. I could just leave the jail anytime I want if they would imprison me\u2026."</p>' +
				'<p>Diane, "Technically, yes my ' + perYou.getMaster() + ', you could, but a procedure like this would take ages. You would have to go to court several times to prove you\u2019re innocent or not and after that there would be still people who would keep an eye on you. I\u2019m sure of it."</p>' + '<p>You ask, "I could just enslave the judge, the jury and everyone else\u2026."</p>' + '<p>Diane, "You are not strong enough to charm a group of people at the same time. Your mana would deplete fast and you would fall into a swoon in an instant. I wouldn\u2019t advise that, my ' +
				perYou.getMaster() + '!"</p>' + '<p>You ask, "It\u2019s off to hunting documents then\u2026what a great day!"</p>' + '<p>Diane, "Forgive me for dragging you into this, my wise ' + perYou.getMaster() + '. I know how terribly occupied you are with much important things, but this could not wait any longer."', "Diane", "setPersonFlag(\\'Diane\\',24)");
			if (!this.checkFlag(26)) addQuestionR(md, '"How come you are so useless?"', 'You ask Diane, "How come you are so useless? You can\u2019t even deal with something so simple as this. You are a lawyer after all and this would be just an easy routine work for you\u2026"</p>' +
				'<p>Diane, "I really tried my best, ' + perYou.getMaster() + '! I gave a shot to any idea I could think of. I tried to bribe her, I tried to threatened her. I even thought of accusate her for false claims, but nothing worked. She seemed reluctant and also relentless on punishing you. Gina hated you from the bottom of her heart."</p>' + '<p>You ask, "Why? I just tried to steal a vase. It\u2019s not that big of a deal\u2026"</p>' + '<p>Diane, "It is to her. Maybe you didn\u2019t leave a great first impression on her, but she smelled something fishy when I visited her at her home. As if she knew that I\u2019m your thrall."</p>' +
				'<p>You ask, "What did you do? I hope you didn\u2019t slap her on the face or something\u2026"</p>' + '<p>Diane, "No! Of course not, my Lord and ' + perYou.getMaster() + "! I introduced myself as the attorney who got your case and that I\u2019m the one leading the investigation. But she didn\u2019t buy it. I even  told her I didn\u2019t like you too and tried to convince Gina that I\u2019m on her side. I hated that part\u2026having to say such things about you " + perYou.getMaster() + '."</p>' + '<p>You ask, "Gina will be much more friendly from now on I assure you of that. But next time don\u2019t let me come down and deal with petty things like this."</p>' +
				'<p>Diane, "I understand ' + perYou.getMaster() + "! Forgive me one last time for being incompetent\u2026and I will also forget how Gina\u2019s been a pain in the ass. She\u2019s yours now and I will cooperate with her if I need to.", "Diane", "setPersonFlag(\\'Diane\\',26)");
			if (getLocationOnMap() == 359 && !this.checkFlag(25)) addQuestionR(md, '"It\u2019s so strange, my Mum works here..."', 'You explain to Diane, "It\u2019s so strange, my Mum works here and I\u2019ve been here a few times, but I didn\u2019t know that they have a storage room or a mail-system."</p>' +
				'<p>Diane answers, "It\u2019s obvious, ' + perYou.getMaster() + '. A lot of people write to the media for help or any other reasons. It\u2019s a smaller town so the folks don\u2019t really have much other option if they want something. It\u2019s either the police or the Tv\u2026"</p>' + '<p>You consider, "Yes, still it\u2019s weird that how powerful the media can be."</p>' + '<p>Diane smiles, "Maybe you should consider owning the place, if you get my meaning. Imagine the possibilites." Diane naughtily lets out a giggle.',
				"Diane", "setPersonFlag(\\'Diane\\',25)");
			if (!isCharmedBy("Madison") && this.checkFlag(19) && !this.checkFlag(27)) addQuestionR(md, '"You know this Madison?"', 'Diane answers, "I\u2019m not sure\u2026the name doesn\u2019t ring a bell, but I may have know her by face. We will have to see\u2026"</p>' + '<p>You ask, "Hurry then\u2026we might still find her at the station."</p>' + '<p>Diane says, "We need to be careful, ' + perYou.getMaster() + '. You may need to use your powers on her. We need to go prepared, so I advise that you replenish some of your mana if you can now. It\u2019s all just for your good!"',
				"Diane", "setPersonFlag(\\'Diane\\',27)");
			if (!isCharmedBy("Madison") && this.checkFlag(19) && !this.checkFlag(28)) addQuestionR(md, '"It\u2019s useless to go to the police now, right?"', 'You ask Diane, "It\u2019s useless to go to the police now, right? I mean Miss Batton could assist us somehow."</p>' + '<p>Diane says, "I don\u2019t think it\u2019s a good idea to waste your time going there, My dear ' + perYou.getMaster() + '! We will run out of time."</p>' + '<p>You ask, "I hope you are right. I don\u2019t want to go unprepared."</p>' +
				'<p>Diane says, "I\u2019m here for you! ' + perYou.getPersonName() + " I can handle many situations, just trust me " + perYou.getMaster() + '! I won\u2019t fail!"', "Diane", "setPersonFlag(\\'Diane\\',28)");
			if (this.checkFlag(20) & !this.checkFlag(21)) addQuestionR(md, '"We are stuck\u2026what should we do? We are running out of options here!!"', "Don\u2019t panic " + perYou.getMaster() + "! I\u2019m here for you! We will find a way! Let me think\u2026 What about your magic powers? Could you use them here somehow? Do you have any spells that would help? \u2013 Diane remains cool, she is focusing on a solution rather than go to hysteria mode like yourself.</p>" +
				'<p>You rely, "Diane! You are a genius! I could kiss you! \u2013 you burst out in joy. In all the hurry, you forgot that you are magician and that such obstacle as a door would be no match for your powers.</p>' + '<p>Diane says, "I\u2019m happy to serve ' + perYou.getMaster() + "! That\u2019s why I\u2019m here for! To have a clear head when you need it! \u2013 Miss White grins. A rush of excitement rushes through her body, she feels useful for her " + perYou.getMaster() + ".</p>" + "<p>You quickly kiss your very own private lawyer, your slave as a gratitude and now focus on getting through that damned door.",
				"Diane", "setPersonFlag(\\'Diane\\',21)");
			if (getQueryParam("car") == "true" && !this.checkFlag(29)) addQuestionR(md, '"Diane, how many files are in there?"', '<p>Diane says, "I haven\u2019t counted yet ' + perYou.getPersonName() + '! Around a hundred or so. It will take some time to find the right one."</p>' + '<p>You ask, "Yeah, I know. Don\u2019t worry, Victoria will help us. After we are done, you will need to bring back the box and it\u2019s content to the station. Just tell Madison it\u2019s the ' + perYou.getMaster() +
				'\u2019s order. She will know what to do."</p>' + '<p>Diane says, "Yes, I will do as you want. It will be done in no time!"', "Diane", "setPersonFlag(\\'Diane\\',29)");
			if (getQueryParam("car") != "true") addQuestionR(md, '"Diane, I need to do something else, please return to the Police Station for now"', '"Of course ' + perYou.getMaster() + ', but please hurry!"', "Diane", "movePerson(\\'Diane\\',168)", "");
			addLinkToPlace(md, "continue on", Place, getQueryParam("car") == "true" ? "type=victoriascar" : "");
			WritePlaceFooter(md,
				"", true, true);
			return true
		}
		return false
	};
	per.showPersonChat = function(bGeneral, md) {
		if (Place == 168 && this.isHere())
			if (this.checkFlag(16) && !this.checkFlag(17)) addLinkToPlaceC(md, '"Diane, how\'s those charges against me holding up?"', Place, "type=askaboutgina");
			else if (this.checkFlag(17) && !this.checkFlag(30) && this.place !== -1) addQuestionR(md, '"Diane, let\'s get back to finding those documents"', '"Of course ' + perYou.getMaster() + '"', "Diane", "movePerson(\\'Diane\\',-1)");
		if (Place == 416 && this.place == 412) addOptionLink(md,
			"open the door for Diane", "movePerson('Diane',-1);dispPlace()");
		else if (Place == 416 && this.place == -1) addLinkToPlace(md, "take the box full of documents", 194, "type=victoriascar", "Now that you have the necessary items, all in a box, you decide it\u2019s time to leave. You and Diane leave the storage room. Madison has been already instructed to open the backdoor for you to leave quietly. She tells you that everything is going to be all right and she will clear up after you. She ensures that no evidence of you being in the storage-room will remain. You let out a tired sigh and get a hold of yourself. You kiss Madison on the cheek as she closes the backdoor behind you. Victoria is already there, in the parking lot of the TV station. She waves at you and opens the car\u2019s doors for your arrival. Diane sits in the back, right behind the driver\u2019s seat, while you order Victoria to take the passenger\u2019s seat. You drive, because you want to be at Victoria\u2019s place as soon as possible.");
		else if (Place == 466 && this.checkFlag(30)) addLinkToPlace(md, "visit Diane's apartment", 467);
		else if (Place == 467 && sType === "")
			if (this.isHere()) {
				addLinkToPlaceC(md, "ask Diane for legal advice", Place, "type=fuck");
				addSleepLink(md, "bed Diane", "Sleeping with Diane", "<p style=\"position:absolute;left:10%;top:10%;cursor:pointer;font-size:1.1em;width:60%\"><b>You take Diane to bed, but you see she wears a blind-fold, she explains she finds it helps her sleep, and also comes in useful for other 'kinkier' things!</b>",
					"diane-bed.jpg", true, "", "", "", "overflow-y:hidden")
			} else if (!checkPlaceFlag("ShoppingCenter", 4)) addPopupLinkC(md, "read the book", "Reading 'The Voynich Manuscript'", "<p><img src='UI/books/voynichbook.jpg' style='width:30%;float:right;margin-left:5px' alt='Book'>" + "You pick up the book and spend a while reading it, you had heard it was an old grimoir written in an untranslated code. You hoped your recent work with the Sacred Book of Control may give you an insight. Unfortunately it makes no sense to you, it has strange drawings and written in something that looks like an unknown language. The early part of the book discusses the grimoir and suggests it was a con-game to sell a rich person, a book purely created to defraud, skillfully made but gibberish. Probably this is what attracted Diane's interest, the fraud and the mystery.<br><br>" +
			"You are about to put it down as interesting but useless, and at the end of the book there is one of the strange symbols. For a moment the symbol glows and then fades as you feel a surge of mana flow into you. So mana can be enscibed on paper, but the symbol is just a drawing, there must of been some other knack to doing this not just the symbol...", false, "setPlaceFlag('ShoppingCenter',4);AddMana(10);WaitHere(6)")
	};
	per.showPersonTextHere = function(md) {
		if (Place == 416 && this.place == -1) {
			md.write("<p>Now joined by Diane, the two of you look around, searching for the package. After a few bitter minutes of unsuccessful hunt for the papers, you sadly state to Diane,</p>" +
				'<p>"We will never find it here. We don\u2019t have the time look through all this mess! Look at this; they are not even labeled! And what if someone sees us?!"</p>' + '<p>Diane says, "Don\u2019t worry ' + perYou.getMaster() + '! Madison is standing guard outside. No one will notice for a while, but you are right. We don\u2019t have much time. How about bringing all these packages to a safe place and dig through them there?"</p>' + '<p>You tell her, "No can do\u2026 there are camera outside! They would see us carrying huge bags of documents. Though I know someone who can help! I call Victoria, while you collect every document that has the date adressed in this month! She will come and pick up us!"</p>' +
				'<p>Diane answers, "At once! Give me a few minutes and it will be done!"</p>');
			if (!this.checkFlag(22)) {
				addSMS(105);
				usePhone("sms");
				this.setFlag(22)
			}
		}
		if (Place == 467 && sType === "") {
			if (this.isHere()) md.write("<p>Diane is waiting for you, wearing some lovely lingerie.</p>");
			if (!this.isHere() && !checkPlaceFlag("ShoppingCenter", 4)) {
				md.write('<p style="clear:both">');
				AddImage("UI/books/voynichbook.jpg", "20%", "left");
				md.write('You see some books neatly arrayed in a bookcase. Most are legal works of no interest to you but there are a few other general works. One attracts your attention, "The Voynich Manuscript", you have heard of it as claimed to be a grimoir.</p>')
			}
		}
	};
	per.isPhoneable = function() {
		return checkPlaceFlag("Hotel", 11) && Place == 269
	};
	per.callThem = function() {
		if (Place == 269)
			if (!(this.checkFlag(30) && isNight())) WriteComments("You call Diane to invite her to join you at the pool for a swim, but she apologies that she is busy with legal work." + (this.checkFlag(30) ? " She suggest you call back tonight and she will be happy to join you" : ""));
			else {
				gotoPlace(Place, "type=dianepool");
				receiveCall("", 'You call Dian to invite her to join you at the pool for a swim, and she immediately answers that she will meet you there as soon as she can."');
				WriteCommentsFooter(bChat, bChatLeft)
			}
	};
	per.addPersonPhoneCall = function() {
		if (!this.isCharmedBy()) return false;
		var hr = getHour();
		var tm = this.hoursCharmed();
		var rnd = Math.floor(Math.random() * 72);
		if (tm > 12 + rnd && hr > 19 && !this.checkFlag(3)) {
			if (makeCall(true, 100)) this.setFlag(3)
		} else if (tm > 24 + rnd && hr < 9 && !this.checkFlag(4)) {
			if (makeCall(true, 101)) this.setFlag(4)
		} else if (tm > 12 + rnd && !this.checkFlag(5)) {
			if (makeCall(true, 102)) this.setFlag(5)
		} else if (tm > 12 + rnd && !this.checkFlag(6) && isCharmedBy("OfficerBatton")) {
			if (makeCall(true,
					103)) this.setFlag(6)
		} else if (this.isCharmedBy() && isCharmedBy("Gina") && isCharmedBy("Victoria") && Place != 168 && getHour() < 9 && !this.checkFlag(16)) {
			if (makeCall(true, 104)) this.setFlag(16)
		} else if (this.checkFlag(31) && !this.checkFlag(32))
			if (makeCall(true, 106)) this.setFlag(32);
		return false
	};
	per.getPersonSMS = function(id) {
		switch (id) {
			case 100:
				return receiveSMS("Diane", "Argh\u2026all these paperwork can wait...im just having a break and dream about u being here\u2026 i miss u! the only thing keeping me here and not leaving immediately to kneel at your feet and worship is that u have commanded me to stay, to be ur personal attorney...",
					"dianesms_allthesepaperwork.jpg") + replyToSMS("I know it\u2019s hard without me\u2026:) But there\u2019s tons of desk work needed to be done and this is how you can help me the best at the moment:)") + receiveSMS("Diane", "I know...im a good slave and i obey without question, i understand that you are busy but still...if i could lick ur feet for a minute\u2026anyways\u2026Love you " + perYou.getMaster() + "!");
			case 101:
				return receiveSMS("Diane", "Goooood morning to the " + (perYou.isBornMale() ? "handsomest, " :
					"") + "most beautiful " + perYou.getManWoman() + " in the world and the one makes my heart beat harder every second\u2026my " + perYou.getMaster() + "! Ur whore lawyer is currently dressing up for todays work\u2026hope u can come by today:P", "dianesms_morninglawyer.jpg");
			case 102:
				return receiveSMS("Diane", "Are these the boobs u are looking for? yes! these are the boobs and body u are looking for!! aandd their yours to claim! Love u!", "dianesms_boobsyouarelookfor.jpg");
			case 103:
				return receiveSMS("Diane", "Kerry, the chief, sent me this\u2026.still laughing:))) she caught me\u2026.",
					(perYou.isBornMale() ? "dianesms_howthemaster" : "dianesms_howthemistress") + ".jpg", "88%");
			case 104:
				return receiveSMS("Diane", perYou.getMaster() + ", please come by my office when you can. We need to talk about Ginas court case againts you!!! Ohh " + perYou.getManWoman() + " im worried about it!");
			case 105:
				return replyToSMS("Slave! i need you to come and get us! we are in the tv station\u2026come with a car now!") + receiveSMS("Victoria", "On my way, " + perYou.getMaster() + "!") + replyToSMS("Wait for us at the back of the building\u2026madison gonna open the backyard door for us") +
					receiveSMS("Victoria", "Yes " + perYou.getMaster() + "!");
			case 106:
				return receiveSMS("Diane", "Its done " + perYou.getMaster() + "\u2026you are no longer reported for anything:DD have fun! xoxo, Diane")
		}
		return ""
	}
}

function initialiseDidi() {
	addPerson("Didi", 0, "Didi");
	per.whereNow = function() {
		return !isDay() || getDay() == "Sunday" ? 0 : this.place
	};
	per.getNextDress = function(drs) {
		if (drs == "Yellow") return "Turquoise";
		else if (drs == "Turquoise") return "String";
		else if (drs == "String") return "Multi";
		else if (drs == "Multi") return "Jaguar";
		else if (drs == "Jaguar") return "Blue";
		return "Yellow"
	};
	per.passTimeDay = function() {
		if (this.place == 999) {
			if (this.getCharmedLevel() == 4) {
				if (this.dress != "Naked") this.dress = this.getNextDress(this.dress)
			} else if (this.getCharmedLevel() ==
				1) {
				var ar = [];
				if (!this.checkFlag(2)) ar.push("Yellow");
				if (!this.checkFlag(4)) ar.push("Turquoise");
				if (!this.checkFlag(3)) ar.push("String");
				if (!this.checkFlag(5)) ar.push("Multi");
				if (!this.checkFlag(6)) ar.push("Jaguar");
				if (!this.checkFlag(7)) ar.push("Blue");
				for (var i = 0; i < ar.length; i++) {
					this.dress = this.getNextDress(this.dress);
					for (var j = 0; j < ar.length; j++)
						if (ar[j] == this.dress) {
							this.place = 269;
							return ""
						}
				}
				this.dress = ar[0]
			} else this.dress = this.getNextDress(this.dress);
			this.place = 269
		}
		return ""
	};
	per.showEventPopup =
		function() {
			if (sType !== "") return false;
			if (Place == 269 && this.isHere() && !this.checkFlag(1)) {
				this.setFlag(1);
				this.dress = "Yellow";
				showPopupWindow("Welcome to the Pool", "<img src='Images/People/Didi/introduction.jpg' class='imgpopup' alt='Didi'>" + "You see a new face at the pool, well a bit more than that as she is mostly naked. The woman just came out of the changing area for the public, wearing nothing more than a towel. She looks around and sees yourself and smiles,<br><br>" + '"Ahh silly me, swimsuits are not optional here are they!", and she steps back into the changing room. A very short time later she returns, barely wearing her swimsuit. She smiles again,<br><br>' +
					"\"Cute isnt't it? I'm Didi, you coming for a swim?\". She speaks with a lovely accent, possibly Welsh, and she is definitely cute, curvy and busty with some tattoos at her waist. The tattoos catch your attention but you cannot quite say why.");
				return true
			}
			return false
		};
	per.showEvent = function() {
		var md;
		if (Place == 269 && this.isHere()) {
			var cnt = this.checkFlag(2) ? 1 : 0;
			if (this.checkFlag(3)) cnt++;
			if (this.checkFlag(4)) cnt++;
			if (this.checkFlag(5)) cnt++;
			if (this.checkFlag(6)) cnt++;
			if (this.checkFlag(7)) cnt++;
			if (sType ==
				"charmdidi1") {
				if (this.dress == "Yellow") this.setFlag(2);
				else if (this.dress == "String") this.setFlag(3);
				else if (this.dress == "Turquoise") this.setFlag(4);
				else if (this.dress == "Multi") this.setFlag(5);
				else if (this.dress == "Jaguar") this.setFlag(6);
				else if (this.dress == "Blue") this.setFlag(7);
				cnt++;
				md = WritePlaceHeader(false, "td-left-med");
				this.showPerson("charm1.jpg");
				addPlaceTitle(md, "Didi Under a Spell" + (cnt > 1 ? " Again" : ""));
				if (cnt > 1) md.write("<p>Once again you cast the charm spell on Didi hopeful it will work this time. She seems to have no memory of the previous time you cast charm on her.");
				else md.write("<p>Once again you cast the spell on Didi and you feel something odd, but spell does seem to work.");
				md.write(" Didi looks at you and smiles. Before you can say anything she removes part of her swimsuit, what little there is. She asks you,</p>" + '<p>"Isn\'t that better? Who needs swimwear, and I like to show-off my body"</p>' + "<p>You have to admit her body is worth being displayed and she should be proud of it. You compliment her and start to talk to her about desire and obedience. While she does not ignore you, she pays little attention, more showing off for your pleasure. You play along and suggest she should just completely forget the swim-wear completely</p>");
				startQuestions();
				addLinkToPlaceO(md, "Didi strips...", 269, "type=charmdidi2");
				WritePlaceFooter(md);
				return true
			} else if (sType == "charmdidi2") {
				md = WritePlaceHeader();
				this.showPerson("charm2.jpg");
				addPlaceTitle(md, "Didi Under a Spell" + (cnt > 1 ? " Again" : ""));
				if (cnt > 1) md.write("<p>Again this seems to play out the same as before, Didi has no recollection of the presious time. ");
				else md.write("<p>");
				md.write("Didi agrees and completely strips off naked, exposing her lovely figure and ample breasts. As you look she says,</p>" +
					'<p>"While my name is short for Dierdre, most people assume it is a reference to my measurements"</p>' + "<p>Well double D seems about right, but you tell her it is hard to be sure that she is true to her nick-name. She grins,</p>" + '<p>"Come on how about a hands-on check?"</p>' + "<p>You can only agree and step over to her and cup her large breasts,</p>");
				startQuestions();
				addLinkToPlaceC(md, "DD is about right...", 269, cnt == 3 ? "type=charmdidi3" : "type=charmdidisex");
				WritePlaceFooter(md);
				return true
			} else if (sType ==
				"charmdidi3") {
				md = WritePlaceHeader();
				this.showPerson("charm3.jpg");
				addPlaceTitle(md, "Didi Under a Spell" + (cnt > 1 ? " Again" : ""));
				this.charmThem(4);
				this.dress = "Naked";
				this.moveThem(999);
				md.write("<p>You notice Didi rub the tattoo on her hip and you step back and ask her about it. She lies back in the water of the pool and looks up at you,</p>" + '<p>"I do not know, but you are really, really sexy..."</p>' + "<p>Something is different this time, so you suggest that maybe she would like to explore her submissive nature. She shakes her head,</p>" +
					'<p>"Not really, I have never been into that sort of stuff, but I do not mind a little role-playing, ' + perYou.getMaster() + '"</p>' + '<p>Interesting, the tattoo has allowed her to retain some independence, but she seems under the influence of the spell. Didi stands and gives you a kiss and says "Sorry I gotta go and get back to work. I hope to see you another time, ' + perYou.getMaster() + '". With that she picks up her swimsuit and leaves.</p>');
				startQuestions();
				addLinkToPlaceC(md, "Didi leaves again...",
					269);
				WritePlaceFooter(md);
				return true
			} else if (sType == "charmdidisex") {
				md = WritePlaceHeader(false, !perYou.isMaleSex() && !isExplicit() ? "td-left-med" : "");
				if (perYou.isMaleSex()) this.showPersonRandomRorX("!pool-sexb", isExplicit() ? 2 : 1);
				else if (isExplicit()) this.showPersonX("!pool-sexga.jpg");
				else this.showPersonRandom("!pool-sexg", 2);
				this.moveThem(999);
				addPlaceTitle(md, "Didi Under a Spell" + (cnt > 1 ? " Again" : ""));
				if (perYou.isMaleSex()) md.write("<p>Didi steps over and starts to pull down your trousers and in short order you are unclothed and fucking the busty and naked woman.</p>");
				else md.write("<p>Didi steps over and starts to pull down your pants and in short order you are licking and being licked by the busty and naked woman.</p>");
				md.write("<p>A little before the end, you notice her tatto is slighly glowing.");
				if (cnt == 1) md.write(" Afterwards you ask her about the tattoo and she tells you,</p>" + '<p>"I met this girl one time, she was called Faye, and called herself a fae. Well she may of been deluded and thought she was one of the y Tylwyth Teg, but more likely an eccentric. Still she was cute and we hung out and had a lot of fun. She gave me this tattoo, telling me it was a protective charm that would shield me from curses, but only a few times!"' +
					"<p>Well this Faye may of had some knowledge of magic and the tattoo may be a <b>ward</b>, but possibly only for a limited time. Possibly you should try this again another day?");
				md.write('</p><p>Didi gives you a kiss and says "Sorry I gotta go and get back to work. I hope to see you another time". With that she picks up her swimsuit and leaves.</p>');
				startQuestions();
				addLinkToPlace(md, "Didi leaves", 269);
				WritePlaceFooter(md);
				return true
			} else if (sType == "chattodd") {
				md = WritePlaceHeader();
				this.showPerson("pool-talk.jpg");
				addPlaceTitle(md, "Chatting with Didi");
				md.write("<p>You notice Didi rub the tattoo on her hip and you step back and ask her about it. She lies back in the water of the pool and looks up at you,</p>" + '<p>"I do not know, but you are really, really sexy..."</p>' + "<p>Something is different this time, so you suggest that maybe she would like to explore her submissive nature. She shakes her head,</p>" + '<p>"Not really, I have never been into that sort of stuff, but I do not mind a little role-playing, ' +
					perYou.getMaster() + '"</p>' + '<p>Didi stands and gives you a kiss and says "Sorry I gotta go and get back to work. I hope to see you another time, ' + perYou.getMaster() + '". With that she picks up her swim-suit and leaves.</p>');
				startQuestions();
				addLinkToPlaceC(md, '"Let\'s fuck"', 269, "type=charmdidisex");
				if (this.dress == "Naked") addPopupLink(md, '"I want to see you in bikini\'s again"', "Changing", "<img src='Images/People/Didi/pool-change.jpg' style='width:50%;float:right;margin-left:5px' alt='Didi'>" + "You ask Didi to start wearing her bikini's again and she nods her head,<br><br>" +
					'"Sure, but it is a pitty to cover up all this", she stands to show you what you will be missing. She blows you a kiss and walks off to the changing room. You expect her to return wearing a bikini, but a little later she calls you to say "See you". While she is under the spell, she has certainly retained some independence.', true, "movePerson('Didi',999);per.dress=''");
				else addPopupLink(md, '"I want to see you naked again"', "Changing", "<img src='Images/People/Didi/pool-change.jpg' style='width:50%;float:right;margin-left:5px' alt='Didi'>" +
					"You ask Didi to stop wearing her bikini's again and she nods her head, and simply removes her bikini!", true, "findPerson('Didi').dress='Naked'");
				addLinkToPlaceC(md, "leave Didi for now", 269, "", "As you leave you notie Didi heads off to the changing room", "", "movePerson('Didi',999)");
				WritePlaceFooter(md);
				return true
			}
		}
		return false
	};
	per.showPersonTextHere = function(md) {
		if (Place == 269 && this.isHere() && sType === "" && this.checkFlag(1)) md.write("<p>You see Didi enjoying herself in the pool.</p>")
	};
	per.showPersonChat =
		function(bGeneral, md) {
			if (Place == 269 && this.isHere() && sType === "" && this.getCharmedLevel() == 4) addLinkToPlaceC(md, "talk to Didi", 269, "type=chattodd")
		};
	per.handleItem = function(no, cmd) {
		if (no == 14 && cmd == 2)
			if (Place == 269 && this.isHere() && sType === "") {
				CastCharmSpell("Didi", 269, 1, "type=charmdidi1");
				return "handled"
			}
		return ""
	};
	per.addPersonPhoneCall = function() {
		if (this.place != 999 && this.getCharmedLevel() == 1) {
			var cnt = this.checkFlag(2) ? 1 : 0;
			if (this.checkFlag(3)) cnt++;
			if (this.checkFlag(4)) cnt++;
			if (this.checkFlag(5)) cnt++;
			if (this.checkFlag(6)) cnt++;
			if (this.checkFlag(7)) cnt++;
			if (makeCall(true, cnt > 1 ? 281 : 280)) {
				this.unCharmThem();
				AddMana(10)
			}
		}
		if (this.place != 999 && this.getCharmedLevel() == 4 && !this.checkFlag(10))
			if (makeCall(true, 282)) this.setFlag(10);
		return false
	};
	per.getPersonSMS = function(id) {
		if (id == 280) return receiveSMS("DD", "Hey there, I found your number in my phone. Did we hook up yesterday? Sorry I must of been drunk I do not really remember it. Sorry", "sms1.jpg");
		if (id == 281) return receiveSMS("DD", "We did hook up at the pool yesterday? Not sure I remember...gotta go my hip itches...",
			"sms2.jpg");
		if (id == 282) return receiveSMS("DD", "Hey " + this.getYourNameFor() + ", come and see me at the pool sometime", perYou.isMaleSex() ? "sms3b.jpg" : "sms3g.jpg");
		return ""
	}
}

function initialiseDoctorKay() {
	addPerson("Doctor Kay", 0, "DoctorKay");
	per.whereNow = function() {
		if (this.place === 0) return 0;
		if (isShopOpen(2) && getHour() > 12 || sType.indexOf("followntina") != -1) return 69;
		if (!isDay() && this.isCharmed()) return 181;
		return 0
	};
	per.addPlaceImageLeft = function(lit) {
		if (Place == 69 && this.isHere() && sType === "") return this.showPerson("tinasch2b.jpg", "", "", "", "", false, "string");
		if (Place == 181 && this.isHere() && sType === "") return this.showPerson("tinahotelbed2.jpg", "", "", "", "", false, "string");
		return ""
	};
	per.showEventPopup = function() {
		if (Place == 70 && !this.checkFlag(1) && isShopOpen(2) && checkPersonFlag("Catherine", 10)) {
			this.setFlag(1);
			this.place = 69;
			showPopupWindow("Who is that?", "<img src='Images/People/DoctorKay/tinaprofalt.jpg' class='imgpopup' alt='Nurse'>" + "You see a girl you don\u2019t recognise walking down the corridor.</p>" + "<p>She seems to be heading to the Nurse\u2019s Office, and she certainly looks like a nurse. You remember that Catherine said she was taking a leave from her job as the school nurse, she just did not want to have to confront 'that slime Beasley'</p>" +
				"<p>Do you try and follow her or wait and ask Catherine?</p>" + addOptionLink("string", "follow", "dispPlace(69,'type=followntina')", "chatblock", "width:50%;margin-left:10%") + addOptionLink("string", "leave and ask Catherine", ";dispPlace(70,'', '" + this.addPersonFace(true) + "You decide you&rsquo;ll have to ask Catherine next time you see her as to who the stand-in nurse is. On the other hand you wonder to yourself whether you could find anything out at the hospital.')", "chatblock", "width:50%;margin-left:10%"),
				"", "", true, true);
			return true
		}
		if (Place == 269 && !this.checkFlag(2) && !this.checkFlag(5) && isDay() && checkPersonFlag("Catherine", 10) && this.checkFlag(4)) {
			this.setFlag(5);
			showPopupWindow("The Nurse Bambi Mentioned?", "<img src='Images/People/DoctorKay/tinapoolpre1.jpg' class='imgpopup' alt='Nurse'>" + "You emerge into the sunlight around the pool and start looking for the new girl you have heard about from Bambi.</p>" + "<p>After a moment adjusting your eyes you realise there is someone on the far side of the pool who appears to be finishing dressing prior to leaving. You start around the pool towards her...",
				"dispPlace(Place,'type=drkaypool2')", "", true);
			return true
		}
		if (sType == "drkaypool2") {
			showPopupWindow("The Nurse Bambi Mentioned?", "<img src='Images/People/DoctorKay/tinapoolpre2.jpg' class='imgpopup' alt='Nurse'>" + "As you start to go around the pool to try and talk to her she finishes changing and leaves.</p>" + "<p>Before she goes you cannot help but feel she has been assessing you as much as you have been assessing her \u2013 giving you pause for thought.</p>" + "<p>You are fairly sure that she will be going over to the school to cover Catherine\u2019s shift \u2013 the only question is should you follow her to the school right now or do something more pressing.",
				"", "", true);
			return true
		}
		return false
	};
	per.showEvent = function() {
		var md;
		if (Place == 181) {
			if (sType == "drtinafun1") {
				md = WritePlaceHeader(false, "td-left-med");
				this.showPerson("tinahotelbed3.jpg");
				addPlaceTitle(md, "Fun with Dr. Tina");
				md.write("<p>You decide that there is time to have some fun before settling down for the night.</p>" + "<p>As she starts to undress you catch her looking at you longingly whilst nibbling on her finger. Realising that she is as excited as you are you start towards her.</p>");
				startQuestions();
				if (perYou.isMaleSex()) addLinkToPlaceC(md, "approach her", Place, "type=drtinafunmale&stage=stage1");
				else addLinkToPlaceC(md, "approach her", Place, "type=drtinafunfemale&stage=stage1");
				WritePlaceFooter(md);
				return true
			}
			var stage = getQueryParam("stage");
			if (sType == "drtinafunmale") {
				md = WritePlaceHeader(false, stage == "stage1" || !isExplicit() && stage != "stage2" && stage != "stage6" && stage != "stage7" && stage != "stage8" ? "" : "td-left-med");
				switch (stage) {
					case "stage1":
						this.showPerson("tinahotelbed4.jpg");
						break;
					case "stage2":
						this.showPersonRorX("tinahotelbed5.jpg");
						break;
					case "stage3":
						this.showPersonRorX("tinahotelbed6.jpg");
						break;
					case "stage4":
						if (!isExplicit()) this.showPerson("tinahotelbed9.jpg");
						else this.showPersonX("tinahotelbed7.jpg");
						break;
					case "stage5":
						if (!isExplicit()) this.showPerson("tinahotelbed9.jpg");
						else this.showPersonX("tinahotelbed10.jpg");
						break;
					case "stage6":
						this.showPerson("tinahotelbed12.jpg");
						break;
					case "stage7":
						this.showPersonRorX("tinahotelbed13.jpg");
						break;
					case "stage8":
						if (!isExplicit()) this.showPerson("tinahotelbed13.jpg");
						else this.showPersonX("tinahotelbed14.jpg");
						break
				}
				addPlaceTitle(md, "Fun with Dr. Tina");
				switch (stage) {
					case "stage1":
						md.write("<p>As you reach the bed you see that Tina is now just in her lingerie and holding a tub of lube \u2013</p>" + "<p>\u201cI hoped you would be paying me a visit to me tonight so I have prepared myself on the off chance you would come.\u201d</p>" + "<p>As you reach the bed and settle down next to her she hurriedly puts the jar away.</p>");
						startQuestionsOnly();
						addLinkToPlaceC(md, "go another round", Place, "type=drtinafunmale&stage=stage2");
						break;
					case "stage2":
						md.write("<p>Having put the jar away she quickly hooks your jeans down and starts to suck rapidly\u2026 the prospect of what is to follow meaning that in no time at all you are ready for the first part of proceedings.</p>");
						startQuestionsOnly();
						addLinkToPlaceC(md, "go more", Place, "type=drtinafunmale&stage=stage3");
						break;
					case "stage3":
						md.write("<p>With little ceremony and great speed you find that you are both naked and that Tina has jumped on top of you.</p>" + "<p>As you lose yourself in the pleasure of the moment you let Tina take control and before long she has you kneeling on the bed taking care of her every need.</p>");
						startQuestionsOnly();
						addLinkToPlaceC(md, "go more", Place, "type=drtinafunmale&stage=stage4");
						break;
					case "stage4":
						md.write("<p>On any normal day you would quite happily continue like this for the whole time but you cannot help but have you mind wander back to the little jar and what Tina has prepared for you.</p>" + "<p>With a sense of anticipation you slowly pull back and lie back on the bed and savour the moment as Tina finally offers herself to you completely.</p>");
						startQuestionsOnly();
						addLinkToPlaceC(md,
							"go more", Place, "type=drtinafunmale&stage=stage5");
						break;
					case "stage5":
						md.write("<p>With a gasp she lowers herself gently onto you again giving herself to you entirely. As she slowly gets used to the feeling she suggests that you should once again take charge.</p>" + "<p>Never being one to refuse the wish of a lady you take her at her word and spin her around before starting in earnest in taking your pleasure with her.</p>");
						startQuestionsOnly();
						addLinkToPlaceC(md, "go more", Place, "type=drtinafunmale&stage=stage6");
						break;
					case "stage6":
						md.write("<p>As you continue to couple like a pair of rabbits you realise that you won\u2019t be able to continue for much longer at this pace.</p>" + "<p>Realising that you won\u2019t hold out much longer Tina pulls off you and lays herself out beneath you.</p>");
						startQuestionsOnly();
						addLinkToPlaceC(md, "go more", Place, "type=drtinafunmale&stage=stage7");
						break;
					case "stage7":
						md.write("<p>With a feeling of bliss you feel you orgasm approaching and cum all over her face.</p>");
						startQuestionsOnly();
						addLinkToPlaceC(md, "go more", Place, "type=drtinafunmale&stage=stage8");
						break;
					case "stage8":
						md.write("<p>As you finish she starts to clean up having swallowed as much as she can.</p>" + '<p>"So are you staying with me tonight ' + perYou.getPersonName() + ' or do you have other things to do?"</p>');
						startQuestionsOnly();
						addLinkToPlaceC(md, "talk more to Tina", Place);
						break
				}
				WritePlaceFooter(md);
				return true
			}
			if (sType == "drtinafunfemale") {
				md = WritePlaceHeader(false, stage == "stage4" ? "" : "td-left-med");
				switch (stage) {
					case "stage1":
						this.showPerson("tinahotelbedalt1.jpg");
						break;
					case "stage2":
						this.showPerson("tinahotelbedalt2.jpg");
						break;
					case "stage3":
						this.showPerson("tinahotelbedalt3.jpg");
						break;
					case "stage4":
						this.showPerson("tinahotelbedalt4.jpg");
						break;
					case "stage5":
						this.showPerson("tinahotelbedalt5.jpg");
						break;
					case "stage6":
						this.showPerson("tinahotelbedalt6.jpg");
						break
				}
				addPlaceTitle(md, "Fun with Dr. Tina");
				switch (stage) {
					case "stage1":
						md.write("<p>You are both on the bed and help each other to rapidly strip off all of your clothes.</p>");
						startQuestionsOnly();
						addLinkToPlaceC(md,
							"go another round", Place, "type=drtinafunfemale&stage=stage2");
						break;
					case "stage2":
						md.write("<p>You feel yourself getting wetter and wetter with anticipation as she finally pulls your shorts all the way off whilst massaging your butt.</p>");
						startQuestionsOnly();
						addLinkToPlaceC(md, "go more", Place, "type=drtinafunfemale&stage=stage3");
						break;
					case "stage3":
						md.write("<p>With minimal ceremony Tina pushes you back on the bed and starts to lap away at your pussy, sending your mind into overdrive.</p>");
						startQuestionsOnly();
						addLinkToPlaceC(md, "go more", Place, "type=drtinafunfemale&stage=stage4");
						break;
					case "stage4":
						md.write("<p>Before too long you decide it is only fair to return the favour so slide yourself down the bed so that you can get a taste straight from the source.</p>");
						startQuestionsOnly();
						addLinkToPlaceC(md, "go more", Place, "type=drtinafunfemale&stage=stage5");
						break;
					case "stage5":
						md.write("<p>Before too long you are scissoring with each other and things are rapidly coming to a head..</p>");
						startQuestionsOnly();
						addLinkToPlaceC(md, "go more", Place, "type=drtinafunfemale&stage=stage6");
						break;
					case "stage6":
						md.write("<p>As you finally feel the pressure building up inside Tina spins you up onto your hands and knees and with a combination of adroit fingers and nimble tongue brings you to a shuddering climax.</p>" + '<p>"So are you staying with me tonight ' + perYou.getPersonName() + ' or do you have other things to do?"</p>');
						startQuestionsOnly();
						addLinkToPlaceC(md, "talk more to Tina", Place);
						break
				}
				WritePlaceFooter(md);
				return true
			}
		}
		if (Place == 269 && sType == "drtinapool") {
			WaitHereOnly(4);
			md = WritePlaceHeader();
			this.showPerson("tinapool.jpg");
			addPlaceTitle(md, "Swimming with Tina");
			md.write("<p>You ask Tina is she is interested in a swim, and she enthusiastically agrees, and meets you near one of the seats at the edge of the pool</p>");
			startQuestions();
			addLinkToPlaceC(md, '"let\'s have some more fun"', Place, "type=drtinapoolsex");
			addLinkToPlaceC(md, "return to the hotel room", 181);
			WritePlaceFooter(md);
			return true
		}
		if (Place ==
			269 && sType == "drtinapoolsex") {
			md = WritePlaceHeader();
			this.showPerson("tinapoolsex.jpg");
			addPlaceTitle(md, "Pool Fun with Tina");
			md.write("<p>The seating is quite private so you suggest some more 'intimate' fun. Of course Tina agrees!</p>");
			startQuestions();
			addLinkToPlaceC(md, "return to the hotel room", 181);
			WritePlaceFooter(md);
			return true
		}
		if (Place != 69) return false;
		if (sType == "followntina") {
			md = WritePlaceHeader();
			setPlaceKnown("NursesOffice");
			this.showPerson("tinasch1a.jpg");
			addPlaceTitle(md, "Other School Nurse");
			md.write("<p>You reach the door just in time before she can close it.</p>" + "<p>She looks you up and down with a puzzled expression as there is evidently nothing wrong.\t</p>" + '<p>"Who are you?", she asks.</p>');
			startQuestions();
			addLinkToPlaceC(md, "you tell her your name", Place, "type=followntina2");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "followntinalater") {
			md = WritePlaceHeader();
			this.showPerson("tinasch1a.jpg");
			addPlaceTitle(md, "Other School Nurse");
			md.write("<p>You open the door and you see the nurse, or is it doctor, standing there with a puzzled expression as there is evidently nothing wrong.</p>" +
				'<p>"Who are you?", she asks.</p>');
			startQuestions();
			addLinkToPlaceC(md, "you tell her your name", Place, "type=followntina2");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "followntina2") {
			md = WritePlaceHeader();
			this.setFlag(2);
			this.showPerson("tinasch2a.jpg");
			addPlaceTitle(md, "Other School Nurse");
			md.write('<p>"' + perYou.getPersonName() + '" you reply, and ask what is she doing here, Catherine is the school nurse.</p>' + "<p>She moves to close the door and have you leave again as there is nothing wrong with you.</p>" +
				"<p>Again you ask about Catherine and if she is replacing your friend. She smiles,</p>" + "<p>\u201cI\u2019m Dr. Kay, Katrina Kay, though my friends normally call me Tina. Catherine asked me to cover for her as a favour.\u201d</p>");
			startQuestions();
			addLinkToPlaceC(md, "leave her", 70, "", "As you stand there puzzling over Catherine's absence she shuts the door on you leaving you standing in the hallway.</p><p>You realise that you will have to go and find her at the hospital, unless you can speak to Catherine in the meantime in the hope that she can give you any idea as to where to find her.");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "doctortinacharm1") {
			md = WritePlaceHeader();
			this.showPerson("tinasch2c.jpg");
			addPlaceTitle(md, "Tina Under a Charm Spell");
			md.write("<p>You recite the spell as quietly as you can and Doctor Kay reacts mildly. Her eyes do not change, but something definitely happened, she must be under the spell.</p>" + "<p>Do you want to push her or ease her in by making her think you are here for a check up?</p>");
			startQuestions();
			addLinkToPlaceC(md, "push her", Place, "type=doctortinacharmpush1");
			addLinkToPlaceC(md, "check-up", Place, "type=doctortinacharmexam1");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "doctortinacharmpush1") {
			md = WritePlaceHeader();
			this.charmThem(4);
			this.showPerson("tinasch3b.jpg");
			addPlaceTitle(md, "Tina Under a Charm Spell");
			md.write("<p>You concentrate hard and explain the new state of play to her.</p>" + '<p>"Strip for me Tina, embrace your new inner self"</p>');
			startQuestions();
			addLinkToPlaceC(md, "further", Place, "type=doctortinacharmpush2");
			WritePlaceFooter(md);
			return true
		}
		if (sType ==
			"doctortinacharmpush2") {
			md = WritePlaceHeader();
			this.showPerson("tinasch3c.jpg");
			addPlaceTitle(md, "Tina Under a Charm Spell");
			md.write('<p>You tell her, "Keep going, be my obedient nurse."</p>');
			startQuestions();
			addLinkToPlaceC(md, "further still", Place, "type=doctortinacharmpush3");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "doctortinacharmpush3") {
			md = WritePlaceHeader(false, perYou.isMaleSex() && isExplicit() ? "td-left-med" : "");
			if (perYou.isMaleSex() && isExplicit()) this.showPersonX("tinasch3e.jpg");
			else this.showPerson("tinaschalt3.jpg");
			addPlaceTitle(md, "Tina Under a Charm Spell");
			md.write("<p>As you tire of watching you decide you cannot wait any longer and bend her over.</p>" + '<p>You tell her, "How do you like your new role Tina, my assessment won\'t take long."</p>');
			startQuestions();
			addLinkToPlaceC(md, '"Roll Over"', Place, "type=doctortinacharmpush4");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "doctortinacharmpush4") {
			md = WritePlaceHeader(false, perYou.isMaleSex() && isExplicit() ? "td-left-med" : "");
			if (perYou.isMaleSex() && isExplicit()) this.showPersonX("tinasch3f.jpg");
			else this.showPerson("tinaschalt2.jpg");
			addPlaceTitle(md, "Tina Under a Charm Spell");
			md.write("<p>As you instructed Tina rolls over...</p>");
			startQuestions();
			addLinkToPlaceC(md, "just one more nudge", Place, "type=doctortinacharmpush5");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "doctortinacharmpush5") {
			md = WritePlaceHeader(false, perYou.isMaleSex() && isExplicit() ? "td-left-med" : "");
			if (perYou.isMaleSex() && isExplicit()) this.showPersonX("tinasch3g.jpg");
			else this.showPerson("tinaschalt1.jpg");
			addPlaceTitle(md,
				"Tina Under a Charm Spell");
			md.write("<p>As she loses herself further and further into your power you know you cannot last long.</p>" + "<p>Suddenly you spin her round and face her.</p>" + '<p>You tell her, "What a wonderful find you are Tina. One of these days I may have to find another job for you or take you home."</p>' + '<p>She replies, "Thank you ' + perYou.getMaster() + ', if I am not working here or at the Hospital you can find me at the hotel or at my evening job".</p>' + "<p>As you return to the school corridor you wonder what she meant by \u201cEvening Job\u201d</p>" +
				"<p><b>No more content in this release</b></p>");
			startQuestions();
			addLinkToPlaceC(md, "leave her for now", 70);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "doctortinacharmexam1") {
			md = WritePlaceHeader();
			this.charmThem(1);
			this.showPerson("tinasch3b.jpg");
			addPlaceTitle(md, "Tina Under a Charm Spell");
			md.write("<p>You realise you need an excuse in case anyone is in the corridor listening, and you need it fast...</p>" + '<p>"Well Tina, I am the head ' + perYou.getSex() + " and I've been asked to welcome you to the school.\"</p>");
			startQuestions();
			addLinkToPlaceC(md, 'Tina responds "Come In"', Place, "type=doctortinacharmexam2");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "doctortinacharmexam2") {
			md = WritePlaceHeader();
			this.showPerson("tinasch3c.jpg");
			addPlaceTitle(md, "Tina Under a Charm Spell");
			md.write("<p>As you step in Tina says,</p>" + "<p>\"Oh, I've heard all about you from Catherine, she's told me what to expect and I am looking forward to it.\"</p>" + "<p>Even though you are certain you hit her with the charm this seems a little odd. She seems to be stripping of her own volition.</p>" +
				"<p>Puzzled you ask:</p>" + "<p>\u201cWhat do you mean: \u201dLooking forward to it?\u201d Do you mean you wanted this?\u201d</p>");
			startQuestions();
			addLinkToPlaceC(md, "she replies...", Place, "type=doctortinacharmexam3");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "doctortinacharmexam3") {
			md = WritePlaceHeader();
			this.showPerson("tinasch3i.jpg");
			addPlaceTitle(md, "Tina Under a Charm Spell");
			md.write('<p>She tells you, "Why do you think I was slow shutting the door ' + perYou.getPersonName() + '."</p>' + "<p>Before you can adjust you see she has stripped down and moves in front of you.</p>");
			startQuestions();
			addLinkToPlaceC(md, "Tina continues", Place, "type=doctortinacharmexam4");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "doctortinacharmexam4") {
			md = WritePlaceHeader(false, perYou.isMaleSex() && isExplicit() ? "td-left-med" : "");
			if (perYou.isMaleSex() && isExplicit()) this.showPersonX("tinasch3d.jpg");
			else this.showPerson("tinaschalt1.jpg");
			addPlaceTitle(md, "Tina Under a Charm Spell");
			md.write("<p>As she steadies herself in front of you you wonder what hidden agenda she might have, but as Tina gets to work you cease wondering and just sit back and relax.</p>" +
				"<p>\u201cThat's wonderful. And you say Catherine put you up to this?\u201d</p>" + "<p>Tina lifts her head and looks you in the eye.</p>");
			startQuestions();
			addLinkToPlaceC(md, "Tina continues", Place, "type=doctortinacharmexam5");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "doctortinacharmexam5") {
			md = WritePlaceHeader(false, perYou.isMaleSex() && isExplicit() ? "td-left-med" : "");
			if (perYou.isMaleSex() && isExplicit()) this.showPersonX("tinasch3e.jpg");
			else this.showPerson("tinaschalt2a.jpg");
			addPlaceTitle(md, "Tina Under a Charm Spell");
			md.write("<p>Slowly she turns around.</p>" + '<p>"Oh, she told me everything, and I have been looking forward to this".</p>' + "<p>With that she slides back to you with a satisfied grin on her face.</p>" + "<p>As she turns around you notice the signet ring on her finger and wonder just how much of this is forced and how much is voluntary. Not that that is very important as you are far too preoccupied at this moment in time.</p>");
			startQuestions();
			addLinkToPlaceC(md, "Tina continues", Place, "type=doctortinacharmexam6");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "doctortinacharmexam6") {
			md = WritePlaceHeader(false, perYou.isMaleSex() && isExplicit() ? "td-left-med" : "");
			if (perYou.isMaleSex() && isExplicit()) this.showPersonX("tinasch3f.jpg");
			else this.showPerson("tinaschalt2.jpg");
			addPlaceTitle(md, "Tina Under a Charm Spell");
			md.write("<p>As she feels you tensing up she jumps turns around for a final flourish.</p>");
			startQuestions();
			addLinkToPlaceC(md, "Tina continues", Place, "type=doctortinacharmexam7");
			WritePlaceFooter(md);
			return true
		}
		if (sType ==
			"doctortinacharmexam7") {
			md = WritePlaceHeader(false, perYou.isMaleSex() && isExplicit() ? "td-left-med" : "");
			if (perYou.isMaleSex() && isExplicit()) this.showPersonX("tinasch3g.jpg");
			else this.showPerson("tinaschalt3.jpg");
			addPlaceTitle(md, "Tina Under a Charm Spell");
			md.write("<p>You come to a shuddering conclusion and are waiting breathlessly.</p>" + "<p>As you are both starting to clear up and you start to be able to concentrate fully again in the aftermath of your tryst you realise she is still calling you by your first name.</p>" +
				"<p>As you get your breath back you decide you have to ask about the ring.</p>");
			startQuestions();
			addLinkToPlaceC(md, "ask Tina", Place, "type=doctortinacharmexam8");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "doctortinacharmexam8") {
			md = WritePlaceHeader(false, "td-left-med");
			if (perYou.isMaleSex() && isExplicit()) this.showPerson("tinasch3h.jpg");
			else this.showPerson("tinaschalt5.jpg");
			addPlaceTitle(md, "Tina Not Under a Charm Spell");
			md.write("<p>You finally corral your thoughts and ask her:</p>" + "<p>\u201cSo what happened there then?\u201d</p>" +
				"<p>She looks at you like the cat that got the cream and answers:</p>" + '<p>"I organised this with Catherine. My signet ring gave me protection so we both got what we wanted, and you still have me always but next time we meet you will have the same choice to make as you did with Catherine."</p>' + "<p>As you realise the import of her words you realise you haven\u2019t asked the key question:</p>");
			startQuestions();
			addLinkToPlaceC(md, "\u201cSo where will I find you?\u201d", Place, "type=doctortinacharmexam9");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "doctortinacharmexam9") {
			md = WritePlaceHeader();
			this.showPerson("tinasch3i.jpg");
			addPlaceTitle(md, "Tina");
			md.write('<p>Tina explains "I work shifts as a nurse covering both here to help Catherine and my main job at the hospital and am staying at the hotel until I can find somewhere better\u2026</p>' + '<p>And at night I do earn some money on the side; if you don\u2019t mind my continuing that line of work."</p>' + "<p>As you ponder these last statements you realise she has quietly slipped out the door and gone back to work around the school.</p>" +
				"<p>She should present a pleasant addition to your menagerie. Whilst you are unsure yet as to whether there is space for her at home you are fairly confident that you know where to find her at night even if she is not at the hotel or hospital.</p>" + "<p><b>No more content in this release</b></p>");
			startQuestions();
			addLinkToPlaceC(md, "leave her for now", 70);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "drtinafuck") {
			md = WritePlaceHeader(false, "td-left-med");
			if (perYou.isMaleSex() && isExplicit()) this.showPerson("tinasch3h.jpg");
			else this.showPerson("tinaschalt5.jpg");
			addPlaceTitle(md, "Getting a Check-up");
			md.write("<p>You ask Dr Tina for a checkup, and for a moment she looks concerned as the professional she is, but she quickly realises you mean something more intimate.</p>" + "<p>You thoroughly checkout, up and down, the body of the lovely doctor.</p>");
			startQuestions();
			addLinkToPlace(md, "talk more to Tina", Place);
			WritePlaceFooter(md);
			return true
		}
		return false
	};
	per.showPersonTextHere = function(md) {
		if (Place == 69)
			if (!this.isHere()) md.write("<p>It seems Dr. Kay is not here at the moment, then again the position of School Nurse is only part-time. She must be somewhere else.</p>");
			else md.write("<p>Dr. Tina Kay is here, ready to give you a checkup.</p>");
		else if (Place == 181 && this.isHere()) md.write("<p>You knock on the door of Tina\u2019s room and here her shout from inside to \u201ccome on in\u201d.</p>" + "<p>As you enter you see Tina kneeling on the bed getting her clothes ready for the next day.</p>")
	};
	per.showPersonChat = function(bGeneral, md) {
		if (Place == 69 && this.isHere() && this.isCharmed() && sType === "") addLinkToPlaceC(md, "ask Dr. Tina for a checkup", 69, "type=drtinafuck");
		else if (Place ==
			181 && this.isHere() && sType === "") {
			addLinkToPlaceC(md, "have some fun", Place, "type=drtinafun1");
			if (checkPlaceFlag("Hotel", 11)) addLinkToPlaceC(md, '"Let\'s go for a swim?"', 269, "type=drtinapool");
			addSleepLink(md, "go to bed for the night with Tina", "Sleeping with Tina", '<p style="position:absolute;left:5%;top:75%;cursor:pointer;font-size:1.1em;width:90%">' + "You lie down with Tina and settle down for what turns out to be a surprisingly good nights rest. When you wake in the morning you realise that you are lying in the bed alone and that Tina\u2019s uniform is no longer in the wardrobe\u2026 She must be on the early shift. Rousing yourself you dress and head back to the lobby.",
				this.getImg("tinahotelbedsleep.jpg"))
		}
	};
	per.handleItem = function(no, cmd) {
		if (no == 14 && cmd == 2) {
			if (Place == 69 && this.isHere()) {
				if (!this.checkFlag(2)) addComments("You do not know her name, the spell will not work!");
				else if (!isSpellKnown("Shielded Charm")) addComments("It is too public here, the door is open and students regularly pass by");
				else CastCharmSpell("DoctorKay", 69, 4, "type=doctortinacharm1");
				return "handled"
			}
			if (Place == 269 && this.isHere())
				if (!this.checkFlag(2)) addComments("You do not know her name, the spell will not work!")
		}
		return ""
	}
}

function initialiseDonna() {
	addPerson("Donna");
	per.whereNow = function() {
		return !isDay() && this.isCharmedBy() ? 185 : this.place
	};
	per.hoursSinceEvent = function() {
		return Math.floor((nTime - this.extra[0]) / 12)
	};
	per.isPersonInfo = function() {
		return this.isCharmedBy()
	};
	per.getPersonInfo = function() {
		return "<img src='Images/donna0.jpg' style='width:40%;float:right;margin-left:5px' alt='Donna'>" + "Donna became somewhat your friend over your visits. She shows deep sympathy and caring to you, but interestingly she looks as a very close friend and not as her " +
			perYou.getMaster() + " as everyone else do after you\u2019ve charmed them. Maybe she has such a strong will that it only affects her that much or does she have any magical powers that you don\u2019t know? You have to talk her about this.<br><br>" + 'Anyways,  she is good friend who even lets you make out with her. Deep inside you know if you\u2019d use your powers on her a second time she would most likely be turned into your slave, but you don\u2019t want that. It\u2019s nice to have a "friend" after all those obedient, determined to please you, loyal slaves you gathered. Sometimes she calls you ' +
			perYou.getMaster() + " as a foreplay for sex because she knows you like it and she\u2019s a hundred percent devoted to you just like the rest!<br><br>" + "Donna is waving at you by the pool. She gives you kisses to both ears and asks you if you have the time to chit-chat with her."
	};
	per.addPersonPhoneCall = function() {
		if (!this.isCharmedBy()) return false;
		if (isShopOpen(4, 0, true) && !this.checkFlag(3)) {
			var perJenny = findPerson("Jenny");
			if (perJenny.isCharmedBy("You") && Place != 196 && Place != 269 && Place != 185 && !(wherePerson("MissLogan") ==
					196 && getPersonOther("MissLogan") == 1)) {
				var nt = this.hoursCharmed();
				var jt = perJenny.hoursCharmed();
				if (nt > 48 && jt > 48)
					if (makeCall(true, 120)) this.setFlag(3)
			}
		}
		if (this.checkFlag(6) && !this.checkFlag(4) && this.hoursSinceEvent() > 12 + Math.ceil(Math.random() * 6))
			if (makeCall(true, 121)) {
				this.setFlag(4);
				this.extra[0] = nTime
			}
		if (this.checkFlag(4) && !this.checkFlag(5) && this.hoursSinceEvent() > 12 + Math.ceil(Math.random() * 6))
			if (makeCall(true, 122)) {
				this.setFlag(5);
				this.extra[0] = nTime
			}
		return false
	};
	per.getPersonSMS = function(id) {
		switch (id) {
			case 120:
				return receiveSMS("Donna",
					"Hey there lover" + perYou.getSex() + "! Meet me at the restaurant for a good time\u2026also wanted to talk to you. Ive seen this girl Jenny shes looking hot! Dont keep me waitin\u2026xoxo");
			case 121:
				return receiveSMS("Donna", "Boy that was fun!i like you soo much buddy;P.we have to repeat this again, a friendly get together, right? PS can I borrow Jenny for a while? I could use an ass like hers\u2026:P") + replyToSMS(" sure thing; just dont break her\u2026:DD");
			case 122:
				return receiveSMS("Donna", "Jenny is great\u2026.shes helping around the house\u2026:P I can understand why youre sooo fond of your slaves. Anyway, love u and keep safe\u2026:)",
					"donna-jenny sms.jpg", "88%")
		}
		return ""
	};
	per.showEvent = function() {
		var md;
		if (Place == 185 || Place == 269)
			if (sType == "enjoy") {
				md = WritePlaceHeader(false, isDay() ? "" : "td-left-med");
				if (isDay()) this.showPerson("donna5.jpg");
				else if (perYou.isMaleSex()) this.showPerson("donna9b.jpg");
				else this.showPerson("donna9g.jpg");
				addPlaceTitle(md, "Donna");
				md.write("<p>Donna prepares herself for you. Her body is firm and ripe for you to use however you like.</p>");
				startQuestions();
				addLinkToPlaceC(md, "talk to Donna?", Place);
				WritePlaceFooter(md);
				return true
			}
		if (Place != 196 || !isShopOpen(4, 0, true)) return false;
		if (this.checkFlag(3) && !this.checkFlag(6) && wherePerson("Jenny") == 196 || sType == "donna0") {
			md = WritePlaceHeader();
			this.setFlag(6);
			this.extra[0] = nTime;
			setQueryParams("type=donna0");
			var perJenny = findPerson("Jenny");
			perJenny.showPerson("jenny10.jpg");
			addPlaceTitle(md, "A Reservation?");
			md.write("<p>You open the windowed door that serves as the entrance to the Bavaria Hut and look for Donna. " + "Jenny jumps at you spooking you a bit, because in your hurry you forgot that she\u2019s always standing next to the entrance, waiting for new customers to serve. However, this customer is her " +
				(perYou.isBornMale() ? "Lord and Master" : "Lady and Mistress") + " so the german waitress tilts her down, greeting you like a good servant.</p>" + '"Please follow me ' + perYou.getMaster() + '! Donna\u2019s been waiting for you at your private room!", she\u2019s talking about the VIP room you own at back of the restaurant.</p>' + "<p>Jenny escorts you rocking her hip seductively while you check out her booty from the back. As you arrive she poses for your viewing pleasure.</p>");
			startQuestions();
			addLinkToPlace(md,
				"enter the room", 196, "type=donna1");
			WritePlaceFooter(md);
			return true
		} else if (sType == "donna1") {
			md = WritePlaceHeader();
			this.showPerson("donna-resto1.jpg");
			addPlaceTitle(md, "Donna at the Restaurant");
			md.write("<p>Jenny closes the door to your very own private room where you usually spend your dinner. She makes sure it is closed and puts the key away then she marches to a narrow wall part that is between two windows that lights up the room and awaits further commands.</p>" + "<p>You see Donna on the restaurant\u2019s table sitting in a casual attire that consists of a simple jeans and a blouse.</p>" +
				'<p>"Finally! I\u2019ve been waiting for you!", she tells you. You come close to her and end up hugging your friend.</p>');
			startQuestions();
			addLinkToPlaceC(md, '"It\u2019s nice to see you too! What have you been up to?"', 196, "type=donna2");
			WritePlaceFooter(md);
			return true
		} else if (sType == "donna2") {
			md = WritePlaceHeader();
			this.showPerson("donna-resto2.jpg");
			addPlaceTitle(md, "Donna at the Restaurant");
			md.write("<p>You ask Donna how she has been while you sit down to the closest chair. The room is filled with antique paintings, chairs and a big, old fashioned table where at least twelve people could sit and eat.</p>" +
				'<p>"Not much, I can\u2019t stop thinking about you! I can\u2019t even finish that lame book I\u2019ve been reading without stopping at every page. I daydream of having you there, with me, talking funny like you usually do!", she\u2019s referring to Pride and Prejudice she was reading when you first met her. Donna gently pushes her chest thus making the upper buttons on her blouse tears apart revealing her two nipples wide open to you.</p>');
			startQuestions();
			addLinkToPlaceC(md, '"I thought you were a typical uptown girl who doesn\u2019t talk to people like me."',
				196, "type=donna3");
			WritePlaceFooter(md);
			return true
		} else if (sType == "donna3") {
			md = WritePlaceHeader();
			this.showPerson("donna-resto3.jpg");
			addPlaceTitle(md, "Donna at the Restaurant");
			md.write("<p>You jokingly imitate a british oldschool accent as you ask her. She looks at angrily and slaps your chest with her hands.</p>" + '<p>"Haha, very funny ' + perYou.getPersonName() + '! You know I was\u2026 before I met you!", she playfully pats your face. After that Donna looks at Jenny questioningly, who is still standing at her place hands behind her back.</p>');
			startQuestions();
			addLinkToPlaceC(md, '"Don\u2019t worry. She\u2019s mine! She serves me."', 196, "type=donna4");
			WritePlaceFooter(md);
			return true
		} else if (sType == "donna4") {
			md = WritePlaceHeader();
			this.showPerson("donna-resto4.jpg");
			addPlaceTitle(md, "Donna at the Restaurant");
			md.write("<p>You casually explain about Jenny to Donna. Jenny looks straight at one point on the dining table without ever looking up or glancing aside to you or Donna. She doesn\u2019t want to disturb your time with your friend. How thoughtful of her! Meanwhile Donna opens her blouse and gets rid of it quickly. She\u2019s doing the same with her jeans too!</p>" +
				'<p>You tell her "Now we are talking! Donna, you are one horny girl and I like that in you!", you say it again with that crappy english noble accent.</p>' + "<p>The redhead girl teases you by pulling some of her fiery red hair to hide her nipple.</p>" + '<p>"Honey, It\u2019s in my blood! Oohh\u2026 I forgot about my panty\u2026Whoops!" with a single action she\u2019s out of that red thong and smirks at you coyly.</p>');
			startQuestions();
			addLinkToPlaceC(md, '"I do have to admire your passion for getting rid of your clothes so fast!"',
				196, "type=donna5");
			WritePlaceFooter(md);
			return true
		} else if (sType == "donna5") {
			md = WritePlaceHeader();
			this.showPerson("donna-resto5.jpg");
			addPlaceTitle(md, "Donna at the Restaurant");
			md.write('<p>"' + perYou.getPersonName() + ', stop talking that much\u2026 and live the moment!", Donna whispers while making glances at Jenny. She puts a finger to your mouth, shutting you up for the rest of the time while you two are together.</p>' + '<p>"How about a little somethin\u2019 for my oh so tired and weary hero?" Donna continues to seduce you and your feelings. You wish you could take her right here right now, but she\u2019s your friend. Donna would be more than willing to have you fuck her, but you don\u2019t want that. You are afraid that if you would have sex with her, your power would drastically grow over her making her a slave like the rest. So you can only have these peepshows without worrying you would control her too much.</p>');
			startQuestions();
			addLinkToPlaceO(md, "You nod your head signaling her to finish what she started.", 196, "type=donna6");
			WritePlaceFooter(md);
			return true
		} else if (sType == "donna6") {
			md = WritePlaceHeader();
			this.showPerson("donna-resto6.jpg");
			addPlaceTitle(md, "Donna at the Restaurant");
			md.write("<p>She zealously shows you her pussy and ass even motioning you to touch them. She gives in all she got, you clearly see her whole body tightens for your viewing pleasure.</p>" + "<p>Ten minutes later, after you had your fun with her you tell Donna to get dressed and thank her for her friendship. She gives you a kiss on your lips and smilingly waves you away so she put her clothes back. You leave with Jenny at your side. Your very own waitress hugs and escorts you out of the Cafe. She goes back to work and you turn to back to the important matters at hand. You start to like these private sessions with Donna more each time you visit! She\u2019s a keeper and a close friend!</p>");
			startQuestions();
			addLinkToPlace(md, "exit the restaurant", 194);
			WritePlaceFooter(md);
			return true
		}
		return false
	}
}

function initialiseEllie() {
	addPerson("Ellie", 225);
	per.charmThem(1, "Davy");
	per.getPersonName = function(full) {
		if (full === true) return "Ellie Bartel";
		if (this.isCharmedBy("You")) {
			if (this.getCharmedLevel() == 4) return "Slave Ellie";
			return "Ellie, your lover"
		}
		return "Ellie"
	};
	per.getPersonAddress = function() {
		return checkPlaceFlag("DervishRd", 3) ? "12 Dervish Rd, Glenvale" : ""
	};
	per.whereNow = function() {
		if (this.isCharmedBy("You") && (!isDay() || !isWeekDay())) return 422;
		if (Place == 422) return Place;
		if (Place == 430 && this.place ==
			430) return sType.indexOf("ellie") != -1 ? Place : 0;
		return this.place
	};
	per.isPersonInfo = function() {
		return true
	};
	per.getPersonInfo = function() {
		var s = "<img src='Images/ellie1a.jpg' class='imgpopup' alt='Ellie'>";
		if (!this.isCharmed() || !this.isCharmedBy("You")) return s + "You immediately recognise Ellie when you walk around the Bank. She was the prom queen back then in highschool when you were just a freshman. " + "She became the prom queen of her last year not necessarily out of her beauty (she's not bad looking, but not really the prom queen type of girl), but rather because of her charm and intelligence.<br><br>" +
			"She's the type of girl who is known by everyone and was the centre of attention on a regular basis. She attended a lot of competitions in maths and physics and done a lot of school sport races too. " + 'So it\'s rather obvious that the teachers became fond of her and she rose to fame as an example of the typical "perfect student". However, she was praised  and loved by the school students too, because she helped to keep the school community together by programmes and events. She was extremely nice to everyone and always offered help in any kind of need.<br><br>' +
			"You, on the other hand, had not really spoken to her too much, because she always was surrounded by friends or other people who were just buzzing around her. She never was quite alone and you were too shy to talk to her longer than a minute or two.<br><br>" + "Strangely, she kind of disappeared from the local scene after she finished high school. You haven't seen her in years yet, but her face gave her away quickly. She hasn't changed much!";
		else if (this.getCharmedLevel() == 2) return s + "Ellie turned out to be a great addition to your growing number of girlfriends: She is gentle, kindhearted, surprisingly submissive, and has absolutely no problem with you 'dating' other girls.<br><br>" +
			"Her time with Davy and the things he ordered her to do, however, has left a deep impression on the woman and you have decided to keep the spell binding her as light as possible to not hurt her further. She might be coerced to love you and is far more comfortable with sexuality, but still has much of her own free will, occasionally arguing with you and certainly not following every order you give her.<br><br>" + "You decided to keep it slow and let her pick the pace at which she wants to be intimate, which has often led to you spending the nights cuddling and talking rather then engaging in wild sexual escapades like you are used to by now. It's kinda a pleasant change of pace, though.<br><br>" +
			"Carol and Ellie had a strained relationship for a very long time thanks to Carols long time affair with Kristin, but with Ellies new views and your subtle 'help', the two of them have begun to make up.";
		else return s + "Ellie turned out to be a very submissive girl by nature and your spell only enforced this part of her personality as well as her already existing desire to submit to another person.<br><br>" + "She has fully devoted her life to you and your pleasure to the point that she even refers to herself in 3rd person and follows your orders without questioning and drawbacks. Well, most of them.<br><br>" +
			"You know her time with Davy has left a mark on her psyche, and while the charms effects help her to deal with what he did by filling her mind with blissful lust and obedience, you are well aware that there are a few things she will not be able and willing to do and make sure to avoid them as you find out.<br><br>" + "You have altered her personality just a little to get her to make up with her mother as well. The two of them had a strained relationship for far too long and you figured they will need to love each other again if they are to properly serve you."
	};
	per.passTimeDay = function() {
		if (this.isCharmedBy("You") && checkPersonFlag("Kristin", 10)) {
			var nd = Math.floor(nTime / 288) % 7;
			if (nd < 6) {
				if (this.isHere()) {
					this.place = 225;
					return this.addPersonFace() + "In the morning Ellie gives you a kiss and tells you she has to leave for her job at the Bank.</p>"
				}
				this.place = 225
			}
		}
		return ""
	};
	per.passTimeNight = function() {
		if (this.isCharmedBy("You") && checkPersonFlag("Kristin", 10)) {
			var nd = Math.floor(nTime / 288) % 7;
			if (nd < 6) this.place = 422
		}
		return ""
	};
	per.addPersonPhoneCall = function() {
		if (!this.isCharmedBy()) return false;
		if (!this.checkFlag(3) && isShopOpen(0)) {
			var perMT = findPerson("Mayor");
			if (perMT.checkFlag(4)) {
				var perAng = findPerson("Angela");
				if (!perAng.checkFlag(10)) {
					var perBatton = findPerson("OfficerBatton");
					var nt = this.hoursCharmed();
					var nm = perMT.hoursCharmed();
					if (perBatton.isCharmedBy("You") && perMT.isCharmedBy("You") && isCharmedBy("Kristin") && perMT.place === 110 && Place != 95 && Place != 110) {
						var nk = getPersonHoursCharmed("Kristin");
						var tm = 72 + Math.floor(Math.random() * 5);
						if (nt > tm && nm > tm && nk > tm)
							if (makeCall(true, 140)) this.setFlag(3)
					}
				}
			}
		} else if (this.getCharmedLevel() ==
			2 && getDay(true) == "Mon" && !this.checkFlag(7) && isDay() && getHour() > Math.floor(9 + 3 * Math.random()))
			if (makeCall(true, 141)) this.setFlag(7);
		return false
	};
	per.getPersonSMS = function(id) {
		switch (id) {
			case 140:
				return receiveSMS("Ellie", this.getYourNameFor() + "!  Kristin and I are at a meeting with the mayor and the " + getPoliceChief().toLowerCase() + "...Kristin says that you are invited too&#9786; Join us pretty please! It would be soo good to you again!") + receiveSMS("Angela", "Ps: Ellie is here too! She is such a cute girl! She and I have a lot in common!");
			case 141:
				return receiveSMS("Ellie", "I hate mondays, but seeing you at work lightens up my day a bit, so here's a little incentive for you to visit me.;)", "elliesms1.jpg") + receiveSMS("Ellie", "And if that's not enough:", "elliesms2.jpg")
		}
		return ""
	};
	per.showEventPopup = function() {
		if (sType !== "") return false;
		if (Place == 225) {
			if (!this.checkFlag(5)) {
				this.setFlag(5);
				this.showPersonInfo(mdCache);
				return true
			}
			if (isCharmedBy("Kristin") && !this.checkFlag(8)) {
				this.setFlag(8);
				showPopupWindow("Ellie is Distracted", "<img src='Images/ellie1a.jpg' class='imgpopup' alt='Ellie'>" +
					"You almost bump into Ellie as you leave Kristins Office, and it seems the teller had been completely absorbed by something on her phone.</p>" + "<p>You don't really catch anything of interest on the screen before she turns it off to apologize to you, but you do notice the way her eyes suddenly widen as if she just remembered something of great importance.</p>" + "<p>Her fingers constrict around the phone for a second before she seemingly calms herself with a breather. This might be the most nervous you've ever seen her.</p>" +
					"<p>\u201cI... uhm, I'm sorry, I just remembered... I have to really take care of something but will be right back if you... need anything.\u201d</p>" + "<p>She rushes off with a surprising burst of speed before you are even able to reply and it looks like she was dialing a number on her phone as she vanishes into the back of the bank.</p>" + "<p>When she returns, she tries her best to avoid looking at you, she still has her usual smile, but the way she carries herself looks... somewhat tense when you are around.</p>")
			}
		}
		return false
	};
	per.showEvent = function() {
		var md;
		if (Place == 95) {
			if (sType == "ellie2" || sType == "ellie2q1" || sType == "ellie2q2") {
				md = WritePlaceHeader();
				var q1 = getQueryParam("q1");
				var q2 = getQueryParam("q2");
				this.showPerson("trioeventellie2.jpg");
				addPlaceTitle(md, "Ellie");
				if (sType == "ellie2q1") md.write('<p>Ellie replied "Ohh, very much! Without you, we would probably be still on a warpath with each other. Luckily, you came along and changed both of our lives forever! At work, Kristin is still my boss who can use me for mostly anything, but at nights we visit each other\u2019s house for some "talk".", Ellie devilishly beams at you for a second.</p>');
				else if (sType == "ellie2q2") md.write('<p>Ellie replies, "Not much, apart that she was very secretive before your arrival. She wanted to do some business with our company and she visited the bank once or twice, but didn\u2019t stay for long. She asked money from us about a project she wanted to do, something that would rebuild certain parts of the town. Miss Thomas really wished to revive this community by building new parks and  central plazas. Modernization was her thing and she took that idea seriously. I don\u2019t know more, you should talk to her about this. After all, there are no taboos between you and your slaves..." Ellie protectively looks up to you, resting herself on the sofa.</p>');
				else md.write('<p>"You are right Ellie, I can do whatever I damn well please. Why are you here in the first place?", you dominantly lean on the nearbiest couch.</p>' + '<p>Ellie replies "Miss Kristin promoted me, I became her secretary. She needed one, after you charmed her she became obsessed serving you and your empire. She is busy managing the financials of the town and also consulting and planning on how she could help you expand and manage between the city walls without attracting audience. That\u2019s why she needed a confidante and chose me. I follow her everywhere she goes and handle her time management, her work schedule and of course, her personal needs!", her naughty smirk is dangerously affective on your sexual needs. You reply,</p>' +
					'<p>"Ohh, I see a hierarchy has already been developing between my slaves..."</p>' + '<p>Ellie happily answers "Yes ' + perYou.getMaster() + '! We do need some order, don\u2019t we? I mean you don\u2019t have time to deal with each and every one of your slaves so it was the logical thing to do. We run our lives normally and look after each other all while perfectly following your orders. In time we will know all about you and your preferences and will look for all your needs without you having to move a muscle.", Ellie stands up from the sofa and streches her legs, the black stockings she is wearing tightens a little.</p>');
				startQuestions();
				if (q1 != "asked") addLinkToPlaceC(md, '"How\u2019s Kristin? The two of you come along now?"', 95, q2 == "asked" ? "type=ellie3" : "type=ellie2q1&q1=asked&q2=" + q2);
				if (q2 != "asked") addLinkToPlaceC(md, '"What do you know about the mayor?"', 95, q1 == "asked" ? "type=ellie3" : "type=ellie2q2&q2=asked&q1=" + q1);
				WritePlaceFooter(md);
				return true
			}
			if (sType == "ellie3") {
				md = WritePlaceHeader();
				this.showPerson("trioeventellie3.jpg");
				addPlaceTitle(md, "Ellie");
				md.write('<p>You tell Ellie, "Thanks, my dear slave, for the talk. But I have to go now...", you step towards Mayor Thomas\u2019s office door, but Ellie interrupts you,</p>' +
					'<p>"' + perYou.getMaster() + ', don\u2019t you want to inspect what new skills I have to offer to you?", she doesn\u2019t even wait for your answer. Ellie lets loose her clothes, she unbuttons her grey vest while she continues talking.</p>' + '<p>"As I have said...it\u2019s been so long without you, ' + perYou.getLord() + ", My " + perYou.getMaster() + '. I have missed you with all my heart and body. You don\u2019t know how we, your slaves, long after you when you are not in our presence...", Ellie seems determined, yet there is clear craving in her voice. Her vest and shirt are no longer held together by the buttons revealing a blue bra to you.</p>');
				startQuestions();
				addLinkToPlaceC(md, '"I do know and understand Ellie"', 95, "type=ellie4");
				WritePlaceFooter(md);
				return true
			}
			if (sType == "ellie4") {
				md = WritePlaceHeader();
				this.showPerson("trioeventellie4.jpg");
				addPlaceTitle(md, "Ellie");
				md.write('<p>You tell Ellie, "I do know and understand Ellie. Those servants of mine can be a bit more persuasive...", Ellie holds your hands and leads you back to the couch in front of the sofa. She sits down and goes on what she\u2019s been doing.</p>' + '<p>"Thank you ' +
					perYou.getPersonName() + '! I promise to keep you entertained. Anyways, how do you like my new dress? Kristin wanted me to buy something fresh, to celebrate the beginning of my brand-new life!", her grin could melt steel. She drops both the shirt and vest, the next is the skirt.</p>');
				startQuestions();
				addLinkToPlaceC(md, '"It\u2019s...uhm...pretty nice!"', 95, "type=ellie5");
				WritePlaceFooter(md);
				return true
			}
			if (sType == "ellie5") {
				md = WritePlaceHeader();
				this.showPerson("trioeventellie5.jpg");
				addPlaceTitle(md,
					"Ellie");
				md.write('<p>You hesitantly reply, "It\u2019s...uhm...pretty nice! You\u2019ve got my approval!", you are searching for words as you are looking at your slave, who looks stunning in her underwear.</p>' + 'Ellie says, "Thank you! This is my only purpose, to help and serve you! You look a bit tired, let your mind go off a bit and just enjoy the view. This ass only wiggles for you!", she throws away her skirt too and lets you have a good look at her firm bottom. She cheekily asks,</p>' + '<p>How do you like them?", Ellie bounces her butt a bit and comes close to you. You can\u2019t take it anymore, you bite into her two round ass cheeks.</p>');
				startQuestions();
				addLinkToPlaceO(md, "sometime later", 95, "type=ellie6");
				WritePlaceFooter(md);
				return true
			}
			if (sType == "ellie6") {
				md = WritePlaceHeader();
				this.showPerson("trioeventellie6.jpg");
				addPlaceTitle(md, "Ellie");
				md.write('<p>You tell Ellie, "You keep yourself in good shape. I order you to be it that way.", you are like a child who can\u2019t enough of a good present.</p>' + '<p>Ellie happily replies "As my ' + perYou.getMaster() + " commands! Now that all those stress came out from you I think it is time to go and see your other slaves. Don\u2019t worry " +
					perYou.getMaster() + ', I will be waiting here outside!"</p>');
				startQuestions();
				addLinkToPlace(md, "you continue into the Mayor's office", 110);
				WritePlaceFooter(md);
				return true
			}
			if (!this.checkFlag(6) && (this.checkFlag(3) || checkPersonFlag("Angela", 10))) {
				md = WritePlaceHeader();
				var perAngela = findPerson("Angela");
				this.showPerson("trioeventellie1.jpg");
				addPlaceTitle(md, "Ellie and Angela");
				md.write("<p>Angela is sitting at her usual place, typing, and seems focused on her work. Not far away from her is Ellie, the bank teller, standing near a sofa that is for visitors or guests who have to wait when they want to visit the mayor. She is looking around inquisitively, watching the pictures, the computers and the furniture. She must be impressed by all the luxury and quality of the office.</p>" +
					"<p>You two share a long gaze which is finally broken when Ellie jumps between your arms, her hair brushing in your face and gives you a welcoming kiss. Ellie then tells you,</p>" + '<p>"Well, lookie here! If it ain\'t my darling! The others are already in office, waiting for you. But why should you hurry when we could be to ourselves for a bit. They can wait and I haven\u2019t seen you for a while! My body is ready to be used again!"</p>');
				startQuestions();
				addPopupLinkToPlaceC(md, '"Sorry babe, I don\u2019t have the time..."',
					110, "", "Ellie", "you tell her &quot;Sorry babe, I don\u2019t have the time\u2026 I\u2019m busy. Now be a good girl and wait here while I talk with your boss.&quot;<br><br>Ellie, almost bursting out in tears holds her hands together and bows at your order. She is definitely sad that you have turned her offer down, but she is just a slave, a nobody to you and you really don&rsquo;t have the time or mood to be in her company. You barge into the Mayor&rsquo;s round, elegant office with haste.");
				addLinkToPlaceC(md,
					'"You are right Ellie..."', 95, "type=ellie2");
				AddPeopleColumn(md);
				perAngela.showPerson("angela1d.jpg");
				WritePlaceFooter(md);
				return true
			}
		}
		if (Place != 430) return false;
		var clv = this.isCharmedBy("You") ? this.getCharmedLevel() : 0;
		if (this.place == 420 && clv === 0) this.place = 430;
		if (this.place == 430 && clv > 0) this.place = 422;
		if (sType === "visitellie") {
			md = WritePlaceHeader();
			this.showPerson("ellie3a.jpg");
			addPlaceTitle(md, this.getPersonName() + " In The Spare Room");
			if (this.isCharmedBy("Davy")) md.write("<p>This is a small guest room with basic furniture, a bed and side table and fitted wardrobe.</p><p>Ellie is sitting on the bed looking rather annoyed at you,</p>" +
				'<p>"I see you got here like <i>a bat out of hell</i>. Get out of here, I\'ll have Kristin call the police!"</p>');
			else md.write("<p>This is a small guest room with basic furniture, a bed and side table and fitted wardrobe.</p><p>Ellie is sitting on the bed looking puzzled as if she is trying to work something out. She looks up at you,</p>" + "<p>\"Hello didn't we just meet somewhere, sorry I have been very forgetful recently, it seems I can only vaguely remember some recent things. Odd I normally have a good memory.<br/>Ummm...you are a friend of Aunt.. I mean of Kristin's, I have not seen you at the Bank...or maybe...are you a customer?\"</p>");
			startQuestions();
			addLinkToPlace(md, "exit the house", 5);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "elliefreed") {
			md = WritePlaceHeader();
			this.showPerson("ellie3b.jpg");
			addPlaceTitle(md, this.getPersonName() + " In The Spare Room");
			if (getQueryParam("by") == "Tina") md.write("<p>Tina concentrates on Ellie and you feel the the mana powering the charm over Ellie flow from her into you.</p>");
			else md.write("<p>The ring glows as you clasp it in your fist and focus on the mana powering the charm over Ellie, absorbing it within moments.</p>");
			md.write("<p>Ellie looks startled, scanning the room in confusion.</p>" + '<p>"Where am I...? Is...is this Kristins place...?"</p>' + "<p>When she finally notices you, her eyes widen in shock. \"Who are you, didn't we meet somewhere... recently? \u201c It seems the memory slowly catches up with her and tears begin to form.\u201d Oh no... I did... he did... I'm so sorry!\u201d</p>" + '<p>She picks up a phone from a side table and then says "I\'m Sorry, but I need to go home, need to find out what happened... maybe see Kristin first."</p>' +
				"<p>Ellie is clearly confused and pays little attention to you, if you want to charm her, this might be the last chance you get before she returns home, making it much harder, if not impossible to get her.</p>");
			AddMana(5);
			this.unCharmThem();
			startQuestions();
			addLinkToPlace(md, "exit the house", 5);
			WritePlaceFooter(md);
			return true
		} else if (sType === "elliebj") {
			md = WritePlaceHeader(false, perYou.isMaleSex() || isExplicit() ? "td-left-large" : "");
			if (perYou.isMaleSex()) this.showPersonRorX("ellie19b.jpg");
			else this.showPersonRorX("ellie19g.jpg");
			if (clv == 4) addPlaceTitle(md, this.getPersonName() + " Showing Her Devotion");
			else addPlaceTitle(md, this.getPersonName() + " Showing Her Love");
			this.place = 422;
			if (clv == 4) {
				md.write("<p>You order your new slave to show her obedience and devotion. Ellie looks at you, unsure what you mean, but smiles as you remove your clothing and sit down on the bed.</p>");
				if (perYou.isBornMale()) md.write("<p>She kneels and takes over, pulling down your underwear and taking your cock and balls into her hands. She starts to lick along the entire length of your shaft, and you can tell she is no novice but also not all too practiced ether. Still, she is talented enough, and shows her somewhat playful nature as she pleases you.</p>" +
					"<p>You decide to enforce your dominance of her a little more, and while she is licking the head of your cock you firmly grasp her hair and make it clear she is to go deeper, as deep as she can. She tries to accommodate you, but she has definitely not done this before.</p>" + '<p>She manages to get a bit over half your length into her mouth and throat before you call out "Now swallow, Slave!" and cum into her throat. She gags a little, but manages to keep most of it inside, swallowing obediently and looking up at you, the smile returning to her face.</p>');
				else md.write("<p>She looks at you uncertain, hesitating until you reinforce your order and she finally kneels before the bed to nervously lick your pussy.</p>" + "<p>Well, at least for about 5 seconds, before she backs away and lowers her head in shame. \u201cY..your slave apologizes, mistress. But she is not a lesbian.... she can't do that.</p>" + "<p>Well, that was unexpected, you reach down and lift her chin to check her eyes, but she is clearly under your spell, you can feel your mana flowing through her body and see the pink shine in her eyes.</p>" +
					"<p>\u201cSlave Ellie.\u201d You speak firmly. You will do as you are told, and not question my orders.</p>" + "<p>The pink glow flares up and again, her head moves forward, but to your amazement, she again resists.</p>" + "<p>\u201cI... your slave really can't do this, mistress... It.... does not feel right...\u201d Her head slumps down again\u201d Sorry, mistress.\u201d</p>" + "<p>So, even with the spell in full effect, she has enough willpower to deny certain orders... you admit you are somewhat impressed, and decide to relent until you know more about this, telling her that she will not be required to serve you like this... for now.</p>");
				md.write('<p>"Slave Ellie, return to your home, I will visit you then once I am ready."</p>' + "<p>Ellie smiles and quickly puts on some of her clothing as she leaves the room, making sure you get a good view of her as she dresses.</p>")
			} else {
				md.write("<p>You move to make her lie down on the bed, but as you try to press your body against her, she suddenly recoils from your touch.</p>" + '<p>"Ouugh, I... just had a horrible vision of someone else...not you..."</p>' + "<p>You realize she still has some memories of Davy and suggest delaying this for a while, but she shakes her head.</p>" +
					'<p>"N...no, It\'s fine. Let me show you my love another way, instead."</p>' + "<p>She asks you to sit down and kneels before you, reaching out with both hands to open your pants, but once again recoils after a few seconds, looking both confused and embarrassed.</p>" + "<p>\u201cCome to think of it, Kristin might hear us.\u201d You finally interrupt her, realizing that she might still be fighting both your charm and the memories of her time as Davys slave in her subconsciousness.\u201c We might be taking this too fast, anyway, ");
				if (!perYou.isBornMale()) md.write("and you didn't even know you could fall for another woman until now, ");
				md.write("so we better give it some time.</p>" + "<p>Ellie still looks a little embarrassed, but also relieved, and quickly nods. You tell her that it's best if she returns home now and that you will meet her later.</p>" + "<p>Ellie smiles and quickly puts on some of her clothing, making sure you get a good view of her as she dresses. She kisses your cheek and waves goodbye as she leaves the room.</p>")
			}
			startQuestions();
			addLinkToPlace(md, "exit the house", 5);
			WritePlaceFooter(md);
			return true
		} else if (sType === "elliereturnhome") {
			md = WritePlaceHeader();
			this.showPerson("ellie20.jpg");
			addPlaceTitle(md, this.getPersonName() + " Returns Home");
			this.place = 422;
			if (clv == 4) md.write("<p>You decide that it is time for your slave to leave here, and order her to return home and wait for you there. She stands and you see her there naked before the window and she says,</p>" + '<p>"Yes ' + perYou.getMaster() + ' this slave will return to her home, and await your presence"</p>' +
				'<p>She starts to walk out, ignoring her clothing, and you tell her that she should get dressed. She smiles "Of course ' + perYou.getMaster() + '", and dresses. You sense something of her normal self shining through the slave personna, or is it act?. She finishes dressing and with a longing glance she leaves the room.</p>');
			else md.write("<p>You tell Ellie not here Kristin's home and she agrees that she should return home and wait for you there.</p>" + "<p>She stands and you see her there naked before the window smiling at you and she says,</p>" +
				'<p>"' + perYou.getPersonName() + ' I really should get dressed before I leave."</p>' + "<p>She turns around a little giving you a good show and then dresses quickly. She gives you a kiss on the cheek and waves goodbye as she leaves the room.</p>");
			startQuestions();
			addLinkToPlace(md, "exit the house", 5);
			WritePlaceFooter(md);
			return true
		} else if (sType.indexOf("ellie") != -1) {
			md = WritePlaceHeader();
			this.showPerson(sType + ".jpg");
			addPlaceTitle(md, this.getPersonName() + " Under a Charm Spell");
			if (sType === "ellie4") {
				md.write("<p>You recite the words of the spell and Ellie looks at you in surprise,</p>" +
					'<p>"I know those words, they are from a song Davy sung for me... but they make me feel..."</p>' + "<p>Her words trail off as the spell works itself into her mind and body again. She turns away from you, deep in thought, a soft sigh coming from her. The bank teller gives you a lovely view of her assets as she does so.</p>" + "<p>You are a little torn here, she is troubled by her time under Davy's influence and now you are doing the same to her. You " + (perYou.checkFlag(26) ? "could" : "can") + " make her your obedient little slave as Davy did, she is very cute and will be a delightful plaything." +
					(perYou.checkFlag(26) ? "You could also be gentler and convince her she has fallen in love with you dramatically, she will not be as obedient, but still yours and protected from Davy. It depends on what you want." : "") + "</p>");
				startQuestions();
				addLinkToPlaceO(md, "enslave Ellie", 430, "type=ellie5", "", "", "charmPerson('Ellie',4);");
				if (perYou.checkFlag(26)) addLinkToPlaceO(md, "charm Ellie", 430, "type=ellie5", "", "", "charmPerson('Ellie',2);")
			} else if (sType === "ellie5")
				if (clv == 4) {
					md.write('<p>You firmly tell Ellie "Forget about the song, it does not matter to you, all you need to do is listen to me and do what I ask you"</p>' +
						"<p>She stands up on the bed, but is shaken by the spell and needs to stretch to catch her balance,</p>" + '<p>"What do you mean, what <b>are</b> you asking me to do?"</p>' + '<p>You reply firmly "It does not matter what, you just want to do anything I ask, don\'t you?"</p>' + "<p>Your words almost pound into her and for a moment her ever present smile fades, she then hesitantly says,</p>" + '<p>"I do...not...think I barely know you...you are ' + perYou.getPersonName() + ' right..."</p>');
					startQuestions();
					addLinkToPlaceC(md,
						"ask her to strip", 430, "type=ellie6")
				} else {
					md.write('<p>You speak to her as she stands on the bed as if looking for the song. "Ellie, you should not worry about that song, but I can see how you are looking at me. Do you actually like me?"</p>' + '<p>Ellie looks at you curiously, "Well... I am feeling a bit... odd...');
					if (perYou.isBornMale()) md.write("but yes you are handsome");
					else md.write("and yes, you are beautiful... but I am not really into girls");
					md.write('..."</p><p>She looks at you more closely, and as the idea of you as a potential lover sinks into her mind, you reinforce it,</p>' +
						'<p>"You are  very cute yourself and I did not come here expecting you to fall in love with me, I mean love at first sight is something for romance novels."</p>' + '<p>She hesitates as you words sink in more, pulling in her lower lip before she replies, "Love at first sight..." and you see a blush pass across her face, or maybe a flush of arousal.</p>');
					if (!perYou.isBornMale()) md.write("<p>\u201cN... no.\u201d She suddenly shakes her head. \u201cI may have two mothers, and I really believe that you should love whoever you want... but I'm only into guys.</p>");
					startQuestions();
					addLinkToPlaceO(md, "increase her desire", 430, "type=ellie6")
				}
			else if (sType === "ellie6")
				if (clv == 4) {
					md.write("<p>Ellie looks at you in surprise and subconsciously takes off her top before suddenly covering herself with her last remaining willpower,</p>" + "<p>\"No, I don't think so! I barely know you, " + perYou.getPersonName() + '"</p>' + "<p>You focus on the magical link between you and Ellie, forcing your will on her and reply simply,</p>" + '<p>"You do not have to worry about these things, or think about anything other than obeying me, and you should not call me ' +
						perYou.getPersonName() + '"</p>' + '<p>She looks confused, the spell slowly taking its toll, "Why... what should I call you?"</p>');
					startQuestions();
					addLinkToPlaceC(md, 'you tell her "' + perYou.getMaster() + '"', 430, "type=ellie7")
				} else {
					md.write("<p>You focus on her and the magical link between you and Ellie, willing her to desire you more and more. She looks at you smiling,</p>" + '<p>"It is so strange how attractive you are. Well, do you like me too?"</p>' + "<p>She starts to tease you, removing parts of her clothes to give you a glimpse of her body and likely going much farther than she meant to under the influence of your spell. Her top soon flies off completely, and she is not wearing a bra.</p>" +
						"<p>There is only one real answer to her question, even if you do not really mean it, yet...</p>");
					startQuestions();
					addLinkToPlaceC(md, '"Yes, I love you"', 430, "type=ellie7")
				}
			else if (sType === "ellie7")
				if (clv == 4) {
					md.write('<p>She looks troubled, "' + perYou.getMaster() + " that's not right! That would mean I was some sort of servant...!\"</p>" + "<p>You reply firmly,</p>" + '<p>"No, that means you are my slave, who will obey me, doing anything I ask, anytime.<br>' + 'And now, my slave, you will strip!"</p>' + "<p>She lets herself fall back with a blissful gasp and removes her skirt, but still maintains some tiny measure of control, she almost whispers,</p>" +
						"<p>\"I wont't...I can't do some things, I know there was something I had to do, but I can't...hurt...\"</p>" + "<p>You see how troubled she is about some orders Davy had given her before and how there are some limits of what she will do, no matter what you say. You relent a little,</p>" + '<p>"I will never order you to harm another, that is not what I want from you as my slave. Obey me and only think of what I desire and my pleasure, and you will be happy as the slave you are."</p>' + '<p>She looks at you nervously, but your assurance seems to put her somewhat at ease as the spell washes away the last traces of doubt and resistance, a blissful smile forming on her lips "Yes, ' +
						perYou.getMaster() + '"</p>');
					startQuestions();
					addLinkToPlaceC(md, '"Prove your obedience"', 430, "type=ellie9")
				} else {
					md.write('<p>Ellie looks radiantly happy to hear this and  quickly replies "I love you too!"</p>' + "<p>Ellie smiles and lets herself fall back with a sigh to removes her skirt, giving you a good view of her panties. She looks at you, the arousal from the magic spell still working itself on her.</p>" + '<p>"Do you want to see more, my love?"</p>');
					startQuestions();
					addLinkToPlaceC(md, '"Yes, I do"',
						430, "type=ellie9")
				}
			else if (sType === "ellie9") {
				this.place = 422;
				if (clv == 4) {
					md.write("<p>Ellie drops the skirt and kneels there before you on the bed, almost naked and very beautiful, with a wide smile,</p>" + "<p>" + perYou.getMaster() + ' what can you slave do to prove her devotion?"</p>' + "<p>You are a little surprised, and pleased, at the way she addresses you. She seems to have completely adopted a slave attitude, referring to herself as a slave and not by name. You can see she is yours now, to do anything you like, as long as you do not cross a certain line and ever ask her to harm another person.</p>" +
						"<p>You look at your smiling slave and decide how to proceed,</p>");
					startQuestions();
					addLinkToPlaceO(md, "dominate her more", 430, "type=elliebj");
					addLinkToPlaceC(md, "tell her to return to her home and wait for you there", 430, "type=elliereturnhome")
				} else {
					md.write("<p>Playfully Ellie throws away her skirt and knees on the bed before you, nearly naked in all her Beauty and smiling as you admire her body.</p>" + "<p>She leans in and kisses you, but while you can feel the force of the spell still coursing though her and reinforcing her feelings, the actual kiss is brief and still hesitant.</p><p>");
					if (perYou.isBornMale()) md.write("\u201cI can't believe how quick I fell for you, my love...\u201d");
					else md.write("\u201cI'm actually in love with another woman...\u201d");
					md.write(" She whispers as she breaks the kiss and looks deeply into your eyes, desire and love filling her expression,</p>" + "<p>Shall we...here?</p>");
					startQuestions();
					addLinkToPlaceC(md, '"I need you now"', 430, "type=elliebj");
					addLinkToPlaceC(md, '"Not here, meet me at your home"', 430, "type=elliereturnhome")
				}
			}
			addLinkToPlace(md, "exit the house",
				5);
			WritePlaceFooter(md);
			return true
		}
		return false
	};
	per.handleItem = function(no, cmd) {
		if (no == 32) {
			var eNow = this.whereNow();
			if (cmd == 1) {
				if (Place == 421 && eNow === 421 || Place == 93 && eNow === 93 || Place == 430 && eNow === 430 && this.isCharmedBy("Davy") || Place == 423 && eNow == 423 || Place == 225 && eNow === 225 && this.isCharmedBy("Davy")) {
					examineSilverRingStart();
					addComments("<p>It seems to be reacting to Ellie's presence... getting warmer the closer you get.</p>" + "</td></tr></table>");
					return "handled"
				}
			} else if (cmd == 2)
				if (Place == 93 && eNow ===
					93) {
					useSilverRingStart();
					addComments("<p>You use the ring</p></td></tr></table>");
					dispPlace(93, "type=ellie10b");
					return "handled"
				} else if (Place == 421 && eNow === 421) {
				useSilverRingStart();
				addComments("<p>You clasp the ring with your fist. It glows and, within moments, it absorbs the mana powering the <i>charm</i> over Ellie.</p>");
				if (isInvisible()) addComments('<p>She looks very confused and before you can do anything, mutters,</p><p>"I know I had to hurt someone, I do not remember who."</p>');
				else addComments('<p>She looks very confused and before you can do anything, she steps over to you and slaps you hard, and then looks horrified,</p><p>"I\'m sorry, I do not know what came over me, I know I had to hurt someone, I do not remember who."</p>');
				addComments("<p>Tears come to her eyes and she runs back toward the park entrance.</p></td></tr></table>");
				AddMana(5);
				this.moveThem(420);
				return "refresh"
			} else if (Place == 430 && eNow === 430 && this.isCharmedBy("Davy")) {
				useSilverRingStart();
				addComments("<p>You use the ring</p></td></tr></table>");
				dispPlace(430, "type=elliefreed");
				return "handled"
			} else if (Place == 423 && eNow == 423) {
				useSilverRingStart();
				addComments("<p>You use the ring</p></td></tr></table>");
				dispPlace(423, "type=ellie22");
				return "handled"
			}
		} else if (no ==
			14 && cmd == 2)
			if (Place == 93)
				if (this.whereNow() == 93 && this.isCharmedBy("Davy")) {
					addComments("<p>You recite the spell, it fails, it seems she is under the effect of a charm spell by someone else.</p>");
					return "handled"
				} else {
					CastCharmSpell("Ellie", 93, 1, "type=ellie11");
					return "handled"
				}
		else if (Place == 421) {
			if (this.whereNow() == 421 && this.isCharmedBy("Davy") && isSpellKnown("Shielded Charm")) {
				addComments("<p>You recite the spell, it fails, it seems she is under the effect of a charm spell by someone else.</p>");
				return "handled"
			}
		} else if (Place ==
			423) {
			if (this.whereNow() == 423 && this.isCharmedBy("Davy")) addComments("<p>You recite the spell, it fails, it seems she is under the effect of a charm spell by someone else.</p>");
			else if (this.whereNow() == 423) CastCharmSpell("Ellie", 423, 1, "type=ellie23");
			else addComments("You read a spell.... but it fizzles.");
			return "handled"
		} else if (Place == 430) {
			if (this.whereNow() == 430) CastCharmSpell("Ellie", 430, 1, "type=ellie4");
			else addComments("You read a spell.... but it fizzles.");
			return "handled"
		}
		return ""
	}
}

function RepliesGypsy(nR) {
	var myName = per.getYourNameFor();
	if (nR == 52)
		if (perYourBody.NoItems < perYourBody.MaxItems)
			if (nMoney < 45) addComments("<p>\"I'm afraid you do not have enough, " + myName + '."</p>');
			else {
				AddCash(-45);
				perYourBody.PutItem(52);
				addComments('"Thank you very much, ' + myName + '." She says, taking your ' + sCurrency + "45 as you slip the quartz crystal into your backpack.")
			}
	else addComments("<p>\"Oh my my...  I'm afraid you don't have room for it.\"</p>");
	else if (nR == 54)
		if (perYourBody.NoItems < perYourBody.MaxItems)
			if (nMoney <
				20) addComments("<p>\"I'm afraid you do not have enough, " + myName + '."</p>');
			else {
				AddCash(-20);
				perYourBody.PutItem(54);
				perYou.setHolyWaterUses(3);
				addComments('"Thank you very much, ' + myName + '." She says, taking your ' + sCurrency + "20 as you slip the candles into your backpack.")
			}
	else addComments("<p>\"Oh my my...  I'm afraid you don't have room for it.\"</p>");
	else if (nR == 49)
		if (perYourBody.NoItems < perYourBody.MaxItems)
			if (nMoney < 20) addComments("<p>\"I'm afraid you do not have enough, " + myName + '."</p>');
			else {
				AddCash(-20);
				perYou.setHolyWaterUses(perYou.getHolyWaterUses() + 3);
				if (perYourBody.FindItem(49) === 0) perYourBody.PutItem(49);
				addComments('"Thank you very much, ' + myName + '." She says, taking your ' + sCurrency + "20 as you slip the bottle of holy water into your backpack.")
			}
	else addComments("<p>\"Oh my my...  I'm afraid you don't have room for it.\"</p>");
	else if (nR == 51)
		if (perYourBody.NoItems < perYourBody.MaxItems) {
			if (perYourBody.FindItem(60) === 0)
				if (nMoney < 100) addComments("<p>\"I'm afraid you do not have enough, " +
					myName + '."</p>');
				else {
					AddCash(-100);
					perYourBody.PutItem(60);
					addComments('"Thank you very much, ' + myName + '." She says, taking your ' + sCurrency + "100 as you put the book in your backpack.")
				}
		} else addComments("<p>\"Oh my my...  I'm afraid you don't have room for it.\"</p>");
	else if (nR == 53) {
		PlaceI(60, 345);
		addComments('<p>"Yes I do, check the book shelf over there"</p>')
	} else if (nR == 55) {
		setPersonFlag("Vampyre", 10);
		passTime(true, true);
		passTime(true, true);
		addComments('<p>"Yes I do of course many of the tales of the nosferatu come from the old country"</p>' +
			"<p>She talks at length about the old legends of vampires, many of which you are quite familiar but some are subtly different than you have heard from horror movies. Some interesting parts</p><ul>" + "<li>To kill them you need to be-head them or use a stake of hawthorn wood. She is unsure if there are any hawthorn trees in Glenvale..</li>" + "<li>Garlic is quite effective to ward them off, but it may only make some of the more powerful ones hesitate. And it is not just the smell..</li>" + "<li>Holy items can work, but need a strong spiritual link, just picking up a crucifix and waving it around will do little. An item of a person of strong-faith may work.</li>" +
			"<li>Holy water might help but more to enhance another item, like washing garlic to purify it</li>" + (isMurderPath() ? "<li>You can kill a vampyre using a stake of hawthorn wood, engraven with certain runes. Hawthorn can be found near the standing stones in the Wild Ranges, and she shows you the runic marks needed.</li>" : "") + '</ul><p>She speaks as if this is no legend but absolute fact. You query her a little more about whow she knows this so certainly, but she just smiles and gestures around her, and says, "Well I am a gypsy!"')
	} else if (nR ==
		80) {
		setPersonFlag("Pamela", 12);
		addComments('<p>"Yes I do, very much so, but you only seem to have half of it there. do you have the other part as well?"</p>')
	} else if (nR == 81) {
		setPersonFlag("Pamela", 13);
		addComments('<p>You tell her that you have the other part, but not on you. She eagerly asks "Where is it!"</p><p>She is very anxious to find this out, and you decide to not tell her for now. She looks angry and for a moment you are sure you saw her eyes flash a slight green colour</p>')
	} else if (nR ==
		82) {
		setPersonFlag("Pamela", 14);
		addComments("<p>You lie and claim you only found this part a while ago. She asks where you found it and you hesitate for a moment and then answer that it was in the graveyard. She does not look at all convinced.</p>")
	} else if (nR == 700) {
		setComments('<span onclick="ClearComments();dispPlace()" class="zoom-icon" style="color:black;top:0.5em;right:5%">&#215;</span><div class="conversebubble">');
		addComments('<img src="Images/items/tarotpapessereversed.jpg" style="width:30%;float:left;margin:0 10px 2em 10px">You ask Esmeralda if she knows about demonology and how to free someone from being enslaved by a demon,</p>' +
			'<p>"Yes and No, ' + myName + ', I know it can be done, but I do not walk the ways of the underworld. But let me give you a simple reading and see if the cards can help."</p>' + "<p>She passes you a deck of tarot cards and asks you to shuffle them and then cut the deck. You do and draw a card labeled 'La Papesse' and it is upside down. Esmeralda looks amused,</p>" + '<p>"That is a card from another deck, from the Tarot of Marseilles, it must have been accidentally mixed in, but this is still your card. Reversed, it means you should try a different approach and look for co-incidences. It can sometimes also encourage you to seek knowledge not intuition, but in an out of the ordinary way. Say someone knowledgeable but strange."</p>');
		setTimeout("var cdiv = document.getElementById('commentdiv');if (cdiv) {cdiv.style.top = '5vh';cdiv.style.maxHeight = '90vh';}", 10);
		setPersonFlag("Leanne", 9);
		movePerson("MsJones", 145);
		setPlaceKnown("FrenchClassroom")
	} else if (nR == 15701) {
		per.setFlag(9);
		addComments('<p>"Oh come now...  Must we go through this?" She asks. "After all that you have done, is it so hard to believe that a true psychic <i>may</i> actually exist?"')
	} else if (nR == 1711) {
		per.setFlag(1);
		addComments('<p>"Hemlock?" She asks, raising an eyebrow. "I am afraid I am not allowed to carry that within my ' +
			getShopStore() + '.  It usually grows in <i>wild</i> places, if one knows <i>where</i> to look."  She says, leaving you with a vague sense that she may have just given you a small hint.</p>')
	} else if (nR == 1712) {
		per.setFlag(2);
		addComments('<p>"Silver Dagger? What are you getting into?" She asks, then glances towards her crystal ball.</p><p>"Ah... I see.  We all must make our own decisions and live with our own choices.  But to answer your question, you may find both the dagger and the chalice at the Lady of our Heavenly Father catholic church, although not in the same place."</p><p>"Try the taxi." She says with a wink.</p>')
	} else if (nR ==
		1713) {
		per.setFlag(3);
		addComments('<p>"There are many places to find a human skull if one is a bit creative.", she says.</p><p>"One could try digging for one in the graveyard, or search a catacomb if you can find one...  Or perhaps a crypt.  But but be warned, some skulls are more valuable than others."</p>')
	} else if (nR == 1714) {
		per.setFlag(4);
		addComments('<p>"There are many magical talismans to protect you from any number of threats.", she says, beginning to gaze into her crystal ball.</p><p>"Interesting..." She says.  "There <i>is</i> an artifact nearby that would protect you...  ');
		if (perYou.getQuestAftane() < 10) addComments(' But something is actively hiding it from my sight." She says, disapointed.  I\'m afraid I can tell you no more."</p>');
		else if (perYourBody.FindItem(41) === 0) addComments(' And it would seem that your mentor has already offered it too you." She says smiling.  "I would take his offer if I were you."</p>');
		else if (perYourBody.FindItem(41) > 0) addComments(" And it would seem that you already have it...  The Aftane.  Best of luck, " + myName + ".  You're going to need it.\"</p>")
	} else if (nR ==
		1717)
		if (perYourBody.NoItems < perYourBody.MaxItems) {
			if (per.checkFlag(7))
				if (nMoney < 100) addComments("<p>\"I'm afraid you do not have enough, " + myName + '."</p>');
				else {
					AddCash(-100);
					per.setFlag(7, false);
					addComments('<p>"Here you are ' + myName + '." She says.  "Use its power wisely."</p>');
					perYourBody.PutItem(6)
				}
		} else addComments("<p>\"Oh my my...  I'm afraid you don't have room for it.\"</p>");
	else if (nR == 1718) {
		per.setFlag(8);
		addComments('<p>"Having demon problems, aren\'t we?" She asks almost amused as she gazes into her crystal ball.  "Yes.  I know of a relic, held within the walls of the Lady of Our Heavenly Father.  If a ' +
			perYou.getManWoman() + ' were to find a way to purify the artifact with holy water and then trick the demon into taking the locket of its own free will, it would bind the demon within." She says in a deep voice that echo\'s with power.  "But be warned.  It must be anointed <i>moments</i> before or your own <i>impurity</i> will render it powerless."</p>')
	}
	return true
}

function initialiseEsmeralda() {
	addPerson("Gypsy", 345, "Esmeralda");
	per.Replies = RepliesGypsy;
	per.showEventPopup = function() {
		if (Place == 345)
			if (!this.checkFlag(10)) {
				this.setFlag(10);
				showPopupWindow("Gypsy in the New Age " + getShopStore(true), "<img src='Images/People/Esmeralda/gypsy0.jpg' class='imgpopup' alt='Gypsy'>" + "The Fortune teller sits right in front of you as you look around her " + getShopStore() + ". Her mysterious appearance and her husky voice scares you a little. She seems to know you, you see it in her eyes that she is wondering about you. The place is all musky and you cannot really see much because of the dim light, but you recognise some of the items on the boards. Crystals, stones, magic powders, candles, crucifixes and all kind of occult things you could only think of! You even see a crytal ball, the one you saw in old horror movies where the witch used these balls to tell the future.<br><br>" +
					"You cannot really decide if this woman is a hoax or a real fortune teller. However, a strong feeling comes over you; <i>don\u2019t mess with her!</i><br><br>" + "The fortune teller starts to introduce herself to you.<br><br>" + '"Welcome, ' + perYou.getPersonName() + ". I've been waiting for you!\", her voice makes you tremble a bit. It seems otherwordly and distant.<br><br>" + '"My name is Esmeralda and I\'m going to help you find the answers you seek.", she continues, not lifting her heavy gaze from you.<br><br>' +
					'"Don\u2019t worry, I won\u2019t hurt you, at least for now\u2026I see you already have a question. Don\'t hesitate!", Esmeralda smiles vigorously.<br><br>' + "You collect your thoughts and put away your waning fears and approach her.");
				return true
			}
		return false
	}
}

function RepliesGabby(nR) {
	var perGabby = per;
	if (nR == 100) {
		this.setFlag(1);
		addComments('<table><tr><td style="vertical-align:top;width:20%"><img src="Images/Items/spiralpendant.jpg" style="width:95%;" alt="Pendant"></td><td><p>' + "You ask Gabby about the book on hypnosis from the library, she looks at you surprised,</p>" + '<p>"How did you know...well, I lost it, that is all. I paid the fine, but I do not see why you are interested."</p>' + "<p>You start to reply and you notice a small pendant she is wearing underneath her white top, a silver spiral. For an instant you feel a warmth, and know it is slightly magical. You decide it is best to leave off asking her anything more. She continues,</p>" +
			'<p>"We have a lot of work to get to, can you leave now?"</p>' + '<p>Your mother looks at her sternly, "Calm down Gabby ' + perYou.getHeShe() + " is just being curious, now " + perYou.getPersonName() + ' it is nice to see you but as she rudely said, we have work to do."' + "</td></tr></table>")
	} else if (nR == 101) {
		this.setFlag(1);
		perYou.setFlag(12);
		if (perBeasley.place == 1E3) perBeasley.place = 11;
		addComments('<table><tr><td style="vertical-align:top;width:20%"><img src="Images/Items/spiralpendant.jpg" style="width:95%;" alt="Pendant"></td><td><p>' +
			"You ask Gabby about the book on hypnosis on her desk, she looks at you startled,</p>" + '<p>"It is interesting, my family has always been in to the occult."</p>' + "<p>She glances at your mother and you notice the small pendant she is wearing underneath her white top, a silver spiral. For an instant you feel a warmth, and know it is slightly magical. You decide it is best to leave off asking her anything more. She continues,</p>" + '<p>"We have a lot of work to get to, you can buy a book like that yourself, try the New Age ' +
			getShopStore(true) + '. Can you leave now?"</p>' + '<p>Your mother looks at her sternly, "Calm down Gabby ' + perYou.getHeShe() + " is just being curious, now " + perYou.getPersonName() + ' it is nice to see you but as she rudely said, we have work to do."' + "</td></tr></table>")
	}
	return true
}

function GabbyGotInformation() {
	movePerson("Gabby", isMurderPath() ? 453 : 452);
	movePerson("Mom", 452);
	setPersonFlag("Gabby", 8);
	if (isMurderPath()) setQueryParams();
	else setPersonFlag("Gabby", 10)
}

function initialiseGabby() {
	addPerson("Gabby", 415, "Gabby");
	per.Replies = RepliesGabby;
	per.isPersonInfo = function() {
		return true
	};
	per.getPersonInfo = function() {
		if (!this.isCharmedBy()) return "<p><img src='Images/People/Gabby/gabby1.jpg' class='imgpopup' alt='Gabby'>Gabrielle Halliway (\u201cGabby\u201d, for short, but she doesn't like it when anyone calls her that) Is your Mom's Assistant.</p>" + "<p>You've come to know her as a control freak who orders others around not because she particularly likes doing it, but because she believes that her way is usually the most efficient way to do something and thus should be adhered to, no exceptions.</p>" +
			"<p>She is dedicated and punctual, with a mind for numbers and appointments, but has little patience for delays and can get pretty abrasive when annoyed... and she seems to be annoyed quite often.</p>" + "<p>Mom is pretty much the only person you know who, for some reason, gets along well with her, and the two are pretty much inseparable while at work.</p>" + "<p>The Halliway family actually used to own the Gates Mansion during the times of Kurndorf and were said to be devoted servants him, but when you tried to ask Gabby about it, she refused to waste time with \u201cFairy tales of warlocks and magic\u201d.";
		if (this.isCharmedBy("Vampyre")) return "<p><img src='Images/People/Gabby/gabby-ghoul1.jpg' class='imgpopup' alt='Gabby'>The Ghoul is... unsettling.</p>" + "<p>Gabby is able to perform her duty at work in pretty much the same way she used to be, but as soon as her shift is over she will wordlessly walk towards the park and take her place at the Vampyre's side.</p>" + "She doesn't have a will of her own anymore and her skin is a lot more pale when the Vampyre exerts full control over her. ";
		if (this.getCharmedLevel() ==
			2) return "<img src='Images/People/Gabby/gabby16.jpg' class='imgpopup' alt='Gabby'>" + "You had always suspected that there is a storm brewing under Gabby's skin, and the Dai Chu appears to have unleashed it.</p>" + "<p>While most girls under your spell are barely able to even consider criticizing you, Gabby has no problems letting you know she disapproves of pretty much anything you do with your magic and doesn't see any reason to be nice or polite about it.</p>" + "<p>At the same time, however, she is of course still feeling the full effects of the spell. Your mere presence sends her libido into overdrive, and she longs for you to take her just as much as any other woman you have charmed, which brings you to something you had not expected about her:</p>" +
			"<p>Gabby loves rough sex.</p>" + "<p>From spanking and hair-pulling to degrading positions. She can be surprisingly vicious for a 1,52 m woman at one time and oddly affectionate at another, just don't expect her to submit easily.</p>" + "<p>Gabby is still a Dom by nature, the spell could not change that, and given the chance she will definitely try to exert that.";
		else if (this.getCharmedLevel() == 4) return "<img src='Images/People/Gabby/gabby23.jpg' class='imgpopup' alt='Gabby'>" + "The spell wasn't able to fully turn Gabby into a submissive, but she still has been bound to you.</p>" +
			"<p>She is not able to disobey direct orders, at least as far as you know, and has come to crave the rush of pain to the point that it is literally possible to whip her to orgasm.</p>" + "<p>It started off as punishment administered for what she did, but you quickly discovered that you have quite some talent for this. By now, you've come to enjoy testing out how far you are able to push her, and while Gabby can't help but relish every strike administered, a fact that seems to greatly annoy her.</p>" +
			"<p>Aside from that, though, she is still not all to fond of you, which is unusual for someone affected by the Dai Chu. She doesn't sabotage you but still has a sharp tongue and no problem using it.</p>" + "<p>Of course, that may just be her way of asking for more \u201cpunishment\u201d. ";
		else if (this.getCharmedLevel() == 1) return "<img src='Images/People/Gabby/gabby24.jpg' class='imgpopup' alt='Gabby'>" + (isMurderPath() ? "You have decided to not break up Mom and Gabby, and while the later is annoyed that you have put her under your spell, she is at least happy to be with Mom and a lot more amiable towards you." :
			"You had wanted to give your Mom a devoted servant for a while, And Gabby, already being her assistant, was the perfect choice. She is pretty much doing what she always did, but with more enthusiasm and a lot less ulterior motives.") + "</p><p>Gabby hasn't really become a submissive under the spell. She has always had a rather dominant personality and without you actively guiding the spell, that hardly changed, but she does listen to you and Mom and is devoted to assist you in any way she can, though obviously leans more towards Mom than you.";
		return ""
	};
	per.getPersonAddress = function() {
		return isPlaceKnown("GabbysHouse") ? "11 Amaranth Pl, Glenvale" : ""
	};
	per.whereNow = function() {
		if (this.getCharmedLevel() != 1 || !checkPersonFlag("Mom", 32) || !isCharmedBy("Mom")) return this.place;
		var d = getDay(true);
		if (d == "Sat" || d == "Sun") return 154;
		return this.place
	};
	per.passTimeDay = function() {
		if (this.checkFlag(10)) this.setFlag(23);
		else if (this.checkFlag(23) && !this.isCharmedBy()) this.setFlag(13);
		return ""
	};
	per.addPlaceImageLeft = function(lit) {
		if (Place == 452 && this.isHere() &&
			sType === "")
			if (this.getCharmedLevel() == 2) return this.showPerson("gabby15.jpg", "", "", "", "", false, "string");
			else if (this.getCharmedLevel() == 4) return this.showPerson("gabby22.jpg", "", "", "", "", false, "string");
		else if (this.getCharmedLevel() == 1) return this.showPerson("gabby24.jpg", "", "", "", "", false, "string");
		if (Place == 247 && this.isHere() && sType === "") return this.showPerson("gabby-ghoul1.jpg", "", "", "", "", false, "string");
		return ""
	};
	per.showEventPopup = function() {
		if (this.place == 452 && checkPersonFlag("Mom", 14) &&
			getHour() > 7 && getHour() < 18) {
			var d = getDay(true);
			if (d != "Sat" && d != "Sun") {
				if (Place == 452 && this.getCharmedLevel() == 1) {
					this.place = 415;
					WriteComments(this.addPersonFace() + "Gabby tells you she is leaving for work");
					return true
				}
				if (Place != 452) {
					this.place = 415;
					if (sType === "" && (Place == 45 || Place == 46)) {
						WriteComments(this.addPersonFace() + "Mom gives you a kiss goodbye as she heads off to work");
						return true
					}
				}
			}
		}
		if (Place == 45 && this.whereNow() == 154 && !this.checkFlag(16)) {
			showPopupWindow("Mom and Gabby", "<img src='Images/People/Gabby/gabby26.jpg' class='imgpopup' alt='Gabby and Mom'>" +
				"To your surprise, you see Gabby just on her way out of the kitchen as you enter your home. She's naked, clearly on her way to Mom's bedroom, and only stopping when you call out and ask her what's she's doing here.</p><p>" + (isMurderPath() ? "\u201cWell, there is no longer any need to keep our relationship secret from you now, is there?\u201d She turns her head around. \u201cAlex asked me to spend the weekend with her, and she didn't want to leave you and Tracy alone the whole time, so... I'll be visiting now occasionally.\u201d She chuckles at how weird that is." :
					"\u201cMistr... Alex actually asked me to spend the weekend with her.\u201d She turns her head around. \u201cEver since you have used that spell on her as well, she has been more open about her needs, and my...\u201d She really seems to dislike using that word. \u201c...duties as her servant had to be expanded.\u201d") + "</p><p>\u201cWe will spend most of our time in her bedroom, so you won't even notice me being here unless you want to... watch.\u201d", 'setPersonFlag("Gabby", 16)');
			return true
		}
		if (Place ==
			110) {
			if (sType == "waitconfmayor2") {
				showPopupWindow("Waiting with the Mayor", "<img src='Images/" + (perYou.isMaleSex() && isExplicit() ? "Explicit/mayor13" : "mayor14") + ".jpg' class='imgpopup' alt='Mayor'>" + "...with Beatrice all to eager to provide a bit of stress relief for you and her.", 'dispPlace(Place,"type=waitconfmayor3")');
				return true
			}
			if (sType == "waitconfmayor3") {
				showPopupWindow("Waiting with the Mayor", "<img src='Images/mayor15.jpg' class='imgpopup' alt='Mayor'>" + '"As the event draws near, both of you go over the plan once again.</o>' +
					"<p>You will be introduced as Miss Thomas's personal aide, for the time being, which should allow you to move freely around the building without being questioned. You will receive a signal as soon as Gabby is alone and ready to be charmed.</o>" + "<p>Mayor Thomas will make sure that Gabby is in a room far away from the rest of the gathering and delay whoever she is supposed to meet, so all you need to do is charm her.", 'dispPlace(98,"type=startconference")');
				return true
			}
		}
		if (sType == "waitconfsarah2") {
			showPopupWindow("Waiting with the Mayor",
				"<img src='Images/sofia_office_noncharmed.jpg' class='imgpopup' alt='Sofia'>" + "Finally, when the time has come, you take a seat in a spacious limousine, earning a suspicious look from the chauffeur as you are on the way to the Town Hall.", 'dispPlace(98,"type=startconference")');
			return true
		}
		if (sType == "conferencecallout") {
			showPopupWindow("A Reporter", "<img src='Images/People/Julie/julie1.jpg' class='imgpopup' alt='Julie'>" + "You actually recognize this woman.</p>" + "<p>Julie Luna, at least that's her pen-name, is a writer for the Midwestern Gazette, a tabloid popular especially among fans of the arcane and paranormal. The paper itself deals mostly in celebrity gossip and strange conspiracy stories around haunted areas, occult rituals and the ever popular Alien abductions, but occasionally they do hit gold with a story. Julie's articles in particular are usually quite entertaining and as well researched as the subject matter allows. She did manage to earn some renown for it, and many question why she would waste her talent writing stories about Bigfoot's dietary habits instead of shooting for a bigger publication.</p>" +
				"<p>Still, to see someone like her here is surprising, you'd think Mayor Thomas would want to avoid gossipers and tabloids right now. ", 'dispPlace(Place,"type=conferencetalkjulie1")');
			return true
		}
		if (sType == "conferencemayor")
			if (getQueryParam("stage") == "stage3") {
				showPopupWindow("Other Help", '<img src="Images/' + (perYou.isMaleSex() && isExplicit() ? "Explicit/" : "") + 'mayor18.jpg" style="width:' + (perYou.isMaleSex() && isExplicit() ? "50%" : "25%") + ';float:left;margin-right:5px" alt="Mayor">' + "It's quick and dirty. No foreplay, no long-winded buildup. You just throw her on the desk and go at it, trading kisses, rolling around on the bed and feeling each others skin. You are " +
					(perYou.isMaleSex() ? "inside her" : "grinding against her") + " sex within seconds and roughly take the woman with forceful motions.", 'dispPlace(Place, "type=conferencemayor&stage=stage4")');
				return true
			} else if (getQueryParam("stage") == "stage4") {
			showPopupWindow("Other Help", '<img src="Images/' + (perYou.isMaleSex() && isExplicit() ? "Explicit/" : "") + 'mayor19.jpg" style="width:' + (perYou.isMaleSex() && isExplicit() ? "50%" : "25%") + ';float:left;margin-right:5px" alt="Mayor">' + "Both of you climax not even 5 minutes in, taking a brief moment to bask in the afterglow before you part with a final kiss. There's work to be done, but this surely was a pleasant distraction.",
				'dispPlace(Place, "type=conferencemayor&stage=stage5")');
			return true
		}
		if (sType !== "") return false;
		if (!checkPersonFlag("Mom", 26) && (Place == 413 || Place == 412 && getQueryParam("enter") == "true") && !this.checkFlag(2)) {
			this.setFlag(2);
			showPopupWindow("Mom's Assistant", "<img src='Images/People/Gabby/gabby1.jpg' class='imgpopup' alt='Gabby'>" + (Place == 412 && getQueryParam("enter") == "true" ? isCharmedBy("Nina") ? "Nina runs a hand over her breasts and gestures to Madison's office, you walk over to the office while looking appreciatively at Nina.</p><p>" :
					"Annoyed, Nina gestures towards an office, you walk over.</p><p>" : "") + "You run right into probably the worst person to meet in the Studio, your Mom's ever faithful assistant.</p>" + "<p>Her name is Gabrielle Halliway, \u201cGabby\u201d to the very few people she likes. And no, you are not among those. She hates tardiness, disorder and meddling kids and can be surprisingly intimidating for a 1.52m woman, but she must be good at her job. People in the studio rarely complain about her behavior and Mom even gets along with her fairly well.",
				'dispPlace(Place,"type=meetgabby")');
			return true
		}
		return false
	};
	per.showEventConference = function() {
		var md;
		var perSarah = findPerson("Sarah");
		var perMayor = findPerson("Mayor");
		var bSarah = this.checkFlag(12);
		var stage = getQueryParam("stage");
		if (sType == "startconference") {
			this.moveThem(98);
			var tm = nTime % 288;
			if (tm < 240) nTime += 242 - tm;
			md = WritePlaceHeader();
			addPlaceTitle(md, "The Press Gathering", "townhall-conferenceroom.jpg");
			md.write("<p>Mayor Thomas surely likes it posh. The large conference room has been decorated lavishly, and if not for the many camera crews, this would almost seem like a high society party with the fancy dresses, buffet and  hired caterers serving drinks.</p>" +
				"<p>Press personal, contractors and socialites make the bulk of the attendees, and you quickly mingle into the crowd to not draw too much attention.</p>" + "<p>There's some time before you will be able to meet with Gabby, so you might as well look around a bit.</p>");
			var img = "townhall-conferenceroom-people" + String.fromCharCode(Math.floor(Math.random() * 5) + 97);
			switch (img) {
				case "townhall-conferenceroom-peoplea":
					md.write("<p>A group of wealthy looking contractors has gathered in a corner of the room.</p>");
					break;
				case "townhall-conferenceroom-peopleb":
					md.write("<p>A hired caterer briefly smiles to you before moving on to take another order.</p>");
					break;
				case "townhall-conferenceroom-peoplec":
					md.write("<p>A security guard speaks into his microphone.</p>");
					break;
				case "townhall-conferenceroom-peopled":
					md.write("<p>Two socialites have moved away from the main gathering to talk, from the looks of it about someone's wardrobe.</p>");
					break;
				case "townhall-conferenceroom-peoplee":
					md.write("<p>A camera team prepares their equipment.</p>");
					break
			}
			startQuestions();
			if (!this.checkFlag(21) || !this.checkFlag(22)) startAlternatives(md);
			if (!this.checkFlag(21)) addLinkToPlaceC(md, "look for Sarah", Place, "type=conferencesarah");
			if (!this.checkFlag(22)) addLinkToPlaceC(md, "look for Mayor Thomas", Place, "type=conferencemayor");
			addLinkToPlaceC(md, "mingle with the crowd and wait for the signal", Place, "type=conferencemingle");
			if (!this.checkFlag(21) || !this.checkFlag(22)) endAlternatives(md);
			AddPeopleColumn(md);
			AddImage(img + ".jpg");
			WritePlaceFooter(md);
			return true
		}
		if (sType ==
			"conferencesarah") {
			md = WritePlaceHeader();
			this.setFlag(21);
			perSarah.showPerson("sarah14.jpg");
			addPlaceTitle(md, "Talking to Sarah");
			md.write("<p>Sarah Gates clearly knows how to navigate a crowd like this. She is smiling, answering questions and occasionally posing for pictures without ever appearing to be bored or impolite.</p>");
			if (!bSarah) md.write("<p>Her Maid is usually not far away from her, but looks a lot more nervous. Her posture is stiff and her cheeks slightly red, you also notice that her eyes are frequently darting around.</p>");
			startQuestions();
			switch (stage) {
				case "":
					addQuestionR(md, "talk to Sarah", bSarah ? "Sarah introduces you to the people she has been talking to as her temporary assistant and excuses herself to speak with you for a moment.</p>" + "\u201cWe do have a bit of time before my interview, Mayor Thomas wants to impress people and is poised to give a few exclusives herself before the actual conference begins.\u201d She smirks mischievously.\u201dI will find you when the time comes, so feel free to mingle or stay.\u201d" :
						"\u201cAh, " + perYou.getPersonName() + ".\u201d Sarah approaches you the moment she sees you. \u201cI am surprised to actually see you here, you are quite resourceful, it seems.\u201d She keeps her voice low, and gestures for her maid to come over. \u201cLauren, be so good and get us something to drink.\u201d</p>" + "<p>The maid nods demurely and walks towards the buffets with a strangely stiff gait, and you notice Sarah flipping a switch on a sort of small item in her hand.", "Sarah", bSarah ? "setQueryParams(\\'type=" +
						sType + "&stage=stage5\\')" : "setQueryParams(\\'type=" + sType + "&stage=stage2\\')");
					break;
				case "stage2":
					addQuestionR(md, "ask if everything goes well", "\u201cI am bored out of my mind.\u201d Sarah says matter of factly, yet never breaks the smile. \u201cBut uncle Ronnie would never think of attending these events, so I'm the one stuck here.\u201d She flicks something on the little stick again, and you could have sworn you've seen Lauren stagger a bit at the same moment.", "Sarah", "setQueryParams(\\'type=" +
						sType + "&stage=stage3\\')");
					break;
				case "stage3":
					addQuestionR(md, "ask about the device in her hand", "\u201cOh, that is just a fidget toy to keep my fingers busy.\u201d Again she flicks a switch on her toy, and your, as well as other peoples, eyes are drawn towards an audible moan coming from the maid, who is pressing her tights together and barely able to balance the glasses. \u201cIt's nothing special, but it breaks up boredom a little.\u201d", "Sarah", "setQueryParams(\\'type=" + sType + "&stage=stage4\\')");
					break;
				case "stage4":
					addQuestionR(md, "enjoy your drinks and have a short chat", "Lauren's face has taken on an even deeper shade of red when she delivers the glasses to you and you occasionally see her twitch and bite her lower lip.</p>" + "<p>However, when you ask her if she is well, she just nods quickly, explaining in few words that crowds make her a bit nervous and making sure to stay out of your sight behind Sarah for the rest of the conversation, which in itself turned out to be rather pleasant.</p>" +
						"<p>You talk about this and that, staying clear of certain topics while within the public and never really touching anything of importance, but it is a pleasant way to pass the time.", "Sarah", "setQueryParams(\\'type=" + sType + "&stage=stage5\\')");
					break;
				case "stage5":
					addLinkToPlaceC(md, "check out the rest of the conference", Place, "type=startconference");
					break
			}
			if (stage !== "" && stage != "stage5") addLinkToPlaceC(md, "leave her for now", Place, "type=startconference");
			AddPeopleColumn(md);
			if (!bSarah) findPerson("Lauren").showPerson("lauren13.jpg");
			else AddImageRandom("townhall-conferenceroom-people", 5);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "conferencemayor") {
			md = WritePlaceHeader();
			this.setFlag(22);
			perMayor.showPerson(isCharmedBy("Mayor") ? "mayor15.jpg" : "mayor16.jpg");
			addPlaceTitle(md, "Talking to Mayor Thomas");
			md.write("<p>Mayor Thomas is by herself, overlooking the premise and making sure the hired personal is serving drinks and handing out fliers to the attendees.</p>");
			startQuestions();
			switch (stage) {
				case "":
					addQuestionR(md, "approach the Mayor",
						bSarah ? perMayor.isCharmedBy() ? "\u201c" + perYou.getPersonName() + "?\u201d The Mayor is surprised when she notices you. \u201cI had no idea you wanted to be here I...\u201d She looks around briefly to make sure no one is listening in and lowers her voice. \u201cI could have made sure you gain VIP access, please don't tell me you went to someone else for help.\u201d</p>" + "<p>You tell her about Sarah, and after a short look over to her, in which you are sure Beatrice created an extensive profile based on a million tiny details about how much of a threat Sarah might be to her, she turns back to you.</p>" +
						"<p>\u201cShe is not even one of, well, yours.\u201d She casts another nervous look to Sarah. \u201cAre you really sure it is wise to involve outsiders and not use the resources available? Like me?\u201d</p>" + "<p>You assure her that you intent to use her many times, but for this one, Sarah seemed like the better choice, which seems to cause her no small amount of discomfort.</p>" + "<p>\u201cOf course, but if there is anything I can do to assist you, please don't hesitate to ask!\u201d" : "\u201cPlease, I am very busy making sure that everything is perfect. So, unless you have an appointment for a personal interview you will have plenty of time to ask questions during the conference.\u201d</p>" +
						"<p>You ponder for a moment to insist on talking to her, but the way she looks over to the security personal makes you think better of it." : "Mayor Thomas turns to you with a conspiratorial smile. \u201cEverything is going just as planned, " + perYou.getPersonName() + ". Miss Halliway will be alone in one of the rooms to conduct an interview, and I made sure that the person she is set to meet will be sufficiently delayed, to give you all the time you need.\u201c Miss Thomas is positively exhilarated.</p>" +
						"<p>\u201cThank you so much, again, " + perYou.getPersonName() + ", this little event was close to become a disaster, but if I am able to help you expand your harem, all will be worth it.\u201d", "Mayor", "setQueryParams(\\'type=" + sType + "&stage=" + (perMayor.isCharmedBy() ? "stage2" : "stage5") + "\\')");
					break;
				case "stage2":
					addPopupLink(md, "maybe she can help you in some \u201cother\u201d ways", "Other Help", '<img src="Images/mayor17.jpg" style="width:25%;float:left;margin-right:5px" alt="Mayor">' + "Mayor Thomas looks uncertain whether she should really leave the crowd alone, even for a while, but of course her desire wins over.</p>" +
						"<p>She tells you to meet her in 5 minutes inside one of the empty rooms to avoid suspicion, and when you follow her, she is already nearly undressed and ready for you.", false, "dispPlace(Place,'type=conferencemayor&stage=stage3')");
					addLinkToPlaceC(md, "leave her for now", Place, "type=startconference");
					break;
				case "stage5":
					addLinkToPlaceC(md, "check out the rest of the conference", Place, "type=startconference");
					break
			}
			AddPeopleColumn(md);
			AddImageRandom("townhall-conferenceroom-people", 5);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "conferencemingle") {
			md = WritePlaceHeader();
			addPlaceTitle(md, "Mingling At The Press Gathering", "townhall-conferenceroom.jpg");
			md.write("<p>At this point, all you can do is keep ready and hope that everything goes to plan. Gabby should soon be on the way to a room in the back of the Town Hall, so you just move aside, try not to be noticed and apparently fail spectacularly at that.</p>");
			startQuestions();
			addLinkToPlaceC(md, "someone calls out to you", Place, "type=conferencecallout");
			AddPeopleColumn(md);
			AddImageRandom("townhall-conferenceroom-people", 5);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "conferencetalkjulie1") {
			md = WritePlaceHeader();
			AddImage("People/Julie/julie1.jpg");
			addPlaceTitle(md, "A Reporter");
			switch (stage) {
				case "":
					md.write("<p>The journalist's eyes are inquisitive, but she approaches you with a friendly smile and open demeanor.</p>" + "<p>\u201cJulie Luna, from the Midwestern Gazette.\u201d She immediately introduces herself. \u201cExcuse my boldness, but I had thought I'd know every face I would meet here, so you kind of picked my curiosity.\u201d</p>");
					startQuestions();
					addLinkToPlaceC(md, "introduce yourself", Place, "type=conferencetalkjulie1&stage=stage2");
					break;
				case "stage2":
					md.write("<p>You think about sending her away, but if her reputation is anything to go by, this will only make her more curious. So you politely introduce yourself using your cover story.</p>");
					if (bSarah) md.write("<p>\u201cSo, you are Miss Gates's new assistant?\u201d Her interest is clearly perked now. \u201cThis makes you about 30% more interesting than anyone else in here, including the mayor.\u201d</p>");
					else md.write("<p>\u201cSo you are Miss Thomas's new Aide?\u201d She gives you a curious one-over. \u201cI'm impressed, she has a reputation for being picky and pretty tough on her staff, you must have made quite the impression.\u201d</p>");
					startQuestions();
					addLinkToPlaceC(md, "ask about her own work", Place, "type=conferencetalkjulie1&stage=stage3");
					break;
				case "stage3":
					md.write("<p>You try to lead the conversation away from yourself and ask Julie about her own work. After all, the gazette is not really known to take an interest in politics and housing projects.</p>" +
						"<p>\u201cYou see right through me.\u201d She smirks. \u201cGlenvale has always been a place of interest for myself and our readers, with the Kurndorf myth and the towns lively past, but right now the place seems abuzz with rumors of strange happenings from ghost sightings to people vanishing under mysterious circumstances.\u201d</p>" + "<p>\u201cIn fact.\u201d Her expression turns more serious. \u201cA local blogger I wanted to meet is among those missing as well, a girl named Jesse.\u201d</p>");
					startQuestions();
					addLinkToPlaceC(md, '"A local blogger?"', Place, "type=conferencetalkjulie2");
					break
			}
			AddPeopleColumn(md);
			AddImageRandom("townhall-conferenceroom-people", 5);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "conferencetalkjulie2") {
			md = WritePlaceHeader();
			AddImage("jesse-photo.jpg");
			addPlaceTitle(md, "A Reporter");
			md.write("<p>You really hope she did not notice how your stomach just made a double back-flip when you heard the name, but if she did, she doesn't show it and gladly gives you more information.</p>" + "<p>\u201cYes, she was last seen at the Broken Inn and completely went off the grid a few days back with not even her father knowing where she is.\u201d She shows you a photo on her smartphone, and your heart sinks even further seeing an all to familiar face.</o>" +
				"<p>\u201cIt's also part of the real reason I wanted to talk to you. ");
			if (!bSarah) md.write("The mayors staff is always tight-lipped about everything, but I'm sure they are well-informed, and if you overhear something, I would appreciate it if you can give me a hint.</p>");
			else md.write("The Gates family has a reputation for being involved in the paranormal, but they don't exactly speak with our paper. If my gut feeling is right and Jesse's disappearance is linked to the weird things happening around town, they might hear something, in that case I would appreciate a hint.</p>");
			startQuestions();
			addLinkToPlaceC(md, "try to answer her", Place, "type=conferencetalkjulie3", "You are not sure how to answer this, so it's probably a stroke of luck that you are interrupted the moment you try to.");
			AddPeopleColumn(md);
			AddImageRandom("townhall-conferenceroom-people", 5);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "conferencetalkjulie3") {
			md = WritePlaceHeader();
			if (bSarah) perSarah.showPerson("sarah14.jpg");
			else findPerson("Angela").showPerson("!angela15" + (isCharmedBy("Angela") ? "a" : "b") + ".jpg");
			addPlaceTitle(md, "An Interruption");
			if (bSarah) md.write("<p>\u201c" + perYou.getPersonName() + ", Miss Luna.\u201d Sarah gives Julie a very terse nod before turning to you. \u201cIt is time for the interview, we should be going.\u201d</p>" + "<p>\u201cOf course, Miss Gates, but I never meant to infringe on your staff for too long and shall take my leave.\u201d The two women exchange brief glances before Julie bids you farewell and vanishes back into the crowd while Sarah takes you with her to the back of the future hotel.</p>" +
				"<p>\u201cBe careful around the press, especially her.\u201d Sarah remarks with a neutral voice, but it doesn't look like she wishes to talk more about Julie. \u201cFor now, let's focus on getting that naughty little hypnotist on your side, I've been looking forward to it all night.\u201d</p>");
			else md.write("<p>\u201c" + perYou.getPersonName() + ".\u201d Angela interrupts you before you are able to say anything. \u201cMiss Thomas wishes to let you know that you are needed during the next appointment, please follow me.\u201d</p>" +
				"<p>\u201cYou apologies to Julie for cutting the talk short, but she is quite understanding and quickly vanishes into the crowd as Angela leads you to the back of the Town hall.</p>");
			startQuestions();
			addPopupLinkToPlaceC(md, "follow " + (bSarah ? "Sarah" : "Angela"), 97, "type=conferencegabby", "Break Room", '<img src="Images/door1.jpg" style="width:25%;float:right;margin-left:5px" alt="Dress">' + "You follow " + (bSarah ? "Sarah" : "Angela") + " through a long corridor, past several doors and way from the prying eyes of the crowd until you stand in front of a door to a break room of the Town Hall. " +
				(bSarah ? "Sarah goes in first, telling you to give her a few minutes before following to make sure she has Gabby's full attention." : "Angela tells you that your \u201cappointment\u201d is waiting inside and takes her leave to help with preparations, and you take a short look around to make sure that really no one is watching.") + "</p><p>You open the door....</p>");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "conferencegabby") {
			md = WritePlaceHeader();
			this.showPerson("gabby2.jpg");
			addPlaceTitle(md, "Gabby");
			md.write("<p>Gabby turns towards the door and recognizes you instantly, a look of surprise on her face.</p>");
			if (bSarah) md.write("<p>Sarah is sitting next to her, waiting for you to make your move.</p>");
			startQuestions();
			addLinkToPlaceC(md, "leave the room", 94, "", "Well... what did you expect to happen? The moment you leave the room, Gabby rushes out, almost running you over and out of sight with surprising speed, most likely to get Mom and run. That could have gone better...", "", "movePerson('Gabby',998);movePerson('Mom',998)");
			if (bSarah) {
				AddPeopleColumn(md);
				perSarah.showPerson("sarah15.jpg")
			}
			WritePlaceFooter(md);
			return true
		}
		if (sType == "conferencecharm1") {
			md = WritePlaceHeader();
			this.showPerson("gabby3.jpg");
			addPlaceTitle(md, "Gabby Under A Charm Spell...Maybe");
			md.write("<p>Doubt begins to gnaw on you as you speak the incantation, a strange feeling as if this is not the best course of action, that you might be making a horrible mistake by casting that spell on Gabby.</p>" + "<p>Does she really deserve this? What if she has defenses you don't know about? Your eyes fall on her necklace, and for a second, you don't think you should go through with this.</p>");
			if (bSarah) md.write("<p>Sarah is sitting next to her, watching.</p>");
			startQuestions();
			if (this.checkFlag(8)) addLinkToPlaceC(md, "ignore it and push through", Place, "type=conferencecharm2");
			else addLinkToPlaceC(md, "stop and let the mana disperse", 94, "", "You don't know what is coming over you, but you can't finish the spell...</p><p>The mana dissipates and you are left with an uncomfortable, hollow feeling inside.</p><p>Gabby, on her end, doesn't take long to connect the dots and figure out what you were trying to do, and before you know it she's tackled you aside with for her stature surprising force and is on her way out of the building.",
				"", "movePerson('Mom',998)");
			if (bSarah) {
				AddPeopleColumn(md);
				perSarah.showPerson("sarah15.jpg")
			}
			WritePlaceFooter(md);
			return true
		}
		if (sType == "conferencecharm2") {
			md = WritePlaceHeader();
			this.showPerson("gabby4.jpg");
			addPlaceTitle(md, "Gabby Under A Charm Spell");
			md.write("<p>The spell on the necklace capitalizes on your own uncertainty, but knowing for sure that it's all smoke and mirrors thanks to your research, you easily push those feelings away and finish the spell, and not a second too late.</p>" + "<p>\u201cDai Chu? Is this some sort of joke, " +
				perYou.getPersonName() + "?\u201d Gabby asks in a condescending tone. \u201cI don't know what you are hoping to achieve here, but you will step aside and let me leave this instant.\u201d</p>" + "<p>There is a sharp edge to her voice, but while she may approach you aggressively, you can already see specks of pink flashing behind her eyes.\u201d</p>");
			if (bSarah) md.write("<p>Sarah is sitting next to her, watching.</p>");
			startQuestions();
			addLinkToPlaceC(md, "close the door and tell her to stay here", Place,
				"type=conferencecharm3");
			if (bSarah) {
				AddPeopleColumn(md);
				perSarah.showPerson("sarah15.jpg")
			}
			WritePlaceFooter(md);
			return true
		}
		if (sType == "conferencecharm3") {
			md = WritePlaceHeader();
			this.showPerson("gabby5.jpg");
			addPlaceTitle(md, "Gabby Under A Charm Spell");
			md.write("<p>Gabby stops in her tracks and just stares at you incredulously, her mind racing in an attempt to wrap itself around what is happening until her eyes suddenly widen in shock.</p>" + "<p>\u201cYou... you actually do know the Dai Chu...\u201d She backs away from you. \u201cThat's why all the girls Alex told me about seem to flock to you...\u201c She desperately looks for an exit, her arm occasionally twitching as if intending to hit you, but never pulling through.</p>");
			if (bSarah) md.write("<p>Sarah is sitting next to her, watching.</p>");
			startQuestions();
			addLinkToPlaceC(md, "Order her to tell you about Mom", Place, "type=conferencecharm4");
			if (bSarah) {
				AddPeopleColumn(md);
				perSarah.showPerson("sarah15.jpg")
			}
			WritePlaceFooter(md);
			return true
		}
		if (sType == "conferencecharm4") {
			md = WritePlaceHeader();
			this.showPerson("gabby6.jpg");
			addPlaceTitle(md, "Gabby Under A Charm Spell");
			md.write("<p>\u201cHow do you....\u201d Gabby shoots you an angry glare, clearly struggling with herself before she blurts out the answer. \u201cYes, I have been hypnotizing her to be my slave, happy now?\u201d You ask why she did it, and Gabby just snarls. \u201cWho doesn't want to do that to their boss? She would have loved to worship this body.\u201d She tears off her top and poses for you. \u201cI would have made her scream in pure ecstasy at my feet, pushing her from one blissful climax to the next! She'd be in heaven.\u201d</p>" +
				"<p>Yeah, that's not a mental image you necessarily wanted to have, but at least she doesn't try to resist the spell, now that you got her ranting.</p>");
			if (bSarah) md.write("<p>Sarah is sitting next to her, watching.</p>");
			startQuestions();
			addLinkToPlaceC(md, "play with her ego to keep her ranting", Place, "type=conferencecharm5");
			if (bSarah) {
				AddPeopleColumn(md);
				perSarah.showPerson("sarah15.jpg")
			}
			WritePlaceFooter(md);
			return true
		}
		if (sType == "conferencecharm5") {
			md = WritePlaceHeader();
			this.showPerson("gabby7.jpg");
			addPlaceTitle(md, "Gabby Under A Charm Spell");
			md.write("<p>You didn't know Gabby could be passionate about anything, but there is clearly some pent-up frustration she is finally letting out and you decide to goat her further play on her ego a bit.</p>" + "<p>\u201cAs if you don't  desire me, too.\u201d Gabby throws her top away and begins to push down her pants. \u201cYou would not have used that spell on me if you didn't, am I right, " + perYou.getPersonName() + "? So have a good look!\u201d</p>" + "<p>\u201cLook at all this and tell me to my face that you don't want to fuck me!\u201d Her eyes show a strange mix of anger and lust, and you are not quite what she wants to do more at this point, fuck you, or kill you.</p>");
			if (bSarah) md.write("<p>Sarah is sitting next to her, watching.</p>");
			startQuestions();
			startAlternatives(md);
			addLinkToPlaceC(md, "order your her to sit down on the bed and behave, like a good slave", Place, "type=conferencecharmslave1");
			if (perYou.checkFlag(26)) {
				addLinkToPlaceC(md, "rile her up even further", Place, "type=conferencecharmlover1");
				addLinkToPlaceC(md, "actually, tell her she'll serve your Mom instead", Place, "type=conferencecharmmomservant1")
			}
			endAlternatives(md);
			if (bSarah) {
				AddPeopleColumn(md);
				perSarah.showPerson("sarah15.jpg")
			}
			WritePlaceFooter(md);
			return true
		}
		if (sType == "conferencecharmleave") {
			md = WritePlaceHeader();
			this.showPerson("gabby7.jpg");
			addPlaceTitle(md, "Gabby Under A Charm Spell");
			md.write("<p>Your refusal doesn't really improve Gabby's already sour mood, and she glares daggers towards you when you tell her to finish up whatever she still had to do and that you will seek her out later.</p>");
			if (bSarah) md.write("<p>\u201cFine... I believe I still had to conduct my interview with Ms Gates anyway.\u201d She turns to Sarah, who just smirks. \u201cI have no idea why you would help " +
				perYou.getHimHer() + ", but I presume you are still here for the interview?\u201d</p>" + "<p>\u201cIf you stay like this all the more, Miss Halliway.\u201d</p>" + "<p>You are amazed that Gabby is still able to go through her questions with a straight face as you pick up the keys and prepare to leave through the open door... wait, didn't you close it?</p>" + "<p>In any case, you got the keys and the address, time to look for Mom.</p>");
			else md.write("<p>\u201cFine, I still have to conduct an interview anyway, and you are probably responsible for the holdup.\u201d</p>" +
				"<p>The two of you agree to meet later, and as... well, angry as Gabby is, you might actually want to follow up on it before she chases you down.</p>" + "<p>It's not a mistake you should make too often, but in any case, you got the keys and the address, time to look for Mom.</p>");
			startQuestions();
			startAlternatives(md);
			addLinkToPlaceC(md, "leave the room", 94, "", "You gather up what you need and leave through the open door... didn't you close it?</p><p>You are not sure, but at least no one walked in on you.");
			if (bSarah) {
				AddPeopleColumn(md);
				perSarah.showPerson("sarah15.jpg")
			}
			WritePlaceFooter(md);
			return true
		}
		if (sType == "conferencecharmslave1") {
			this.charmThem(4);
			if (whereItem(67) === 0) PlaceI(67);
			md = WritePlaceHeader();
			this.showPerson("gabby8.jpg");
			addPlaceTitle(md, "Gabby Under A Charm Spell");
			md.write("<p>Gabby follows suit, much to her own surprise, keeping her legs spread and sitting still like a good girl.</p>" + "<p>\u201cThe spell has already progressed this far... I'm about to become some stupid teenager's fucktoy...\u201d The realization hits her hard, and she suddenly bursts out laughing. \u201cThis is rich... to think that you of all people had the potential to be a " +
				perYou.getWitch() + " all this time while I had to rely on silly trinkets...\u201d She throws the Necklace onto the floor with an angry grunt and tries to focus. \u201cAnd to think this stupid spell makes even you look... absolutely radiant...\u201d</p>");
			if (bSarah) md.write("<p>Sarah is sitting next to her, watching.</p>");
			startQuestions();
			addLinkToPlaceC(md, "push her further", Place, "type=conferencecharmslave2");
			if (bSarah) {
				AddPeopleColumn(md);
				perSarah.showPerson("sarah15.jpg")
			}
			WritePlaceFooter(md);
			return true
		}
		if (sType == "conferencecharmslave2") {
			md = WritePlaceHeader();
			this.showPerson("gabby9.jpg");
			addPlaceTitle(md, "Gabby Under A Charm Spell");
			md.write("<p>\u201cIt's fascinating is it not? How your body is getting hot and flustered, trembling with need and desire as your mind is being claimed by a true " + perYou.getWitch() + "?\u201d</p>" + "<p>Yep, you didn't expect to find this sore spot, but you are sure as hell going to hit it.</p>" + "<p>\u201cHow you feel want your " + perYou.getMaster() + " to punish you for the bad things you did, how you want " +
				perYou.getHimHer() + " to make you scream in pain in pleasure, how your body yearns to be claimed by your betters?\u201d</p>" + "<p>\u201cYou are not...\u201d Gabby rises to her feet only to be stopped by another harsh command.</p>" + "<p>\u201cSit down, slave!\u201d</p>" + "<p>She immediately sits back on the bed, glaring daggers at you.</p>" + "<p>\u201cI am. And you will accept that, slave.\u201d</p>" + "<p>Gabby's body is taken by a lustful shudder  as you say the last word, her underwear showing red stains.</p>" +
				"<p>\u201cYou will yearn for me to take you, punish you and treat you like a little painslut. And you will get off from it like you never did before.</p>");
			if (bSarah) md.write("<p>Sarah is sitting next to her, watching.</p>");
			startQuestions();
			addLinkToPlaceC(md, "Gabby glares at you", Place, "type=conferencecharmslave3");
			if (bSarah) {
				AddPeopleColumn(md);
				perSarah.showPerson("sarah15.jpg")
			}
			WritePlaceFooter(md);
			return true
		}
		if (sType == "conferencecharmslave3") {
			md = WritePlaceHeader(false, "td-left-med");
			this.showPerson("gabby10.jpg");
			addPlaceTitle(md, "Gabby Under A Charm Spell");
			md.write("<p>\u201cF...fuck you!... I... I...\u201d She is still fighting, nominally at least, \u201cI will... I am... Oh, to hell with it...!\u201d Gabby tears off what is left of her clothes and turns around.</p>" + "<p>\u201cYes, I want to show myself off to you and be punished like a slutty, dirty slave!\u201d She slaps her own ass. \u201cHappy now, you damn, cheating, teenage " + (perYou.isBornMale() ? "bastard" : "bitch") + "? Happy to have ruined everything I've worked towards for months?\u201d</p>" +
				"<p>Wow, you did not expect an outburst like that, Gabby must have had a ton of pent-up frustration under the cold exterior.</p>" + "<p>\u201cI'm yours now, \u201c" + perYou.getMaster() + "\u201d.\u201d There is not a hint of submission in her voice, but she still offers herself to you. \u201cFuck me, spank me, punish me and better make it count. I sure as hell wouldn't have went easy on you!\u201d</p>");
			if (bSarah) md.write("<p>Sarah is sitting next to her, watching.</p>");
			startQuestions();
			if (!this.checkFlag(14)) addQuestionR(md,
				'"First things first, where\'s Mom?"', "\u201cAlex is at my home on 11 Amaranth place, awaiting her full indoctrination.\u201d Gabby reluctantly hands you the keys. \u201cDo with her as you wish.\u201c</p><p>You might have to do something about that attitude, but for now, Mom is more important.", "", "setPersonFlag(\\'Gabby\\',14);setPlaceKnown(\\'GabbysHouse\\')");
			else {
				startAlternatives(md);
				addLinkToPlaceC(md, "tell Gabby to meet you at her house once her business here is concluded", 94, "", "Gabby looks annoyed that you don't follow up right away, but she will require some proper disciplining, for which you now simply lack the time. Not to mention that you might need some help to employ certain ideas.</p><p>Nevertheless, you have what you needed, time to head out and find Mom.");
				if (!bSarah) addLinkToPlaceC(md, "take her up on her offer", Place, "type=conferencecharmslave5");
				else addLinkToPlaceC(md, "take her up on her offer", Place, "type=conferencecharmslave4")
			}
			if (bSarah) {
				AddPeopleColumn(md);
				perSarah.showPerson("sarah15.jpg")
			}
			WritePlaceFooter(md);
			return true
		}
		if (sType == "conferencecharmslave4") {
			md = WritePlaceHeader(false, "td-left-med");
			this.showPerson("gabby10.jpg");
			addPlaceTitle(md, "Gabby Under A Charm Spell");
			md.write("<p>Before you do anything more, \u201cI can leave if you want.\u201d Sarah interjects with a smirk. \u201cThough I'd much rather stay.\u201d.</p>");
			startAlternatives(md);
			addLinkToPlaceC(md, "ask her to join in", Place, "type=conferencecharmslave5&stage=sarah1");
			addLinkToPlaceC(md, "tell her to leave", Place, "type=conferencecharmslave5&stage=nosarah", "\u201cFine with me, just remember that we still have an interview scheduled.\u201d</p><p>Sarah leaves the room through the open door and... wait, didn't you close it?</p><p>Maybe not. In any case, you are now alone with Gabby", "Sarah");
			addLinkToPlaceC(md, "allow her to stay", Place, "type=conferencecharmslave5&stage=sarahwatch",
				"Sarah smiles at you brightly and leans back on the chair, gesturing for you to proceed.");
			AddPeopleColumn(md);
			perSarah.showPerson("sarah15.jpg");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "conferencecharmslave5") {
			md = WritePlaceHeader(false, stage == "sarah1" || perYou.isMaleSex() && !isExplicit() ? "" : "td-left-med");
			if (stage == "sarah1") perSarah.showPerson("sarah16.jpg");
			else if (stage == "sarah2")
				if (perYou.isMaleSex()) this.showPersonX("gabby-sarahm.jpg");
				else this.showPerson("gabby-sarahf.jpg");
			else if (perYou.isMaleSex())
				if (isExplicit()) this.showPersonX("gabby14m.jpg");
				else this.showPersonX("gabby19.jpg");
			else this.showPerson("gabby14f.jpg");
			addPlaceTitle(md, "Gabby Under A Charm Spell");
			if (stage == "sarah1") {
				md.write("<p>\u201cHmh, it is my first chance to play with a charmed woman, is it?\u201d</p>" + "<p>Sarah rises from her chair and begins to take off her clothes, her eyes on you. \u201cOne rule, though. I am saving my virginity, so no penetration of any kind, understood?\u201d</p>" + "<p>You are a little surprised to hear that. Sarah isn't exactly an example of virginal purity, but the way she looks at you suggests that she takes this rule very serious, and you'll have your hands full with Gabby anyway.</p>");
				startQuestions();
				addLinkToPlaceC(md, '"Understood"', Place, "type=conferencecharmslave5&stage=sarah2")
			} else {
				if (stage == "sarah2") md.write("<p>Gabby is... intense.</p>" + "<p>With the spell having effectively eliminated her inhibitions, she is aggressive and often vicious in a way few other women you have been with are. She is openly struggling for dominance, but with you and Sarah working against her, it is easy to keep her under control.</p>" + "<p>Sarah in particular is interesting to watch. She seems to know how to handle someone like her and does so with both tender playfulness and sadistic glee, taking intense pleasure in both the control she has over the struggling, charmed woman and watching you take advantage of her.</p>" +
					"<p>You trade sloppy kisses with both women, and while Sarah makes sure to direct most of your attention to Gabby at first, she grows more open as time passes, both accepting your affections and repaying them as the three of you bring each other to orgasm and finally collapse together.</p>");
				else md.write("<p>Gabby is... intense.</p>" + "<p>She wants to hurt you as much as she wants you to enjoy yourself, and the sex feels more like a struggle for dominance than anything you have done so far.</p>" +
					"<p>And you kinda like it.</p>" + "<p>Your adrenaline is pumping as you pin each other to the bed, roll around, pull hair and trade sloppy kisses. Your body aching from both the strain and the many times she slapped your ass or dug her fingertips into your muscles, both gestures you made sure to repay in kind, and as you reach your peak, you are certain you'll both feel this workout for a while.</p>");
				startQuestions();
				addLinkToPlaceC(md, "gather your things and leave", 94, "", "Gabby still has her interview to conduct, which you are sure will be interesting, so you'll leave her at the Town hall for now and agree to meet with her later, after you found Mom.")
			}
			if (stage ==
				"sarahwatch") {
				AddPeopleColumn(md);
				perSarah.showPerson("sarah15.jpg")
			}
			WritePlaceFooter(md);
			return true
		}
		if (sType == "conferencecharmlover1") {
			this.charmThem(2);
			if (whereItem(67) === 0) PlaceI(67);
			md = WritePlaceHeader();
			this.showPerson("gabby11.jpg");
			addPlaceTitle(md, "Gabby Under A Charm Spell");
			md.write("<p>You are just here to get her away from Mom, at least that's what you tell her, explaining further that you've known her long enough to easily suspect that she is probably stiff as a plank in bed and just about as passionate as one.</p>" +
				"<p>It has the desired effect, if you wanted to make her furious, that is.</p>" + "<p>\u201cYou little " + (perYou.isBornMale() ? "bastard" : "bitch") + "...\u201d Gabby throws more of her clothes off, including the Necklace as she approaches you. \u201cHow is that for passion?\u201d</p>" + "<p>Your vision blurs as her palm suddenly connects with your face and you feel a dull pain spreading through the left half of it.</p>");
			if (bSarah) md.write("<p>You are pretty sure you hear Sarah giggling</p>");
			md.write("<pGabby just slapped you, and with quite some force.</p>" +
				"<p>You lift your arms in reflex, but she just brushes them aside, grabs your shirt and pushes your already dazed body against the wall behind you with a loud thud.</p>");
			startQuestions();
			addLinkToPlaceC(md, "order her to stop", Place, "type=conferencecharmlover2");
			if (bSarah) {
				AddPeopleColumn(md);
				perSarah.showPerson("sarah15.jpg")
			}
			WritePlaceFooter(md);
			return true
		}
		if (sType == "conferencecharmlover2") {
			md = WritePlaceHeader();
			this.showPerson("gabby12.jpg");
			addPlaceTitle(md, "Gabby Under A Charm Spell");
			md.write("<p>\u201cToo passionate?\u201d Gabby whispers in a condescending voice as she presses her naked body against you. \u201cOr too rough for you?\u201d You feel her lips on yours and your heart begins to race, the dull, throbbing pain on your left fading as she loosens her grip and gently drives her fingertips over your shoulders and along your cheeks.</p>" +
				"<p>Surprisingly: She's a good kisser...</p>" + "<p>You find yourself returning her affections, pulling her closer as you dance, no, fight with her tongue, a struggle for dominance going on for a minute with no clear winner as the kiss is broken.</p>" + "<p>\u201cI want you to fuck me so badly...\u201d Gabby whispers out of breath, her eyes locked on you, fully claimed by the spell. \u201cI hate you...\u201d You feel her fingertips digging painfully into your shoulder. \u201cYou are a stupid, meddling, cheating " +
				(perYou.isBornMale() ? "bastard" : "bitch") + ", and I have never wanted anyone so much, not even Alex.\u201d</p>");
			if (bSarah) md.write("<p>Sarah is sitting next to her, watching.</p>");
			startQuestions();
			addLinkToPlaceC(md, '"Speaking off, where is she?"', Place, "type=conferencecharmlover3");
			if (bSarah) {
				AddPeopleColumn(md);
				perSarah.showPerson("sarah15.jpg")
			}
			WritePlaceFooter(md);
			return true
		}
		if (sType == "conferencecharmlover3") {
			md = WritePlaceHeader(false, "td-left-med");
			setPlaceKnown("GabbysHouse");
			this.showPerson("gabby13.jpg");
			addPlaceTitle(md, "Gabby Under A Charm Spell");
			md.write("<p>It's not an effect you had expected. Gabby is clearly under your spell, but she is neither submissive nor does she really seem to love you, but she is still beholden to follow your orders, as shown when you tell her to let you to let go off you and tell you about Mom.</p>" + "<p>\u201cFine, she is in my home, 11 Amaranth place, keys are in my handbag if you want to get her... however... \u201dShe lies down on the bed and gives herself a slap on the rear. \u201cI'd much rather be doing something else first...\u201d</p>");
			if (bSarah) md.write("<p>Sarah is sitting next to her, watching.</p>");
			startQuestions();
			startAlternatives(md);
			addLinkToPlaceC(md, "take the key and leave", Place, "type=conferencecharmleave");
			if (!bSarah) addLinkToPlaceC(md, "take her up on her offer", Place, "type=conferencecharmslave5");
			else addLinkToPlaceC(md, "take her up on her offer", Place, "type=conferencecharmslave4");
			endAlternatives(md);
			if (bSarah) {
				AddPeopleColumn(md);
				perSarah.showPerson("sarah15.jpg")
			}
			WritePlaceFooter(md);
			return true
		}
		if (sType == "conferencecharmmomservant1") {
			this.charmThem(1);
			if (whereItem(67) === 0) PlaceI(67);
			md = WritePlaceHeader();
			this.showPerson("gabby11.jpg");
			addPlaceTitle(md, "Gabby Under A Charm Spell");
			md.write("<p>\u201cI'll do what?\u201d Gabby looks outraged. \u201cYou can't cast that spell on me and just shove me away! I need... I want... Damn you!\u201d</p>" + "<p>Again, you feel like she wants to hit you, but can't quite bring herself to do so, and you push her further while the spell is still molding her mind.</p>" + "<p>\u201cYou want to please me, Gabby, do you?\u201d</p>" +
				"<p>Silence.</p>" + "<p>\u201cI know you do, and I believe you can serve me best when you serve my mother.\u201d</p>" + "<p>\u201cI... I don't...\u201c Gabby stutters, clearly confused.</p>" + "<p>\u201cI want you to be the best assistant you can be, read every wish off her lips and do whatever she wants you to do.\u201d There's a certain amount of irony in turning her into a slave to the woman she tried to enslave herself, and you like that.</p>" + "<p>\u201cBut.... but I want to be yours...\u201d Either she has forgotten that she hates you, or she really doesnt want to be Mom's servant.</p>");
			if (bSarah) md.write("<p>You are pretty sure you hear Sarah giggling</p>");
			startQuestions();
			addLinkToPlaceC(md, "she'll serve you by serving your Mom", Place, "type=conferencecharmmomservant2");
			if (bSarah) {
				AddPeopleColumn(md);
				perSarah.showPerson("sarah15.jpg")
			}
			WritePlaceFooter(md);
			return true
		}
		if (sType == "conferencecharmmomservant2") {
			md = WritePlaceHeader();
			this.showPerson("gabby12.jpg");
			addPlaceTitle(md, "Gabby Under A Charm Spell");
			md.write("<p>\u201cYou will be, and I assign you to serve my Mother, your boss, and in serving her, you'll serve me, doesn't that make sense?\u201d</p>" +
				"<p>Gabby's mind is racing, her expression shifting between rage and confusion as the spell forces her to accept your words as truth.</p>" + "<p>\u201cIt... does...\u201d</p>" + "<p>\u201cSo what will you do?\u201d</p>" + "<p>\u201cI will serve you by devoting myself to serving Alex and fulfilling her every wish...\u201d</p>" + "<p>\u201cGood Girl.\u201d</p>" + "<p>Gabby still looks less than pleased with this outcome, but it feels like a fitting punishment for her.</p>" + "<p>She probably won't be available for quick sex when she is with Mom, well unless...</p>" +
				"<p>No, that's a bridge you cross when you get there.</p>");
			if (bSarah) md.write("<p>You are pretty sure you hear Sarah giggling</p>");
			startQuestions();
			if (!this.checkFlag(14)) addQuestionR(md, '"First things first, where\'s Mom?"', "\u201cAlex is at my home on 11 Amaranth place, awaiting her full indoctrination.\u201d Gabby reluctantly hands you the keys. \u201cDo with her as you wish.\u201c</p><p>You take the keys and order Gabby to finish whatever business she has here, mostly her interview.</p><p>You will visit later to make sure she is doing as told.",
				"Gabby", "setPersonFlag(\\'Gabby\\',14);setPlaceKnown(\\'GabbysHouse\\')");
			else addLinkToPlaceC(md, "leave the room", 94, "", "You gather up what you need and leave through the open door... didn't you close it?</p><p>You are not sure, but at least no one walked in on you. ");
			if (bSarah) {
				AddPeopleColumn(md);
				perSarah.showPerson("sarah15.jpg")
			}
			WritePlaceFooter(md);
			return true
		}
		return false
	};
	per.showEventTrap = function() {
		var perTina = findPerson("Tina");
		var stage = getQueryParam("stage");
		var q1 = getQueryParam("q1");
		var q2 = getQueryParam("q2");
		var q3 = getQueryParam("q3");
		if (sType == "gabbyhouseapproach") {
			md = WritePlaceHeader();
			addPlaceTitle(md, "Gabby's Front Door", "house9-frontdoor.jpg");
			md.write("<p>The door is locked, the windows are blacked out and no one reacts when you ring the doorbell. The place looks empty, though it's not like Gabby has any reason to open the door for you to begin with.</p>");
			if (perTina.place == -1) md.write("<p>Tina approaches the house at the same time you do, she looks a little nervous.</p>");
			if (isSpellKnown("Pass")) md.write("<p>It's strange, the house actually seems to be warded in some way. There are some similarities to the protections on the Gates mansion, but they are not nearly as strong and, in fact, quite uneven.</p>" + "<p>It doesn't take you long to develop a feel for the magical energies forming the wards, and after walking around the house once, you notice one spot in particular where it is thin enough for you to effortlessly pass through.</p>");
			startQuestions();
			if (isSpellKnown("Pass")) {
				startAlternatives(md);
				if (nMana < 2) addTextForQuestions(md, "<b>You do not have enough mana to cast pass so you are stuck here</p>", "center");
				else if (perTina.place != -1) addLinkToPlaceC(md, "pass into the house", 453, "type=gabbyhousestudy1", "It feels a bit like passing through a fragile spider-net. The wards stretch for maybe a second before breaking away and letting you pass through into what looks like Gabby's home office.</p><p>The room is very clean and bears similarity's to Gabby's workplace at the studio. It should be easy to snoop around and find something.",
					"", "AddMana(-2)");
				else addLinkToPlaceC(md, "pass into the house", 453, "type=gabbyhousestudy1", "You take Tina's hand and recast the spell, allowing both of you to walk through the wall into the house.</p><p>It feels a bit like passing through a fragile spider-net. The wards stretch for maybe a second before breaking away and letting you pass through into what looks like Gabby's home office.</p><p>The room is very clean and bears similarity's to Gabby's workplace at the studio. It should be easy to snoop around and find something.",
					"", "AddMana(-2)");
				addLinkToPlaceC(md, "not now", 38, "", "Right... this spot feels a little too obvious. You don't really know what you find on the other side of the wall. Maybe you know someone who knows about wards and other magic symbols or could help with any magical traps?", "", "setPersonFlag('Gabby',15)");
				endAlternatives(md)
			} else addLinkToPlaceC(md, "return to the street", 38);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "gabbyhousestudy1") {
			md = WritePlaceHeader();
			addPlaceTitle(md, "Gabby's House", "livingroom-gabby.jpg");
			md.write("<p>You take the first, steps into the room, careful not to make too much noise, but something is not... right.</p>" + "<p>You feel an unpleasant tingle in the back of your neck. The sensation quickly spreads through your entire body with every step taken, and before you are really able to react, you find the strength leaving your body and fall to your knees.</p>");
			if (perTina.place == -1) md.write("<p>You look around and find Tina on her knees as well, her eyes fearfully darting through the room.</p>");
			startQuestions();
			addLinkToPlaceC(md, "what's happening?", Place, "type=gabbyhousestudy2");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "gabbyhousestudy2") {
			md = WritePlaceHeader();
			addPlaceTitle(md, "Gabby's Trap", "livingroom-gabby.jpg");
			md.write("<p>This is bad... your head is spinning and your body locked in place. You try to muster enough magical energy for a spell, but can't seem to focus your mana. In panic, you look around the room and finally notice the strange markings on every wall, unknown to you, but clearly magical in nature, and after a minute of struggling, Gabby appears in the door.</p>" +
				"<p>\u201c" + perYou.getPersonName() + "... I suspected that someone had spied on us and searched my office, but I had still hoped it wouldn\t be you I'd find here...\u201d</p>");
			startQuestions();
			addLinkToPlaceC(md, "look at Gabby", Place, "type=gabbyhousestudy3");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "gabbyhousestudy3") {
			md = WritePlaceHeader();
			this.showPerson("gabby1.jpg");
			addPlaceTitle(md, "Gabby's Trap");
			md.write("<p>Gabby's eyes seem to burn a hole into you as she looks over your kneeling, helpless body, her voice cold, not unlike Moms when she gives an \u201cI'm not mad, just disappointed\u201d speech.</p>" +
				"<p>\u201cSo I was right, you are using spells from the book of control. Are you also the one responsible for the death of its guardian?\u201d</p>");
			startQuestions();
			addLinkToPlaceC(md, "She knows of the book?", Place, "type=gabbyhousestudy4");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "gabbyhousestudy4") {
			md = WritePlaceHeader();
			this.showPerson("gabby1.jpg");
			addPlaceTitle(md, "Gabby's Trap");
			md.write("<p>\u201cOf course, I do. My ancestors had been involved with Kurndorf, and while I do not share their... ambitions I do keep track of the supernatural Community.\u201d Her expression darkens.</p>" +
				"<p>\u201cWhen I heard of the murder of Sir Gates, I knew someone must have stolen it, and when Alex began to tell me about the stained shirt and how popular you are suddenly with the girls it was easy to put two and two together.\u201d</p>" + "<p>\u201cNow please answer my question: Did you kill Sir Ronald Gates?\u201d</p>");
			startQuestions();
			if (isMurderPath(true)) addLinkToPlaceC(md, '"No, but you witnessed Davy Robbins do it"', Place, "type=gabbyhousestudy5", "\u201cDavy Robbins?\u201d She tilts her head and you explain that he is a classmate of yours who recently turned out to be a warlock.</p><p>Another Warlock... that's even more complications to take care off.\u201d");
			else {
				startAlternatives(md);
				addLinkToPlaceC(md, 'Truth - "Yes, but it was an accident"', Place, "type=gabbyhousestudy5", "\u201cYou just happened to accidentally shoot a man and steal his most priceless possession?\u201d</p><p>\u201cReally, now?", "Gabby");
				addLinkToPlaceC(md, 'Lie - "No, he was already dead when you arrived at the mansion"', Place, "type=gabbyhousestudy5", "\u201cAnd then you just took the book the murderer left behind and ran?\u201d She tilts her head. \u201cI want to believe you, for Alex's sake, but I'm not sure I can.\u201d",
					"Gabby");
				endAlternatives(md)
			}
			WritePlaceFooter(md);
			return true
		}
		if (sType == "gabbyhousestudy5") {
			md = WritePlaceHeader();
			this.showPerson("gabby1.jpg");
			addPlaceTitle(md, "Gabby's Trap");
			md.write("<p>Gabby sights. \u201cIt doesn't matter, anyway. The damage is done, but I won't let you cause your mother any more grief.</p>");
			startQuestions();
			if (q1 != "asked") addLinkToPlaceC(md, "Grief? She is using Hypnosis to have sex with her!", Place, "type=gabbyhousestudy5&q1=asked", "\u201cYour Mother and I had been intimate long before she allowed me to hypnotize her for the first time. I love her dearly and would never force anything sexually on her we hadn't agreed on before.\u201d</p><p>Wait what? That's completely new to you, Mom surely never mentioned it.</p><p>\u201cWe had to keep it a secret because of work regulations, the hypnosis used to be just a little kink of mine she allowed me to live out.\u201d</p><p>You didn't know that... but in retrospect a lot of things between them suddenly make a lot more sense...");
			else if (q2 != "asked") addLinkToPlaceC(md, '"But you saw her trying to turn Mom into a slave"', Place, "type=gabbyhousestudy5&q1=asked&q2=asked", "\u201cI am protecting her, from you!\u201d Your eyes go wide at that statement. \u201cShe wouldn't have listened to me had I told her that her " + (perYou.isBornMale() ? "Son" : "Daughter") + " is using magic to enslave people, so I had to get her away from you before you would use that spell on her as well.\u201d", "Gabby");
			else {
				startAlternatives(md);
				addLinkToPlaceC(md,
					"tell her that you would never do that to your own mother (Truth)", Place, "type=gabbyhousestudy6", "\u201cMaybe not now, but you clearly have a lot less restraint on others. The power of the Dai Chu is tempting to the greatest of minds and, frankly, you are a teenager. Your mind is controlled by your hormones and it wouldn't be long until breaking simple taboos no longer suffices." + (perTina.place == -1 ? " You even have one of these spellbound girls with you right now!\u201d" : "\u201d"), "Gabby");
				addLinkToPlaceC(md,
					"tell her that you would never do that to your own mother (Lie)", Place, "type=gabbyhousestudy6", "\u201cMaybe not now, but you clearly have a lot less restraint on others. The power of the Dai Chu is tempting to the greatest of minds and, frankly, you are a teenager. Your mind is controlled by your hormones and it wouldn't be long until breaking simple taboos no longer suffices." + (perTina.place == -1 ? " You even have one of these spellbound girls with you right now!\u201d" : "\u201d"), "Gabby");
				addLinkToPlaceC(md,
					"tell her that it's not her business", Place, "type=gabbyhousestudy6", "\u201cYes it is.\u201d She says flatly. \u201cOr do you expect me to wait until it is my turn to be charmed?\u201d", "Gabby");
				endAlternatives(md)
			}
			WritePlaceFooter(md);
			return true
		}
		if (sType == "gabbyhousestudy6") {
			md = WritePlaceHeader();
			this.showPerson("gabby1.jpg");
			addPlaceTitle(md, "Gabby's Trap");
			md.write("<p>This is no use, Gabby has made up her mind, and you are frankly not in the mood to be scolded by her... if you only had a way out...</p>");
			if (perTina.place == -1) md.write("<p>\u201cI figured it out!\u201d Tina Suddenly whispers from behind you. \u201cThese sigils may use a special Mana-infused ink, and if I'm right, I might be able to absorb it. But I need time.\u201d</p>");
			startQuestions();
			addLinkToPlaceC(md, "ask Gabby what she is planning to do now", Place, "type=gabbyhousestudy7");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "gabbyhousestudy7") {
			md = WritePlaceHeader();
			this.showPerson("gabby1.jpg");
			addPlaceTitle(md, "Gabby's Trap");
			md.write("<p>\u201cNow you will look at this Necklace.\u201d</p>" +
				"<p>Shit.</p>" + "<p>\u201cYou usually can not put someone into a trance who is not willing, but the sigils are siphoning away your strength and willpower as we speak, and with this trinket, it should only be a mater of time until it works.\u201d</p>" + "<p>Double shit.</p>" + "<p>You strain against whatever force binds your body, but it's of no use, you are held in place, no matter what you do, forced to look forward, forced to watch the necklace... forced to listen to Gabby speak to you, her voice suddenly soft, almost velvety.</p>" +
				"<p>\u201cShhh... you should relax, " + perYou.getPersonName() + ". I just want to help your Mom, and I just want to help you, you can <b>trust me</b>.</p>");
			startQuestions();
			addLinkToPlaceC(md, "grind your teeth and be silent", Place, "type=gabbyhousestudy8");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "gabbyhousestudy8") {
			md = WritePlaceHeader();
			this.showPerson("gabby1.jpg");
			addPlaceTitle(md, "Gabby's Trap");
			md.write("<p>\u201cYou can feel your focus fading already, can you? You can feel the need to let your mind drift, let your guard falter.\u201d</p>" +
				"<p>Gabby speaks on, unimpressed by your reaction and keeping a gentle, voice so very much unlike the way she usually speaks to you.\u201d</p>" + "<p>\u201cYou are safe " + perYou.getPersonName() + " no one is here to harm you, no one is here to judge you. You can let yourself fall, you want to let yourself fall. There is no reason to be on your guard, no reason not to <b>trust me</b>...</p>");
			startQuestions();
			addLinkToPlaceC(md, '"Trust... you..."', Place, "type=gabbyhousestudy9");
			WritePlaceFooter(md);
			return true
		}
		if (sType ==
			"gabbyhousestudy9") {
			md = WritePlaceHeader();
			this.showPerson("gabby1.jpg");
			addPlaceTitle(md, "Gabby's Trap");
			md.write("<p>You could kick yourself for saying that, it can't be that easy for you to fall under her sway, but what choice do you have?</p>" + "<p>No one is going to come to rescue you, isn't it so? Gabby has as long as she needs to slowly break down your resistance, and how bad could what she has in mind for you really be?</p>" + "<p>\u201cNo one is going to harm you. No one is bearing you any ill will.\u201d Gabby's soft voice echos inside your head. Warm and velvety, washing over your thoughts like a soft, silken blanket. \u201cYou will enjoy letting yourself go, " +
				perYou.getPersonName() + " You will enjoy letting your mind drift off to focus on the Necklace, to focus just on my voice.\u201d</p>" + "<p>\u201cRemember, you can <b>Trust me</b>.\u201d</p>");
			if (perTina.place == -1) md.write("<p>\u201cI'm ready.\u201d Tina once again whispers from behind you. \u201dJust say the word!\u201d</p>");
			startQuestions();
			startAlternatives(md);
			addLinkToPlaceC(md, "trust her", Place, "type=gabbyhousestudybadend1");
			addLinkToPlaceC(md, "continue to struggle", Place, "type=gabbyhousestudybadend2");
			if (perTina.place == -1) addLinkToPlaceC(md, "order Tina to break the seals", Place, "type=gabbyhousestudy10");
			endAlternatives(md);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "gabbyhousestudybadend1") {
			md = WritePlaceHeader();
			this.showPerson("gabby-badend1.jpg");
			addPlaceTitle(md, "Trust Her");
			md.write("<p>It took some time to accept that taking the book was a mistake, just like using the spells within for your own selfish ends was, but with the help of Mistress Halliway, you brought your life back on track.</p>" +
				"<p>She helped you study like you never did before, and while your grades aren't perfect, you passed the final year and are headed for an internship at the TV studio, where she can, as she puts it, have an eye on you.</p>" + "<p>With her help, you freed most of the women you had cast the spell on, it wasn't a very nice thing to do that anyway, and oh, she is scheduled to marry your Mother next month! This will make her your Mistress, and your stepmom, which is awesome, of course.</p>" + "<p>Still... something feels off. Your life is going pretty great but you can't shake the feeling that it's all wrong, that you are being cheated out of... something.</p>" +
				"<p>Mistress keeps you on a very tight leash, sometimes literally, and sometimes... just maybe you feel like the control she has over your life is smothering.</p>" + "<p>You have to talk to her about it later, she has always means to make that feeling go away, and you enjoy the sessions with her, enjoy being in a trance, under her command.... enjoy to fully... trust her.</p>");
			startQuestionsOnly();
			addRestartLink(md);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "gabbyhousestudybadend2") {
			md = WritePlaceHeader();
			this.showPerson("gabby-badend2.jpg");
			addPlaceTitle(md, "Struggling");
			md.write("<p>In the next hours... days.... weeks? You are honestly not sure how much time you spend with Gabby, but it's an arduous process.</p>" + "<p>You sometimes fall into a trance during the evening only to wake up the next morning, and every time it happens, you feel your mind move a little closer to the inevitable end, that moment when you finally break down and accept everything she says to you.</p>" + "<p>Hell, you are already not sure how much of your current thoughts are hers and how much are yours, and yet, you still hold on to yourself, to that thought that maybe you can beat her if you resist long enough, that she can't do this forever...</p>" +
				"<p>But of course, if Gabby has anything, then it is patience, your struggle will last for a long while and every time you wake up, her victory seems a little closer.</p>" + "<p>Still... you hold on, you have to hold on...</p>" + "<p>And just maybe... one day it will pay off.</p>");
			startQuestionsOnly();
			addRestartLink(md);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "gabbyhousestudy10") {
			md = WritePlaceHeader();
			AddMana(10);
			this.showPerson("gabby-charm1.jpg");
			addPlaceTitle(md, "Gabby's Trap Broken");
			md.write("<p>Tina absorbs the mana from the sigils and gives it to you, immediately breaking the bonds that hold both of you.</p>" +
				"<p>You feel your strength coming back the moment the ward breaks. Clarity returns to your mind, and the mana within you, up until now scattered and unfocused, begins to untangle, to flow freely once again.</p>" + "<p>Gabby must have noticed, and her eyes open wide in fear as she realizes what you are about to do.</p>");
			startQuestions();
			addLinkToPlaceC(md, "leave the house", Place, "type=gabbyhousestudy10", "You don't know if Gabby has any other tricks and there's no way you loose this chance to charm her.");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "studycharm1") {
			md = WritePlaceHeader();
			if (whereItem(67) === 0) PlaceI(67);
			this.showPerson("gabby-charm2.jpg");
			addPlaceTitle(md, "Gabby Under A Charm Spell");
			md.write("<p>\u201cDai Chu, Gabrielle Halliway!\u201d You defiantly shout the words and let your mana crash into her, watching tensely as her eyes begin to lose focus and the first specs of pink glister appear behind them.</p>" + "<p>\u201cPlease, " + perYou.getPersonName() + ", You don't have to do this! I just... wanted to... I want to...\u201d</p>" +
				"<p>You reach out and take the necklace from Gabby's neck but it falls to the ground as Gabby tries to stop you.</p>");
			startQuestions();
			startAlternatives(md);
			addLinkToPlaceC(md, "She wants to fuck you", Place, "type=studycharmlover1");
			addLinkToPlaceC(md, "She wants to be punished for her behavior", Place, "type=studycharmslave1");
			addLinkToPlaceC(md, "She just wants to be with Mom", Place, "type=studycharmmomservant1");
			endAlternatives(md);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "studycharmlover1") {
			this.charmThem(2);
			md = WritePlaceHeader();
			this.showPerson("gabby-charmlover1.jpg");
			addPlaceTitle(md, "Gabby Under A Charm Spell");
			md.write("<p>\u201cNo!\u201d</p>" + "<p>\u201cOf course you do, don't you feel it, Gabrielle?\u201d You do your best to speak in a calm voice, though the ordeal has left you somewhat agitated. \u201cDoesn't it make you wet just thinking about all the ways I will soon take you? Doesn't it make you want to throw off your clothing and Undress!?\u201d</p>" + "<p>\u201cDamn you...\u201d Gabby's eyes are filled with spite, but her hands are moving by themselves, tearing off her shirt and pushing down her dress. \u201cPlease... stop.... this...\u201d</p>");
			startQuestions();
			addLinkToPlaceC(md, '"You couldnt stop it if you wanted to, now. And you don\'t want to"', Place, "type=studycharmlover2");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "studycharmlover2") {
			md = WritePlaceHeader();
			this.showPerson("gabby-charmlover2.jpg");
			addPlaceTitle(md, "Gabby Under A Charm Spell");
			md.write("<p>\u201cIt's too late to stop it now, Gabrielle, and you don't want me to stop anyway, do you?\u201d</p>" + "<p>\u201cNo... I...\u201d</p>" + "<p>\u201cJust look at that sexy underwear you are wearing.\u201d You interrupt her. \u201dYou were secretly hoping I would overcome your trap, right?\u201d</p>" +
				"<p>Well, you are pretty sure she wasn't, But Maybe you can get her to think she was. \u201cIt would be much easier to just be honest and give in.\u201d</p>" + "<p>\u201cHonest my ass... I know what game you're playing, and... maybe you are...\u201d Gabby's face shows a plethora of emotions: Anger, fear, confusion, and slowly growing desire...</p>" + "<p>\u201cNo... I would never...\u201d She stops mid sentence, her features showing traces of doubt.</p>" + "<p>\u201cI really...\u201d She bites her lower lip, chest heaving under heavy breathers.</p>" +
				"<p>Oh fuck it!\u201d</p>");
			startQuestions();
			addLinkToPlaceC(md, "Gabby turns around", Place, "type=studycharmlover3");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "studycharmlover3") {
			md = WritePlaceHeader();
			this.showPerson("gabby-charmlover3.jpg");
			addPlaceTitle(md, "Gabby Under A Charm Spell");
			md.write("<p>\u201cYou win, " + perYou.getPersonName() + "!\u201d She leans over the table. \u201cYes, I want you, I want you to finger my pussy and slap my tits, I want to feel your fucking " + (perYou.isMaleSex() ? "cock inside me" :
				"cunt against mine") + "! So please, hurry up! If I have to be some stupid teenagers fucktoy I'm better getting the best fucking pounding of my life out of it!\u201d</p>");
			startQuestions();
			addLinkToPlaceC(md, "give her what she desires", Place, "type=studycharmlover4");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "studycharmlover4") {
			md = WritePlaceHeader(false, isExplicit() ? "" : "td-left-large");
			this.showPersonX("gabby-charmlover4.jpg");
			addPlaceTitle(md, "Gabby Under A Charm Spell");
			md.write("<p>Gabby is the last person you expected an angry outburst like this from, but at this point, you don't mind it at all. She tried to steal your Mother, lured you into a trap and wanted to hypnotize you, so now that she is practically begging for you to take out some of your frustration on her, you gladly follow up.</p>" +
				"<p>She exhales a lustful groan as you pull her hair back and roughly push into her waiting sex, not caring for her comfort as you pin her down and give her exactly what she now craves.</p>" + "<p>\u201cOh yes you fucking teenage " + (perYou.isBornMale() ? "Bastard" : "Bitch") + "... fuckmefuckmefuckme... \u201c Gabby is almost ferocious in the way she offers herself, spitting expletives and insults to rile you up further and not once stopping until both of you reach a hard-earned, but satisfying climax, her exhausted body falling flat on the table, eyes almost delirious from the workout.</p>" +
				"<p>\u201cFuck... I hate you so much... but that was almost worth it... almost.\u201d</p>");
			startQuestions();
			addLinkToPlaceC(md, "tell her to wait here as you look for Mom", 452, "", "\u201cYes... sure...\u201d She breathes out in exhaustion, obviously having given up on trying to stop you, but when you prepare to leave the room, she calls your attention again.</p><p>\u201cAre you really going to... well...\u201d She bites her lower lip, not daring to finish the thought, and you simply answer with another question.</p><p>\u201cWould you mind if I did now?\u201d</p><p>\u201cNo... of course not.\u201d There is an uncomfortable delay before she answers, and you decide to not speak further of it. Maybe you have already made up your mind on the matter, maybe not, but it is no longer her concern.");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "studycharmslave1") {
			this.charmThem(4);
			md = WritePlaceHeader();
			this.showPerson("gabby-charmslave1.jpg");
			addPlaceTitle(md, "Gabby Under A Charm Spell");
			md.write("<p>\u201cBe quiet and undress, Gabrielle.\u201d</p>" + "<p>You bellow the words out with a harshness surprising even yourself and there is really no denying it: Gabby has pissed you off. She tries to turn your mother into her sexslave, lays out a trap for you, tries to Hypnotize you and then has the audacity to lecture you on the responsible usage of magic?!</p>" +
				"<p>\u201cAnd no, I don't need to do this, but I want to, and you will soon want me to do it, to.\u201d</p>" + "<p>\u201c" + perYou.getPersonName() + ", Please...\u201d She has already torn off most off her clothing after your initial order, the fear in her eyes slowly mixing with arousal. \u201cI...\u201d</p>");
			startQuestions();
			addLinkToPlaceC(md, "order her to be quiet and turn around", Place, "type=studycharmslave2");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "studycharmslave2") {
			md = WritePlaceHeader();
			this.showPerson("gabby-charmslave2.jpg");
			addPlaceTitle(md, "Gabby Under A Charm Spell");
			md.write("<p>Again, Gabby follows your orders without hesitation, surprisingly, given the early state of her induction, and you feel her tremble as you step closer and draw your fingers over her naked ass, pull back, and bring your hand down harshly.</p>" + "<p>\u201cAhhh!\u201d</p>" + "<p>\u201cThat was a surprisingly sensual noise, looks like you liked that a little.\u201d</p>" + "<p>\u201cThat's the spell you... uuuuhhhhgn...!\u201d</p>" + "<p>Another slap interrupts her, and she bites her lower lip to muffle the noise. Gabby is right, of course, the spell increases her sensitivity, makes her more receptive to your touch, even enjoy the humiliation, but soon, she will no longer care.</p>");
			startQuestions();
			addLinkToPlaceC(md, "punish her", Place, "type=studycharmslave3");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "studycharmslave3") {
			md = WritePlaceHeader(false, "td-left-med");
			this.showPerson("gabby-charmslave3.jpg");
			addPlaceTitle(md, "Gabby Under A Charm Spell");
			md.write("<p>You find a sturdy looking ruler almost suspiciously perfect for your needs and bring it down on Gabby's ass with a satisfying whack.</p>" + "<p>\u201cNo, Gabrielle, I believe you want to be punished.\u201d The next strike leaves a red imprint on her ass.</p>" +
				"<p>\u201cIn fact, you crave it.\u201d</p>" + "<p>*Whack*</p>" + "<p>\u201cYou get off on it!\u201d</p>" + "<p>*Whack*</p>" + "<p>\u201cJust look at how wet your pussy is.\u201d</p>" + "<p>Gabby doesn't answer as you push the ruler into her folds, coat it in her juices and splat those on her ass with the next strike. Her brain focused on processing the onslaught of new sensations flooding her mind.</p>" + "<p>\u201cFuck... this is... fuck...\u201d</p>");
			startQuestions();
			addLinkToPlaceC(md, "show her how much she likes it",
				Place, "type=studycharmslave4");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "studycharmslave4") {
			md = WritePlaceHeader();
			this.showPerson("gabby-charmslave4.jpg");
			addPlaceTitle(md, "Gabby Under A Charm Spell");
			md.write("<p>You draw your fingertips over her red skin. \u201c-This- will be how you get off from now on.\u201c She groans as you bring the ruler down again. \u201cMasturbation will no longer suffice, sex will no longer suffice.\u201c Another strike hits her. \u201dYou need the rush of adrenaline that comes with being treated like a kinky little painslut. You crave to be punished and humiliated like a naughty little slavegirl and you need me to do it.\u201d</p>" +
				"<p>\u201cNo, I ahh....ahhhhhhhhhh...\u201d</p>" + "<p>You strike her again, and again. Your mind taken over by a formerly unknown instinct to punish this woman, to push her to the limit and make her scream in both pain and pleasure as your spell ravages her mind, and only when she screams her climax into the room, you stop.</p>" + "<p>\u201c...You just came, did you?\u201d This was more of a rhetoric question. Her body convulses under your touch and streams of her fluids run down her legs, so it's pretty obvious that she is literally cumming her brains out from your treatment.</p>" +
				"<p>\u201cYou really came from being spanked by me... maybe you secretly already were a little Painslut.\u201d</p>" + "<p>\u201c... Fuck... you, " + perYou.getPersonName() + ".\u201d</p>" + "<p>\u201cI take that as a yes.\u201d</p>" + "<p>You have to give it to her, she's not someone who easily submits. Even under your spell and with her mind likely all over the place from your treatment, she is still able to spit out some token bile at you.</p>" + "<p>But that's okay, you never wanted her to submit, just to crave punishment for what she did, and not only are you pretty sure achieved that goal, you have a few ideas to exploit her newfound masochism, but for now, you need to find Mom.</p>");
			startQuestions();
			addLinkToPlaceC(md, "order Gabby to rest here and leave the room", 452, "", "Gabby gives a tired and annoyed grunt in response, but remains on the table, not stopping you as you leave the room.");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "studycharmmomservant1") {
			this.charmThem(1);
			md = WritePlaceHeader();
			this.showPerson("gabby-charm3.jpg");
			addPlaceTitle(md, "Gabby Under A Charm Spell");
			md.write("<p>There is something dark in you that wants to claim Gabby as your own, even wants to punish her for that trap, but in the end, you push that feeling deep down and bury it inside you.</p>" +
				"<p>\u201cNo, you don't want me.\u201d You say, much to her bewilderment. \u201cWell, maybe a little, but I'm not going to take away my Mom's lover.\u201d</p>" + "<p>\u201cI don't understand...\u201d You can see specs of pink light in her eyes, the spell is starting to affect her mind, awaiting your guidance. \u201cI want to... You can't... dammit what am I saying?\u201d</p>");
			startQuestions();
			addLinkToPlaceC(md, "tell her to be with Mom, and out of your way", Place, "type=studycharmmomservant2");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "studycharmmomservant2") {
			md = WritePlaceHeader();
			this.showPerson("gabby-charm4.jpg");
			addPlaceTitle(md, "Gabby Under A Charm Spell");
			md.write("<p>\u201cIt's not like I'm not grateful, but you can't tell me you don't want all this.\u201d</p>" + "<p>Gabby pulls off her shirt and poses for you in her underwear, her eyes challenging you to come closer only for her to suddenly take a step back from you.</p>" + "<p>\u201cOh hell... what am I doing...? What game are you playing, " + perYou.getPersonName() +
				"?\u201d</p>" + "<p>\u201cThere is no game, you will do everything you can to make my Mom happy, and you will no longer be opposed to me using the spell on people, in fact. You find it quite sexy that I do.\u201d</p>" + "<p>\u201cGabby opens her mouth to protest, but you cut her off with a sudden rush of arousal.\u201d</p>" + "<p>\u201cRepeat: I like it when " + perYou.getPersonName() + " uses " + perYou.getHisHer() + " Magic on other women.\u201d</p>" + "<p>\u201cI... ahhh...\u201d She moans heavily. \u201cI like it when " +
				perYou.getPersonName() + " uses " + perYou.getHisHer() + " Magic on other women.\u201d</p>" + "<p>\u201c" + capitalizeFirstLetter(perYou.getHeShe()) + " should be able to use his gift however " + capitalizeFirstLetter(perYou.getHeShe()) + " wants.\u201d</p>" + "<p>\u201c" + capitalizeFirstLetter(perYou.getHeShe()) + " should... should be able to use his gift how... however " + capitalizeFirstLetter(perYou.getHeShe()) + " wants.\u201d</p>" + "<p>\u201cI will support " + perYou.getHimHer() + " and " + perYou.getHisHer() + " mother in all things, I will work hard to serve Alex\u201d</p>" +
				"<p>\u201cI will support " + perYou.getHimHer() + " and " + perYou.getHisHer() + " mother in all things.\u201d She breathes the words out hastily. \u201cI will work hard to serve A... Alex... Ahhhhhh...\u201d</p>" + "<p>You push her arousal as much as you can to make her climax, hopefully imprinting those words on her mind in the process, leaving her heavily gasping for air.</p>" + "<p>\u201cThis was... intense...\u201d She looks at you, her eyes now fully taken over. \u201cI... actually liked that, I really do like it when you use your magic.\u201d</p>" +
				"<p>There is a certain longing in her eyes, but with the spell being mostly unguided, she shouldn't be influenced too much.</p>");
			startQuestions();
			addLinkToPlaceC(md, "order Gabby to rest here and leave the room", 452, "", "Gabby won't be a problem anymore, you are sure of it, and while she is not happy to be ordered around, she agrees to wait for you to free Mom, even telling you where to find her.</p><p>A part of you wonders if you could have gotten more from her. Sure, she is your mothers lover, but Mom might be willing to share if you...</p><p>No, this is a bridge you cross later.");
			WritePlaceFooter(md);
			return true
		}
		var perVamp = findPerson("Vampyre");
		if (sType == "vamphelpgabby") {
			md = WritePlaceHeader();
			perVamp.health -= 20;
			if (whereItem(67) === 0) PlaceI(67);
			perVamp.showPerson("vamp2.jpg");
			addPlaceTitle(md, "Lilith's Help");
			md.write("<p>On your order, the Vampyre is next to you.</p>" + "<p>You don't even know how she broke in, but the creature breached the much stronger wards of the Gates mansion, so this must have been easy for her.</p>" + "<p>Gabby doesn't even have time to scream before the Vampyre is behind her, moving with inhuman speed and sinking its fangs into her neck.</p>" +
				"<p>\u201cA...ah...haaaaa...\u201d</p>" + "<p>You watch as her expression changes from horror to ecstasy, a series of pained gasp leading into a long, lascivious moan. Her body twitches, struggles briefly against Lilith's embrace... then relaxes... and goes limp.</p>" + "<p>You see the necklace must of been torn free and has fallen to the ground.</p>");
			startQuestions();
			startAlternatives(md);
			addLinkToPlaceC(md, "order Lilith to stop", 452, "type=vamphelpgabby2&stage=stop");
			addLinkToPlaceC(md, "just watch",
				452, "type=vamphelpgabby2&stage=watch");
			endAlternatives(md);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "vamphelpgabby2") {
			md = WritePlaceHeader();
			perVamp.showPerson("vamp2.jpg");
			addPlaceTitle(md, "Lilith's Help");
			if (stage == "stop") md.write("<p>Lilith just chuckles coldly as she pulls back from Gabby's neck</p>" + "<p>\u201cShe will live, " + perYou.getMaster() + ".\u201d She licks over the wound on Gabby's neck and Kisses her on the lips, long and intimate, claiming her like a feral beast.</p>" + "<p>\u201cIt would be a waste to kill her.\u201d She finally turns back to you. \u201dHer blood has the faintest trace of a witches taste, too weak to affect me, but delicious nonetheless...\u201d She smiles wickedly. \u201dI have turned her into my Ghoul... Our Ghoul.\u201d</p>");
			else if (stage == "watch") md.write("<p>Lilith's head pulls back with a hiss, her entire body shivering in delight as she turns Gabby around and kisses her on the lips, long and intimate, claiming her like a feral beast.</p>" + "<p>\u201cIt is done, " + perYou.getMaster() + ".\u201d She turns her attention back to you. \u201cThis woman will longer be a threat to you, quite the opposite, in fact.</p>" + "<p>You ask what she has done, and Lilith just smiles wickedly.</p>" + "<p>\u201dHer blood has the faintest trace of a witches taste, too weak to affect me, but delicious nonetheless...\u201d She smiles wickedly. \u201dI have turned her into my Ghoul... Our Ghoul.\u201d</p>");
			else if (stage == "ghoul") md.write("<p>\u201cA Vampyre's servant. A thrall with just as much of a will of her own as I am willing to grant her.\u201d Gabby's eyes open again, but they look absent, if not empty. She calmly undresses and knees next to Lilith.</p>" + "<p>\u201cShe can perform her daily routine as it is needed to not arise suspicion, but her mind is empty unless I will her to think. She will do everything I, or my " + perYou.getMaster() + " orders her to do, without question.</p>" + "<p>Gabby stares at you with big, empty eyes, and you feel a knot in your stomach. Sure, she trapped you, tried to enslave your Mom... but is this really the fate you had in mind for her?</p>" +
				"<p>Lilith at least seems happy, in a... twisted, evil way. She drives her fingers possessively through Gabby's hair and awaits further orders.</p>");
			startQuestions();
			if (stage != "ghoul") addLinkToPlaceC(md, '"A Ghoul?"', 452, "type=vamphelpgabby2&stage=ghoul");
			addLinkToPlaceC(md, "order Lilith to free you", 452, "type=vamphelpgabby3");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "vamphelpgabby3") {
			md = WritePlaceHeader();
			perVamp.showPerson(perVamp.health <= -100 ? "vamp8c.jpg" : "vamp2.jpg");
			addPlaceTitle(md, "Lilith's Help");
			if (perVamp.health <= -100) {
				md.write("<p>\u201cNo...\u201d</p>" + "<p>Lilith smiles coldly, and the look she is giving you makes your blood freeze.</p>" + "<p>\u201cFeeding is my unlife, the power of my soul... and after you fed me so well, her blood was the final bit of power I needed to break free of your pitiful spell.\u201d</p>" + "<p>She pushes your motionless body to the ground and straddles you, her lips above yours.</p>" + "<p>\u201cI should tear you apart for what you did...\u201d Her voice is a sensual whisper making your skin crawl. \u201cBut your spell still holds some influence, and I want you to stay with me...\u201d</p>" +
					"<p>Your body trembles as she kisses you softly on the lips.</p>" + "<p>\u201c...as a fellow Vampyre and my eternal lover...\u201d</p>" + "<p>You try to protest as she kisses your chin, but your voice fails you.</p>" + "<p>\u201c...forever united in darkness.\u201d</p>" + "<p>And with those last words, her fangs sink into your neck, a sharp pain followed by orgasmic bliss rushing through your entire body as the world around you fades away...</p>" + "<p>...sometime later, you revive as a vampyre and lover of your once slave. Nothing can stop the two of you using the Book, your magic and her savagery. Glenvale is yours to enslave, to feed on and satisfy all your lusts, or at least all her lusts, but they are yours now too.</p>");
				startQuestions();
				addRestartLink(md)
			} else {
				md.write("<p>\u201cRight, I would not want my " + perYou.getMaster() + " to remain helpless, would I?\u201d the Vampyre seems to contemplate something, her piercing stare on you as she licks her teeth and walks forward, faintly drawing her nails over your exposed neck as she moves past towards one of the wards to suddenly break it by using those very nails to tear into the wall.</p>" + "<p>Your strength comes back the moment the ward breaks. Clarity returns to your mind, and the mana within you, up until now scattered and unfocused, begins to untangle, to flow freely once again.</p>");
				startQuestions();
				addLinkToPlaceC(md, "tell Lilith to keep an eye on Gabby and leave the room", 452, "", "Lilith presses Gabby's cheek to her leg and assures you that her \u201cGhoul\u201d is in good hands. She would never harm her pets, after all, and the way she smiles sends shivers down your spine as you leave the room.", "", "movePerson('Gabby',247)")
			}
			WritePlaceFooter(md);
			return true
		}
		return false
	};
	per.showEvent = function() {
		var md;
		if (sType.indexOf("conference") != -1) return this.showEventConference();
		if ((sType.indexOf("vamphelpgabby") !=
				-1 || sType.indexOf("studycharm") != -1 || sType.indexOf("gabbyhouse") != -1) && isMurderPath()) return this.showEventTrap();
		if (Place == 247 && sType == "useghoul") {
			md = WritePlaceHeader();
			this.showPerson("gabby-ghoul2.jpg");
			addPlaceTitle(md, "Use the Ghoul");
			md.write("<p>Gabby still knows how to use her tongue, maybe even better than before, who knows, but the whole act is still... kinda uncomfortable.</p>" + "<p>She never moans or makes any other noise and neither does she show disgust or enjoyment towards what she does.</p>" +
				"<p>She allows you to use her body and returns to her spot when she is done.");
			startQuestions();
			addLinkToPlaceC(md, "look around the crypt", Place);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "meetgabby") {
			md = WritePlaceHeader();
			this.showPerson("gabby1.jpg");
			addPlaceTitle(md, "Gabriel Halliway");
			md.write("<p>Gabby gives you a long, scrutinizing look, clearly disapproving of your being here, before she speaks.</p>" + "\u201cI believe Alex... your Mother is not at work right now, so may I know what you are doing here, " +
				perYou.getPersonName() + "?\u201d</p>" + "You tell her that you are just visiting someone, and don't intent to linger to long, and while she still looks annoyed, her features soften a little.</p>" + '\u201cWe are already behind schedule as it is, so please conduct your business quickly and do not disturb the staff, okay?"</p>');
			startQuestions();
			startAlternatives(md);
			addLinkToPlaceC(md, '"Yes, Ms Halliway"', Place, "", "\u201cThank you.\u201d She breathes out in relief. \u201cNow if you excuse me there is work I need to attend to.\u201d<br><br>Gabby gives you a polite nod and goes off into the studio.<br><br>You continue on into Madison's office...");
			addLinkToPlaceC(md, '"Yes, Gabby"', Place, "", "Seconds pass in which you are fairly certain Gabby tries to figure out a way to murder you with her eyes and make it look like an accident, but as you stubbornly remain alive, she just releases yet another annoyed sigh and goes off into the studio.<br><br>You continue on into Madison's office...");
			endAlternatives(md);
			WritePlaceFooter(md);
			return true
		}
		if (Place == 415) {
			if (sType == "usegabbyoffice") {
				md = WritePlaceHeader(false, "td-left-med");
				this.showPerson("gabby-mom4.jpg");
				addPlaceTitle(md, "Using Mom's Assistant");
				md.write("<p>\u201cOf course " + perYou.getPersonName() + ". I'm happy that she is so willing to help you with your needs.\u201d Mom silences whatever protest Gabby might have with a stern look and order her to turn around and undress for you.</p>" + "<p>Gabby's face turns deeply red as Mom bends her firmly over the desk and caresses her folds, luring a deep moan from her lips.</p>" + "<p>\u201chmmm...ahh...\u201d</p>" + "<p>Gabby bites her lower lip to suppress further noises, trembling and gasping for air as your mothers fingers dig deeper, until she finally turns to you. \u201cShe's ready for you, Hun.\u201d</p>");
				if (perYou.isMaleSex()) md.write("<p>Your cock is already hard from the display alone, and Mom has a hard time looking away as you take it out and push deeply into her assistants sex.</p>");
				else md.write("<p>You are pretty wet yourself from the display alone, and Mom has a hard time looking away as you undress as well, pull Gabby off the desk and pin her underneath you.</p>");
				md.write("<p>The actual act is quick and dirty. You can't spend too much time with the two, but you make sure to thoroughly enjoy Gabby's pussy and more than once, Mom needs to remind her to be more quiet when at work.</p>" +
					"<p>She firmly bites her lower lip as her climax approaches, staying mostly silent as you " + (perYou.isMaleSex() ? "hoot your load into her" : "grind your sex against hers") + ", but the struggle to not just shout her climax into the room is clearly visible on her face.</p>");
				startQuestionsOnly();
				addLinkToPlace(md, "talk more with them", 415);
				WritePlaceFooter(md);
				return true
			}
			if (sType == "momdesireoffice") {
				md = WritePlaceHeader();
				this.showPerson("gabby-mom8.jpg");
				addPlaceTitle(md, "Mom's Help");
				md.write("<p>Mom never refuses a chance to help you unwind, and since both women have been horny pretty much since the moment you entered the room, they happily undress for you.</p>" +
					"<p>Mom orders Gabby to go to her knees and prepare her for you while you undress yourself and lock the door, watching the show both of them put on for you.</p>" + "<p>Mom in particular enjoys your eyes on her body. She throws her head back with a soft moan, and caresses herself with both hands while Gabby teases her folds with her tongue, only reluctantly moving aside to make way for you.</p>" + "<p>By now, Mom is so wet you are able to just ");
				if (perYou.isMaleSex()) md.write("press her onto the desk and push into her in one swift motion");
				else md.write("pull her to the floor and slide on top of her in one swift motion");
				md.write(", taking her right in front of Gabby, who watches in morbid fascination.</p>" + "<p>Gabby may still have mixed feelings about watching you fuck your own Mom in front of her, but even she can't help but being swept away by her arousal. Every time you glance aside, you see her furiously fingering herself, eyes locked on you and your Mom as you bring each other to climax.");
				startQuestionsOnly();
				addLinkToPlace(md,
					"talk more with them", 415);
				WritePlaceFooter(md);
				return true
			}
			if (sType == "lookmomgabby1") {
				md = WritePlaceHeader();
				this.setFlag(3);
				this.showPerson("gabby-mom-hypno1.jpg");
				addPlaceTitle(md, "Watching Mom and Gabby");
				md.write("<p>You were prepared for a lot when you decided to peak into Moms office, but what you see still takes you by surprise.</p>" + "<p>Gabby has opened her blouse and is talking softly to Mom, who is seated before her, legs spread suggestively with her eyes glazed over, focused on Gabby's necklace.</p>" +
					"<p>\u201c...to clear your thoughts, and let that heavy, drowsy feeling seep into your mind and body. Are you feeling relaxed, Alex?\u201d Gabbys voice vibrates delicately with every spoken word. She's completely lacking the hard edge and impatience you usually associate with it, and it seems to have an effect on Mom.</p>" + "<p>\u201cYes, Gabby.... Very relaxed...\u201d</p>" + "<p>\u201cGood. \u201c She brushes her fingertips over Moms bare shoulder. \u201dI want you to focus only on my voice. You will block out everything else. No stress, no work, no obligations. Only my voice exists for you.\u201d</p>" +
					"<p>\u201cYes Gabby... no stress, no work, no obligations... only your voice...\u201d You get a knot in your stomach as Mom repeats Gabby's orders word for word with a slightly slurred whisper. Just what is she doing with her?</p>");
				startQuestions();
				addLinkToPlace(md, "keep listening", Place, "type=lookmomgabby1next1");
				WritePlaceFooter(md);
				return true
			}
			if (sType == "lookmomgabby1next1") {
				md = WritePlaceHeader();
				this.showPerson("gabby-mom-hypno2.jpg");
				addPlaceTitle(md, "Keep Watching Mom and Gabby");
				md.write("<p>\u201cGood girl.\u201d A shiver runs through Moms body as Gabby says those words. \u201cNow remember our last sessions, you had to lock those memories away, but they are still there, right?\u201d</p>" +
					"<p>\u201cYes, Gabby.\u201d</p>" + "<p>\u201cSo what will you call me, Alex?\u201d</p>" + "<p>There is a brief pause before Mom answers, a struggle you know all to well by now, and she clearly didn't win.</p>" + "<p>\u201cMistress Halliway.\u201d</p>" + "<p>\u201cGood Girl.\u201d Another shiver rushes through Moms Body, and you strangely feel it as well. \u201cAnd what are you?\u201d</p>" + "<p>\u201cI am...\u201d Another brief hiccup, but barely noticeable this time. \u201c... Mistress Halliway's sexy little... plaything.\u201d</p>" +
					"<p>\u201cGood.\u201d Gabby smiles wickedly. \u201dYou like being sexy, do you, Alex?\u201d</p>" + "<p>\u201cYes... Mistress Halliway.\u201d</p>" + "<p>\u201cAnd what do you know about being sexy?\u201d</p>" + "<p>Again, Mom hesitates for a moment, but her resistance is fading, and she recites the next words steadily and without interruption. \u201cThere is nothing as sexy as a woman who is not afraid to show her sexuality... There is nothing as sexy as a woman who is confident in her own body. There is nothing as sexy as a woman who loves and obeys her Mistress.\u201d</p>" +
					"<p>\u201cRepeat it, let those words wash over you, let them become part of your true self.\u201d</p>" + "<p>\u201cThere is nothing as sexy as a woman who is not afraid to show her sexuality... There is nothing as sexy as a woman who is confident in her own body. There is nothing as sexy as a woman who loves and obeys her Mistress.\u201d</p>" + "<p>The words come out easier this time, and Gabby forces Mom to repeat them several times, slow and deliberate, like a mantra. And to your shock, you find your lips are moving with every syllable, and your eyes glued to Gabby's necklace.</p>" +
					"<p>Luckily, the effect isn't strong. It doesn't take a lot of willpower to tear your attention away from the trinket, and being aware of the effect you doubt you'll easily fall under its influence, again, but this thing certainly is magical in some way.</p>");
				startQuestions();
				addLinkToPlace(md, "keep watching, you might \u201clearn\u201d something", Place, "type=lookmomgabby1next2");
				addLinkToPlace(md, "get out of here, you know what will follow and you've already seen more than you want to", 372, "", "You really don't need to see where this is going, and you don't really want to, either.</p><p>You know what you need to know about Mom's condition and you need a plan to get her away from Gabby somehow, that's all that's important.");
				WritePlaceFooter(md);
				return true
			}
			if (sType == "lookmomgabby1next2") {
				md = WritePlaceHeader();
				this.showPerson("gabby-mom-hypno3.jpg");
				addPlaceTitle(md, "Keep Watching Mom and Gabby");
				md.write("<p>Mom is in a trance, and Gabby fully focused on her, so there's little risk to be caught, and you might learn more about this strange Necklace and Gabby's plans if you just watch them a little longer.</p>" + "<p>Well, at least that's what you tell yourself.</p>" + "<p>On Gabby's order, Mom has pulled down her assistants top and begun to slowly circle her tongue around the other woman's nipple.</p>" +
					"<p>\u201cSee..?\u201d Gabby coos softly. \u201cThis wasn't so hard, doesn't it feel so much better to just obey?\u201d</p>" + "<p>\u201cYes, mistress Halliway...\u201d Moms voice is slurred and absent-minded, her attention focused on Gabby's breasts as she pulls the tiny sensitive nipple into her mouth to lure an audible guest from the others lips.</p>");
				startQuestions();
				addLinkToPlace(md, "keep watching", Place, "type=lookmomgabby1next3");
				addLinkToPlace(md, "bail out", 372, "", "You really don't need to see where this is going, and you don't really want to, either.</p><p>You know what you need to know about Mom's condition and you need a plan to get her away from Gabby somehow, that's all that's important.");
				WritePlaceFooter(md);
				return true
			}
			if (sType == "lookmomgabby1next3") {
				md = WritePlaceHeader();
				this.showPerson("gabby-mom-hypno4.jpg");
				addPlaceTitle(md, "Keep Watching Mom and Gabby");
				md.write("<p>\u201cVery Good.\u201d Gabby leans forward, whispering to Mom. \u201cNow touch my ass, don't be shy, a good, sexy woman worships her Mistresses body.\u201d</p>" + "<p>\u201cA good, sexy woman worships her... Mistresses Body...\u201d Mom, again, repeats every word and begins to  massage Gabby's ass with... rather skilled motions. Gently kneading her buttocks, pulling them apart, and once even giving her assistant a light slap.</p>" +
					"<p>\u201cHmmm... you love your mistresses ass, do you, Alex?\u201d</p>" + "<p>\u201cYes, Mistress Halliway.\u201d The words now come out without hesitation.</p>" + "<p>\u201cEnough to use your tongue to please her, this time?\u201d</p>" + "<p>\u201cI... I...\u201d Mom struggles, and you see awareness briefly returning to her eyes.</p>" + "<p>\u201cIt's okay, you are calm, you are relaxed, you are safe.\u201d</p>" + "<p>\u201cI... am safe...\u201d Gabby looks briefly annoyed, but overall it seems like Mom's resistance is more of a small inconvenience to her than anything else.</p>");
				startQuestions();
				addLinkToPlace(md, "keep watching", Place, "type=lookmomgabby1next4");
				addLinkToPlace(md, "bail out", 372, "", "You really don't need to see where this is going, and you don't really want to, either.</p><p>You know what you need to know about Mom's condition and you need a plan to get her away from Gabby somehow, that's all that's important.");
				WritePlaceFooter(md);
				return true
			}
			if (sType == "lookmomgabby1next4") {
				md = WritePlaceHeader();
				this.showPerson("gabby-mom-hypno5.jpg");
				addPlaceTitle(md, "Keep Watching Mom and Gabby");
				md.write("<p>We have plenty of days ahead, no need to rush.</p>" + "<p>\u201cYes... Mistress...\u201d Moms voice is sleepy, and the two share a long, tender and surprisingly loving kiss among themselves.</p>" + "<p>\u201cYou will rest, for now, and not remember anything we just did. Seal it within you until the next session.\u201d</p>" + "<p>\u201cYes... Mistress...\u201d</p>" + "<p>You are not sure if you are glad or disappointed this didn't go any further, but this is your cue to get out before you are spotted.</p>");
				startQuestions();
				addLinkToPlace(md, "leave the office", 372);
				WritePlaceFooter(md);
				return true
			}
			if (sType == "lookmomgabby2") {
				md = WritePlaceHeader();
				this.setFlag(4);
				this.showPerson("gabby-mom-hypno6.jpg");
				addPlaceTitle(md, "Watching Mom and Gabby");
				if (this.checkFlag(3)) md.write("<p>When you arrive at Mom's office this night, she has already been put into a trance, legs spread on top of her writing desk, with Gabby in front of her.</p>" + "<p>\u201cA sexy woman is not afraid to show her sexuality, a sexy woman is confident in her own body, a sexy woman loves and obeys her mistress, I am a sexy woman.\u201d</p>" +
					"<p>It's the mantra you know from the last session, and this time, Mom recites it without delay or hesitation.</p>");
				else md.write("<p>You... did not expect to find this when you decided to spy on the pair.</p>" + "<p>Mom sits on top of her office desk, legs spread with Gabby on the floor in front of her, and while your first reflex is to pull back and not intrude on this rather intimate moment, you quickly notice that something is... off.</p>" + "<p>Mom's eyes are weirdly unfocused. She is starring off into the distance as if barely taking note of Gabby, and if that is not suspicious enough, the words she keeps repeating certainly are.</p>" +
					"<p>--</p>" + "<p>\u201cA sexy woman is not afraid to show her sexuality, a sexy woman is confident in her own body, a sexy woman loves and obeys her mistress, I am a sexy woman.\u201d</p>" + "<p>She is speaking the words like a mantra, calm and emotionless as Gabby drives her fingertips along Mom's underwear.</p>");
				startQuestions();
				addLinkToPlace(md, "stay calm and listen in", Place, "type=lookmomgabby2next1");
				WritePlaceFooter(md);
				return true
			}
			if (sType == "lookmomgabby2next1") {
				md = WritePlaceHeader();
				this.showPerson("gabby-mom-hypno7.jpg");
				addPlaceTitle(md, "Watching Mom and Gabby");
				md.write("<p>\u201cYou are making progress Alex.\u201d Gabby coos sensually as she pulls Mom's underwear into her folds. \u201cI am proud of you.\u201d</p>" + "<p>\u201cT...thank you, Mistress Halliway...\u201d Mom softly breathes out the answer as her body tenses up and begins to tremble under Gabby's touch.</p>" + "<p>\u201cYou do like it when I touch like this, yes?\u201d</p>");
				if (this.checkFlag(3)) md.write("<p>Gabby phrased it as a question, but it felt more like a statement, and you once again have to stop your lips from moving along as Mom repeats the order.</p>");
				else md.write("<p>Gabby phrased it as a question, but it felt more like a statement, and you don't even notice your lips moving along as Mom repeats the words.</p>");
				md.write("<p>--</p>" + "<p>\u201cI like it when you touch me like this... Mistress.\u201d</p>" + "<p>Mom's head rolls back with a soft moan, her eyes closed as Gabby pushes her underwear to the side.</p>" + "<p>\u201cSay it again...\u201d Her lips are close enough to Mom's folds to let her breath wash over them, and Gabby slowly drags  the tip of her finger over Mom's womanhood as she repeats every word.</p>" +
					"<p>\u201cI like it when you touch me like this, I want to be touched like this,\u201d Her breathing grows more ragged with every syllable, she is gasping for air but dutifully repeats everything Gabby says. \u201dI want to feel good, I want to surrender myself to mistress Halliway...\u201d</p>");
				startQuestions();
				if (this.checkFlag(3)) addLinkToPlace(md, "Whisper: \u201dI want to feel good, I want to surrender myself to mistress Halliway...\u201d", Place, "type=lookmomgabby2next2");
				else {
					addLinkToPlace(md,
						"The necklace tries to get your attention again, but you easily ignore the influence", Place, "type=lookmomgabby2next3");
					addLinkToPlace(md, "bail out, you've seen enough", 372, "", "You really don't need to see where this is going, and you don't really want to, either.</p><p>You know what you need to know about Mom's condition and you need a plan to get her away from Gabby somehow, that's all that's important.")
				}
				WritePlaceFooter(md);
				return true
			}
			if (sType == "lookmomgabby2next2") {
				md = WritePlaceHeader();
				this.showPerson("gabby-mom-hypno7.jpg");
				addPlaceTitle(md, "Keep Watching Mom and Gabby");
				md.write("<p>Wait... this is not right... Have you been repeating Gabby's words as well...?</p>" + "<p>It's a subtle effect... and now that you've recognized it, you find it easy to block the urge out, but yes, you have, and not only that, your eyes weren't focused on the pair, but on Gabbys necklace...</p>" + "<p>The effect was subtle, and now that you noticed it, you are easily able to pull your attention away, but this trinket is clearly magical in nature.</p>" +
					"<p>It's pretty much what you needed to know, and now that you are aware of the effect, there really is no reason for you to keep watching Mom and Gabby, right?</p>");
				startQuestions();
				addLinkToPlace(md, "Actually..", Place, "type=lookmomgabby2next3");
				addLinkToPlace(md, "Indeed, get out as quick as you can", 372, "", "You really don't need to see where this is going, and you don't really want to, either.</p><p>You know what you need to know about Mom's condition and you need a plan to get her away from Gabby somehow, that's all that's important.");
				WritePlaceFooter(md);
				return true
			}
			if (sType == "lookmomgabby2next3") {
				md = WritePlaceHeader();
				this.showPerson("gabby-mom-hypno8.jpg");
				addPlaceTitle(md, "Keep Watching Mom and Gabby");
				md.write("<p>You keep watching with mixed feelings as Gabby begins to peel your Mother out of her clothes, moving with slow, sensual motions and clearly delighting in any inch of bare skin she manages to expose.</p>" + "<p>There is no protest and no resistance. Mom's eyes remain dazed as Gabby pushes her back against the desk and slowly pulls the last piece of clothes covering Mom's body.</p>" +
					"<p>The whole scene is surreal: You watch as your own mother spreads her legs for another woman, gasping softly with every gentle touch to her skin and eagerly presenting herself to someone who is clearly messing with her mind... and all you can think of is:</p>" + "<p>She looks really, fucking hot.</p>");
				startQuestions();
				addLinkToPlace(md, "witness the finale", Place, "type=lookmomgabby2next4");
				addLinkToPlace(md, "bail out", 372, "", "You really don't need to see where this is going, and you don't really want to, either.</p><p>You know what you need to know about Mom's condition and you need a plan to get her away from Gabby somehow, that's all that's important.");
				WritePlaceFooter(md);
				return true
			}
			if (sType == "lookmomgabby2next4") {
				md = WritePlaceHeader();
				this.showPerson("gabby-mom-hypno9.jpg");
				addPlaceTitle(md, "Keep Watching Mom and Gabby");
				md.write("<p>Gabby pushes her fingers forward, breaching Mom's folds and diving deeply into her wetness.</p>" + "<p>\u201cLet yourself fall, Alex.\u201d She coos softly. \u201cLay back, relax, you like it when I finger your pussy.\u201d</p>" + "<p>\u201cI... I like it when you finger my pussy...\u201d</p>" + "<p>\u201cIt makes you feel sexy and submissive, you enjoy feeling sexy and submissive.\u201d</p>" +
					"<p>\u201cI enjoy... enjoy feeling sexy and... ah... and submissive...\u201d</p>" + "<p>Mom's words barely come out now, interrupted by haggard breathing and sexy moans as Gabby intensifies her attentions, skillfully flicking her tongue over her playthings clit.</p>" + "<p>\u201cA sexy woman is not afraid to show her sexuality, a sexy woman is confident in her own body, a sexy woman loves and obeys her mistress.\u201d</p>" + "<p>She repeats the mantra once again, and Mom dutifully recites it, once, twice, a third barely cohesive time as her voice begins to crack under her impending climax and finally a fourth time, screaming out the words as she reaches her peak and collapses on the desk, gasping for air.</p>" +
					"<p>\u201cGood girl... you are almost ready.\u201d Gabby rises to her feet and caresses Moms trembling body. \u201cCommit what you have learned to your subconsciousness, but seal it away. You will not remember anything that happened tonight, but it will affect you.\u201d</p>" + "<p>\u201cYes Mistress.\u201d</p>" + "<p>Well, that is your cue to leave. Gabby is giving out a few more instructions, but  for now it's better if she does not see you.</p>");
				startQuestions();
				addLinkToPlace(md, "leave", 372);
				WritePlaceFooter(md);
				return true
			}
		}
		if (Place == 161) {
			var stage = getQueryParam("stage");
			if (sType == "gabbyslaverig") {
				if (stage === "") stage = Math.floor(Math.random() * 4) + 1;
				else stage = parseInt(stage, 10);
				md = WritePlaceHeader(false, stage == 2 ? "" : "td-left-med");
				this.showPerson("gabby-bdsm" + stage + "a.jpg");
				addPlaceTitle(md, "Gabby Bound by Bambi");
				md.write("<p>Gabby has been rigged up and her body is trembling in anticipation. She is clearly aroused, as much as it may annoy her, and eagerly awaiting you to play with her.</p>");
				startQuestions();
				var nstage = stage + 1;
				if (nstage > 4) nstage = 1;
				addLinkToPlace(md, "change position", Place, "type=gabbyslaverig&stage=" + nstage, "Bambi helps you re-position your toy, explaining knots and techniques to you and making sure you know how to not cut of the flow off blood.</p><p>According to her, you are a natural and might soon be able to do your own ropework.");
				addLinkToPlace(md, "play with her", Place, "type=gabbyslaverigplay&stage=" + stage);
				addLinkToPlace(md, "fuck her", Place, "type=gabbyslaverigfuck&stage=" + stage);
				addLinkToPlace(md, "untie her and leave the cellar", 124, "", "Bambi helps you undo the ropes and promises to carry out proper aftercare, like tending to any bruises and making sure Gabby is ready for the next session whenever you are.");
				WritePlaceFooter(md);
				return true
			}
			if (sType == "gabbyslaverigplay") {
				md = WritePlaceHeader(false, stage == 2 ? "" : "td-left-med");
				stage = parseInt(stage, 10);
				this.showPerson("gabby-bdsm" + stage + "b.jpg");
				addPlaceTitle(md, "Playing with the Bound Gabby");
				md.write("<p>You don't really have a lot of experience with this aside from a book you once found in the library (It turned out to not belong to the library itself and by now you have a good idea who left it), but Bambi is a good teacher and according to her, you are a natural and learning surprisingly fast.</p>" +
					"<p>Sessions always start of slow. Light flogging, spankings and similar forms of impact play to build up adrenaline and allow her to get used to the rising sensations as you slowly pick up the pace.</p>" + "<p>You have no real reason to go soft on her, but at the same time you don't want to cause any damage from improper treatment and there is something extremely satisfying to bring her to the edge and back at your leisure, frequently forcing her to climax from the rush of pain alone and reminding her just how much her body enjoys it now, whether she likes it or not.</p>" +
					"<p>Gabby screams, moans and curses under your continued assault and Bambi helps you to strike the right spots and alternate between gentle and rough sensations. Slowly, you are pushing her closer to the edge until she collapses under a final, intense climax, her body coming to rest and her face deeply red as she recovers.</p>");
				startQuestions();
				var nstage = stage + 1;
				if (nstage > 4) nstage = 1;
				addLinkToPlace(md, "change position", Place, "type=gabbyslaverig&stage=" + nstage, "Bambi helps you re-position your toy, explaining knots and techniques to you and making sure you know how to not cut of the flow off blood.</p><p>According to her, you are a natural and might soon be able to do your own ropework.");
				addLinkToPlace(md, "fuck her", Place, "type=gabbyslaverigfuck&stage=" + stage);
				addLinkToPlace(md, "untie her and leave the cellar", 124, "", "Bambi helps you undo the ropes and promises to carry out proper aftercare, like tending to any bruises and making sure Gabby is ready for the next session whenever you are.");
				WritePlaceFooter(md);
				return true
			}
			if (sType == "gabbyslaverigfuck") {
				stage = parseInt(stage, 10);
				md = WritePlaceHeader(false, stage == 2 || stage == 4 ? "" : "td-left-med");
				this.showPerson("gabby-bdsm" + stage + "c.jpg");
				addPlaceTitle(md, "Fucking the Bound Gabby");
				md.write("<p>Gabby likes it rough to begin with and sex with her has a tendency to escalate into a struggle who is on top and who is not, but this definitely solves that problem.</p>" + "<p>With her body nearly completely bound you can have your way with her however you like, and thanks to the effects of the spell she can't help but enjoy it.</p>" + "<p>Gabby tries to hold back her moans as you " + (perYou.isMaleSex() ? "push into her sex" : "put the vibrator to her pussy") +
					", but there is only so much she can do, and soon, her voice hallows through the Cellar as you bring her helpless body closer to the peak, always making sure to keep her on the edge and occasionally have her beg for it until you finally allow her to cum.</p>");
				startQuestions();
				var nstage = stage + 1;
				if (nstage > 4) nstage = 1;
				addLinkToPlace(md, "change position", Place, "type=gabbyslaverig&stage=" + nstage, "Bambi helps you re-position your toy, explaining knots and techniques to you and making sure you know how to not cut of the flow off blood.</p><p>According to her, you are a natural and might soon be able to do your own ropework.");
				addLinkToPlace(md, "play with her", Place, "type=gabbyslaverigplay&stage=" + stage);
				addLinkToPlace(md, "untie her and leave the cellar", 124, "", "Bambi helps you undo the ropes and promises to carry out proper aftercare, like tending to any bruises and making sure Gabby is ready for the next session whenever you are.");
				WritePlaceFooter(md);
				return true
			}
		} else if (Place != 452) return false;
		var clv = this.getCharmedLevel();
		if (sType == "gabbyrecharm1") {
			md = WritePlaceHeader();
			if (clv == 1) this.showPerson("gabby-recharm1.jpg");
			else if (clv == 4) this.showPerson("gabby-recharm2.jpg");
			else this.showPerson("gabby16.jpg");
			addPlaceTitle(md, "Gabby Under A Charm Spell - Again");
			md.write("<p>\u201cW...what are you doing?\u201d Gabby's body twitches after you have re-cast the spell, her eyes quickly loosing focus as a barrage of new sensations rapidly overtakes her mind, opening it up to new orders.</p>" + "<p>\u201cP...please stop this... I... I can't think, everything's so... so... ohhh\u201d</p>" + "<p>She looses her train of thought with a soft moan and just helplessly stares at you, her body trembling from the rush of arousal as her mind gets ready to be shaped however you want.</p>");
			startQuestions();
			if (clv != 4) addLinkToPlace(md, "you still want to punish her", Place, "type=gabbyrecharmslave");
			if (clv != 2) addLinkToPlace(md, "you want her to desire you", Place, "type=gabbyrecharmlover");
			if (clv != 1) addLinkToPlace(md, "you want her to be with your Mom", Place, "type=gabbyrecharmservant");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "gabbyrecharmslave") {
			md = WritePlaceHeader();
			this.charmThem(4);
			this.showPerson("gabby-recharm4.jpg");
			addPlaceTitle(md, "Gabby Under A Charm Spell - Again");
			md.write("<p>\u201cTurn around.\u201d You order her, cutting of whatever protest she may have been about to give with a harsh \u201cDo it!\u201d as you take away whatever clothes she might have left.</p>" +
				"<p>\u201cI had to realize that I have let you off too easy the last time. You need to be properly punished to be able to atone for your sins, and I am sure that you agree.\u201d</p>" + "<p>You bring your hand harshly down on Gabby's ass before she is able to respond, her entire body twitching forward with a surprised gasp.</p>" + "<p>\u201cStop this! I...\u201d Aaahhh!\u201d</p>" + "<p>\u201cNope.\u201d You say flatly, striking her again. \u201cI know you want to be punished.\u201d The next strike leaves a red imprint on her ass.</p>" +
				"<p>\u201cIn fact, you crave it.\u201d</p>" + "<p>*Whack*</p>" + "<p>\u201cYou get off on it!\u201d</p>" + "<p>*Whack*</p>" + "<p>\u201cJust look at how wet your pussy is.\u201d</p>" + "<p>Gabby doesn't answer as you push your fingers into her folds, coat it in her juices and splat those on her ass with the next strike. Her brain focused on processing the cascade of new sensations flooding her mind.</p>" + "<p>-This- will be how you get off from now on.\u201c She groans as you spank her again. \u201cMasturbation will no longer suffice, sex will no longer suffice.\u201c Another strike hits her. \u201dYou need the rush of adrenaline that comes with being treated like a kinky little painslut. You crave to be punished and humiliated like a naughty little slavegirl and you need me to do it.\u201d</p>" +
				"<p>\u201cPlease, I ahh....ahhhhhhhhhh...\u201d</p>" + "<p>You spank her harshly, bringing your hand down again, and again. Your mind taken over by a formerly unknown instinct to punish this woman, to push her to the limit and make her scream in both pain and ecstasy as your spell ravages her mind, and only when she screams her climax into the room, you stop.</p>" + "<p>\u201c...You just came, did you?\u201d This was more of a rhetoric question. Her body convulses under your touch and streams of her fluids run down her legs, so it's pretty obvious that she is literally cumming her brains out from your treatment.</p>" +
				"<p>\u201cYou really came from being spanked by me... maybe you secretly already were a little Painslut.\u201d</p>" + "<p>\u201cGabby groans in response, her body trembling in the afterglow of what must have been a pretty intense orgasm, and you give her some time to adjust to her new mindset.</p>");
			startQuestions();
			addLinkToPlace(md, "punish her more", Place);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "gabbyrecharmlover") {
			md = WritePlaceHeader();
			this.charmThem(2);
			this.showPerson("gabby-recharm3.jpg");
			addPlaceTitle(md, "Gabby Under A Charm Spell - Again");
			md.write("<p>\u201cIt is time to change things a little, and I am sure you feel the same, after all, you have wanted us to fuck for a while now, right?\u201d</p>" + "<p>Gabby at first looks utterly dumbstruck as you say that, then angry. \u201cI have not, I...\u201d Her words trails off as the spell adjust her mind to your words.</p>" + "<p>\u201cYou have.\u201d You state simply, using the confusion to take of whatever clothes remain. \u201cYou want me to fuck you like a beast, you crave to feel my " +
				(perYou.isMaleSex() ? "cock inside your pussy" : "cunt against your pussy") + ", you want nothing more than to...</p>" + "<p>\u201cDamn you!\u201d She tries to slap you, but you know her well enough to expect it by now and catch her hand midair. \u201cStop fucking with my head like this and... and...\u201d She stops... breathing heavily and starring at you in a mix of rage and desire for several heartbeats. \u201c...and start fucking my pussy?\u201d</p>" + "<p>\u201cOh to hell with it...You win, " + perYou.getPersonName() +
				"!\u201d She pulls you closer, her lips close to yours. \u201cYes, I want you, I want you to finger my pussy and slap my tits, I want to feel your fucking cock inside me/cunt against mine! So please, hurry up! If I have to be some stupid teenagers fucktoy I'm better getting the best fucking pounding of my life out of it!\u201d</p>");
			startQuestions();
			addLinkToPlace(md, this.getCharmedLevel() != 1 ? "fuck her more" : "talk to her more", Place);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "gabbyrecharmservant") {
			md =
				WritePlaceHeader();
			this.charmThem(1);
			this.showPerson("gabby-recharm3.jpg");
			addPlaceTitle(md, "Gabby Under A Charm Spell - Again");
			md.write("<p>As fun as it was to mess with her, you do believe that Gabby should be at Mom's side, as she always has been, as her " + (!isMurderPath() ? "faithful little slave" : "devoted lover") + ".</p>" + "<p>\u201cBut... but don't you want me anymore?\u201d Gabby looks crushed for a few seconds, almost as if she is close to begging you to keep her until she catches herself.</p>" +
				"<p>\u201cOh hell... what am I doing...? " + (!isMurderPath() ? "I don't want to be her slave!" : "I love Alex but...") + "\u201d She grinds her teeth. \u201cWhat game are you playing, " + perYou.getPersonName() + "?\u201d</p>" + "<p>\u201cThere is no game, you will do everything you can to make my Mom happy, and you will not be opposed to me using my magic on people, in fact. You find it quite sexy that I do.\u201d</p>" + "<p>\u201cGabby opens her mouth to protest, but you cut her off with a sudden rush of arousal.\u201d</p>" +
				"<p>\u201cRepeat: I like it when " + perYou.getPersonName() + " uses his/her Magic on other women.\u201d</p>" + "<p>\u201cI... ahhh...\u201d She moans heavily. \u201cI like it when " + perYou.getPersonName() + " uses his/her Magic on other women.\u201d</p>" + "<p>\u201c" + capitalizeFirstLetter(perYou.getHeShe()) + " should be able to use " + perYou.getHisHer() + " gift however " + perYou.getHeShe() + " wants.\u201d</p>" + "<p>\u201c" + capitalizeFirstLetter(perYou.getHeShe()) + " should... should be able to use " + perYou.getHisHer() +
				" gift how... however " + perYou.getHeShe() + " wants.\u201d</p>" + "<p>\u201cI will support " + perYou.getHimHer() + " and " + perYou.getHisHer() + " mother in all things, I will work hard to serve Alex\u201d</p>" + "<p>\u201cI will support " + perYou.getHimHer() + " and " + perYou.getHisHer() + " mother in all things.\u201d She breathes the words out hastily. \u201cI will work hard to serve A... Alex... Ahhhhhh...\u201d</p>" + "<p>You push her arousal as much as you can to make her climax, imprinting those words on her mind in the process and leaving her heavily gasping for air.</p>" +
				"<p>\u201cThis was... intense...\u201d She looks at you, her eyes now fully taken over. \u201cI... actually liked that, I really do like it when you use your magic.\u201d</p>");
			startQuestions();
			addLinkToPlace(md, "fuck her more", Place);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "gabbylovergloat") {
			md = WritePlaceHeader();
			this.showPerson("gabby16.jpg");
			addPlaceTitle(md, "Gloating");
			md.write("<p>\u201cFuck you, " + perYou.getPersonName() + ".\u201d Gabby rolls her eyes and tries her best to ignore you from now on, but your presence clearly riles her up.</p>" +
				"<p>She looks moody and annoyed, but also really horny, her eyes occasionally shifting to you and her fingers twitching to her folds, but it doesn't look like she wants to give you the satisfaction of having to touch herself.</p>");
			startQuestions();
			addLinkToPlace(md, "not enough", Place);
			addLinkToPlace(md, "leave the house", 38);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "gabbyloverxxx") {
			md = WritePlaceHeader();
			this.showPerson("gabby15.jpg");
			addPlaceTitle(md, "Fucking Gabby");
			md.write("<p>\u201cOkay.\u201d Gabby tries not to show it, but she is genuinely excited to hear that. You see her pose shifting slightly, and she licks her upper lip.</p>" +
				"<p>\u201cLet's get this over... Ach to hell with the pretense. Just fuck me, please?\u201d</p>");
			startQuestions();
			if (perYou.isMaleSex()) {
				addLinkToPlace(md, "fuck her ass", Place, "type=gabbyloverfuckass");
				addLinkToPlace(md, "fuck her mouth", Place, "type=gabbyloverbj")
			} else {
				addLinkToPlace(md, "order her to eat you out", Place, "type=gabbyloverbj");
				if (perYou.FindItem(45) > 0) addLinkToPlace(md, "fuck her with a strap-on", Place, "type=gabbyloverstraponfuck")
			}
			addLinkToPlace(md, "just fuck her", Place, "type=gabbyloverfuck");
			addLinkToPlace(md, '"Actually, you -are- just here to gloat"', Place, "type=gabbylovergloat2");
			addLinkToPlace(md, '"Not now", and leave the house', 38);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "gabbyloverfuckass") {
			md = WritePlaceHeader();
			this.showPersonRorX("gabby17.jpg");
			addPlaceTitle(md, "Fucking Gabby's Ass");
			md.write("<p>Sex with Gabby is generally rough, intense and a struggle to keep up with her, but great if you need to work up a sweat and take your frustrations out on someone, she definitely does so on you.</p>" +
				"<p>Gabby knew what you were planning to do with the lube and puts up a bit of a fight, but actually surrenders unusually fast and quickly finds herself on all fours with your cock sliding into her tight rear.</p>" + "<p>She moans as you place a slap on her ass and push into her, keeping her body pinned to the bed and roughly rocking your hip. She groans lustfully, her expression a mix of pain and lust as you speed up and grinding her fingers deeper into the sheets with every passing second until she actually reaches her peak before you do and shouts her climax into the room with a litany of assorted profanities right as you unload your own climax into her.</p>");
			startQuestions();
			addLinkToPlace(md, "that's not enough", Place);
			addLinkToPlace(md, "leave the house", 38);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "gabbyloverbj") {
			md = WritePlaceHeader(false, perYou.isMaleSex() && isExplicit() ? "td-left-med" : "");
			if (perYou.isMaleSex()) this.showPersonRorX("gabby18.jpg");
			else this.showPerson("gabby20.jpg");
			addPlaceTitle(md, "Fucking Gabby's Mouth");
			if (perYou.isMaleSex()) md.write("<p>Gabby is not as enthusiastic about a blowjob as she is about more direct forms of sex, but her lust usually wins out and it takes little convincing for her to get on her knees and service you.</p>" +
				"<p>Her method can best be described as sloppy and aggressive, with hard, jerky motions and a lot spit as her lips and tongue roll over your cock, focused on getting you to climax and shoot your load onto her face as quick as possible.</p>" + "<p>And she's pretty good at that.</p>");
			else md.write("<p>Gabby is not as enthusiastic about eating you out as she is about more direct forms of sex, but her lust usually wins out and it takes little convincing for her to get on her knees and service you.</p>" +
				"<p>She is aggressive and sloppy, using her fingers more than her tongue and not interested in drawing things out, but you have to admit... she is really good at what she does.</p>" + "<p>She figured out where your most sensitive areas are in record time and knows how to stimulate them with amazing precision, usually making you cum in record time, though not really being very sensual about it.</p>");
			startQuestions();
			addLinkToPlace(md, "that's not enough", Place);
			addLinkToPlace(md, "leave the house", 38);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "gabbyloverfuck") {
			md = WritePlaceHeader(false, perYou.isMaleSex() ? "" : "td-left-med");
			if (perYou.isMaleSex()) this.showPersonRorX("gabby19.jpg");
			else this.showPerson("gabby20.jpg");
			addPlaceTitle(md, "Fucking Gabby");
			md.write("<p>Gabby may not be deeply in love with you, but she wants still wants you to enjoy yourself and come back to her, and you found that she can be surprisingly affectionate after having her urges satisfied.</p>" + "<p>This time is no different, Gabby and you roll around the bed, constantly shifting who is on top and who gets pinned down, and the more you go, the more aggressive she gets, pulling your hair, digging her fingers into your skin and even slapping your ass if given the opportunity.</p>" +
				"<p>You really don't know if she has always secretly been like that or your spell awakened that side, but you have to admit that having sex with her is a rush like few others and having her come to rest in your sore arms in the end not an unpleasant finale.</p>");
			startQuestions();
			addLinkToPlace(md, "that's not enough", Place);
			addLinkToPlace(md, "leave the house", 38);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "gabbyloverstraponfuck") {
			md = WritePlaceHeader();
			this.showPerson("gabby21.jpg");
			addPlaceTitle(md,
				"Fucking Gabby with a Strap-On");
			md.write("<p>Using your strap-on on Gabby is equally satisfying and exhausting, and it almost makes you appreciate all the work some men must be putting into sex regularly.</p>" + "<p>You usually change position often, but in most cases things end up with Gabby either face down on the ground as you aggressively pound away or her riding you to climax.</p>" + "<p>In either case, it is satisfying to watch her impale herself on the fake cock, and Gabby clearly enjoys herself as well.</p>");
			startQuestions();
			addLinkToPlace(md, "that's not enough", Place);
			addLinkToPlace(md, "leave the house", 38);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "gabbylovergloat2") {
			md = WritePlaceHeader();
			this.showPerson("gabby16.jpg");
			addPlaceTitle(md, "Gloating");
			md.write("<p>\u201cFuck you, " + perYou.getPersonName() + ".\u201d Gabby rolls her eyes and tries her best to ignore you from now on, but your presence clearly riles her up.</p>" + "<p>She looks moody and annoyed, as well as really horny, her eyes occasionally shifting to you and her fingers twitching to her folds, but it doesn't look like she wants to give you the satisfaction of having to touch herself.</p>");
			startQuestions();
			addLinkToPlace(md, "that's not enough", Place);
			addLinkToPlace(md, "leave the house", 38);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "gabbyslavefuck") {
			md = WritePlaceHeader(false, perYou.isMaleSex() ? "" : "td-left-med");
			if (perYou.isMaleSex()) this.showPersonRorX("gabby19.jpg");
			else this.showPerson("gabby20.jpg");
			addPlaceTitle(md, "A Quickie with Gabby");
			md.write("<p>Thanks to your conditioning, Gabby gets off more from the rush of pain than from sex itself, and it shows in the way she treats you in bed.</p>" +
				"<p>Sex with her is generally rough, intense and a struggle to keep up with her, but great if you need to work up a sweat and take your frustrations out on someone, she definitely does so on you.</p>" + "<p>You roll around in the sheets, pull hair, spank each other and waste little time on kisses or foreplay. Both of you tend to end up with a few bruises, but you have yet to injure each other, and you doubt it will happen.</p>" + "<p>Gabby may not be deeply in love with you, but she wants still wants you to enjoy yourself and come back to her, and you found that she can be surprisingly affectionate after having her urges satisfied.</p>");
			startQuestions();
			addLinkToPlace(md, "that's not enough", Place);
			addLinkToPlace(md, "leave the house", 38);
			WritePlaceFooter(md);
			return true
		}
		return false
	};
	per.showPersonChatCharmed = function(md) {
		if (Place == 452 && this.isHere() && sType == "") {
			if (this.getCharmedLevel() == 2) {
				addLinkToPlace(md, '"Here to Gloat"', Place, "type=gabbylovergloat");
				addLinkToPlace(md, '"Here to Fuck"', Place, "type=gabbyloverxxx")
			} else if (this.getCharmedLevel() == 4) {
				addLinkToPlace(md, "have a quickie", Place, "type=gabbyslavefuck");
				if (isCharmedBy("Bambi") &&
					checkPlaceFlag("Hotel", 9)) addLinkToPlace(md, "have Bambi rig her up in the Hotel Cellar", 161, "type=gabbyslaverig", "You quickly take Gabby over to the Hotel tell Bambi what you want. Bambi is fast, as usual, and within a few minutes, she has Gabby locked into an elaborate rope harness for your enjoyment.", "", "WaitHereOnly(2)")
			}
			if (!this.checkFlag(17)) addQuestionR(md, "ask her about the necklace", "\u201cIt's a family heirloom, or was until recently.\u201d Gabby is still rather bitter about you taking it.</p>" +
				"<p>\u201cApparently, the warlock Kurndorf handed out these and other trinkets to those loyal to him, including some of my ancestors.\u201d</p><p>" + (isMurderPath() ? "\u201cI didn't think I would ever use it and only took it out after the murder of Sir Gates... Funny how using it only caused you to come after me earlier, is it?\u201d" : "\u201cI have been using it for about a year to improve my standing in the studio and prepare Alex for my plan, and without your meddling, I would have taken over that place and...\u201d She breathes out...</p>" +
					"<p>\u201cOf course, I no longer need such ambitions as I am now your loyal plaything instead... which is just as great.\u201d"), "", "setPersonFlag(\\'Gabby\\',17)");
			else if (!this.checkFlag(18)) addQuestionR(md, "ask about her ancestors", "\u201cI'm not sure how much you know about Glenvale's history, but the Halliways were servants of Kurndorf. Minor warlocks and nobles who pledged their fealty to him early and were rewarded with a small degree of power over the commoners during his reign.\u201d</p>" +
				"<p>\u201cThey were the ones who built what is now the Gates mansion, but lost everything when their \u201cMaster\u201d died. They tried to hold on to whatever power they had left but in the end were forced to flee overnight, taking whatever trinkets they could carry with them.\u201d</p><p>" + (isMurderPath() ? "\u201cI have tried to distance myself from them and their deeds for most of my life, and the moment I use their legacy I fall under the spell of a warlock myself... Ironic, isn't it?\u201d" : "Truth be told, I have always envied them for their magic and power, even if it meant servitude to Kurndorf, though of course I never thought I'd end up like them if I actually make use of their legacy..."),
				"", "setPersonFlag(\\'Gabby\\',18)");
			else if (!this.checkFlag(19)) addQuestionR(md, "ask about her relationship with your Mom", isMurderPath() ? "\u201cI truly love her and confessed it about a year ago.\u201d</p>" + "<p>\u201cAlex was hesitant at first due to our work, but we started dating and one thing slowly led to another. She wanted to tell you and Tracy about it, but I asked her not to, for now.\u201d</p>" + "<p>\u201cI... regret using our hypnosis sessions to bring her under my will and justifying it with my fear of you. I went too far when I saw how much control I had, left you no choice but to come after me and tainted something beautiful we shared.\u201d" :
				"\u201cI was so close to...\u201d She stops mid sentence and grinds her teeth. \u201cWhat is there to say? I actually used to love her and confessed it a year ago, but she wanted to keep our relationship professional.\u201d</p>" + "<p>\u201cI knew that my ancestors were rumored to be warlocks, but... unlike you I apparently lacked the talent needed to learn any spells, so I used what I had from them over the course of the last year to make her mine, not as a lover, but a slave.\u201d</p>" + "<p>\u201cAnd then someone like you succeeds with ease where I failed and interferes at the last minute...\u201d",
				"", "setPersonFlag(\\'Gabby\\',19)");
			if (this.getCharmedLevel() == 2) addSleepLink(md, "take her to bed", "Sleeping with Gabby", '<p style="position:absolute;left:10%;top:10%;cursor:pointer;font-size:1.1em;width:40%">Even Gabby gets tired at one point, and that provides one of the rare opportunities for both of you to peacefully share the bed together, at least until tomorrow.', this.getImg("gabby-bed1.jpg"), true, "", "", "", "overflow-y:hidden");
			else if (this.getCharmedLevel() == 4) addSleepLink(md, "take her to bed",
				"Sleeping with Gabby", '<p style="position:absolute;left:10%;top:10%;cursor:pointer;font-size:1.1em;width:40%">You decide to go to sleep for the night, which in this case means you are sleeping in her bed, while she sleeps in front of it, chained to the bedpost.', this.getImg("gabby-bed2.jpg"), true, "", "", "", "overflow-y:hidden");
			else if (this.getCharmedLevel() == 1) addSleepLink(md, "Spend the night at Gabby's home", "Sleeping at Gabby's Home", "<p style=\"position:absolute;left:10%;top:10%;cursor:pointer;font-size:1.1em;width:40%\">Gabby isn't really happy with you being here, but she always has a guest-bed ready for you to use.<br>During the night, you are woken up by noises from Gabby's bedroom, and as you go to investigate, you find her masturbating furiously with a thick dildo.<br>You are certain she looks at you for a brief moment, but never says anything as you watch her bring herself to climax and silently go back to your bed before she recovers from it.",
				this.getImg("gabby-bed3.jpg"), true, "", "", "", "overflow-y:hidden")
		}
	};
	per.showPersonChat = function(bGeneral, md) {
		if (Place == 247 && this.isHere() && sType === "") {
			addLinkToPlace(md, "use the ghoul", Place, "type=useghoul");
			return
		}
		if (Place == 415 && sType === "") {
			var bCanArrest = isArrestPossible();
			if (!perYou.checkFlag(12) && !this.checkFlag(1) && !isArrestPossible()) addQuestionC(md, "ask about the book on Hypnosis", "Gabby", 101);
			else if (perYou.checkFlag(12) && checkPersonFlag("Monique", 17) && !this.checkFlag(1)) addQuestionC(md, "ask about the book on Hypnosis from the library",
				"Gabby", 100)
		}
		if (this.isCharmedBy()) return this.showPersonChatCharmed(md);
		if (!(this.checkFlag(3) || this.checkFlag(4))) return;
		if (Place == 372 && !isDay()) addLinkToPlace(md, "check Gabby's Office", 417);
		if (Place == 417)
			if (!this.checkFlag(6)) addQuestionR(md, "look around the office", "You are pretty sure that Gabby will notice if as much as a single speck of dust it's not where it's supposed to be, which limits your options to really snoop around, but do find her day planner on the work desk.", "", "setPersonFlag(\\'Gabby\\',6)");
			else if (!this.checkFlag(7)) addQuestionR(md, "check her Day planner", isMurderPath() ? "Lucky for you, the wonders of modern smartphone apps have either not reached Gabby, or been deemed unreliable by her. Either way, you quickly flip towards the last pages to find out what she will be doing this week.</p>" + "<p>Most of it is predictable. Meetings, work time, breaks, exercise and sleep at a schedule she seems to repeat almost every day. You do, however, find several entries in the past months simply marked as \u201cTest/Necklace\u201d or something similar, often with notes like \u201csuccess, failure, use less/more pressure\u201d or other additions added later.</p>" +
			"<p>The entries pick up in frequency in the last two weeks, and right now, pretty much every night after the studio closes is marked \u201cNecklace/Alex\u201d in her planner.</p>" + "<p>Gabby is obviously using the necklace you saw to hypnotize your Mom during this time! You may be able to confront her alone once Mom has been placed in a trance, but you will need to find out more about the necklace fist. Maybe someone with knowledge of hypnotic techniques or Kurndorf-era trinkets could tell you more?" :
			"Lucky for you, the wonders of modern smartphone apps have either not reached Gabby, or been deemed unreliable by her. Either way, you quickly flip towards the last pages to find out what she will be doing this week.</p>" + "<p>Most of it is predictable. Meetings, work time, breaks, exercise and sleep at a schedule she seems to repeat almost every day, there is, however, an item of interest on the list:</p>" + "<p>One entry has been neatly crossed out  and replaced with a new one: \u201cMayoral press gathering/Sarah Gates interview\u201d.</p>" +
			"<p>Apparently, she had a reporter assigned to interview Sir Ronald's niece at a press gathering organized by Mayor Thomas, but he called in sick, and with the team stretched thin thanks to her efforts she'll have to go herself.</p>" + "<p>This is really useful information. Gabby will be at the town hall, alone, and if you play your cards right, you'll be able to catch and charm her before she returns to the studio.</p>" + "<p>The event is... tomorrow at 6:00 pm and apparently closed to the public... that doesn't leave you a lot of time to prepare.",
			"", "setPersonFlag(\\'Gabby\\',7)");
		if (Place == 348 && !this.checkFlag(5) && !this.checkFlag(10) && !this.checkFlag(8)) addQuestionR(md, "ask Victoria if she knows anything about that necklace", "\u201cI am Sorry, but there are at reports of at least 5 dozen different magical necklaces in the area around Glenvale alone. I will see if I can find anything befitting your description, but it will take time, maybe too much.\u201d", "Victoria", "setPersonFlag(\\'Gabby\\',5)");
		if (Place == 11 && perBeasley.isCharmedBy() &&
			!this.checkFlag(9) && !this.checkFlag(8)) {
			var sfx = perBeasley.getGenderSuffix();
			if (sfx == "-bimbo1") addQuestionR(md, "ask Ms Beasley about Gabby's necklace", "\u201cUhhhh, a necklace you say?\u201d Miss Beasley giggles happily. \u201cI totes love jewelry, you think it'll look prittys on my tittys?\u201d Miss Beasley laughs about her own wordplay, and you have to admit to yourself that you may have gone a little overboard with her transformation.\u201d", "MrBeasley", "setPersonFlag(\\'Gabby\\',9);setQueryParams()");
			else if (sfx == "-bimbo2") addQuestionR(md, "ask Ms Beasley about Gabby's necklace", "\u201cUhhh, Hypnosis... and magic trinkets?\u201d Miss Beasley scratches the back of her head. \u201cYes, yes I, like, used to know real lots 'bout that... I think...\u201d</p>" + "<p>You ask if there is anything she can remember, and Miss Beasley contemplates almost painfully long.</p>" + "<p>\u201cUh... sorry...\u201d Her head sinks down in a moment of frustration. \u201dAll I can think of is how much I want you to fuck me, or how much I like being fucked in general...\u201d There is a brief moment of annoyance on her face, but it is quickly washed away by a cheerful smile.</p>" +
				"<p>\u201cSorry, don't know 'bout this stuff anymore, but I know lots 'bout fucking! Would you like to ask me something 'bout that, " + perYou.getPersonName() + "?\u201d</p>" + "<p>You really did a number on your teachers brain with that spell. There's no useful information to get here.", "MrBeasley", "setPersonFlag(\\'Gabby\\',9);setQueryParams()");
			else if (sfx == "-male")
				if (sType === "") addLinkToPlace(md, "ask Mr Beasley about Gabby's necklace", Place, "type=gabbyaskbeasley2", "\u201cYou have found one of Kurndorfs psychomancy charms?\u201d Your Teacher looks at you incredulously. \u201cI had thought those to have been long lost... where have you seen it? I need... I mean you will need one if you want to make the most of your hypnotic abilities, " +
					perYou.getPersonName() + ".", "MrBeasley");
				else if (sType === "gabbyaskbeasley2") addLinkToPlace(md, "order Mr Beasley to tell you more", Place, "type=gabbyaskbeasley3", "\u201cYes, yes, of course.\u201d Mr Beasley grovels before you. \u201cYou see, Kurndorf was powerful, but even he needed underlings to do his dirty work.\u201d Mr. Beasley folds his hands in front of himself.</p>" + "<p>\u201cTo ensure they would be able to keep the common peasants under control, he had a series of trinkets crafted and imbued them with a spell.\u201d",
				"MrBeasley");
			else if (sType === "gabbyaskbeasley3") addLinkToPlace(md, "ask about the spell", Place, "type=gabbyaskbeasley4", "\u201cBasic psychomancy. Like the Dai Chu, but self-sustained and on a much smaller scale.\u201d He explains in his \u201carrogant teacher\u201d voice. \u201cPeople who are exposed to these trinkets, the longer the better, would be more inclined to trust the wearer, let down their guards, be swayed by his or her words...\u201d</p>" + "<p>\u201cThey can not really \u201centhrall\u201d a person, but a skilled Hypnotist gaining someones trust, could easily breach their mental defenses and use it to implant triggers or subtly change ones behavior... the possibilities are astonishing...\u201d",
				"MrBeasley");
			else if (sType === "gabbyaskbeasley4") addLinkToPlace(md, "ask about how to overcome it", Place, "type=gabbyaskbeasley5", "Beasley seems to be lost in his thoughts, likely basking in lecherous fantasies of what using the necklace would allow him to do to the girls in his class, and you have to roughly shake him out of them.</p>" + "<p>\u201cMy apologies, " + perYou.getMaster() + ".\u201d He straightens himself again</p>" + "<p>\u201cWell, As I said, the necklace is merely implanting an idea, little more. Once you become aware of the effect, a small amount of focus is pretty much all that is needed to shake it off. Well, unless you are already deeply under the hypnotists influence, that is.\u201d He sneers.</p>" +
				"<p>\u201cKurndorf would obviously not hand out anything that could be used against him in any way. An inexperienced attacker might be thrown of guard by its effects, possibly expecting a trap or experiencing uncertainty, but this is nothing a strong willed mind like yours can not overcome once aware of the influence, I am sure, " + perYou.getMaster() + "\u201d", "MrBeasley");
			else {
				if (sType == "gabbyaskbeasley5") addQuestionR(md, '"How could Gabby have found one of these trinkets?"', "\u201cDidn't you know? The Halliway Family used to be minor nobles serving Kurndorf, Percy Halliwell, the last recorded member of his line to live in Glenvale, likely got as much from what is now the Gates...\u201d He speaks the name with utter disdain. \u201c...mansion as he could carry before he ran away.\u201d</p>" +
					"<p>\u201cWhen my own Ancestors took residence, they found barely anything of use... to think a trinket of such importance was right here in Glenvale, I could have...\u201d He stops mid sentence as if fighting with himself before going back to groveling.</p>" + "<p>\u201cOf course, whatever former ambitions I may have had now take second place to yours, " + perYou.getMaster() + ". And I hope you continue to see my use.\u201d His eyes focus on you wantonly, " + (perYou.isBornMale() ? "and you kinda know how the girls in class must have felt with him." :
						"with that creepy lecherous look you know so well from him, but he is a lot less unsettling now that he's under your control."), "MrBeasley", "GabbyGotInformation()")
			} else if (sfx == "-bondage")
				if (sType === "") addLinkToPlace(md, "ask Miss Beasley about Gabby's necklace", Place, "type=gabbyaskboundbeasley2", "\u201cYou want me to tell you more about a Necklace you saw being used to hypnotize someone?\u201d Miss Beasley looks like she struggles with herself, and it's obvious she doesn't want to help you out.</p>" +
					"<p>\u201cWhy should I... why...\u201d She curses under her breath, her lips beginning to form words she never gets to say until she finally gives up with a frustrated sigh.\u201d</p>" + "<p>\u201cI presume this is an order \u201d" + perYou.getMaster() + "?\u201d\u201d", "MrBeasley");
				else if (sType === "gabbyaskboundbeasley2") {
				if (!checkPersonFlag("MrBeasley", 13)) addQuestionR(md, "of course it is, and just for that attitude she will also strip naked and bend over the desk", "Miss Beasley protests, even as her body is already following your orders, and she looks seriously embarrassed as she leans over her desk and spreads her legs for you.",
					"", "setPersonFlag(\\'MrBeasley\\',13)");
				addLinkToPlace(md, "order her to tell you everything", Place, "type=gabbyaskboundbeasley3", "\u201cOf course, " + perYou.getMaster() + ".\u201d Miss Beasley breathes out. \u201cYou see, Kurndorf was powerful, but even he needed underlings to do his dirty work, and he had to ensure they would be able to keep the common peasants under control.\u201d She begins to explain.</p>" + "<p>\u201cSo, he had a series of trinkets crafted and imbued them using a simple spell.\u201d",
					"MrBeasley")
			} else if (sType === "gabbyaskboundbeasley3") {
				if (perBeasley.checkFlag(13))
					if (getQueryParam("tease") === "") addQuestionR(md, "tease her while she speaks", "You can feel her tense up in anticipation when you move your fingers towards her folds and slowly drag them along the sensitive surface, and while Miss Beasley may grind her teeth, her new body clearly enjoys the attention just as much as you enjoy the cute little gasp escaping her lips and the way her voice begins to tremble as she speaks on.",
						"", "addQueryParams(\\'tease=true\\')");
				addLinkToPlace(md, "let her tell you about the spell", Place, "type=gabbyaskboundbeasley4", "\u201cBasic psychomancy. Like the Dai Chu, but self-sustained and on a much smaller scale.\u201d She explains, doing her best to sound calm. \u201cPeople who are exposed to these trinkets, the longer the better, would be more inclined to trust the wearer, let down their guards, be swayed by his or her words...\u201d</p>" + "<p>\u201cThey can not really \u201centhrall\u201d a person, but a skilled Hypnotist gaining someones trust, could easily breach their mental defenses and use it to implant triggers or subtly change ones behavior... the possibilities would be...\u201d Her mind seems to trail off...",
					"MrBeasley")
			} else if (sType === "gabbyaskboundbeasley4") {
				if (perBeasley.checkFlag(13))
					if (getQueryParam("spank") === "") addQuestionR(md, "give her a good spanking", "Miss Beasley's body twitches forward with a loud, sensuous moan the moment your hand connects with her rear.</p>" + "<p>\u201cDammit, don't...\u201d Whatever protest she may have had is silenced by a second slap to her other cheek, followed by a third and a forth, each one forcing a soft, euphonious noise from your teachers lips.</p>" + "<p>\u201cCurse this body...\u201d Miss Beasley breathes through her teeth as you grant her a moment of respite and softly drive your fingertips over the reddening flesh. \u201cWhy does this have to feel so...\u201d She angrily grinds her teeth together before finishing the sentence, but you have a good idea of what she tried to say by the way her folds are dampening.",
						"", "addQueryParams(\\'spank=true\\')");
				addLinkToPlace(md, "tell her to focus and continue", Place, perBeasley.checkFlag(13) ? "type=gabbyaskboundbeasley5" : "", "\u201cMy apologies, " + perYou.getMaster() + ".\u201d Her exposed body shivers a little.</p>" + "<p>\u201cThey have a weakness, of course, the necklace is merely implanting an idea, little more. Once you become aware of the effect, a small amount of focus is pretty much all that is needed to shake it off. Well, unless you are already deeply under the hypnotists influence, that is.\u201d She shifts a little on the desk as she speaks.</p>" +
					"<p>\u201cKurndorf would obviously not hand out anything that could be used against him in any way. An inexperienced attacker might be thrown of guard by its effects, possibly expecting a trap or experiencing uncertainty, but it's nothing a strong willed mind like yours can't overcome once aware of the influence, I am sure, " + perYou.getMaster() + "\u201d", "MrBeasley", perBeasley.checkFlag(13) ? "" : "GabbyGotInformation()")
			} else if (sType == "gabbyaskboundbeasley5") addQuestionR(md, "ask if she wants to be rewarded",
				"\u201cThank you for your help, Miss Beasley.\u201d You put a strong emphasis on the honorific, much to her annoyance. \u201cWould you like me to reward you?\u201d</p>" + "<p>The former man desperately tries to muffle her moans as you begin to drive your fingers over her exposed sex, shivering delightfully with every small movement and yet unwilling to lower herself to actually ask for relieve.</p>" + "<p>Of course, her new body betrays her. Your fingers push deeper into the damp tunnel and every single motion makes her twitch and tense up violently, her body shaking as wave after wave of those pleasant little shocks rushes through her but still biting her lower lip and not speaking up even as she is close to climax.</p>" +
				"<p>\u201cStill sure you do not want a reward, Miss Beasley?\u201d You stop moving and watch the struggle on your teachers face.\u201d</p>" + "<p>\u201cAlright.\u201d You pull your fingers away, and for a second, you are sure she would crack, but to her credit, she remains silent.</p>" + "<p>\u201cOh, you are of course not allowed to reward yourself.\u201d You casually mention as you wipe her juices from your fingers. \u201cYou will not be allowed to touch yourself or otherwise climax for the rest of the day, understood?\u201d</p>" +
				"<p>\u201cY...yes, " + perYou.getMaster() + "...\u201d</p>" + "<p>\u201cGood girl.\u201d", "", "GabbyGotInformation()")
		} else if (Place == 436 && checkPersonFlag("AdeleRoss", 6) && !this.checkFlag(8))
			if (sType === "") addLinkToPlace(md, "ask Adele if she knows anything about that necklace", Place, "type=gabbyaskadele2", "\u201cActually, yes, I do. I had expected Beasley to use something like this, so I've read up on these trinkets to find out how to counter them.\u201d</p>" + "<p>\u201cSee, the Warlock Kurndorf granted his most loyal followers various trinkets to help them spread his influence. Bracelets, necklaces, staffs and rods... all of them strong enough to influence the normal populace, but never as strong as that they could become a threat to himself, and if I am right, your mothers assistant is using a basic psychomancy charm.</p>" +
				"<p>It's not quite mind control, but it works on similar principles to the spell you are using.\u201d", "AdeleRoss");
			else if (sType == "gabbyaskadele2") addLinkToPlace(md, '"How exactly does it work?"', Place, "type=gabbyaskadele3", "\u201cAn \u201cidea\u201d is placed in the minds of those affected by it, usually that the wearer is trustworthy and likable, leading people to be at ease and dropping their guard around them, possibly even making them think twice about attacking. There are limitations, though.\u201d</p>" +
			"<p>\u201cEye contact with the trinket needs to be established, the longer the better, and the effects are easily shaken off once you know about them. It won't enthrall anyone just by being worn, but it likely helped this woman to convince your mother to allow herself be hypnotized.\u201d", "AdeleRoss");
		else {
			if (sType == "gabbyaskadele3") addQuestionR(md, '"Are there any defenses?"', "\u201cUsually not. Some who fought those wielding these trinkets reported a strong feeling of unease, as if they are about to make a grave mistake by attacking, but it can apparently be easily overcome if your conviction is strong enough, so you basically just need to really want to charm her, I'm sure you can manage that.\u201d",
				"AdeleRoss", "GabbyGotInformation()")
		} else if (Place == 192 && isCharmedBy("Sarah") && !this.checkFlag(8))
			if (sType === "") addLinkToPlace(md, "ask Sarah if she knows anything about that necklace", Place, "type=gabbyasksarah2", "\u201cI should know something about this.\u201d Sarah moves to get a book. Magic trinkets were part of my early training before uncle Ronnie... her voice breaks as she speaks, Sarah looks close to tears for about a second before the pink glow flares up behind her eyes and a carefree smile returns to her face. \u201cUh... where was I... oh yes! The Warlock Kurndorf granted his most loyal followers various trinkets to help them spread his influence. Bracelets, necklaces, staffs and rods... all of them strong enough to influence the normal populace, but never as strong as that they could become a threat to himself.\u201d She turns the book around and points to a drawing of a familiar looking piece of jewelry.</p>" +
				"<p>\u201cIf I am right, your little hypnotist is using a basic psychomancy charm, not quite mind control, but it works on similar principles to the Dai Chu.\u201d", "Sarah");
			else if (sType == "gabbyasksarah2") addLinkToPlace(md, '"How exactly does it work?"', Place, "type=gabbyasksarah3", "\u201cAn \u201cidea\u201d is placed in the minds of those affected by it, usually that the wearer is trustworthy and likable, leading people to be at ease and dropping their guard around them, possibly even making them think twice about attacking. There are limitations, though.\u201d</p>" +
			"<p>\u201cEye contact with the trinket needs to be established, the longer the better, and the effects are easily shaken off once you know about them. It won't enthrall anyone just by being worn, but it likely helped this woman to convince your mother to allow herself be hypnotized.\u201d", "Sarah");
		else {
			if (sType == "gabbyasksarah3") addQuestionR(md, '"Are there any defenses?"', "\u201cUsually not. Some who fought those wielding these trinkets reported a strong feeling of unease, as if they are about to make a grave mistake by attacking, but it can apparently be easily overcome if ones conviction is strong enough.\u201d Sarah closes the book.</p>" +
				"<p>And you are the strongest and most wonderful person I know, " + perYou.getMaster() + '"', "Sarah", "GabbyGotInformation()")
		} else if (!isMurderPath() && this.checkFlag(7) && !this.checkFlag(13)) {
			if (isPersonHere("Mayor") && isCharmedBy("Mayor")) {
				if (sType === "" && !this.checkFlag(10)) addLinkToPlace(md, "ask Mayor Thomas about the press gathering", Place, "type=askmayorconference2", "\u201cOh yes, the press gathering.\u201d Beatrice answers dispassionately, and you get the feeling she is a little disappointed that you are not here for sex. \u201cI was supposed to promote a project of mine in the city outskirts, but I fear questions regarding the recent influx of strange events will steal most of the attention away from it, and...\u201d She stops halfway, her eyes going wide!\u201d</p>" +
					"<p>\u201cYou wish to attend, right, " + perYou.getMaster() + "?\u201d Her interest perks up quickly, realizing she might have a chance to please you. \u201cFor the most part, we have only invited journalists from various publications. It's far from the event I intent to present you with, but there are a few socialites scheduled to attend to raise public interest, as well.\u201d She is literally pushing her chest out now and giving you the bedroom eyes. \u201cThere's no one nearly as influential and useful to you as I am, of course, but if you have your eye on anyone just say the word!\u201d",
					"Mayor");
				else if (sType == "askmayorconference2") addLinkToPlace(md, "tell her about Gabby", Place, "type=askmayorconference3", "\u201cThe representative of MC channel 4? Consider it done.\u201d The Mayor doesn't even ask why you would want to charm her, and you don't feel the need to tell her the whole story anyway.</p>" + "<p>\u201cI will find a way to isolate her from the rest of the attendees and make sure that you receive a VIP pass with full access to the entire facility.\u201d She is practically brimming with enthusiasm. \u201cJust make sure to be here before <b>6:00 PM " +
					(this.checkFlag(23) ? "today" : "tomorrow") + "</b> and I will also ensure that you look the part.\u201d</p>" + "<p>\u201cLook the part?\u201d You ask, and the Mayor nods.</p>" + "<p>\u201cIt is still an upper class event, but with your natural radiance, my influence and the right attire, no one will question your right to be there, I promise, " + perYou.getMaster() + "!\u201d</p>" + "<p>Well you didn't even consider that you shouldn't just walk in there with your casual attire, but it seems mayor Thomas has thought of that. Now only one question remains, are you ready to deal with Gabby and the Necklace?",
					"Mayor", "setPersonFlag('Gabby',10)");
				else if (sType == "askmayorconference3") {
					startAlternatives(md);
					addQuestionR(md, "you still have something to take care off, leave for now", "There are still a few things you need to do before you face Gabby, but Mayor Thomas assures you that everything will be ready once you return.</p>" + "<p>Just make sure to be in Mayor Thomas's office before <b>6:00 PM " + (this.checkFlag(23) ? "today" : "tomorrow") + "</b>, the event can not be rescheduled at this point.", "Mayor", "setQueryParams()")
				}
				if (this.checkFlag(23) &&
					Place == 110)
					if (sType === "" || sType == "askmayorconference3") {
						addPopupLinkToPlaceC(md, "wait at the Town hall till 6:00 pm and get ready for the event", 110, "type=waitconfmayor2", "Waiting for the Conference", '<img src="Images/Items/' + (perYou.isBornMale() ? "suit" : "dress") + '.jpg" style="width:25%;float:left;margin-right:5px" alt="Dress">' + "You spend the rest of the day getting ready for the event, forming a plan with Mayor Thomas, picking out a nice " + (perYou.isBornMale() ? "suit" : "dress") + " to wear and of course having a shower...");
						if (sType == "askmayorconference3") endAlternatives(md)
					}
			}
			if (isPersonHere("Sarah")) {
				if (sType === "" && !this.checkFlag(11)) addLinkToPlace(md, "ask Sarah about the interview with Gabby", Place, "type=asksarahconference2", "Sarah eyes you curiously when asked about the upcoming event before asking you to have a seat and talk.</p>" + "<p?\u201cI am indeed scheduled to make an appearance during that event. The Gates Family has always donated generously to the city, after all.\u201d She folds her hands on her lap. \u201dThese events tend to be dull, so I usually take Lauren as my \u201cplus one\u201d with me to provide some entertainment.\u201d You see Lauren shiver from the corner of your eye, and Sarah smile sweetly to her before turning back to you. \u201cBut now you have me curious, so...\u201d She folds her fingers in her lap. \u201cWhy is my uncles apprentice/my ally interested in this event? You surely don't just want to mingle with the press there.\u201d",
					"Sarah");
				else if (sType == "asksarahconference2") addLinkToPlace(md, "tell her about Gabby's plans", Place, "type=asksarahconference3", "You lay out what you have seen with as little graphical detail as possible, telling Sarah about the necklace, Gabby's attempts to hypnotize your mother and about your plan to isolate Gabby at the event and get the necklace.</p>" + "<p>\u201cYour mothers assistant is quite the wicked little woman, it seems.\u201d Sarah chuckles. \u201cAlright, I will gladly take you with me to the event, but I want to be there when you use the spell.\u201d",
					"Sarah");
				else if (sType == "asksarahconference3") addLinkToPlaceC(md, '"The Spell?"', Place, "type=asksarahconference4", "\u201cThe Dai chu, you do intend to use it to turn that naughty little hypnotist into your personal slut, right?\u201d</p>" + "<p>You did not expect Sarah to be that direct about it, and your surprise must have been written on your face.</p>" + (checkPersonFlag("Sarah", 9) ? "\u201cYou have attempted to use it on me, remember? Don't worry, I don't blame you for trying, but I certainly want to see what happens when the spell works.\u201d" :
						"") + (isCharmedPath() ? "You are the first apprentice my uncle took on in decades, you can't blame me for taking an interest in you.\u201d Sarah smiles. \u201cDon't worry, I don't tattle. Uncle Ronnie may believe that magic is meant to help and defend, and I agree, but why shouldn't we amuse ourselves on occasion?\u201d" : "\u201cI believe that you are well aware by now, that I have taken a keen interest in my ally's exploits.\u201d Sarah explains nonchalantly. \u201cAnd of all the spells you know, this one interests me the most, for obvious reasons.\u201d"),
					"Sarah");
				else if (sType == "asksarahconference4") addLinkToPlaceC(md, '"So, you do me a favor if I do you a favor?"', Place, "", "\u201cExactly. It is a simple exchange of gifts, and you will find that those trades are very important within the supernatural community, is it not so, Lauren?\u201d</p>" + "<p>You don't know why Sarah defers to her maid for this question, or why Lauren seems to shift uncomfortably before answering. \u201cIt is as my Lady says. The exchange of gifts and favors is taken very seriously. It makes and breaks  alliances, and accepting or handing out favors without offering or taking anything in return can lead to... unfortunate situations.\u201d</p>" +
					"<p>\u201cIt may seem egoistic to you, but I will not be able to assist you without a favor in return, so what do you say?\u201d", "Sarah", "setPersonFlag('Gabby',11)");
				if (this.checkFlag(11) && !this.checkFlag(12)) {
					startAlternatives(md);
					addLinkToPlace(md, "You don't mind her watching, but no interference", Place, "", "\u201cOf course not.\u201d Sarah looks positively giddy with excitement. \u201cI promise to not speak or interfere until the spell has finished claiming the woman. You have my word.\u201d",
						"Sarah", "setPersonFlag('Gabby',12)");
					addLinkToPlace(md, "No deal, you prefer to do this alone", Place, "", "\u201cThis is unfortunate.\u201d Sarah's breathes out a disappointed sigh. \u201cBut my offer stands, I will be here in case you change your mind.\u201d", "Sarah");
					endAlternatives(md)
				}
				if (this.checkFlag(12)) {
					if (sType === "" && !this.checkFlag(10)) addLinkToPlace(md, "ask if Sarah knows anything about that necklace", Place, "type=asksarahconference5", "\u201cYes, I have been thinking about it as well, and I may know how to overcome it.\u201d Sarah motions for Lauren to fetch a book. \u201cMagic trinkets were part of my early training... before uncle Ronnie decided I was not ready.\u201d There is some bitterness in Sarah's voice as she flips through the pages. \u201cThe Warlock Kurndorf granted his most loyal followers various trinkets to spread his influence. Bracelets, necklaces, staffs and rods... all of them strong enough to influence the normal populace, but never as strong as that they could become a threat to himself.\u201d She turns the book around and points to a drawing of a familiar looking piece of jewelry.</p>" +
						"<p>\u201cIf I am right, your little hypnotist is using a basic psychomancy charm, not quite mind control, but it works on similar principles to the Dai Chu.\u201d", "Sarah");
					else if (sType === "asksarahconference5") addLinkToPlaceC(md, '"How exactly does it work?"', Place, "type=asksarahconference6", "\u201cAn \u201cidea\u201d is placed in the minds of those affected by it, usually that the wearer is trustworthy and likable, leading people to be at ease and dropping their guard around them, possibly even making them think twice about attacking. There are limitations, though.\u201d</p>" +
						"<p>\u201cEye contact with the trinket needs to be established, the longer the better, and the effects are easily shaken off once you know about them. It won't enthrall anyone just by being worn, but it likely helped this woman to convince your mother to allow herself be hypnotized.\u201d", "Sarah");
					else if (sType === "asksarahconference6") addLinkToPlaceC(md, '"Are there any defenses?"', Place, "type=asksarahconference7", "\u201cUsually not. Some who fought those wielding these trinkets reported a strong feeling of unease, as if they are about to make a grave mistake by attacking, but it can apparently be easily overcome if ones conviction is strong enough.\u201d",
						"Sarah");
					else if (sType === "asksarahconference7") addLinkToPlaceC(md, '"Anything else?"', Place, "type=asksarahconference8", "\u201cNo, for all I care, we may begin preparations.\u201d Sarah smiles mischievously. \u201dI invite you to stay here until we are ready to leave, and I am sure we will find a nice suit/dress to make you presentable at the event.\u201d</p>" + "<p>\u201cIf there is anything left you feel you need to do, remember to be here before <b>6:00 PM " + (this.checkFlag(23) ? "today" : "tomorrow") +
						"</b>. I will not be able to delay my departure.\u201d", "Sarah", "GabbyGotInformation()");
					else if (sType == "asksarahconference8") {
						startAlternatives(md);
						addQuestionR(md, "leave for now", "\u201cVery well, Lauren shall make sure the door is open for you during the day. Just be here in time.\u201d", "Mayor", "setQueryParams()")
					}
					if (this.checkFlag(23))
						if (sType === "" || sType == "asksarahconference8") {
							addPopupLinkToPlaceC(md, "wait with Sarah and get ready", 110, "type=waitconfsarah2", "Waiting for the Conference", '<img src="Images/Items/' +
								(perYou.isBornMale() ? "suit" : "dress") + '.jpg" style="width:25%;float:left;margin-right:5px" alt="Dress">' + "You spend the rest of the day getting ready with Sarah, who takes great pleasure in making sure you \u201clook the part\u201d by picking out a " + (perYou.isBornMale() ? "suit" : "dress") + " from her surprisingly big collection.</p>" + "<p>Time flies by as you go over the plan again, you will pose as a servant who is filling in for Lauren, which should give you enough freedom to move around in Sarah's name.</p>" +
								"<p>When the time of the interview comes, Sarah will take you with her, but you'll probably have to hurry, as Gabby will most likely recognize you.");
							if (sType == "asksarahconference8") endAlternatives(md)
						}
				}
			}
		}
	};
	per.showPersonTextHere = function(md) {
		if (Place == 452 && this.isHere())
			if (this.getCharmedLevel() == 2) md.write("<p>Gabby eyes you as walk into the room, she tries to look unimpressed, but you can see her pressing her tights together uncomfortably.</p>" + '<p>"Oh, it\'s you... are you here to gloat or here to fuck?"</p>');
			else if (this.getCharmedLevel() == 4) md.write("<p>Gabby always looks like she barely tolerates your presence.</p>" + "<p>She usually doesn't ask for you to play with her unless it has been a few days since your last visit, but her eyes follow you intently, and she is clearly hoping you'll take the first step.</p>");
		else if (this.getCharmedLevel() == 1) md.write("<p>Gabby doesn't like you being in her home, but she won't chase you out, either.</p>");
		if (Place == 415 && sType === "" && !perYou.checkFlag(12) && !this.checkFlag(1) &&
			!isArrestPossible()) md.write("<p>You notice through the door to Gabby's small office there is a large book on her desk. What attracted your attention is that it is a book about hypnosis, and that Gabby is wearing a new spiral pendant, the stereotypical symbol of the hypnotist. You would guess she is interested in hypnotherapy, or in performing on stage...</p>")
	};
	per.handleItem = function(no, cmd) {
		if (sType != "gabbyhousestudy10" && (sType.indexOf("gabbyhousestudy") != -1 || sType.indexOf("vamphelpgabby") != -1)) {
			addComments("You are unable to move, you cannot cast spells or use any items");
			return "handled"
		}
		if (no == 32) {
			if (cmd == 1)
				if (sType.indexOf("conferencetalkjulie") != -1) {
					noeffectSilverRing();
					return "handled"
				}
			return ""
		}
		if (no == 15 && cmd == 2) {
			if (Place == 412 && sType == "meetgabby")
				if (CastClairvoyanceSpell()) {
					addComments("The spell reveals there is something magical about her necklace");
					return "handled"
				}
			return ""
		}
		if (no == 14 && cmd == 2) {
			if (Place == 412 && sType == "meetgabby") {
				addComments("You whisper the words and begin to cast the spell but something... is not right. A strange feeling of dread washes over you, as if it would be a really bad idea to use that spell now...</p>" +
					"<p>Maybe Gabby has some sort of protection in place? You can't risk it, better learn more about her and the necklace, first.");
				return "handled"
			}
			if ((Place == 97 || Place == 98) && sType.indexOf("conference") != -1) {
				if (sType == "conferencegabby") CastCharmSpell("Gabby", Place, 4, "type=conferencecharm1");
				else addComments("You are in a room full of Reporters and Camera Teams, better not risk it.");
				return "handled"
			}
			if (Place == 453 && sType == "gabbyhousestudy10") {
				CastCharmSpell("Gabby", Place, 4, "type=studycharm1");
				return "handled"
			}
			if (Place ==
				452 && this.isHere() && this.isCharmedBy() && sType == "") {
				CastCharmSpell("Gabby", Place, 4, "", "", "type=gabbyrecharm1");
				return "handled"
			}
		}
		return ""
	}
}

function getSoulBoundCrystal(no) {
	if (no == 52 && perKurndorf.getQuestRitual() >= 200) return "Soul Bound Crystal";
	findPerson("Ghost");
	if (no == 64 && per.place == -64) return "Soul Bound Crystal Ring";
	return ""
}

function initialiseGhost() {
	addPerson("Ghost", 443, "NurseGhost");
	per.health = -1;
	per.isDead = function() {
		return true
	};
	per.passTimeDay = function() {
		this.setFlag(1, false);
		this.setFlag(7, false);
		if (this.checkFlag(13) && !this.checkFlag(14) && isCharmedBy("Desiree")) {
			movePerson("Desiree", 444);
			this.setFlag(14)
		}
		if (this.place == -1) {
			this.place = this.checkFlag(16) ? 408 : 443;
			return "<p>Keana fades from sight as dawn breaks.</p>"
		}
		return ""
	};
	per.whereNow = function() {
		if (this.place == -64) return this.place;
		if (isDay()) return 0;
		return this.place
	};
	per.addPlaceImageLeft = function(lit) {
		if (Place == 443 && this.isCharmedBy() && this.isHere() && sType === "" && this.place != -1)
			if (!this.checkFlag(7) && !this.checkFlag(8)) return this.showPerson("ghostnurse7.jpg", "", "", "", "", false, "string");
			else return this.showPerson("ghostnurse3.jpg", "", "", "", "", false, "string");
		if (Place == 408 && this.isCharmedBy() && this.isHere() && wherePerson("Miku") != 408 && sType === "" && this.place != -1)
			if (!this.checkFlag(7) && !this.checkFlag(8)) return this.showPerson("ghostnurse7.jpg", "", "", "", "", false,
				"string");
			else return this.showPerson("ghostnurse3.jpg", "", "", "", "", false, "string");
		return ""
	};
	per.isPlaceImageRight = function() {
		return this.whereNow() == -1 || this.isHere() && wherePerson("Miku") == 408 && Place == 408
	};
	per.showPlaceImageRight = function(md) {
		if (this.whereNow() == -1) this.showPersonFace("", "", "", "Keana, the ghost", md);
		else this.showPerson("ghostnurse3.jpg")
	};
	per.showEventPopup = function() {
		if (sType !== "") return false;
		if (Place == 408 && this.isHere() && !this.checkFlag(17) && perYou.FindItem(64) > 0) {
			this.setFlag(17);
			showPopupWindow("Keana and the Ring", "<img src='Images/Items/crystalring-glow.jpg' style='width:30%;float:right;margin-left:5px' alt='Ring'>" + "You feel something odd, the crystal ring on your finger feels cold and when you hold it up to examine it, it gets colder. You realise it seems to be reacting to the presence of Keana.<br><br>" + "Does this mean it is some sort of ghost detector? Keana looks at at are reaches out to touch it. As she does her fingers distort, but she dos not seem in pain or otherwise affected.<br><br>" +
				"You do not know what this means, you could try manipulating the ring further", "dispPlace()");
			return true
		}
		if (this.place == -1 && Place == 408) {
			this.place = 408;
			if (!this.checkFlag(16)) {
				this.checkFlag(16);
				showPopupWindow("Keana in the Attic", "<img src='Images/" + this.getImg("ghostnurse4.jpg") + "' style='width:34%;float:right;margin-left:5px' alt='Keana'>" + "Keana quickly walks from behind you and walk into the storage room and takes a seat on a box. She looks content and you hear her voice faintly,<br><br>" + '"...here...your home...let me stay here..."<br><br>' +
					"Well it would seem she likes it here, so you wait with her until dawn to make sure this is sealed as her new 'haunt'", "passTimeDay();dispPlace()")
			} else showPopupWindow("Keana in the Attic", "<img src='Images/" + this.getImg("ghostnurse4.jpg") + "' style='width:34%;float:right;margin-left:5px' alt='Keana'>" + "Keana returns to her place, the storage room, looking content, you hear her faint voice,<br><br>" + '"...home..."<br><br>' + "Just to be sure you spend the rest of the night with her, to make sure this is sealed as her 'haunt'",
				"passTimeDay();dispPlace()");
			return true
		}
		return false
	};
	per.showEvent = function() {
		var md;
		if (Place == 141 && this.place == -1 && !checkPlaceFlag("SacredClearing", 2) && findPerson("Vampyre").isMonstersInSacredClearing()) {
			md = WritePlaceHeader(true, "", "black");
			showPopupWindow("<i>Too Thin</i> Sacred Clearing", "<img src='Images/" + this.getImg("ghostnurse10.jpg") + "' style='float:right;width:35%;margin-left:5px' alt='Ghost'>" + "You see movement in the darkness, and you feel a hand on your shoulder. Startled you see Keana looking very bright and solid. She steps in front of you wrapped in ectoplasm holding out her hands warding whatever it is away.<br><br>" +
				"The shape in the darkness retreats and vanishes into the darkness. Keana steps back to your side and rests her hand on your shoulder.");
			setPlaceFlag("SacredClearing", 2);
			WritePlaceFooter(md, "", true, true);
			return true
		}
		if (sType == "ghostclairvoyance1" && Place == 141) {
			if (!this.checkFlag(1))
				if (this.extra[0] === 0) this.extra[0] = Math.floor(Math.random() * 3) + 1;
				else {
					this.extra[0]++;
					if (this.extra[0] > 5) this.extra[0] = 1
				}
			md = WritePlaceHeader(false, this.extra[0] != 3 ? "td-left-large" : "");
			AddImage("stones4" + String.fromCharCode(this.extra[0] +
				96) + ".jpg");
			addPlaceTitle(md, "A Presence");
			this.setFlag(1);
			md.write("<p>You cast the spell and ");
			switch (this.extra[0]) {
				case 1:
					md.write("see an ethereal shape moving near one of the stones, as she(?) passes behind the stone, the apparition does not emerge from the other side.....</p>");
					break;
				case 2:
					md.write("see an ethereal shape standing near the stones, she(?) just stands there, not moving in any way, but you feel they are staring at you....</p>");
					break;
				case 3:
					md.write("see in the trees an ethereal shape slowly moving. The figure is heavily shrouded and you cannot make out anything about the ghostly figure.....</p>");
					break;
				case 4:
					md.write("see in the trees an ethereal shape slowly moving. The figure is indistinct, a person but you can make out little more.....</p>");
					break;
				case 5:
					md.write("some of the swirling mist seems to form into a vaguely human form or at least you hope human.....</p>");
					break
			}
			startQuestions();
			addLinkToPlace(md, "explore the sacred clearing more", 141);
			addLinkToPlace(md, "go to " + perGates.getPersonNameShort() + "'s estate", 16);
			WritePlaceFooter(md, "", false, true);
			return true
		}
		if (sType == "ghostcharmsex" &&
			Place == 141) {
			md = WritePlaceHeader(false, !perYou.isMaleSex() && isExplicit() ? "td-left-large" : "");
			if (isExplicit()) AddImageRandomX(perYou.isMaleSex() ? "ghost5b" : "ghost5g", 3);
			else AddImage("ghost5.jpg");
			addPlaceTitle(md, "Charming Ghost");
			AddMana(15);
			md.write("<p>You cast the unlife enspelled spell and direct it at the ethereal shape ");
			switch (this.extra[0]) {
				case 1:
					md.write("and you have sex with the ghost.</p>");
					break;
				case 2:
					md.write("and you have sex with the ghost.</p>");
					break;
				case 3:
					md.write("and you have sex with the ghost.</p>");
					break;
				case 4:
					md.write("and you have sex with the ghost.</p>");
					break;
				case 5:
					md.write("and you have sex with the ghost.</p>");
					break
			}
			md.write("<p>As you step away, the figure vanishes, and as it does you feel a surge of mana as the spell dissolves but there is more mana than you put into the spell!</p>");
			startQuestions();
			addLinkToPlace(md, "explore the sacred clearing more", 141);
			addLinkToPlace(md, "go to " + perGates.getPersonNameShort() + "'s estate", 16);
			WritePlaceFooter(md, "", false, true);
			return true
		}
		if ((Place ==
				408 || Place == 443) && this.isHere() && sType == "ghostfuck") {
			md = WritePlaceHeader();
			if (!this.checkFlag(8)) this.showPerson("ghostnurse8.jpg");
			else this.showPerson("ghostnurse6.jpg");
			addPlaceTitle(md, "Communing with the dead");
			this.setFlag(7);
			AddMana(5);
			if (this.checkFlag(8)) {
				md.write("<p>As you look at Keana you see she is looking more and more solid, and you reach out to test and you rest your hand on her shoulder, it feels like flesh and blood, a little cool but just like any girl.</p>" + "<p>When you touch her, Keana makes an inarticulate noise, and she reaches up and takes your hand and puts it to her lips and kisses it. A strangely cool but passionate action, her cool touch and lips, but done with passion and joy.</p>" +
					"<p>You look her in the eyes and she looks at you with arousal in her expression. She kisses you and as she does you feel her move your hand to one of her breasts. There is a swirling of ectoplasm as the veils surround you both.</p>" + "<p>You make love to her again in a strangely passionate but almost silent way, the only noises those of your own passion and faint sighs of Keana. You will never again think of her as being 'cold' or 'lifeless', she is a wild and passionate lover who just happens to be a ghost.</p>");
				if (!this.checkFlag(9)) {
					md.write("<p>You are struck that this old basement is not really a pleasant place to 'commune' with Keana, it would be nicer if she could meet you somewhere else. You try to talk to her about following you to another place, but she seems to not understand, but when you finally explain, she shakes her head. It may be that ghosts are really limited to haunting a particular place, but then again you are no expert in these things.</p>");
					this.setFlag(9)
				}
			} else md.write("<p>Keana is dressed in her old nurses uniform and the way she is posing for you and how she looks, you feel she is doing this as a gift for you.</p>" +
				"<p>Then again the term dressed is generous, she was exposing her breasts for you after all. Your ghostly lover does a sensual if somewhat eerie dance as she strips her uniform, and at the end she is kneeling before you, ready for you.</p>" + '<p>You reach out, unsure as she is still partly transparent, but you solidly caress her ass. You hear her sigh faintly and then a soft voice <i>"...please..."</i>.</p>' + "<p>You make love to her again, but it is so strange. She is transparent, but full of flesh and passion, cool but hot with arousal.</p>" +
				"<p>After you see she has resumed her naked appearance, draped in ectoplasmic veils. Equally transparent as before but somehow 'less' present.</p>");
			this.setFlag(8);
			startQuestions(checkPlaceFlag("Hospital", 4) ? undefined : "There is no physical way out of here...");
			if (Place == 408) addLinkToPlace(md, "return to the attic", 408);
			else if (checkPlaceFlag("Hospital", 4)) addLinkToPlace(md, "return to the main part of the basement", 442);
			WritePlaceFooter(md);
			return true
		}
		if (Place == 443 && (sType == "ghostcharm" || this.isHere() &&
				this.place != -1)) {
			var perNS = findPerson("NurseSandra");
			var frm = getQueryParam("from");
			if (frm == "sandra" && sType == "ghostcharm") {
				sType = "charm1";
				this.place = 443
			}
			if (sType.substr(0, 5) == "charm") {
				md = WritePlaceHeader();
				var idx = parseInt(sType.charAt(5), 10) + 3;
				if (idx == 4) this.showPersonRorX("ghostnurse4.jpg");
				else this.showPerson("ghostnurse" + idx + ".jpg");
				addPlaceTitle(md, "Charming a Ghost");
				if (sType == "charm1") {
					this.charmThem(4);
					this.setFlag(7);
					AddMana(11);
					md.write('<p>You say "Don\'t worry Sandra" and cast the Unlife Enspelled incantation. Immediately the ghost of Keana stops and turns to look at you. You cannot help but feel a chill as a ghost stares at you, the first time she has looked at you directly..</p>' +
						"<p>As she stares at you, you feel a surge of mana as all the mana you used in the spell returns to you, maybe a little more. You fear this means the spell has failed but she is looking at you. As a test you tell her to sit down.</p>" + "<p>With a fluid gracefulness Keana the ghost sits down in a chair, wrapped in ectoplasm but otherwise naked. She seems a little more solid than before.</p>" + "<p>You remember something you had read while studying the Book about the spell, it said that ghosts and ectoplasm are a manifestation of mana, and in passing talked about using ghosts. You assumed as some sort of servant or information source, but maybe it meant as a source!</p>" +
						"<p>You try to test your control more...</p>");
					startQuestions();
					addLinkToPlaceC(md, '"Dance Keana"', 443, "type=charm2")
				} else if (sType == "charm2") {
					md.write("<p>The ghost seems to solidify even more, just her limbs are slightly trans Old Japanese ghost stories come to mind, where you cannot see the feet of a ghost. As you ponder this Keana starts to dance, weaving her ectoplasmic veil in some sort of arabian inspired dance, but since she is completely naked already it is only a vague inspiration.</p>" +
						'<p>Sandra whispers "Boss, Kea was always a great dancer. Ummm Boss, please be kind to her"</p>' + "<p>You hear a faint noise, like a faint wind but it is Keana's voice, \"Sandy...nice.." + perYou.getMaster() + '"</p>');
					startQuestions();
					addLinkToPlaceO(md, "she is yours", 443, "type=charm3")
				} else if (sType == "charm3") {
					md.write("<p>You know Keana is yours, or at least the ghost of Keana if there is a difference or that it matters. As you are looking at her you see she is looking more and more solid, and you reach out to test and you rest your hand on her shoulder, it feels like flesh and blood, a little cool but just like any girl.</p>" +
						"<p>When you touch her, Keana makes an inarticulate noise, and she reaches up and takes your hand and puts it to her lips and kisses it. A strangely cool but passionate action, her cool touch and lips, but done with passion and joy.</p>" + '<p>You look her in the eyes and she looks at you with arousal in her expression. She kisses you and as she does you feel her move your hand to one of her breasts. There is a swirling of ectoplasm as the veils surround you both, and dimly you hear Sandra "No fair, lemme see".</p>' +
						"<p>You make love to her in a strangely passionate but almost silent way, the only noises those of your own passion and faint sighs of Keana. You will never again think of her as being 'cold' or 'lifeless', she is a wild and passionate lover who just happens to be a ghost.</p>" + '<p>Later the ectoplasm clears, and you see Sandra with tears in the corner of her eyes. You ask what is troubling her, and she replies, "Nothin\' Boss, I am just happy Keana is with us, thank you Boss!"</p>');
					startQuestions();
					addLinkToPlaceO(md, "look around the basement", 443, "", perNS.addPersonFace() + "<b>Sandra</b><br><br>&quot;Boss. I should go back to my ward&quot;")
				}
				AddRightColumnMed(md);
				perNS.showPerson("Setting/sandra10.jpg");
				WritePlaceFooter(md, "", false, true);
				return true
			} else if (sType == "seeghost") {
				md = WritePlaceHeader();
				this.showPerson("ghostnurse1.jpg", "height:max");
				addPlaceTitle(md, "Haunted Basement");
				md.write("<p>You cast the clairvoyance spell, and it is almost like your eyes focus and the mist clears and becomes the figure of a pale woman standing in the corner. She is draped in a white ectoplasmic veil but is otherwise completely naked. She slowly moves around, completely unaware of your presence, she is slowly moving, she might be looking for something.</p>");
				if (!this.checkFlag(2)) {
					this.setFlag(2);
					md.write("<p>You have no idea what she is looking for, you will have to see if you can research it or speak to her friends or relatives.</p>")
				}
				startQuestions();
				addLinkToPlaceO(md, "the spell ends and the ghost disappears...", 443);
				if (checkPlaceFlag("Hospital", 4)) addLinkToPlace(md, "return to the main part of the basement", 442);
				WritePlaceFooter(md);
				return true
			} else if (sType == "ghostcharm") {
				md = WritePlaceHeader();
				this.showPerson("ghostnurse2.jpg", "height:max");
				addPlaceTitle(md,
					"A Charming Ghost");
				var cost = perYou.checkFlag(17) ? 9 : 10;
				AddMana(cost);
				md.write("<p>You cast the spell and the ghost stops what she is doing, and looks almost ecstatic for a moment, the ectoplasm swirling around her. It is like she poses for you, but the moment passes and she continues her slow wander around the room, ignoring you again. You feel a surge as the mana returns back to you.</p>" + "<p>During this she never looked at you once.</p>");
				startQuestions();
				addLinkToPlaceO(md, "the clairvoyance spell ends and the ghost disappears...",
					443);
				if (checkPlaceFlag("Hospital", 4)) addLinkToPlace(md, "return to the main part of the basement", 442);
				WritePlaceFooter(md);
				return true
			} else if (sType == "sandra") {
				md = WritePlaceHeader();
				this.place = 1E3;
				this.setFlag(6);
				this.showPerson("ghostnurse2.jpg");
				addPlaceTitle(md, "Sandra and the Ghost");
				md.write("<p>You ask Sandra to come with you to the basement,</p>" + '<p>"Sure thing Boss, I need to make it up with Kea. Gimme a bit, I need to change out of my uniform, the basement is dirty!"</p>' + "<p>You quickly go with her upstairs to change and then down to the basement. Sandra unlocks the door to the old basement, and you both are there!</p>" +
					"<p>You start to recite the Clairvoyance spell, but before you do, the ghost eerily appears, wrapped still in ectoplasm and completely naked. She looks directly at Sandra, who seems very nervous as she speaks,</p>" + "<p>\"Kea, I'm..I'm sorry I took your ring, I just wanted a keepsake. I missed you so much! Here have it back!\"</p>" + '<p>The ghost smiles faintly, and shakes her head and the blows a kiss at Sandra, who almost cries, "Don\'t go Kea"</p>' + "<p>Despite her plea the ghost of Keana looks happy and she starts to fade away....</p>");
				startQuestions();
				addLinkToPlaceO(md, "well that is solved", 443, "", perNS.addPersonFace() + "<b>Sandra</b><br><br>&quot;Sorry Boss...I..I will go back to my ward&quot;");
				if (checkPlaceFlag("Hospital", 4)) addLinkToPlace(md, "return to the main part of the basement", 442);
				AddRightColumnMed(md);
				perNS.showPerson("Setting/sandra10.jpg");
				WritePlaceFooter(md);
				return true
			}
		}
		return false
	};
	per.showPersonTextHere = function(md) {
		if (Place == 443 && this.isHere() && this.isCharmedBy() && this.place != -1)
			if (!this.checkFlag(7) && !this.checkFlag(8)) md.write("<p>Keana is waiting for you, she is not naked as before, but she is wearing her old nurses uniform. She is quite transparent though.</p>");
			else {
				md.write("<p>Keana is eerily waiting here for you, she looks ");
				if (!this.checkFlag(7)) md.write("almost solid, except for her limbs");
				else md.write("a little faint and transparent");
				md.write(".</p>")
			}
		else if (Place == 408 && this.place == 408)
			if (isDay()) md.write("<p>Keana rests during the day, there is no trace of her to be seen.</p>");
			else if (getPersonOther("Miku") == -100) md.write("<p>Living with Miku seems to have had an effect on Keana, the ghost seems more... lively, so to say, and is often tangible even before you enter the room.</p>");
		else md.write("<p>Keana's transparent form slowly phases into sight as you enter the room, and she silently greets you with a graceful bow.</p>")
	};
	per.showPersonChat = function(bGeneral, md) {
		switch (Place) {
			case 17:
				if (this.place == 443 && this.checkFlag(9) && !this.checkAnyFlags(10, 12)) addQuestionC(md, "ask about ghosts", "SirRonald", 3E3);
				break;
			case 192:
				if (this.place == 443 && this.checkFlag(9) && !this.checkAnyFlags(10, 12)) addQuestionC(md, "ask about ghosts", "Sarah", 3E3);
				break;
			case 145:
				if (this.place == 443 && wherePerson("MsJones") ==
					145 && isCharmedBy("MsJones"))
					if (this.checkFlag(9) && !this.checkAnyFlags(10, 12)) addQuestionC(md, "ask about ghosts", "MsJones", 3E3);
				break;
			case 332:
				if (this.place == 443 && this.checkFlag(12) && !this.checkFlag(13)) addQuestionC(md, "ask about ghosts", "Desiree", 3E3);
				break;
			case 384:
				if (this.place == 443)
					if (this.checkFlag(9))
						if (!this.checkAnyFlags(10, 12)) addQuestionC(md, "ask Daria about ghosts", "Daria", 3E3);
						else if (this.checkFlag(12) && !this.checkFlag(13) && wherePerson("Desiree") == 384 && !checkPersonFlag("Desiree", 1)) addQuestionC(md,
					"ask Desiree about ghosts", "Desiree", 3E3);
				break;
			case 408:
			case 443:
				if (this.isHere() && this.isCharmedBy() && sType === "" && this.place != -1) {
					if (!this.checkFlag(7)) addLinkToPlaceO(md, "commune with Keana", Place, "type=ghostfuck");
					if (this.checkFlag(15) || this.checkAnyFlags(10, 12) && Place == 443)
						if (!this.checkFlag(7)) addPopupLinkC(md, "take her by the hand", "Leading Keana Away", "<img src='Images/" + this.getImg("ghostnurse9.jpg") + "' style='width:30%;float:right;margin-left:5px' alt='Ghost'>" + "You reach out to take Keana's hand and she steps up and holds your hands, as if it is a prelude to intimacy.<br><br>" +
							(Place == 443 ? "You firmly lead her out of the old basement, as you approach the door to the main area it just opens as if it was an automatic door. You hear a faint sign from Keana like a very faint laugh.<br><br>" : "") + "As you step into the more brightly lit area you feel her other hand rest on your shoulder and you lose grasp of the hand you were holding. Looking around she is standing very closely behind you, looking a little nervous. She is standing close enough that she is almost leaning on your back, almost embracing you.<br><br>" +
							"The question is now where will you take her?" + (Place == 408 ? " First you lead her downstairs to get her away from her current haunt. You should be careful to only return to the attic with her unless you wish to rebound her to it." : ""), false, "movePerson('Ghost', -1);dispPlace(" + (Place == 408 ? 45 : "") + ");");
						else addPopupLinkC(md, "take her by the hand", "Trying to Lead Keana Away", "<img src='Images/" + this.getImg("ghostnurse3.jpg") + "' style='width:35%;float:right;margin-left:5px' alt='Ghost'>" + "You reach out to take Keana's hand but she is very faint and your hand just passes though her. She seems only vaguely aware of you and just stands there waiting.<br><br>" +
							"You will have to return another time when you have not communed with her and drained her physically and magically", false)
				}
				break
		}
	};
	per.handleItem = function(no, cmd) {
		if (no == 64 && cmd == 2) {
			if (!this.checkFlag(17)) return "";
			if (isDay()) {
				addComments("Nothing happens, but then again it is the daytime...");
				return "handled"
			}
			if (this.place == -64) {
				addComments("There is a sudden flash and Keana is standing in front of you");
				if (Place != 408) addComments(' and she whispers "...home...attic..." and vanishes from your sight.');
				addComments("</p><p>The ring returns to it's original appearance");
				this.place = 408;
				getBaseItemObj(64).image = "crystalring.jpg";
				return "refresh"
			}
			if (this.isHere()) {
				if (!this.checkFlag(18)) {
					addComments("You hold the ring out to Keana and focus on it as she again reaches out to touch it. Suddenly there is a flash of light and she is gone. You are worried, have you harmed her, or killed her?</p>" + '<p>The ring is gently glowing and you touch it with your other hand. Immediately you feel the presence of Keana, and hear a soft whisper "...nice...." and feel comforted, she seems fine.</p>' +
						"<p>You concentrate again and she reappears, smiling. You try again and there is the flash and she is gone, once more she is in the ring.");
					if (isSpellKnown("Transform")) addComments("</p><p>You wonder does this now count as a soul-bound crystal? If so then possibly Keana will help to power it as she is a source of mana, though only once per day.")
				} else addComments("You hold the ring out to Keana and focus on it as she again reaches out to touch it. Suddenly there is a flash of light and she is gone, bound into the ring again. The ring is gently glowing and you feel the presence of Keana.");
				this.place = -64;
				getBaseItemObj(64).image = "crystalring-glow.jpg";
				return "refresh"
			}
		}
		if (no == 15 && cmd == 2) {
			if (Place == 141 && !isDay())
				if (!this.checkFlag(1)) {
					dispPlace(141, "type=ghostclairvoyance1");
					return "nofooter"
				} else {
					addComments("After your last encounter, nothing more is revealed, at least for this night.");
					return "handled"
				}
			if (Place == 443) {
				if (!checkPlaceFlag("Hospital", 2)) addComments("Why would you want to? There is nothing here in this abandoned place");
				else if (isDay()) addComments("The spell reveals nothing during the daytime");
				else if (wherePerson("Ghost") == 443 && !isCharmedBy("Ghost")) {
					dispPlace(443, "type=seeghost");
					return "nofooter"
				}
				return "handled"
			}
		}
		if (no == 10 && cmd == 2)
			if (Place == 141 && !isDay()) {
				if (sType == "ghostclairvoyance1")
					if (perYou.checkFlag(23)) {
						CastUnlifeEnspelledSpell(141, "type=ghostcharmsex");
						return "handled"
					} else {
						addComments("<p>You are not skilled enough to affect spirits, the spell has no effect.</p>");
						return "handled"
					}
			} else if (Place == 443)
			if (sType == "seeghost" || sType == "sandra")
				if (perYou.checkFlag(23)) {
					CastUnlifeEnspelledSpell(443,
						"type=ghostcharm&from=" + sType);
					return "handled"
				} else {
					addComments("<p>You are not skilled enough to affect spirits, the spell has no effect.</p>");
					return "handled"
				}
		return ""
	}
}

function RepliesGina(nR) {
	var myName = per.getYourNameFor();
	if (nR == 11300) {
		bChat = false;
		setPlaceFlag("Museum", 3, false);
		moveItem(29, 276);
		Place = 276;
		addComments('<table><tr><td><img src="Images/gina3.jpg" width="30%" alt="Gina"></td><td>');
		addComments('Gina moves to open the safe for you.  "Anything else ' + myName + '?" she asks quickly, a longing look on her face.</td></tr></table>')
	}
	return true
}

function GinasVisitor() {
	setPlaceFlag("GinasHouse", 9)
}

function initialiseGina() {
	addPerson("Gina");
	per.extra = [0, 0];
	per.Replies = RepliesGina;
	per.getPersonName = function(full) {
		if (full === true) return "Gina James";
		return this.isCharmedBy() ? "Slave Gina" : "Gina, the Museum Guard"
	};
	per.getPersonAddress = function() {
		return isPlaceKnown("GinasHouse") ? "2138 Rathdown Rd, Glenvale" : ""
	};
	per.isPersonInfo = function() {
		return true
	};
	per.getPersonInfo = function() {
		var s = "<p><img src='Images/" + this.getImg("gina0.jpg") + "' class='imgpopup' alt='Gina'>";
		if (this.isCharmedBy()) return s +
			"It was a bit tricky to get Gina under your influence, but the reward was worth it. You own a blonde babe who is ready to take any commands you give her! Her boobs are only rivaled by Ms Titus, both in quality and size! The fun doesn\u2019t stop there, she rocks a body that would make every man turn their heads. It is quite clear that she trains and exercises a lot and has a great physique. Interestingly enough she told you that she was a bodyguard for the rich and famous before she became a museum security. She can prove useful in hand to hand combat if needed and she can also use guns aswell.<br><br>" +
			"She curtsies to you every time she sees you and silently comes to your side to protect and follow you. No words needed, she knows her job all too well!";
		else return s + "Gina, the museum security guard."
	};
	per.whereNow = function() {
		if ((Place == 241 || Place == 304 || Place == 315) && this.place == 0) return Place;
		if (Place == 303 && sType == "ginabath") return Place;
		return this.place
	};
	per.possessThem = function() {
		if (this.place === 0) {
			this.extra[0] += 1;
			Place = 239;
			addComments("<p>You possess the guard, Gina James. You may move Gina within the museum.</p>")
		} else {
			this.extra[1] +=
				1;
			if (this.extra[1] == 1) startTimedEvent("GinasVisitor()", 40);
			if (this.extra[1] == 2 && !checkPlaceFlag("GinasHouse", 9)) setQueryParams("type=visitor1");
			Place = 302;
			addComments("<p>You possess the security guard Gina James while she is at home. You may move Gina within her house.</p>")
		}
		return true
	};
	per.dispossessThem = function() {
		if (this.place === 1)
			if (this.extra[1] === 1) {
				setPlaceFlag("GinasHouse", 4);
				setPlaceFlag("GinasHouse", 3)
			}
		return true
	};
	per.getPossessionFace = function() {
		if (this.place === 0) return "gina-m-face";
		else return "gina-h-face"
	};
	per.showEventPopup = function() {
		if (sType !== "") return false;
		if (Place == 239 && !this.checkFlag(1) && this.place === 0) {
			showPopupWindow("Security Guard", "<img src='Images/" + this.getImg("ginaintro.jpg") + "' class='imgpopup' alt='Gina'>" + "You see patrolling around an armed guard, it is surprising the level of security for this museum.<br><br>" + "The museum guard is, for your surprise, a woman! Hell, she's the hottest guard you've ever seen! The blonde bombshell walks around with a gun in her holster and wearing a rigid, cold face. She stops only to look around for unusual or suspicious visitors, like yourself. She is really precise in her job! You know she would kick your ass in a minute if you were to touch any of the museum artefacts.",
				"setPersonFlag('Gina',1)");
			return true
		}
		return false
	};
	per.showEvent = function() {
		var md;
		if (Place == 269 && sType == "ginapool") {
			WaitHereOnly(4);
			md = WritePlaceHeader();
			this.showPerson("gina-pool.jpg");
			addPlaceTitle(md, "Swimming with Gina");
			md.write("<p>Gina arrives, dressed in a white bikini, and she seductively poses for you.</p>");
			startQuestions();
			addLinkToPlaceC(md, "it is fairly private here...", Place, "type=ginapoolsex");
			addLinkToPlaceC(md, "say goodbye to Gina", Place);
			WritePlaceFooter(md);
			return true
		}
		if (Place ==
			269 && sType == "ginapoolsex") {
			md = WritePlaceHeader(false, "td-left-large");
			this.showPerson("gina-pool-sex.jpg");
			addPlaceTitle(md, "Being Discrete and Private with Gina");
			md.write("<p>You ask your large breasted security guard to play with you more privately, and she seductively removes most of her swimsuit and lies back waiting for you.</p>");
			startQuestions();
			addLinkToPlaceC(md, "later...say goodbye to Gina", Place);
			WritePlaceFooter(md);
			return true
		}
		return false
	};
	per.isPhoneable = function() {
		return checkPlaceFlag("Hotel",
			11) && Place == 269 && this.isCharmedBy()
	};
	per.callThem = function() {
		if (Place == 269)
			if (this.place === 0) WriteComments('You call Gina to invite her to join you at the pool for a swim, but she replies, "Sorry ' + perYou.getMaster() + ' I am on duty. I cannot take time off, maybe if I was home on a holiday, but not now!". She apologies and promises to another time. ');
			else {
				gotoPlace(Place, "type=ginapool");
				receiveCall("", 'You call Gina to invite her to join you at the pool for a swim, and she answers enthusiasticaly, "Damn right!" and hangs up. You take that to mean she will be there soon.');
				WriteCommentsFooter(bChat, bChatLeft)
			}
	}
}

function initialiseGlenvale() {
	addPerson("Glenvale");
	per.passTimeDay = function() {
		this.flags[0] = 0;
		return ""
	};
	per.showPersonTextHere = function(md) {
		if (sType !== "") return;
		if (Math.floor(this.place) != Place) return;
		switch (Place) {
			case 25:
				md.write("<p>You see the campers are back at their campsite.</p>");
				break;
			case 26:
				if (this.place == 26.2) md.write("<p>You some people hiking along a track.</p>");
				break;
			case 2:
			case 94:
			case 194:
			case 238:
			case 360:
			case 455:
				md.write("<p>The streets near the center of Glenvale are busiest in the daytime, there are people walking around nearby.</p>");
				break;
			case 63:
				md.write("<p>The park can be quite busy on sunny days, people walking or just sitting in the sun.</p>");
				break;
			case 70:
				md.write("<p>You notice through a classroom door a student teacher you have seen around school. You have never been in one of his classes and you cannot quite remember his name.</p>");
				break;
			case 144:
				md.write("<p>Some sporty sutdents are around playing on the fields.</p>");
				break;
			case 195:
				if (this.place == 195.1) md.write("<p>An affectionate couple are browsing at one of the counters.</p>");
				else if (this.place == 195.2) md.write('<p>You pass a scantily clad young woman trying to decide on an item. Perhaps unfairly the word "Bimbo" comes to mind...</p>');
				break;
			case 225:
				md.write("<p>The security guard is patrolling the bank.</p>");
				break;
			case 239:
				if (this.place == 239.1) md.write("<p>You see a number of people studying the exhibits.</p>");
				else if (this.place == 239.2) md.write("<p>You see an older couple taking a rest.</p>");
				break;
			case 318:
				md.write("<p>You see a young lady near the stained glass windows, illuminated by them. She looks at you briefly but returns to her prayers.</p>");
				break;
			case 361:
			case 369:
			case 370:
				md.write("<p>A couple is near one of the tanks, the aquarium is one of the towns major date spots.</p>");
				break
		}
	};
	per.addPlaceImageLeft = function(lit) {
		if (Place == 25 && this.place == 25 && sType === "") {
			this.setFlag(4);
			return this.showPerson("townspeople-wildranges1b.jpg", "", "", "", "", false, "string")
		}
		return ""
	};
	per.isPlaceImageRight = function() {
		return Math.floor(this.place) == Place && sType === ""
	};
	per.showPlaceImageRight = function(md) {
		switch (Place) {
			case 26:
				if (this.place == 26.2) AddImage("townspeople-wildranges2.jpg");
				break;
			case 63:
				AddImage("townspeople-park" + String.fromCharCode(Math.floor(Math.random() * 2) + 49) + ".jpg");
				break;
			case 70:
				this.setFlag(3);
				AddImage("townspeople-school1.jpg");
				break;
			case 144:
				AddImage("townspeople-sportsfields" + String.fromCharCode(Math.floor(Math.random() * 2) + 49) + ".jpg");
				break;
			case 194:
			case 238:
			case 360:
			case 94:
			case 455:
			case 2:
				AddImage("townspeople-street" + String.fromCharCode(Math.floor(Math.random() * 5) + 49) + ".jpg");
				break;
			case 195:
				if (this.place == 195.1) AddImage("townspeople-generalstore1.jpg");
				else if (this.place == 195.2) AddImage("townspeople-generalstore2.jpg");
				break;
			case 225:
				AddImage("townspeople-bank-security1.jpg");
				break;
			case 239:
				if (this.place == 239.1) {
					AddImage("townspeople-museum2.jpg");
					this.setFlag(1)
				} else if (this.place == 239.2) AddImage("townspeople-museum1.jpg");
				break;
			case 318:
				AddImage("townspeople-church1.jpg");
				this.setFlag(2);
				break;
			case 361:
			case 369:
			case 370:
				AddImage("townspeople-aquarium" + Math.round((this.place - Math.floor(this.place)) * 10) + ".jpg");
				break
		}
	};
	per.showEventPopup = function() {
		if (sType !==
			"") return false;
		if (Place == 225 && this.place == 225 && !this.checkFlag(33)) {
			this.setFlag(33);
			showPopupWindow("New Security Guard", "<img src='Images/townspeople-bank-security1.jpg' class='imgpopup' alt='Bank'>" + "You see a new security guard on duty in the Bank, she seems to be a private guard hired to increase security here after the talk about burglaries and other similar problems around town.");
			return true
		}
		if (Place == 26 && this.place == 26.1 && !this.checkFlag(34)) {
			this.setFlag(34);
			showPopupWindow("A Group of Campers",
				"<img src='Images/townspeople-wildranges1a.jpg' class='imgpopup' alt='Campers'>" + "You see a group of girls setting up camp in the Wild Ranges. You try to chat but they are busy with their camp site.." + (checkPersonFlag("NurseSandra", 2) && isBritish() ? "</p><p>You recognise one of them as Nurse Sandra from the hospital, she must be out here with some friends. She notices you and briefly talks, just mentioning something about camping here as a get together with her friends." : ""));
			return true
		}
		if (Place ==
			195 && this.place == 195.9 && !this.checkFlag(35)) {
			this.setFlag(35);
			showPopupWindow("A Vaguely Familiar Woman", "<img src='Images/townspeople-generalstore-exh2.jpg' class='imgpopup' alt='Woman'>" + "A young woman approaches you and she is very familiar to you. For a moment you thought she was Leanne, she sort of looked like her for a moment.</p>" + "<p>You start to ask her what she wants and she suddenly exposes her breasts to you! You are quite sure you did not say 'show us your tits' and she quickly covers up and walks away with saying a word.");
			return true
		}
		return false
	};
	per.showEvent = function() {
		if (sType !== "") return false;
		if (Place != this.place) {
			if (this.place !== 0 && !isOutside(Math.floor(this.place)) && !gameState.nLastOut) return false;
			this.place = 0;
			if (Place == 239 && isShopOpen(2, 0, true) && !checkPlaceFlag("Museum", 8) && Math.random() < .2) this.place = this.checkFlag(1) ? 239.1 : 239 + Math.floor(Math.random() * 2 + 1) / 10;
			else if (Place == 318 && Math.random() < .2 && !this.checkFlag(2)) {
				this.place = 318;
				return false
			} else if (Place == 195 && checkPersonFlag("Leanne", 25) && Math.random() <
				.2)
				if (!this.checkFlag(35)) this.place = 195.9;
				else this.place = this.checkFlag(1) ? 195.1 : 195 + Math.floor(Math.random() * 2 + 1) / 10;
			else if (Place == 225 && wherePerson("Camryn") !== 0) this.place = 225;
			else if (Place == 70 && isShopOpen(2) && Math.random() < .05 && !this.checkFlag(3)) this.place = 70;
			else if (isDay() && (Place == 194 || Place == 238 || Place == 360 || Place == 94 || Place == 455 || Place == 2) && Math.random() < .15) this.place = Place;
			else if (Place == 26 && Math.random() < .4 && isDay() && !this.checkFlag(34)) this.place = 26.1;
			else if (Place == 26 && Math.random() <
				.1 && isDay()) this.place = 26.2;
			else if (Place == 25 && isDay() && this.checkFlag(34) && !this.checkFlag(4)) this.place = 25;
			else if (isShopOpen(2, 0, true) && (Place == 361 || Place == 369 || Place == 370) && Math.random() < .2) this.place = Place + Math.floor(Math.random() * 3 + 1) / 10;
			else if (Place == 144 && wherePerson("Kylie") != 144 && isShopOpen(2) && Math.random() < .2) this.place = Place + Math.floor(Math.random() * 2 + 1) / 10;
			else if (Place == 63 && isDay() && Math.random() < .1) this.place = Place + Math.floor(Math.random() * 2 + 1) / 10;
			if (this.place !== 0) SetRightColumnSize("")
		}
		return false
	}
}

function RepliesHannah(nR) {
	var pCharm = per.isCharmedBy();
	var myName = per.getYourNameFor();
	if (nR == 279) {
		if (getPersonOther("MrsGranger") > 0 && getPersonOther("MrsGranger") < 58) {
			setPersonOther("MrsGranger", 58);
			if (wherePerson("MrsGranger") == 275.5) movePerson("MrsGranger", 278)
		}
		var perAbby = findPerson("Abby");
		perAbby.setQuestDragonGem(10);
		perYou.completeQuest(3);
		moveItem(29, 1E3);
		PlaceI(35, 279);
		if (!pCharm) addComments('<p>"Hannah looks the vase over for a minute.  "Hmm.  I think we can get this open," she agrees, putting the vase into a vise. That doesn\'t seem to be enough so she pulls out a cutting torch. The metal melts until it the vase opens and a gem falls out.');
		else addComments('<p>Hannah smiles. "I believe I may be of service, ' + myName + '." She says, a shiver of pleasure running down her spine as she leaps into action at your command.  Minutes and a cutting torch later, the vase finally breaks - letting loose the small gem inside.')
	}
	return true
}

function HannahBikeRide(call) {
	carRide("Hannah", (call === true ? "Hannah arrives shortly after your call and" : "Hannah") + " helps you put on the helmet and safety gear, and a few minutes later, your hot biker Girlfriend heads out to the street.</p><p>It&rsquo;s something that would be really awesome, would you not have to hold on to your dear life every time she sees an opportunity to show off or go full speed. Nevertheless, you always reach your goal safely and Hannah says goodbye with a deep, passionate kiss before storing the helmet and driving back to her " + (isShopOpen(0) ?
		"workshop." : "apartment."))
}

function initialiseHannah() {
	addPerson("Hannah", 279);
	per.getPersonName = function(full) {
		if (full === true) return this.name;
		return this.isCharmedBy() ? "Slave Hannah" : "The Mechanic"
	};
	per.Replies = RepliesHannah;
	per.isPersonInfo = function() {
		return this.isCharmedBy()
	};
	per.getPersonInfo = function() {
		return "<img src='Images/hannah3s.jpg' style='width:35%;float:right;margin-left:5px' alt='Hannah'>" + "Hannah, the biker girl is yours to use any and all ways possible! It wasn\u2019t difficult to turn her to your side, you even went that far to let her keep this attitude of hers fully, thus she is still a rebel at heart. In contrast, she became so confidently loyal to you in a short period of time that she offered her chopper, her most precious thing to you use. She even pressed on becoming your personal driver who will take you anywhere on her bike (which now you own)! What is it if ain\u2019t love at first sight between you and her?<br><br>" + "Hannah is dressed as in her usual attire when you open the garage door to visit her and her little shop. Though she  is quickly out of her clothes and waits on your next orders. She leans back on a bike she\u2019s currently working on, so you can have a better view of her naked flesh."
	};
	per.getPersonAddress = function() {
		return this.isCharmedBy() ? "above the Mechanics Workshop, Glenvale Shopping Center" : ""
	};
	per.whereNow = function() {
		if (this.place != 279) return this.place;
		if (isShopOpen(0)) return this.place;
		return 237
	};
	per.addPlaceImageLeft = function(lit) {
		if (Place == 457 && this.isHere() && !isPersonHere("Camryn") && sType === "") return this.showPersonString("hannah16.jpg");
		return ""
	};
	per.isPlaceImageRight = function() {
		return (Place == 168 || Place == 457 && wherePerson("Camryn") == 457 && !isCharmedBy("Camryn")) &&
			this.isHere() || Place == 172 && this.place == 168
	};
	per.showPlaceImageRight = function(md) {
		this.showPerson("hannah-pface.jpg", undefined, undefined, undefined, undefined, undefined, md)
	};
	per.showEventPopup = function() {
		if (sType !== "") return false;
		if (Place == 279 && !this.checkFlag(1)) {
			this.setFlag(1);
			showPopupWindow("Hannah the Mechanic", "<img src='Images/hannah0.jpg' class='imgpopup' alt='Hannah'>" + "The workshop is owned by a charming brunette girl named Hannah. She is the striking example of a biker girl. Wild, badass and digs bikes.<br><br>" +
				"Just by looking at her you know you need to have her! The black biker gang jacket she\u2019s almost wearing shows the strongest part of her body; her tits. She is way too cool to even wear a bra, or that what is she is thinking. She is busy fixing a bike and doesn\u2019t notice you at first.<br><br>A badass biker chick " + (isSpellKnown("Charm") ? "sure won\u2019t be an easy prey and the place is public also." : "is not usually your type but you could make an exception for her!"));
			return true
		}
		if ((Place ==
				237 || Place == 279) && !isMurderPath() && this.isHere() && wherePerson("Camryn") == 457 && !this.checkFlag(17)) {
			this.setFlag(17);
			showPopupWindow("Riding with Hannah", "\u201c" + perYou.getPersonName() + "! I'm glad you're here.\u201d Hannah is in a very good mood as you enter the workshop and she quickly cleans some oil from her hands and takes off her jacket to greet you. \u201cI have something for you, catch.\u201d She throws you a motorcycle helmet.</p>" + "<p>\u201cThe Police returned my bike, Camryn's back  home safe as well, and it's all thanks to you.\u201d She beams. \u201dSo, I've bought a set of safety gear for you and, as promised, will be your personal driver and take you wherever you want to go from now on. Well, almost.\u201d</p>" +
				"<p>You are curious if she will let you drive, and she shakes her head.</p>" + "<p>\u201cI know you never sat on one of these, and you can not mess with my head enough to make this seem like a good idea, " + perYou.getMaster() + ".\u201d She grins. \u201cI'll happily give you driving lessons, but until you know what you are doing you'll have to settle for the bitch seat.\u201d</p>" + "<p>\u201cBitch seat?\u201d You tilt your head to the side and Hannah smiles innocently.</p>" + "<p>\u201cI did not invent the terminology, " +
				perYou.getMaster() + ". Now come on, try it on.\u201d");
			return true
		}
		if (Place == 457 && !this.checkFlag(8)) {
			this.setFlag(8);
			showPopupWindow("Hannah", "<img src='Images/hannah16.jpg' class='imgpopup' alt='Hannah'>" + "\"Hannah almost drags you inside as you arrive on Camryn's floor and gives you a strong hug.</p>" + "<p>\u201cThank you for coming, I was really at my wits end and...\u201c She stops talking as she realizes she has been fondling your butt-cheeks and pulls herself away.</p>" + "<p>\u201cSorry, your presence makes it hard to concentrate on anything but sex, which is usually great but can become irritating, do you think we could...\u201d</p>" +
				"<p>You tell Hannah to focus and explain what's wrong, and the order seems to actually help her do just that.</p>" + '<p>"Right, sorry. Short version: my sisters scumbag of a boyfriend has stolen my bike, and her. They have been gone for over a day, and I have no idea where they are."');
			return true
		}
		return false
	};
	per.showEvent = function() {
		var md;
		var bMoniqueWaiting;
		if (Place != 457 && this.place == 457)
			if (wherePerson("Camryn") == 457) this.place = 279;
		if (Place == 269 && sType == "hannahpool") {
			WaitHereOnly(6);
			md = WritePlaceHeader();
			this.showPerson("hannah-pool.jpg");
			addPlaceTitle(md, "Swimming with Hannah");
			md.write("<p>Hannah arrives, dressed in a gold bikini, and she suggest you sit in the hot-tub to have a chat.</p>");
			startQuestions();
			addLinkToPlaceC(md, "it is fairly private here...", Place, "type=hannahpoolsex");
			addLinkToPlaceC(md, "say goodbye to Hannah", Place);
			WritePlaceFooter(md);
			return true
		}
		if (Place == 269 && sType == "hannahpoolsex") {
			md = WritePlaceHeader(false, "td-left-med");
			this.showPerson("hannah-pool-sex.jpg");
			addPlaceTitle(md,
				"Being Discrete and Private with Hannah");
			md.write("<p>The hot-tub is quite private, so you suggest to Hannah they you can play in another way, and she seductively removes all of her swimsuit and leans against the side of the tub waiting for you to take her.</p>");
			startQuestions();
			addLinkToPlaceC(md, "later...say goodbye to Hannah", Place);
			WritePlaceFooter(md);
			return true
		}
		if (Place == 237) {
			if (sType == "iwantyou") {
				bMoniqueWaiting = wherePerson("Monique") == Place;
				md = WritePlaceHeader();
				this.showPerson("hannah12.jpg");
				addPlaceTitle(md, "I Want You");
				md.write("<p>Hannah looks gorgeous, and you are not in the mood for long small-talk or even to waste time heading to her room, so you simply tell her to strip and bend over the stairs while you begin to undress yourself.</p>" + "<p>\u201cImpatient again, " + perYou.getMaster() + "?\u201d Hannah grins and turns around while casually throwing her top away and removing her Pants. She is not wearing any underwear, which speeds things up, so you waste no time to drive your fingers over her already wet folds" +
					(!perYou.isMaleSex() ? ", attach your trusty strap on" : "") + " and push into her waiting mound.</p>" + "<p>Hannah moans lewdly, pressing her cheek against the stairs and eagerly grinding her hip against your crotch. \u201cHrrrnnnyesss... Fuck me hard, " + (perYou.isMaleSex() ? "boy" : "girl") + "!\u201d</p>" + "<p>\u201cWhat was that, slave?\u201d You place a rough slap on Hannah's rear and take a hold of her hair. She purrs in delight.</p>" + "<p>\u201cSorry, " + perYou.getMaster() + "! Please fuck your slave hard!\u201d There is something undeniably mischievous in her voice. \u201cSpank her more and show her her place!\u201d</p>" +
					"<p>You chuckle softly at her non-attempt at acting, but it's okay to be played when you know you are... and when you are the one with the charm-spell to begin with, so you play her little game and place another slap on her rear. \u201cOh, I will.\u201d You lean forward and whisper to your pet, telling her that she is yours to use as you please and better remember it while you take her with fast, firm strokes to sate both your own and her fantasy.</p>" + "<p>In the end, you both collapse exhausted after she reaches a powerful climax. You probably are going to feel the results of this workout in the morning, but it was worth it.</p>");
				if ((nTime % 288 + 1) / 12 == 8) md.write("<p>\u201cMonique had returned home at one point during your session, you noticed her almost shining red face as she climbed over the two of  you and headed to her room, probably masturbating furiously after what she had witnessed.</p>");
				else if (bMoniqueWaiting) md.write("<p>\u201cYou think you've seen Monique in the doorway at one point, sheepishly watching you and maybe even doing more, but apparently not having dared to ask to join in.\u201d</p>");
				startQuestions();
				addLinkToPlace(md, "talk more to Hannah", 237);
				WritePlaceFooter(md);
				return true
			}
			if (sType == "service") {
				bMoniqueWaiting = wherePerson("Monique") == Place;
				md = WritePlaceHeader(false, perYou.isMaleSex() ? "td-left-med" : "");
				this.showPerson(perYou.isMaleSex() ? "moniquehannah1.jpg" : "moniquehannah2.jpg");
				addPlaceTitle(md, "Servicing Your Ride");
				if (perYou.isMaleSex()) md.write("<p>You lazily stretch out on Monique's bed and on your order, both women make a bit of a show undressing each other in front of it, and Hannah especially enjoys teasing the still slightly nervous Monique while removing her clothes, giving her breasts a squeeze from behind or pulling her slip between her folds before simply pushing her onto the bed next to you.</p>" +
					"<p>The three of you trade kisses, and it doesn't take the pair long until your manhood is standing firmly at attention and you order Monique to straddle your face, while Hannah is the first to ride your cock.</p>" + "<p>Both women eagerly follow their orders, getting into position to ride you and soon filling the room with lustful moans. Hannah wild and passionate, making sure to savor every little motion, while Monique moans cutely every time your tongue flick over her dripping folds and clit and as their lust increases, so seems their affection for each other, the two best friends turned slavesisters starting to kiss passionately and eagerly as their mutual climaxes build up, until they both, with a little help from you, reach their peak simultaneously.</p>");
				else md.write("<p>You announce that you need to take a shower and it seems by now you don't even need to issue any orders for the pair to line up and offer their assistance in whatever way you might need it.</p>" + "<p>Within a few moments, the two have you undressed, gotten rid of their own clothes, prepared the shower for you and are beaconing for you to join in.</p>" + "<p>You enjoy the attentions of the pair immensely, Monique is still rather reserved, but with Hannah around to push her a little, you get to see a wilder side you didn't expect the librarian to have in her as her lips and fingers explore your body.</p>" +
					"<p>Hannah, on her end, seems eager to experiment with her newfound love for \u201clesbian lovemaking\u201d as she puts it, squeezing your breasts and teasing your sex with her tongue, fingers and the water stream from the shower alike. She may lack experience with women, but is a fast learner, quickly driving you to the first of what shall soon be several orgasms this evening.</p>");
				startQuestions();
				addLinkToPlace(md, "talk more to Hannah", 237);
				WritePlaceFooter(md);
				return true
			}
		}
		if (Place == 284 && sType ==
			"catcharide") {
			md = WritePlaceHeader();
			this.showPersonRorX(perYou.isMaleSex() ? "hannah10b.jpg" : "hannah10g.jpg");
			addPlaceTitle(md, "Catch A Ride With Hannah");
			if (perYou.isMaleSex()) md.write("<p>You pull Hannah into your lap and she immediately kisses you deeply, her naked body rubbing against your own and wasting no time taking off whatever clothes you may still be wearing, even without being ordered to do so.</p>" + "<p>\u201cYou have no idea how much I want you to fuck me, master...\u201d She breathes out in a haughty whisper, her body trembling in anticipation. \u201cStill not sure how you did it... but you are the best ride I ever had.\u201d</p>" +
				"<p>You jokingly tell your pet that you are just a natural before you order her to turn and straddle your lap, and after she complied, pull her closer against your chest and rub the tip of your manhood against her folds.</p>" + "<p>\u201cHmmmm... yes... just like this....\u201d Hannah gasps and eagerly pushes her body down to impale herself on your cock, rolling her hip forward a few times and quickly picking up the pace.</p>" + "<p>You give her breasts a good squeeze, trailing your fingers over her bare skin and finally wrap your arms firmly around her body to pull her close, one hand gently on her neck, the other resting on her clit to stimulate her further, luring a loud groan of pleasure from her lips.</p>" +
				"<p>It doesn't take long for her to reach her peak that way, and she almost screams out her lust into the room as it finally happens, collapsing happily in your lap and turning her head just enough to give you a gentle kiss.</p>");
			else md.write("<p>You are not even fully seated yet as Hannah just grabs you, presses your back against the couch and comes to rest on top of you, muffling any form of potential protest with a deep, passionate kiss.</p>" + "<p>\u201cWow...\u201d You have to take a breather when she finally withdraws and begins to nibble on your neck and shoulder. \u201cSo eager, my pet?\u201d</p>" +
				"<p>\u201cI can't help myself, oh my mistress.\u201d Hannah answers with a grin while she takes your top off and her fingers begin to trail around your nipples. \u201cYou are like a.... grand Buffet of treats I never even dreamed of trying without knowing how good they taste.\u201d</p>" + "<p>\u201cWell,\u201d You laugh. \u201dFeel free to indulge.</p>" + "<p>\u201cYes Mistress!\u201d</p>" + "<p>She playfully massages your breasts, occasionally flicking her tongue over your nipples and teasingly biting you before slowly making her way down, placing a kiss above your bellybutton and  taking off the rest of your clothes and underwear before drawing her tongue all the way over your folds and flicking over your clit.</p>" +
				"<p>You give her an approving moan and grab her hair to roughly push her face against your mound briefly, but pull her toward you before she is able to continue.</p>" + "<p>\u201cWe do this all the time in the workshop, here I want something else.\u201d You spin her around and rest on top of her body, giving her hair another pull to make her expose her neck to your lips as you begin to grind your clit and pussy against hers.</p>" + "<p>Hannah seems confused at first, then curious, and finally enthusiastic as she realizes what you are doing. Soft moans escape her lips while your body rocks back and forth, your fingers caressing her skin and your lips covering her body with kisses until she begins to tremble below you, stretching out her arms and allowing you to fully take charge and drive her to her climax.</p>" +
				"<p>\u201cThat was new...\u201d She whispers as you come to rest on top of her.</p>" + "<p>\u201cYou like it?\u201d</p>" + "<p>\u201cI loved it! It's great to have someone press their tits against mine while they fuck me, Mistress.\u201d She grins to you and presses a kiss to your lips.</p>");
			startQuestions();
			addLinkToPlace(md, "talk more to Hannah", 284);
			addLinkToPlace(md, "leave Hannah's room", 237);
			addLinkToPlace(md, "leave the apartment", 194);
			WritePlaceFooter(md);
			return true
		}
		if (Place == 161) {
			var perJessica =
				findPerson("Jessica");
			if (sType == "cutting") {
				md = WritePlaceHeader();
				this.showPerson(this.isCharmedBy() ? "hannah8b.jpg" : "hannah8a.jpg");
				addPlaceTitle(md, "Hannah freeing Jessica");
				md.write("<p>Hannah packs some tools and a cutting torch and loads then into a small pickup truck. She regretfully mentions being unable to fit them on her Harley.</p>");
				if (this.isCharmedBy()) md.write("<p>A short drive and you arrive at the Hotel. Hannah notices a truck and says it belongs to a friend of hers and asks if she can visit her friend after the job. You see no reason to refuse and give your slave permission.</p>" +
					'<p>You lead her into the cellar, and Hannah looks at you with a smile when she sees Jessica, "So more a rigging failure then, or is she a slave of yours?". She checks over the chains and binding of Jessica. and tells you,</p>' + '<p>"How did this happen? There are no joins in the cuffs or the gag. I do not see how you could have got these on her ' + perYou.getMaster() + ", but I do hear the barmaid upstairs is quite experienced with this sort of thing.<br><br>" + 'Ok, I can cut the chains and cuffs and remove the gag no problems just a few quick cuts. I can also loosen then a little so they can be removed so your slave here will be more accessible. That will be a little harder."');
				else {
					md.write("<p>A short drive and you arrive at the Hotel. Hannah notices a truck and says it belongs to a friend of hers and that she plans to look them up after the job.</p>" + '<p>You lead her into the cellar, and Hannah looks at you with a smile when she sees Jessica, "So more a rigging failure then". She checks over the chains and binding of Jessica. and tells you,</p>' + '<p>"How did this happen? There are no joins in the cuffs or the gag. I do not see how you could have got these on her....Well it is none of my business, but I do hear the barmaid upstairs is quite experienced with this sort of thing. Not my thing!<br><br>' +
						"Ok, I can cut the chains and cuffs and remove the gag no problems just a few quick cuts, costing " + sCurrency + "10. I can also loosen then a little so they can be removed, and reapplied later for more games. That will be a little harder, and cost " + sCurrency + '50."');
					if (nMoney < 10) md.write("<p>Unfortunately you do not have enough money for either of these choices.</p>")
				}
				md.write("<p>You are tempted by the idea of just loosening the bindings, then you can comfortably have your own personal witch-toy. Then again if you free her you are sure Jessica will be very <i>grateful</i>.</p>");
				startQuestions();
				if (this.isCharmedBy()) {
					addLinkToPlace(md, "cut the bindings", 161, "type=cut2");
					addLinkToPlaceO(md, "loosen them, but leave them on her", 161, "type=cut1")
				} else if (nMoney >= 10) {
					addLinkToPlace(md, "cut the bindings", 161, "type=cut2");
					if (nMoney >= 50) addLinkToPlace(md, "loosen them, but leave them on her", 161, "type=cut1");
					else addTextForQuestions(md, "You do not have enough money to loosen the chains", "center")
				}
				addLinkToPlaceC(md, '"Not now Hannah"', 124, "", "Hannah tells you she will return to her workshop after a quick drink with her friend");
				AddPeopleColumnMed();
				perJessica.showPersonRandom("jessica2c", 6, "100%", "", "", "Bound Witch");
				WritePlaceFooter(md);
				return true
			} else if (sType == "cut1" || sType == "cut2") {
				var bWitchSlave = false;
				md = WritePlaceHeader();
				if (sType == "cut1") {
					bWitchSlave = true;
					if (!this.isCharmedBy()) AddCash(-50);
					perJessica.setRivalry(-1);
					this.showPerson(this.isCharmedBy() ? "hannah8b.jpg" : "hannah8a.jpg");
					addPlaceTitle(md, "Enslaving Jessica");
					if (this.isCharmedBy()) md.write('<p>You order Hannah to loosen the bindings of Jessica so they can be removed without cutting, but to leave them on Jessica. Hannah looks at you curiously and then tells Jessica "You will love being ' +
						perYou.getMaster() + "'s slave\"</p>" + '<p>With this she cuts, trims and adjusts the bindings and looks at you and Jessica, "Done! You can play with her as much as you like ' + perYou.getMaster() + '". With your permission Hannah leaves the cellar to visit her friend for a drink.</p>' + '<p>Jessica looks at you angrily as she realises you have betrayed her, and you firmly tell her "I have a new, beautiful and powerless witch-toy!"</p>');
					else md.write("<p>You ask Hannah to loosen the binding of Jessica so they can be removed without cutting, but to leave them on Jessica. Hannah looks at you curiously and then asks Jessica if this is alright. Jessica is still gagged so cannot directly answer but vigorously shaked her head. Hannah looks at you sternly,</p>" +
						"<p>\"There are games, and then there are things that are too serious for me. Look I'll do it, but I'll tell Bambi the barmaid to check in and if things are not good and consensual she will call the police, right!\"</p>" + '<p>Yet with this she cuts, trims and adjusts the bindings and looks at you and Jessica, "That is it, I want nothing more of this, I am out of here!"</p>' + '<p>Jessica looks at you angrily, and you quickly tell her "I will return to play with my new witch-toy later"</p>' + "<p>You can still just see Hannah and could attempt a spell if you wanted.</p>")
				} else if (sType ==
					"cut2") {
					perJessica.setRivalry(3);
					perJessica.place = 1E3;
					if (!this.isCharmedBy()) AddCash(-10);
					this.showPerson(this.isCharmedBy() ? "hannah8b.jpg" : "hannah8a.jpg");
					addPlaceTitle(md, "Jessica Freed");
					var myLord = perJessica.getYourNameFor();
					if (this.isCharmedBy()) md.write("<p>You order Hannah to completely free Jessica. It is a very quick process and less than 5 minutes later, Jessica is completely free of her bindings. While Hannah is cutting you quickly borrow from the barmaid some clothing for Jessica</p>" +
						'<p>Hannah packs to leave as Jessica dressed and tells you "Pease return to me ' + perYou.getMaster() + '" and leaves.</p>' + '<p>Jessica says, "Thank you ' + myLord + " I am grateful you freed me, those bindings completely blocked all my abilities, I was completely powerless. " + myLord + " I see that woman is one of your servants, so she is no danger to us. I need to find a place of safety as well, we should leave here and I will find you soon " + myLord + "</p>" + "<p>You can see she wants to get out of here as soon as she can and almost runs out of the cellar.</p>");
					else md.write("<p>You ask Hannah to completely free Jessica. It is a very quick process and less than 5 minutes later, Jessica is completely free of her bindings. While Hannah is cutting you quickly borrow from the barmaid some clothing for Jessica</p>" + '<p>Hannah packs to leave as Jessica dressed and tells you "Take care with your games in future" and leaves.</p>' + '<p>Jessica says, "Thank you ' + myLord + " I am grateful you freed me, those bindings completely blocked all my abilities, I was completely powerless. " +
						myLord + " did you intend to do anything about the woman just here, she knows about me and may spread rumours? I need to find a place of safety as well, we should leave here and I will find you soon " + myLord + "</p>" + "<p>You can see she wants to get out of here as soon as she can and almost runs out of the cellar. You can still just see Hannah and could attempt a spell if you wanted.</p>")
				}
				startQuestions();
				addLinkToPlace(md, "look around the cellar more", 161);
				addLinkToPlace(md, "go back up to the hotel bar",
					124);
				AddPeopleColumnLarge();
				if (perJessica.isHere() || sType == "cut2")
					if (bWitchSlave) perJessica.showPersonRandom("jessica3", 2, "100%", "", "", "Witch-Toy");
					else if (sType == "cut2") perJessica.showPerson("jessica2d.jpg", "100%", "", "", "Freed Witch");
				else perJessica.showPersonRandom("jessica2c", 6, "100%", "", "", "Bound Witch");
				WritePlaceFooter(md);
				return true
			}
		}
		if (Place != 279 && Place != 161) return false;
		if (sType == "charmhannah1") {
			bMoniqueWaiting = wherePerson("Monique") == Place;
			md = WritePlaceHeader();
			this.showPerson(Place ==
				161 ? "hannah2c.jpg" : "hannah2s.jpg");
			addPlaceTitle(md, "Hannah Under a Charm Spell");
			if (Place == 161) md.write("<p>You catch up with Hannah outside in the parking lot near some trucks, and fortunately the vehicles are empty and block the view of the Hotel, creating a private place for now. You recite the spell and watch her.</p>" + "<p>Hannah stops in her tracks as you begin to guide the strains of mana into her body, and after a few seconds of trying to adjust to the new sensations flooding her, she spots you, her cheeks flushing with a deep red.</p>" +
				'<p>"What is... you just did something... did you?"</p>' + "<p>You smile as her eyes focus on you and you recognize the familiar pink sheen starting to form. Her breathing slowly increases in pace as the spell begins to work through her body, leaving her barely able to stop her hands from pushing up her shirt.</p>");
			else if (bMoniqueWaiting) md.write("<p>\u201cThis spell is weird, " + perYou.getMaster() + "...\u201d Monique muses as while she examines the runes on the stone.\u201d It supposedly is called \u201cNeo One\u201d which most likely means \u201cshielded\u201d, but it feels like the base of pretty much everything it builds up on is missing...\u201d</p>" +
				"<p>\u201cMaybe it builds up on... another spell?\u201d You ask, and after a second of thinking, Monique's eyes brighten up.</p>" + "<p>\u201cOf course! You are a genius, " + perYou.getMaster() + ".\u201d Monique flips a few pages in the book, makes a few notes, and finally explains to you. \u201cThis is not a spell itself, but an addition to the Dai Chu, to create a zone around the target that will make everyone around loose interest in what is happening to it during the charm!\u201d</p>" + "<p>Monique seems exited and you can tell why, with a spell like this, you could charm people in public spaces, and it seems easy enough for someone who has as much practice with the basic charm as you to cast.</p>" +
				"<p>You look outside to the people passing by the workshop... and then to Monique's friend, who is completely focused on her bike. A wicked smile forms on your lips as you begin to focus your mana and cast the new incantation, directing it towards the pretty mechanic.</p>");
			else md.write('<p>"A Daitchu? You might want to elaborate on that.... re....quest..."</p>' + "<p>Hannah's voice trails off as you begin to guide the strains of mana into her body, and after a few seconds of trying to adjust to the new sensations flooding her, her cheeks flush with a deep red.</p>" +
				'<p>"What is... you just did something... did you?"</p>' + "<p>You smile as her eyes focus on you and you recognize the familiar pink sheen starting to form. Her breathing slowly increases in pace as the spell begins to work through her body and her fingers begin to subconsciously play with her jackets zipper.</p>");
			startQuestions();
			addLinkToPlaceC(md, Place == 161 ? "tell her to continue" : bMoniqueWaiting ? "watch what happens" : "tell her to pull down the zipper", Place, "type=charmhannah2");
			WritePlaceFooter(md);
			return true
		} else if (sType == "charmhannah2") {
			bMoniqueWaiting = wherePerson("Monique") == Place;
			md = WritePlaceHeader();
			this.showPerson(Place == 161 ? "hannah3c.jpg" : "hannah3s.jpg");
			addPlaceTitle(md, "Hannah Under a Charm Spell");
			if (Place == 161) md.write("<p>She looks down in amazement as she finds herself following your order without hesitation, quickly taking off her shirt and throwing it to the side.</p>" + "<p>\u201cHow are you... doing.... ohhhh...</p>" + "<p>You watch in delight as her body is taken by another wave of blissful pleasure, her head rolling back with a long, drawn out moan while she squeezes her breasts and begins to caress her upper body.</p>" +
				"<p>\u201cSo... fucking... horny...\u201d She breathes the words out and glares at you intently, her hands starting to push down her Jeans while she moves to give you a good view of her backside.</p>" + "<p>\u201cI... I suddenly want to drag you back into Bambi's Cellar and just ravage you... wait...\u201d The glow in her eyes briefly flares up as another lustful shudder washes through her. \u201cI want you to drag me back into that cellar and ravage me...\u201d her eyes widen as the realization sets in.</p>" +
				"<p>\u201cYou are trying to turn me into some sort of sexslave!\u201d</p>");
			else if (bMoniqueWaiting) md.write("<p>Hannah gasps softly and looks around for a moment, her head rolling to the side as she catches you and Monique looking at her. She doesn't seem to notice her fingers moving to her Jackets zipper.</p>" + "<p>\u201cOh, you are testing it on Hannah!\u201d Monique exclaims giddily, and quickly covers her lips, watching in fascination as the Mechanics eyes begin to show the first traces of the familiar pink glow.</p>" +
				"<p>\u201cTesting what, Monique?\u201d Hannah pulls down the zipper of her Jacket and it does not look like she even realizes it, though her body language clearly shows her rising arousal.</p>" + "<p>\u201cOh, you'll see! It'll feel amazing.\u201d Monique quickly moves behind you and takes a submissive kneeling position, her cheeks slightly flushed, and she bites her lower lip as Hannah's  body is taken by a wave of blissful pleasure, the mechanics head rolling back with a long, drawn out moan as she squeezes her breasts and begins to caress her upper body.</p>" +
				"<p>\u201cWhy... am I so... fucking... horny...\u201d Hannah breathes the words out and glares at you intently, her hands starting to open her Jeans before twitching to the side and clinging to the seat of her bike. \u201cWhat have you two done to me?\u201d</p>" + "<p>\u201cWhat do you think I did to you, Hannah?\u201d You possessively drive a hand through Monique's hair and caress her cheek.</p>" + "<p>\u201cI...\u201d Hannah looks stunned. \u201cI think I suddenly want to throw you to the floor and just ravage you... no, wait...\u201d The glow in her eyes briefly flares up as another lustful shudder washes through her. \u201cI want you to throw me to the floor and ravage me...\u201d her eyes focus on the kneeling Monique and widen as the realization sets in.</p>" +
				"<p>\u201cYou have turned Monique into some sort of sexslave and now you're trying the same with me!\u201d</p>");
			else md.write("<p>She looks down in amazement as she finds herself following your order without hesitation, the sides of her jacket falling back to reveal her bare breasts underneath.</p>" + "<p>\u201cHow are you... doing.... ohhhh...</p>" + "<p>You watch in delight as her body is taken by another wave of blissful pleasure, her head rolling back with a long, drawn out moan while she squeezes her breasts and begins to caress her upper body.</p>" +
				"<p>\u201cSo... fucking... horny...\u201d She breathes the words out and glares at you intently, her hands starting to open her Jeans before twitching to the side and clinging to the seat of her bike.</p>" + "<p>\u201cI... I suddenly want to throw you to the floor and just ravage you... no, wait...\u201d The glow in her eyes briefly flares up as another lustful shudder washes through her. \u201cI want you to throw me to the floor and ravage me...\u201d her eyes widen as the realization sets in.</p>" +
				"<p>\u201cYou are trying to turn me into some sort of sexslave!\u201d</p>");
			startQuestions();
			addLinkToPlaceC(md, "confirm her theory", Place, "type=charmhannah3");
			WritePlaceFooter(md);
			return true
		} else if (sType == "charmhannah3") {
			bMoniqueWaiting = wherePerson("Monique") == Place;
			md = WritePlaceHeader();
			this.showPerson(Place == 161 ? "hannah4c.jpg" : "hannah4s.jpg");
			addPlaceTitle(md, "Hannah Under A Charm Spell");
			if (Place == 161) md.write("<p>\u201cI'm not \u201ctrying\u201d, Hannah.\u201d She shudders as you speak her name to reinforce the spells hold. \u201cTake off your pants.\u201d</p>" +
				"<p>You expect her to struggle against the spell after you confirm her suspicions, but if any, it only seems to make her calm down a little and regard you with a curious gaze while she follows your order and pulls down her pants with a slow, sensual motion.</p>" + "<p>\u201cYour slave...\u201d She speaks the words as if tasting them on her lips and faces you.</p>" + "<p>\u201cSounds fun, let's do this.\u201d</p>");
			else if (bMoniqueWaiting) md.write("<p>\u201cI'm not \u201ctrying\u201d, Hannah.\u201d She shudders as you speak her name to reinforce the spells hold. \u201cMonique, help her take off her pants.\u201d</p>" +
				"<p>You expect her to struggle against the spell after you confirm her suspicions, but if any, it only seems to make her calm down a little and regard Monique with a curious gaze as the librarian obediently pushes her back onto her bike and pulls down her pants.\u201d</p>" + "<p>\u201c" + (perYou.isBornMale() ? "His" : "Her") + " slave... huh?\u201d She speaks the words as if tasting them on her lips and rises to her feet, her last remains of willpower still struggling against your influence. \u201cKinky bitch...\u201d</p>" +
				"<p>\u201cYessss...\u201d Monique coos happily to Hannah, who now focuses on you.</p>" + "<p>\u201cAlright, sounds fun, let's do this.\u201d</p>");
			else md.write("<p>\u201cI'm not \u201ctrying\u201d, Hannah.\u201d She shudders as you speak her name to reinforce the spells hold. \u201cTake off your pants.\u201d</p>" + "<p>You expect her to struggle against the spell after you confirm her suspicions, but if any, it only seems to make her calm down a little and regard you with a curious gaze while she follows your order and pulls down her pants with a slow, sensual motion.</p>" +
				"<p>\u201cYour slave...\u201d She speaks the words as if tasting them on her lips and rises to her feet.</p>" + "<p>\u201cSounds fun, let's do this.\u201d</p>");
			startQuestions();
			addLinkToPlaceC(md, '"Just like that?"', Place, "type=charmhannah4");
			WritePlaceFooter(md);
			return true
		} else if (sType == "charmhannah4") {
			bMoniqueWaiting = wherePerson("Monique") == Place;
			this.setFlag(2);
			md = WritePlaceHeader();
			this.showPerson(Place == 161 ? "hannah5c.jpg" : "hannah5s.jpg");
			addPlaceTitle(md, "Hannah Under A Charm Spell");
			if (Place ==
				161) {
				md.write("<p>Well, it was not like you had intended for her to have a particular say in the matter, but her instant submission does come as a surprise to you, and Hannah seems to gain no small amount of pleasure out of having derailed you a little.</p>");
				if (perYou.isMaleSex()) md.write("\u201cWhatever you did is making me horny as hell and I'm suddenly unable to think about anything but how you might pin me against my bike and fuck me as roughly as you can. If you can do that by waving your fingers, I want to see what you can do with your cock.\"");
				else md.write("\u201cI have no idea what you did to me, but I've never been into girls and now believe you are the hottest bitch to ever come in here and unable to think of anything but how you might grab my hair and shove my lips against your pussy, and it's frankly driving me nuts.\u201d");
				md.write("</p><p>She leans against one of the trucks and looks over her shoulder with a hungry gaze.</p>" + "<p>\u201cSo... \u201c She goes on, her voice sultry, dripping with sex and need as the magic claims her mind fully.\u201d If you want a servant: Here I am. Claim me, fuck me, make me yours for as long as you like. I'll be whatever you need me to be... " +
					perYou.getMaster() + ".\u201d</p>" + "<p>She chuckles softly as the last word rolls of her lips, her eyes daring you to come closer, as does the way she teasingly wiggles her ass into your direction.</p>" + "<p>As you, however, follow up on her invitation, you feel a weird shiver running down your back.</p>" + "<p>You turn around and check the parking lot and driver seats again, but there is definitely no one around...</p>" + "<p>...and yet, you feel like someone is watching you...</p>" + "<p>Perhaps using magic this much is starting to draw attention to you, but before you are able to follow up on that feeling, you find that Hannah has apparently lost her patience and decided to just approach you herself.</p>" +
					"<p>She turns you around to face her, roughly presses you against one of the trucks and gives you a deep kiss, passionate enough to make you forget your worries and think about what is to come once you have her for yourself in private instead.</p>" + "<p>You tell her to head back to the workshop and await your visit and she eagerly obeys, promising to always be prepared to \u201cCheck your fluids\u201d and \u201cGive your chassis a proper stress-test\u201d.</p>" + "<p>As she drives off, the feeling of being watched is gone... and yet, you can't quite shake off the memory.</p>")
			} else if (bMoniqueWaiting) {
				md.write("<p>Well, it was not like you had intended for her to have a particular say in the matter, but her instant submission, even with Monique nearby, does come as a surprise to you, and Hannah seems to get no small amount of pleasure out of having derailed you a little.</p>");
				if (perYou.isMaleSex()) md.write("\u201cBoy, you've turned one of the most nervous girls I know into your slut and whatever you did to us is making me horny as hell. I'm suddenly unable to think about anything but how you might pin me against my bike and fuck me as roughly as you can. If you can do that by waving your fingers, I want to see what you can do with your cock.\"");
				else md.write("\u201cGirl, you've turned one of the most nervous girls I know into your slut and while I have no idea what you did to us, I've never been into girls and yet believe now that you are the hottest bitch to ever come in here. I'm unable to think of anything but how you might grab my hair and shove my lips against your pussy, and it's frankly driving me nuts.\u201d");
				md.write("</p><p>She rolls back her shoulders to let the leather Jacket fall down, taking a step forward and focusing on you with a hungry gaze.</p>" + "<p>\u201cSo... \u201c She goes on, her voice sultry, dripping with sex and need as the magic claims her mind fully.\u201d If you want a servant: Here I am. Claim me, fuck me, make me yours for as long as you like. I'll be whatever you need me to be... " + perYou.getMaster() + ".\u201d</p>" + "<p>She chuckles softly as the last word rolls of her lips, her eyes daring you to come closer while she pushes her hip to the side and slips both thumbs into her panties.</p>" +
					"<p>As you, however, follow up on her invitation, you feel a weird shiver running down your back.</p>" + "<p>You turn around and the only people you see are customers passing by the workshop, completely oblivious to what is happening inside thanks to the shield.</p>" + "<p>...and yet, you feel like someone is watching you...</p>" + "<p>Perhaps using magic this much is starting to draw attention to you, but before you are able to follow up on that feeling, you find that Hannah has apparently lost her patience and decided to just approach you herself.</p>" +
					"<p>She turns you around to face her and gives you a deep kiss, before almost dragging you and Monique to the back of the workshop, suggesting that the three of you commemorate her entry into your Harem properly.</p>")
			} else {
				md.write("<p>Well, it was not like you had intended for her to have a particular say in the matter, but her instant submission does come as a surprise to you, and Hannah seems to get no small amount of pleasure out of having derailed you a little.</p><p>");
				if (perYou.isMaleSex()) md.write("\u201cWhatever you did is making me horny as hell and I'm suddenly unable to think about anything but how you might pin me against my bike and fuck me as roughly as you can. If you can do that by waving your fingers, I want to see what you can do with your cock.");
				else md.write("\u201cI have no idea what you did to me, but I've never been into girls and now believe you are the hottest bitch to ever come in here and unable to think of anything but how you might grab my hair and shove my lips against your pussy, and it's frankly driving me nuts.\u201d");
				md.write("</p><p>She rolls back her shoulders to let the leather Jacket fall down, taking a step forward and focusing on you with a hungry gaze.</p>" + "<p>\u201cSo... \u201c She goes on, her voice sultry, dripping with sex and need as the magic claims her mind fully.\u201d If you want a servant: Here I am. Claim me, fuck me, make me yours for as long as you like. I'll be whatever you need me to be... " +
					perYou.getMaster() + ".\u201d</p>" + "<p>She chuckles softly as the last word rolls of her lips, her eyes daring you to come closer while she pushes her hip to the side and slips both thumbs into her panties.</p>" + "<p>As you, however, follow up on her invitation, you feel a weird shiver running down your back.</p>" + "<p>You turn around and the only people you see are customers passing by the workshop, completely oblivious to what is happening inside thanks to the shield.</p>" + "<p>...and yet, you feel like someone is watching you...</p>" +
					"<p>Perhaps using magic this much is starting to draw attention to you, but before you are able to follow up on that feeling, you find that Hannah has apparently lost her patience and decided to just approach you herself.</p>" + "<p>She turns you around to face her and gives you a deep kiss, before almost dragging you to the back of the workshop.</p>" + "<p>The two of you properly commemorate her entry into your Harem, and you soon forget about the strange feeling you had, but you can't quite shake of the memory afterwards.</p>")
			}
			startQuestions();
			if (Place == 161) addLinkToPlace(md, "check the cellar", 161);
			else {
				addLinkToPlaceC(md, "talk to Hannah some more", 279);
				addLinkToPlace(md, "exit the workshop", 194)
			}
			WritePlaceFooter(md);
			return true
		} else if (sType == "hannahcheck") {
			bMoniqueWaiting = wherePerson("Monique") == Place;
			md = WritePlaceHeader(false, isExplicit() && !perYou.isMaleSex() ? "td-left-large" : "");
			this.showPersonRorX(perYou.isMaleSex() ? isExplicit() ? "hannah7bb.jpg" : "hannah7b.jpg" : "hannah7g.jpg");
			addPlaceTitle(md, "Hannahs Checkup");
			if (perYou.isMaleSex()) md.write("<p>\u201cRight away, Master, I do pride myself in speedy service and quality work.\u201d</p>" +
				"<p>Hannah speaks with a wide grin as she moves behind you and presses both hands into your back.</p>" + "<p>\u201cI will need to perform a thorough check of your equipment, of course\u201d She explains as she pushes you towards a more secluded area of the workshop and knees down in front of you. \u201cI trust your other girls have been keeping the injector in good shape?\u201d</p>" + "<p>Hannah manages to keep up both her \u201ctalking to a customer\u201d voice and a straight face, all while opening your pants and getting ready to pull down your underwear, so you do your best to follow up, explaining to her that the \u201cinjector\u201d has seen a lot of use and might require some effort to get a good sample from.</p>" +
				"<p>\u201cPromises, promises...\u201d Hannah purrs playfully while she pulls your underwear down, her eyes almost mesmerized as they hungrily focus on your manhood.</p>" + "<p>It seems to take her some willpower to get back \u201cinto character\u201d, the pink glow flaring up briefly.</p>" + "<p>\u201cWell, a good cleaning will be needed master,\u201d She licks her upper lip for emphasis. \u201cCould you please hold my hair so it is out of the way?\u201d</p>" + "<p>\u201cLike this?\u201d You collect her hair in your fist.</p>" +
				"<p>\u201cHmmm... harder, please.\u201d She replies with a pleasant hum and begins to work on your growing erection, looking up to you mischievously while her tongue flicks over the tip and her fingers caress your shaft.</p>" + "<p>You chuckle softly and comply, roughly grabbing her hair and even pushing her face against your crotch. Hannah gives you a delightful purr and  she moves both hands behind her back, rolling her head to wrap her lips around your cock and, to your surprise, proceeding to take it in all the way to the base.</p>" +
				"<p>She stays like that for a few seconds and takes a long breather as she moves back, her tongue pressed against the underside of your tip and her eyes a little dazed as she looks up to you with a clear challenge in them, and you gladly follow up on it.</p>" + "<p>You tighten the hold on your servants hair and she moans in delight as you press her head against your crotch again, pushing your cock into her mouth and guiding her head up and down, using her lips, throat and tongue to satisfy your desires, and, if her approving moans are any indication, her own.</p>" +
				"<p>When you finally reach your peak, she eagerly takes in every drop, commenting playfully how your fluids are all in good condition, though pointing out that you should definitely come by for regular checkups.</p>" + "<p>You agree.</p>");
			else md.write("<p>\u201cRight away, Mistress, I do pride myself in speedy service and quality work.\u201d</p>" + "<p>Hannah speaks with a wide grin as she moves behind you and presses both hands into your back.</p>" + "<p>\u201cI'm not entirely familiar handling this type of chassis, but I have watched many educational instruction videos since you made me your dykeslave.</p>" +
				"<p>\u201cSo, you have been watching lesbian porn?\u201d</p>" + "<p>\u201cEducational. Instruction. Videos!\u201d She emphases every word. \u201cThis is my version of the story, and I will stick to it, Mistress.\u201d</p>" + "<p>Hannah pushes you towards a more secluded area of the workshop and eagerly begins to undress you. \u201cBesides, I have a pussy myself and I know how to play with it.\u201d She gives you a playful wink and slips onto her knees to take a teasing lick along your folds.</p>" + "<p>You rest on a workbench and place one leg on your slaves shoulder with a wry smirk, and while it's true that Hannah has little experience when it comes to being with another woman, she is still very eager and submits to your guidance quickly.</p>" +
				"<p>You grab her hair and pull her closer against your folds, guiding her to lick your clit and encouraging her to use her fingers more, and with a little help, she quickly brings you to orgasm.</p>" + "<p>\u201cYou're a fast learner, my pet.\u201d You say as you caress her hair. \u201cThough we will need to practice more.\u201d</p>" + "<p>\u201cAs you wish, my Mistress.\u201d She places a soft kiss to your clit and pulls back with a grin. \u201cNo one should say I'm not dedicated to good customer service.\u201d</p>");
			startQuestions();
			addLinkToPlaceC(md, "talk to Hannah some more", 279);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "service") {
			bMoniqueWaiting = wherePerson("Monique") == Place;
			md = WritePlaceHeader(false, perYou.isMaleSex() ? "td-left-med" : "");
			this.showPerson(perYou.isMaleSex() ? "moniquehannah1.jpg" : "moniquehannah2.jpg");
			addPlaceTitle(md, "Servicing Your Ride");
			if (perYou.isMaleSex()) md.write("<p>Hannah seems willing to pounce on you here and now, not really caring for and maybe even enjoying the possibility of being caught, but in the End, Monique convinces her that it is better to head back into the apartment.</p>" +
				"<p>\u201cYou're right, a ride like this deserves our full attention.\u201d Hannah leads you up some stairs into a small apartment and wastes little time ushering you into one of the bedrooms.</p>" + "<p>\u201cSoo, miss nervous bookworm.\u201d Hannah folds her arms underneath her ample bust and focuses on Monique. \u201cIt seems you have been able to gather extensive experience with this particular Model, any tips for the newly enslaved?\u201d</p>" + "<p>Monique blushes heavily, and it takes her a moment to respond. \u201cI'm... pretty sure this is not so different to your usual visitors.\u201d</p>" +
				"<p>\u201cIt is.\u201d Hannah laughs and motions for you to head to the bed. \u201cHe is the first to ask me for a threesome with you and actually get it.\u201d</p>" + "<p>\u201cMonique bites her lower lip and Hannah seems to enjoy having the last word in their little banter, celebrating her victory by pushing you on the bed and opening your belt. \u201cWell, let's see what you've been withholding from me.\u201d</p>" + "<p>Hannah finally takes off your pants while Monique moves behind you to help you with your top and pushes your body down against the bed, leaning forward to give your Shaft a good lick, and both women eagerly squeeze it between their lips and tongues.</p>" +
				"<p>\u201cWait!\u201d Hannah suddenly interrupts. \u201cI want to ride that dick before we make him cum.\u201d</p>" + "<p>There is a brief moment of silence until she seemingly realizes something, looking to you with Puppy dog eyes. \u201cUhm, please, master?\u201d</p>" + "<p>You chuckle softly, but see absolutely no harm in letting her do that (well, quite the opposite, really) ordering Monique to straddle you and position her pussy for you to lick and play with while Hannah enjoys her ride.</p>" + "<p>Both women eagerly follow their orders, getting into position to ride you and soon filling the room with lustful moans. Hannah wild and passionate, making sure to savor every little motion, while Monique moans cutely every time your tongue flick over her dripping folds and clit and as their lust increases, so seems their affection for each other, the two best friends turned slave-sisters starting to kiss passionately and eagerly as their mutual climaxes build up until they both, with a little help from you, reach their peak simultaneously.</p>");
			else md.write("<p>Hannah seems willing to pounce on you here and now, not really caring for and maybe even enjoying the possibility of being caught, but in the End, Monique convinces her that it is better to head back into the apartment.</p>" + "<p>\u201cWell, I guess the mistress must be feeling dirty now, I sure do.\u201d Hannah remarks with a wink to the visibly relieved Monique as she leads the two up some stairs into what is apparently their apartment and straight to the shower, most of her clothes dropping on the way.</p>" +
				"<p>You watch from the door frame as Monique finishes stripping out if the remainder of her clothes and is taken by surprise by Hannah, who suddenly pulls her close into a deep, long kiss.</p>" + "<p>\u201cSo this is what it feels like...\u201d Hannah muses to Monique, who just stares at her wide-eyed, her face taking a deep shade of red, struggling to find words.</p>" + "<p>\u201cI... think you broke her...\u201d you remark jokingly, and Hannah laughs. \u201cHey, it's her fault that I'm suddenly into girls now.\u201d</p>" +
				"<p>\u201cDidn't see you struggle against it much...\u201d Monique retorts, and Hannah has a hard time calming her laughter.</p>" + "<p>\u201cNo... I guess not...\u201d She pulls Monique lovingly into the shower and motions for you to join in as well, so they can \u201cGive your ride a thorough cleaning.\u201d</p>" + "<p>You enjoy the attentions of the pair immensely, Monique is still rather reserved, but with Hannah around to push her a little, you get to see a wilder side you didn't expect the Librarian to have in her as her lips and fingers explore your body.</p>" +
				"<p>Hannah, on her end, seems eager to experiment with her newfound love for \u201clesbian lovemaking\u201d as she puts it, squeezing your breasts and teasing your sex with her tongue, fingers and the water stream from the shower alike. She may lack experience, but is a fast learner, quickly driving you to the first of what shall soon be several orgasms this evening.</p>");
			startQuestions();
			addLinkToPlace(md, "talk more to Hannah", 237);
			WritePlaceFooter(md);
			return true
		}
		return false
	};
	per.showPersonChat =
		function(bGeneral, md) {
			if ((Place == 279 || Place == 237) && sType === "" && this.isHere()) {
				if (this.checkFlag(17)) addOptionLinkC(md, '"Take me somewhere on your bike"', "HannahBikeRide(false)");
				if (this.checkFlag(16)) addLinkToPlaceC(md, '"Let\'s Visit Camryn"', 457, "", "&quot;I&rsquo;d like to check up on her, too and should be able to squeeze some time into my schedule, let&rsquo;s go.&quot;&lt;/p&gt;&lt;p&gt;Hannah helps you put on the helmet and safety gear, and the two of you head to the Celeste road apartment to visit her sister.",
					"", "movePerson('Hannah',457)")
			}
			if (Place == 279 && sType === "" && this.isHere()) {
				if (this.isCharmedBy()) {
					addLinkToPlaceC(md, 'tell Hannah she can "Check your fluids" now', Place, "type=hannahcheck");
					if (wherePerson("Monique") == Place) addLinkToPlaceC(md, 'tell Monique and Hannah to "Service my ride"', Place, "type=service")
				}
				if (whereItem(29) == 279) addQuestionC(md, "ask Hannah to break the vase", "Hannah", 279);
				if (isRitualComplete() && getPersonOther("Jessica", 1) == 2) addLinkToPlaceC(md, '"Could you help me cut some chains"',
					161, "type=cutting")
			} else if (Place == 457 && this.isHere())
				if (!isPersonHere("Camryn")) {
					if (!this.checkFlag(9)) addQuestionR(md, "she never mentioned her sister", "\u201cYou never asked, and I often don't even remember that Monique is in the next room when we are together.\u201c Hannah smiles, her mind briefly trailing off before she quickly focuses again.</p>" + "<p>\"Her name is Camryn, she's my younger sister by two years, but we are not much alike.\u201c Hannah guides you into the living room and motions for you to sit down.</p>" +
						"<p>\u201cI was always quite rebellious, hung out with what many deemed the wrong people, disobeyed my parents and even dropped out of school, and she was kind of expected to make up for it.\u201d</p>" + "<p>You give an understanding nod and tell her to go on.</p>" + "<p>\u201cSo, Camryn was always polite, did what mom and dad told her, studied a lot, and now that she's out of school, she already has a stable, if boring, office job at a reputable company.\u201d", "Hannah", "setPersonFlag(\\'Hannah\\',9)");
					if (this.checkFlag(9) && !this.checkFlag(10)) addQuestionR(md, "ask about the boyfriend", "\u201cHe's an asshole.\u201d Hannah says flatly.</p>" + "<p>\u201cI've hung out with a lot of people who are considered a bad influence, but they were good people at the core, but he... he's arrogant, contemptuous, and likely involved in a lot of shady shit.\u201d She sighs.</p>" + "<p>\u201cI told Cam to ditch him, but she snapped at me, told me I was always allowed to make mistakes and live the life I wanted so I don't get to judge her for her decisions...\u201d",
						"Hannah", "setPersonFlag(\\'Hannah\\',10)");
					if (this.checkFlag(10) && !this.checkFlag(11)) addQuestionR(md, '"So, What exactly happened?"', '"Gary, no wait, Gil... Glenn... Scumbag said he wanted to talk it out with me, get to know each other over a drink to break the ice.\u201c</p>' + "<p>\u201cI figured he just wanted to get us drunk and take advantage of it, but also that I could just drink him under the table anyway and teach him a lesson, but I wasn't halfway through the first glass when I passed out and woke up hours later with my bike-keys and wallet missing.\u201d</p>" +
						"<p>You interject that he likely drugged her, and Hannah nods with a grim expression, her eyes suddenly very focused, as if barely affected by the spell.</p>" + "<p>\u201cCamryn was gone, too and left her smartphone here, so I had no way to contact her. I thought they were doing a Joyride and was ready to wait and give them a what for... but it's been over a day, and now I'm worried sick.", "Hannah", "setPersonFlag(\\'Hannah\\',11)");
					if (this.checkFlag(11) && !this.checkFlag(12)) {
						startAlternatives(md);
						addQuestionR(md,
							"ask what you can do to help", "\u201cYou are a " + perYou.getWitch(true) + ", right? I figured if anyone can find her fast enough it's you.\u201d</p>" + "<p>\u201cThere are a lot of personal items here, maybe you have a tracking spell, or a way to contact the Items owner.\u201d Hannah sounds hopeful.</p>" + "<p>\u201cI'll do anything for you if you manage to help me find her, be your bitch, your lover, your personal driver... okay I'll happily be all these things anyway, but with even more passion and enthusiasm!\u201d",
							"Hannah", "setPersonFlag(\\'Hannah\\',12)");
						addQuestionR(md, "ask what you'll get out of helping her", "\u201cYou'd not be a fucking ass...\u201d Hannah looks genuinely angry as she rises to her feet, and for a moment, it even looks like she is able to overcome the charm.</p>" + "<p>The glow in her eyes flares up and you see the struggle play out on her face before her mind is overpowered again, her eyes returning to normal, looking at you with adoration.</p>" + "<p>\u201cOf course I'll reward you, " + perYou.getMaster() +
							"! I'll be whatever you want me to be, Your driver, your personal slut, your lover.</p>" + "<p>You point out that she is all of this anyway if you want her to be, and once again, you see the anger flare up in her eyes, but she finally has an idea.</p>" + "<p>\u201cYou'll get Camryn!\u201d She rises to her feet and gets you a photo of a good-looking girl with dark hair. \u201cShe's inexperienced, but young and sexy, and if you get her back, she is naturally yours.\u201d", "Hannah", "setPersonFlag(\\'Hannah\\',12);setPersonFlag(\\'Hannah\\',13)");
						endAlternatives(md)
					}
					if (this.checkFlag(12) && !this.checkFlag(14)) addQuestionR(md, "tell her about the possession spell and agree to help", "You explain the possession spell to Hannah, how it works, and that you indeed need a personal item of hers, and Hannah leaves to get a small trinket.</p>" + "<p>\u201cJust be careful with her body, okay? We don't know where she will be and how Scumbag will react if she acts up.\u201d</p><p>" + (this.checkFlag(13) ? "\u201cShe'll make a good slave for you, but only if you bring her home safely, " +
						perYou.getMaster() + ".\u201d" : "\u201cOh, and thank you.\u201d She gives you a peck on the cheek. \u201cI'm glad to have met you, and I'm not only saying this because you control my mind... possibly.\u201d"), "Hannah", "setPersonFlag(\\'Hannah\\',14);PlaceI(63);");
					if (this.checkFlag(12) && !this.checkFlag(14) && !this.checkFlag(15)) addQuestionR(md, "tell her you'll consider it", "Hannah slumps down in defeat and buries her face in her hands. \u201cJust... don't consider too long, every day we wait puts her into more danger.\u201d",
						"Hannah", "setPersonFlag(\\'Hannah\\',15)")
				} else {
					if (sType === "") {
						addQuestionR(md, "send Hannah back to " + (isShopOpen(0) ? "the shop" : "her apartment"), "\u201cI... guess I do still have a lot of work to do, do I?\u201d Hannah sighs and looks at you longingly as she dresses herself.</p>" + "<p>\u201cTake good care of " + perYou.getHimHer() + ", Cam, and please visit me if you find the time, " + perYou.getMaster() + ".\u201d</p>" + "<p>The two of you share a kiss and Hannah hesitantly leaves the apartment, leaving you and Camryn alone. ",
							"Hannah", "movePerson(\\'Hannah\\',279)");
						addLinkToPlace(md, "ask Hannah to take you back to " + (isShopOpen(0) ? "the shop" : "her apartment"), isShopOpen(0) ? 279 : 237, "", "\u201cYou have to leave already?\u201d Camryn looks disappointed, but you assure her that you will be back to see her soon, and Hannah adds that she intents to take good care of you, which somewhat makes her feel better.</p>" + "<p>The two of you share a goodbye kiss before you leave the apartment with Hannah and she takes you back to the workshop.")
					}
				}
			else if (Place ==
				456 && this.checkFlag(14) && !checkPlaceFlag("CelesteRd", 3)) addQuestionRO(md, "pickup the stone", "You reach in and try to get the stone but just knock over the bin. The stone tumbles out as you right the bin.", "", "setPlaceFlag(\\'CelesteRd\\',3);" + (isConspiracyPath() ? "PlaceI(6)" : "PlaceI(5)"))
		};
	per.showPersonTextHere = function(md) {
		if (this.whereNow() == 279 && Place == 279 && wherePerson("Monique") != 279)
			if (!this.isCharmedBy()) md.write("<p>The place is very clean for a mechanics shop. Parts, tools and cars are reasonably well-kept and you walk through the office to the workshop without picking up any grease or dirt.</p>" +
				'<p>Hannah, the mechanic, turns to you with her "talking to the customer" smile.  "Can I help you with something?" she asks.</p>');
			else md.write("<p>Since the Hannah\u2019s enslavement, the mechanical shop belongs to you. It\u2019s a well-kept workshop that once was a garage. Though it is relatively clean, you always come here with a thought that you will need a change of clothes when you leave.</p>" + '<p>Hannah seems excited that you have returned. "How may this humble servant be of service, ' + perYou.getMaster() +
				'? Perhaps you would like me to... check your fluids?" she asks, a hint of mischief in her eyes. It is true that she a servant of yours, but that she would be humble? You don\u2019t think so\u2026 She can still be a nasty little animal, a part that she only brings out in bed.</p>');
		else if (this.whereNow() == 457 && Place == 457 && wherePerson("Camryn") == 457)
			if (isCharmedBy("Camryn")) md.write("<p>The two sisters embrace each other as you enter the apartment and share a long, sensual kiss, more for your benefit than theirs, before welcoming you in unison.</p>");
			else md.write("<p>Hannah looks at you expectantly with a knowing smile, but otherwise keeps quiet and waits for you to make the first move.</p>");
		else if (Place == 456 && this.checkFlag(14) && !checkPlaceFlag("Apartments", 3)) md.write("<p>You notice discarded in a waste-bin a familiar looking stone.</p>");
		else if (Place == 168 && this.isHere()) md.write("<p>Hannah is already here and speaking to " + getPoliceChief() + " Batton, who does her best to try to calm the agitated woman.</p>")
	};
	per.isPhoneable = function() {
		return this.checkFlag(17) ||
			checkPlaceFlag("Hotel", 11) && Place == 269 && this.isCharmedBy()
	};
	per.callThem = function() {
		if (Place == 269) {
			gotoPlace(Place, "type=hannahpool");
			receiveCall("", "You call Hannah to invite her to join you at the pool for a swim, and she happily agrees" + (isShopOpen(0) ? " business is slow, she will close the shop for a while." : "."));
			WriteCommentsFooter(bChat, bChatLeft)
		} else {
			WaitHereOnly(3);
			HannahBikeRide(true)
		}
	};
	per.addPersonPhoneCall = function() {
		if (this.hoursCharmed() > 12 && getHour() > 5 && !this.checkFlag(2)) {
			if (makeCall(true,
					180)) this.setFlag(2)
		} else if (this.hoursCharmed() > 12 && getHour() > 9 && !this.checkFlag(3)) {
			if (makeCall(true, 181)) this.setFlag(3)
		} else if (this.hoursCharmed() > 36 && getHour() > 17 && !this.checkFlag(5)) {
			if (makeCall(true, 190)) this.setFlag(5)
		} else if (this.hoursCharmed() > 72 && isDay() && !this.checkFlag(4)) {
			if (makeCall(true, 182)) this.setFlag(4)
		} else if (this.checkFlag(6) && !this.checkFlag(7)) {
			if (makeCall(false, "", "Your phone rings and Hannah's number is on the display. You take the call,<br><br>" + "<b>Hannah</b><br>" + '"' +
					perYou.getPersonName() + "? Oh, I'm so glad I've reached you.\u201c Hannah's voice sounds agitated at the other end of the line. \u201cI need help, ideally magical help. Do you know how to get to the apartment complex at Celeste Road?\u201c<br><br>" + "You know those rather well, cheap but usually clean apartments run by a local company. Your family would have likely moved there, had you not been able to keep your house on Kollam Street.<br><br>" + "The quickest way to reach Celeste rd is following Oakpine Road to the museum and turn right, and Hannah is glad you know the way so well.<br><br>" +
					"\"From the Museum on, It's the first large building along the road, just look for Camryn Gifford's apartment and I'll let you in.\u201c<br><br>" + "You ask what exactly happened, but Hannah tells you she doesn't want to talk about it on the phone, so you agree to make your way over to her.<br><br>" + "With that she hangs up.")) {
				this.setFlag(7);
				setPlaceKnown("CelesteRd");
				setPlaceKnown("CamrynsApartment");
				return true
			}
		} else if (wherePerson("Camryn") == 457 && !this.checkFlag(16))
			if (makeCall(true, 183)) this.setFlag(16);
		return false
	};
	per.getPersonSMS = function(id) {
		switch (id) {
			case 180:
				return receiveSMS("Tenacious Diva", "Monique told me you like to start the day with a pair of tits, so: Good morning, my sexy " + perYou.getMaster() + ".", "hannahsms1.jpg") + receiveSMS("Tenacious Diva", "PS: If you already happen to have a good pair of tits next to you, plz send Pics!");
			case 181:
				return receiveSMS("Tenacious Diva", "And some sexy ass to tug you in for the night. Naughty dreams from me and Monique (she is holding the phone camera) ;)",
					"hannahsms2.jpg");
			case 182:
				return receiveSMS("Tenacious Diva", "I've been looking through old pictures and wondering if you would like it if I cut my hair short again.", "hannahsms3.jpg") + replyToSMS("Keep it long, I like having more to hold onto.") + receiveSMS("Tenacious Diva", "Good answer, " + perYou.getMaster() + "! Now I'm having dirty thoughts again... Hoping to see you soon! :-*");
			case 183:
				return receiveSMS("Tenacious Diva", "Hey, your " + perYou.getMaster() + "ness. The police say Camryn is free to go and she should be home by now. I'll gladly drive you there, but also told her of your help and that you may want to check up on her, so she'll be expecting you if you want to spend some time with her alone first. ;)")
		}
		return ""
	}
}

function RepliesJade(nR) {
	var ret = true;
	var myName = perYou.getPersonName();
	if (nR == 666) {
		addComments('"' + myName + '  do not consort with demons, you have neither the skill or training. No matter how beautiful they may be, they seek to enslave and little else. While I can work out bargains with them the cost can be very high."</p>' + '<p>She hesitates, "The warlock Kurndorf dealt with them but he has not limited or compassion and would give any sacrifice for his deals"</p>' + "<p>You mention her calling for you,</p>" +
			'<p>"Those with magic, be they warlock, sorceror, witch or whatever name you wish, are a great prize for demons. Refuse any offer they make, there is little way for you to safely deal with them!"</p>');
		this.setFlag(6)
	} else if (nR == 667) {
		addComments('"' + myName + ", names are very important in the occult world. Names are power, true-names absolute power. Demons can tell you a part of their name, as a magical link. Never say the name, never use it when you cast a spell, if you do you give <i>them</i> power over you.</p>");
		this.setFlag(7)
	} else if (nR == 668) {
		addComments('"' + myName + ', there are ways but are very difficult and require rare insight into demons and how they possess people. I am not foolish enough to do deminoc possessions, unlike you". You try to argue that it was not you who did it, but she dismisses you and continues speaking over you,.</p>' + '<p>"You need someone who has had first hand experience or is an idiot who dabbles in demoonic possessions."</p>');
		this.setFlag(8)
	} else if (nR == 669)
		if (perYourBody.NoItems <
			perYourBody.MaxItems) {
			perYourBody.PutItem(5);
			this.setFlag(9);
			addComments("<p>She steps over and picks it up, she weighs it in her hand and tosses it to you,</p>" + '<p>"I know of these, they are useless to me, have it ' + myName + '"')
		} else addComments("You reconsider, you can barely carry the items you have now. You will ask her another time");
	return ret
}

function initialiseJade() {
	addPerson("Jade", 286, "Jade");
	per.Replies = RepliesJade;
	per.getYourNameFor = function() {
		return this.checkFlag(4) ? "<i>" + perYou.getMaster() + "</i> " + perYou.getPersonName() : perYou.getPersonName()
	};
	per.passTimeDay = function() {
		this.setFlag(3, false);
		return ""
	};
	per.showEvent = function() {
		var md;
		if (Place != 286) return false;
		if (sType == "askjade") {
			this.setFlag(1);
			this.setFlag(3);
			md = WritePlaceHeader(false, "td-left-med");
			this.showPerson("jade2.jpg");
			addPlaceTitle(md, "Meeting Jade");
			md.write('<p>You ask a few people about a woman named Jade and you are immediately corrected "Mistress Jade" and directed to a private room at the rear of the club</p>' +
				'<p>The room is outfit as a stylised dumgeon, a fantasy of BDSM and other gear. A woman is sitting on a chair, more sprawled than sitting, looking at you with a condescending expression. Dressed in shiny leather she scream "Dominatrix" to you, especially as you were told she is "Mistress Jade"! As you are thinking this she states bluntly,</p>' + '<p>"You touched a demon", you start at her accurate statement. She continues "A possession here in Glenvale, like the old days"</p>' + "<p>You are at least a little ashamed of what happened to Jesse, and hesitate before asking her if she is a demonologist as you had been told. She looks at you,</p>" +
				'<p>"You survived the encounter, you must have some power, or luck. I think power but it is difficult to say. Yes I am a demonologist, but I am not fool enough to summon a demon and allow it to possess someone!"</p>' + (checkPersonFlag("Seraphina", 2) ? '<p>You ask about Seraphina the thrall and she smiles, "One of the results of your foolishness. She was sent to me to try and corrupt me and this place. I have dealt with that plan, she is mine now."</p>' : "") + "<p>You start to explain it was someone else, though it was partly your fault, and she interrupts,<p>" +
				'<p>"You want my help, I can, but everything has a price. Domination is what matters to demons, and to me. Submit to me in at least a token, and pay a fee of money, ' + sCurrency + '50 and I will answer your questions."<p>' + '<p>You ask about the token submission, and she smiles, "Lick my boots". She looks at you appraisingly, "You are young, so if money is short I am sure there is another way you can serve me instead of the payment"</p>' + '<p>You ask what sort of payment and she answers, "' + (perYou.isBornMale() ?
					"My strap-on, your ass" : "Dance for me in the club") + '". You look surprised, that is not something that had ever crossed your mind!</p>');
			startQuestions();
			startAlternatives(md);
			addLinkToPlaceC(md, '"No way! I will not submit to you!"', Place, "type=nosubmit");
			if (nMoney > 49) addLinkToPlace(md, "pay the fee and lick her boots", Place, "type=payfeemoney");
			addLinkToPlace(md, "pay the other way and lick her boots", Place, "type=payfeeother");
			addLinkToPlace(md, "leave her for now", 282, "", "As you leave she tells you to not waste her time, and the door is locked behind you. Hopefully she will allow you back another time, maybe tomorrow?");
			endAlternatives(md);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "nosubmit") {
			md = WritePlaceHeader();
			this.showPerson("jade1.jpg");
			addPlaceTitle(md, "Meeting Jade");
			this.setFlag(4);
			md.write("<p>For looks at you with a mixture of anger and amusement,</p>" + '<p>"Someone so young to act like a ' + perYou.getMaster() + ' and you have done nothing to earn my respect", she looks at you and continues,</p>' + '<p>"I have to admire your attitude at least, all right, then ' + sCurrency + '200 and nothing else."</p>' + "<p>Well you have sort of negotiated just for a lot more money!" +
				(nMoney < 200 ? " Except you do not have it of course." : ""));
			startQuestions();
			startAlternatives(md);
			if (nMoney > 199) addLinkToPlace(md, "pay the fee", Place, "type=payfeemoneyonly");
			addLinkToPlace(md, "leave her for now", 282);
			endAlternatives(md);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "payfeemoneyonly") {
			md = WritePlaceHeader(false, "td-left-large");
			this.showPerson("jade2.jpg");
			addPlaceTitle(md, "Paying Jade");
			AddCash(-200);
			this.setFlag(5);
			md.write('<p>You hand over the money and she says "Our contract is complete, ask you questions or other requests"</p>');
			startQuestions();
			addLinkToPlace(md, "leave her for now", 282);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "payfeemoney") {
			md = WritePlaceHeader();
			this.showPerson("jade3.jpg");
			addPlaceTitle(md, "Paying Jade");
			AddCash(-50);
			this.setFlag(5);
			md.write("<p>You hand over the money and she stand and put her foot on a stool. You then see it is not really a stool, it is a crouched man, kneeling at the feet of his Mistress.</p>" + "<p>You hesitate, this is not something you have done before, but you quickly kneel down and give a tentative lick of her boot. As you do you feel the handle of her whip press into your back to tell you to keep doing it. You force yourself to continue until the handle is removed.</p>" +
				"<p>As you stand, she smiles \"A defiant one aren't you, an aspiring " + perYou.getMaster() + ' and not a submissive it seems. Our contract is complete, ask your questions or make your requests."</p>');
			startQuestions();
			addLinkToPlace(md, "leave her for now", 282);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "payfeeother") {
			md = WritePlaceHeader(false, perYou.isBornMale() ? "td-left-med" : "");
			if (perYou.isBornMale()) this.showPerson("jade5.jpg");
			else AddImage("Player/poledance1.jpg");
			addPlaceTitle(md, "Paying Jade");
			this.setFlag(5);
			md.write("<p>You hand over the money and she stand and put her foot on a stool. You then see it is not really a stool, it is a crouched man, kneeling at the feet of his Mistress.</p>" + "<p>You hesitate, this is not something you have done before, but you quickly kneel down and give a tentative lick of her boot. As you do you feel the handle of her whip press into your back to tell you to keep doing it. You force yourself to continue until the handle is removed.</p>" + "<p>As you stand, she smiles \"A Defiant one aren't you, an aspiring " +
				perYou.getMaster() + ' and not a submissive it seems. Now the rest"</p>');
			if (perYou.isBornMale()) md.write('<p>She smiles and just states, "Strip". You are having second thoughts about this and hesitate, and she swats her whip on your jean-clad ass. She smiles and repeats, "Strip"</p>' + "<p>You grit your teeth and decide you may as well go through with it, and strip, she has you lie down on your back and puts on her strap-on and lucricates it to your relief.<p>" + "<p><i>scene to follow</i></p>" + "<p>After she finishes, she allows you to redress and says,</p>" +
				'<p>"Our contract is complete, ask your questions or requests"</p>');
			else {
				AddCash(10);
				md.write("<p>She offers you a changing room but you initially refuse until she says that you are wearing too much to dane properly. You quickly strip off some clothing and head bac to her room, she stops you, and gestures toward the main area of the club. She meant for you to dance publically! Youstart to refuse but she stops you,</p>" + '<p>"You have come this far, show me your courage and your body", you suppose she is right, you might as well get this over with. You step out and Jade introduces you as "Everyone enjoy a new performer, the Witch ' +
					perYou.getPersonName() + '!" and there is a light applause.</p>' + "<p>While this is not something you have really done <b>much</b> of before, you did once play around with Tracy and she gave you a surprisigngly good lesson but it was a while ago. You start out a bit tentatively but quickly get used to it and actually start to enjoy it.<p>" + "<p>You finish, panting to some more applause and actually a few tips! Jade escorts you back to her room and tells you,</p>" + '<p>"Our contract is complete, ask your questions or requests"</p>')
			}
			startQuestions();
			addLinkToPlace(md, "leave her for now", 282);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "castcharm") {
			this.setFlag(2);
			this.setFlag(3);
			md = WritePlaceHeader();
			this.showPerson("jade1.jpg");
			addPlaceTitle(md, "Charming Jade");
			md.write("<p>You whisper the words of the charm spell, but Jade does not react except to smile,</p>" + '<p>"Domination and control is my expertise, that of people and demons. I know of that forbidden spell you just tried to use on me, and I am quite protected by a <b>contract</b>. You are a fool, you should control people of their own free will, it is so much more satisfying."</p>' +
				'<p>She steps over and slaps you and then prders you, "Get out"</p>' + "<p>You have no choice but to leave, hopefully she will calm down later.</p>");
			startQuestions();
			addLinkToPlace(md, "leave her for now", 282);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "payment") {
			this.setFlag(3);
			md = WritePlaceHeader(false, "td-left-med");
			this.showPerson("jade2.jpg");
			addPlaceTitle(md, "Meeting Jade");
			md.write("<p>You visit the room used by Mistress Jade again, she is sitting waiting for you.</p>" + '<p>She is blunt, "My price is unchanged, ' +
				(this.checkFlag(4) ? sCurrency + "200" : sCurrently + "50, and lick my boots or the other way") + "</p>");
			startQuestions();
			startAlternatives(md);
			if (this.checkFlag(4)) {
				if (nMoney > 199) addLinkToPlace(md, "pay the fee", Place, "type=payfeemoneyonly")
			} else {
				if (nMoney > 49) addLinkToPlace(md, "pay the fee and lick her boots", Place, "type=payfeemoney");
				addLinkToPlace(md, "pay the other way and lick her boots", Place, "type=payfeeother")
			}
			addLinkToPlace(md, "leave her for now", 282, "", "As you leave she tells you to not waste her time, and the door is locked behind you. Hopefully she will allow you back another time, maybe tomorrow?");
			endAlternatives(md);
			WritePlaceFooter(md);
			return true
		}
		return false
	};
	per.showPersonTextHere = function(md) {
		if (Place == 286 && sType === "" && !this.checkFlag(9)) md.write("<p>You notice  familiar looking stone sitting on a shelf.</p>");
		if (sType !== "" || Place != 282 || this.whereNow() != 286) return;
		if (!isShopOpen(-2, -2, true, true)) return;
		if (this.checkFlag(3)) md.write("<p>Mistress Jade's private room seems to be closed.</p>");
		else if (this.checkFlag(1)) md.write("<p>Mistress Jade's private room seems to be open.</p>")
	};
	per.showPersonChat =
		function(bGeneral, md) {
			if (Place == 286 && this.checkFlag(5) && this.isHere()) {
				if (!this.checkFlag(6)) addQuestionC(md, "ask about demons", "Jade", 666);
				if (!this.checkFlag(7)) addQuestionC(md, "ask about Elian", "Jade", 667);
				var perLeanne = findPerson("Leanne");
				if (perLeanne.place == 382 && !perLeanne.checkFlag(9)) addQuestionC(md, "ask her about saving a person from demons", "Jade", 668);
				if (sType === "" && !this.checkFlag(9)) addQuestionC(md, "ask about the stone", "Jade", 669);
				return
			}
			if (sType !== "" || Place != 282) return;
			if (isShopOpen(-2, -2, true, true))
				if (!this.checkFlag(1)) addLinkToPlaceC(md, "ask around for Jade", 286, "type=askjade");
				else if (!this.checkFlag(3))
				if (this.checkFlag(5)) addLinkToPlaceC(md, "visit Mistress Jade", 286);
				else addLinkToPlaceC(md, "visit Mistress Jade", 286, "type=payment")
		};
	per.handleItem = function(no, cmd) {
		if (no == 14 && cmd == 2)
			if (Place == 286 && this.isHere()) {
				if (this.checkFlag(2)) addComments("It seems pointless to try this again!");
				else dispPlace(286, "type=castcharm");
				return "handled"
			}
		return ""
	}
}

function RepliesJanetKelly(nR) {
	var pCharm = per.isCharmedBy();
	var myName = per.getYourNameFor();
	if (nR == 6800) {
		if (perKurndorf.getQuestCrypt() === 0) perKurndorf.setQuestCrypt(1);
		if (!isPlaceKnown("ShoppingCenter")) setPlaceKnown("ShoppingCenter");
		per.setFlag(2);
		if (!pCharm) addComments("\"She didn't say, " + myName + '. She went out to walk her dog and said that she had some shopping to do this evening. Maybe she has gone to the shopping centre."<br>');
		else addComments("\"She didn't say, " + myName + ". She went out to walk her dog and said that she had some shopping to do this evening. Maybe she has gone to the shopping centre.  Are you sure you wouldn't rather stay here?  I could show you my room... again.\"<br>")
	} else if (nR ==
		6801) {
		if (perKurndorf.getQuestCrypt() < 2) perKurndorf.setQuestCrypt(2);
		per.setFlag(3);
		if (!pCharm) addComments("\"No I haven't, but my great-grandmother's ancestors did a long time ago. Her name was Stears and she told us many stories about this town. Did you know that my ancestors were among the first settlers?\"<br>");
		else addComments('"No ' + myName + ", I have never lived here before. My ancestors were among the first settlers of this town, though.  My grandmother told my sister and I many stories.  Her name was Mrs. Stears.<br>")
	} else if (nR ==
		6802) {
		per.setFlag(4);
		addComments('She smiles at you.  "Here I am telling you all about my family history and I know so little about yours.  What is your family like?" she asks, obviously avoiding the question.  Something tells you there is more to learn from this one.  If only there was a way to force her to talk.')
	} else if (nR == 6701) {
		perKurndorf.setQuestCrypt(5);
		per.setFlag(5);
		addComments('"As you wish, ' + myName + '.  My mother told me that there was real magic in the Glenvale.  She said it was because the warlock, Kurndorf, was shot with a silver bullet at the old hotel."<br>')
	} else if (nR ==
		6702) {
		perKurndorf.setQuestCrypt(6);
		if (!isPlaceKnown("Hotel")) setPlaceKnown("Hotel");
		per.setFlag(6);
		addComments('"Yes ' + myName + ".  I heard that a witch betrayed the warlock. In revenge for this betrayal Kurndorf's spirit imprisoned the witch forever in the basement of the hotel.  I don't know if its true though; Debra and I already tried to find it and failed.  I'm sorry " + myName + '."')
	} else if (nR == 2716) {
		perKurndorf.setQuestSeance(17);
		addComments('"You might try the library, ' + myName + '," Janet says. She pauses, "I did sell some useless old papers and books recently to the Antiques Shop, I think one of them might of been about that."');
		if (pCharm) addComments(", her eyes adoring your every move. Could I show you my bedroom first?  Please, " + myName + '?" she asks longingly.');
		else addComments(".");
		setPersonFlag("Victoria", 34)
	}
	return true
}

function LeaveMinJanet(recharm) {
	charmPerson("JanetKelly", 1);
	dispPlace(44, "");
	WriteComments("You leave the house and Janet to deal with the spell.<br/>She will be affected by the spell but you have chosen to not try to reinforce or guide her so the effect will be minimal.")
}

function initialiseJanetKelly() {
	addPerson("Janet Kelly", 112);
	per.Replies = RepliesJanetKelly;
	per.extra = [0, 0];
	per.getPersonName = function(full) {
		if (full === true) return this.name;
		var clv = this.getCharmedLevel();
		if (clv == 4) return "Slave Janet";
		if (clv == 3) return "Janet, the bimbo";
		if (clv == 5) return "Janet, your pet pussy";
		if (clv == 2) return "Janet, your lover";
		if (clv > 0) return "Janet";
		return this.name
	};
	per.getPersonAddress = function() {
		return isPlaceKnown("KellyHouse") && this.checkFlag(1) ? "22 Kollam St, Glenvale" : ""
	};
	per.whereNow =
		function() {
			if (Place == 300) return Place;
			return this.place
		};
	per.getPossessionFace = function() {
		return "janet-face"
	};
	per.isPersonInfo = function() {
		return this.isCharmedBy()
	};
	per.getPersonInfo = function() {
		if (this.getCharmedLevel() == 3) return "<img src='Images/janetsmsbimbo3.jpg' style='width:38%;float:right;margin-left:5px' alt='Janet'>" + 'Janet has been dumbed down to a level of a complete slut. You played with her mind so much that you have successfully turned her your airhead bimbo. She craves for sex and can\u2019t really think of anything else other that your "godly huge penis" as she likes to describe. Her clothes has changed too, she is wearing the classic bimbo outfit that comes with a lollipop to suck on.<br><br>' +
			"Janet jumps on you at the moment she sees you, pushing her boobs right in your face.<br><br>" + '"Like, ' + perYou.getMaster() + ", it's soo good to see you! Let me help ya relaxin\u2019 a bit!\", she smiles, her accent slightly resembles the typical texas one.";
		else return "<img src='Images/janet2.jpg' style='width:35%;float:right;margin-left:5px' alt='Janet'>" + "Janet turned out to be a caring, loyal lover whose capability of emotions are much wider than you first thought. She still has some bimboness, but that\u2019s her charm. She\u2019s one of the very best in bed and also a great stress reliever, she can gives great massages to you. Now you can freely about her family\u2019s history. It is why you have charmed her int he first place, right? Or was it her smoking hot body and tits? Never mind, she is yours forever now and open to you anytime, anywhere."
	};
	per.visitThem = function() {
		this.extra[1] = nTime;
		this.setFlag(7, false)
	};
	per.showEvent = function() {
		var md, clv;
		if (Place == 269 && sType == "janetpool") {
			WaitHereOnly(4);
			md = WritePlaceHeader();
			this.showPerson("janet-pool.jpg");
			addPlaceTitle(md, "Swimming with Janet");
			md.write("<p>Janet arrives, dressed in a polka-dot bikini, and immediately jumps in for a swim. When she get out, she give you a very nice view!.</p>");
			startQuestions();
			addLinkToPlaceC(md, "it is fairly private here...", Place, "type=janetpoolsex");
			addLinkToPlaceC(md,
				"say goodbye to Janet", Place);
			WritePlaceFooter(md);
			return true
		}
		if (Place == 269 && sType == "janetpoolsex") {
			md = WritePlaceHeader();
			this.showPerson("janet-pool-sex.jpg");
			addPlaceTitle(md, "Being Discrete and Private with Janet");
			md.write("<p>You ask Janet to play with you more privately, and she lies back exposing herself as an invitation for you to take her.</p>");
			startQuestions();
			addLinkToPlaceC(md, "later...say goodbye to Janet", Place);
			WritePlaceFooter(md);
			return true
		}
		if (Place != 112) return false;
		if (sType ==
			"recharm1") {
			clv = this.getCharmedLevel();
			if (clv != 1) this.charmThem(1);
			if (clv != 4) this.charmThem(4);
			else if (clv != 2) this.charmThem(2);
			else this.charmThem(3);
			md = WritePlaceHeader();
			this.showPerson("janet-recharm1.jpg");
			addPlaceTitle(md, "Janet Under A Charm Spell - Again");
			md.write("<p>Once again Janet falls under the spell. She starts to say something, then trails off after the first word, and shakes her head.</p>" + '<p>She tries again and asks, "Do you want to take me upstairs?"</p>' + "<p>What she really means is obvious. Everything says it: her gasping breaths, her stance, her gaze.</p>");
			startQuestions();
			if (clv != 2) addLinkToPlaceC(md, 'tell Janet "Yes, I want you now too!"', Place, "type=recharm2", "", "", "charmPerson('JanetKelly',2);");
			if (clv != 3) addLinkToPlaceC(md, 'tell Janet "You forget where your room is, don\'t you"', Place, "type=recharm2", "", "", "charmPerson('JanetKelly',3);");
			if (clv != 4) addLinkToPlaceC(md, "order Janet to go upstairs", Place, "type=recharm2", "", "", "charmPerson('JanetKelly',4);");
			if (clv != 1) addOptionLink(md, "exit the house and let Janet get used to the spell", "LeaveMinJanet()");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "recharm2") {
			clv = this.getCharmedLevel();
			md = WritePlaceHeader(false, "td-left-large");
			this.showPerson("janet-recharm2.jpg");
			addPlaceTitle(md, "Janet Under A Charm Spell - Again");
			var myName = this.getYourNameFor();
			switch (this.getCharmedLevel()) {
				case 2:
					md.write('<p>Passion overcomes the girl, causing her to fall to the ground. "Oh god!" she exclaims, holding the raging excitement in her stomach.</p>' + '<p>"I want you so much, and that you want me too is so <b>hot</b>" she says, the excitement building.</p>' +
						'<p>"Please make love to me ' + myName + '. I want you, I need you, so badly."</p>');
					break;
				case 3:
					md.write('<p>Passion overcomes the girl, causing her to fall to the ground. "What do you mean...my room..."</p>' + '<p>You quickly interrupt her "You don\'t remember, your sister looked after these things for you. After all you are more interested in your appearance, in being sexy than smart."</p>' + "<p>She looks confused as the spell reinforces your words, and also as it seems they are at least in some part the truth. She tries to deny your words,</p>" +
						'<p>"Well I like looking good, but it is not like I am some sort of..."</p>' + '<p>Again you interrupt her "A bimbo...a beautiful sexy woman who knows what is important in life, looking good and pleasing others"</p>' + '<p>She looks at you, "A bimbo...well I love being sexy and how others look at me...I suppose you could call me that...yes...I am a bimbo!!"</p>');
					break;
				case 4:
					md.write('<p>Passion overcomes the girl, causing her to fall to the ground. "Oh god!" she exclaims, holding the raging excitement in her stomach. "I feel like such a cheap slut, like <i>your</i> cheap slut, your whore, your... <i>slave</i>," she says, relishing the word as it rolls off her tongue.</p>' +
						'<p>"Please take me ' + myName + '. I want you, I need... to serve you, so badly."</p>');
					break
			}
			startQuestions();
			addLinkToPlaceC(md, "talk more to her", 112);
			WritePlaceFooter(md);
			return true
		}
		return false
	};
	per.handleItem = function(no, cmd) {
		if (no == 32)
			if (cmd == 1)
				if (this.isHere() && this.isCharmedBy()) {
					examineSilverRingStart();
					addComments("<p>It seems to be reacting to Janet's presence... getting warmer the closer you get.</p>" + "</td></tr></table>");
					return "handled"
				}
		return ""
	};
	per.isPhoneable = function() {
		return checkPlaceFlag("Hotel",
			11) && Place == 269 && this.isCharmedBy()
	};
	per.callThem = function() {
		if (Place == 269) {
			gotoPlace(Place, "type=janetpool");
			receiveCall("", 'You call Janet to invite her to join you at the pool for a swim, and she answers enthusiasticaly, "Damn right!" and hangs up. You take that to mean she will be there soon.');
			WriteCommentsFooter(bChat, bChatLeft)
		}
	};
	per.addPersonPhoneCall = function() {
		var clv = this.getCharmedLevel();
		if (clv === 0) return false;
		var hr = getHour();
		if (nTime - this.extra[1] > 24 && hr > 6 && !this.checkFlag(7) && this.extra[0] <
			3) {
			hr = this.extra[0];
			if (makeCall(true, 10 + hr)) {
				this.extra[0]++;
				this.setFlag(7);
				return true
			}
		}
		return false
	};
	per.getPersonSMS = function(id) {
		var clv = this.getCharmedLevel();
		switch (id) {
			case 10:
				if (clv == 2) return receiveSMS("Janet", "Hey " + perYou.getPersonName() + " missing you, come and visit", "janetsmsgf1.jpg", "88%");
				else return receiveSMS("Janet", "Feeling horny, cum and fuck me", "janetsmsbimbo1.jpg", "88%");
				break;
			case 11:
				if (clv == 2) return receiveSMS("Janet", "Hi, " + perYou.getPersonName() + " taking a break and thinking of you",
					"janetsmsgf2.jpg", "88%");
				else return receiveSMS("Janet", "Do ya like, they are my best part", "janetsmsbimbo2.jpg", "88%");
				break;
			case 12:
				if (clv == 2) return receiveSMS("Janet", "I just had a shower, sorry you were not here to join me", "janetsmsgf3.jpg", "88%");
				else return receiveSMS("Janet", "Trying on lingerie, let me show you them on and then off", "janetsmsbimbo3.jpg");
				break
		}
		return ""
	}
}

function RepliesJenny(nR) {
	if (nR == 9601) {
		per.other = 2;
		addComments('"Depends on your price range, hon. I recommend the bratwurst, for ' + sCurrency + '4.00.  I love a good bratwurst."<br>')
	} else if (nR == 9602)
		if (nMoney > 3) {
			per.other = 3;
			AddCash(-4);
			addComments("You pay " + sCurrency + "4 for the bratwurst. Jenny asks you to step over to the counter as she gets the bratwurst from a small storeroom. It appears to be a sausage that smells faintly of beer.");
			Place = 203
		} else addComments('"Looks like you don\'t have enough for that, hon."');
	return true
}

function initialiseJenny() {
	addPerson("Jenny", 196, "Jenny");
	per.getPersonName = function(full) {
		if (full === true) return this.name;
		return this.isCharmedBy() ? "Jenny, Your Slave" : "Jenny, Your Waitress"
	};
	per.Replies = RepliesJenny;
	per.getPersonGender = function() {
		return this.checkFlag(4) ? "futa" : "woman"
	};
	per.isPersonInfo = function() {
		return true
	};
	per.getPersonInfo = function() {
		var s = "<p>" + this.addPersonString(this.isCharmedBy() ? "jenny1c.jpg" : "jenny1b.jpg", "height:max%", "right") + "Jenny, the waitress of the Bavaria Hut, ";
		if (this.isCharmedBy()) return s +
			"and your slave.";
		else return s + "the beautiful idol of the restaurant."
	};
	per.whereNow = function() {
		if (!this.checkFlag(3)) {
			if (Place == 203) return Place;
			return this.place
		}
		var d = getDay(true);
		if (d == "Sat" || d == "Sun") return 0;
		if (Place == 203) return Place;
		return this.place
	};
	per.showEvent = function() {
		if (Place == 269 && sType == "jennypool") {
			WaitHereOnly(4);
			md = WritePlaceHeader();
			this.showPerson("jenny-pool" + (this.checkFlag(4) ? "-fute" : "") + ".jpg");
			addPlaceTitle(md, "Swimming with Jenny");
			md.write("<p>Jenny arrives, dressed in a black bikini, you think it is made of leather, an unexpected side of her.</p>" +
				(this.checkFlag(4) ? "<p>You notice she tends to cover the bulge in her crothch from others, she seems embarrassed to show <i>others</i> her new cock.</p>" : ""));
			startQuestions();
			addLinkToPlaceC(md, "it is fairly private here...", Place, "type=jennypoolsex");
			addLinkToPlaceC(md, "say goodbye to Jenny", Place);
			WritePlaceFooter(md);
			return true
		}
		if (Place == 269 && sType == "jennypoolsex") {
			md = WritePlaceHeader();
			this.showPerson("jenny-pool-sex" + (this.checkFlag(4) ? "-fute" : "") + ".jpg");
			addPlaceTitle(md, "Being Discrete and Private with Jenny");
			md.write("<p>You ask your lovely watressy, and she seductively removes most of her swimsuit and lies back waiting for you." + (this.checkFlag(4) ? " her cock stiffening as she uncovers it." : "") + "</p>");
			startQuestions();
			addLinkToPlaceC(md, "later...say goodbye to Jenny", Place);
			WritePlaceFooter(md);
			return true
		}
		if (Place != 196 || !isShopOpen(4, 0, true)) return false;
		var md;
		if (sType == "bj") {
			md = WritePlaceHeader(false, "td-left-med");
			if (perYou.isMaleSex()) {
				this.showPersonRorX("jenny8b.jpg", isExplicit() ? "" : "height:max");
				addPlaceTitle(md, "Bavaria Hut");
				md.write("<p>You instead ask Jenny to use her mouth to pleasure you. She eagerly agrees and she is not inexperienced and skillfully pleasures you until you release into her mouth. She happily swallows as the good slave she is.</p>")
			} else {
				this.showPersonRorX("jenny8g.jpg");
				addPlaceTitle(md, "Bavaria Hut");
				md.write("<p>You accept Jenny' suggestion and ask her to use her fingers and tongue to pleasure you. To your surprise and delight she appears quite skilled at this and you enjoy her attentions until you cry out your pleasure.</p>")
			}
			addLinkToPlace(md,
				"exit the restaurant", 194);
			WritePlaceFooter(md);
			return true
		} else if (sType == "anal") {
			md = WritePlaceHeader(false, perYou.isMaleSex() && isExplicit() && this.getPersonGender() == "futa" ? "" : "td-left-med");
			if (perYou.isMaleSex()) {
				this.showPersonRorX("jenny7b" + (this.getPersonGender() == "futa" ? "-futa" : "") + ".jpg");
				addPlaceTitle(md, "Bavaria Hut");
				md.write("<p>You accept Jenny' suggestion as her ass looks very tempting and you very much enjoy exploring the depths of her being. She also very much enjoys serving you.</p>")
			} else {
				AddImageRandomX("GenericSex/sex-ff anal strapon ",
					2);
				addPlaceTitle(md, "Bavaria Hut");
				md.write("<p>Instead of her suggestion you decide to use your strap-on to explore Jenny's lovely ass. While this does not seem to be something she is expienced with, at least with another woman, she does very much enjoy it, reaching her peak not long after you do.</p>")
			}
			addLinkToPlace(md, "exit the restaurant", 194);
			WritePlaceFooter(md);
			return true
		} else if (sType == "titsfuck") {
			md = WritePlaceHeader(false, "td-left-med");
			this.showPersonRorX(this.getPersonGender() == "futa" &&
				!isExplicit() ? "jenny9b-futa.jpg" : "jenny9b.jpg", "height:max");
			addPlaceTitle(md, "Bavaria Hut");
			md.write("<p>You instead ask Jenny to use her breasts to pleasure you. This seems to be something she is quite familiar with and she uses her ample bosom to please you until you release all over her breasts and face.</p>");
			addLinkToPlace(md, "exit the restaurant", 194);
			WritePlaceFooter(md);
			return true
		} else if (sType == "transformcock") {
			CastTransform(1);
			this.setFlag(4);
			md = WritePlaceHeader(true, "", "black");
			showPopupWindow("Transformation",
				'<img src="Images/GenericSex/xf-futa-blonde.jpg" style="width:35%;float:left;margin-right:6px;margin-top:1em;margin-bottom:2em" alt="futa">' + "<p>You cast the spell and Jenny cries out something inarticulate in German and pulls away what little clothing she has on. You see a large cock growing from her groin above where her pussy is.</p>" + "<p>As she groans you can distinctly hear someone laughing but it is drowned out as Jenny cries out in ecstasy as her new cock spasms in her first male ejaculation.</p>" +
				"<p>Jenny seems remarkably pleased with her new cock but you cannot help but wonder if it was a good thing, but then again as you watch her stroking her new cock you put these worries out of your mind.");
			setQueryParams("");
			WritePlaceFooter(md, "", true, true);
			return true
		}
		return false
	};
	per.addPlaceImageLeft = function(lit) {
		if (Place == 203 && this.isHere() && sType === "") return this.showPerson("jenny2.jpg", "", "", "", "", false, "string");
		else if (Place == 196 && this.isHere() && sType === "") {
			var bLogan = wherePerson("MissLogan") ==
				196;
			var bEvt1 = this.isCharmedBy() && !bLogan && this.hoursCharmed() > 12 && !this.checkFlag(2);
			if (this.isCharmedBy()) {
				if (bEvt1 || bLogan) return this.showPerson("jenny6b.jpg", "", "", "", "", false, "string");
				return this.showPersonArray(this.getPersonGender() == "futa" ? ["jenny6d.jpg"] : ["jenny6a.jpg", "jenny6c.jpg"], "44vw", "", "", "", false, "string")
			} else if (bLogan) return this.showPerson("jenny1b.jpg", "", "", "", "", false, "string");
			return this.showPerson("jenny1a.jpg", "50vw", "", "", "", false, "string")
		}
		return ""
	};
	per.showPersonTextHere =
		function(md) {
			if (Place == 203 && this.isHere() && sType === "") md.write("<p>The young couple vacate the restaurant.  Jenny, moves quickly to clear their table, " + "the novelty size mug of beer sloshing gently. She catches you staring at her, " + "and balances the mug on her leg. &quot;Do you need anything, " + (perYou.isMan() ? "sir" : "ma'am") + "?&quot;</p>");
			else if (Place == 196 && this.isHere() && sType === "") {
				var bEvt1 = this.isCharmedBy() && wherePerson("MissLogan") != 196 && this.hoursCharmed() > 12 && !this.checkFlag(2);
				if (this.isCharmedBy())
					if (bEvt1) {
						this.setFlag(2);
						md.write("<p>As Jenny, your personal waitress, is standing at attention behind your back, you try to choose from one of the courses. You cannot seem to pick one to your liking and turn your attention to Jenny.</p>" + '<p>"Bring me the today\u2019s menu!", you order causally. Jenny, like a good slave acknowledges your demand and runs to fulfill it the best she can.</p>' + "<p>You wait for a few minutes, realizing you probably don\u2019t have that much money to spend on some fancy food. You need the money for other things than just to waste them on something expensive. Jenny returns with a plate and starts to serve it to you.</p>" +
							'<p>"' + perYou.getMaster() + ", it's the house's speciality! Bratwurst with bread and some beer! I hope it\u2019s to your liking!\", she says, trying to prove herself to you. You thank her and you begin to consume the dish that has been just served to you. Jenny takes a few steps backwards from your table and carefully looks around. After a few silent moments, you hear her mellow voice in that slight German accent that you oh so love to hear.</p>" + '<p>"' + perYou.getPersonName() + '! I just wanted to mention that you don\u2019t have to pay for the meal. Not for this one you eat at the moment or the ones you will eat in the future. Take it as a gift of the house.", she smiles, but you feel a little nervousness in her voice. You put down the half eaten wurst from your hand and look at her.</p>' +
							'<p>"I hope it\u2019s not a problem to you. I don\u2019t want you to fall into some mess because of me\u2026"</p>' + '<p>"No, not all my ' + perYou.getMaster() + '! This is all for you! I wanted to make you happy and I thought through what can I offer you. This is what I came up with; free food and an isolated table far from the other, annoying guests.", Jenny objects first and after that she tries to convince you.</p>' + '<p>"Don\u2019t worry about anything! I\u2019m the restaurant\u2019s favourite and prettiest waitress, they like me! They won\u2019t notice a thing! I just wanted make myelf useful to you\u2026 I know I\u2019m not some high profile police ' +
							getOfficer(false) + ' or the mayor, but I wanted to help you.", her pretty smile rolls to wail. You direct her to come close to you with your eyes (you don\u2019t need words anymore, she knows what to do) and give a playful spank on her ass. Her confused face makes you laugh out loud.</p>' + '<p>"You did well Jenny! I\u2019m impressed! You have done well!", you pause for a little while Jenny\u2019s smile returns. Her face now glows with pride.</p>' + '<p>"Now, please let me finish this delicious meal! I\u2019ve got to hurry because I\u2019ve got important things to do.". Jenny, after heavily nodding to every word you said returns to her place, a few steps away from you, but just in reach if you would need anything from her. She quietly waits on you as you finish your meal in peace.</p>')
					} else md.write("<p>You enter the Bavaria Hut and you notice Jenny is at the front waiting for customers to come in, holding a menu sheet in her hands. When she sees you, she runs to you and clasp her hands with yours and gently drags you through the main area of the building. When you two finally arrive, you realize you\u2019re at the private part of the Cafe where only reserved guests can stay. It seems Jenny knew you would need some privacy so she arranged that this room would be all yours to use. " +
						"You can talk\u201dwith her or have a nice breakfast or dinner anytime without anyone disturbing you.</p>" + "<p>As you sit down to your table, Jenny gives you the menu. As you run through the menu she massages your head trying get your attention. You feel that her libido is going crazy and is all over the place!</p>" + '<p>"Hello my love," she says, ' + (perYou.isMaleSex() ? '"my ass is waiting for you."' : '"my lips and tongue are waiting for you."'));
				else md.write("<p>You enter the cafe and look around for a seat. You " +
					"examine the menu and realise that you may not have enough " + 'money to purchase most of the "authentic German cuisine." ' + "There is a young couple finishing their coffee in the far right corner.</p>" + "<p>The waitress approaches you.</p>")
			}
		};
	per.showPersonChat = function(bGeneral, md) {
		if (Place == 196 && this.isHere() && sType === "")
			if (this.isCharmedBy())
				if (perYou.isMaleSex()) {
					addLinkToPlaceO(md, "accept her offer", 196, "type=anal");
					addTextForQuestions(md, "or maybe you would prefer to sample");
					addLinkToPlaceO(md,
						"her breasts", 196, "type=titsfuck");
					addLinkToPlaceO(md, "her mouth", 196, "type=bj")
				} else {
					addLinkToPlaceO(md, "accept her offer", 196, "type=bj");
					if (perYourBody.FindItem(45) > 0) {
						addTextForQuestions(md, "or maybe you would prefer to sample");
						addLinkToPlaceO(md, "her ass", 196, "type=anal")
					}
				}
		else if (this.other === 0) addPopupLinkC(md, "talk to the waitress", "Your Waitress, Jenny", "<img src='Images/People/Jenny/jenny0.jpg' class='imgpopup' alt='Jenny'>" + "As you stroll through the German restaurant for a seat you come across a pretty waitress. She\u2019s the definition of the German beauty with slim, tall body, long legs and golden locks. " +
			"Her eyes and smile also betray her of the pure German heritage she has. She escorts you to your table and gives you the menu.<br><br>" + "She doesn\u2019t hold much interest in you, you\u2019re just an another customer. However, you imagine her as your slave in your head, serving you food and waiting on you all day. You would no longer have to worry about where and what to eat and you wouldn\u2019t have to pay for it anymore. You could just come in anytime if you can make her change her mind about you" +
			(isSpellKnown("Charm") ? ", but it\u2019s too public so you have to watch out what you are doing around here!" : "") + "<br><br>Your daydream is interrupted as she speaks to you,<br>" + '"Welcome to Bavaria Hut! I\'m Jenny, what can I get you?"', false, "setPersonOther('Jenny', 1);dispPlace();");
		else if (this.other == 1) addQuestionC(md, "ask the waitress what she recommends", "Jenny", 9601);
		else if (this.other == 2) addQuestionCO(md, "buy a bratwurst for " + sCurrency + "4", "Jenny", 9602)
	};
	per.handleItem = function(no, cmd) {
		if (cmd ==
			1 && (no == 52 || no == 64)) {
			var s = getSoulBoundCrystal(no);
			if (s != "")
				if (this.isHere() && !this.checkFlag(4)) {
					if (!this.isCharmedBy()) examineItem(no, "The " + s + " trembles weakly, you suspect you need a magical link to Jenny before it will work.");
					else examineItem(no, "The " + s + " vibrates softly the closer you get to Jenny.");
					return "handled"
				}
		}
		if (no == 14 && cmd == 2) {
			if (Place == 196 && this.isHere()) {
				if (this.other === 0) addComments("You do not know her name, so the spell will not work.");
				else if (!isSpellKnown("Shielded Charm")) addComments("Don't cast the spell here.  Its too public.");
				else CastCharmSpell("Jenny", 204, 1);
				return "handled"
			}
			if (Place == 203 && (this.whereNow() == 196 || this.whereNow() == 203)) {
				CastCharmSpell("Jenny", 204, 1);
				return "handled"
			}
		}
		if (no == 18 && cmd == 2)
			if ((Place == 203 || Place == 196) && this.isHere()) {
				if (this.checkFlag(4)) {
					addComments("You have already transformed Jenny!");
					return "handled"
				}
				if (!this.isCharmedBy()) {
					addComments("The spell washes over her but nothing happens, you seem to need a magical link to her");
					return "handled"
				}
				if (!CastTransform(1, true)) return "handled";
				ClearComments();
				dispPlace(Place, "type=transformcock");
				return "nofooter"
			}
		return ""
	};
	per.isPhoneable = function() {
		return checkPlaceFlag("Hotel", 11) && Place == 269 && this.isCharmedBy()
	};
	per.callThem = function() {
		if (Place == 269)
			if (this.whereNow() !== 0) WriteComments("You call Jenny to invite her to join you at the pool for a swim, but she replies, but someone else picks up and says Alison is busy serving customers and for you to call back later.");
			else {
				gotoPlace(Place, "type=jennypool");
				receiveCall("", 'You call Jenny to invite her to join you at the pool for a swim, and she answers pleasantly, "Certaintly!" and promises to join you soon.');
				WriteCommentsFooter(bChat, bChatLeft)
			}
	}
}
var perJesse;

function isDemonFreed() {
	return perKurndorf.getQuestSeance() >= 70
}

function isDemonInTown() {
	return perKurndorf.getQuestSeance() >= 70 && perJesse.getDemonPath() < 500
}

function isDemonQuestDone() {
	return perJesse.getDemonPath() >= 500
}

function isDemonBound() {
	return perJesse.checkFlag(12)
}

function isDemonGone() {
	return perJesse.getDemonPath() == 900
}

function isJesseOk() {
	return perJesse.getDemonPath() >= 600
}

function RepliesJesse(nR) {
	var myName = per.getYourNameFor();
	var perD = findPerson("Desiree");
	if (nR == 12101) {
		perJesse.place = 161;
		perKurndorf.setQuestSeance(20);
		Place = 161;
		bChatLeft = false;
		addComments('"A secret place sounds exciting. Sure, why not have a little bit of adventure.  There\'s nothing else to do around here," she says, smiling at you.<br>')
	} else if (nR == 12200) {
		perJesse.setDemonPath(602);
		addComments('"Dont\'s worry about her, she is not very talkative, but she is really helpful and cute," she says, smiling at you. Once again the thrall, or Lucy, says nothing, just looks at Jesse with a look of complete devotion.')
	} else if (nR ==
		12201) {
		perJesse.setDemonPath(603);
		addComments('"A bit off, maybe I got a cold as well, but probably just a hangover. I think I remember you helping out at times, thank you" she says, smiling at you and she leans over and gives you a kiss on the cheek.');
		if (perJesse.checkFlag(6)) addCommnts("</p><p>Jesse suddenly looks down and turns away from you and grabs piece of clothing and holds it in front of her waist. For a moment you thought you may of seen a bulge forming, does she have a cock like you saw in that photo? You are sure when she was ill you saw her naked enough and there was nothing like that there. Maybe it can appear at will, or accident?")
	} else if (nR ==
		12202) {
		perJesse.setDemonPath(604);
		addComments('"Weird things, but they are probably dreams...I mean I am not some sort of slut...was I?" she asks a little hesitantly. You reassure her that it must of been a dream, there is no way <b>she</b> was a slut.')
	} else if (nR == 14410) {
		addComments('<p>"Call us?" she asks.  "Ah, yes...  We are <b>LEGION</b>," she says, the name shaking you to your core with its weight.  "But you may use this body\'s name...  Call Us Jesse.  Yes... We like that name."</p>');
		perJesse.setDemonPath(11)
	} else if (nR ==
		14431) {
		perJesse.setDemonPath(35);
		addComments('<p>"Why do you ask, ' + myName + "?  Can't We just be enjoying ourselves in this beautiful park your people have made here?\" She asks.</p>")
	} else if (nR == 1841)
		if (!perJesse.checkFlag(1)) {
			perJesse.setFlag(1);
			addComments('<p>"You aren\'t the only one who can steal the will of those around them.  This," She says, running her hand through her pet\'s hair.  "This is within Our power... to completely enthrall a creature to Our will.  The process is quite pleasurable, We assure you."</p>')
		} else {
			perJesse.setFlag(2);
			addComments('<p>"It was very simple, ' + myName + '," She says beckoning you closer and pushing her thrall away as she turns your attention to you.</p><p>"Would you like to find out?" She whispers... "We can show you how it feels."')
		}
	else if (nR == 1842) {
		bChat = false;
		Place = 63;
		setQueryParams();
		perJesse.place = 10;
		perJesse.setDemonPath(50);
		movePerson("Seraphina", 282);
		addComments('<p>Jesse, or rather Legion, hisses her contempt at you as you once again shrug off the haze that was clouding your mind.</p><p>"This much We know, and you shall regret the shirking of Our attentions." It hisses, draping a few clothes over her body and dragging off her thrall and leaving you alone once again.</p>')
	} else if (nR ==
		1843) {
		perJesse.setFlag(3);
		addComments('<p>"Oh that one?" She asks, feigning innocence and then flashing an almost predatory smile.  "We left her with another friend of Ours.  She should keep them both busy for a while."</p>')
	} else if (nR == 1844) {
		perJesse.setFlag(3, false);
		perJesse.setFlag(4);
		if (perJesse.getDemonPath() < 65) perJesse.setDemonPath(65);
		addComments('<p>"Fine." She hisses, a flash of anger crossing her face before quickly regaining her composure.  "Look what you do to Us ' + myName + '.  We are <i>not</i> used to my advances being so easily ignored. - Besides, that is not what We are here for."</p>')
	} else if (nR ==
		1845) {
		perJesse.setFlag(5);
		if (perJesse.getDemonPath() < 65) perJesse.setDemonPath(65);
		IncreaseMomsArousal(1, 2);
		addComments('<p>"Your Mother?" She asks, almost amused with herself. "Don\'t worry.  We have done nothing to any of your family.  Nothing beyond a simple glamour to mask my somewhat less than "presentable" appearance."</p>');
		addComments('<p>You remember how your mother looked and again ask the demons,<br/>"She is very susceptible to simple hypnotic suggestions. You know people will not do anything against their will while in a trance and it makes some glamours and other such enchantments easier. She will not remember except in her dreams. Ahh so willing..."</p>');
		addComments("<p>You try to pry further but the demon just smiles.")
	} else if (nR == 1848)
		if (perYourBody.NoItems < perYourBody.MaxItems) {
			bChat = false;
			addComments(perJesse.addPersonFace() + '<p>"Here you are..." She says lustfully as she hands over the stone.</p>' + '<p>"We will find you when you have the relic. We believe it is being held at the <i>church</i>." She hisses in contempt.  "We can not go there.  Get it for Us and We will contact you when you have it." She says as she leaves you.</p>');
			if (perJesse.checkFlag(8)) {
				perYourBody.PutItem(5);
				perJesse.setFlag(8, false)
			}
			if (!isPlaceKnown("Church")) setPlaceKnown("Church");
			if (!isPlaceKnown("Graveyard")) setPlaceKnown("Graveyard");
			Place = 45;
			perJesse.place = 10;
			perJesse.setDemonPath(100);
			perD.setQuestRelic(5)
		} else addComments('<p>"Oh, We would love to give it to you ' + myName + ", but We don't think you could carry it.  Perhaps if you made room in your backpack...\"</p>");
	else if (nR == 18421) {
		addComments('<p>"Mmmm..." She moans, before finally pushing her pet away long enough to turn and face you. "Yes, ' +
			myName + '.  Do you have something for Us?"</p>');
		perJesse.setFlag(1, false)
	} else if (nR == 18422) {
		addComments('<p>"Why We wanted it is no concern of yours, ' + myName + '.", she says, evidently not pleased to be interrupted for such questions.</p><p>"We wanted it, and you agreed to get it.  Now, do you have it for Us?"</p>');
		perJesse.setFlag(2)
	} else if (nR == 18423) {
		addComments('<p>"We are not entirely sure." She says, blatantly lying to your face.</p><p>"All that concerns you is that once it is Ours, We will no longer remain in your pathetic little town."</p>');
		perJesse.setFlag(3)
	} else if (nR == 18424) {
		addComments('<p>"We are creatures of law, not pure chaos, although We do revel in chaos.  We have given our word.  Our word is law.  We shall leave your town and do no harm..."</p><p>Then, she eyes her pet for a moment.  "We shall even leave <i>this</i> to you," She says, running her hands through her thrall\'s hair.</p><p>"As a... gift.  Now, do you have it?"</p>');
		perJesse.setFlag(4);
		perJesse.setFlag(8)
	} else if (nR == 18425) {
		addComments('<p>"Mmm...  We have found this particular thrall to be most..." She says. The thrall\'s sightless eyes turn to you, and it says, "Sensitive to our talents". It speaks with Jesse\'s voice.</p>');
		perJesse.setFlag(5)
	} else if (nR == 18426) {
		addComments('<p>"Mmm..." She sighs. "Now, where where We?  Ah yes, do you have the relic ' + myName + '?" She asks.</p>');
		perJesse.setFlag(5, false)
	} else if (nR == 14465) {
		perJesse.setDemonPath(70);
		addComments('<p>"Please," She hisses, a unpleasant look crossing her face.  "We told you to call Us Jesse.  That is the name of this... <i>flesh</i>."  She says, running her hands up and down the body and momentarily distracted by the experience.  "Allow me to explain..."</p>')
	} else if (nR ==
		14470) {
		perJesse.setDemonPath(75);
		perJesse.setFlag(8);
		addComments('<p>"We need something.  Something We can not get on Our own.  But you... You could get it for Us.  And in return we could do something for you.  Perhaps give you something that you need to further your own goals?"</p>')
	} else if (nR == 144151) {
		bChat = false;
		addComments('<p>"Then what are you doing here wasting Our time." She demands. "We know you have it.  Now bring it to us!" She says, literally kicking you out of the room.</p>');
		Place =
			124
	} else if (nR == 481) {
		perD.setQuestRelic(100);
		perJesse.setFlag(5, false);
		perJesse.setFlag(1, false);
		if (perJesse.checkFlag(11)) {
			perJesse.setDemonPath(500);
			perJesse.setTimeFreed(nTime);
			perJesse.setFlag(12);
			perJesse.place = 375;
			if (!isMurderPath()) {
				setPlaceKnown("FrenchClassroom");
				movePerson("MsJones", 145);
				movePerson("Anita", 195)
			}
			perYourBody.DropItem(48);
			setPersonFlag("Lucy", 1);
			getBaseItemObj(48).image = "artifact3.jpg";
			addComments('<p>Jesse reaches out and snatches the anointed relic from your hands, then screams in pain.  A storm of red flashes before your eyes, swirling violently around Jesse and into the relic as <i>Legion</i> is drawn out of its host.</p><p>You hear a faint sigh from the demon as it is drawn into the relic "...jones..."</p>')
		} else {
			perJesse.setDemonPath(900);
			perJesse.place = 900;
			setQueryParams("type=left");
			if (!isMurderPath()) {
				setPlaceKnown("FrenchClassroom");
				movePerson("MsJones", 145);
				movePerson("Anita", 195)
			}
			perYourBody.RemoveItem(48);
			addComments('<p>"Oh yes...  this pleases Us." She hisses in delight, then flashing her eyes at you.</p><p>"You have served your purpose...  Normally I would kill you now, but according to our <i>agreement</i>", spitting the word with utter contempt</p><p>"We will instead leave this town.  Do NOT search for Us ' + myName + '.  Otherwise Our agreement is void."</p><p>Moments later, she has vanished.</p>')
		}
	} else if (nR ==
		19E3) {
		perJesse.setFlag(9);
		addComments('<p>"Leanne, who is that?", and you tell her about your friend that she had taken as a thrall.</p><p>"Ahh, that one, names of mortals mean little to us.",  she says and looks at you with a smirk.</p><p>"Would you offer us another to take instead?", she laughs "Not that it matters, it is not in our power to restore, just to take."</p>')
	}
	return true
}

function JesseNonTG() {
	perJesse.setFlag(6, false);
	addSMS(perJesse.place == 8 ? 62 : 60);
	usePhone("sms");
	receiveCall("Legion", "Your phone chimes that a new SMS has arrived, and the voice continues in the active call,</p>" + '<p>"Hmm look at this slut, her tongue gives our body great pleasure. So susceptible to glamours and simple charms, she thinks she is with her lover. We will play with this one until ' + (perJesse.place == 8 ? "come here" : "have it for us") + '. Mmmmmm"</p>' + "<p>The phone call disconnects", true);
	WriteCommentsFooter(false)
}

function JesseTG() {
	perJesse.setFlag(6);
	addSMS(perJesse.place == 8 ? 63 : 61);
	usePhone("sms");
	receiveCall("Legion", "Your phone chimes that a new SMS has arrived, and the voice continues in the active call,</p>" + '<p>"Look at us cumming down this sluts thoat. A simple <b>transformation</b> and so pleasurable. Ugggg the sluts ass is tight on our cock now and her groans are a joy to our ears. ' + "Even a " + perYou.getWitch() + " like you can do this...uhhhhh...all you need is the spell...uhhhh...and the Mirrors....." + "Ummm...ugggg...take it you slut...take it all....uhhhhh....cummmmming....Huhhhh...We will play with this one until you " +
		(perJesse.place == 8 ? "cum here...like we did..." : "have it for us") + '... clean it slut..."</p>' + "<p>The phone call disconnects.", true);
	WriteCommentsFooter(false)
}

function initialiseJesse() {
	perJesse = addPerson("Jesse");
	per.setFlag(6);
	per.extra = [0, 0, 0];
	per.getPersonName = function() {
		return this.getDemonPath() > 1 && this.getDemonPath() < 900 ? "Demon Jesse" : "Jesse"
	};
	per.Replies = RepliesJesse;
	per.getDemonPath = function() {
		return this.extra[1]
	};
	per.setDemonPath = function(no) {
		this.extra[1] = no
	};
	per.getTimeFreed = function() {
		return this.extra[2]
	};
	per.setTimeFreed = function(no) {
		this.extra[2] = no
	};
	per.getPossessionFace = function() {
		if (isDemonInTown()) return "jesse-dface";
		if (perJesse.getDemonPath() >=
			500 && perJesse.getDemonPath() < 600) return "jesse-sickface";
		return "jesse1b"
	};
	per.passTimeDay = function() {
		var dp = perJesse.getDemonPath();
		if (dp > 500 && dp < 505) perJesse.setDemonPath(dp + 1);
		else if (dp == 505) perJesse.setDemonPath(600);
		return ""
	};
	per.isPlaceImageRight = function() {
		if (Place == 375 && this.isHere() && sType === "" && perJesse.getDemonPath() >= 500 && perJesse.getDemonPath() < 600) return true;
		return false
	};
	per.showPlaceImageRight = function(md) {
		this.showPerson("jesse-sickface.jpg", undefined, undefined, undefined, undefined,
			undefined, md)
	};
	per.showEventPopup = function() {
		if (Place == 375 && this.getDemonPath() == 600) {
			showPopupWindow("Jesse Has Recovered", "<img src='Images/jesse21.jpg' class='imgpopup' alt='Jesse'>" + "You open the door to room 113 and you see Jesse standing there next to the thrall, she looks a little consused,</p>" + '<p>"Oh, ' + perYou.getPersonName() + '...Hi there, can I help you...what about that secret room...did we drink a lot or something like that, I do not remember a lot...Come in!"</p>' + "<p>As you step in you see Jesse is stanfing close to the thrall, resting an arm over her shoulders. She notices, and says,</p>" +
				'<p>"I do not think you have met Lucy here, she is a very close friend of mine...", she heistates, "I must really be hung-over, I do not remember your last name Lucy...Faller...Thaller...sorry I am still feeling off colour" The Thrall does not say anything in reply.<p>' + "<p>You are quite sure Jesse did not know Lucy before and this is some residual effect of the possession, a possession she seems to have no memory of! You distract Jesse with a lie about a wild party in the cellar and how you are not surprised she has no memory. Jesse smiles,</p>" +
				'<p>"I suppose that explains it, I am not really that sort of party-girl, but I suppose every once in a while!"', "perJesse.setDemonPath(601)");
			return true
		}
		return false
	};
	per.showEvent = function() {
		var md;
		if (Place == 269 && sType == "jessepool") {
			WaitHereOnly(4);
			md = WritePlaceHeader();
			if (!this.checkFlag(7)) {
				this.showPerson("jesse-pool.jpg");
				addPlaceTitle(md, "Swimming with Jesse");
				md.write("<p>Jesse brightly agrees to a swim and she changes into a cute bikini and you go for a fun swim with her. As you look at her sitting on the edge of the pool after getting out, you are stuck with how cute she is looking!</p>");
				startQuestions();
				addLinkToPlaceC(md, "say goodbye to Jesse for now", Place, "", "Jesse waves goodbye as she leaves you to return to her room", "", "setPersonFlag('Jesse',7)")
			} else {
				var perLucy = findPerson("Lucy");
				perLucy.showPerson("lucy-pool.jpg");
				addPlaceTitle(md, "Swimming with Lucy");
				md.write("<p>Jesse apologies that she is feeling unwell and suggest you go with Lucy instead. You feel a but unsure but agree</p>" + "<p>You go to the pool while Lucy changes and after a little a woman joins you, she looks a bit like the thrall, but her hair is different as is her general bearing. You realise this is Lucy, she must be using one of the minor glamours the demon-kind use, as Legion used with your Mom.</p>" +
					"<p>Lucy sits on the edge of the pool, she seems to have litte interest in swimming, but silently make it clear she is interested in <i>you</i>.</p>");
				startQuestions();
				addLinkToPlaceC(md, "give in to her desire...and yours", Place, "type=lucypoolsex");
				addLinkToPlaceC(md, "take Lucy the Thrall back to the hotel room", 375, "", "", "", "setPersonFlag('Jesse',7,false)")
			}
			WritePlaceFooter(md);
			return true
		}
		if (sType == "threatenlegion1") {
			md = WritePlaceHeader();
			if (this.place == 2) this.showPerson("jesse00p.jpg");
			else if (this.place ==
				6) this.showPerson("jesse00h.jpg");
			addPlaceTitle(md, "Threatening <i>Legion</i>");
			md.write("<p>You raise the gun and, seeing your brandishing the weapon, Legion covers herself a little, though her thrall's efforts continue, and suddenly her eyes stop glowing.</p>" + "<p>The smell of sex still lies heavy in the air - small surprise with the thrall still putting on her show - but you suddenly don't feel so urgently aroused by it anymore.</p>" + '<p>"I..." she says.  "What was I... we were at the circle, doing that s\u00e9ance game, and then a ghost really appeared."</p>' +
				"<p>You gulp.  Inside that body, even subsumed by the demon's influence, Jesse is still alive... and still innocent.</p>" + "<p>Suddenly she sees the gun, her lack of decent clothes, and the thrall.  She is about to cry out, but instead she gives you a wry smile under red-gleaming eyes.</p>");
			startQuestions();
			addLinkToPlace(md, "wait for her to speak", Place, "type=threatenlegion2");
			WritePlaceFooter(md, "Script by Tilde");
			return true
		}
		if (sType == "threatenlegion2") {
			md = WritePlaceHeader(false, this.place == 2 ?
				"td-left-large" : "");
			var perSera = findPerson("Seraphina");
			if (this.place == 2) perSera.showPerson("thrall1-1.jpg");
			else if (this.place == 6) this.showPerson("jesse10.jpg");
			addPlaceTitle(md, "Threatening <i>Legion</i>");
			md.write('<p>"It wouldn\'t be as delectable for Us to let her panic," Legion says.  "Far better to feel her innocence around Us, like bathing in fine scented soapsss."</p>' + '<p>You smile back, grateful in spite of yourself for not having to deal with the panic of a victim of your dark experiment.  "I think you smell good enough already," you say before you can stop yourself.</p>' +
				"<p>Her thrall continues to play and lick at her Mistress, and the effect of the aroma you have been breathing without worry for the past minute hits you all at once.  Your eyes are drawn to Jesse's - No, you tell yourself, the demon's - succulent lips and you find you are wetting your own");
			if (!perYou.isMaleSex()) md.write(" with your fingers");
			md.write('.</p>"Indeed," she says.  "You like Us a great deal, don\'t you?  Lower that silly toy, ' + perYou.getPersonName() + ".  You wouldn't want to hurt Our vessel.  Or Us, for that matter...\"</p>" +
				"<p>You avoid her gaze, afraid that she will draw you in, but you put away the gun.  You try to tell yourself it's only to protect Jesse.\"</p>");
			startQuestions();
			if (this.place == 2) addLinkToPlace(md, "Continue speaking with... Jesse...", 63, "type=jessepark");
			else if (this.place == 6) addOptionLink(md, "Continue speaking with... Jesse...", "GoRoom113()");
			WritePlaceFooter(md, "Script by Tilde");
			return true
		}
		if (sType == "jessepark") {
			md = WritePlaceHeader(false, !perJesse.checkFlag(1) ? "td-left-large" : "");
			var myName =
				perYou.getPersonName();
			var perSera = findPerson("Seraphina");
			if (!this.checkFlag(1)) perSera.showPerson("thrall1-1.jpg");
			else perSera.showPerson("thrall1-2.jpg");
			addPlaceTitle(md, "Encounter with a Demon");
			md.write("<p>You walk around a small bunch of trees and are greeted by a sight that would normally cause you to wonder what lottery you had won.</p>" + "<p>If you didn't know what was <i>hiding</i> in the beautiful creature before you, that is.</p>");
			if (this.getDemonPath() == 30) {
				this.setDemonPath(31);
				md.write('<p>"Well, well..." you hear the creature almost hiss.  "What a surprise running into you here, ' +
					myName + '."' + " As your eyes betray your desire and begin to wander over the sight before you the demon in Jesse continues.  \"I'm sorry " + myName + ', should I introduce you to my little pet here?"</p>' + "<p>You recognize her 'pet' as the young woman...Serena? Seraphina?...that you met in the Wild Ranges while she was hiking.</p>")
			}
			if (this.checkFlag(1)) {
				md.write("<p>The thrall begins to minister to her Mistress.  Within seconds the strong scent of Jesse's <i>scent</i> begins to assail your senses.</p>" +
					"<p>You can feel yourself quickly losing control, the power of the demon once again beginning to assert itself over your mind.  Kurndorf's warning echoes in your ears, but the longer you hover within reach of her, the less that voice is able to overcome her influence.</p>");
				if (this.checkFlag(2)) md.write('<p>"Come to Us, ' + myName + '," she hisses into your ear. "Kiss Us, ' + myName + '," she says, her eyes and her smell drawing you in.</p>')
			}
			startQuestions();
			if (!this.checkFlag(2)) {
				if (!this.checkFlag(1)) addQuestionC(md,
					'"How?  What did you do to her?"', "Jesse", 1841);
				else addQuestionC(md, '"How did you do it?  Enthrall them?"', "Jesse", 1841);
				if (this.getDemonPath() == 31) addQuestionC(md, '"What are you doing here, Jesse?"', "Jesse", 14431);
				addLinkToPlace(md, "leave Jesse to her fun", 63)
			} else {
				addQuestionC(md, '"Shove off, Legion.  I <i>know</i> what you are, remember?"', "Jesse", 1842);
				addLinkToPlace(md, "Kiss the creature", 995)
			}
			WritePlaceFooter(md);
			return true
		}
		if (Place != 375) return false;
		if (sType == "checkjesse") {
			md = WritePlaceHeader(false,
				"td-none");
			addPlaceTitle(md, "Checking on Jesse");
			md.write("<p>You decide to check on how Jesse is at the moment...</p>");
			var s = this.showPersonArray(["jesse-sick1.jpg", "jesse-sick2.jpg", "jesse-sick3.jpg", "jesse-sick4.jpg"], "80%", "center");
			if (s.indexOf("jesse-sick1.jpg") != -1) md.write('<p>Jesse is lying on the bath, she has been sick and has washed herself. She looks weak and is awake but any attempt to talk to her only gets simple responses like "ok", "sure" but nothing more. You help her back to bed and she falls asleep immediately.</p>');
			else md.write("<p>Jesse is asleep in the bed, you try to gently wake her, but she does not respond. She seems to be otherwise well, just exhausted..</p>");
			startQuestions();
			addLinkToPlace(md, "that is enough", 375);
			addLinkToPlace(md, "walk back to the bar", 124);
			addLinkToPlace(md, "leave the hotel", 123);
			WritePlaceFooter(md);
			return true
		}
		return false
	};
	per.showPersonChat = function(bGeneral, md) {
		if (Place == 124) {
			if (!this.checkFlag(10) && !isNight()) addPopupLinkC(md, "introduce yourself to the girl", "Jesse", "<img src='Images/jesse1c.jpg' class='imgpopup' alt='Jesse'>" +
				"You approach the girl, as you do she gestures to you to step out of the noisy bar and you leave with her to the nearby beer-garden.<br><br>" + '"Hi there ' + perYou.getPersonName() + '," says the young girl. "My name is Jesse. This place is so boring. I wish that there was something exciting to do around here."<br><br>' + "Now if this was your friend Catherine speaking you would have taken what she said as a proposition, but Jesse seems so innocent, it was more like an invitation to play a game. You ask her why she is here if it is so boring,<br><br>" +
				'"I\'m here in town with my father, while he is here on business. He thought I would enjoy it here while he is off in his meetings, there are a lot of stories about witches and ghosts around here and I love those spooky stories!"<br><br>' + "You look at her innocent smile, and you suspect she may get more than 'spooked' here in town.", false, "setPersonFlag('Jesse', 10);dispPlace();");
			if (perKurndorf.getQuestSeance() == 19 && this.checkFlag(10) && !isNight()) addQuestionC(md, '"Hey Jesse, wanna see a <i>secret room</i> I found?"',
				"Jesse", 12101)
		}
		if (Place == 45 && this.whereNow() == 6) addLinkToPlaceC(md, "check on your <i>visitor</i> in the living room", 374, "", "", "", "Leave45()");
		if (Place != 375 || sType !== "") return;
		if (!isDemonBound()) {
			if (this.checkFlag(1)) addQuestionC(md, 'Interrupt her - "Uhm...  May we talk?"', "Jesse", 18421);
			else if (this.getDemonPath() < 500 && !this.checkFlag(5)) {
				if (this.getDemonPath() == 151) addQuestionC(md, "\"I'm afraid I don't have it <i>on</i> me.\"", "Jesse", 144151);
				if (!this.checkFlag(9)) addQuestionC(md, '"Restore Leanne first!"',
					"Jesse", 19E3);
				if (!this.checkFlag(2)) addQuestionC(md, '"Why did you want this thing again?"', "Jesse", 18422);
				if (!this.checkFlag(3)) addQuestionC(md, '"What does it do?"', "Jesse", 18423);
				if (!this.checkFlag(4)) addQuestionC(md, '"If I give it to you, then you are bound by <i>contract</i> to leave and do no harm here. Right?"', "Jesse", 18424);
				if (!this.checkFlag(5)) addQuestionC(md, '"Don\'t let me keep you from enjoying your <i>pet</i>"', "Jesse", 18425);
				if (perYourBody.FindItem(48) > 0) addQuestionCO(md, "give <i>Legion</i> the relic",
					"Jesse", 481)
			} else if (this.checkFlag(5)) addQuestionCO(md, "give her a moment and enjoy the show", "Jesse", 18426);
			return
		}
		if (this.getDemonPath() >= 500 && this.getDemonPath() < 600) {
			addLinkToPlace(md, "check on Jesse", 375, "type=checkjesse");
			return
		}
		if (this.getDemonPath() == 601) addQuestionC(md, "ask about Lucy", "Jesse", 12200);
		else if (this.getDemonPath() == 602) addQuestionC(md, '"How are you feeling"', "Jesse", 12201);
		else if (this.getDemonPath() == 603) addQuestionC(md, "\"Do you remember anything more of the 'party'\"", "Jesse",
			12202);
		else if (checkPlaceFlag("Hotel", 11)) addLinkToPlaceC(md, '"Jesse, feeling up to going for a swim?"', 269, "type=jessepool")
	};
	per.handleItem = function(no, cmd) {
		if (no == 14 && cmd == 2) {
			if (Place == 161 && this.isHere()) {
				addComments("You cast the spell but it seems to bounce off of her, it is like she is immune somehow...  She seems so...  innocent.");
				return "handled"
			}
			if (Place == 375) {
				if (perJesse.getDemonPath() < 500) addComments("You attempt to cast the spell, but if fails to take effect... Evidently the spell is not powerful enough to affect a demon.");
				else ddComments("You attempt to cast the spell, but if fails to take effect Jesse is still affected by the aftermath of her possession.</p><p>The thrall, has no will or apparently a soul and the spell is not needed, and also does not work.");
				return "handled"
			}
			if (Place == 340 || Place == 341 || Place == 63 && sType == "jessepark" || Place == 374 && this.isHere()) {
				addComments("You attempt to cast the spell, but if fails to take effect... Evidently the spell is not powerful enough to affect a demon.");
				return "handled"
			}
		}
		return ""
	};
	per.addPersonPhoneCall = function() {
		if (this.getDemonPath() == 150 && this.place == 10)
			if (!this.checkFlag(14)) {
				if (makeCall(false, "unknown", '"Hello," says the voice, and a familiar chill runs down your spine. "We know you have it...We want it... We have been watching you.  We are waiting for you at the Broken Inn Hotel.  Bring it to us..."' + '"We can feel it ummm, just like we can feel this slut on our...mmmmmm"<br><br>' + addOptionLink("string", "clit?", "setTimeout(JesseNonTG, 100)") + addOptionLink("string", "cock?",
						"setTimeout(JesseTG, 100)"))) {
					this.moveThem(8);
					this.setFlag(13, false);
					this.setFlag(14);
					wanderLeanne();
					return true
				}
			} else {
				if (makeCall(false, "unknown", '"Hello," says the voice, and a familiar chill runs down your spine. "We know you have it... We have been watching you.  We are waiting for you at the Broken Inn Hotel.  Bring it to us..."')) {
					this.moveThem(8);
					wanderLeanne();
					return true
				}
			}
		else if (this.checkFlag(13))
			if (makeCall(false, "unknown", '"Very close, you are getting very close...," says the voice, and a familiar chill runs down your spine. "We can feel it, just like we can feel this slut on our...mmmmmm"<br><br>' +
					"You cannot quite make out what she said next, her moan made it hard to hear...Was it...." + addOptionLink("string", "clit?", "setTimeout(JesseNonTG, 100)") + addOptionLink("string", "cock?", "setTimeout(JesseTG, 100)"))) {
				this.setFlag(13, false);
				this.setFlag(14);
				return true
			}
		return false
	};
	per.getPersonSMS = function(id) {
		if (id == 60) return receiveSMS("...", "pussy slut", "jessesms1.jpg");
		if (id == 61) return receiveSMS("...", "cock slut", isExplicit() ? "Explicit/jessesms1dg.jpg" : "jessesms1.jpg");
		if (id == 62) return receiveSMS("...",
			"pussy slut", "jessesms3.jpg");
		if (id == 63) return receiveSMS("...", isExplicit() ? "cock slut" : "cum drinking cock slut", isExplicit() ? "Explicit/jessesms3dg.jpg" : "jessesms3dg.jpg");
		return ""
	}
}

function RepliesJessica(nR) {
	var myLord = per.getYourNameFor();
	if (nR == 1E3) {
		per.setFlag(5);
		addComments('"The name is Jessica, but let\'s not talk about me now...", the woman says.</p>' + '<p>"Are you the one who I think you are? The one whose power will be even greater than mine in time? The true ' + perYou.getMaster() + " of Glenvale? I know, I can feel it! You are " + myLord + '!", Jessica continues and sinks down into a kneeling position.</p>' + '<p>"What?" you answer, confused by the woman\'s questioning. Jessica begins to eye you suspiciously before you correct yourself, "I mean... uh...  You must be the witch, the one Kurndorf imprisoned here. I want you to help me defeat Davy Robbins. He plans on ruining everything."')
	} else if (nR ==
		12600) {
		addComments('"I have so little mana but you may have what\'s left of my power," she says.  You can feel your power growing (20 mana) as she concentrates on you for a moment.  "There.  It is yours," she says.<br>');
		if (!per.checkFlag(3)) {
			AddMana(20);
			per.setFlag(3)
		}
	} else if (nR == 12500) {
		per.other = 1;
		addComments('"Yes it is true, the foul Kurndorf returned after his death and trapped me in this jail. I have existed here ever since."<br>')
	} else if (nR == 12502) {
		per.other = 10;
		addComments("\"I used Kurndorf's own magic to summon and possess the gunman, who killed the warlock. After Kurndorf's death he discovered what I had done and cast the wicked spell from beyond.\"<br>")
	} else if (nR ==
		12510) {
		per.other = 11;
		perKurndorf.setQuestSeance(16);
		addComments('"You must call the warlock back from beyond ' + myLord + '", claims Jessica. "To do that, you must learn the art of s\u00e9ance and bring a sacrifice to this chamber. I will aid you in the ritual. Though beware, Kurndorf is dangerous, even after death."')
	} else if (nR == 12511) {
		per.other = 11;
		perKurndorf.setQuestSeance(16);
		per.setFlag(1);
		addComments('"Thank you ' + myLord + " for asking, it has been a long time since someone was kind to me. The only way is to call the warlock back from beyond, " +
			myLord + ' and that should weaken my prison" claims Jessica. "To do that, you must learn the art of s\u00e9ance and bring a sacrifice to this chamber. I will aid you in the ritual. Though beware, Kurndorf is dangerous, even after death."')
	} else if (nR == 5910) {
		perDavy.setQuestBlueBottle(perDavy.getQuestBlueBottle() + 1);
		addComments('<p>"You have found the blue bottle!" exclaims Jessica. "It is the very same bottle that was used to imprison Kurdorf\'s power so that he could be killed."</p>');
		if (perDavy.getQuestBlueBottle() ==
			11) addComments('<p>"Oh no," she cries after taking a closer look.  "The seal has been broken. Kurndorf\'s power must be unleashed into the world.  Who knows what someone could do with that much power..."</p>');
		else if (perDavy.getQuestBlueBottle() == 21) addComments('<p>"Hmm... the seal is broken, but the power is still held within. ' + myLord + ', you could do amazing things with the power held in that bottle, but not before we destroy Kurndorf forever.<p>"')
	} else if (nR == 2749) {
		perKurndorf.setQuestSeance(49);
		Place = 339
	} else if (nR == 2750) {
		movePerson("Jesse", 0);
		perKurndorf.setQuestSeance(50);
		perYourBody.RemoveItem(26);
		perKurndorf.setQuestGhost(1)
	}
	return true
}

function initialiseJessica() {
	addPerson("Jessica", 193);
	per.extra = [0, 0];
	per.Replies = RepliesJessica;
	per.getYourNameFor = function() {
		return perYou.getLord()
	};
	per.getPersonName = function(full) {
		return full !== true && this.isCharmedBy() ? "Jessica Enslaved" : "Jessica the Witch"
	};
	per.startRival = function() {
		this.place = 1E3;
		this.extra[1] = 1
	};
	per.startAlly = function() {
		this.place = 161;
		this.extra[0] = 1
	};
	per.isRival = function() {
		return this.extra[1] > 0
	};
	per.getRivalry = function() {
		return this.extra[1] > 0 ? this.extra[1] : this.extra[0]
	};
	per.setRivalry = function(no) {
		if (this.extra[1] !== 0) this.extra[1] = no;
		else this.extra[0] = no
	};
	per.showEvent = function() {
		var md;
		if (Place == 161 && sType == "playjessica") {
			md = WritePlaceHeader(false, "td-left-any");
			if (perYou.isMaleSex()) this.showPersonRandom("jessica4", 5, "30vw,30vw,30vw,30vw,50vw");
			else this.showPersonRandom("jessica5", 5, "30vw,30vw,50vw,50vw,30vw");
			addPlaceTitle(md, "Playing with your Witch-Toy");
			md.write("<p>You play with your bound witch-toy.</p>" + '<p style="font-size:x-small">Actual scenes to be implemented</p>');
			startQuestions();
			addLinkToPlaceC(md, "that is all for now", 161);
			WritePlaceFooter(md);
			return true
		}
		return false
	};
	per.handleItem = function(no, cmd) {
		if (no == 14 && cmd == 2)
			if (Place == 193) {
				addComments("A spell of this magnitude has no effect on true witches. You will need something much more powerful!");
				return "handled"
			}
		return ""
	}
}

function RepliesJohnAdams(nR) {
	var perJ = per;
	var myName = perJ.getYourNameFor();
	var perT = findPerson("Tess");
	if (nR == 10301) {
		PlaceI(32, 230);
		perJ.setFlag(1);
		addComments('"Of course, ' + myName + '.  Everything I have is yours.  I took this from the museum to show it to my wife, I believe it may be magical as it seemed to glow when it was near the talking worm."</p>')
	} else if (nR == 10400) {
		perJ.other = 1;
		addComments('<p>"Oh right, Tess told you about my collection. Yes I am thinking of donating my discoveries to the museum," John says, pleased that you have asked him about his hobby.</p><p>"Here, let me show you a very special piece. It\'s an old silver ring and if I didn\'t know better I say it almost glowed when it was near that worm thing...Odd, it now seems to be glowing again...and more when it is near Tess."</p>' +
			"<p>\"I found it in an estate auction of an old Glenvale family where the last member died with no heirs. The ring was hidden in an old box in a secret compartment along with some old papers. Once referred to the ring as the 'free' ring and another as 'the ring of the inner eye', but nothing more. It is quite an old design but hard to date, it could be centuries old, or made last year, though I am sure it is more likely to be centuries.\"</p>")
	} else if (nR == 10401) {
		perJ.other = 2;
		addComments("<p>\"I'm sorry " +
			myName + ' but it really belongs to the museum," John says.</p>')
	} else if (nR == 10402) {
		if (!(whereItem(32) !== 0 || perYourBody.FindItem(32) > 0)) {
			if (perJ.other < 5) perJ.other = 5;
			PlaceI(32, 230);
			bChatLeft = false;
			addComments("<p>Tess jumps her husband to snatch the ring out of his hand. As the lovely klutz she is, she drops it. Fortunately she does just before John grabs it back from her.</p>")
		}
	} else if (nR == 10405) {
		if (perJ.other < 6) perJ.other = 6;
		addComments('<p>"Of course I like the way she is dressed," he says, eyeing you suspiciously and obviously wondering why you brought it up.</p><p>"Although she keeps changing outfits today. Why do you ask?"</p>')
	} else if (nR ==
		10406) {
		perJ.other = 7;
		addComments('<p>"I don\'t believe it," he says in suprise.</p><p>"Then again she has never dressed in sexy clothes before. I was beginning to like the new and improved Tess. Not likely though." His pride and self-confidence flare up for a moment as he glares at you.</p><p>"Prove it." He says defiantly.</p>')
	} else if (nR == 10408) {
		perJ.other = 9;
		perT.other = 28;
		addComments('<p>John moves forward to strike you, his anger suddenly flaring as he realises how much control you have over his wife.  "Get the HELL out of my house, you freak!" He bellows.</p>')
	} else if (nR ==
		10409) {
		perJ.other = 20;
		perT.other = 30;
		perJ.place = 1E3;
		bChat = false;
		addComments(perJ.addPersonFace());
		if (perJ.isCharmedBy()) addComments('"Yes, ' + myName + ".  I'll get right on that,\" he says moving quickly to begin his task.  It would seem you have proven once and for all who was <i>really</i> in control here.</p>");
		else addComments('"All right. Fine," he says rather angrily as he leaves to search for more magic, having proven to him who is <i>really</i> in charge here.</p>')
	}
	return true
}

function initialiseJohnAdams() {
	addPerson("John Adams", 0, "JohnAdams", "Male");
	per.Replies = RepliesJohnAdams;
	per.getPersonGender = function() {
		return this.checkFlag(4) ? "woman" : "man"
	};
	per.getNextDress = function(drs) {
		return this.checkFlag(4) ? this.checkFlag(6) ? "Female2" : "Female1" : "Male"
	};
	per.getPersonName = function(full) {
		if (full !== true) return this.checkFlag(5) ? "Joan" : "John";
		else {
			if (this.checkFlag(5)) return this.isCharmedBy() ? "Joan Adams, your Slave" : "Joan Adams";
			return this.isCharmedBy() ? "John Adams, your Slave" :
				"John Adams"
		}
	};
	per.getPersonAddress = function() {
		return isPlaceKnown("AdamsHouse") ? "2121 Rathdown Rd, Glenvale" : ""
	};
	per.getPossessionFace = function() {
		if (this.isCharmedBy()) return "john11";
		return "john10"
	};
	per.isPersonInfo = function() {
		return this.isCharmedBy()
	};
	per.getPersonInfo = function() {
		if (this.dress == "Male") return "<img src='Images/People/JohnAdams/Male/john3.jpg' class='imgpopup' alt='John'>" + "John is your slave, the once proud husband of Tess now finally joined her in serving your wishes. A male slave could come in handy once in a while, especially after all those girls you have enslaved. Maybe John could be your harem guard or even better, he could be your bodyguard. You could always use one.";
		else return "<img src='Images/People/JohnAdams/" + this.dress + "/john3.jpg' class='imgpopup' alt='John'>" + this.getPersonName(true) + " is your slave, the once proud husband of Tess now finally joined her in serving your wishes. Now <b>she</b> is a " + (this.checkFlag(6) ? "slim woman" : "very large breasted woman") + " who has joined your harem!"
	};
	per.showEvent = function() {
		var md;
		var nmJ = this.getPersonName(false);
		if (Place == 269 && sType == "johnpool") {
			WaitHereOnly(4);
			md = WritePlaceHeader();
			this.showPerson("john-pool.jpg");
			addPlaceTitle(md, "Swimming with " + nmJ + "");
			if (this.isMaleSex()) md.write("<p>John arrives dressed more in shorts, but says he can change into bathers when you decide to swim. He takes a seat to have a chat first</p>");
			else if (this.checkFlag(6)) md.write("<p>" + nmJ + ' arrives dressed in a blue bikini to your surprise, <i>she</i> has really take to this "being a woman thing".</p>');
			else md.write("<p>" + nmJ + ' arrives dressed in a white bikini to your surprise, <i>she</i> has really take to this "being a woman thing".</p>');
			startQuestions();
			if (this.getCharmedLevel() == 2) addLinkToPlaceC(md, "it is fairly private here...", Place, "type=johnpoolsex");
			addLinkToPlaceC(md, "chat and say goodbye to " + nmJ, Place);
			WritePlaceFooter(md);
			return true
		}
		if (Place == 269 && sType == "johnpoolsex") {
			md = WritePlaceHeader();
			this.showPerson("john-pool-sex.jpg");
			addPlaceTitle(md, "Being Discrete and Private with " + nmJ);
			md.write("<p>You ask " + nmJ + " to play with you more privately, and ");
			if (this.isMaleSex()) md.write("he seductively removes his shorts and top, ready for you.</p>");
			else md.write("she does an awkward strip-tease, still self-conscious of her breasts and <i>not</i> being a man.</p>");
			startQuestions();
			addLinkToPlaceC(md, "later...say goodbye to " + nmJ, Place);
			WritePlaceFooter(md);
			return true
		}
		if (Place != 230) return false;
		if (sType == "johncharm1") {
			md = WritePlaceHeader();
			this.other = 9;
			this.showPerson("john2.jpg");
			addPlaceTitle(md, "Charmed John Adams");
			md.write("<p>You mumble the spell, every word trickling off your tongue like water from crystal.</p>" + '<p>"What are you doing!" exclaims John. "I feel kind of weird. My mind! I can\'t think straight. Your words are some kind of magic. Please stop. I..."</p>');
			startQuestions();
			addLinkToPlace(md, "wait the spell to take effect", 230, "type=johncharm2");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "johncharm2") {
			md = WritePlaceHeader();
			this.showPerson("john3.jpg");
			addPlaceTitle(md, "Charmed John Adams");
			md.write("<p>John's confusion begins to fade as an excitement courses through his body.</p>" + "<p>\"Do you know that I've always dreamed about a threesome with Tess and another " + perYou.getManWoman() + '" he says. ');
			if (perYou.isBornMale()) md.write("\"I never realized how erotic it was to be someone's boy toy before, but then again you are so fucking handsome " +
				perYou.getPersonName() + '.  I could let you use me all night and still not get enough."</p>');
			md.write('<p>"My cock feels so hard just thinking about it. I have to have you."</p>');
			startQuestions();
			if (wherePerson("Tess") == 230)
				if (perYou.isBornMale()) addLinkToPlace(md, "receive John's affections <b>only</b> with Tess", 230, "type=johnsex&with=onlytess");
				else addLinkToPlace(md, "receive John's affections with Tess", 230, "type=johnsex&with=both");
			else if (perYou.isBornMale()) addLinkToPlace(md, "receive John's affections <b>only</b> with Tess",
				230, "", "Tess is not here so you will leave it there and accept John no further.");
			addLinkToPlace(md, "receive John's affections", 230, "type=johnsex&with=john");
			addLinkToPlace(md, "exit the Adams home", 229);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "johnsex") {
			var swith = getQueryParam("with");
			if (swith == "john") {
				md = WritePlaceHeader(false, this.dress == "Male" ? "" : "td-left-med");
				if (this.getCharmedLevel() == 1) this.charmThem(2);
				this.showPerson("john4.jpg");
				addPlaceTitle(md, "Making Love with " + nmJ + " Adams");
				if (this.isMaleSex())
					if (perYou.isMaleSex()) md.write("<p>You take John into the Adams' bedroom to enjoy some time with your male lover, time he is overjoyed to share with you. As you close the door John is quick to take off his shirt and cast it off to the side. Casually you discard your own shirt as the man steps toward you. His eyes drinking in the sight of your masculine body while his fingers tenderly brush along your chest. \u201cI've missed you,\u201d he whispers. John's lips instinctively press against your chest in a foray of passionate kisses. A man possessed with the need to drink in the feeling and taste of his lover's skin.</p>" +
						"<p>Moaning from the inflamed actions of your lover, your hand wraps around the back of his head to caress and encourage his attention upon your body. He fumbles with your pants for a moment before releasing your cock from their confines. His head slipping from your fingers as his lips traverse down the front of your chest. Already anticipating his next act you once again moan as John wraps his lips around your cock. Focused upon your pleasure his head pulls back as his lips nurse the head of your cock, almost nursing it. It takes little time for your body to further respond as your cock stands fully erect.</p>" +
						"<p>John lovingly explores your cock with his mouth, slowly edging himself further along your length. A deep moan escapes you as he lovingly tends to you. But you can't simply let John spend all his time focused on you... you want to play with him. As he accepts more of your cock into his mouth you let out a slight gasp as you try to speak, \u201cStrip for me and kneel on the bed.\u201d</p>" + "<p>Hesitantly he stops his attentions upon your flesh to comply with your wishes. His own cock springs to life as his pants hit the floor. As if anticipating what you want he turns and kneels on hands and knees upon the bed with his ass facing you. While you enjoy the view a mischievous thought comes to mind you simply must do. As you move behind him you hold your cock up before letting it fall between his ass cheeks. Your left hand reaching down to pull his torso up. Teasingly you whisper into his hear, \u201cI have other ideas, lover.\u201d</p>" +
						"<p>Moving to wrap your hand around John's cock you slowly begin to stroke over the surface. The warm and soft skin gliding beneath your fingers. He moans and leans back against you, absently stroking your length with the cheeks of his rear. \u201cI want you to cum for me,\u201d you growl into his ear.</p>" + "<p>He smiles within the throes of his bliss at your hand stroking his cock. Easily taking to the rhythm of your hand to stroke your cock resting between his cheeks. His chest sliding off to the side to allow him to look at you. An arm reaches behind him in effort to hold your face close to his.</p>" +
						"<p>\u201cOh " + perYou.getPersonName() + ",\u201d he gasps as his orgasm begins. Your hand quickly aiming up as the first thick rope of cum explodes from John's cock, landing across his chest and a small portion of your cheek. A second and third follow, striking John's chest as you continue to milk his cock. Absently his arm retracts from you as he wipes the cum from your cheek. Without a pause he cleans it from his finger, \u201cYou are such a wonderful lover, " + perYou.getPersonName() + "...\u201d</p>" +
						"<p>You chuckle slightly as you tell him you must leave. Unfortunately you have other matters to attend to but will be back. You hear John confess his love and desire for you to come back as soon as you can, leaving him to clean up the mess of his orgasm.</p>");
					else if (wherePerson("Tess") == 230) md.write("<p>You ask Tess to leave so you and John can speak privately. After she leaves little speaking takes place as you make love with John. He repeatedly confesses his love to you making no mention of Tess.</p>");
				else md.write("<p>You ask John to speak privately in the bedroom. Little speaking takes place as you make love with John. He repeatedly confesses his love to you making no mention of Tess.</p>");
				else if (perYou.isMaleSex()) md.write("<p>You take " + nmJ + " into the Adams' bedroom to enjoy some time with your female lover, time she is overjoyed to share with you. As you close the door " + nmJ + " is quick to take off her top and cast it off to the side. Casually you discard your own shirt as the woman steps toward you. Her eyes drinking in the sight of your masculine body while her fingers tenderly brush along your chest. \u201cI've missed you,\u201d she whispers. " +
					nmJ + "'s lips instinctively press against your chest in a foray of passionate kisses. A woman possessed with the need to drink in the feeling and taste of her lover's skin.</p>" + "<p>Moaning from the inflamed actions of your lover, your hand wraps around the back of her head to caress and encourage her attention upon your body. She fumbles with your pants for a moment before releasing your cock from their confines. Her head slipping from your fingers as her lips traverse down the front of your chest. Already anticipating her next act you once again moan as " +
					nmJ + " wraps her lips around your cock. Focused upon your pleasure her head pulls back as her lips nurse the head of your cock, almost nursing it. It takes little time for your body to further respond as your cock stands fully erect.</p>" + "<p>" + nmJ + " lovingly explores your cock with her mouth, slowly edging herself further along your length. A deep moan escapes you as she lovingly tends to you. But you can't simply let " + nmJ + " spend all her time focused on you... you want to play with her. As she accepts more of your cock into her mouth you let out a slight gasp as you try to speak, \u201cStrip for me and kneel on the bed.\u201d</p>" +
					"<p>You chuckle slightly as you tell her you must leave. Unfortunately you have other matters to attend to but will be back. You hear " + nmJ + " confess her love and desire for you to come back as soon as you can.</p>");
				else if (wherePerson("Tess") == 230) md.write("<p>You ask Tess to leave so you and " + nmJ + " can speak privately. After she leaves little speaking takes place as you make love with " + nmJ + ". She repeatedly confesses her love to you making no mention of Tess.</p>");
				else md.write("<p>You ask " +
					nmJ + " to speak privately in the bedroom. Little speaking takes place as you make love with " + nmJ + ". She repeatedly confesses her love to you making no mention of Tess.</p>")
			} else {
				md = WritePlaceHeader();
				if (swith == "both") this.charmThem(2);
				if (isExplicit()) AddImageRandomX(perYou.isMaleSex() && this.isMaleSex() ? "GenericSex/sex-mmf threesome " : "GenericSex/sex-mff threesome ", 3);
				else if (perYou.isMaleSex() && this.isMaleSex()) AddImage("GenericSex/sex-mmf threesome blonde hair-a.jpg");
				else if (perYou.isMaleSex()) AddImage("GenericSex/sex-mff threesome a.jpg");
				else AddImage("GenericSex/foursomea.jpg");
				addPlaceTitle(md, "Making Love with the Adamses");
				md.write("<p>You join the Adamses in their love making and for a long time you learn what it could be like to be married. Both " + nmJ + " and Tess confess over and over that they are madly in love with you and declare their servitude forever.</p>");
				if (swith == "onlytess" && perYou.isBornMale()) md.write("<p>You make it clear to " + nmJ + " that there will be nothing sexual with him unless Tess is also involved.</p>")
			}
			startQuestions();
			addLinkToPlace(md, wherePerson("Tess") == 230 ? "talk to the Adamses a bit more" : "talk to " + nmJ + " a bit more", 230);
			addLinkToPlace(md, "exit the Adams home", 229);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "johntransformgender1") {
			CastTransform(1);
			md = WritePlaceHeader(true, "", "black");
			showPopupWindow("Transformation", '<img src="Images/GenericSex/tg a.gif" style="width:50%;float:left;margin-right:6px;margin-top:1em;margin-bottom:2em" alt="TG">' + "You cast the spell and John cries out and he strips off his clothing. As you watch his body changes, growing plusher and you see his cock shrinking. His chest expands as you see large breasts grow and his face softens to a feminine appearance.</p>" +
				"<p>As you watch <i>her</i> figure changes, becoming slimmer, her breasts shrinking. It seems to settle for a moment and then fills out again as if it is uncertain on it's final form, but no matter what John is a <b>he</b>, now <b>she</b> is very definitely female, nothing masculine is left, she is completely a woman!</p>" + "<p>She looks quite confused, has John been affected mentally by this? How does John's form finally settle down?</p>" + '<div style="clear:both;">' + addOptionLink("string", "large breasted figure",
					"setPersonFlag('JohnAdams',4);dispPlace(Place,'type=johntransformgender2')", "chatblock") + addOptionLink("string", "slim figure", "setPersonFlag('JohnAdams',4);setPersonFlag('JohnAdams',6);dispPlace(Place,'type=johntransformgender2')", "chatblock") + "</div>", "", "", true, true);
			setQueryParams("");
			WritePlaceFooter(md, "", true, true);
			return true
		}
		if (sType == "johntransformgender2") {
			md = WritePlaceHeader(true, "", "black");
			if (this.checkFlag(6)) this.dress = "Female2";
			else this.dress = "Female1";
			showPopupWindow("Transformation",
				'<img src="Images/People/JohnAdams/' + this.dress + '/xf1.jpg" class="imgpopup" alt="TG2">' + (!this.checkFlag(6) ? "John's body shifts, fills out and her breasts grow very large, and she sits there, cradling them. You would guess G cup...you notice his clothing was also changed by the spell but it hard to say exactly how." : "Johns body shift, growing slimmer and feminine with slight breasts. Her hair grows longer and you notice his clothing was also changed by the spell but it hard to say exactly how.") +
				' She says,</p><p>"I feel different, but I do not quite know how. I remember my job, my family, my...wife...but these seem..wrong. I am...also finding it hard to remember some other things, my wifes name...my name...Adams is my last name. Joe..John..Joan..John seems best but this body does not belong to a John...</p>' + "<p>She seems to be in a bit of a confused state, her memories were affected, this is an opportunity to help or manipulate as you prefer. So you tell her what her name is..." + addOptionLink("string",
					'"John"', "setPersonFlag('JohnAdams',5,false);dispPlace(Place,'type=johntransformgender3')", "chatblock") + addOptionLink("string", '"Joan"', "charmPerson('JohnAdams',2);setPersonFlag('JohnAdams',5);dispPlace(Place,'type=johntransformgender1p3')", "chatblock"), "", "", true, true);
			setQueryParams("");
			WritePlaceFooter(md, "", true, true);
			return true
		}
		if (sType == "johntransformgender3") {
			md = WritePlaceHeader(true, "", "black");
			showPopupWindow("Transformation", '<img src="Images/People/JohnAdams/' + this.dress + '/xf2.jpg" class="imgpopup" alt="TG3">' +
				(!this.checkFlag(5) ? "You tell her that her name is John, and your slave and lover. You make no mention of Tess, and emphasise <b>her</b> devotion to you." : "You tell <b>her</b> that her name is Joan, you large breasted slut and devoted slave. You stress that she has never been married and you are all she desires.") + "</p><p>She looks at you, her confusion lifting and she stands and asks to excuse her as she goes and dresses again. She bends over and picks up her clothing and steps out for a few minutes to dress. It sounds like she has some difficulty dressing and you offer to assist. She refuses and a few minutes later rejoins you.",
				"dispPlace()", "", true);
			setQueryParams("");
			WritePlaceFooter(md, "", true, true);
			return true
		}
		return false
	};
	per.handleItem = function(no, cmd) {
		if (cmd == 1 && (no == 52 || no == 64)) {
			var s = getSoulBoundCrystal(no);
			if (s != "")
				if (this.isHere() && !this.checkFlag(4)) {
					examineItem(no, "The " + s + " vibrates softly the closer you get to John.");
					return "handled"
				}
		}
		if (no == 18 && cmd == 2) {
			if (this.isHere()) {
				if (this.checkFlag(4)) {
					addComments("You have already transformed <b>her</b>!");
					return "handled"
				}
				if (!this.isCharmedBy()) {
					addComments("The spell washes over him but nothing happens, you seem to need a magical link to him");
					return "handled"
				}
				if (wherePerson("Tess") == 230) {
					addComments("Tess is here, you should do this when she is not around");
					return "handled"
				}
				if (!CastTransform(1, true)) return "handled";
				ClearComments();
				dispPlace(Place, "type=johntransformgender1");
				return "nofooter"
			}
		} else if (no == 14 && cmd == 2)
			if (Place == 230) {
				if (perYou.checkFlag(19)) CastCharmSpell("JohnAdams", 230, 1, "type=johncharm1");
				else addComments("The spell fails to work on John Adams as the spell only affects the feminine.");
				return "handled"
			}
		return ""
	};
	per.isPhoneable =
		function() {
			return checkPlaceFlag("Hotel", 11) && Place == 269 && this.isCharmedBy() && this.place == 230
		};
	per.callThem = function() {
		if (Place == 269) {
			gotoPlace(Place, "type=johnpool");
			receiveCall("", "You call " + nmJ + ' to invite him to join you at the pool for a swim, and he answers, "Sure, why not!" and promises to be there soon.');
			WriteCommentsFooter(bChat, bChatLeft)
		}
	}
}

function FreeKate() {
	var perKate = findPerson("Kate");
	perKate.setFlag(31);
	perKate.unCharmThem()
}

function isKateTrusting() {
	var perKate = findPerson("Kate");
	if (perKate.isCharmedBy("Davy") || perKate.checkFlag(4) || perKate.checkFlag(12)) return false;
	return perKate.checkFlag(1) && perKate.checkFlag(2) && perKate.checkFlag(5) && perKate.checkFlag(11) && perKate.checkFlag(31)
}

function KatesHome() {
	movePerson("Kate", 139.5);
	startTimedEvent("KatesGone()", 4);
	if (Place == 35)
		if (!isInvisible() && !perYou.checkFlag(16)) {
			Place = 35;
			setQueryParams("type=clobberedvisible")
		} else {
			Place = 139;
			setQueryParams("type=katepacking")
		}
}

function KatesGone() {
	if (!isCharmed("Kate")) movePerson("Kate", 9999)
}

function RepliesKate(nR) {
	var perKate = per;
	if (nR == 540) {
		if (Math.random() < .5) addComments("<p>\"What's up! I don't have time for such silly nonsense! Let me pass imbecile!\"</p>");
		else addComments("<p>\"What's up! What do you mean 'What's up'??  I can't believe this, get out of my way you simpleton!\"</p>");
		if (perKate.other < 1) perKate.other = .5
	} else if (nR == 5401) {
		if (perKate.other < 1) perKate.other = 1;
		addComments('<p>"If you must know. I\'m studying for the mathematics exam next week."</p>')
	} else if (nR == 5402) {
		perKate.other =
			999;
		perKate.place = 1E3;
		if (perYou.isBornMale()) {
			PlaceI(5, 26);
			setPlaceFlag("Park", 3)
		}
		Place = 63;
		addComments('<p>"I heard what that juvenile said about me and it was horrible. You have a filthy mind and I never want to see you again!" she cries, turning to run away');
		if (!perYou.isBornMale()) {
			addComments(" then, surprisingly, turns around again and begins frantically digging through her backpack for something." + '  "Here," she says with tears welling up in her eyes.  "Davy said I had to give my address to all the girls that I knew so <i>take it</i>!"  Then, finally, she turns and runs away.  You can hear her begin to cry as she goes.');
			PlaceI(3, 63)
		} else addComments(".</p><p>As she leaves you notice a kite stuck in a tree, some kid must have lost it recently.</p>")
	} else if (nR == 541) {
		if (perKate.other < 3) perKate.other = 3;
		addComments('<p>"You got an A+! Excellent! I didn\'t know. Do you think that we could study together?"</p>')
	} else if (nR == 543) {
		if (perKate.other < 4) perKate.other = 4;
		perKate.place = 3;
		addComments('<p>"Yes," replies Kate. "That sounds like a great idea. I\'ll meet you there, don\'t take too long!"</p>');
		Place = 63
	} else if (nR ==
		5410) {
		perKate.other = 11;
		addComments('<p>"Davy told me not to say anything about it. After he... he said something about a Dai Chu, whatever that is. It was when we were... you know.. Davy told me that Mr Beasley taught him some magic and they found a stone buried in the park. I can\'t remember much more than that because it was all a blur."</p>')
	} else if (nR == 5411) {
		perKate.other = 12;
		perKate.place = 1E3;
		addComments('<p>"You really think so?" says Kate. "I\'m so glad you agree. I\'ll meet you back at my house."</p>');
		dispPlace(47, "")
	} else if (nR == 3201) {
		perKate.other = 12;
		perKate.place = 1E3;
		addComments('<p>"Oh my god!" Kate cries as you free her from Davy\'s control.  "The things he made me do!  I can\'t believe this, its not possible!" She says, running away from you before you can do anything to stop her.</p>')
	} else if (nR == 5415) {
		addComments('<p>"I met Davy on the way here. He said that magical word again and now I realize how much I love him. He even ordered me to give you something."</p>');
		perKate.other = 50
	}
	return true
}

function initialiseKateGranger() {
	addPerson("Kate", Math.random() < .7 ? 63 : 216);
	per.Replies = RepliesKate;
	per.getPersonName = function(full) {
		if (full === true) return "Kate Granger";
		var clv = this.getCharmedLevel();
		if (clv == 2) return "Kate";
		return clv == 4 ? "Slave Kate" : "Kate Granger"
	};
	per.getPersonAddress = function() {
		return isPlaceKnown("GrangerHouse") ? "34 Yoolaroo Dr, Glenvale" : ""
	};
	per.isPersonInfo = function() {
		return true
	};
	per.getPersonInfo = function() {
		if (!this.isCharmed() || !this.isCharmedBy("You")) return "<img src='Images/kate16a.jpg' style='width:25%;float:right;margin-left:5px' alt='Kate'>" +
			"Kate, your classmate and the hottest girl at school. She is smart but violent, but still you like her!";
		else if (this.getCharmedLevel() == 4) return "<img src='Images/kate18ca.jpg' style='width:30%;float:right;margin-left:5px' alt='Kate'>" + "Whew! It was a wild ride, but you finally caught Kate! She\u2019s your humble slave now, just the rest of girls you own. How long have you been dreaming about this moment. One of the prettiest girl in school is yours. Davy Robbins will no longer be an issue so Kate and you can have some time to spend together. She is just great in bed as you have imagined! You guess her mother has taught her well in the ways of pleasing a man. You should try a threesome with them one day!<br><br>" +
			"Kate is sitting on her bed as you have instructed her. She doesn\u2019t like to talk unless you ask her something. She\u2019s like a living statue waiting for your commands. You like it when she bows to you, she makes it so damn erotic! You just can\u2019t wait to jump on her!";
		else return "<img src='Images/kate16a.jpg' style='width:30%;float:right;margin-left:5px' alt='Kate'>" + "Kate has always been your crush for years now. She\u2019s the hottest girl in the school and a caring friend as you have heard from others. It\u2019s been a long journey, but you managed to charm her to become your girlfriend. She still has bad memories of being Davy\u2019s slave thus she can be a bit emotional at times. You reassured her that she is safe with you and Davy is no longer a threat to her. You jokingly added that by being your girlfriend she\u2019s technically the queen of your harem and domain. At first she laughed at the idea, but as she got to know you better by time she is interested in ruling along your side. Actually, she\u2019s not like the rest of your girls. She has a free will ( more or less ) and she has her own emotions and feelings that\u2019s not always about you. It is because she\u2019s girlfriend, not your slave. You like this relationship so far. You are still the dominant one in this affair and she\u2019s very loyal to you and your cause, but she has the mind of her own. It\u2019s so good to have someone that you can trust and can help you out or just someone who you can talk to!<br><br>" +
			"The two of you share a long, mouthful kiss when you enter the Granger house. Kate offers you fresh drinks and snacks all while she ushers you to sit down on her bed. She sits on your lap and clasps her hands around your back. You can tell she\u2019s been waiting for you all day, between kisses and hugs she asks about how your day went and what kind of new girl have you added to your army of slaves. The perfect girlfriend, she so thoughtful of you! You are in heaven!"
	};
	per.isPlaceImageRight = function() {
		return this.isHere() &&
			(this.whereNow() == 47 || this.whereNow() == 3 || this.whereNow() == 63 || this.whereNow() == 216)
	};
	per.showPlaceImageRight = function() {
		if (Place == 3) this.showPerson("kate3a.jpg", "100%", "", "", "Kate");
		else if (Place == 63 || Place == 216) this.showPerson("kate5.jpg", "100%", "", "kate1a.jpg");
		else if (Place == 47) this.showPerson("kate5.jpg", "100%", "", "kate4a.jpg")
	};
	per.whereNow = function() {
		if (this.place === 1) {
			if (this.other >= 15 && this.isCharmedBy("Davy")) return 108;
			return 139
		}
		return Math.floor(this.place)
	};
	per.getPossessionFace = function() {
		return "kate5"
	};
	per.showEvent = function() {
		var md, clv;
		if (sType == "katepool") {
			WaitHereOnly(6);
			md = WritePlaceHeader();
			this.showPerson(this.isCharmedBy("You") ? "kate-poolc.jpg" : "kate-poolu.jpg");
			addPlaceTitle(md, "Swimming with Kate");
			md.write("<p>Kate arrives and changes into her bikini, looking stunning, has she done something with her hair?</p>");
			startQuestions();
			addLinkToPlaceC(md, "say goodbye to Kate", Place);
			WritePlaceFooter(md);
			return true
		}
		if (Place != 139 && Place != 108) return false;
		this.setFlag(6);
		var perMG = findPerson("MrsGranger");
		perMG.setFlag(9, false);
		if (perMG.checkFlag(13)) {
			perMG.setFlag(12, false);
			perMG.setFlag(13, false)
		}
		var plcMG = perMG.whereNow();
		if (sType == "freed") {
			md = WritePlaceHeader();
			if (getQueryParam("plc") === "")
				if (perDavy.other == 6) perDavy.other = 7;
			this.place = 1E3;
			var bFreedBefore = getQueryParam("before") === "true";
			FreeKate();
			if (!isDavyDefeated())
				if ((this.other == 999 || this.other < 15) && isPlaceKnown("MechanicsShop")) {
					this.place = Math.random() < .5 ? 47 : 421;
					if (this.place == 421) setPlaceKnown("DuckPond");
					this.other = 10
				}
			AddMana(5);
			this.showPerson("kate17d.jpg");
			addPlaceTitle(md, "Kate Freed from Davy's Control!");
			if (getQueryParam("by") === "Tina") md.write("<p>Tina concentrates and, within moments, she absorbs the mana powering the <i>charm</i> over Kate.</p>");
			else md.write("<p>You clasp the ring with your fist. It glows and, within moments, it absorbs the mana powering the <i>charm</i> over Kate.</p>");
			md.write('<p>"I can\'t <i>believe</i> this!" She cries out as she dashes for the door.  "He did it <i>again</i>!  That <i><b>ASSHOLE</i></b>!!"</p>' + "<p>She immediately goes to leave, clearly with the intent of exacting revenge on Davy.</p>");
			startQuestions();
			if (bFreedBefore) {
				addLinkToPlaceC(md, "&quot;Wait!! I can protect you from Davy!&quot;", 139, "type=waitprotect");
				addLinkToPlaceC(md, "&quot;Wait!! I love you!&quot;", 139, "type=waitlove")
			}
			if (plcMG === 177) addLinkToPlace(md, "let her go and look for Mrs Granger", 177, "", "", "", "charmPerson('Kate',4,'Davy')");
			addLinkToPlace(md, "let her go and follow her out of the house", 43, "", "", "", "charmPerson('Kate',4,'Davy')");
			WritePlaceFooter(md);
			return true
		} else if (sType == "waitprotect") {
			md = WritePlaceHeader();
			this.showPerson("kate17f.jpg");
			addPlaceTitle(md, "Kate Hesitates");
			this.setFlag(13);
			md.write('<p>You call out to Kate, "Wait, don\'t go I love you and I can protect you!"</p>' + "<p>She hesitates and looks at you with a smile,  \"I..don't know how to answer that, I am so angry at that <b>bastard</b> I just want to pound his face ");
			if (isKateTrusting()) {
				md.write("but I do like you too, and maybe I was starting to fall... It is just Davy has messed with me and my emotions I do not know what to do.</p>");
				startQuestions();
				if (perYourBody.FindItem(43) !== 0) addLinkToPlaceC(md, "&quot;I can give you this necklace&quot;", 139, "type=waitprotectnecklace");
				addLinkToPlaceC(md, "&quot;I can protect you by casting Charm on you&quot;", 139, "type=waitprotectcharm")
			} else {
				this.setFlag(12);
				md.write("but I do not trust you. You seem to have some of the same abilities as Davy does and I do not know what you can or have done with them. Maybe I was starting to fall for you, but this has messed us around and I doubt I can ever trust someone with those powers ever again.</p>" +
					"<p>You try to reassure her of your feelings and that you will never used your magic on her but she is too angry and confused. She looks at you and resumes walking out, intent on her revenge against Davy.</p>");
				startQuestions()
			}
			if (plcMG === 177) addLinkToPlace(md, "let her go and look for Mrs Granger", 177, "", "", "", "charmPerson('Kate',4,'Davy')");
			addLinkToPlace(md, "let her go and follow her out of the house", 43, "", "", "", "charmPerson('Kate',4,'Davy')");
			WritePlaceFooter(md);
			return true
		} else if (sType == "waitprotectcharm") {
			md =
				WritePlaceHeader();
			this.showPerson("kate17d.jpg");
			addPlaceTitle(md, "Kate Refuses");
			this.setFlag(12);
			md.write("<p>You tell her you know something of how Davy did what he did to her and can protect her by using the same spell on her, but just to protect her, doing nothing more. She replies suspiciously,</p>" + '<p>"I see, but I could never let anyone have that sort of power over me ever again. No one, not you, Davy, anyone!!"</p>' + "<p>You see you have lost any trust she had in you, she turns her back on you and leaves the room, certainly going to punish Davy.</p>");
			startQuestions();
			if (plcMG === 177) addLinkToPlace(md, "let her go and look for Mrs Granger", 177, "", "", "", "charmPerson('Kate',4,'Davy')");
			addLinkToPlace(md, "let her go and follow her out of the house", 43, "", "", "", "charmPerson('Kate',4,'Davy')");
			WritePlaceFooter(md);
			return true
		} else if (sType == "waitprotectnecklace") {
			md = WritePlaceHeader();
			perYourBody.DropItem(43, "Kate");
			this.setFlag(15);
			this.place = 124;
			this.showPerson("kate17i.jpg");
			addPlaceTitle(md, "Give Kate the Necklace");
			md.write("<p>You show Kate the heirloom necklace you are wearing and without explaining how you got it, you describe how it protects from magic spells being cast on you. You remove it and offer it to her. She looks surprised, them smiles,</p>" +
				"<p>\"I do not know how to thank you! I will properly 'thank' you later, once I have beaten Davy and heard him beg to apologise to me!\"</p>" + '<p>I am not sure where he is at the moment, he has been very cautious, he said how afraid of you he was, but also mentioned his mentor protecting him. If I find him before you I will call you. Do not dare attack him without me, I must punish him myself!"</p>' + "<p>She quickly kisses you on your lips, and then runs out of the room to hunt down Davy.</p>");
			startQuestions();
			if (plcMG === 177) addLinkToPlace(md, "let her go and look for Mrs Granger", 177);
			addLinkToPlace(md, "let her go and follow her out of the house", 43);
			WritePlaceFooter(md);
			return true
		} else if (sType == "waitlove") {
			md = WritePlaceHeader();
			if (isKateTrusting()) this.showPerson("kate17f.jpg");
			else this.showPerson("kate17d.jpg");
			addPlaceTitle(md, "Kate Hesitates");
			md.write('<p>You call out to Kate, "Wait, don\'t go I love you and want to help you!"</p>' + "<p>She hesitates and looks at you with a smile,  \"I..don't know how to answer that, I am so angry at that <b>bastard</b> I just want to pound his face ");
			if (isKateTrusting()) {
				md.write("but I do like you too, and maybe I was starting to fall... It is just Davy has messed with me and my emotions I do not know what to do.</p>" + "<p>You once again try to reassure her of your feelings and she looks at you,</p>");
				startQuestions();
				addLinkToPlaceC(md, "&quot;I love you, everything I have been doing is to help you!&quot;", 139, "type=waitloveyou");
				addLinkToPlaceC(md, "&quot;I love you, I will defeat Davy!&quot;", 139, "type=waitlovewait")
			} else {
				this.setFlag(12);
				md.write("but I do not trust you. You seem to have some of the same abilities as Davy does and I do not know what you can or have done with them. Maybe I was starting to fall for you, but this has messed us around and I doubt I can ever trust someone with those powers ever again.</p>" +
					"<p>You try to reassure her of your feelings and that you will never used your magic on her but she is too angry and confused. She looks at you and resumes walking out, intent on her revenge against Davy.</p>");
				startQuestions()
			}
			if (plcMG === 177) addLinkToPlace(md, "let her go and look for Mrs Granger", 177, "", "", "", "charmPerson('Kate',4,'Davy')");
			addLinkToPlace(md, "let her go and follow her out of the house", 43, "", "", "", "charmPerson('Kate',4,'Davy')");
			WritePlaceFooter(md);
			return true
		} else if (sType == "waitlovewait") {
			md =
				WritePlaceHeader();
			this.showPerson("kate17d.jpg");
			addPlaceTitle(md, "Kate Leaves");
			md.write('<p>You tell Kate, "I do love you and I am working to defeat Davy and rob him of his powers. Just wait here and I will call for you when he is beaten."</p>' + '<p>Kate smiles and replies, "Thank you, but the only person who is going to beat Davy is me!" and she walks out of the room.');
			startQuestions();
			if (plcMG === 177) addLinkToPlace(md, "let her go and look for Mrs Granger", 177, "", "", "", "charmPerson('Kate',4,'Davy')");
			addLinkToPlace(md, "let her go and follow her out of the house", 43, "", "", "", "charmPerson('Kate',4,'Davy')");
			WritePlaceFooter(md);
			return true
		} else if (sType == "waitloveyou") {
			md = WritePlaceHeader();
			this.showPerson("kate17f.jpg");
			addPlaceTitle(md, "Kate");
			md.write('<p>You tell Kate, "Everything I have been doing is to help you, I love you!"</p>' + '<p>She looks at you smiling and replies, "I might love you as well, but...I should go..."</p>');
			startQuestions();
			addLinkToPlace(md, "kiss her", 139, "type=waitlovekiss");
			if (plcMG === 177) addLinkToPlace(md, "let her go and look for Mrs Granger", 177, "", "", "", "charmPerson('Kate',4,'Davy')");
			addLinkToPlace(md, "let her go and follow her out of the house", 43, "", "", "", "charmPerson('Kate',4,'Davy')");
			WritePlaceFooter(md);
			return true
		} else if (sType == "waitlovekiss") {
			md = WritePlaceHeader(false, "td-left-med");
			this.showPerson(perYou.isMaleSex() ? "kate17gb.jpg" : "kate17gg.jpg");
			addPlaceTitle(md, "A Kiss");
			md.write("<p>You take the uncertain Kate in your arms and you kiss her. She hesitates for a moment and then returns your kiss.</p>" +
				"<p>After a time you part and Kate looks calmer, the anger gone from her face, and she says,</p>" + '<p>"After everything with Davy this is so confusing, but I do want to thank you properly"</p>' + "<p>You look at her, she is unusually nervous, she is usually very clear minded, if impulsive.</p>");
			startQuestions();
			addLinkToPlace(md, "embrace her", 139, "type=waitloveembrace");
			if (plcMG === 177) addLinkToPlace(md, "let her go and look for Mrs Granger", 177, "", "", "", "charmPerson('Kate',4,'Davy')");
			addLinkToPlace(md,
				"let her go and follow her out of the house", 43, "", "", "", "charmPerson('Kate',4,'Davy')");
			WritePlaceFooter(md);
			return true
		} else if (sType == "waitloveembrace") {
			md = WritePlaceHeader(false, isExplicit() || perYou.isMaleSex() ? "td-left-med" : "");
			this.setFlag(14);
			this.place = 124;
			var img = "";
			if (isExplicit()) img = this.showPersonRandomX(perYou.isMaleSex() ? "kate17hb" : "kate17hg", 2);
			else this.showPerson(perYou.isMaleSex() ? "kate17hb.jpg" : "kate17hg.jpg");
			addPlaceTitle(md, "Passionate Embrace");
			md.write("<p>You take Kate into your arms and passionately kiss her, and you both start to strip each others clothing. You touch her large breasts and she sighs in passion, but when you touch her lower down, she shys away, and says,</p>" +
				'<p>"For now just let me please you...another time for...you know.."</p>');
			if (perYou.isMaleSex())
				if (img.indexOf("kate17hba.jpg") != -1) md.write("<p>Kate has you place your cock between her breasts and you fuck her ample cleavage. She seems quite skilled at this, and you quickly cum, splattering over her face and tits.</p>");
				else md.write("<p>Kate kneels and gives you a practised blowjob, clearly not her first time by a long way. You quickly cum, splattering her face and tits.</p>");
			else md.write("<p>Kate has you lie back and she leans in and starts licking your pussy. She is remarkably skilled and you quickly orgasm hard on her face.</p>");
			md.write("<p>Kate looks at you and smiles and she quickly re-dresses. Once dressed she tells you,</p>" + '<p>"I will be back soon, once I have beaten Davy for what he did to me!"</p>' + "<p>Before you can complain or warn her she leaves the room.</p>");
			startQuestions();
			if (plcMG === 177) addLinkToPlace(md, "let her go and look for Mrs Granger", 177, "", "", "", "charmPerson('Kate',4,'Davy')");
			addLinkToPlace(md, "let her go and follow her out of the house", 43, "", "", "", "charmPerson('Kate',4,'Davy')");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "katepacking") {
			if (!isInvisible() && !perYou.checkFlag(16)) {
				gotoPlace(35, "type=clobberedvisible");
				return true
			}
			md = WritePlaceHeader();
			this.showPerson("kate18a.jpg");
			addPlaceTitle(md, "Kate Packing");
			md.write("<p>Kate has arrived back home and she is quickly packing some things. She seems to have first changed her clothes elsewhere in the house before entering the room.</p>");
			if (isInvisible()) md.write("<p>You are waiting in the room, quiet and invisible.</p>");
			else if (perYou.checkFlag(16)) md.write("<p>You are quietly hiding in the wardrobe.</p>");
			startQuestions()
		} else if (sType == "charm1" || sType == "charm1v") {
			md = WritePlaceHeader(false, sType == "charm1" || !this.checkFlag(23) ? "" : "td-left-large");
			this.place = 1;
			this.showPerson(sType == "charm1" ? "kate18b.jpg" : this.checkFlag(23) ? "kate18bv1.jpg" : "kate18bv2.jpg");
			addPlaceTitle(md, "Kate Under a Charm Spell");
			if (sType == "charm1") {
				md.write('<p>You wait for a moment until Kate is putting some items into a bag and making a little noise. As quietly as you can you recite "Dai Chu Kate", the spell of charming.</p>' +
					'<p>Kate looks around and says "..again..??" and her face flushes and a look of arousal passes across her features. Somehow she looks confused and also like it is Deja-Vu all over again. ' + "With that you are quite certain she is under the influence of the spell and ");
				if (perYou.checkFlag(16)) {
					perYou.setFlag(16, false);
					md.write("step out of hiding")
				} else {
					checkInvisible();
					md.write("drop the invisibility spell")
				}
			} else md.write('<p>Kate looks around and says "..again..you..??" and her face flushes and a look of arousal passes across her features. Somehow she looks confused and also like it is Deja-Vu all over again. ' +
				"With that you are quite certain she is under the influence of the spell ");
			md.write(' and she looks at you, "' + perYou.getPersonName() + ' what is happening?" and she starts to involuntarily remove her clothing.</p>' + "<p>You consider if you earlier annoyance at Kate is justified, or have you calmed down.</p>");
			startQuestions();
			addLinkToPlaceC(md, '"Bitch, you must call me ' + perYou.getMaster() + '!"', 139, sType == "charm1v" ? "type=charm2v" : "type=charm2");
			if (perYou.checkFlag(26)) addLinkToPlaceC(md, '"It is just you are in love with me"',
				139, sType == "charm1v" ? "type=charm2v" : "type=charm2", "", "", "charmPerson('Kate', 2);")
		} else if (sType == "charm2" || sType == "charm2v") {
			md = WritePlaceHeader(false, sType == "charm2" || this.checkFlag(23) ? "" : "td-left-large");
			if (sType == "charm2") this.showPersonRandom("kate18c", 2);
			else this.showPerson(this.checkFlag(23) ? "kate18cv1.jpg" : "kate18cv2.jpg");
			setPersonFlag("MrsGranger", 12, false);
			if (this.getCharmedLevel() == 2) {
				addPlaceTitle(md, "Kate Falling for a Charm Spell");
				md.write('<p>You tell Kate, "Have you changed your mind, you do trust me, and care for me, don\'t you?"</p>' +
					"<p>You words subtly shape her thoughts as the spell courses through her body and mind, She continues removing her clothing, out of some residual memory of the previous times she had been charmed. " + 'She says "No, I don\'t trust..." and you interrupt her, "fully trust me, but you care for me."</p>' + '<p>She looks uncertain, and you continue "I do love you, and you can trust me absolutely". Kate looks at you, the spell erasing some of her concerns and doubts.</p>');
				startQuestions();
				addLinkToPlaceC(md,
					'"Do you love me"', 139, sType == "charm2v" ? "type=charm3v" : "type=charm3")
			} else {
				addPlaceTitle(md, "Enslaving Kate");
				md.write('<p>You firmly tell her "Kate! You may only call me ' + perYou.getMaster() + '!". She looks shocked and starts to walk towards you, clearly intent on striking you. You tell her "Stop!" and she hesitates as the spell shapes her thoughts.</p>' + '<p>You continue "You are violent and ungrateful for everything I have tried to do for you!". She starts walking again and you repeat "Stop! You will obey"</p>' +
					'<p>Kate hesitates and you continue "You <b>must</b> obey instantly and without thought, strip your clothing!"</p>' + "<p>Kate struggles to resist, but finally removes her clothing, looking at you unsure.</p>");
				startQuestions();
				addLinkToPlaceC(md, '"Obey me slave"', 139, sType == "charm2v" ? "type=charm3v" : "type=charm3")
			}
		} else if (sType == "charm3" || sType == "charm3v") {
			md = WritePlaceHeader();
			this.showPerson("kate18d.jpg");
			if (this.getCharmedLevel() == 2) {
				addPlaceTitle(md, "Kate Falling for a Charm Spell");
				md.write('<p>Kate answers, "Well I did like you, but all this with Davy...", and you reply,</p>' +
					'<p>"Be honest Kate, I love you, and you do love me", your answer is meant as a statement, not a question. Kate\'s expression changes,</p>' + '<p>"I think I do love you ' + perYou.getPersonName() + ' I think I was just confused with that bastard Davy!", she pauses and continues "I do love you!"</p>' + "<p>You can see he mind is made up, both because of the spell and you think due to her confused feelings. You notice her eyes change, the glow of magic recedes, and now you think of it, when she was charmed by Davy you never noticed anything about her eyes.</p>");
				startQuestions();
				addLinkToPlace(md, "make love to her", 139, "type=charm4")
			} else {
				addPlaceTitle(md, "Enslaving Kate");
				md.write('<p>Kate looks angry as you call her a slave, but you reinforce your words, "Yes, an obedient, submissive slave!"</p>' + "<p>Her eyes flare and then the glow of magic recedes, you wonder if you went too far and prepare yourself for a lot of pain, but Kate says,</p>" + '<p>"Yes my ' + perYou.getMaster() + ' I will do <i>anything</i> you need or desire"</p>' + "<p>She is completely under your control, it would seem her repeated charming by Davy has made it simpler to charm her again and your words have had an increased effect. She is your slave.</p>");
				startQuestions();
				addLinkToPlace(md, "take your slave", 139, "type=charm4")
			}
		} else if (sType == "charm4") {
			md = WritePlaceHeader();
			this.showPerson("kate18e.jpg");
			if (this.getCharmedLevel() == 2) {
				addPlaceTitle(md, "Loving Kate");
				md.write("<p>You make love to Kate, she is a highly passionate lover, partially from the residue of the spell, but mostly from her nature.</p>")
			} else {
				addPlaceTitle(md, "Fucking your Slave Kate");
				md.write("<p>You take your slave, sating yourself on her body, caring little about her pleasure, but the spell ensures her arousal and easy orgasm.</p>")
			}
			startQuestions();
			addLinkToPlaceC(md, "talk to " + this.getPersonName(), 139)
		} else if (sType == "bedroomforeplay") {
			clv = this.getCharmedLevel();
			if (clv === 0) {
				md = WritePlaceHeader(false, perYou.isMaleSex() && !isExplicit() ? "" : "td-left-med");
				this.showPersonRandomRorX("kate-home-lover-foreplay-" + (perYou.isMaleSex() ? "b" : "g"), isExplicit() ? perYou.isMaleSex() ? 3 : 1 : 1);
				addPlaceTitle(md, "Arousing Kate");
				md.write("<p>You embrace your lover, kissing her passionately. You both start to remove your closing and teasing each other with hands, mouths and toys.</p>");
				startQuestions();
				addLinkToPlace(md, "now it is time to make love with Kate", 139, "type=bedroomsex&after=foreplay")
			} else if (clv == 2) {
				md = WritePlaceHeader(false, perYou.isMaleSex() && !isExplicit() ? "td-left-med" : "");
				if (isExplicit())
					if (perYou.isMaleSex()) {
						md = WritePlaceHeader();
						this.showPersonRandomX("kate-home-charmedlover-foreplay-b", 4)
					} else {
						md = WritePlaceHeader(false, "td-left-med");
						this.showPersonRandomX("kate17hg", 2)
					}
				else {
					md = WritePlaceHeader(false, perYou.isMaleSex() ? "td-left-med" : "");
					this.showPersonRandom("kate-home-charmedlover-foreplay-" +
						(perYou.isMaleSex() ? "b" : "g"), 1)
				}
				addPlaceTitle(md, "Arousing You Charmed Lover Kate");
				md.write("<p>You embrace your charmed lover, kissing her passionately. You both start to remove your closing and teasing each other with hands, mouths and toys.</p>");
				startQuestions();
				addLinkToPlace(md, "now it is time to make love with Kate", 139, "type=bedroomsex&after=foreplay")
			} else {
				if (perYou.isMaleSex()) {
					md = WritePlaceHeader();
					this.showPersonRandomRorX("kate-home-charmedslave-foreplay-b", isExplicit() ? 4 : 1)
				} else if (isExplicit()) {
					md =
						WritePlaceHeader(false, "td-left-med");
					this.showPersonRandomX("kate17hg", 2)
				} else {
					md = WritePlaceHeader();
					this.showPerson("kate-home-charmedslave-foreplay-ga.jpg")
				}
				addPlaceTitle(md, "Slave Kate Serving You");
				md.write("<p>You tell your slave to pleasure you and " + (perYou.isMaleSex() ? "give you a blowjob" : "lick your pussy") + ".</p>");
				startQuestions();
				addLinkToPlace(md, "now take your slave", 139, "type=bedroomsex&after=foreplay")
			}
			if (perYou.FindItem(45) > 0 && !perYou.isMaleSex()) addLinkToPlace(md, "you could take it to the next level with your strap-on",
				Place, "type=bedroomstrapon")
		} else if (sType == "bedroomstrapon") {
			md = WritePlaceHeader(false, "td-left-med");
			this.showPersonX("kate-home-strapon.jpg");
			addPlaceTitle(md, "Another Toy");
			if (clv === 0) md.write("<p>You take out your strap-on to continue the foreplay, and Kate suggests you move to the couch she has in her room.  You both move over there and you fuck her with your strap-on</p>");
			else if (clv == 2) md.write("<p>You take out your strap-on to continue the foreplay, and Kate suggests you move to the couch she has in her room.  You both move over there and you fuck her with your strap-on</p>");
			else md.write("<p>You take out your strap-on and tell Kate to lie on the couch in her room. She lies down and you fuck her with your strap-on</p>")
		} else if (sType == "bedroomsex") {
			clv = this.getCharmedLevel();
			var after = getQueryParam("after");
			if (clv === 0) {
				md = WritePlaceHeader(false, perYou.isMaleSex() ? "td-left-med" : "");
				this.showPersonRandomRorX("kate-home-lover-sex-" + (perYou.isMaleSex() ? "b" : "g"), perYou.isMaleSex() ? isExplicit() ? 4 : 3 : 1);
				addPlaceTitle(md, "Loving Kate");
				md.write("<p>You make love to Kate, she is a highly passionate lover, partially from the residue of her time charmed by Davy, but mostly from her nature.</p>")
			} else if (clv ==
				2) {
				md = WritePlaceHeader(false, perYou.isMaleSex() && isExplicit() ? "" : "td-left-med");
				this.showPersonRandomRorX("kate-home-charmedlover-sex-" + (perYou.isMaleSex() ? "b" : "g"), perYou.isMaleSex() ? isExplicit() ? 4 : 2 : isExplicit() ? 2 : 1);
				addPlaceTitle(md, "Loving Your Charmed Lover Kate");
				md.write("<p>You make love to Kate, she is a highly passionate lover, partially from the residue of the spell, but mostly from her nature.</p>")
			} else {
				if (perYou.isMaleSex())
					if (isExplicit()) {
						md = WritePlaceHeader(false, "td-left-med");
						this.showPersonRandomX("kate-home-charmedslave-sex-b",
							5)
					} else {
						md = WritePlaceHeader(false, "td-left-med");
						this.showPersonRandom("kate-home-charmedslave-sex-b", 1)
					}
				else if (isExplicit()) {
					md = WritePlaceHeader(false, "td-left-med");
					this.showPersonRandomX("kate-home-charmedslave-sex-g", 2)
				} else {
					md = WritePlaceHeader(false, "td-left-med");
					this.showPerson("kate-home-charmedslave-sex-ga.jpg")
				}
				addPlaceTitle(md, "Fucking your Slave Kate");
				md.write("<p>You take your slave, sating yourself on her body, caring little about her pleasure, but the spell ensures her arousal and easy orgasm.</p>")
			}
			startQuestions();
			addLinkToPlaceC(md, "talk more to " + this.getPersonName(), 139)
		} else return false;
		if (plcMG === 177) addLinkToPlace(md, "look for Mrs Granger", 177);
		addLinkToPlace(md, "exit the house", 43);
		WritePlaceFooter(md);
		return true
	};
	per.handleItem = function(no, cmd) {
		if (no == 14 && cmd == 2) {
			if (Place == 108) {
				addComments("You attempt to cast the spell, but if fails to take effect... Evidently Kate is already under the effects of a charm spell...  Someone <i>else's</i> spell.");
				return "handled"
			}
			if (Place == 267) {
				dispPlace(125, "");
				return "nofooter"
			}
			if (Place ==
				36)
				if (!this.isCharmedBy("Davy")) {
					gotoPlace(47, "type=clobbered");
					return "nofooter"
				} else addComments("You attempt to cast the spell, but if fails to take effect... Evidently Kate is already under the effects of a charm spell...  Someone <i>else's</i> spell.")
		}
		return ""
	};
	per.isPhoneable = function() {
		return checkPlaceFlag("Hotel", 11) && Place == 269
	};
	per.callThem = function() {
		if (Place == 269)
			if (!this.checkFlag(22) && !this.checkFlag(23) && !this.isCharmedBy("You")) WriteComments("You try to call Kate to invite her to join you at the pool for a swim, but there is no answer.");
			else {
				gotoPlace(Place, "type=katepool");
				receiveCall("", "You call Kate to invite her to join you at the pool for a swim, and she agrees to meet you there shortly");
				WriteCommentsFooter(bChat, bChatLeft)
			}
	};
	per.addPersonPhoneCall = function() {
		if (Place != 139 && Place != 177 && this.place == 1 && this.other == 7 && Math.floor((nTime - this.charmedTime) / 12) >= 1 && !this.checkFlag(26))
			if (makeCall(true, 240)) this.setFlag(26);
		return false
	};
	per.getPersonSMS = function(id) {
		if (id == 240) return receiveSMS("Kate", "Hey " + perYou.getPersonName() +
			" can we meet? I am at my place, please can you come here?");
		if (id > 240 && id < 250) return receiveSMS("", "", (isExplicit(true) ? "Explicit/" : "") + "katephoto" + (id - 240) + (isExplicit() ? id < 247 ? ".gif" : ".jpg" : id < 245 ? ".gif" : ".jpg"));
		return ""
	}
}

function RepliesKristin(nR) {
	var pCharm = per.isCharmedBy();
	var myName = per.getYourNameFor();
	if (nR == 100) {
		this.setFlag(5);
		addComments("\u201cEllie Bartel? She is a bright girl, usually very social, though of late she has been rather withdrawn, always walking straight home and rarely showing interest in anyone.\u201d</p>" + "<p>\u201cIf you want to talk to her you might have to catch her when she is not at work, " + myName + ", just don't forget about me.\u201d She teasingly licks her upper lip.")
	} else if (nR ==
		2701) {
		AddCash(100);
		perYourBody.DropItem(27, 0);
		if (!pCharm) addComments('"Oh, I see you have an approval notice from ' + perGates.getPersonNameShort() + " for a disbursement of " + sCurrency + '100," says the manager as she types a few things into the computer. "Everything seems to be in order.  Here you are, ' + myName + '."');
		else addComments('"Yes, ' + myName + '.  All I need are the... here they are," she says as she looks at the letter. "Everything is in order now, ' + myName + ".  Here is the " + sCurrency + '100.  Will there be... anything else?" she asks expectantly, ready to serve.</p>')
	} else if (nR ==
		2800) {
		addComments("\u201cAnything you want, " + myName + ", but I will only be able to close for a limited amount of time, I'm only the manager, not the owner after all.\u201d</p>" + "<p>Kristin performs a quick phone-call, then turns to you.</p>" + "<p>\u201cI have explained that there is an electrical problem, this won't work more than once but will give you some time. Just visit me at my home in 10 Dervish Rd once you are ready to reopen. Ellie, the teller you were interested in, lives right next to me with her mothers Carol and Sally, by the way.\u201d</p>" +
			"<p>She gets ready to close the Bank and finally asks you to leave as well.");
		per.setFlag(9);
		setPlaceKnown("DervishRd");
		setPlaceFlag("DervishRd", 2);
		setPlaceFlag("DervishRd", 3);
		per.place = 430;
		movePerson("Ellie", 1E3);
		Place = 194
	} else if (nR == 2801) {
		per.setFlag(10);
		per.setFlag(9, false);
		if (isDay()) {
			addComments('<p>"Yes ' + myName + '. I will do so immediately."</p><p>You walk out with her as she leaves to reopen the Bank</p>');
			per.place = 362;
			movePerson("Ellie", 225);
			Place = 5
		} else addComments('<p>"Yes ' + myName + '. I will do so first thing in the morning."</p><p>She makes a few calls and sends some messages and emails, and the returns to you.</p>')
	} else if (nR ==
		2802) {
		addComments('<p>"Yes we can approve a credit card for you ' + myName + ". but given your income I can only approve a small limit of " + sCurrency + '50 but this can be increased in a month."</p><p>You fill out the paperwork and are given the card, and make an immediate cash withdrawal of the balance from the card. You do wonder a little about the beautiful manager but you have no further reason to see her for another month.</p>');
		AddCash(50);
		per.setFlag(13);
		setPersonFlag("Mom", 6, false);
		Place = 194
	} else if (nR ==
		2900) {
		addComments('<p>"Of course ' + myName + ' just give me a moment" and she types a transaction into her computer and "It is done, the limit is removed from your account."</p>');
		perYou.setFlag(9)
	}
	return true
}

function LaterCall() {
	setPersonFlag("Kristin", 15)
}

function initialiseKristin() {
	addPerson("Kristin", 362);
	per.Replies = RepliesKristin;
	per.getPersonName = function(full) {
		return full !== true && this.isCharmedBy() ? "Slave Kristin" : "Kristin"
	};
	per.getPersonAddress = function() {
		return checkPlaceFlag("DervishRd", 2) ? "10 Dervish Rd, Glenvale" : ""
	};
	per.isPersonInfo = function() {
		return this.isCharmedBy()
	};
	per.getPersonInfo = function() {
		if (Place == 430) return "Kristin serves you a cold orange juice while you two talk. She knows you are not allowed to drink yet, but she still wants you to feel at home when you visit her. Her house is a modern, elegant house with 4 rooms. It is more of a small palace than an actual house. You asked why she needed that big of a house and she answered honestly. She wanted to show off to the people how rich she is. She knew this kind of luxury was not necessary for her, but she went with it anyway.<br><br>" +
			"Kristin is standing right in front of you in her pink lingerie and nylon stockings. Her bossy demeanor is still present, but it\u2019s more of a show to you rather than her real persona. She\u2019s still dominant to other people; she told you it is easier for her to make your plans a reality.<br><br>" + "Kristin also mentioned briefly that she has a somewhat intimate relationship with Ellie\u2019s mother, Carol. You should discuss this matter futher if you have the time.";
		else return "Kristin, the manager of the bank sits before you as you enter her office without knocking. You don\u2019t have to anymore, because she raised you the idea that why would you need to go through the security protocols when you practically own this place. She even talked to Ellie and told her to grant you free access to the manager\u2019s office anytime.<br><br>" +
			'Kristin changed a bit, however she still plays the innocent, confused woman who doesn\u2019t understand what\u2019s been happening to her lately. Deep inside, you know it\u2019s all just an act so you can visit her more often to "eludicate her behaviour" and "educate her personally". You are sure that she is your slave just like the others, but she does this act to have you around her.'
	};
	per.whereNow = function() {
		if (Place == 430 && sType.indexOf("ellie") != -1) return 0;
		if (this.place != 420 && (!isDay() || !isWeekDay())) return 430;
		return this.place
	};
	per.passTimeDay = function() {
		if (this.isCharmedBy()) {
			if (this.checkFlag(10)) {
				var nd = Math.floor(nTime / 288) % 7;
				if (nd < 6) {
					if (this.isHere()) {
						this.place = 362;
						return this.addPersonFace() + "In the morning Kristin gives you a kiss and tells you she has to leave for her job at the Bank.</p>"
					}
					this.place = 362
				}
			}
			if (this.place == 420 && this.checkFlag(2) && !this.checkFlag(4) && !this.checkFlag(6) && Place != 430) this.setFlag(7)
		}
		return ""
	};
	per.passTimeNight = function() {
		if (this.isCharmedBy() && this.checkFlag(10)) {
			var nd =
				Math.floor(nTime / 288) % 7;
			if (nd < 6) this.place = 430
		}
		return ""
	};
	per.showEvent = function() {
		var md;
		if (Place == 269 && sType == "kristinpool") {
			WaitHereOnly(6);
			md = WritePlaceHeader();
			this.showPersonRandom("kristin-pool", 2);
			addPlaceTitle(md, "Swimming with Kristin");
			md.write("<p>Kristin arrives, dressed in a bikini, and you have a pleasant swim together.</p>");
			startQuestions();
			addLinkToPlaceC(md, "it is fairly private here...", Place, "type=kristinpoolsex");
			addLinkToPlaceC(md, "say goodbye to Kristin", Place);
			WritePlaceFooter(md);
			return true
		}
		if (Place == 269 && sType == "kristinpoolsex") {
			md = WritePlaceHeader();
			this.showPerson("kristin-pool-sex.jpg");
			addPlaceTitle(md, "Being Discrete and Private with Kristin");
			md.write("<p>You ask Kristin to play with you more privately, and she seductively removes most of her swimsuit and lies back waiting for you.</p>");
			startQuestions();
			addLinkToPlaceC(md, "later...say goodbye to Kristin", Place);
			WritePlaceFooter(md);
			return true
		}
		if (Place == 362 && sType == "elucidate") {
			md = WritePlaceHeader();
			this.showPerson(perYou.isMaleSex() ?
				"kristin9b.jpg" : "kristin9g.jpg");
			addPlaceTitle(md, "Taking Kristin Again");
			md.write("<p>Your hands and tongue heighten your slave's arousal and obedience, and she does " + "her best to please you in turn.</p>" + "<p>As you and she find yourselves crying out with " + 'the joy of your activity, you have the passing concern that the "shield" over your ' + "charm will not extend to the street, where people can no doubt hear you.</p>" + "<p>If they do, however, nobody mentions it.</p>");
			startQuestions();
			addLinkToPlace(md,
				"Put your clothes back on and return to the front desk", 225);
			WritePlaceFooter(md, "Script by Tilde");
			return true
		}
		return false
	};
	per.isPhoneable = function() {
		return checkPlaceFlag("Hotel", 11) && Place == 269 && this.isCharmedBy()
	};
	per.callThem = function() {
		if (Place == 269)
			if (this.whereNow() == 362) WriteComments("You call Kristin to invite her to join you at the pool for a swim, but she explains she is working at the Bank and will have to take a rain-check.");
			else {
				gotoPlace(Place, "type=kristinpool");
				receiveCall("",
					"You call Kristin to invite her to join you at the pool for a swim, and she answers that it is agreeable and will be there in a while.");
				WriteCommentsFooter(bChat, bChatLeft)
			}
	};
	per.addPersonPhoneCall = function() {
		if (this.checkFlag(15) && !this.checkFlag(14))
			if (makeCall(false, "Kristin", '"' + perYou.getMaster() + " I have convinced Carol to allow you to 'watch', come on back to the house!\"")) {
				this.setFlag(14);
				return true
			}
		if (this.place == 420 && this.checkFlag(2) && !this.checkFlag(4) && this.checkFlag(7) && !this.checkFlag(6) &&
			Place != 430)
			if (makeCall(true, 310)) this.setFlag(6);
		return false
	};
	per.getPersonSMS = function(id) {
		if (id == 310) return receiveSMS("Kristin", this.getYourNameFor() + " I was just thinking, and I am sorry about before when we talked about my neighbours. I did not tell you everything. Come by and talk to me again.", "kristinsms1.jpg");
		return ""
	}
}
var perKurndorf;

function isRitualComplete() {
	return perKurndorf.getQuestRitual() >= 200
}

function RepliesKurndorf(nR) {
	var myName = perYou.getPersonName();
	var mySex = perYou.getSex();
	if (nR == 14301) {
		bChat = false;
		addComments('<p>"Yes, ' + myName + ', I know who you are," he says, never taking his eyes off of the Witch. "Who do you think helped you get as far as you have?"');
		perKurndorf.setQuestGhost(5);
		perKurndorf.setQuestSeance(51)
	} else if (nR == 14305) {
		bChat = false;
		addComments('<p>"Simply, my ' + mySex + '," he says, turning to look you in the eye.  You can\'t help but feel a shiver run down your spine.</p><p>"How else was I going to get someone to summon my spirit so that I may <i>live again</i>!!"</p>');
		perKurndorf.setQuestGhost(10);
		if (perYourBody.FindItem(41) === 0) {
			Place = 997;
			perKurndorf.setQuestGhost(999)
		}
	} else if (nR == 14310) {
		bChat = false;
		addComments('<p>"I see," he says, smiling at you, which would have been disarming were it not for the flare of his temper a moment before.</p>' + '<p>"Then again..." he says, turning his attention to Jessica. "I could always achieve my revenge in... other ways.  I do have <i>some</i> tricks up my sleeve even after all these years."</p>');
		perKurndorf.setQuestGhost(15)
	} else if (nR ==
		14315) {
		perKurndorf.setQuestGhost(20);
		perJesse.setDemonPath(1)
	} else if (nR == 14320) {
		perKurndorf.setQuestGhost(25);
		perJesse.setDemonPath(10);
		perKurndorf.setQuestSeance(70);
		if (wherePerson("Jessica") === 0) {
			var perJessica = findPerson("Jessica");
			perJessica.startRival()
		}
	} else if (nR == 14325) {
		bChatLeft = false;
		addComments('<p>"You\'re inquiring as to the disposition of a man who was killed 200 years ago and is now floating incorporeally with no hope of final release?"</p>');
		perKurndorf.setQuestGhost(30)
	} else if (nR ==
		27100) {
		perKurndorf.setQuestSeance(105);
		addComments('<p>"Simple, my ' + mySex + '.  Even though that treacherous little imp broke the prison spell, this space is still <i>between</i> worlds enough for me to continue to exist here."</p>')
	} else if (nR == 27105) {
		perKurndorf.setQuestSeance(110);
		addComments('<p>Kurndorf grumbles for a moment, then his spirits lighten slightly.</p><p>"No, in fact, I can not leave this place.  Were I to try, my spirit would quickly fade back into the netherworld.  It would seem that I have simply traded one hell for another."</p>')
	} else if (nR ==
		14350) {
		perKurndorf.setQuestGhost(55);
		addComments('<p>"Why did I help?" he asks, seemingly pondering the question for a moment.</p><p>"Well...  I suppose I could say it was to foil that treacherous imp.  Or I could say that it was to save your life.  But would you believe me, regardless of what I said?"</p>')
	} else if (nR == 14355) {
		perKurndorf.setQuestGhost(60);
		addComments('<p>"Simple, my ' + mySex + ".  If I hadn't stopped you, that imp would have sucked your soul from you body and devoured it - leaving you a soulless thrall with no will of your own.  And certainly no <i>magic</i>,\" he says, emphasising the last point.</p>")
	} else if (nR ==
		14360) {
		perKurndorf.setQuestGhost(65);
		addComments('<p>He smiles at you. "Very observant of you, my ' + mySex + '.  Quite right."  He stops and looks at you, seemingly considering his options for a short while.</p><p>"Yes, you might just do after all," he says finally.  "I saved you because I think you may be able to help me."</p>')
	} else if (nR == 14365) {
		perKurndorf.setQuestGhost(70);
		addComments('<p>"Out of the goodness of your heart?" he asks sarcastically.  "No, I suppose that would be too much to expect.  Perhaps because I can teach you more <b>Magic</b> - the kind that puts your little tricks to shame."</p>')
	} else if (nR ==
		14370) {
		perKurndorf.setQuestGhost(75);
		addComments('<p>"In return?" he says, pausing. "Well...  Revenge on that little imp would be nice.  Or perhaps even that Witch," he says, small flares of anger turning his ghostly image a shade of red - then he seems to calm down a bit.</p><p>"No, in the end all I would request is a new body.  No, not <i>yours</i> - but someones, even a mundane body devoid of magic would still have <i>life</i>."</p>')
	} else if (nR == 14375) {
		perKurndorf.setQuestGhost(80);
		addComments('<p>Kurndorf looks at you, all humour gone from his visage.</p><p>"My ' +
			mySex + ', I would do <i>anything</i> to live once more." Then he seems to lighten a bit.</p><p>"Now, shall I begin my tutelage or shall you leave me here to fend for myself?"</p>')
	} else if (nR == 14380) {
		perKurndorf.setQuestGhost(85);
		addComments('<p>"Well, among other things..." he says pausing to consider his words carefully.</p><p>"How would you like to learn the same ritual that I was <i>about</i> to cast before I was so rudely interrupted?"</p>')
	} else if (nR == 143100) {
		perKurndorf.setQuestGhost(100);
		addComments('<p>"Excellent!" Kurndorf exclaims. "You have made the right choice."</p>');
		if (!isPlaceKnown("Church")) setPlaceKnown("Church");
		if (!isPlaceKnown("NewAgeStore")) setPlaceKnown("NewAgeStore");
		if (!isPlaceKnown("Graveyard")) setPlaceKnown("Graveyard");
		PlaceI(50, 45);
		PlaceI(51, 318);
		PlaceI(53, 321);
		PlaceI(59, 242)
	} else if (nR == 143101) {
		perKurndorf.setQuestGhost(102);
		addComments('<p>"You can\'t get them all?  Surely someone as resourceful as you could find a way to get around any problem that might arise," Kurndorf says almost derisively.  Whose side is this guy on?</p>')
	} else if (nR ==
		143102) {
		perKurndorf.setQuestGhost(103);
		addComments('<p>Kurndorf takes a deep breath, an empty gesture for a ghost. "I suppose I could teach you a minor little cantrip that may be helpful. You <i>do</i> have the book, don\'t you?"</p>')
	} else if (nR == 143103) addComments('<p>"Not that this makes any sense, but it would seem that you don\'t have <i>room</i> for anything more...  spell or otherwise.  Perhaps if you <i>drop</i> something, then I could teach you."</p>');
	else if (nR == 143105) {
		perKurndorf.setQuestGhost(105);
		addComments('<p>"Oh I never teach a student <i>everything</i> I know, otherwise what reason would they have to keep their teacher around?"</p>')
	} else if (nR == 143110) {
		perKurndorf.setQuestGhost(110);
		addComments('<p>He looks at you and, for a second, you almost think he\'s going to lose his temper.  "No, its an ancient incantation...  Now <b>say it</b>."</p>')
	} else if (nR == 143115) {
		perKurndorf.setQuestGhost(115);
		addComments('<p>"What? Oh, yes. Of course I meant you, what else would I have meant?  You won\'t be able to help me get a body later if you fail during the ritual.  Now, back to the task at hand."</p>')
	} else if (nR ==
		143120) {
		perKurndorf.setQuestGhost(120);
		addComments('<p>"<i><b>Peasants Progress</i></b>, my ' + mySex + ', must you interrupt!?" he says, losing his composure for but a moment.  "Blood is the most powerful of fluids, a <i>little</i> bit goes a <i>long</i> way.  Now, <b>prick</b>!"</p>')
	} else if (nR == 143125) {
		perKurndorf.setQuestGhost(125);
		addComments('<p>"But we are soooo close, now <b>finish</b>!" he says, almost drooling in anticipation.  <i>So close to what?</i> you wonder.</p>')
	} else if (nR == 14900) {
		perKurndorf.setQuestRitual(5);
		addComments('<p>"Remember..." he says curtly.  "Now that we have begun - we must see this through to the end."</p>')
	} else if (nR == 14420) perJesse.setDemonPath(20);
	return true
}

function initialiseKurndorf() {
	perKurndorf = addPerson("Kurndorf");
	per.extra = [0, 0, 0, 0];
	per.Replies = RepliesKurndorf;
	per.getPersonGender = function() {
		return "man"
	};
	per.getPersonName = function() {
		return "Ghost of Kurndorf"
	};
	per.getQuestRitual = function() {
		return this.extra[0]
	};
	per.setQuestRitual = function(no) {
		this.extra[0] = no
	};
	per.getQuestSeance = function() {
		return this.extra[2]
	};
	per.setQuestSeance = function(no) {
		this.extra[2] = no
	};
	per.getQuestGhost = function() {
		return this.extra[1]
	};
	per.setQuestGhost = function(no) {
		this.extra[1] =
			no
	};
	per.getQuestCrypt = function() {
		return this.extra[3]
	};
	per.setQuestCrypt = function(no) {
		this.extra[3] = no
	};
	per.showEvent = function() {
		var md;
		if (Place == 141 && sType == "banshee") {
			md = WritePlaceHeader(false, "td-left-large");
			AddImage("monstera.png");
			addPlaceTitle(md, "Fury of a Ghost");
			md.write("<p>You ignore the ghost and decide this is just wrong, walking towards the front of the mansion intent on taking a taxi home. As you do, you see the ghost look at you with a furious expression as you disobey it.</p>" + "<p>It steps well away from the mansion and you feel a strange sensation, as if something <i>tears</i>, and the ghost flickers and vanishes.</p>" +
				"<p>You think it must have just left, and resume walking, but then you hear a piercing scream, and you are frozen in your tracks, your body refusing to move. You see another figure appear from the trees, an unearthly female figure, and you remember some of the myths and legends. You remember the stories of the women of the Sidhe from Irish mythology, the banshee, an unearthly being whose cry means the death of any who hears it. She scfeams again, and the blackness of death envelops you.</p>" + "<p>As the final darkness descends, you think you should have tried following the ghosts instructions, or been nicer to " +
				perGates.getPersonName() + "...</p>");
			startQuestionsOnly();
			addRestartLink(md);
			WritePlaceFooter(md);
			return true
		}
		return false
	}
}

function initialiseKylie() {
	addPerson("Kylie", 0, "Kylie");
	per.isPersonInfo = function() {
		return true
	};
	per.getPersonInfo = function() {
		var s = "<p><img src='Images/People/Kylie/kylie1a.jpg' style='width:25%;float:right;margin-left:5px' alt='Kylie'>";
		if (this.isCharmedBy()) return s + "<p>You were surprised to find out that Kylie already had a thing for you even before you used the charm on her, though it explains all the teasing she so much enjoyed putting you through ever since you met her again.</p>" + "<p>Speaking off, she still is a little tease and you are really starting to see a pattern with the women of your family here.</p>" +
			"<p>The two of you are slowly getting reacquainted when you are at school, and she enjoys flashing her breasts or underwear to you whenever she feels unwatched, but overall, may be one of the least submissive girls under your spell.</p>" + "<p>She is energetic, funny and usually the one to take charge when you have the time to be more intimate, and it's something you have grown to like about her.</p>";
		return s + "Kylie is your cute cousin who you have not seen for years.<br><br>An athletic and outgoing young woman."
	};
	per.whereNow = function() {
		if (sType == "streetmeet1" || sType == "streetmeet2") return Place;
		var nd = Math.floor(nTime / 288) % 7;
		return getHour() >= 12 && getHour() < 14 && nd < 6 ? 144 : this.place
	};
	per.passTimeDay = function() {
		this.setFlag(6, false);
		return ""
	};
	per.showEventPopup = function() {
		if (sType !== "") return false;
		if (Place == 144 && !this.checkFlag(1) && this.isHere()) {
			this.setFlag(1);
			showPopupWindow("Familiar Girl playing Volleyball", "<img src='Images/People/Kylie/kylie0.jpg' style='width:25%;float:right;margin-left:5px' alt='Kylie'>" +
				"Over on the volleyball court you see a game has just finished and one of the players is a familiar looking girl, and for a moment you stop to admire her cute figure. You cannot quite place her, what class you have met her in, maybe she is a new student here? Then you remember, whoops, she is Kylie a younger cousin of yours!<br><br>" + "Her family recently moved to Glenvale but they has been estranged from your family for many years, some argument with your Mom many years ago. You know Mom visited a while ago so they have probably sorted that out. At the time you were too busy researching some occult works trying to locate references to the Book to go visit with Mom and Tracy.<br><br>" +
				"If you had realised Cousin Kylie had grown up to be so cute, you would have definitely visited! You step over making a small wave of the hand and she calls out,<br><br>" + "\"Hi there, you're my cousin " + perYou.getPersonName() + " aren't you? Nice to see you again after so many years! Do you play? We meet here from lunch most school days\", she says gesturing at the net.<br><br>" + "Well you would certainly like to play, but maybe not the way she meant!");
			return true
		}
		return false
	};
	per.showEvent = function() {
		var md;
		if (sType == "streetmeet1") {
			md = WritePlaceHeader();
			this.setFlag(6);
			this.showPersonRandom("kylie-street-1", 2);
			addPlaceTitle(md, "Walking with Cousin Kylie");
			md.write("<p>Kylie joins you from a nearby house, you assume her home. She is wearing a sheer white dress that is almost transparent in the bright sunlight. You are fairly sure she is weaing <i>nothing</i> else!</p>" + '<p>"Hey Cuz! Care to chat, walk or maybe go somewhere private, not my place, Mom\'s home"</p>');
			startQuestions();
			if (!this.checkFlag(7)) addQuestionR(md,
				'ask "Why not visit your place?"', "&quot;Mom has made it clear about what I can an can't do at home, and having a " + perYou.getSex() + ' visit is a big no-no!"</p>' + "<p>You say that you are her cousin and as far as Aunt Brandi is concerned you can just be visiting family. Kylie grins, &quot;More than just visiting Cuz! Well you will have to ask her yourself sometime.&quot;</p>" + "<p>Ok, you will have to ask your Mom sometime to arrange a visit, it seems Kylie in not willing to now.", "Kylie", "setPersonFlag(\\'Kylie\\',7)");
			addLinkToPlaceC(md, '"let\'s go somewhere private"', Place, "type=streetmeet2");
			addLinkToPlace(md, "say goodbye for now", Place);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "streetmeet2") {
			md = WritePlaceHeader();
			this.showPersonRandom("kylie-street-2", 3);
			addPlaceTitle(md, "Private Times with Cousin Kylie");
			md.write("<p>Kylie leads you to a nearby pathway betten the homes, an access-way to some walking paths. After a quick check that there is no-one else around, she removes her dress with ease. She is not wearing a thing aside from the sheer dress!</p>" +
				'<p>"Well Cuz, you do not just have to look" She smiles as she starts to remove your clothing...</p>' + "<p>There is a certain sort of excitement in stripping off in public to have sex with your cousin. This area is not exactly private and you keep wondering if some person walking their dog or going shopping will come along to witness the two of you. But that is part of the excitment, the thrill and Kylie is completely in to it.</p>");
			if (!checkPersonFlag("Brandi", 1)) md.write("<p>You notice Kylie glance over at a house nearby, you see a figure clearly in the window.</p>");
			else if (!checkPersonFlag("Brandi", 2)) md.write("<p>After Kylie put her clothes back on, and then jumps up and waves at someone in the backyard of her house. You are fairly sure who it is...</p>");
			else md.write("<p>You see her glancing occasionally towards her home, as if hoping her mother would be one of those walking along and see her daughter!</p>");
			startQuestions();
			if (!checkPersonFlag("Brandi", 1)) addLinkToPlace(md, "look at the person Kylie glanced at", Place, "type=seebrandi1");
			else if (!checkPersonFlag("Brandi",
					2)) addLinkToPlace(md, "wave at Aunt Brandi", Place, "type=seebrandi2");
			addLinkToPlace(md, "sometime later...say goodbye for now", Place);
			WritePlaceFooter(md);
			return true
		}
		if (Place == 269 && sType == "kyliepool") {
			WaitHereOnly(6);
			md = WritePlaceHeader();
			this.showPerson("kylie-pool.jpg");
			addPlaceTitle(md, "Swimming with Kylie");
			md.write("<p>Kylie arrives, dressed in a cute pink bikini, smiling broadly as she shows off her swimsuit and her figure.</p>");
			startQuestions();
			addLinkToPlaceC(md, "it is fairly private here...",
				Place, "type=kyliepoolsex");
			addLinkToPlaceC(md, "say goodbye to Kylie", Place);
			WritePlaceFooter(md);
			return true
		}
		if (Place == 269 && sType == "kyliepoolsex") {
			md = WritePlaceHeader(false, "td-left-large");
			this.showPerson("kylie-pool-sex.jpg");
			addPlaceTitle(md, "Being Discrete and Private with Kylie");
			md.write("<p>You ask your cousin to play with you more privately, and she seductively removes most of her swimsuit and kneels on a sub-lounge waiting for you.</p>");
			startQuestions();
			addLinkToPlaceC(md, "later...say goodbye to Kylie",
				Place);
			WritePlaceFooter(md);
			return true
		}
		if (Place == 144)
			if (sType == "kiss") {
				md = WritePlaceHeader();
				this.showPersonRorX(perYou.isMaleSex() ? "kylie5b.jpg" : "kylie5g.jpg");
				addPlaceTitle(md, "Kiss Kylie");
				md.write("<p>The two of you move to a somewhat secluded area behind a few bushes and you pull Kylie closer, your lips touching as you exchange a tender kiss.</p>" + "<p>\u201cHmh, That was great, cuz, but not the type of kiss I had in mind.\u201d Kylie looks around to make sure no one is able to see you two, for now, and slips onto her knees, quickly taking off your pants and ordering you to sit down.</p>" +
					"<p>Yes, even under your spell she is the one giving the orders, you've gotten used to it by now.</p>" + "<p>\u201cYou know we are easily spotted here?\u201d You ask, and your Cousin gives you an exited grin while her fingers begin to tease your " + (perYou.isMaleSex() ? "cock" : "pussy") + ".</p>" + "<p>\u201cJust means we need to hurry a little.\u201d</p>");
				if (perYou.isMaleSex()) md.write("<p>And with that, her soft lips wrap around your manhood and slide forward almost to the base with a softly vibrating hum. It's surprising how good your Cousin is at this, she may lack the finesse and experience of older women, but she knows the basics well and is able to use her tongue to improve the experience.</p>" +
					"<p>You remain somewhat vigilant while Kylie's head bobs up and down, but aside from a few students hurrying to the locker rooms in the distance, the field is empty, and soon you don't really care for them ether.</p>" + "<p>Kylie shifts her position a little, and boy, she wasn't kidding about hurrying up, you warn her about your approaching climax, and as it hits, she eagerly takes in every single drop, cleaning your shaft with a few quick laps of her tongue and pressing a kiss to the tip.</p>");
				else md.write("<p>And with that, her soft lips wrap around your clit to suck it in and allow her to teasingly flick her tongue over it. It's surprising how good your Cousin is at this, she may lack the finesse and experience of other women, but she knows the basics well and is able to use her tongue to improve the experience.</p>" +
					"<p>You remain somewhat vigilant while Kylie's tongue begins to slide over your folds and her fingers push into you, but aside from a few students hurrying to the locker rooms in the distance, the field is empty, and soon you don't really care for them ether.</p>" + "<p>Kylie shifts her position a little, and boy, she wasn't kidding about hurrying up, her fingers massaging along your inner walls while she focuses her tongue fully on your clit to push you to your climax, and as it hits, she eagerly cleans your mound with a few quick laps of her tongue and presses a kiss to your clit.</p>");
				startQuestions();
				if (isShopOpen(2)) addLinkToPlace(md, "enter the School", 70);
				if (isPlaceKnown("Park")) addLinkToPlace(md, "walk into the park", 63);
				addLinkToPlace(md, "return to the front of the school", 9);
				WritePlaceFooter(md);
				return true
			}
		return false
	};
	per.isPhoneable = function() {
		return this.isCharmedBy() && this.checkFlag(3)
	};
	per.callThem = function() {
		if (!isDay() || getHour() > 12 || this.checkFlag(6)) {
			WriteComments("You call Kylie, but there is no answer.");
			this.setFlag(5)
		} else if (Place == 269 && checkPlaceFlag("Hotel",
				11)) {
			gotoPlace(Place, "type=kyliepool");
			receiveCall("", 'You call Kylie and invite her to join you at the pool for a swim, and she mmediately answers, "Sure Cuz, sounds like fun!"');
			WriteCommentsFooter(bChat, bChatLeft)
		} else if (!isOutside()) WriteComments("You call Kylie, but there is no answer, you should try again somewhere else. Your phone is not the best and you are getting a poor signal here inside.");
		else if (Place != 37) WriteComments("You call Kylie, and speak to her, but she says she has only a little free time, and asks you to meet her on Cherise Rd, but to call once you get there");
		else {
			gotoPlace(Place, "type=streetmeet1");
			receiveCall("", "You call Kylie and she immediately answers, and says she will be there in a minute!");
			WriteCommentsFooter(bChat, bChatLeft)
		}
	};
	per.addPersonPhoneCall = function() {
		if (!this.checkFlag(3) && this.isCharmedBy() && getHour() < 12)
			if (makeCall(true, 290)) this.setFlag(3);
		if (!this.checkFlag(4) && this.checkFlag(5))
			if (makeCall(true, 291)) this.setFlag(4);
		return false
	};
	per.getPersonSMS = function(id) {
		if (id == 290) return receiveSMS("Kylie", "Hey cuz, give me a call sometime. I am often free in the mornings, or can get free. Next time you are near Cherise Rd let's hook up",
			"kyliesms1.jpg");
		if (id == 291) return receiveSMS("Kylie", ' "Sorry, tied up now", hahaha! Seriously, from a fun night a while ago!', "kyliesms2.jpg");
		return ""
	}
}

function CharmLauren(md) {
	var perLauren = findPerson("Lauren");
	var myLord = perLauren.getYourNameFor();
	if (Place == 18) setPersonOther("Sarah", getPersonOther("Sarah") + .1);
	AddMana(-10);
	perLauren.extra[0] = perLauren.extra[0] + 1;
	if (perLauren.extra[0] == 1) {
		setQueryParams();
		showPopupWindow("Charming Lauren", "<img src='Images/lauren10-1.jpg' class='imgpopup' alt='Lauren'>" + "You attempt to cast the spell, and the maid starts to react looking at you with some desire, but then she shakes her head and touches a ring on one of her fingers.<br><br>" +
			"You see the protection you were told about is there, a weak protection, but sufficient.<br><br>" + "With some confusion Lauren leaves you, seeming to agree that you want her...to leave.")
	} else if (perLauren.extra[0] == 2) {
		setQueryParams();
		showPopupWindow("Charming Lauren", "<img src='Images/lauren10-2.jpg' class='imgpopup' alt='Lauren'>" + "You attempt to cast the spell, and the maid definitely reacts as she looks at you with desire, but then she shakes her head and touches a ring on one of her fingers, fiddling with it, almost removing the ring.<br><br>" +
			"You see the protection you were told about is there, but only barely.<br><br>" + "With some confusion Lauren leaves you, seeming to agree that you want her...to leave.")
	} else {
		perLauren.charmThem(4);
		showPopupWindow("Charming Lauren", "<img src='Images/lauren10-3.jpg' class='imgpopup' alt='Lauren'>" + "You cast the spell, and the maid reacts as she looks at you with lust, and she touches a ring on one of her fingers and purposely removes it. She proceeds to strip some of her clothing,<br><br>" + '"Yes, ' +
			myLord + ' how may I serve you"<br><br>' + "She seems completely under the influence of the spell, no slow submission, instantly your slave, with no real control or choice!" + (Place == 18 ? "<br><br>Lauren takes you to the guest room so she can better <b>serve</b> you there." : ""), "gotoPlace(290,'type=laurenplay')")
	}
}

function initialiseLauren() {
	addPerson("Lauren");
	per.getYourNameFor = function() {
		return perYou.getLord()
	};
	per.extra[0] = -1E3;
	per.isPersonInfo = function() {
		return this.isCharmedBy()
	};
	per.getPersonInfo = function() {
		return this.addPersonString("lauren1b.jpg", "height:max%", "right", undefined, "", true) + "Lauren is the faithful servant to the Gates family and now a devoted slave to you! Through serving Sarah she serves you because you ordered her to be a companion to Sarah and be with her. She was reluctant at first as her desire was to move into your Mother\u2019s house to be YOUR family\u2019s maid. Imagine a personal maid at your whim! Keeping the house fresh and clean, she can even cook some great food not mentioning the sexual services she could offer. Though the idea was tempting you talked Lauren out of this. You need someone who keeps an eye on " +
			(isMurderPath() ? "Sarah. She" : "Sir Ronald and Sarah. Both") + " can be quite secretive at times.<br><br>" + "Lauren has been working for Sir Gates for years and has and has a bizarre relationship with Sarah as she likes to describe it. She vaguely mentioned some kind of blackmailing involved between them, but she didn\u2019t talk about more. You should ask her about that, because it really is strange that the Madame of such importance as Sarah would regularly have sex with a lowkeep servant like Lauren.<br><br>" +
			"Lauren curtsy you at the instant moment she sees you. She whispers you, her " + perYou.getLord() + ", about what " + (isMurderPath() ? "Sarah has" : "the Gates have") + " been doing today, feeding you information about anything important she came across. She does this everytime she meets you, so you can be up to date with what is happening at the Mansion."
	};
	per.getPersonAddress = function() {
		return this.checkFlag(1) || this.checkFlag(10) || getPersonOther("Sarah") >= 101 ? "Gate's Mansion" : ""
	};
	per.whereNow = function() {
		if (Place ==
			290)
			if (isMurderPath() || this.isCharmedBy() || sType == "escort") return Place;
		return this.place
	};
	per.showEventPopup = function() {
		if (sType !== "" || Place != 124) return false;
		if (isConspiracyPath() && perYou.FindItem(26) > 0 && !this.checkFlag(10)) {
			showPopupWindow("Meeting Lauren", "<img src='Images/lauren11a.jpg' class='imgpopup' alt='Lauren'>" + "The Broken Inn Hotel has a few customers around the bar area, and your eyes are drawn to an attractive young lady. You have never seen her before, but she seems to know you as she walks towards you with clear purpose. For a moment you feel uncertain, is she working for Davy or someone else? You prepare for the worst,<br><br>" +
				'"Hello ' + perYou.getLord() + ", and '" + (perYou.isBornMale() ? "Mr" : "Miss") + " Not Apprentice' I was asked to meet you by my Lady and she told me to call you that and say that she is your ally.\", suddenly you realise she is from your mysterious benefactor and 'co-conspirator'! You ask her who she is and what she wants, and she answers awkwardly,<br><br>" + '"' + perYou.getLord() + ' I am Lauren, Maid to Lady...to my Lady. I have been asked to deliver you a message but not here, there are too many people. My Lady ordered..told me that the pool is often empty and there are many private places to..to..talk. I will go there, please join me there when you can...I must...must change, my Lady <i>insisted</i>.."<br><br>' +
				"She blushes and looks very embarrassed but then covers up her discomfort and gives you a little curtsy and walks off towards the pool area.<br><br>" + "Odd, it seems this maid has a strange relationship with your 'noble ally'. You wonder if she might be the young lady Victoria at the Antiques " + getShopStore(true) + " talked about who sold the old stone?");
			this.place = 269;
			this.setFlag(10);
			return true
		}
		return false
	};
	per.showEvent = function() {
		var md;
		if (Place == 290 && sType == "laurenplay") {
			var chc = Math.floor(Math.random() *
				3);
			md = WritePlaceHeader(false, chc !== 0 && !perYou.isMaleSex() ? "td-left-med" : "");
			if (chc === 0)
				if (isMurderPath()) this.showPerson("lauren5-day.jpg", "height:max");
				else this.showPersonDN("lauren5.jpg", "height:max");
			else if (perYou.isMaleSex()) this.showPersonRandom("lauren9b", 2, "height:max");
			else this.showPerson("lauren9g.jpg");
			addPlaceTitle(md, "Guest Room");
			md.write('<p>"I am so proud to service you," claims the maid. She breathes faster as you take her in your arms. Without pause her lips meet yours to plunge her tongue into your mouth.</p>');
			startQuestions();
			addLinkToPlaceC(md, "talk to Lauren", 290);
			WritePlaceFooter(md);
			return true
		}
		return false
	}
}

function RepliesLeanne(nR) {
	WriteCommentsHeader();
	if (nR == 100) {
		setPlaceKnown("MotherSuperiorsSecretRoom");
		addComments("<b>Thrall</b></p>" + '<p>"There is a concealed room that the nun did not want this thrall to know about. The thrall cannot enter it, it reeks of holyness."</p>' + "<p>The thrall shows you the mechanism for the door before lying back onto the bed seductively.</p>")
	} else if (nR == 416) {
		addComments("<p><b>Lost and Found</b></p>");
		if (perYourBody.NoItems < perYourBody.MaxItems) {
			findPerson("Louise");
			addComments("You grab the stone from the bin.");
			if (!per.checkFlag(6)) {
				per.setFlag(6);
				perYourBody.PutItem(5)
			}
		} else addComments("<p>You don't have enough room to carry any more items.  Make room and try again.</p>")
	} else if (nR == 211) {
		var perLea = findPerson("Leanne");
		if (perLea.other < 2) {
			AddCash(20);
			addComments("<p><b>General " + getShopStore(true) + "</b></p>" + "You sneak the " + sCurrency + "20 into your pocket before Leanne returns. <br>");
			perLea.other = 2
		}
		Place = 195
	} else if (nR == 19555) {
		addComments("<p><b>Buying the Scissors</b></p>");
		if (perYourBody.NoItems == perYourBody.MaxItems) addComments("<p>You don't have enough room to carry any more items.  Make room and try again.</p>");
		else if (nMoney > 4) {
			AddCash(-5);
			perYourBody.PutItem(55);
			addComments("You pay " + sCurrency + "5 and tuck the scissors into your backpack.")
		} else if (nMoney < 5) addComments("You do not have enough money. The scissors cost " + sCurrency + "5.")
	} else if (nR == 19556) {
		addComments("<p><b>Buying the Sports Bag</b></p>");
		if (nMoney > 9 && perYourBody.FindItem(47) === 0) {
			AddCash(-10);
			perYourBody.MaxItems += 20;
			perYourBody.PutItem(47);
			addComments("You pick up the sports bag and sling it over your shoulder, you should be able to carry more things now.")
		} else if (nMoney < 10) addComments("You do not have enough money. The bag costs " + sCurrency + "10.")
	} else if (nR == 19557) {
		addComments("<p><b>Buying Some Garlic</b></p>");
		if (nMoney > 1) {
			AddCash(-2);
			perYourBody.PutItem(62);
			addComments("You buy a string of garlic and put it in your bag.")
		} else if (nMoney < 10) addComments("You do not have enough money. The bag costs " +
			sCurrency + "10.")
	} else if (nR == 19530) {
		addComments("<p><b>Buying the Shovel</b></p>");
		if (perYourBody.NoItems == perYourBody.MaxItems) addComments("<p>You don't have enough room to carry any more items.  Make room and try again.</p>");
		else if (nMoney > 14) {
			addComments("<p>You tuck the shovel under your arm and pay " + sCurrency + "15.</p>");
			AddCash(-15);
			perYourBody.PutItem(30)
		} else if (nMoney < 15 && perYourBody.FindItem(30) === 0) addComments("<p>You do not have enough money. The shovel cost " + sCurrency + "15.</p>")
	} else if (nR ==
		19528) {
		addComments("<p><b>Buying the Paperweight</b></p>");
		if (perYourBody.NoItems == perYourBody.MaxItems) addComments("<p>You don't have enough room to carry any more items.  Make room and try again.</p>");
		else if (nMoney > 2 && perYourBody.FindItem(28) === 0) {
			addComments("You put the object into your bag and pay " + sCurrency + "3.");
			AddCash(-3);
			perYourBody.PutItem(28)
		} else if (nMoney < 3) addComments("You do not have enough money. The paper weight costs " + sCurrency + "3.")
	}
	WriteCommentsFooter();
	return true
}

function wanderLeanne() {
	var perLeanne = findPerson("Leanne");
	if (perLeanne.place == 195) {
		if (perLeanne.other >= 5 && perLeanne.other < 20) {
			perLeanne.other += 5;
			if (perLeanne.other >= 20) {
				perLeanne.place = 325;
				if (isDemonFreed()) perLeanne.charmThem(4, "Demon");
				movePerson("Louise", 195)
			}
		}
		if (isDemonFreed() && Place != 2 && Place != 9)
			if (wherePerson("Louise") != 195 && perLeanne.other < 20) {
				perLeanne.other = 25;
				perLeanne.place = 325;
				perLeanne.charmThem(4, "Demon");
				movePerson("Louise", 195)
			} else if (perLeanne.place == 195 && !perLeanne.isCharmedBy("Demon") &&
			!isDemonQuestDone()) perLeanne.charmThem(4, "Demon")
	}
}

function influenceLeanne(no) {
	findPerson("Leanne");
	per.setInfluenced(per.getInfluenced() + no)
}

function initialiseLeanne() {
	addPerson("Leanne", 195);
	per.extra = [0, 0];
	per.getInfluenced = function() {
		return this.extra[1]
	};
	per.setInfluenced = function(no) {
		this.extra[1] = no
	};
	per.hadSexYourself = function() {
		return this.checkFlag(12) || this.checkFlag(5)
	};
	per.Replies = RepliesLeanne;
	per.getPersonAddress = function() {
		return "3 Amaranth Pl, Glenvale"
	};
	per.isPersonInfo = function() {
		return true
	};
	per.getPersonInfo = function() {
		if (this.isCharmedBy("Demon")) return "<img src='Images/leanne8t.jpg' class='imgpopup' alt='Leanne'>" +
			"<p>Leanne has been turned into a thrall...</p>" + "<p>Your best friends soul has been taken by the demon you accidentally helped to summon into this world and her body is being used as bait to lure others into the creatures grasp.</p>" + "<p>The thought alone is enough to make your innards constrict violently.</p>" + "<p>You know little about what actually happens to the ones Legion claims. Leanne's... the thralls eyes  are blank and empty, and while it speaks with your friends voice, it is clear that unlike those under the influence of the charm spell, there is nothing left of her personality.</p>" +
			"<p>Worst of all, being in her... the thralls mere presence makes your body shiver with desire. You have always found Leanne to be attractive, but only now do you realize how beautiful and sexy she actually is, and you are not quite sure what to make of these new feelings.</p>" + "<p>You hope that the real Leanne is still somewhere in there and can be saved, but for now, you will have to find out more about the Demon and what exactly it did to her first.</p>";
		if (this.getCharmedLevel() == 4) return "<img src='Images/leanne1a.jpg' class='imgpopup' alt='Leanne'>" +
			"<p>Leanne used to be your best friend, and now she is one of your favorite slaves, sometimes things take a weird turn.</p>" + "<p>You are still not quite sure what suddenly made you desire a girl for whom you have never felt anything but friendship, but it doesn't matter anyway. She is now yours and both of you could not be happier.</p>" + "<p>You are often visiting your slave at home or work and take great care to teach her how to serve you properly, and every day she rewards you by turning more and more into your perfect little slut and serving with enthusiasm like you would never have expected from her, even under your spell.</p>" +
			"<p>She has begun teaching you about the ins and out of managing her " + getShopStore() + " so you can one day take over and she may devote all her time to be your perfect slave, and while it will be awhile until you are able to use it to supplement your personal income, you believe you do have a few ideas to ensure employee motivation.</p>";
		else if (this.getCharmedLevel() == 1) return "<img src='Images/leanne1a.jpg' class='imgpopup' alt='Leanne'>" + "<p>You would never have dreamed that your relationship with Leanne would turn out this way, but with a little magical help she has all but forgotten her time under Legions control and turned out to be a really sweet, loving girlfriend with the type of fun and kinda bubbly personality you had almost forgotten she used to have every day.</p>" +
			"<p>Still, you are not sure you made the right choice. Leanne was always strictly a friend, even though it turned out she had hidden feelings for you, but you have really broken her trust by charming her and do wonder how much of your sudden desire to add her to your harem was your own and not influenced by the thralls glamour.</p>" + "<p>You know you can never go back to the way things were between you two, but on the other hand, why would you want to?</p>" + "<p>Leanne is really happy to be with you and no longer troubled by the aftermath of her possession. Also, you would lie to say your feelings for her have not changed in the last days and you thoroughly enjoy every minute spend with her as she is now.</p>";
		else if (this.checkFlag(16) && this.getInfluenced() === 0) return "<img src='Images/leanne1a.jpg' class='imgpopup' alt='Leanne'>" + "<p>Not much has changed between you and Leanne, and you are thankful for it.</p>" + "<p>Thanks to your help, Leanne is still the same person she was before her encounter with Legion, and while she makes it clear that she is not happy about a lot of the things you use your magic for, she still believes in you as a person and the two of you still share a strong bond of friendship.</p>" +
			"<p>Still, not everything is as it was. Both of you still feel the aftereffects of the thralls glamour, weak as it is now, and the two of you have to decide how to deal with these new feelings sooner or later, and while Leanne is lenient when it comes to you using your magic to enthrall people, she makes it clear that she does not approve of it and will often try to, more or less subtly, steer you into what she believes to be the right direction.</p>" + "<p>All things aside though, it feels good to have someone like her to talk to. Leanne doesn't mince words and there are preciously few people who know about your magical abilities and are not spellbound to treat everything you say as pure gold, so maybe she has a point and you should be more careful with the charm.</p>" +
			"<p>Maybe.</p>";
		return "<img src='Images/leanne1a.jpg' class='imgpopup' alt='Leanne'>" + "Leanne is you good friend and you originally met her when she became good friends with your sister Tracy. While they are still friends they are no longer as close as they were." + "<br><br>" + "Leanne's parents owned and ran this " + getShopStore() + ", but unfortunately they died in an accident last year. It was over this tragedy that you became close friends with her and became aware of her religious beliefs, something she had never discussed before. Leanne has been running the " +
			getShopStore() + " since then, and after a rough start she is doing well. At times she complains about wanting something different, but she also enjoys dealing with people and generally running the business." + "<br><br>" + "You consider her to be your best friend now, and you have never had any romantic thoughts towards her. She has been in a number of non-serious relationships, occasionally double dating with Tracy."
	};
	per.whereNow = function() {
		if (this.place == 325) {
			if (this.isCharmedBy("Demon")) return 325;
			if (!isDay()) return 0
		}
		return this.place
	};
	per.passTimeDay = function() {
		if (this.place == 450 && this.getInfluenced() > 4 && this.checkFlag(16) && !this.isCharmedBy())
			if (!this.checkFlag(20)) this.setFlag(20);
			else this.place = 9999;
		return ""
	};
	per.showEventPopup = function() {
		if (Place == 2 || Place == 9 || Place == 63 && sType == "jessepark" || Place == 374) wanderLeanne();
		if (Place == 195 && this.place == 195 && !this.checkFlag(1)) {
			this.setFlag(1);
			showPopupWindow("Leanne", "<img src='Images/leanne1a.jpg' class='imgpopup' alt='Leanne'>" + "This " + getShopStore() +
				" is run by a good friend of yours, Leanne. You originally met her when she became good friends with your sister Tracy. While they are still friends they are no longer as close as they were." + "<br><br>" + "Leanne's parents owned and ran this " + getShopStore() + ", but unfortunately they died in an accident last year. It was over this tragedy that you became close friends with her and became aware of her religious beliefs, something she had never discussed before. Leanne has been running the " + getShopStore() +
				" since then, and after a rough start she is doing well. At times she complains about wanting something different, but she also enjoys dealing with people and generally running the business." + "<br><br>" + "You consider her to be your best friend now, and you have never had any romantic thoughts towards her. She has been in a number of non-serious relationships, occasionally double dating with Tracy.");
			return true
		}
		return false
	};
	per.showEvent = function() {
		var md;
		var s;
		var nInf;
		if (Place != 450) return false;
		if (sType.substr(0, 5) == "charm") {
			md = WritePlaceHeader();
			nInf = this.getInfluenced();
			if (sType == "charm1") {
				this.showPerson("leanne9a.jpg");
				addPlaceTitle(md, "Leanne Under a Charm Spell");
				if (nInf < 5) md.write("<p>You chat with her for a while and wait for an opportunity to arise, and as Leanne moves to the fridge to get herself something to drink, you quietly whisper the words of the spell and guide a small portion of your mana into her body.</p>" + "<p>Leanne gasps, her cheeks flushing red as a wave of arousal begins to spread inside her, but for now, she seems more concerned that you might notice it than with the fact that it is happening.</p>" +
					"<p>From now on, there is no going back, Leanne, your best friend, will be bound by your spell, and you can only decide what you want her to be.</p>");
				else md.write("<p>Dai Chu, Leanne! You make no attempt to hide the casting of your spell, Leanne may know about your magic, but you catch her by surprise and she is not Kate, so it is not like she will be able to do anything to stop you from completing it.</p>" + "<p>You see confusion in Leanne's eyes as the mana begins to spread within her, then fear as she realizes what you did and backs away, her cheeks flushing red with arousal and her breathing increasing in pace while you calmly watch the spell taking hold. She may not have the same feelings she had for you anymore, but it does not matter.</p>");
				startQuestions();
				if (nInf < 5) addLinkToPlaceO(md, "reinforce her existing feelings for you and let her be your lover", 450, "type=charm2lover");
				addLinkToPlaceO(md, "let the spell fully dominate her mind, she will make a wonderfully slutty slave", 450, "type=charm2slave")
			} else if (sType == "charm2lover") {
				this.showPerson("leanne10.jpg");
				addPlaceTitle(md, "Leanne Under a Charm Spell");
				md.write("<p>You ask Leanne if everything is alright and she hastily nods.</p>" + "<p>\u201cYes... yes. I have been having these... feelings ever since you freed me from the demon, this is just a little... stronger than usual.\u201d</p>" +
					"<p>Leanne sits back down, but nervously slides over the stool while trying her best to find a way back into the conversation and keep her eyes averted from your crotch/chest.</p>" + "<p>\u201cMaybe I should leave?\u201d You finally suggest with fake concern, explaining that your presence might be making things worse, and Leanne quickly blurts out a loud \u201cNo!\u201d seemingly surprised by her reaction herself.</p>" + "<p>\u201cI mean, no need to, it's alright... why would you make things worse?\u201d Leanne is clearly squeezing her legs together now, her eyes loosing focus, but she is still determined to not show you her arousal.</p>");
				startQuestions();
				addLinkToPlaceO(md, "remind her of what the Thrall told you", 450, "type=charm3lover")
			} else if (sType == "charm3lover") {
				this.showPerson("leanne11.jpg");
				addPlaceTitle(md, "Leanne Under a Charm Spell");
				md.write("<p>\u201cIt's just, the Thrall told me you had feelings for me... before all this, feelings you never spoke about.\u201d You explain to her that you are \u201cworried\u201d your presence might make her desire even worse, and Leanne brushes it off with a giggle.</p>" + "<p>\u201cDon't joke about this, it's enough to constantly have Tracy send me naughty pictures and suggestive messages without you joining in, too...\u201d She casually pushes her top down and gives you a beautiful view of her breasts.</p>" +
					"<p>\u201cI am just... really hot and need to cool off a little.\u201d</p>");
				addLinkToPlaceO(md, "suggest that she undresses fully", 450, "type=charm4lover")
			} else if (sType == "charm4lover") {
				this.showPerson("leanne12.jpg");
				addPlaceTitle(md, "Leanne Under a Charm Spell");
				md.write("<p>Leanne hesitates for a few seconds to contemplate your suggestion, but in the end, agrees. \u201cWell... there is nothing on me you have not had plenty of time to see, no?\u201d</p>" + "<p>A part of her likely realized that something can not be right, but thanks to her own stalling, the mana had enough time to muddle her mind, and she happily takes off her clothes and stretches herself before you, completely naked and even more sexy than you remember her when she was a thrall.</p>" +
					"<p>\u201cBetter?\u201d You slowly let your eyes wander over her body as you ask, and Leanne shivers visibly. \u201cNo... If any, I feel even more...\u201d She bites her lower lip, her eyes wandering to your " + (perYou.isMaleSex() ? "crotch" : "chest") + " for a second.</p>");
				startQuestions();
				addLinkToPlaceO(md, "Push her to accept her feelings", 450, "type=charm5lover")
			} else if (sType == "charm5lover") {
				this.showPerson("leanne13.jpg");
				addPlaceTitle(md, "Leanne Under a Charm Spell");
				md.write("<p>\u201cMaybe I can help.\u201d You rise from your own seat and take a step toward her. \u201cBut you will need to be honest with your feelings, Leanne.\u201d</p>" +
					"<p>Her body is taken by a shudder as you speak her name and step closer, she opens her lips in protest, but you press a finger to them. \u201cI am not teasing you or making jokes, and I do not think the thrall lied to me, so...\u201d You place both elbows on her shoulders, move your lips close to hers as you push her onto the stool behind her and whisper softly: \u201cDo you love me... Leanne?\u201d</p>" + "<p>\u201cYes...\u201d She breathes the answer in a barely audible whisper. \u201cDeep inside, I always did... but I was afraid to act... I didn't want to ruin our friendship...\u201d</p>" +
					"<p>Many things make sense now in retrospect, but you admit you never would have even dreamed she harbored these feelings, much less of reciprocating them. But your own feelings changed when you found her in the ruined mausoleum and you suddenly saw her not as your friend, but as a woman, naked, beautiful and undeniably sexy.... and you just had to have her.</p>" + "<p>Your head moves forward and the two of you share a brief kiss, soft and hesitant, but it sends both your hearts racing.</p>" + "<p>\u201cYou did something to me, did you? With your magic...\u201d She suddenly asks and you nod, watching as a brief expression of sadness and betrayal in her eyes is quickly washed away by blissful devotion and a soft pink glow as the spell finishes claiming her mind.</p>" +
					"<p>\u201cYou are an asshole, " + perYou.getPersonName() + "\u201d She says with a laughter, and it likely is not meant as a joke and may be the first time to hear her insult someone that directly. \u201cBut for now, I'm just glad to be with you.\u201d</p>" + "<p>Her lips touch yours again and you share another kiss, deep and passionate this time, her naked body pushing against yours.</p>");
				startQuestions();
				addLinkToPlaceO(md, "help her release some of her pend up desires", 450, "type=charm6lover")
			} else if (sType ==
				"charm6lover") {
				this.showPerson("leanne14.jpg");
				addPlaceTitle(md, "Leanne Under a Charm Spell");
				md.write("<p>Leanne helps you undress and you guide her to lay down on the stairs, where she eagerly presents herself to you, her legs spreading to lewdly show her shaved pussy.</p>" + "<p>You drive your fingertips over her tights and to her sides as you lean in and softly kiss her above the bellybutton while she spreads her arms with a soft moan, clearly enjoying your attention. \u201cI can't believe this is really... ahhh..\u201d</p>" +
					"<p>Her body twitches as you move your lips down and begin teasing her clit with your tongue, a needful moan leaves her lips and only encourages you to go on and spread her labia with two fingers.</p>" + "<p>\u201cPlease " + perYou.getPersonName() + "...\u201d She gasps. \u201cDon't make me wait any longer, I want... I need to feel you in me/your full body against mine.</p>" + "<p>You pull Leanne into your embrace and before you know, the two of you find yourself on the floor, your bodies passionately intertwined, touching, gasping, moaning softly as you finally seize the chance to touch and explore each other.</p>" +
					"<p>Finally, you spread her legs, guide " + (perYou.isMaleSex() ? "your shaft into her sex and begin to slowly roll your hips against hers" : "your clit against hers and begin to gently rub your bodies together") + ".</p>" + "<p>Leanne seems to be in haven, her hands desperately holding on to one of the stools and every little motion seems to lure a new blissful noise from her lips, panting, moaning, gasping every second you take her.</p>" + "<p>As she reaches her orgasm, the first of many today, her arms wrap around you as if unwilling to let you go, and the two of you share another kiss.</p>");
				startQuestions();
				addLinkToPlaceO(md, "talk to Leanne more", 450);
				addLinkToPlace(md, "leave the house", 38)
			} else if (sType == "charm2slave") {
				this.charmThem(4);
				this.showPerson("leanne9b.jpg");
				addPlaceTitle(md, "Slave Leanne Under a Charm Spell");
				md.write("<p>\u201c" + perYou.getPersonName() + "... I'm...\u201d You notice your mana spreading through her body at a rapid pace, her possession potentially leaving her more attuned to its effects, and you smile as you interrupt her.</p>" + "<p>\u201c...feeling horny? Your mind clouding by a haze of desire? A desire to serve?\u201d</p>" +
					"<p>You put a strong emphasis on the last word and watch as your friends body trembles under a wave of pleasure, forceful enough that she needs to support herself on one of the stools. Her eyes are wide open as she realizes what is happening, focused on you \u201cWhy...?\u201d</p>");
				startQuestions();
				addLinkToPlaceO(md, "tell her it was destined to be", 450, "type=charm3slave")
			} else if (sType == "charm3slave") {
				this.showPerson("leanne10b.jpg");
				addPlaceTitle(md, "Slave Leanne Under a Charm Spell");
				md.write("<p>\u201cDo you remember what you told me about your ancestors? How they were servants of Kurndorf.\u201d You slowly move towards her, and as Leanne tries to get away, you simply order her in a firm voice to stay right where she is and not move or speak.</p>" +
					"<p>\u201cI've been thinking about it.\u201d You explain as you push her skirt up and pull down her panties. \u201cYou are meant to serve a powerful warlock just as they did, Leanne.\u201d She shivers as your hands travel over her tight and faintly brush along her nether-lips. \u201cYou were meant to serve me!\u201d</p>");
				startQuestions();
				addLinkToPlaceO(md, "order her to turn around and pull her dress up", 450, "type=charm4slave")
			} else if (sType == "charm4slave") {
				this.showPerson("leanne12b.jpg");
				addPlaceTitle(md,
					"Slave Leanne Under a Charm Spell");
				md.write("<p>Leanne follows your order without any hesitation and presents her by now glistering pussy to you, but you can still see resistance in her eyes. \u201c" + perYou.getPersonName() + ", please, you can't...\u201d</p>" + "<p>\u201cOf course I can, Slave.\u201d You silence her by placing a finger on her lips. \u201cI am your " + perYou.getMaster() + ", and you will address me as such.\u201d</p>" + "<p>You see a plethora of emotions play on Leanne's face, defiance, anger, but most of all... sadness, and you watch as  they all fade the more her arousal increases, replaced with lust, need and desire as she looses the battle against your spell.</p>");
				startQuestions();
				addLinkToPlaceO(md, "remove the rest of her clothing and push her onto the stool", 450, "type=charm5slave")
			} else if (sType == "charm5slave") {
				this.showPerson("leanne13.jpg");
				addPlaceTitle(md, "Slave Leanne Under a Charm Spell");
				md.write("<p>Leanne only wore a light dress, and she does not fight back in the slightest as you push it over her shoulders and her naked body onto one of the stools.</p>" + "<p>\u201cNow tell me what you are.\u201d You tenderly caress her cheek and move your lips close to hers, looking deeply into her eyes.</p>" +
					"<p>\u201cI am a slave...\u201d she whispers, and you roughly push her back against the pillar.</p>" + "<p>\u201cA slave, what?\u201d</p>" + "<p>\u201cI am a slave, " + perYou.getMaster() + ", I am your slave, " + perYou.getMaster() + ".\u201d she blurts out, her body trembling under your touch.</p>" + "<p>\u201cAnd why are you a slave?\u201d You drive your free hand over her stomach and your fingers briefly caress her shaved mound.</p>" + "<p>\u201cBecause I want to be, " + perYou.getMaster() + ", I was meant to be your slutty servant from the day we met!\u201d</p>" +
					"<p>\u201cAnd you will never desire anything more than to be mine with body heart and soul, to be the perfect slave you were always meant to be? A slut who is always wet, knowing that only I can and will satisfy her desires?\u201d</p>" + "<p>\u201cOh please yes, " + perYou.getMaster() + ".\u201d She moans in delight. \u201cPlease make me yours forever.\u201d</p>");
				startQuestions();
				addLinkToPlaceO(md, "take your new slave", 450, "type=charm6slave")
			} else if (sType == "charm6slave") {
				this.showPerson("leanne9b.jpg");
				addPlaceTitle(md, "Slave Leanne Under a Charm Spell");
				md.write("<p>You spread Leanne's legs and drive your fingers over her slit to feel her wetness, and your slaves body twitches under your touch, her eyes filling with desire, following your hands and begging for more.</p>" + "<p>Please " + perYou.getMaster() + "...\u201d She whispers. \u201cDon't make me wait...\u201d</p>" + "<p>You ponder teasing her longer, but to be honest, you want her almost as much as she wants you by now.</p>" + "<p>It may be an aftereffect of the thralls glamour, but you don't care, within seconds, you have thrown your clothing to the floor and ");
				if (perYou.isMaleSex()) md.write("push your already rockhard cock into her waiting mound.</p>" + "<p>\u201cLeanne exhales a lustful groan as you push her head against the pillar again and roughly take her, pushing into her almost dripping sex again and again with force while manipulating the mana within her to keep her arousal at peak, close to climax but never quite there.</p>");
				else md.write("press your lips against her waiting folds.</p>" + "<p>Leanne moans blissfully as your tongue tickles her clit and your fingers begin to spread her sex, and you watch in delight as her body twitches and spasms with every motion, and quickly, it is no longer enough for you.</p>");
				md.write("<p>She yelps in surprise as you drag her to the ground and straddle her face, but she immediately recognizes what she has to do and drags her tongue over your folds while you bow forward to once again tend to hers.</p>" + "<p>You make her repeat what she is again and again, your slave, your slut, your ever devoted servant, and she almost screams every word with ecstatic enthusiasm until you can finally no longer hold back, order her to cum with you and both your bodies are shaken by a mutual climax, the first of many.</p>");
				startQuestions();
				addLinkToPlaceO(md, "talk to Leanne more", 450);
				addLinkToPlace(md, "leave the house", 38)
			}
			WritePlaceFooter(md, "", false, true);
			return true
		}
		if (sType == "askher") {
			var stage = getQueryParam("stage");
			if (stage === "") {
				nInf = this.checkFlag(5) ? 3 : 0;
				if (this.checkFlag(6)) nInf++;
				this.setInfluenced(nInf)
			} else nInf = this.getInfluenced();
			md = WritePlaceHeader();
			this.showPerson("leanne8s.jpg");
			addPlaceTitle(md, "Talking to Leanne");
			md.write("<p>&quot;I'm feeling better, now, and I guess I'm as fine as someone can be who had her body taken over by a demon, watched as it was put on public display and...\u201d " +
				(this.hadSexYourself() ? "She seems to seek a good word. &quot;...\u201dused\u201d by her best friend." : "used to try to seduce some of her best friends.") + "..</p>" + "<p>It seems much of the glamours effect has finally worn off, so it has become more easy for both of you to be around each other and Leanne seems to have calmed down a little in the last days as well, " + (this.hadSexYourself() ? "at least enough for her to be wiling to talk to you again." : "and she looks a little better with a few days of rest.") +
				"<p>Her hands, however, are still fidgeting, she looks nervous, and you see her eyes lingering on your " + (perYou.isMaleSex() ? "crotch" : "chest") + " a little too long.</p>" + "<p>&quot;I'm sorry...&quot; She blushes and turns her gaze away. &quot;Ever since you released me from that... thing I've been having... desires I can't quite shake, and I still don't know what exactly that woman did to me.</p>" + "<p>But I think you do, right, " + perYou.getPersonName() + "?&quot; Leanne looks at you intently, and you nod.</p>" +
				"<p>&quot;Then can you please tell me then what is happening with me... you... with the whole damn Town!&quot; Her voice grows louder as she speaks, but she quickly calms herself.</p>" + '<p>"Sorry... I did not mean to swear...&quot; She takes a breather and crosses her heart.</p>' + "<p>You assure her that you don't mind, but she probably does deserve to know what happened, the question is, how much are you willing to tell her?</p>");
			startQuestions();
			startAlternatives(md);
			if (stage === "") {
				if (isCharmedPath()) s =
					"&quot;So... Sir Ronald Gates himself made you his apprentice? Just like that?&quot;</p>" + "<p>Leanne&rsquo;s eyes fixate on you the way they always do when she is suspicious of you, sometimes you think that girl has a build in lie detector.</p>" + "<p>&quot;You are not joking.&quot;</p>" + "<p>You explain to her that things have been happening, going into some detail about Kurndorfs Ghost guiding you to new spells, Mr Beasley&rsquo;s rivalry with the Gates family and Davy starting to use his magic to try to attack you and your family. You assume Sir gates was in dire need of someone to carry on his work, but while he has been very supportive, you don&rsquo;t know much about what this work will entail, and you are not entirely sure why he has chosen a stranger over a relative like Sarah aside from his cryptic talk about seeing something special in you.</p>" +
					"<p>&quot;So... Davy is a... Warlock as well? Is that how he was suddenly able to make Kate and Tracy fall for him?&quot;</p>" + "<p>You nod.</p>" + "<p>&quot;Dear god... this explains why she had sent me those pictures... well, more pictures than usual.&quot; Leanne murmurs. &quot;Is this... something you can do as well?&quot;";
				else if (isMurderPath(true)) s = "&quot;Y...you were there when Sir Gates was murdered? And it was Davy?!?&quot;</p>" + "<p>Leanne&rsquo;s eyes fixate on you the way they always do when she is suspicious of you, sometimes you think that girl has a build in lie detector.</p>" +
					"<p>&quot;You are telling the truth... have you gone to the police?&quot;</p>" + "<p>You tell her about Davies power and how he has started moving against you and even your family after you found the book. You were not sure who to trust, not to mention that the police would likely not believe your story about two people just appearing within the villa, shooting sir gates and vanishing, leaving you as the main suspect.</p>" + "<p>&quot;R..right.&quot; Leanne nods once in understanding. &quot;But if..Davy is a... warlock you called it, yes?&quot; You nod. &quot;Right... So he used magic to make Kate and Tracy fall for him, which explains a lot...&quot;</p>" +
					"<p>&quot;Is that something you can do as well?";
				else if (isConspiracyPath()) s = "<p>&quot;-The- Sarah Gates send you the book?&quot;</p>" + "<p>Leanne&rsquo;s eyes fixate on you the way they always do when she is suspicious of you, sometimes you think that girl has a build in lie detector.</p>" + "<p>&quot;Wow... she is a bit of a local celebrity, you don&rsquo;t really expect this sort of thing...&quot;</p>" + "<p>You explain Sarah&rsquo;s plot and how you got caught up in it. The meeting with Sir Gates and the offer that just seemed too good to be true, the later meeting with Sarah and her maid and her admission that she wants you to go out and learn spells without her uncle knowing to teach them to her.</p>" +
					"<p>You also tell her how it made you a target for Mr Beasley and Davy, a magic user himself, and of their attempts to take the book from you.</p>" + "<p>&quot;This is a lot to take in... but it explains how someone like Davy could make both Kate and Tracy fall for him... is that something you can do as well?&quot;";
				else s = "&quot;Leanne seems horrified as you tell her about the struggle with sir gates, the shot fired and how you took the book and ran.</p>" + "<p>&quot;" + perYou.getPersonName() + " you... you killed someone... you killed someone and stole from him...!&quot;</p>" +
					"<p>You try to explain that it was an accident, that you only tried to get the gun before he could shoot you, but Leanne just shakes her head.</p>" + "<p>&quot;You have to go to the police! Maybe you can... I don&rsquo;t know...&quot;</p>" + "<p>You ask her if she wants you to go to jail, or worse, and she quickly shakes her head, her voice agitated and her hands twitching as she tries and clearly fails to come up with a solution. In the end, she breathes out a defeated sigh.</p>" + "<p>&quot;Don&rsquo;t you want to make this right...? For the mans family... for your conscience?&quot;</p>" +
					"<p>You tell her you are too deeply in this to go back now and tell her about Kurndorfs Ghost, Mr Beasley and Davy&rsquo;s hunt for the book as well as the many strange things that have been happening. You don&rsquo;t dare to give up the book, and frankly, you don&rsquo;t want to.</p>" + "<p>Leanne only gives a defeated sigh.</p>" + "<p>&quot;Okay... you said Davy has taken over Tracy&rsquo;s and Kate&rsquo;s mind with magic, which explains a lot... but is this something you can do as well?&quot;";
				addQuestionR(md,
					"tell her about the Book and how you got it", s, "Leanne", "influenceLeanne(" + (isMurderPath(true) ? 3 : 0) + ")", "type=askher&stage=second");
				if (isMurderPath(false)) addQuestionR(md, "tell her about the Book, but lie about how you got it", "You make up a story about chasing the trail of the book to sir Gates and finding him dead in his room with a gunshot wound and the murderer nowhere to be found. He may have surprised a burglar, and you took the book to keep it from falling into the wrong hands.</p>" + "<p>Leanne&rsquo;s eyes fixate on you the way they always do when she is suspicious of you, sometimes you think that girl has a build in lie detector, and it may have gone off, you are not sure.</p>" +
					"<p>&quot;This is serious... have you gone to the police?&quot;</p>" + "<p>You tell her about Davies power and how he has started moving against you and even your family after you found the book. You suspect it was him who short sir Gates and were not sure who to trust, not to mention that the police would likely not believe your story about you just being there and finding him, leaving you as the main suspect.</p>" + "<p>&quot;R..right.&quot; Leanne nods once in understanding. &quot;But if..Davy is a... warlock you called it, yes?&quot; You nod. &quot;Right... At least I finally understand what happened with Kate and Tracy...&quot;</p>" +
					"<p>&quot;Is that something you can do as well?&quot;", "Leanne", "influenceLeanne(1)", "type=askher&stage=second");
				addQuestionR(md, "tell her about the Demon, but nothing about the book or the seance", "You tell her that a Demon called Legion made its way into this world and began taking the Souls of people around him, but carefully exclude your own involvement in its summoning as well as how you managed to get the relic and learn the ritual to free her.</p>" + "<p>Leanne listens closely, but doesn&rsquo;t look satisfied.</p>" +
					"<p>&quot;Okay, but how did you learn to Teleport? Or about that creepy room? Or knew what had happened to me at all?&quot;</p>" + "<p>&quot;I&rsquo;m very thankful for all you did, and I really don&rsquo;t mean to pry, but there are obviously things you are not telling me.&quot;", "Leanne", "", "type=askher&stage=second");
				addQuestionR(md, "refuse to tell her anything", "You make it clear that you are not obliged to tell her anything, your reasons and dealings are your own, and while Leanne seems startled, she will have to accept it.</p>" +
					"<p>Your refusal to clear things up leaves Leanne rattled and she is clearly on her guard now. She won&rsquo;t be very open to you, but depending on your plans for her that might not matter at all.", "Leanne", "influenceLeanne(5);setPersonFlag(\\'Leanne\\',16);setPersonFlag(\\'Leanne\\',17)", "type=askher&stage=refused")
			} else if (stage == "second") {
				addQuestionR(md, 'no point in hiding it: Your answer is "Yes, and you like it"', "Each person charmed gave you power and influence in the city, and you would lie if you&rsquo;d claim you do not vastly enjoy having an entire harem of willing women and maybe even a few men at your disposal.</p>" +
					"<p>Leanne doesn&rsquo;t quite seem to share your enthusiasm though, and the more you speak, the more worried she seems to become.", "Leanne", "influenceLeanne(2)", "type=askher2");
				addQuestionR(md, "Yes, but you believe you are careful about who you charm", "You explain to Leanne that you mostly needed help against Davy, and those under your charm could not be taken by him and would help you gain power and deal with Kurndorf and Legion as well, but you have to admit that you have not been shy about enjoying the other benefits it provided, and Leanne seems to be worried by that admission.",
					"Leanne", "", "type=askher2");
				addQuestionR(md, "refuse to answer further questions", "You make it clear that you have no intent to answer any further questions, which is pretty much an admission of guild regarding the usage of the spell.</p>" + "<p>Leanne is clearly on her guard and won&rsquo;t be very open to you now, but depending on your plans for her that might not matter at all.", "Leanne", "influenceLeanne(5);setPersonFlag(\\'Leanne\\',16);setPersonFlag(\\'Leanne\\',17)", "type=askher&stage=refused")
			} else if (stage ==
				"refused") addLinkToPlace(md, "leave the house", 38);
			endAlternatives(md);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "askher2") {
			var stage = getQueryParam("stage");
			nInf = this.getInfluenced();
			md = WritePlaceHeader();
			this.showPerson("leanne9.jpg");
			addPlaceTitle(md, "Talking to Leanne");
			md.write('<p>"Okay..." After further explanations, Leanne takes a breather.</p>' + '<p>\u201cTo sum it up, you finally found the book you were searching for all this time, but Davy tried to take it from you and used a spell to charm people into doing his bidding."</p>' +
				'<p>\u201cThen, you were taught this very spell by the ghost of Kurndorf, the powerful evil Warlock from our history books, and used it to fight back against Davy... and amuse yourself in the process."</p>' + "<p>You give Leanne a nod.</p>" + "<p>\u201cYou found the legendary witch from Kurndorfs story... Jessica, and in order to " + (!this.hadSexYourself() ? "free her" : "learn the warlocks spells") + ', she helped you call his Ghost in a seance, but the Ghost summoned the demon, Legion... who proceeded to steal the souls of various people, including myself, threatened your family and blackmailed you into stealing an artifact from the Church, which you finally used to trick and banish it..."</p>' +
				"<p>Leanne rubs her temples, but again, your confirm the story.</p>" + '<p>\u201cAnd finally, your french teacher, who is a 400 years old warrior-sexslave bound to a literal gate to hell right in our town..." Leanne\'s expression clearly underlines the ridiculousness of this statement, but she believes you." ...taught you how to free my soul, using a powerful relic you had to steal from the Museum."</p>');
			startQuestions();
			if (stage === "") addQuestionR(md, '"Quite the story, is it?"', "&quot;It is... and I&rsquo;m still not entirely sure what to think of it... or you...&quot;</p>" +
				"<p>She looks around nervously and finally back to you.</p>" + "<p>&quot;You have... tremendous power now... scary power. You have broken the law several times, but I appreciate that some of it was to help me, and you know yourself that what you do with these women is not right...&quot;</p>" + "<p>&quot;But what do you intent to do, now? What are your plans?&quot;", "Leanne", "", "type=askher2&stage=third");
			else if (stage == "third") {
				startAlternatives(md);
				addQuestionR(md, "Jessica said you are destined to rule Glenvale, and you agree",
					"You remember Jessica&rsquo;s words all to well when she called you &quot;the one whose power will be even greater than hers&quot; and &quot;the true " + perYou.getMaster() + " of Glenvale.&quot; And she honestly is not the only one who seems to believe you are more than a simple warlock.</p>" + "<p>It is clear you are meant for greatness, and the book will give you the means to follow that destiny and take what- and whoever you desire, as long as you keep increasing your magical power.</p>" + "<p>As you finish speaking, Leanne seems terrified, and well, you may have gotten a little carried away by the moment as you explained the opportunities lying before you to her, but you certainly have the means to sway her to your side, if need be, so her next question is fitting:</p>" +
					"<p>&quot;Okay... and... what is my role in this going to be? Are you planning on using that spell on me as well?&quot;", "Leanne", "influenceLeanne(2)", "type=askher2&stage=forth");
				addQuestionR(md, "something is happening in this town, and you might need more power to protect it", "<p>Ghosts are returning from the dead, dangerous creatures wander the city outskirts, and you have seen enough episodes of Buffy the Vampire Slayer to know that having a gate to Hell open</p>" + "<p>You explain that it is clear something is happening, and with Glenvale&rsquo;s previous protector, Sir Gates, dead/too old to fight it, it may very well fall on you to face whatever comes. And to do so, you need Magic power, and maybe employ the help of people who would not cooperate under most circumstances.</p>" +
					"<p>Leanne seems unsettled by your statements, but listens carefully before finally speaking again.</p>" + "<p>&quot;It sounds like you want to fight demons by becoming one yourself, " + perYou.getPersonName() + "...&quot;</p>" + "<p>You assure her that it is nothing like that, but reaffirm your belief that Glenvale does need someone ready to protect it from magical threats, and you feel like you can be that person, wielding magic is what you wanted to do all your life, after all.</p>" + "<p>Also, the &quot;benefits&quot; of the &quot;job&quot; have proven to be quite... pleasurable, though you keep that thought for yourself.</p>" +
					"<p>Leanne nods in understanding. &quot;Okay... one last question...&quot; She looks nervous. &quot;Are you planning to cast this charm on me as well?&quot;", "Leanne", "", "type=askher2&stage=forth");
				addQuestionR(md, "you actually just wanted to have fun with magic, but are not sure this is an option anymore", "You are honest in that you have no big plans. Using magic to walk through walls and teleport around just seemed like a lot of fun, making people fall in love with you after you found out it&rsquo;s possible even more so.</p>" +
					"<p>When things started to get serious you were just reacting, protecting your family from Davy and Legion, taking care of the things you&rsquo;ve unleashed and charming people because you either knew they would be able to help you or just to see how they react.</p>" + "<p>In a way, you are a little lucky you got as far as you did, but with all the talk about the hellgate and the &quot;destiny&quot; Jessica mentioned, it might be time to seriously think of the future and what you will do.</p>" + "<p>Leanne certainly agrees.</p>" +
					"<p>&quot;You will have to make a decision sooner or later about what you want to be and I pray to the lord that you will make the right one...&quot; She takes a deep, nervous breather.", "Leanne", "", "type=askher2&stage=forth");
				addQuestionR(md, "your plans are your own and don&rsquo;t concern anyone, not even her.", "It was a clear statement and while Leanne seems angry, she will have to accept, or so you think.</p>" + "<p>&quot;This concerns me very much, considering I nearly had my soul stolen by a Demon you accidentally helped summon on your quest for more magic and still get nightmares about what it did with my body...&quot; She takes a breather to calm herself.</p>" +
					"<p>&quot;Okay, one last question... that spell, are you planning to use it on me?", "Leanne", "influenceLeanne(1)", "type=askher2&stage=forth");
				endAlternatives(md)
			} else if (stage == "forth") {
				startAlternatives(md);
				addQuestionR(md, '"Yes"', "Leanne seems devastated by your answer and is starring at you in disbelieve. &quot;I can&rsquo;t believe you said that...&quot;</p>" + "<p>Did you just free me from that Demons control to do the same to me?&quot;</p>" + "<p>You calmly explain that it&rsquo;s not the same as you simply alter her mind and not take her soul, she will not even realize that she is under a spell, be protected from other Warlocks, free to live out her desires and no longer plagued by those nightmares... but those subtleties are lost on her.</p>" +
					"<p>&quot;" + perYou.getPersonName() + ", We&rsquo;ve been friends for so long, and you just told me to my face that you intent to cast a spell to control my mind... and for what? To make me yet another piece in your apparently steadily growing slave collection?&quot;", "Leanne", "influenceLeanne(2)", "type=askher3");
				addQuestionR(md, '"Of course not!"', "You&rsquo;ve been friends with Leanne for a long time, and while dealing with her as a thrall and the books influence certainly have changed the way you look at her, you don&rsquo;t want her to go through the process of loosing her free will again.</p>" +
					"<p>Leanne seems a little suspicious, but as you looked into her eyes and repeated your promise, she calms down, even smiling again, albeit briefly.</p>" + "<p>&quot;Maybe you are still the " + (perYou.isBornMale() ? "Boy" : "Girl") + " I lo...liked, crazy mind control magic or not... I just wish you would extend that courtesy to others.&quot;", "Leanne", "setPersonFlag(\\'Leanne\\',18)", "type=askher3");
				addQuestionR(md, "you have considered it, it would keep her protected", "You explain to Leanne that you are worried about other warlocks and creatures taking her mind again. The spell would keep her protected from those and also help her shake off the memories of her possession, or any doubts she might have.</p>" +
					"<p>&quot;You may have the best intentions in mind.&quot; She says. &quot;Well... maybe... but I would forfeit my free will and be at the mercy of someone else, again. Someone who I&rsquo;m not sure I&rsquo;m able to fully trust anymore...&quot;", "Leanne", "influenceLeanne(1)", "type=askher3");
				endAlternatives(md)
			}
			WritePlaceFooter(md);
			return true
		}
		if (sType == "askher3") {
			this.setFlag(16);
			nInf = this.getInfluenced();
			md = WritePlaceHeader();
			this.showPerson(nInf > 4 ? "leanne9.jpg" : "leanne8s.jpg");
			addPlaceTitle(md,
				"Finishing Talking to Leanne");
			if (nInf === 0) md.write("<p>\u201cOkay... this is still confusing... but I do think I am feeling a little better now.\u201d Leanne seems to relax a bit after your talk, even letting her guard down somewhat. \u201cI've been lucky to have you and Daria look out for me, I think, I dare not imagine what might have happened had she not found and you not rescued me.\u201d Leanne smiles to you.</p>" + "<p>\u201cI was really loosing faith, but knowing I can rely on my friends, that even during this someone still does watch out for me... it feels good.\u201d</p>" +
				"<p>You ask her if all is well between the two of you and her answer is \u201cMostly.\u201d</p>" + "<p>\u201cThere is a probably a good reason you were given these powers, sometimes he works in mysterious ways, after all, but I still don't like the thought of you going around and using your magic to take advantage of people.\u201d</p>" + "<p>You are about to reply, but Leanne interrupts you.</p>" + "<p>\u201cJust think about it, alright?\u201d She holds up one hand. \u201cYou can do so much more good with your powers like... teleporting me to work or helping me find missing keys.\u201d</p>" +
				"<p>You two share a brief laughter and it feels good to see her returning a little to her bubbly self again, and who knows, maybe she does have a point and you should dial back on using the spell... sometime.</p>");
			else if (nInf < 5) {
				md.write("<p>Leanne seems to be somewhat guarded around you, but it doesn't look like you left too bad of an impression for now.</p>" + "<p>\u201cI think those were all the questions I had... and you certainly don't get yourself into messes halfheartedly, do you?\u201d</p>" +
					"<p>\u201cApparently not.\u201d You shake your head, and the two of you share a relaxing laugh before Leanne's face turns serious again.</p>");
				if (!this.checkFlag(18)) md.write('<p>"' + perYou.getPersonName() + ", I can't stop you from using the spell on me, but remember what that would mean for us. You are still a good person, maybe you were given those powers for a reason, and I hope that you will, in the long run, make the decision to use your new gift the right way.</p>");
				else md.write("<p>I think you are still a good person, I trust your promise and maybe people are right and you were given your powers for a reason.\u201d</p><p>\u201cBut I'm sure deep down you know that what you do with these women is wrong, and I pray that you will do the right thing in the end.</p>")
			} else {
				md.write("<p>Leanne apparently didn't like what she heard in the last minutes and she is clearly on her guard now.</p>" +
					"<p>\u201cYou have changed...\u201d She finally says nervously. \u201cI don't know if it is because of the book, the magic or because of what happened to you, but you are no longer the person I used to know and honestly... you scare me, " + perYou.getPersonName() + ".</p>");
				if (!this.checkFlag(19)) {
					startQuestions();
					startAlternatives(md);
					addQuestionR(md, '"So what?"', "&quot;Right... what did I expect...&quot; she shakes her head. &quot;Fine, if that is what our friendship is worth to you, go on, do what you think you have to, but remember, our sins will at one point come back to haunt us, if not now, then in the next life.&quot;",
						"Leanne", "setPersonFlag(\\'Leanne\\',19)");
					addQuestionR(md, "assure her you are still the same", "&quot;Then act like it.&quot; She says firmly. &quot;If you truly want to prove you&rsquo;re still the friend I knew, you will stop abusing your magic to amuse yourself at others expense. If you can&rsquo;t do that, then you better do what you want to do with me and be done with it.&quot;", "Leanne", "setPersonFlag(\\'Leanne\\',19)");
					endAlternatives(md)
				}
			}
			startQuestions();
			addLinkToPlace(md, "leave the house",
				38);
			WritePlaceFooter(md);
			return true
		}
		if (!this.isCharmedBy("Demon") && !this.checkFlag(13) || sType == "firstvisit") {
			setQueryParams("type=firstvisit");
			this.setFlag(13);
			md = WritePlaceHeader();
			this.showPerson("leanne13s.jpg");
			addPlaceTitle(md, "Leanne has Returned Home");
			md.write("<p>You knock and the door to Leanne's house and she opens the door and wordlessly gestures for you to come in.</p>" + "<p>You can see she is troubled by what happened but also happy to be free.</p>" + '<p>"Thank you, thank you ' + perYou.getPersonName() +
				" I do not understand everything of what happened or you had to go through, but I know you freed me.</p>" + '<p>It is so strange, I can remember what happened when that thing was controlling me, but it is like a dream, it was not like I was aware or out of control in some way, it is just like I can remember someone elses memories."</p>');
			if (this.checkFlag(6)) md.write("<p>She hesitates, but continues,</p>" + '<p>"That thing did something wrong with my friend Daria...the Mother Superior at the Church...I do not know how to talk to her, she might think it was me...but she did seem to think I was possessed..."</p>');
			if (this.hadSexYourself()) md.write("<p>She looks at you with greatly embarrassed,</p>" + '<p>"While that thing was in my body, you..you..had sex with it! How could you!!"</p>' + "<p>You unconvincingly try to explain about how it was an attempt to find out more about the thrall possessing her, she does not seem to believe you and looks away embarrassed.</p>");
			startQuestions();
			addLinkToPlace(md, "leave the house", 38);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "pass") {
			md = WritePlaceHeader();
			this.showPerson("leanne9.jpg");
			addPlaceTitle(md, "Using Pass to Enter Leanne's Home");
			md.write("<p>You cast the spell and literally walk through the door into the house to find a startled Leanne starring at you.</p>" + "<p>\u201c" + perYou.getPersonName() + " What are you...\u201d Her voice stocks as she realizes why you are likely here.</p>");
			startQuestions();
			addLinkToPlace(md, "tell her you just want to speak with her", 38, "", "&quot;I think we have spoken enough for now, please, give me some time to come to terms with what has been happening.&quotl Leanne still looks very anxious, and you breaking into her home did not make things better. You decide it is best to leave immediately");
			addLinkToPlace(md, "Excuse yourself and leave", 38, "", "You apologize for startling her and just turn to leave the house, probably scarring Leanne half to death and not helping her to trust you again.");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "gone") {
			md = WritePlaceHeader();
			this.setFlag(21);
			addPlaceTitle(md, "Leanne's Living Room", "livingroom6.jpg");
			md.write("<p>You walk through the wall and look around, quickly noticing a few personal Items, photographs and clothes missing, and finally, you find her mobile phone, and a letter addressed to you.</p>" +
				"<p>The letter is written with a shaky hand and several parts seem to have been erased and rewritten, but you clearly recognize Leanne's handwriting</p>" + '<div style="background-image:url(UI/paper.jpg);text-align:left;padding:0 5px 0 5px;font-family: cursive;color:black">' + "<p>" + perYou.getPersonName() + ", I am sorry to let it end like this, but I can not just sit here, wait and pray that you will not decide to add me to your slave collection, so I have decided to leave Glenvale for good.</p>" + "<p>I will always remember the person who was my friend fondly, but your newfound power has changed you, and you are walking down a dark path I do not want to be part of.</p>" +
				"<p>You may think this is selfish after all you did to free me, but being under the demons control was one of the most horrible experiences in my life, and I can not risk it happening again.</p>" + "<p>I will pray every day that you will abandon this dark path, but for now, this is goodbye.</p>" + "<p>Leanne.</p>" + "<p>PS: I have told no one where I am going, I will do nothing to interfere with your plans, and if our friendship still means anything to you, you will not try to track me down.</p></div>");
			startQuestions();
			addLinkToPlace(md, "leave the house", 38);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "sexytime") {
			md = WritePlaceHeader(false, perYou.isMaleSex() ? "" : "td-left-large");
			if (perYou.isMaleSex())
				if (isExplicit()) this.showPersonX("leanne18.jpg");
				else this.showPerson("leanne12b.jpg");
			else this.showPerson("leanne24.jpg");
			addPlaceTitle(md, "Sexy Time with Leanne");
			md.write("<p>You guide Leanne directly into the living room and in between tender hugs and passionate kisses, the two of you leave behind a trail of discarded clothes all the way to the couch you finally fall onto.</p>" +
				"<p>\u201cI've been so horny all day without you...\u201d Leanne whispers as she straddles you, her fingers moving down to caress your " + (perYou.isMaleSex() ? "manhood" : "folds") + ". \u201cHow can you be so cruel and leave me alone?\u201d The two of you share a laugh before you pull your lover into another kiss and tell her the wait makes it all the more sweet when you are finally back together, making her laugh even more. \u201cYou are not going to sweet-talk your way out of this, " + perYou.getPersonName() +
				"!\u201d She says with a grin. \u201cI expect you to make up for the wait.\u201d</p>" + "<p>Of course, you \u201cgive in\u201d to her demands. Her closeness is intoxicating and with her fingers constantly caressing your " + (perYou.isMaleSex() ? "shaft" : "sex") + ", it doesn't take long for you to be ready to take her... or be taken by her, and Leanne eagerly guides " + (perYou.isMaleSex() ? "you" : "your fingers") + " into her waiting folds with a playful, over-exaggerated moan.</p><p>" + (perYou.isMaleSex() ? "You just lean back to let her ride you, both arms wrapped tightly around her body to hold her close, fondle her breasts and caress her clit," :
					"You carefully move your fingers to find her sweet-spots, twisting them occasionally and covering her neck and cheeks in soft kisses") + "to drive her further and further forward until you draw her into a deep kiss right as you are ready to reach your peak.</p>");
			startQuestions();
			addLinkToPlace(md, "talk more to Leanne", 450);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "takelead") {
			md = WritePlaceHeader(false, perYou.isMaleSex() && isExplicit() ? "" : "td-left-large");
			if (perYou.isMaleSex()) this.showPersonRorX("leanne19.jpg");
			else this.showPerson("leanne24.jpg");
			addPlaceTitle(md, "Leanne Takes The Lead");
			md.write("<p>Leanne guides you to her bedroom, Kicks the door shut with one leg and pushes you onto the bed with a smile.</p>" + "<p>You follow her lead this time, curious what she has in store and watching as she slowly removes her clothes, flinging her top into a corner and deliberately bending forward to remove her pants and underwear, giving you a good view of her buttocks.</p>" + "<p>You applaud the show and Leanne bows with a deep flourish before crawling onto the bed herself and coming to rest on top of you, her lips brushing over yours briefly, before she almost tears of your top and commits to a deep kiss.</p>" +
				"<p>You return her affections, your tongues playfully mingling while you help her undress you as well and lay back with a soft sigh while her lips wander down to your exposed neck.</p>" + "<p>\u201cI would have never even dreamed of doing this...\u201d She whispers with a soft giggle. \u201cWe really have  a lot to catch up on, do we?\u201d</p>");
			if (perYou.isMaleSex()) md.write("<p>\u201cWe do.\u201d A pleasant shudder rushes through your body as her lips touch your neck, and you close your eyes while Leanne begins to move deeper down to your chest and collarbone.</p>" +
				"<p>You feel her fingers exploring your body, massaging your chest and shoulders, tracing your bicep and sliding back down to the sides, Leanne's lips always close enough to your skin to allow you to feel her breath.</p>" + "<p>\u201cYou're good at this...\u201d You whisper softly, and hear a giggle from her. \u201cI've played through this in my head many times, and I'm going to savor it.\u201d</p>" + "<p>She shifts her position to straddle you and focus her attention fully on your cock, her fingers tracing the sensitive veins to get you hard, not that it took much by now, and finally guiding it to her folds.</p>" +
				"<p>You hear a moan as you enter her, her hip pushing down, rolling a little as she gets used to the sensation before she begins to ride you, slowly moving her body up and down but quickly growing faster and more passionate the closer the two of you get to your climax.</p>");
			else md.write("<p>You simply nod, and feel her fingers driving over your stomach in-between your legs. \u201cThen let us not waste time.\u201d She presses another kiss to your lips and feel her fingers pushing past your folds, a muffled moan vibrating into the kiss while she explores your sex, carefully at first, but soon growing bolder, relishing every single moan or gasp she lures from your lips while your body twitches with every wave of pleasure she sends into you.</p>" +
				"<p>\u201cYou practiced...\u201d You say in-between gasps, and Leanne laughs. \u201cJust for you, and there's more.\u201d You try to answer but your speech is cut short as she finds a particular sensitive spot and uses her free hand to stimulate your clit, making you feel like a jolt of electricity rushed through you.</p>" + "<p>\u201cLeanne...\u201d You manage to bring out, but she seems too eager to push you to the edge now to slow down, her motion growing faster, rougher, driving you further and further forward until you finally reach your orgasm , your lover beaming with pride.</p>");
			startQuestions();
			addLinkToPlace(md, "talk more to Leanne", 450);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "slavepussy") {
			md = WritePlaceHeader(false, "td-left-large");
			if (isExplicit()) this.showPersonX(perYou.isMaleSex() ? "leanne21.jpg" : "leanne25.jpg");
			else this.showPerson("leanne19.jpg");
			addPlaceTitle(md, "Leanne Takes The Lead");
			md.write("<p>LLeanne follows your order with enthusiasm, even wiggling her ass playfully into your direction, keeping her legs spread and playing with her pussy until you order her to stop.</p>" +
				"<p>\u201cLook how wet you already are, my little slut.\u201d You drive your fingers over her glistering folds and watch as her entire body shudders blissfully.</p>" + "<p>\u201cThis pussy is always wet for you, " + perYou.getMaster() + ".\u201d She breathes out the words, and you chuckle to yourself thinking back to how even simple lewdities would turn her head into a shining tomato.</p>" + "<p>\u201cAnd what do you want me to do with it?\u201d You ask, and Leanne doesn't even hesitate anymore before she blurts out the answer.</p>" +
				"<p>\u201cI want you to fuck it, " + perYou.getMaster() + "!\u201d She seems ready to burst from excitement. \u201d" + (perYou.isMaleSex() ? "Please stick your cock into my pussy and fuck me!" : "Please use this to fuck me!") + "\u201d</p>");
			if (perYou.isMaleSex()) md.write("<p>You grin and unzip your pants to free your cock and begin to rub the tip against her sex. \u201cTell me again what you are...\u201d You place a slap onto her rear and she gives a cute yelp.</p>" + "<p>\u201cI am " + perYou.getPersonName() + "'s obedient little slaveslut.\u201d She almost shouts into the room, grinding her hip back against you \u201cI love to serve him, and I love it when he rewards my slutty pussy with his cock.\u201d</p>" +
				"<p>\u201cThat's right.\u201d You grin. \u201cAnd never forget that, my little slut.\u201d You push your hip forward and drive your cock into her  using one hand to push her roughly against the couch and finally fuck her.</p>");
			else md.write("<p>She hands you a dildo of surprising size and you are still kind of amazed the always so restrained Leanne even has something like this.\u201cTell me again what you are...\u201d You place a slap onto her rear and she gives a cute yelp.</p>" + "<p>\u201cI am " +
				perYou.getPersonName() + "'s obedient little slaveslut.\u201d She almost shouts into the room, wiggling her hip to entice you into giving her another slap. \u201cI love to serve her, and I love it when she rewards my slutty pussy.\u201d</p>" + "<p>\u201cThat's right.\u201d You grin. \u201cAnd never forget that, my little slut.\u201d You pin her head onto the ground with one hand and push the dildo deeply into her wet pussy, twisting it around and slowly starting to drive it in and out of her.</p>");
			md.write("<p>Whatever answer she had is barely eligible, swallowed up in a stream of moans, screams and lewd profanity as she repeats that she is yours over and over again and you sate your desire on her body. When you finally reach your peak, you once again focus on the mana within her body to sync your  orgasms and Leanne happily collapses onto the couch, a blissful smile on her lips.</p>" +
				'<p>"Thank you ' + perYou.getMaster() + '. I love you..."</p>');
			startQuestions();
			addLinkToPlace(md, "talk more to Leanne", 450);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "oralservice") {
			md = WritePlaceHeader();
			if (isExplicit()) this.showPersonX("leanne20.jpg");
			else AddImage("GenericSex/sex-mf blowjob brown hair-b.jpg");
			addPlaceTitle(md, "Leannes Oral Service");
			md.write("<p>\u201cWith pleasure, Master!\u201d Leanne slips off the couch and seductively crawls towards you on all fours while you just move both hands to your back and wait for her to work.</p>" +
				"<p>\u201cI trust your are nice and wet, my little slut?\u201d You ask as she opens your pants, and she just smiles up to you. \u201cI am always wet when I think about you, Master, and I always think about you.\u201d She laughs and pulls down your pants, her eyes focusing on your half erect cock and her tongue sliding over her upper lip.</p>" + "<p>\u201cGood little slut. How would you like to be allowed to finger yourself while you suck my cock?\u201dYou gently caress her cheek and slip your thumb past Leanne's lips. \u201cIt would make your slut very happy, master.\u201d</p>" +
				"<p>\u201cThen begin, and do not slack off if you want to be allowed to masturbate for the rest of the week.\u201d</p>" + "<p>\u201cYes master!\u201d Leanne doesn't seem phased in the slightest by your little threat, and to be honest, it is an empty one, since she will always fully focus on pleasing you, no matter what. But you enjoy these little exchanges with her and she seems to have taken a liking to them as well.</p>" + "<p>As she has to your cock.</p>" + "<p>Leanne isn't the most skilled or experienced of your slaves, especially when it comes to anything outside of vanilla sex, but she is a fast learner and you are clearly reaping the benefits of it right now.</p>" +
				"<p>Her tongue slides over the thick veins on your cock and circles around the tip before she takes you into her mouth and begins to slowly move back and forth, one hand always between her legs, rubbing her clit feverishly while you slowly raise her arousal with your spell.</p>" + "<p>It doesn't take long for you to reach your climax, Leanne always has that effect on you when you are around her, and without warning you take a hold of her hair to keep her head in place as you come into her mouth and make her swallow your seed.</p>");
			startQuestions();
			addLinkToPlace(md, "talk more to Leanne", 450);
			WritePlaceFooter(md);
			return true
		}
		return false
	};
	per.showPersonChat = function(bGeneral, md) {
		if (Place == 195 && this.isHere())
			if (!this.checkFlag(22)) addQuestionR(md, "say hello To Leanne", '"Hello ' + perYou.getPersonName() + "\u201d Leanne smiles to you from behind the counter. \u201cTaking some time of from studying to visit or are you looking to buy anything?\u201d", "Leanne", "setPersonFlag(\\'Leanne\\',22)");
			else if (!this.checkFlag(23)) addQuestionRO(md,
			"you may need a few things, but mostly you just want to know how she's doing", "\u201cWell, feel free to browse.\u201d Leanne smiles brightly.</p>" + "<p>\u201cI'm stressed, but fine. Just making sure the inventory is all set up for next week and recovering from the last date Tracy organized.\u201d ", "Leanne", "setPersonFlag(\\'Leanne\\',23)");
		else if (!this.checkFlag(24)) addQuestionR(md, '"A Date? Anything serious?"', "\u201cNo, he was not bad, but it just didn't click between us, so I'm still waiting for the Mister right.\u201d Leanne sighs briefly, then grins and leans forward over the counter, how about you? Any cute girls in your life that I could get jealous over? Tracy is dropping hints, but she has been occupied of late.\u201d" +
			(perYou.isMaleSex() ? "<p>You chuckle when you hear that, Leanne occasionally jokes  about other girls stealing you from her, but you know it's all in good fun.</p>" : "<p>You can't help but smile hearing that question. Leanne is very religious, and you had feared that it would drive a wedge between the two of you when you came out to her about your sexuality, but not only was she very supportive, it seems to have only brought the two of you closer together."), "Leanne", "setPersonFlag(\\'Leanne\\',24)");
		else if (!this.checkFlag(25)) {
			var nSlaves = 0;
			for (i = 0; i < arPeople.length - 3; i++) {
				var p = arPeople[i];
				if (p.isCharmedBy()) nSlaves++
			}
			addQuestionR(md, '"There is no one  special right now"', (nSlaves === 0 ? "<p>You explain that you have barely any time to focus on passing school, and with Ms. Tanika and Mr. Beasley being especially hard on you, you can't really afford to get caught up in dating or a relationship, no matter how much Tracy tries to hook you up.</p>" : "<p>Of course, you can't just tell her about the book and what you are doing, at least not yet, so you make something up about a few casual flings, but claim that nothing is serious, which is not completely far from the truth.</p>") +
				"<p>\u201cWell, we are at least in the same boat, I guess.\u201d She looks like she is pondering something for a few seconds, but disregards the thought.</p>" + "<p>\u201cOh, I've finally pushed myself to go over the crates in the back my parents had collected before they... you know...\u201d</p>" + "<p>\u201cAnyway, I intent to put some of it on the shelves, most of it is likely not of interest to you, like the 4 dozen different paperweights, but maybe there is something you like later on.\u201d", "Leanne",
				"setPersonFlag(\\'Leanne\\',25)")
		}
	};
	per.handleItem = function(no, cmd) {
		if (no == 11 && cmd == 2)
			if (Place == 38 && this.getInfluenced() > 4 && this.checkFlag(16)) {
				CastPassSpell(450, this.place == 9999 && !this.checkFlag(21) ? "type=gone" : "type=pass");
				return "nofooter"
			}
		if (no == 14 && cmd == 2)
			if (Place == 450) {
				if (this.isCharmedBy("Demon")) addComments("The spell fails, the thrall it seems cannot be affected by this spell, she is sort of charmed after all");
				else {
					findPerson("Daria");
					var tm = nTime - per.extra[0];
					if (tm < 288) addComments("You try to cast the spell, but it fails, and you smell a strong odour of brimstone. It seems she is still affected by some residue of the demon. Maybe if you try later?");
					else if (tm < 576) addComments("You try to cast the spell, but it fails, and you smell a faint odour of brimstone. It seems she is still a little affected by some residue of the demon. Maybe if you try later?");
					else if (this.checkFlag(16))
						if (this.getInfluenced() < 5 && this.checkFlag(18)) addComments("You entertain the idea of going back on your promise and charm her anyways for maybe a second before you decide against it.</p><p>You clearly gave your best friend your word, and you will stick by it.");
						else CastCharmSpell("Leanne",
							450, 1, "type=charm1")
				}
				return "handled"
			} else if (Place == 195 && this.isHere()) {
			this.setFlag(31);
			if (!isSpellKnown("Shielded Charm")) addComments("Leanne has been a good friend almost all your life, perhaps friendship should count for something. Even if it doesn't, the " + getShopStore() + " is too public, with people entering and leaving periodically.");
			else addComments("Leanne has been a good friend almost all your life, perhaps friendship should count for something? Well, it appears not, and you cast the spell with a slight twinge. To your annoyance or is it relief, nothing happens as the spell has absolutely no effect.");
			return "handled"
		} else if (Place == 325 && this.isHere()) {
			this.setFlag(31);
			if (!this.isCharmedBy("Demon")) addComments("Leanne has been a good friend almost all your life, perhaps friendship should count for something? Well, it appears not, and you cast the spell with a slight twinge. To your annoyance or is it relief, nothing happens as the spell has absolutely no effect.");
			else addComments("Leanne has been a good friend almost all your life, perhaps friendship should count for something? Well...she has been enthralled by the demon, so maybe you can help... To your annoyance or is it relief, nothing happens as the spell has no effect, is it she has no will, or dreadfully no soul?");
			return "handled"
		}
		return ""
	};
	per.addPersonPhoneCall = function() {
		if (this.hoursCharmed() > 24 + Math.random() * 4 && this.isCharmedBy() && !this.checkFlag(14)) {
			if (makeCall(true, 170)) {
				this.setFlag(14);
				setPersonFlagAfterTime("Leanne", 15, undefined, 6 + Math.floor(Math.random() * 6))
			}
		} else if (this.checkFlag(15))
			if (makeCall(true, 171)) this.setFlag(15, false);
		return false
	};
	per.getPersonSMS = function(id) {
		if (id == 170) return receiveSMS("Tracy", "Hey lil " + (perYou.isBornMale() ? "Bro" : "Sis") + ", Leanne just send me this beauty and I believe it was meant for you. ;)",
			"leannesms1.jpg") + replyToSMS("Uhm, Thanks. ") + receiveSMS("Tracy", "Anytime. :D Btw. Are you two finally an Item?? I'll win 30 bucks if you are.");
		if (id == 171) return receiveSMS("Leanne", "This is so embarrassing! I hope Tracy really deletes that picture...") + replyToSMS("Knowing her she has it set as her wallpaper by now. ;)") + receiveSMS("Leanne", "You're not helping! But I do have a little apology for my mistake ready. Plz enjoy. :)", "leannesms2.jpg");
		return ""
	}
}

function initialiseLouise() {
	addPerson("Louise");
	per.getPersonGender = function() {
		return this.checkFlag(5) ? "futa" : "woman"
	};
	per.isPersonInfo = function() {
		return true
	};
	per.getPersonInfo = function() {
		if (!this.isCharmedBy()) return this.addPersonString("louise1b.jpg", "height:max%", "right") + "Louise, a part-time employee of Leanne, she is friendly and cheerful";
		else return this.addPersonString("louise11.jpg", "height:max%", "right") + "Louise, your slave never takes her eyes off you when you are in the " + getShopStore() +
			". Usually she\u2019s packing items from one box to an another or tidies up the " + getShopStore() + " a bit, but when you are around she always lurks behind you. It would creep you out if you wouldn\u2019t know that Louise is extremely shy and timid. Though her undying love towards draws her to you and is more powerful than her shyness. She doesn\u2019t speak much, but when she does she speaks fondly of you. Her ambitions have changed; she still wants to quit her job so she can take care of you. You reasoned her out of that idea."
	};
	per.passTimeDay = function() {
		if (this.checkFlag(7)) this.setFlag(8);
		return ""
	};
	per.addPlaceImageLeft = function(lit) {
		if (Place == 195 && this.isHere() && sType === "") {
			if (this.isCharmedBy()) return this.showPerson(this.checkFlag(4) ? "louise10be.jpg" : this.checkFlag(5) ? "louise10futa.jpg" : "louise10.jpg", "", "", "", "", false, "string");
			return this.showPerson(this.checkFlag(1) ? "louise1a.jpg" : "louise1b.jpg", "", "", "", "", false, "string")
		}
		return ""
	};
	per.showEventPopup = function() {
		if (sType !== "") return false;
		if (Place == 195 && this.place ==
			195 && !this.checkFlag(1)) {
			if (!isPlaceKnown("Graveyard")) setPlaceKnown("Graveyard");
			var perLea = findPerson("Leanne");
			this.setFlag(1);
			var s = this.addPersonString("louise1b.jpg", "height:max%", "right") + "You bump into a friendly woman as you run through the " + getShopStore() + "\u2019s back aisle. You haven\u2019t seen before, but it looks like she works here, because she was mopping the floor persistently before you almost knocked her off her feet. You apologise and like a true " + (perYou.isMaleSex() ? "gentleman" :
					"lady") + " you offer your hand to help her stand up. She gladly takes your offer while glances to you.<br><br>" + '"Thank you\u2026", she whispers looking at you shyly. You see she\u2019s waiting for your name.<br><br>' + '"Ohh\u2026 ' + perYou.getPersonName() + '! I\u2019m sorry! I was in a rush and I hadn\u2019t seen you!", you say without hesitation.<br><br>' + '"Ohh, no problem! The name\u2019s Louise!", she says and offers her hand to shake.<br><br>' + "You accept and make a small talk with her. Louise seems like a fine woman. She\u2019s also hard working and persistent and wants to be more than just a cleaning lady at a small " +
				getShopStore() + ". She has ambitions of her own.</p>";
			if (perLea.other == 20) {
				s += '<p>"Would you believe, I\'ve seen people take money from the register when Leanne left them to work?  How sleazy is that?"</p>' + '<p>You find yourself feeling embarrassed, and just a little proud that you didn\'t take the money.  "Um, pretty sleazy," you agree.</p>' + '<p>She flashes a winning smile.  "But not you.  It\'s good to meet someone I can trust, you know?"</p>' + '<p>"Leanne told me if I saw you to tell you she took the rest of the day off. She was looking a bit sad"</p>' +
					"<p>You would not be surprised if she has gone to visit the graves of her family.</p>";
				this.setFlag(2)
			} else {
				s += '"Hey, ' + perYou.getPersonName() + ' Leanne told me if I saw you to tell you she took the rest of the day off. She was looking a bit sad"</p>';
				this.setFlag(3)
			}
			showPopupWindow("Louise", s);
			perLea.other++;
			return true
		}
		return false
	};
	per.showEvent = function() {
		var md;
		if (sType == "louisepool") {
			WaitHereOnly(6);
			md = WritePlaceHeader();
			this.showPerson(this.checkFlag(4) ? "louise-poolbe.jpg" : this.checkFlag(5) ?
				"louise-poolfuta.jpg" : "louise-pool.jpg");
			addPlaceTitle(md, "Swimming with Louise");
			md.write("<p>Louise arrives and changes into her swimsuit and happily wades out into you pool with you. She gives you a quick flash but she is not willing to go any further here in the pool.</p>");
			startQuestions();
			addLinkToPlaceC(md, "say goodbye to Louise", Place);
			WritePlaceFooter(md);
			return true
		}
		if (Place != 195 || this.place != 195) return false;
		if (sType == "riskjob") {
			md = WritePlaceHeader();
			this.showPerson(perYou.isMaleSex() ?
				"louise12b.jpg" : "louise12g.jpg");
			addPlaceTitle(md, "Risking your Slave's Job");
			md.write("<p>\"I'm so glad I decided to be your slave, " + perYou.getMaster() + '," Louise says, her hands moving seemingly without her direction to undress her.</p>' + '<p>"Now I can be available for you whenever you like and I won\'t care for a moment if you take me for granted and every moment of obedience is pure bliss.  Do you wish to take me now?"</p>' + '<p>"Yes", you say honestly.</p>');
			if (!this.checkFlag(6)) md.write("<p>As you and she are enjoying yourselves behind the counter, you notice a familiar stone in the general " +
				getShopStore() + "'s lost and found box.</p>");
			startQuestions();
			if (!this.checkFlag(6)) addQuestionCO(md, "grab the stone from the bin", "Leanne", -416);
			addLinkToPlace(md, "leave your slave to clean up", 194);
			WritePlaceFooter(md, "Script by Tilde", true);
			return true
		}
		if (sType == "transformcock") {
			CastTransform(1);
			this.setFlag(5);
			md = WritePlaceHeader(true, "", "black");
			showPopupWindow("Transformation", this.addPersonString("louise13.jpg", "height:max%", "right") + '<p>You cast the spell and Louise cries out, "God, what is this" and pulls down her uniform. You see a large cock growing from her groin above where her pussy is.</p>' +
				"<p>As she groans you can distinctly hear someone laughing but it is drowned out as Louise cries out in ecstasy as her new cock spasms in her first male ejaculation.</p>" + "<p>Louise is confused why you did this and you cannot help but wonder if it was a good thing, but then again as you watch her stroking her new cock you put these worries out of your mind.");
			setQueryParams("");
			WritePlaceFooter(md, "", true, true);
			return true
		}
		if (sType == "transformbreasts") {
			CastTransform(1);
			this.setFlag(4);
			md = WritePlaceHeader(true,
				"", "black");
			showPopupWindow("Transformation", '<img src="Images/GenericSex/be c.gif" style="width:50%;float:left;margin-right:6px;margin-top:1em;margin-bottom:2em" alt="BE">' + '<p>You cast the spell and Louise cries out, "God, what is this" and pulls apart her uniform. You see her breasts swelling, growing larger and larger.</p>' + "<p>As she groans you can distinctly hear someone laughing but it is drowned out as Louise cries out in ecstasy as her breasts stop growing.");
			setQueryParams("");
			WritePlaceFooter(md,
				"", true, true);
			return true
		}
		if (sType == "charmlouise1") {
			md = WritePlaceHeader();
			this.showPerson("louise2.jpg");
			addPlaceTitle(md, "Louise Under a Spell");
			md.write('<p>"Dai Chu Louise," you whisper, almost to yourself. You feel the mana leave you and her eyes ' + "begin to glow, yet she seems unaffected.</p>" + '<p>"Did you say something?" she asks innocently.</p>' + '<p>"Dressy shoes," you stammer quickly, wondering what could ' + 'have gone wrong. "I was wondering why ' + "you're wearing such nice shoes to work.\"</p>" +
				'<p>"You have a good eye," she says, appreciative. "I\'m planning to surprise my ' + perYou.getSex() + "friend after work. " + "I'm not sure it's worth it these days, though. I mean, " + perYou.getHeShe() + ' can be such a jerk, you know?"</p>' + "<p >She looks oddly melancholy, particularly for someone you've\tjust charmed.</p>" + '<p >"Um, is there anything I can do to help?" you ask, still ' + "trying to work out why her eyes are glowing if the charm spell didn't work.</p>" + '<p>"Look," she says. "I trust you, so please be honest with me."</p>');
			startQuestions();
			addLinkToPlaceC(md, 'tell her "You can trust <i>me</i>."', Place, "type=charmlouise2");
			WritePlaceFooter(md, "Script by Tilde", true);
			return true
		}
		if (sType == "charmlouise2") {
			md = WritePlaceHeader();
			this.showPerson("louise3.jpg");
			addPlaceTitle(md, "Louise Under a Spell");
			md.write("<p >She pulls down her uniform to reveal that she isn't wearing anything underneath.</p>" + "<p >\"I've been wondering recently if my " + perYou.getSex() + "friend " + "is taking me for granted. If you were my " + perYou.getSex() +
				"friend, " + 'would you take a body like this for granted?"</p>' + "<p >You smile to yourself before you respond.<i>This is more like it.</i></p>" + '<p >"You know I\'ll always tell you the truth, right Louise?" you ' + 'say, and she nods, eager to hear what you have to say. "If I were your ' + perYou.getSex() + "friend, " + 'I probably <i>would</i> take you for granted," you admit.</p>' + '<p >"Oh," she says, crestfallen.</p>' + '<p >"But if you were <i>my</i> lover, you wouldn\'t mind it."</p>' + "<p >She doesn't question these words for a moment. She accepts them as absolute law. " +
				"As you watch she pulls out her cell phone and leaves a breakup message on her " + perYou.getSex() + "friend's voicemail.</p>" + '<p >"That\'s done," she says, "I want to be your lover. What do I need to do to become your ' + 'lover? Please, be honest with me."</p>');
			startQuestions();
			addLinkToPlaceC(md, '"Show me more..."', Place, "type=charmlouise3");
			WritePlaceFooter(md, "Script by Tilde", true);
			return true
		}
		if (sType == "charmlouise3") {
			md = WritePlaceHeader();
			this.showPerson("louise4.jpg");
			addPlaceTitle(md, "Louise Under a Spell");
			md.write("<p>She pulls the janitor outfit off entirely, revealing more of her gorgeous body.<p>" + '<p>"What else must I do?" she demands.  She doesn\'t sound annoyed so much as anxious to get it done.<p>' + '<p>"Honestly?" you say, and she nods eagerly.  "I\'m not looking for an equal relationship. ' + 'I would rather have a harem of slaves who obey my every whim."<p>' + '<p>She frowns at that.  "That sounds really immoral."<p>' + '<p>"It isn\'t immoral at all," you say.  "If all of the slaves want to be slaves, long to be owned, ' +
				'then there is nothing wrong about it."  She trembles gently at the word owned.<p>' + '<p>She nods slowly.  "Well, I suppose I can\'t argue with that."  You smile inwardly. ' + 'Her words are truer than she knows.  "Still," she continues.  "I don\'t know if... if that kind of life... ' + "if that's something I could ever choose.\"<p>");
			startQuestions();
			addLinkToPlaceC(md, 'ask "Do you want to know the <i>honest truth</i>?"', Place, "type=charmlouise4");
			WritePlaceFooter(md, "Script by Tilde", true);
			return true
		}
		if (sType ==
			"charmlouise4") {
			md = WritePlaceHeader();
			this.showPerson("louise5.jpg");
			addPlaceTitle(md, "Louise Under a Spell");
			md.write('<p>"Of... Of course I want the truth.  I trust you completely," she says.</p>' + '<p>You snap the trap shut.  "You <i>do</i> want to be my slave, Louise.  You have never ' + 'wanted anything more and you know that every moment you obey me will be absolute bliss."</p>' + "<p>Again, she doesn't miss a beat.  Her mind absorbs this, accepts it as Truth, and moves on " + 'to dealing with what that means.  "Then how do I become your slave?  Please, I want to be yours ' +
				"so badly it hurts!  I need you to be my " + perYou.getMaster() + '!"</p>' + '<p>"You will obey me in all things," you say.  It isn\'t a question.</p>' + '<p>"Of course!"</p>' + '<p>"Everything you own is mine," you press.  "You live only for my pleasure."</p>' + '<p>"Yes!" she promises.  "Anything!  Just please, let me be your slave!"</p>');
			startQuestions();
			addLinkToPlaceC(md, '"Prove your worth to me then"', Place, "type=charmlouise5");
			WritePlaceFooter(md, "Script by Tilde", true);
			return true
		}
		if (sType == "charmlouise5") {
			md =
				md = WritePlaceHeader(false, "td-any");
			this.showPersonRandom("louise6", 2, "height:max");
			addPlaceTitle(md, "Louise Under a Spell");
			md.write("<p>You decide the tile floor would be uncomfortably hard and cold, so she puts on a show for you, writhing and guiding your eyes with her hands as they work up and down her body.</p>" + '<p>You are not cruel.  You know she is completely enslaved already, so you let her feel the joy you promised with three little words: "You are mine."</p>' + '<p>"Oh, thank you!  Thank you so much ' +
				perYou.getMaster() + '!  I promise I will always be a good slave girl!"</p>' + '<p>"And I will always be a good ' + perYou.getMaster() + '," you purr.  "Trust me.  Now get dressed.  I wouldn\'t want you to lose your job - not when you can be making money for me."</p>');
			startQuestions();
			addLinkToPlace(md, "leave the " + getShopStore(), 194);
			WritePlaceFooter(md, "Script by Tilde", true);
			return true
		}
		return false
	};
	per.showPersonChat = function(bGeneral, md) {
		if (Place == 195 && this.isHere())
			if (this.isCharmedBy() && sType ===
				"") addLinkToPlace(md, "risk your slave's job again", 195, "type=riskjob")
	};
	per.handleItem = function(no, cmd) {
		if (cmd == 1 && (no == 52 || no == 64)) {
			var s = getSoulBoundCrystal(no);
			if (s != "")
				if (this.isHere() && !(this.checkFlag(4) || this.checkFlag(5))) {
					if (!this.isCharmedBy()) examineItem(no, "The " + s + " trembles weakly, you suspect you need a magical link to Louise before it will work.");
					else examineItem(no, "The " + s + " vibrates softly the closer you get to Louise.");
					return "handled"
				}
		} else if (no == 14 && cmd == 2) {
			if (Place == 195 &&
				this.place == 195) {
				if (wherePerson("Anita") == 195) return "";
				if (!isSpellKnown("Shielded Charm")) addComments("Don't cast the spell here, the " + getShopStore() + " is still open and it's too public.");
				else CastCharmSpell("Louise", Place, 1, "type=charmlouise1");
				return "handled"
			}
		} else if (no == 18 && cmd == 2)
			if (Place == 195 && this.place == 195) {
				if (this.checkFlag(4) || this.checkFlag(5)) {
					addComments("You have already transformed Louise!");
					return "handled"
				}
				if (!this.isCharmedBy()) {
					addComments("The spell washes over her but nothing happens, you seem to need a magical link to her");
					return "handled"
				}
				if (!CastTransform(1, true)) return "handled";
				setCommentsNoClick('<div class="conversebubble" style="cursor:default">' + '<table><tr><td width="80%"><p>You decide to try the transformation spell on Louise and tell her to prepare herself. As you start to recite the spell she falls into a sort of trance, her uniform falling down. As it does your attention is drawn to...</p>');
				addOptionLink("comments", "her breasts", "ClearComments();dispPlace(" + Place + ",'type=transformbreasts')");
				addOptionLink("comments",
					"her groin", "ClearComments();dispPlace(" + Place + ",'type=transformcock')");
				addComments('</td><td width="20%"><img src="Images/' + this.getImg("louise5.jpg") + '" style="width:95%;" alt="Transform"></td></tr></table>');
				return "handled"
			}
		return ""
	};
	per.isPhoneable = function() {
		return checkPlaceFlag("Hotel", 11) && Place == 269
	};
	per.callThem = function() {
		if (Place == 269)
			if (isShopOpen(2, 1, true)) WriteComments("You call Louise to invite her to join you at the pool for a swim, but she says she is working at Leanne's General Store but would love to after she finishes for the day.");
			else {
				this.setFlag(7);
				gotoPlace(Place, "type=louisepool");
				receiveCall("", 'You call Louise to invite her to join you at the pool for a swim, and she immediately answers, "No worries, I will be there as soon as I can!"');
				WriteCommentsFooter(bChat, bChatLeft)
			}
	};
	per.addPersonPhoneCall = function() {
		if (this.checkFlag(8) && !this.checkFlag(9))
			if (makeCall(true, 172)) this.setFlag(9);
		return false
	};
	per.getPersonSMS = function(id) {
		if (id == 172) return receiveSMS("Louise", "Thinking about you...thought you would like this, from my last holiday",
			"louisesms1.jpg");
		return ""
	}
}

function RepliesLucy(nR) {
	if (nR == 1848) {
		addComments("<p><b>Soulless Thrall</b></p>");
		if (perYourBody.NoItems < perYourBody.MaxItems) {
			perYourBody.PutItem(5);
			this.setFlag(1, false);
			addComments("<p>She hands the stone to you, placing it gently in your hand as she runs her fingers down your palm sending shivers of pleasure up your arm.</p>")
		} else addComments("<p>She tries to hand you the stone, but you realize you don't have enough room in your bag to carry it.  Perhaps if you got rid of something.</p>")
	}
	return true
}

function initialiseLucy() {
	addPerson("Lucy", 0, "Lucy");
	per.Replies = RepliesLucy;
	per.getPersonName = function() {
		return perJesse.getDemonPath() >= 150 ? "Thrall" : this.name
	};
	per.isPersonInfo = function() {
		return this.checkFlag(2)
	};
	per.getPersonInfo = function() {
		return "<img src='Images/People/Lucy/lucy12a.jpg' class='imgpopup' alt='Thrall'>" + "<p>You know very little about the woman before you, other than that she had been unlucky enough to catch the fancy of the demon Legion and has since been claimed by the creature.</p>" +
			"<p>The \u201cThralls\u201d, as legion calls them, seem to be mere vessels, their eyes eerily blank and vacant after their souls had been taken by it and replaced with... something else.</p>" + "<p>Whatever it is, the thrall's mere presence has an arousing effect on everyone entering the room besides Jesse, the host of its former Mistress. It seems to exist for little more than to seduce and corrupt and always lewdly presents the woman's body to those visiting, promising them untold pleasure if they just give in to their lust.</p>" +
			"<p>You know the creature can not be allowed to roam free and have ordered Bambi to regularly bring food and something to drink, but otherwise make sure it does not leave the room while you work out what to do with it.</p>" + "<p>You have to admit that you feel sorry for the woman and maybe a bit of guilt, but for now, not even knowing as much as her name, there is nothing you can do for her aside from keeping an eye on her body.</p>"
	};
	per.showEvent = function() {
		var md;
		if (Place == 269 && sType == "lucypoolsex") {
			md =
				WritePlaceHeader();
			this.showPerson("lucy-pool-sex.jpg");
			addPlaceTitle(md, "Giving In To Lucy");
			md.write("<p>The thrall is a creature of lust and delights in the exposure and exhibitionism of stripping naked and taking you here at the pool.</p>");
			startQuestions();
			addLinkToPlaceC(md, "take Lucy the Thrall back to the hotel room", 375, "", "", "", "setPersonFlag('Jesse',7,false)");
			WritePlaceFooter(md);
			return true
		}
		if (Place != 375) return false;
		if (sType == "lucysex") {
			md = WritePlaceHeader(false, "td-left-med");
			if (perYou.isMaleSex()) this.showPersonRorX("lucythrallsex1b.jpg");
			else this.showPersonRorX("lucythrallsex1g.jpg");
			addPlaceTitle(md, "Playing with the Thrall");
			if (isJesseOk()) md.write("<p>You ask Jesse if you can have a private word with Lucy and Jesse waves to you as she starts playing on her phone. You step into the bedroom and the thrall quietly follows you.</p>");
			md.write("<p>The thrall lets out a low moan as you give in to her ministrations.  Within moments she has skillfully unfastened your pants and her hand quickly finds its target, quickly sending shivers of pleasure through you.</p>" +
				"<p>Moments later you can feel her soft supple lips kiss you as her tongue begins to explore your mouth - the heat from her body held so close against you raising your passions even further.</p>" + "<p>For a moment you worry that you have done something wrong - that <i>this</i> time the creature is going to devour your soul as the demon walks in the room cackling in delight...  But a moment later that fear is washed away as you feel an orgasm building toward its inevitable climax.</p>" + '<p><i>"If nothing else, she was right about one thing,"</i> you think to yourself.  <i>"This is a particularly fun pet to play with."</i></p>');
			startQuestions();
			addLinkToPlace(md, isJesseOk() ? "stop and re-join Jesse" : "stop and push her away", 375);
			addLinkToPlace(md, "walk back to the bar", 124);
			addLinkToPlace(md, "leave the hotel", 123);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "askself") {
			this.setFlag(3);
			md = WritePlaceHeader();
			this.showPerson("lucythrall2.jpg");
			addPlaceTitle(md, "Talking to the Thrall");
			md.write("<p>You ask the thrall to tell you her name and about herself before the demon. She presses more against you, her hands moving to remove your clothes and caress and arouse you. She seems to be driven by lust and nothing else, but she did give you that stone. As you are about to give up, she whispers in your ear, a voice full of lust but with an unearthly tone,</p>" +
				"<p>\"This body was once called Lucy, not now. Mistress just calls it 'pussy toy', " + (perJesse.checkFlag(6) ? "'cocksleeve' and 'cumdump'" : "'cunt-licker'") + '. A toy for Mistresses pleasure, nothing else. Lust is all that matters, nothing remains from before."</p>' + "<p>You push her back a bit and tell her that her Mistress is gone, " + (isDemonBound() ? "but the thrall just looks over at the bathroom the exorcised Jesse is currently in. Again you despair of getting anything more, but she speaks again as she embraced you again, speaking in between kissing your neck,</p>" +
					'<p>"Mistress is gone but Mistress is here. Lust remains"</p>' : "but the thrall just continues to try and sedude you. Again you despair of getting anything more, but she speaks again as she embraces you again, speaking in between kissing your neck,</p>" + '<p>"Mistress is gone but Lust remains"</p>') + "<p>You try to ask her more about who she was, about Lucy, but she refuses to say anything more.</p>");
			startQuestions();
			addLinkToPlace(md, "give up for now", 375);
			addLinkToPlace(md, "walk back to the bar",
				124);
			addLinkToPlace(md, "leave the hotel", 123);
			WritePlaceFooter(md);
			return true
		}
		return false
	};
	per.showEventPopup = function() {
		if (sType !== "") return false;
		if (!this.checkFlag(2) && isDemonQuestDone() && Place == 124 && isCharmedBy("Bambi")) {
			this.setFlag(2);
			showPopupWindow("Bambi and the Thrall", "<img src='Images/bambi11b.jpg' class='imgpopup' alt='Bambi'>" + "You know the thrall can not be allowed to roam free so you speak to Bambi and ask her to regularly bring food and something to drink, but otherwise make sure it does not leave the room while you work out what to do with it. Bambi smiles,</p>" +
				'<p>"Of course ' + perYou.getLord() + ', your collection of toys grows larger!  Please try to keep the number occupying the rooms down, this hotel has to have normal customers as well!."  and she laughs.</p>' + '<p>Well the Thrall is taken care of for now, but Bambi continues, "I can lock the rooms but I cannot give her my close personal supervision all the time, unless you plan to make her an assistant for me?"<p>' + '<p>The thought of the Thrall as a badmaid just seems a horribly bad idea so you tell Bambi a definitive "No".</p>');
			return true
		}
		return false
	};
	per.showPersonChat = function(bGeneral, md) {
		if (Place != 375 || sType !== "" || perJesse.place == 8) return;
		addLinkToPlace(md, perJesse.getDemonPath() < 600 ? "play with the thrall for a bit" : "talk to 'Lucy' privately", 375, "type=lucysex");
		if (this.checkFlag(1)) addQuestionCO(md, "take the offering from the thrall", "Lucy", 1848);
		else if (this.checkFlag(2) && !this.checkFlag(3) && perJesse.getDemonPath() < 600) addLinkToPlaceC(md, "ask the thrall about herself", 375, "type=askself")
	}
}

function RepliesMadison(nR) {
	var perMadison = per;
	setQueryParams("");
	var hr = getHour();
	if (nR == 100) {
		if (!perMadison.checkFlag(9)) {
			addComments("You ask Madison about the other delivery girl, Zoey,</p>" + '<p>"' + perYou.getMaster() + " you will really like Zoey! She is cute, bisexual and dating Nina and a guy in accounting, not at the same time.</p>");
			if (hr != 12 && (hr < 16 || hr > 17)) {
				addComments("<p>She's real busy most of the time, if you want to meet her, you know <i>meet her</i> you can sometimes catch her at lunch time, or more often at the end of the work day. I'll send you a message when I next see her!\"</p>" +
					"<p>Ok, you will have to come back another time.</p>");
				perMadison.setFlag(11)
			} else {
				addComments("<p>Hey, I just saw her a little while ago, I'll call her to visit, can I watch, or take part?\"</p>" + "<p>Your slave Madison is the naughty girl, isn't she? Of course you agree!</p>");
				setQueryParams("type=zoey")
			}
		} else if (hr == 12 || (hr == 16 || hr == 17)) {
			addComments('<p>"Hey, I just saw her a little while ago, I\'ll call her to visit, can I watch, or take part?"</p>' + "<p>Your slave Madison is the naughty girl, isn't she? Of course you agree!</p>");
			setQueryParams("type=zoey")
		} else addComments('<p>"' + perYou.getMaster() + ' sorry Zoey is out on a delivery now."</p>');
		perMadison.setFlag(9);
		perMadison.setFlag(10)
	} else if (nR == 101)
		if (hr == 12 || (hr == 16 || hr == 17)) {
			addComments('<p>"Hey, I just saw her a little while ago, I\'ll call her to visit, can I watch, or take part?"</p>' + "<p>Your slave Madison is the naughty girl, isn't she? Of course you agree!</p>");
			Place = 414;
			setQueryParams("type=visitzoey")
		} else addComments('<p>"' + perYou.getMaster() + ' sorry Zoey is out on a delivery now."</p>');
	return true
}

function initialiseMadison() {
	addPerson("Madison", 0, "Madison");
	per.Replies = RepliesMadison;
	per.isPersonInfo = function() {
		return this.isCharmedBy()
	};
	per.getPersonInfo = function() {
		return "<img src='Images/People/Madison/madison15o.jpg' class='imgpopup' alt='Madison'>" + 'Well, it looks like Madison is quite a nasty little tigress in bed. She regularly changes her clothes, each time a dress that pleases your sexual hunger more. She often teases you by appearing half naked already when you just have entered her workplace. You ordered her to continue her job as a mail and package carrier to avoid unnecessary attention from the townsfolk. She agreed and playfully added that she will personally bring any mail or packages of yours to your house without wearing any underwear. She mentioned that she will also bring an "appetite that only You can soothe".' + "Again, aside from her pantyhose she\u2019s fully naked, she sensed that you were coming and wanted to surprise you."
	};
	per.whereNow = function() {
		if (Place == 412 || Place == 414 || Place == 413 || Place == 289) return Place;
		return this.place
	};
	per.showEventPopup = function() {
		if (Place != 412) this.setFlag(10, false);
		return false
	};
	per.passTimeDay = function() {
		if (this.checkFlag(12) && !isCharmedBy("Zoey")) this.setFlag(12, false);
		return ""
	};
	per.showEvent = function() {
		if (sType == "callmadison") {
			WaitHereOnly(6);
			md = WritePlaceHeader();
			if (!perYou.isMaleSex()) this.showPerson("madison-call-g.jpg");
			else this.showPersonRorX("madison-call-b.jpg");
			addPlaceTitle(md,
				"Delivery Call-Girl Madison");
			md.write("<p>Madison arrives and she exclaims,</p>" + '<p>"Well ' + perYou.getMaster() + ' one delivery girl as ordered, and one orgasm as for delivery!"</p>' + '<p>She takes you over to a nearby grassy area and strips off her clothing, and looks at you, "Do you have a <i>' + (perYou.isMaleSex() ? "package" : "slot") + '</i> for me to make my delivery?"</p>' + "<p>You do and remove some of your clothing and let her deliver her service to you, a skilled if very public " + (perYou.isMaleSex() ?
				"blowjob" : "pussy-lick") + ".</p>");
			startQuestions();
			addLinkToPlace(md, "let Madison continue on her way", Place);
			AddRightColumnMed(md);
			this.showPerson("madison11.jpg");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "madisonpool") {
			md = WritePlaceHeader(false, "td-left-large");
			this.showPerson("madison-pool.jpg");
			addPlaceTitle(md, "Pool-Girl Madison");
			md.write("<p>Madison arrives and quickly changes into her swimsuit, or at least part of it!</p>" + "<p>You have a fun time relaxing and playing with your delivery-girl!</p>");
			startQuestions();
			addLinkToPlaceC(md, "say goodbye to Madison", Place);
			WritePlaceFooter(md);
			return true
		}
		if (Place != 412) return false;
		var md;
		if (Place == 412 && sType == "transformbreasts") {
			CastTransform(1);
			this.setFlag(13);
			md = WritePlaceHeader(true, "", "black");
			showPopupWindow("Transformation", '<img src="Images/GenericSex/be c.gif" style="width:50%;float:left;margin-right:6px;margin-top:1em;margin-bottom:2em" alt="BE">' + '<p>You cast the spell and Madison cries out, "What the hell is happening?" and pulls apart her top. You see her breasts swelling, growing larger and larger, her modest sized breasts growing to quite large.</p>' +
				"<p>As she groans you thought you heard some laughing but maybe it was Nina. Madison gasps as her breasts stop growing, and she remarks,<p>" + '<p>"Well, if this is permanent, I am going to need a new wardrobe.", and she rips her top off and continues, "How about giving them a spin!". You happily give them that and more.</p>');
			setQueryParams("");
			WritePlaceFooter(md, "", true, true);
			return true
		}
		return false
	};
	per.handleItem = function(no, cmd) {
		if (cmd == 1 && (no == 52 || no == 64)) {
			var s = getSoulBoundCrystal(no);
			if (s !=
				"")
				if (this.isHere() && !this.checkFlag(13)) {
					if (!this.isCharmedBy()) examineItem(no, "The " + s + " trembles weakly, you suspect you need a magical link to Madison before it will work.");
					else examineItem(no, "The " + s + " vibrates softly the closer you get to Madison.");
					return "handled"
				}
		}
		if (no == 32) {
			if (cmd == 1)
				if (Place == 412 && this.isCharmedBy() && sType != "meetgabby") {
					examineSilverRingStart();
					addComments("<p>It seems to be reacting to Madison's presence... getting warmer the closer you get.</p>" + "</td></tr></table>");
					return "handled"
				}
		} else if (no == 14 && cmd == 2) {
			if (Place == 288) {
				addComments("Are you crazy?  She's out in front of your house! Invite her inside where it's more private.");
				return "handled"
			}
			if (Place == 289) {
				if (CastCharmSpell("Madison", 355, 1)) {
					if (whereItem(38) == 289) moveItem(38, 45);
					if (!isPlaceKnown("TVStation")) setPlaceKnown("TVStation")
				}
				return "handled"
			}
			if (Place == 413) {
				CastCharmSpell("Madison", 355, 1, "place=office");
				return "handled"
			}
		} else if (no == 18 && cmd == 2)
			if (Place == 412) {
				if (this.checkFlag(13)) {
					addComments("You have already transformed Madison!");
					return "handled"
				}
				if (!this.isCharmedBy()) {
					addComments("The spell washes over her but nothing happens, you seem to need a magical link to her");
					return "handled"
				}
				if (!CastTransform(1, true)) return "handled";
				ClearComments();
				dispPlace(Place, "type=transformbreasts");
				return "nofooter"
			}
		return ""
	};
	per.isPhoneable = function() {
		return this.isCharmedBy() && !this.isHere() && this.checkFlag(6)
	};
	per.callThem = function() {
		if (Place == 269) {
			gotoPlace(Place, "type=madisonpool");
			receiveCall("", 'You call Madison to invite her to join you at the pool for a swim, and she immediately answers, "' +
				(isDay() ? "Sure, I can take a break, see you soon" : "Sure, I can use a dip") + '"');
			WriteCommentsFooter(bChat, bChatLeft)
		} else if (!isDay()) WriteComments("You call Madison but there is no answer, you would guess she is at home and the number you have for her is probably her work number.");
		else if (!isOutside()) WriteComments("You call Madison but there is no answer, you should try again somewhere else. Your phone is not the best and you are getting a poor signal here inside.");
		else {
			gotoPlace(Place, "type=callmadison");
			receiveCall("", "You call Madison and she immediately answers, and promises to be there in 15 minutes or she is your slave for life, which she is!");
			WriteCommentsFooter(bChat, bChatLeft)
		}
	};
	per.addPersonPhoneCall = function() {
		if (isDay() && this.checkFlag(7) && !this.checkFlag(8)) {
			if (makeCall(true, 70)) this.setFlag(8)
		} else if (this.checkFlag(11) && !this.checkFlag(12)) {
			var hr = getHour();
			if (hr == 12 && Math.random() < .1 || (hr == 16 || hr == 17))
				if (makeCall(true, 71)) this.setFlag(12)
		}
		return false
	};
	per.getPersonSMS = function(id) {
		if (id ==
			70) return receiveSMS("Madison", "You know " + perYou.getMaster() + " I'm not the only delivery-girl. Do you like Zoey, Nina really really does!", "madisonsms1.jpg");
		if (id == 71) return receiveSMS("Madison", perYou.getMaster() + " she's here!", "madisonsms2.jpg");
		return ""
	}
}

function RepliesMayorThomas(nR) {
	var perMT = per;
	var bCharm = perMT.isCharmedBy();
	var myName = perMT.getYourNameFor();
	var perK = findPerson("OfficerKhan");
	if (nR == 100) {
		setPersonFlag("Gina", 2);
		addComments('"Quite a lot of people have complained about the security at the museum. We only have a small museum but some of the exhibits are very valuable, particularly those in the asian and eqyptology sections. The guard Gina James is very skilled and I completely trust her." recites the Mayor, sounding like she is repeating a press-release.')
	} else if (nR == 81E3) {
		addComments('<p>"You found some evidence on Beasley," cries the mayor. "Congratulations, and thank you for your help ' +
			myName + '."</p>');
		perYourBody.DropItem(8, 1E3)
	} else if (nR == 6104) {
		perMT.place = 176;
		addComments('<p>"Good idea ' + myName + ". Mr. Beasley is probably there right now and I could question him about the book.  Besides, I would love to see Davy very much,\" she says, suddenly very distracted for obvious reasons.</p><p>She escorts you out of her office and then leaves Town Hall, heading for the Robbin's house.</p>");
		Place = 95
	} else if (nR == 5310) {
		if (perK.other < 10) {
			perK.other = 10;
			AddCash(20);
			if (perMT.other < 5) perMT.other =
				5;
			if (!bCharm) addComments("<p>\"Oh, so you want to help. Well, we suspect that a teacher from your school, Mr. Beasley stole an ancient book. If you find Mr. Beasley or the book then come back here immediately. Don't trust anyone else. Tell me where we can find the suspect or bring me the book. Here is " + sCurrency + '20 to help you along the way."');
			else addComments('<p>"You want to help out ' + myName + "? Of course, anything you wish. The police suspect that a teacher from your school, Mr. Beasley stole an ancient book.  But please be careful " +
				myName + ", I don't know what I would do if you were to get hurt.  Oh! Here, take this " + sCurrency + '20 to help you along the way."')
		}
	} else if (nR == 1603) {
		perMT.other = 4;
		if (isMurderPath()) addComments('"Nice meeting you, I\'m sure, but I have important business to get to. An important citizen was murdered this afternoon and an object of great value was stolen. So if you have business with me, please be brief."');
		else addComments("Nice meeting you, I'm sure.  I apologize for being blunt, but I am in the middle of something.  Was there an issue you wanted to discuss?")
	} else if (nR ==
		1601) {
		perMT.other = 10;
		addComments('"That is disappointing. Well goodbye, and don\'t bother coming back here unless you have something worth my attention."')
	} else if (nR == 1602) {
		addComments('<p>"You have it?  How did you... Never mind, I don\'t want to know.  All I care about is getting that book back to its rightful owner. Do you have it on you now?" she asks, a little too eagerly.  "Just give it to me and this whole episode can be forgotten about."</p>');
		perMT.other += 1
	} else if (nR == 1606) {
		perMT.setFlag(6);
		addComments("A flash of anger crosses her face for an instant, but is quickly replaced with a caring smile.  \"That's okay, " + myName + ".  Just bring it to me and I'll take care of everything else.  Perhaps even a reward for finding it!\"")
	} else if (nR == 16999) {
		perMT.setFlag(6);
		addComments('"Yes, this is it!  Davy will be so pleased with me, maybe even fuck me again!"');
		Place = 991
	} else if (nR == 1650) {
		bChat = false;
		addComments(perMT.addPersonFace());
		perMT.place = 110;
		if (!bCharm) addComments('"Yes...  Yes.  I should get back to work." She says turning slowly to leave and obviously still quite confused.');
		else addComments('<p>"Yes.  Yes ' + myName + '. I will meet you at my office. Visit me soon... please?" She says longingly. She redresses and leaves the house with a passionate glance.</p>');
		Place = 176
	} else if (nR == 13400) {
		perMT.place = 1E3;
		movePerson("Gina", 302);
		setPlaceFlag("Museum", 8);
		startTimedEvent("ReturnMayor();", 12);
		if (getPersonOther("MrsGranger") === 5) setPersonOther("MrsGranger", 4);
		if (wherePerson("MrsGranger") === 1) movePerson("MrsGranger", 177);
		if (!isPlaceKnown("GinasHouse") && whereItem(42) != 304) PlaceI(42,
			304);
		Place = 95;
		addComments('"Yes, of course, ' + myName + '.  I will go do that immediately!" says the Mayor, overexcited to finally have some way of serving her ' + myName + "... Other than the obvious method, of course.")
	} else if (nR == 13401) {
		perMT.place = 1E3;
		startTimedEvent("ReturnMayor();", 12);
		movePerson("Gina", 0);
		setPlaceFlag("Museum", 8, false);
		Place = 95;
		addComments('"Anything for you ' + myName + '.  I will go re-open the Museum myself!" says the Mayor, jumping into action at your command.')
	} else if (nR == 44201) {
		setPlaceFlag("Hospital",
			4);
		addComments('"Yes, of course, here is a key to the basement" says the Mayor, as she takes a key from her desk drawer.')
	} else if (nR == 44202) {
		setPlaceFlag("Park", 5);
		addComments('"Yes, of course, just a moment", she calls Angela in and asks her to get a spare key from John\'s office. A little later Angela returns and gives a key to you.')
	}
	return true
}

function ReturnMayor() {
	findPerson("Mayor");
	if (per.place >= 1E3) per.place = 110
}

function initialiseMayorThomas() {
	addPerson("Mayor");
	per.Replies = RepliesMayorThomas;
	per.getPersonName = function(full) {
		return full !== true && this.isCharmedBy("You") ? "Mayor Thomas, your Slave" : "Mayor Thomas"
	};
	per.getPersonAddress = function() {
		return checkPlaceFlag("ShoppingCenter", 6) ? "Penthouse, Haven Apartments" : ""
	};
	per.getPossessionFace = function() {
		return "mayor6a"
	};
	per.isPersonInfo = function() {
		return this.isCharmedBy("You")
	};
	per.getPersonInfo = function() {
		var s = "<p><img src='Images/" + (this.isCharmedBy() ? "mayor6" :
			"mayor1") + ".jpg' style='width:30%;float:right;margin-left:5px' alt='Mayor'>";
		if (isMurderPath()) return s + "Now that you\u2019ve learned she was under Davy\u2019s control you finally understand why she acted so weird. After you freed her, you knew the wisest thing to do is to turn her onto your side. You realized that she could be a valuable asset to your future plans.</p>" + "<p>So, now you are the happy owner of the pretty leader of the town. She told you between two orgasms that she wants to order and boss people around in your name and would gladly be your puppet mayor while you rule over the town. It\u2019s a dream of hers that you can actually fulfill.</p>" +
			"<p>You visit her evey once in a while in person, but she keeps in touch with you through the phone or computer. She keeps you up to date on anything important worth mentioning.";
		else return s + "You are the happy owner of the pretty leader of the town. She told you between two orgasms that she wants to order and boss people around in your name and would gladly be your puppet mayor while you rule over the town. As a slave of yours, she regularly looses her head and becomes nervous on the smallest matters. That\u2019s her overachieving personality trying to please you. It\u2019s the spell that made her this madly loyal. You know if you ever would ask her something she would gladly carry out those orders with ruthless precision.</p>" +
			"<p>She keeps you up to date on anything important worth mentioning through phone or the computer, so you don\u2019t miss anything.</p>"
	};
	per.whereNow = function() {
		if (Place == 110 || (this.place === 0 || this.place == 110)) return isShopOpen(0) ? this.place : 468;
		return this.place
	};
	per.addPlaceImageLeft = function(lit) {
		if (Place == 468 && this.isHere() && sType === "") return this.showPerson("mayor-home.jpg", "", "", "", "", false, "string");
		return ""
	};
	per.passTimeDay = function() {
		if (this.other > 0 && this.other < 3) this.other = 3;
		return ""
	};
	per.showEventPopup = function() {
		if (sType !== "") return false;
		switch (Place) {
			case 110:
				if (!this.checkFlag(1)) {
					this.setFlag(1);
					if (isMurderPath()) showPopupWindow("Mayor Beatrice Thomas", "<img src='Images/mayor1.jpg' class='imgpopup' alt='Mayor'>" + "You have heard a lot about Beatrice Thomas, the mayor of the town, but this is the first time you have seen her in flesh, but you know your mother has regularly worked out at the gym with her. She used to be a lawyer before she ran for the mayors office. Some people say she cheated on her campaign by using a large sum of money from an unknown backer. She used the money to repair the hospital and improve the health-care, but also to reinforce herself as the perfect candidate for the job.<br><br>" +
						"She\u2019s only been mayor for 3 months, but the townsfolk already gossip about her being rude and cold to her workers and neglecting her work.<br><br>" + "As you stand in her well decorated office, you feel that something is not right. She looks gorgeous, but her grim face tells you that she doesn\u2019t like visitors. Especially the likes of you.");
					else showPopupWindow("Mayor Beatrice Thomas", "<img src='Images/mayor1.jpg' class='imgpopup' alt='Mayor'>" + "You know that Beatrice Thomas, the current mayor was a lawyer before she made it into politics. She used to visit the local gym where your Mom worked out too so you've seen her sometimes. She always looked so organized and well dressed, but she did not speak much and had that distant attitude.<br><br>" +
						"She has been the mayor for 3 months now, but her reputation as a lady with iron will had not changed much. She gets and does what she wants, and nobody would dare talk back to her.<br><br>" + "As you stand in her well decorated office, her cool eyes watching you, you feel little around her. She lazily juggling a pencil between her hands and doesn\u2019t seem to be happy that you disturbed her work.");
					return true
				} else if (this.checkFlag(3) && !this.checkFlag(2) && this.sCharmedBy == "You" && isCharmedBy("Angela"))
					if (perYou.isBornMale()) {
						showPopupWindow("Mayor Beatrice Thomas",
							"<img src='Images/mayor6.jpg' style='width:40%;float:right;margin: 0px 0px 0px 5px' alt='Mayor'>" + "You make a quick glance at Angela while you rush through the reception to the mayor\u2019s office , she instantly smiles and waves you back, happly acknowledges you as the boss around here. You don\u2019t even have to close the door anymore. You can freely visit Beatrice Thomas, no one is going to question you anymore here.<br><br>" + "\" How's my little mayor slut's doing?\", you ask casually. Ms. Thomas stands up and greets you with full attention.<br><br>" +
							"\"Sir! Everything's fine. Although I noticed that Angela is under your influence too, I've seen her cute eyes have a purple glow.\", she says normally. You grab her and play with a lock of her brown hair.<br><br>" + '"Does that bother you?", you ask in a little more menacing tone.<br><br>' + '"Not at all Sir, you can have anyone you want and I\'ll still remain the jolliest mayor in all over the world, because what makes you happy that makes me happy too. Plus Angela is a good help and together we can serve you better.", she whispers into your ear and touches your bulging erection. You let go of her hair.<br><br>' +
							"\"When you're not here " + perYou.getPersonName() + ', we always talk about you! We chat about how busy, how important, how powerful you are. And we will be there, at your side when you conquer the whole town!"<br><br>' + "You sit back to the chair after you give her a long kiss. She doesn't care about the mess you made to her dress. Why should she?! This place is your domain and you can do whatever you want!", "setPersonFlag('Mayor',2)");
						return true
					} else {
						showPopupWindow("Mayor Beatrice Thomas", "<img src='Images/mayor6b.jpg' style='width:40%;float:right;margin: 0px 0px 0px 5px' alt='Mayor'>" +
							"You make a quick glance at Angela while you rush through the reception to the mayor\u2019s office , she instantly smiles and waves you back, happly acknowledges you as the boss around here. You don\u2019t even have to close the door anymore. You can freely visit Beatrice Thomas, no one is going to question you anymore here.<br><br>" + "\"How's my little mayor slut's doing?\", you ask casually. Ms. Thomas stands up and greets you with full attention.<br><br>" + "\"Ma'am! Everything's fine. Although I noticed that Angela is under your influence too, I\u2019ve seen her cute eyes have a purple glow.\", she says normally. You grab her and push your hand through her panty down to her pussy. She does the same to you and with her free hand and starts to pinch your nipple.<br><br>" +
							'"Does that bother you?", you ask in a little more menacing tone.<br><br>' + "\" Not at all Ma'am, you can have anyone you want and I'll still remain the jolliest mayor in all over the world, because what makes you happy that makes me happy too. Plus Angela is a good help and together we can serve you better.\", she whispers into your ear. You stop touching her and push her away gently.<br><br>" + "\"When you're not here " + perYou.getPersonName() + ', we always talk about you! We chat about how busy, how important, how powerful you are. And we will be there, at your side when you conquer the whole town!"<br><br>' +
							"You sit back to the chair after you give her a long kiss. She doesn't care about the mess you made to her dress. Why should she?! This place is your domain and you can do whatever you want!", "setPersonFlag('Mayor',2)");
						return true
					}
				break;
			case 239:
				ReturnMayor();
				break
		}
		return false
	};
	per.showEvent = function() {
		if (Place == 269 && sType == "mayorpool") {
			WaitHereOnly(6);
			md = WritePlaceHeader();
			this.showPerson("mayor-pool.jpg");
			addPlaceTitle(md, "Swimming with Beatrice");
			md.write("<p>Nina arrives and changes into an orange bikini, and when she come out she ask that for now to please call her by her given name, Beatrice. You see no reason to refuse and agree, and she happily goes for a swim with you.</p>" +
				"<p>After Beatrice looks around at the almost empty pool and looks at you suggestively?</p>");
			startQuestions();
			addLinkToPlaceC(md, "it is fairly private here...", Place, "type=mayorpoolsex");
			addLinkToPlaceC(md, "say goodbye to Nina", Place);
			WritePlaceFooter(md);
			return true
		}
		if (Place == 269 && sType == "mayorpoolsex") {
			md = WritePlaceHeader(false, "td-left-med");
			this.showPerson("mayor-pool-sex.jpg");
			addPlaceTitle(md, "More Than Swimming With Beatrice");
			md.write("<p>You accept her advances, and she pulls off most of her bikini ready for you to take her!</p>");
			startQuestions();
			addLinkToPlaceC(md, "later...say goodbye to Beatrice", Place);
			WritePlaceFooter(md);
			return true
		}
		if (Place == 468 || Place == 110) {
			var bOffice = Place == 110;
			if (sType == "bj") {
				if (perYou.isMaleSex()) {
					if (isExplicit()) {
						md = WritePlaceHeader();
						this.showPersonRandomX("mayor11b", bOffice ? 4 : 3, "height:max", "", "", "", bOffice ? 0 : 1)
					} else {
						md = WritePlaceHeader(false, "td-left-med");
						this.showPerson("mayor11b.jpg")
					}
					addPlaceTitle(md, "Meeting the Mayors Mouth");
					md.write("<p>Like a skilled porn star, she treasures your cock like it\u2019s the Holy Grail. Her head bobbing up and down, left and right. Miss Thomas is trying to keep up with tempo you dictate, but ultimately she exhausts herself. You let your load all over her face and body, some of it will definitely stuck in her hair, but she doesn\u2019t mind. Miss Thomas, the head of Glenvale is just like the rest of your slaves; she lets out a tired sigh and collapses between your feet. To your surprise, she starts to kiss them and after a few seconds she is back on sucking your cock again. Looks like she is ready for round two! You thrust your manhood into her mouth to the point when she gags a little. It seems she a bit more experienced than you thought so. Your remaining cum lands again on her face and she joyfully licks her mouth.</p>")
				} else {
					md =
						WritePlaceHeader(false, bOffice || !isExplicit() ? "td-left-med" : "");
					if (bOffice || !isExplicit()) this.showPerson("mayor11g.jpg");
					else this.showPersonRandomX("mayor-home-sex-g", 2);
					addPlaceTitle(md, "Meeting the Mayors Mouth");
					md.write("<p>Miss Thomas swirls her tongue like she has been doing it for years, but that\u2019s not exactly the case. After you tell her on how you want to be \u201eamused\u201d today, she hops off from the desk and kneels before your chair. You open your legs and grab her head and toss her between your laps. She unzips your skirt and lowers herself to your treasured vagina. She treats it and you like you are a royalty, her tongue moving up and down. At one point she switches her focus to your other hole. She licks it perfectly clean and when she finishes, she stands up and swallows the juice left on her fingers. You zip back your skirt while she returns to her desk, resting a bit after the fun.</p>")
				}
				addLinkToPlace(md,
					"talk to the Mayor", Place);
				if (bOffice) addLinkToPlace(md, "go to the reception", 95);
				else addLinkToPlace(md, "exit the apartment", 466);
				WritePlaceFooter(md);
				return true
			} else if (sType == "fuck") {
				if (perYou.isMaleSex()) {
					if (isExplicit()) {
						md = WritePlaceHeader();
						if (bOffice) this.showPersonRandomX("mayor-home-fuck-b", 2);
						else this.showPersonRandomX("mayor10b", 3, "50vw,height:max,50vw")
					} else {
						md = WritePlaceHeader(false, "td-left-med");
						if (bOffice) this.showPerson("mayor10b.jpg");
						else this.showPerson("mayor-home-sex.jpg")
					}
					addPlaceTitle(md,
						"Meeting the Mayors Pussy");
					md.write("<p>You grab one of her shoulders and spin her around. Miss Thomas understands your needs and bends over, half of her body is on the desk. You ready to pound her ass, but at the last minute, you turn your attention and dick to her other hole. You put your penis right into her asshole and you push it right until your slave squeals with pain and joy. The act keeps going for ten-fifteen minutes, during this time she never changes her position. Her asshole becomes wider with each push, soon she no longer feels pain only just pleasure. She puts both hands on her asscheeks, trying to rip them apart so you can enjoy the experience better. Your personal plaything even blows you at the end, swallowing your spunk like her life\u2019s depending on it. Miss Thomas tells you she will not wash herself tonight and will dream of you and this glorious sex you just gave her.</p>")
				} else {
					if (perYou.FindItem(45) >
						0) {
						md = WritePlaceHeader();
						this.showPersonX("mayor-home-fuck-g.jpg")
					} else if (bOffice || !isExplicit()) {
						md = WritePlaceHeader(false, "td-left-med");
						this.showPersonRorX("mayor10g.jpg")
					} else {
						md = WritePlaceHeader();
						this.showPersonRandomX("mayor-home-sex-g", 2)
					}
					addPlaceTitle(md, "Meeting the Mayors Body");
					md.write("<p>Just by looking at you, Miss Thomas knows what you want. She grabs a long, black dildo from one drawers and puts it in her mouth to make it wet. All the while you grab her waist and pull her down to floor level. You join your slave, who, after wetting the dildo, puts it into where it belongs, her pussy. The other side of the dildo\u2019s just waiting for you. You squat and push the toy\u2019s end into your own vagina. With the aid of Miss Thomas, you quickly reach your climax and your slave waits for you to recover from the shivers it gave. After both of you are finished, she licks the remaining pussy juice stuck on the dildo. She says she will keep it that way, unwashed, so the smell will always remind her of you.</p>")
				}
				addLinkToPlace(md,
					"talk to the Mayor", Place);
				if (bOffice) addLinkToPlace(md, "go to the reception", 95);
				else addLinkToPlace(md, "exit the apartment", 466);
				WritePlaceFooter(md);
				return true
			} else if (sType == "threesomeangela") {
				var perAngela = findPerson("Angela");
				var myNameA = perAngela.getCharmedLevel() == 4 ? perYou.getMaster() : "my Love";
				if (perYou.isMaleSex())
					if (isExplicit()) {
						var rnd = Math.random() < .5;
						md = WritePlaceHeader(false, rnd ? "td-left-med" : "");
						this.showPersonX(rnd ? "mayorangelayou-bb.jpg" : "mayorangelayou-ba.jpg")
					} else {
						md = WritePlaceHeader();
						this.showPerson("mayorangelayou-b.jpg")
					}
				else {
					md = WritePlaceHeader(false, "td-left-med");
					this.showPersonRorX("mayorangelayou-g.jpg")
				}
				addPlaceTitle(md, "Meeting the Mayor and Angela");
				md.write('<p>Mayor Thomas uses the intercom on her desk and calls Angels "Came in here Angela,", then to you, "Well she will after you do, and I do!".</p>' + '<p>A moment later Angela enters into the room, looking at you and asks, "How can I help you ' + myNameA + '?" assuming correctly you were the actual person summoning her.</p>' +
					'<p>Mayor Thomas tells her "You will attend to ' + perYou.getMaster() + ' and myself, and pleasure us as much as we want". You allow her this little bit of dominance over Angela, it is likely this is how things are developing here in the office since both were charmed and their sexual desired heightened. Besides it is arousing, but you do want to exert some control here,</p>' + '<p>"Yes Angela, you will please <b>me</b> and also Miss Thomas", showing your position and that the Mayor is another slave.</p>' +
					"<p>Angela does her best to please the both of you, and Miss Thomas assists in pleasuring you. Miss Thomas orders Angela around and tries to make it that you are fucking her, and Angela is helping. For now you allow her this little game.</p>");
				addLinkToPlace(md, "talk to the Mayor", 110);
				addLinkToPlace(md, "go to the reception", 95);
				WritePlaceFooter(md);
				return true
			} else if (sType == "threesomediane") {
				if (!isExplicit()) {
					md = WritePlaceHeader();
					this.showPersonRandom("mayordiame", 2)
				} else {
					md = WritePlaceHeader(false,
						"td-left-med");
					if (perYou.isMaleSex()) this.showPersonX("mayordiane-b.jpg");
					else this.showPersonX("mayordiane-g.jpg")
				}
				addPlaceTitle(md, "The Mayor with Diane");
				md.write("<p>You give your lovely lawyer a call and ask her to come upstairs from her apartment and join the Mayor and yourself. A few minutes later she arrives, you now have the two leaders of the town, law enforcement and the civil authority, ready for your pleasure.</p>" + "<p>You feel a rush as you look down at the two authorities of the town " +
					(perYou.isMaleSex() ? "servicing your cock" : "licking your pussy and breasts") + ", it is such a orgasmic feeling of control and power!</p>" + "<p>Afterwards you have to convince yourself to restrain these sort of thoughts and feelings, this is the way that led to the corruption and downfall of Kurndorf.</p>");
				addLinkToPlace(md, "talk to the Mayor", Place);
				addLinkToPlace(md, "follow Diane to her apartment", 467);
				addLinkToPlace(md, "exit the apartment", 466);
				WritePlaceFooter(md);
				return true
			}
		}
		if (Place != 110) {
			this.setFlag(6,
				false);
			return false
		}
		if (sType == "askmore") {
			md = WritePlaceHeader(false, "td-left-large");
			this.showPerson("mayor9.jpg");
			addPlaceTitle(md, this.getPersonName());
			if (perYou.isMaleSex()) md.write("<p>Miss Thomas jumps up onto the table with a nasty, sex hungry smile. She knows what\u2019s coming. It\u2019s either you take her right where she is, the desk, or let her suck you off.</p>" + '<p>"Master, tell me how do you wish to be pleasured today? I want what you want. As always, it\u2019s your call Master.\u201d</p>');
			else md.write("<p>Miss Thomas jumps up onto the table with a rigorous roar and a nasty smile. She knows what will happen now. It\u2019s either you make love to her or she is going to pleasure you, but one thing is sure; she is here to make sure you enjoy every second of it.</p>" + '<p>"My Mistress. Tell me how do you wish to be pleasured today? Maybe something regular like me licking your phenomenally sweet pussy or you want to make it special and fuck each other\u2019s brains out? As always, it\u2019s your call Mistress.\u201d</p>');
			startQuestions();
			if (perYou.isMaleSex()) {
				addLinkToPlace(md, "take her on her desk", Place, "type=fuck");
				addLinkToPlace(md, "take her mouth", Place, "type=bj")
			} else {
				addLinkToPlace(md, "ask her to lick you", Place, "type=bj");
				addLinkToPlace(md, "make love to her", Place, "type=fuck")
			}
			if (isCharmedBy("Angela")) addLinkToPlace(md, "have her call in Angela", Place, "type=threesomeangela");
			addLinkToPlace(md, "talk to the Mayor", Place);
			addLinkToPlace(md, "go to the reception", 95);
			WritePlaceFooter(md);
			return true
		}
		var perBatton =
			findPerson("OfficerBatton");
		var perKristin = findPerson("Kristin");
		var md;
		if (sType == "trio2") {
			md = WritePlaceHeader();
			this.showPerson("trioeventmayor2.jpg");
			addPlaceTitle(md, "Improvement");
			md.write('<p>Mayor Thomas replies, "Right to the point, I love you for it ' + perYou.getMaster() + "! The girls will update you on the things going around right now. Let me just serve you now, my one and only " + perYou.getMaster() + '!"</p>' + "<p>" + getPoliceChief() + ' Kerry reports to you, "I\u2019ve been learning a lot about occultism and wizardry lately. I wanted to be prepared ' +
				perYou.getMaster() + '!"</p>');
			startQuestions();
			addLinkToPlaceC(md, '"Oh and what did you learn?"', 110, "type=trio3");
			AddPeopleColumnMed(md);
			AddPeopleColumnLarge(md);
			md.write('<table><tr><td style="width:50%">');
			perKristin.showPerson("trioeventkristin1.jpg", "99%");
			md.write('</td><td style="width:50%">');
			perBatton.showPerson("Setting/trioeventoffbatton1.jpg", "99%");
			md.write("</td></tr></table>");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "trio3") {
			md = WritePlaceHeader();
			if (perYou.isMaleSex()) this.showPerson("trioeventmayor3b.jpg");
			else this.showPersonRorX("trioeventmayor3g.jpg");
			addPlaceTitle(md, "Police Report");
			md.write('<p>You ask Kerry, "Oh and what did you learn?", but before she answers you take up the Mayor\'s offer, and you lick the sweet juice coming from the brunette slut\u2019s clit. ' + getPoliceChief() + " Batton answers you while starting to remove her clothing,</p>" + '<p>"That the world is full wonderful things. Things I never even took seriously before you charmed me! For example; did you know that the witches of Eastwick were actually real. Or that there are actual witch and vampire hunter groups and they\u2019ve been in war with vampires for centuries now..."</p>' +
				"<p>Glancing up you see she is watching you and Mayor Thomas lustfully. You also see Kristin is sitting and watch intently while playing with herself.</p>");
			startQuestions();
			addLinkToPlaceC(md, '"You sure did your homework, Kerry!"', 110, "type=trio4");
			AddPeopleColumnLarge(md);
			md.write('<table><tr><td style="width:50%">');
			perKristin.showPerson("trioeventkristin2.jpg", "99%");
			md.write('</td><td style="width:50%">');
			perBatton.showPerson("Setting/trioeventoffbatton2.jpg", "99%");
			md.write("</td></tr></table>");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "trio4") {
			md = WritePlaceHeader();
			this.showPersonRorX(perYou.isMaleSex() ? "trioeventmayor4b.jpg" : "trioeventmayor4g.jpg");
			addPlaceTitle(md, "Police Report");
			md.write('<p>You praise your police slave, "You sure did your homework, Kerry!", meanwhile the mayor ' + (perYou.isMaleSex() ? "smacks her lips around your boner" : "sucks eagerly at your clit") + " and starts doing what\u2019s she is best at!</p>" + "<p>" + getPoliceChief() + ' Kerry replies, "Ohh, yes! This had to be done in order to protect you, ' +
				perYou.getMaster() + ', from danger, be it any kind of threat."</p>');
			startQuestions();
			addLinkToPlaceC(md, '"I see"', 110, "type=trio5");
			AddPeopleColumnLarge(md);
			md.write('<table><tr><td style="width:50%">');
			perKristin.showPerson("trioeventkristin3.jpg", "99%");
			md.write('</td><td style="width:50%">');
			perBatton.showPerson("Setting/trioeventoffbatton3.jpg", "99%");
			md.write("</td></tr></table>");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "trio5") {
			md = WritePlaceHeader();
			this.showPersonRorX(perYou.isMaleSex() ?
				"trioeventmayor5b.jpg" : "trioeventmayor4g.jpg");
			addPlaceTitle(md, "Police Report");
			md.write("<p>" + getPoliceChief() + ' Kerry answers you, "An another piece of important information I have to tell you is that during my research, I\u2019ve read a lot about a renegade female witch group who were very active during the time of Kurndorf\u2019s reign. They were allies with him, but they somehow dissapeared after the fall of the mighty warlock. The interesting part is that, there have been recent activities in the neighbouring town, Somerton, that shows signs that these witches are maybe back."</p>');
			startQuestions();
			addLinkToPlaceC(md, '"Well, we can\u2019t base anything on rumors..."', 110, "type=trio6");
			AddPeopleColumnLarge(md);
			md.write('<table><tr><td style="width:50%">');
			perKristin.showPerson("trioeventkristin4.jpg", "99%");
			md.write('</td><td style="width:50%">');
			perBatton.showPerson("Setting/trioeventoffbatton5.jpg", "99%");
			md.write("</td></tr></table>");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "trio6") {
			md = WritePlaceHeader();
			this.showPersonRorX(perYou.isMaleSex() ? "trioeventmayor5b.jpg" : "trioeventmayor4g.jpg");
			addPlaceTitle(md, "Police Report");
			md.write('<p>"Well, we can\u2019t base anything on rumors...What did you have in mind, my dear officer?", you ask Kerry, but suddenly, Kristin, who was silent during the whole conversation starts to talk. She already disrobed herself and is frantically caresses her cleavage.</p>' + '<p>"' + perYou.getMaster() + '... I have a good reputation in Somerton, have some contacts there. I took the liberty to ask them for any information, news about these witch sightings. I had to be subtle and careful, so it takes time until I receive anything, but I\u2019m on it."</p>');
			startQuestions();
			addLinkToPlaceC(md, '"Thank you, Kerry...and Kristin."', 110, "type=trio7");
			AddPeopleColumnLarge(md);
			md.write('<table><tr><td style="width:50%">');
			perKristin.showPerson("trioeventkristin5.jpg", "99%");
			md.write('</td><td style="width:50%">');
			perBatton.showPerson("Setting/trioeventoffbatton5.jpg", "99%");
			md.write("</td></tr></table>");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "trio7") {
			md = WritePlaceHeader();
			if (perYou.isMaleSex()) this.showPersonRorX("trioeventmayor6b.jpg");
			else this.showPerson("trioeventmayor6g.jpg");
			addPlaceTitle(md, "Police Report");
			md.write('<p>"Thank you, Kerry...and Kristin. You\u2019ve pleased me well today. If these reports are true, then we will have to defend Glenvale from these witch-bitches.", ' + (perYou.isMaleSex() ? "you thrust even more" : "you sigh from the delightful tongue of the mayor") + ", Miss Thomas savors every single second of it, moaning.</p>" + "<p>Kerry and Kristin in a unison: Yes " + perYou.getMaster() + "!</p>" + '<p>You tell them, "It is crucial that you take this seriously, girls. Inform me with every tiny detail you come across!". Suddenly, the telephone rings. Kerry jumps up to answer it, but it\u2019s just Angela asking for something irrelevant so the ' +
				getPoliceChief().toLowerCase() + " hangs the phone.</p>" + '<p>Kristin replies, "Of course, ' + perYou.getMaster() + ', this is our life goal now. To serve."</p>');
			startQuestions();
			addLinkToPlaceC(md, '"Fine, Miss Thomas. I\u2019ve had my fun!"', 110, "type=trio8");
			AddPeopleColumnLarge(md);
			md.write('<table><tr><td style="width:50%">');
			perKristin.showPerson("trioeventkristin5.jpg", "99%");
			md.write('</td><td style="width:50%">');
			perBatton.showPerson("Setting/trioeventoffbatton6.jpg", "99%");
			md.write("</td></tr></table>");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "trio8") {
			md = WritePlaceHeader();
			this.setFlag(5);
			AddCash(500);
			this.showPerson("trioeventmayor6g.jpg");
			this.showPerson("trioeventkristin6.jpg");
			perBatton.showPerson("Setting/trioeventoffbatton6.jpg", "50%");
			addPlaceTitle(md, "Police Report");
			md.write('<p>"Fine, Miss Thomas. I\u2019ve had my fun! Now let\u2019s get dressed ladies, we\u2019ve got work to do!", you slap your slave on the butt and let yourself off of her.</p>' + "<p>While the Mayor finishes herself and " +
				getPoliceChief() + " Batton lies exhausted on the desk, Kristin comes close to you, confidently stating the following,</p>" + '<p>"Here\u2019s ' + sCurrency + '500, secured for you, in cash. Not traceable, all yours to spend. It\u2019s not much, but it\u2019s only just the taste of what\u2019s to come for you Master. Have fun!"</p>' + "<p>Kristin hands you an envelope with 500 dollars to use as you wish. You leave the office first, followed by Kristin and Kerry. Ellie silently follows Kristin and the three of them leave the building.  Angela grins as she sees the joy on your face. It\u2019s always amusing to visit the Mayor.</p>");
			startQuestions();
			addLinkToPlaceC(md, '"Thank you ladies I have to go"', 94);
			WritePlaceFooter(md);
			return true
		}
		if (!this.checkFlag(5) && (checkPersonFlag("Ellie", 3) || checkPersonFlag("Angela", 10))) {
			md = WritePlaceHeader();
			var q1 = getQueryParam("q1");
			var q2 = getQueryParam("q2");
			var q3 = getQueryParam("q3");
			setPersonFlag("Ellie", 6);
			if (sType == "trio1q1") {
				this.showPerson("trioeventmayor1.jpg");
				addPlaceTitle(md, "Questioning the Mayor");
				md.write("<p>You ask the Mayor about the redesign, and Mayor Thomas replies,</p>" +
					'<p>"What exactly did you have in mind, ' + perYou.getMaster() + '?"</p>' + '<p>You reply, "You know, just the usual. Some renovation to the building, upgrade the computers and devices and some staff improvement. I mean I like Angela a lot, but come on...she is all alone here...and I am always glad to see new faces..."</p>' + '<p>Mayor Thomas smiles, "Ohh, I see ' + perYou.getMaster() + '! I will work on these. I will bring you fresh recruits to enslave. I\u2019m going to declare an intern program for young trainees and hire them!"</p>')
			} else if (sType ==
				"trio1q2") {
				this.showPerson("Setting/trioeventoffbatton1.jpg");
				addPlaceTitle(md, "Questioning Kerry");
				md.write('<p>You ask Kerry, "Baby, where\u2019s the uniform? You know you look hot in them..." and she replies,</p>' + '<p>"Ohh, yes ' + perYou.getMaster() + '! I had to change to prevent any suspicion from the people. I thought this civilian outfit would still be to your liking..."</p>' + '<p>"Oh, yes it is...you don\u2019t even know how much it is to my liking...", you answer sinisterly, like some kind of evil super villain.</p>')
			} else if (sType ==
				"trio1q3") {
				this.showPerson("trioeventkristin1.jpg");
				addPlaceTitle(md, "Questions Kristin");
				md.write('<p>You ask Kristin, "I met Ellie outside. She is your secretary now as I heard". Kristin replies,</p>' + '<p>"I needed someone who I can trust and who serve me underneath your regime. She\u2019s great at maintaining relationships and also a good talker. I bring her with me to meetings and events, so she can keep the people company. I hope you didn\u2019t have other plans with her, ' + perYou.getMaster() +
					', because if so then of course she is yours to use."</p>' + '<p>You reply, "No, you did the right thing. You need some helping hands anyways, you can keep her for now."</p>')
			} else {
				this.showPerson("trioeventmayor1.jpg");
				addPlaceTitle(md, "Meeting your Slaves");
				md.write("<p>This is a sight for sore eyes! Three beautiful ladies and all yours.</p>" + "<p>Kristin and Kerry are sitting right in front the mayor\u2019s desk. You notice that Kerry changed her uniform into a dress. Kristin is looking fancy as usual and the Mayor is already on her desk, focusing on the other two, talking to them. They do their regular greetings, each of them hugging and kissing you and are now patiently waiting for you to act.</p>")
			}
			startQuestions();
			if (q1 == "asked" && q2 == "asked" && q3 == "asked") addLinkToPlaceC(md, '"All right, girls! What\u2019s the news? Why am I called here?"', 110, "type=trio2");
			if (q1 != "asked") addLinkToPlaceC(md, '"Mayor, this place really could use some redesign"', 110, "type=trio1q1&q1=asked&q2=" + q2 + "&q3=" + q3);
			if (q2 != "asked") addLinkToPlaceC(md, '"Kerry, where\u2019s the uniform?"', 110, "type=trio1q2&q2=asked&q1=" + q1 + "&q3=" + q3);
			if (q3 != "asked") addLinkToPlaceC(md, '"Kristin, I met Ellie outside..."', 110, "type=trio1q3&q3=asked&q2=" + q2 + "&q1=" +
				q1);
			AddPeopleColumnLarge(md);
			md.write('<table><tr><td style="width:50%">');
			if (sType == "trio1q1") {
				perKristin.showPerson("trioeventkristin1.jpg", "99%");
				md.write('</td><td style="width:50%">');
				perBatton.showPerson("Setting/trioeventoffbatton1.jpg", "99%")
			} else if (sType == "trio1q2") {
				this.showPerson("trioeventmayor1.jpg", "99%");
				md.write('</td><td style="width:50%">');
				perKristin.showPerson("trioeventkristin1.jpg", "99%")
			} else if (sType == "trio1q3") {
				perKristin.showPerson("trioeventmayor1.jpg", "99%");
				md.write('</td><td style="width:50%">');
				perBatton.showPerson("Setting/trioeventoffbatton1.jpg", "99%")
			} else {
				perKristin.showPerson("trioeventkristin1.jpg", "99%");
				md.write('</td><td style="width:50%">');
				perBatton.showPerson("Setting/trioeventoffbatton1.jpg", "99%")
			}
			md.write("</td></tr></table>");
			WritePlaceFooter(md);
			return true
		}
		return false
	};
	per.showPersonTextHere = function(md) {
		if (Place == 176 && this.isHere())
			if (!this.isCharmedBy("You"))
				if (this.isCharmedBy("Davy")) {
					md.write("<p>Mayor Thomas greets you at the door, asking where Davy is. ");
					if (isCharmedBy("Tina") &&
						!isCharmedBy("MrsRobbins", "You")) md.write("Tina Robbins, only half clad, is waiting for your instructions.");
					md.write("</p>")
				} else md.write('<p>Mayor Thomas stand there, freed from Davy\'s control, with a look of sheer confusion on her face.  "What? - How did I get here?" She asks.</p>');
		else md.write("<p>Mayor Thomas wants you so much that she pleads for you to take her. Tina Robbins is pleased to have served you so well.</p>");
		if (Place == 468 && sType === "")
			if (this.isHere()) md.write("<p>Mayor Thomas is waiting for you, wearing a slinky dress, a party dress really.</p>")
	};
	per.showPersonChat = function(bGeneral, md) {
		if (Place == 466 && isPlaceKnown("MayorApartment")) addLinkToPlace(md, "visit Beatrice's apartment", 468);
		else if (Place == 176 && this.isHere()) {
			if (sType === "")
				if (!this.isCharmedBy("Davy")) addQuestionC(md, "tell Mayor Thomas to return to her office", "Mayor", 1650)
		} else if (this.isHere() && this.isCharmedBy() && sType === "") {
			if (perGates.checkFlag(6) && !isPlaceKnown("AvernusClub")) addQuestionR(md, '"Is there a gentlemans club in Glenvale?"', "You ask her about the gentlemans's club you were told about. Mayor Thomas almost rolls her eyes,</p>" +
				'<p>"Yes, yes, unfortunately. It is not I object to such places but there was so much resistance from the council, the police and do-gooders around town!"</p>' + "<p>She gives you directions to the club, it is located in a side street off the shopping center. The club is open late at night until the early hours and is by invitation only. She quickly makes a phone call, and tells you,</p>" + '<p>"You are now my personal guest for the club, you can visit any time you want"', "Mayor", "setPlaceKnown(\\'AvernusClub\\')");
			if (!isPlaceKnown("MayorsApartment")) addQuestionR(md, '"Where do you live?"', "You ask your Mayor-slave about her home,</p>" + '<p>"Do you know the Haven apartments in the town center? I own them as an investment and I live in te penthouse apartment. I was never one for gardens and suburbs, I much prefer a luxurious fully serviced apartment."</p>' + "<p>You understand her feelings there, but you do prefer a house and yard. You make arrangements with Mayor Thomas to visit and she gives you a card allowing you access at all times, to the apartment and to her.",
				"Mayor", "setPlaceKnown(\\'MayorsApartment\\')");
			if (Place == 468) {
				addLinkToPlace(md, "ask Mayor Thomas for more of her body", Place, "type=fuck");
				if (isExplicit(true)) addLinkToPlace(md, "ask Mayor Thomas to do more to your body", Place, "type=bj");
				if (isPlaceKnown("DianesApartment") && wherePerson("Diane") == 467) addLinkToPlace(md, "Diane should be home, invite her to join in", Place, "type=threesomediane");
				addSleepLink(md, "bed the Mayor", "Sleeping with Beatrice", '<p style="position:absolute;left:5%;top:10%;cursor:pointer;font-size:1.1em;width:40%"><b>You take Beatrice to bed, and she strips naked, explaining she never wears anything to bed!</b>',
					"mayor-bed.jpg", true, "", "", "", "overflow-y:hidden")
			}
		}
	};
	per.handleItem = function(no, cmd) {
		if (no == 32)
			if (cmd == 1)
				if (this.isHere() && this.isCharmed()) {
					examineSilverRingStart();
					addComments("<p>It seems to be reacting to Mayor Thomas's presence... getting warmer the closer you get.</p>" + "</td></tr></table>");
					return "handled"
				}
		if (no == 14 && cmd == 2)
			if (Place == 110 && this.isHere()) {
				if (this.other == 3) addComments("You should speak to her first!");
				else if (!isCharmedBy("Mayor", "Davy")) CastCharmSpell("Mayor", 243, 1);
				else addComments("You attempt to cast the spell, but if fails to take effect... Evidently Mayor Thomas is already under the effects of a charm spell...  Someone <i>else's</i> spell.");
				return "handled"
			} else if (Place == 176 && this.isHere())
			if (isCharmedBy("MrsRobbins", "Davy")) {
				if (!this.isCharmed()) CastCharmSpell("Mayor", 243, 1);
				else addComments("You attempt to cast the spell, but if fails to take effect... Evidently she is already under the effects of a charm spell...  Someone <i>else's</i> spell.");
				return "handled"
			} else if (isCharmedBy("MrsRobbins", "You")) {
			CastCharmSpell("Mayor", 243, 1);
			return "handled"
		}
		return ""
	};
	per.isPhoneable = function() {
		return checkPlaceFlag("Hotel", 11) && Place == 269 && this.isCharmedBy()
	};
	per.callThem = function() {
		if (Place == 269)
			if (isShopOpen(0)) WriteComments("You call the Mayor to invite her to join you at the pool for a swim, but Angela answers to apologies that the Mayor is busy in a meeting and maybe you could try again later?");
			else {
				gotoPlace(Place, "type=mayorpool");
				receiveCall("", "You call Mayor Thomas to invite her to join you at the pool for a swim, there is no answer so you try an SMS, this time she responds that she will meet you there.");
				WriteCommentsFooter(bChat, bChatLeft)
			}
	}
}

function initialiseMelissa() {
	addPerson("Melissa", 0, "Melissa");
	per.isPersonInfo = function() {
		return this.isCharmedBy()
	};
	per.getPersonInfo = function() {
		var s = "<img src='Images/" + (this.getCharmedLevel() == 4 ? "melissa10" : "melissa12") + ".jpg' style='width:30%;float:right;margin-left:5px' alt='Melissa'>";
		if (this.getCharmedLevel() == 4) return s + "Melissa turned out to be a very submissive girl, even before you have placed her under your spell, and adjusted to her new role as your slave with ease.</p>" + "<p>She can be a little passive, almost shy until you give a direct order. And if you don't, she'll usually just do her work and occasionally casts furtive glances into your direction as you enjoy the attractions of the empty aquarium.</p>" +
			"<p>Of course, she's one of those attractions now. Melissa has begun working in the nude even if you are not around and admitted to you that she enjoys the thrill of it. She has always liked her body, but was apprehensive about the way other people might view her to the point where she always wore clothes concealing her curves when outside and only worked the night-shift to avoid colleagues and customers.</p>" + "<p>Under your spell, however, she no longer cares about what other people may think. Your opinion is the only one that matters to her now, and she works hard to gain your approval.</p>";
		else return s + "Melissa is a very submissive girl.</p>" + "<p>Even as your lover she happily and completely devotes herself to you and only scarcely seems willing to make her own desires known.</p>" + "<p>Still, she is a great companion. Thanks to her, you now have free access to the aquarium during after hours and not only get to see the usual attractions in peace, but also Melissa doing her work with no or very few clothes on her.</p>" + "<p>Melissa loves her curves. She loves to be naked, and she loves to be watched, especially by you, but a part of her was always apprehensive about the way other people might see her, so she always worked the night-shift to avoid colleagues and customers.</p>" +
			"<p>Now, under your spell and encouragement, she is slowly growing to be more and more exhibitionistic. You occasionally see her in sexy outfits even outside of work, and she is more than willing to remove them for a quickie, too.</p>"
	};
	per.whereNow = function() {
		if (isDay()) return this.place;
		var day = (Math.floor(nTime / 288) % 7 + 1) % 3;
		if (day === 0 || day == 1) return 369;
		return 370
	};
	per.passTimeDay = function() {
		this.setFlag(3, false);
		return ""
	};
	per.showEventPopup = function() {
		if (sType == "watchmelissa2") {
			showPopupWindow("Working",
				"<img src='Images/People/Melissa/" + (this.getCharmedLevel() == 4 ? "melissa23.jpg" : "melissa14.jpg") + "' class='imgpopup' alt='Melissa'>" + "It takes her a while to notice that you have your eyes on her the whole time, watching her as she crawls on the floor or stretches herself to reach certain spots. She is apprehensive of it at first, she quickly seems to grow accustomed to your gaze.", "WaitHereOnly(6);dispPlace(Place,'type=watchmelissa3')", "", true);
			return true
		}
		if (sType == "watchmelissa3") {
			showPopupWindow("Working",
				"<img src='Images/People/Melissa/" + (this.getCharmedLevel() == 4 ? "melissa24.jpg" : "melissa15.jpg") + "' class='imgpopup' alt='Melissa'>" + "Soon, you find her actively presenting herself to you, pushing her sizable bust forward, swaying her hip teasingly as she walks and even wiggling her ass whenever she needs to pick something off the ground, which coincidentally happens pretty often now.", "WaitHereOnly(6);dispPlace(Place,'type=watchmelissa4')", "", true);
			return true
		}
		if (sType == "watchmelissa4") {
			showPopupWindow("Working",
				"<img src='Images/People/Melissa/" + (this.getCharmedLevel() == 4 ? "melissa25.jpg" : "melissa16.jpg") + "' class='imgpopup' alt='Melissa'>" + "After about an hour of work, she is visibly aroused. Her folds are coated in her fluids and the way she moves is downright provocative and sensual. Melissa clearly enjoys being watched. Maybe it's just be the spell affecting her will, but chances are she has had a little exhibitionist streak all along.", "WaitHereOnly(6)", "", true);
			return true
		}
		if (!this.isHere()) return false;
		if (!this.checkFlag(1)) {
			this.setFlag(1);
			showPopupWindow("Someone Else Here", "<img src='Images/People/Melissa/melissa1.jpg' class='imgpopup' alt='Cleaner'>" + "As it appears, the aquarium is not as empty at night as you had suspected, and you barely manage to duck out of sight before you are spotted by what must be the cleaning lady.<br><br>" + "Lucky for you, she is completely absorbed in her work, sweeping the floor with a bored expression and barely looking up to check her surroundings.<br><br>" + "You manage to get a good look from your hiding spot, and while her presence is a bit of an inconvenience, you do like what you see. Her uniform is rather snug, and definitely not big enough to contain her massive breasts. She has pulled down the zipper, if she had ever managed to pull it up to begin with, and you have a great look at her cleavage and the surprisingly racy bra she wears.<br><br>" +
				"For a moment, you wonder if you should approach her, but in the end, that might be unwise. You are not supposed to be here, after all, and if she causes a ruckus you have no way to stop her without knowing her name.");
			return true
		}
		return false
	};
	per.showEvent = function() {
		var md;
		if (Place == 269 && sType == "melissapool") {
			WaitHereOnly(4);
			md = WritePlaceHeader();
			this.showPerson("melissa-pool.jpg");
			addPlaceTitle(md, "Swimming with Melissa");
			md.write("<p>Melissa arrives, dressed in a bikini with her hair tied back, smiling and looking quite different in the daylight.</p>");
			startQuestions();
			addLinkToPlaceC(md, "it is fairly private here...", Place, "type=melissapoolsex");
			addLinkToPlaceC(md, "say goodbye to Melissa", Place);
			WritePlaceFooter(md);
			return true
		}
		if (Place == 269 && sType == "melissapoolsex") {
			md = WritePlaceHeader();
			this.showPerson("melissa-pool-sex.jpg");
			addPlaceTitle(md, "Being Discrete and Private with Melissa");
			md.write("<p>You ask Melissa to play with you more privately, and she seductively removes her swimsuit and sits waiting for you.</p>");
			startQuestions();
			addLinkToPlaceC(md,
				"later...say goodbye to Melissa", Place);
			WritePlaceFooter(md);
			return true
		}
		if (this.isHere()) {
			if (sType == "charmmelissa1") {
				md = WritePlaceHeader();
				this.showPerson("melissa3.jpg");
				addPlaceTitle(md, "Melissa Under a Spell");
				md.write("<p>\u201cH...hello?\u201d Melissa looks around the room uneasily as the first traces of the familiar pink glow begin to flicker in her eyes. \u201cIs... is someone there?\u201d</p>" + "<p>After a few seconds of silence she tries to resume her work, and you watch with a smile as the spell begins to slowly take effect and she absentmindedly touches herself.</p>" +
					"<p>She's trying to keep her fingers in check at first. A squeeze here, a pinch there... nothing too naughty, but her cheeks are reddening more and more with every minute, and soon, she is barely able to keep her hands off her own body.</p>" + "<p>\u201cNo... no... what am I doing...\u201d She shakes her head, casting another uneasy glance across the room and, after maybe another minute of trying to focus back on her work, she hastily pulls down her bra with a deep, relaxing sigh.</p>");
				startQuestions();
				addLinkToPlaceO(md, "watch her touching herself", Place, "type=charmmelissa2");
				WritePlaceFooter(md);
				return true
			}
			if (sType == "charmmelissa2") {
				md = WritePlaceHeader();
				this.showPerson("melissa4.jpg");
				addPlaceTitle(md, "Melissa Under a Spell");
				md.write("<p>Melissa reveals her breasts and massages them eagerly, kneading the massive orbs with both hands and lustfully moaning into the room. You can feel the spell building up her lust with every passing second, and soon, fondling her breasts no longer seems to be enough.</p>");
				startQuestions();
				addLinkToPlaceO(md, "keep watching", Place, "type=charmmelissa3");
				WritePlaceFooter(md);
				return true
			}
			if (sType == "charmmelissa3") {
				md = WritePlaceHeader();
				this.showPerson("melissa5.jpg");
				addPlaceTitle(md, "Melissa Under a Spell");
				md.write("<p>\u201cS... someone is here, right?\u201d  She calls out into the empty aquarium.  \u201cSomeone is watching me... making me do these... things....\u201d</p>" + "<p>Her voice is dripping with need and arousal, and as she speaks, she begins rubbing her fingers against her folds through her underwear, moaning lustfully.</p>" +
					"<p>\u201cMaking me... touch myself... pleasure myself.\u201d</p>");
				startQuestions();
				addLinkToPlaceO(md, "wait just a little longer", Place, "type=charmmelissa4");
				WritePlaceFooter(md);
				return true
			}
			if (sType == "charmmelissa4") {
				md = WritePlaceHeader();
				this.showPerson("melissa6.jpg");
				addPlaceTitle(md, "Melissa Under a Spell");
				md.write("<p>The spell has begun to form a connection and Melissa's eyes keep twitching into your direction, aware of your presence, but no longer bothered by it.</p>" + "<p>You watch as she kicks her panties away, seats herself on a nearby chest and begins to put her body on display for you, a shiver of pure lust rushing through her as she removes the rest of her uniform, roughly kneads her breasts and caresses her skin while spreading her folds and circling her, to your surprise, pierced clit.</p>" +
					"<p>She is almost ready, and her mind as malleable as it will ever be. Now is the time to put a finishing touch on her enspellment.</p>");
				startQuestions();
				addLinkToPlaceO(md, "show yourself", Place, "type=charmmelissa5");
				WritePlaceFooter(md);
				return true
			}
			if (sType == "charmmelissa5") {
				md = WritePlaceHeader();
				this.showPerson("melissa7.jpg");
				addPlaceTitle(md, "Melissa Under a Spell");
				md.write("<p>She is close to her climax as you step out of your hiding spot, her eyes going wide, cheeks flushed and her mouth wide open in pure awe as she falls on her knees in front of the chest.</p>" +
					"<p>\u201cI... I have been waiting for you...I think...\u201d She whispers in a husky voice, her entire body trembling in anticipation. \u201cI can't explain it but...\u201d She stops mid sentence.</p>" + "<p>\u201cPlease, I need to know who you are, what is your name?\u201d</p>");
				startQuestions();
				addLinkToPlaceC(md, "tell your new lover your name", Place, "type=charmmelissa6lover");
				addLinkToPlaceC(md, "tell your new slave to call you " + perYou.getMaster(), Place, "type=charmmelissa6slave");
				WritePlaceFooter(md);
				return true
			}
			if (sType == "charmmelissa6lover") {
				md = WritePlaceHeader();
				this.showPerson("melissa8.jpg");
				addPlaceTitle(md, "Lover Melissa Under a Spell");
				md.write("<p>\u201cI'm " + perYou.getPersonName() + ".\u201d You tenderly drive your fingers through her hair, and she releases a soft sigh, her eyes focused on you,</p>" + "<p>\u201c" + perYou.getPersonName() + "...\u201d She smiles brightly. \u201cI'm Melissa... but I believe you already know that, and I... I am usually not like this but I think I'm in love with you...!\u201d She bites her lower lip, her expression suddenly a little insecure. \u201cDo you... love me, too?\u201d</p>" +
					"<p>\u201cOf course.\u201d You answer gently. \u201cI love all the girls in my harem.\u201d</p>" + "<p>\u201cYour... Harem...?\u201d There is a brief moment of uncertainty on her face, but it quickly fades into a grimace of lust and pleasure as you focus on the mana inside her and finally make her climax.</p>" + "<p>\u201cA....ahhh...\u201d You watch her hip twitch and her eyes loose focus, waiting patiently as her entire body convulses from the powerful torrent of sensations rushing through her. When she finally regains her focus, whatever doubt may have been left had vanished.</p>" +
					"<p>\u201cThat was amazing! You... I... I would love to be part of your harem! I'd do anything to get to feel like that again!\u201d</p>" + "<p>Your only response is a smile as you drive your fingers through her hair, of course you have quite a few ideas what she could do.</p>");
				startQuestions();
				addLinkToPlaceC(md, "talk to Melissa of your ideas", Place);
				WritePlaceFooter(md);
				return true
			}
			if (sType == "charmmelissa6slave") {
				md = WritePlaceHeader();
				this.charmThem(4);
				this.showPerson("melissa8.jpg");
				addPlaceTitle(md,
					"Slave Melissa Under a Spell");
				md.write("<p>\u201cYou can call me " + perYou.getMaster() + ".\u201d You gently caress her cheek as you say those words, and her eyes widen in shock.</p>" + "<p>\u201c" + perYou.getMaster() + "?!?\u201d</p>" + "<p>\u201cYes, is that not what a slave calls their owner?\u201d You drive your thumb over her lips, and she closes her eyes with a sigh.</p>" + "<p>\u201cIt... it is...\u201d</p>" + "<p>\u201cAnd you want to be my slave, do you?\u201d You focus on the mana inside her, using her build up arousal to keep her on the edge of her climax, your every word shaping her mind.</p>" +
					"<p>\u201cYou want to give yourself to me with body mind and soul, Melissa. You want to obey everything I say and serve my every desire unquestioningly, right?\u201d</p>" + "<p>\u201cYeff...\u201d She has begun suckling on your fingers, her eyes foggy as the last of her resistance melts into a haze of lust. \u201cI... I do... but...\u201d</p>" + "<p>You push Melissa over the edge before she is able to finish the thought, and she almost falls over the moment the pent-up torrent of sensations washes through her body, twitching, moaning and screaming her lust into the aquarium loud enough to startle a few of the fishes.</p>" +
					"<p>When she is finally able to focus again, the spell has finished remolding her mind, her eyes full of devotion and her body still trembling from the aftereffects of her climax.</p>" + "<p>\u201cThis was amazing...\u201d She whispers demurely, quickly lowering her head. \u201cI would love to be your slave! Please, tell me how to serve you further, " + perYou.getMaster() + "!\u201d</p>" + "<p>You have some ideas...</p>");
				startQuestions();
				addLinkToPlaceC(md, "talk to Melissa of your ideas", Place);
				WritePlaceFooter(md);
				return true
			}
			if (sType == "melissafuck") {
				md = WritePlaceHeader();
				this.showPersonRorX(perYou.isMaleSex() ? "melissa17.jpg" : "melissa21.jpg");
				addPlaceTitle(md, "Melissa");
				if (perYou.isMaleSex()) md.write("<p>You take Melissa right on the freshly cleaned floor, pushing into her with fast, rough strokes and enjoying the view of her massive bust jiggling with every motion.</p>");
				else md.write("<p>Melissa may be inexperienced with other women, but, as you quickly found out, knows her own body rather well and is more than eager to apply that knowledge to satisfy your desires.</p>");
				startQuestions();
				addLinkToPlaceO(md, "let her resume work", Place);
				WritePlaceFooter(md);
				return true
			}
			if (sType == "melissabj") {
				md = WritePlaceHeader();
				this.showPersonRorX(perYou.isMaleSex() ? "melissa18.jpg" : "melissa20.jpg");
				addPlaceTitle(md, "Melissa");
				if (perYou.isMaleSex()) md.write("<p>Melissa greedily takes your cock into her mouth. She is a little sloppy and inexperienced, but you do enjoy her attentions nonetheless.</p>");
				else md.write("<p>Melissa eagerly buries her face between your tights, and after a bit of experimenting, brings you to climax with surprising ease.</p>");
				startQuestions();
				addLinkToPlaceO(md, "let her resume work", Place);
				WritePlaceFooter(md);
				return true
			}
			if (sType == "melissatits") {
				md = WritePlaceHeader();
				this.showPersonRorX("melissa19.jpg");
				addPlaceTitle(md, "Melissa");
				md.write("<p>You place your cock between Melissa's massive orbs and she happily squeezes them together to provide you with a good old-fashioned titjob.</p>");
				startQuestions();
				addLinkToPlaceO(md, "let her resume work", Place);
				WritePlaceFooter(md);
				return true
			}
		}
	};
	per.addPlaceImageLeft = function(lit) {
		if (this.isHere() &&
			sType === "") {
			if (this.isCharmedBy()) return this.showPerson(this.getCharmedLevel() == 4 ? "melissa11.jpg" : "melissa9.jpg", "", "", "", "", false, "string");
			return this.showPerson("melissa2.jpg", "", "", "", "", false, "string")
		}
		return ""
	};
	per.showPersonTextHere = function(md) {
		if (this.isHere() && sType === "")
			if (!this.isCharmedBy())
				if (!this.checkFlag(2)) md.write("<p>The cleaning lady seems to be completely focused on her work, but you shouldn't linger here for too long if you don't want her to see you.</p>");
				else md.write("<p>Melissa remains focused on her work as always, It would be easy now to cast the spell unnoticed, if you wish to do so.</p>");
		else if (this.getCharmedLevel() == 4) md.write("<p>Melissa falls onto her knees and straightens herself after she has let you in.  She doesn't dare to resume her work unless you give her the explicit order to do so, and even as she does, she is doing her best to impress you, occasionally casting over a quick, nervous glance.</p>");
		else md.write("<p>Melissa is, more or less, resuming her work after she has let you inside. However, her attention is mostly on you. She had taken off most of her clothes even before you came in and occasionally looks at you with a dreamy smile.</p>")
	};
	per.showPersonChat = function(bGeneral, md) {
		if (Place == 394 && this.checkFlag(1) && !this.checkFlag(2) && sType === "" && isPersonHere("Abby")) addQuestionR(md, "ask Abby about the cleaning lady", isCharmedBy("Abby") ? "\u201cOh, you mean Melissa?\u201d Abby beams in excitement. \u201cShe hasn't been with us long, but she surely turns heads! I don't think there is a single man on the staff who has not wanted to help her with her uniform, and she does act all flustered and embarrassed if people stare but if you ask me she totally likes it because have you seen her bras?\u201d She gestures to the front of her chest. \u201cThey are all lacy and partly see through and that's totally not part of the uniform!\u201d</p>" +
			"<p>You expect her to need a breather, but she just goes on.</p>" + "<p>\u201cAnd those uniforms are archaic anyway, I told you that, right? I mean why should she bother with them when she is working all alone at night? I bet secretly she would love to just throw off these antiquated notions of \u201cmodesty\u201d as well, but when I told her, she acted all flustered and told me she has work to do and that management wouldn't allow it anyway and she is probably even right on the last bit but it's not like anyone would see her so she knows I am right and just won't admit it.\u201d</p>" +
			"<p>Abby would likely continue her rant for a while longer, but at least you got what you needed out of it, and while she is a little disappointed when you tell her that you don't have that much time to talk, she is happy to have been of help and quick to ask she may help you with anything else." : "\u201cOh, that's Melissa.\u201d Abby answers without a second of hesitation. \u201cBut don't get your hopes up if you want to ask her out, she's really... reserved. Always comes in, does her work and leaves without ever talking much, not even to me, and I tried to get her to talk a lot. She is polite about it, but I know she totally isn't interested.</p>" +
			"<p>Abby goes on for a while about Melissa, other cleaning staff and the aquarium in general, but it's mostly gossip and complains, so the most useful information you get is that Melissa apparently has a way to make even Abby understand that she is not interested in a conversation... which is quite the feat.</p>" + "<p>At least you finally know her name.", "Abby", "setPersonFlag(\\'Melissa\\',2)");
		if (this.isHere() && this.isCharmedBy() && sType === "") {
			if (!this.checkFlag(3)) addPopupLink(md, "watch her work",
				"Working", "<img src='Images/People/Melissa/" + (this.getCharmedLevel() == 4 ? "melissa22.jpg" : "melissa13.jpg") + "' class='imgpopup' alt='Melissa'>" + "You tell Melissa to not mind your presence. You are just here to take in the sights, and she should just keep on working as usual, and while she does look disappointed, she quickly nods and goes back to cleaning the floor.", true, "WaitHereOnly(6);dispPlace(Place,'type=watchmelissa2')");
			if (perYou.isMaleSex()) {
				addLinkToPlace(md, "enjoy her pussy", Place, "type=melissafuck");
				addLinkToPlace(md, "enjoy her mouth", Place, "type=melissabj");
				addLinkToPlace(md, "enjoy her tits", Place, "type=melissatits")
			} else {
				addLinkToPlace(md, "enjoy her body", Place, "type=melissafuck");
				addLinkToPlace(md, "enjoy her tongue", Place, "type=melissabj")
			}
		}
	};
	per.handleItem = function(no, cmd) {
		if (no == 14 && cmd == 2)
			if (this.isHere()) {
				if (!this.checkFlag(2)) addComments("No point in casting the spell if you don't know her name, it won't work.");
				else CastCharmSpell("Melissa", Place, 2, "type=charmmelissa1");
				return "handled"
			}
		return ""
	};
	per.isPhoneable = function() {
		return checkPlaceFlag("Hotel", 11) && Place == 269 && this.isCharmedBy()
	};
	per.callThem = function() {
		if (Place == 269)
			if (!isDay()) WriteComments('You call Melissa to invite her to join you at the pool for a swim, but she replies, "Sorry ' + perYou.getMaster() + ' I am working and I cannot afford to take time off!". She apologies and promises to another time. ');
			else {
				gotoPlace(Place, "type=melissapool");
				receiveCall("", 'You call Melissa to invite her to join you at the pool for a swim, and after a delay she sleepily answers, "Ok, why not!" and promises to be there soon.');
				WriteCommentsFooter(bChat, bChatLeft)
			}
	}
}

function RepliesMia(nR) {
	var bCharm = per.isCharmedBy();
	var myLord = per.getYourNameFor();
	if (nR == 1E3) {
		bChatLeft = false;
		per.setFlag(5);
		setPersonFlag("Bambi", 5);
		addComments('"We have a lot here that is aged to perfection", she smiles as she adjusts her top, exposing her breasts a little more. "But the wine is limited to only a few truly fine vintages. We have a wine rack in the cellar but before I arrived someone lost the key to the rack and they have not yet got in a locksmith to sort it out. The person was communing with nature in Glenvale Park near the Witch Stones and lost it!"')
	} else if (nR == 6010) {
		moveDavyToHotel2();
		bChatLeft = false;
		addComments('"Davy Robbins?  An odd young man checked in some time ago, I think that was his name", she answers and then smiles, "Not sure the name of his lady friend though, but I sent some drinks to their room not long ago, Room 101."</p><p>She hesitates, "Hmm, I am sure Bambi said something about not giving out customers details, so what!"</p>')
	} else if (nR == 10801) {
		bChatLeft = false;
		if (!bCharm)
			if (!this.checkFlag(1)) {
				addComments('<img src="Images/spill1.jpg" width="20%" style="float:left;margin-right:4px">"Sure have one on the house, she says with a smile. She passes the drink over to you and as you reach out you knock it over, spilling the drink, some of it on Mia\'s sleeve.</p><p>She looks at her sleeve, "I\'ll have to go and wash up, give me a couple of minutes". She steps in to back and returns a few minutes later and comments "Just as well it was only the sleeve, I might of had to take a shower if it was worse"</p><p>You consider you could &rsquo;accidentally&rsquo; splash her with a drink to get her somewhere private, you doubt you could do this more than <b>once</b>');
				this.setFlag(1)
			} else addComments('"Sure thing, have one on the house" she says as she whips up your scotch.  You can\'t keep down more than a sip.  Why do people <i>drink</i> these?');
		else if (isBritish()) addComments('"Sure thing" she says as she whips up your scotch.  "Anything else, ' + myLord + "?\" She whispers as she hands you the drink.  You can't keep down more than a sip.  Why do people <i>drink</i> these?");
		else addComments('"Sure, you are quite young looking aren\'t you" She says loud enough to keep up appearances as she whips up your scotch.  "Anything else, ' +
			myLord + "?\" She whispers as she hands you the drink.  You can't keep down more than a sip.  Why do people <i>drink</i> these?")
	}
	return true
}

function initialiseMia() {
	addPerson("Mia");
	per.Replies = RepliesMia;
	per.getYourNameFor = function() {
		return perYou.getLord()
	};
	per.getPersonAddress = function() {
		return isPlaceKnown("MiasApartment") ? "Apartment 12, 42 Celeste Rd" : ""
	};
	per.whereNow = function() {
		if (this.place == 124 && this.checkFlag(7)) {
			if (sType.indexOf("miagym") != -1) return 435;
			return !isDay() ? 124 : 458
		}
		return this.place
	};
	per.showEvent = function() {
		var md;
		var days;
		if (Place == 269 && sType == "miapool") {
			WaitHereOnly(6);
			md = WritePlaceHeader();
			this.showPerson("mia-pool.jpg");
			addPlaceTitle(md, "Swimming with Mia");
			md.write("<p>Mia arrives dressed in a bikini that look a lot like the one you say in the picture in Bambi's room, \"" + perYou.getPersonName() + ' like what you see?"</p>' + "<p>You swim for a little with Mia and while normally you would assume she would be interested in something else, she seems uncomfortable when you make a suggestion. You drop the idea, after all Bambi is around!</p>");
			startQuestions();
			addLinkToPlaceC(md, "say goodbye to Mia", Place);
			WritePlaceFooter(md);
			return true
		}
		if (Place == 458 && this.isHere() && sType === "") {
			SetLeftColumnSize("large");
			return false
		}
		if (Place == 435 && sType == "bambimiagym1") {
			this.charmedTime = nTime;
			this.moveThem(124);
			this.setFlag(7);
			setPersonFlag("Bambi", 7);
			setPersonFlag("Bambi", 12);
			md = WritePlaceHeader(false, "td-left-med");
			this.showPerson("mia1.jpg");
			addPlaceTitle(md, "Bambi and her Mother, Mia");
			md.write("<p>You take the taxi Bambi had called, it is a short 10 minute drive. During the ride Bambi is a bit restless, probably both anxious and excited. Anxious as she wants you to fill her request, excited as you may refuse and she will soon be having sex with her mother.</p>" +
				"<p>At the gym she makes a quick phone call to confirm where her mother is and leads you in. She asks you to wait for a moment as she finds her mother. You wait near a set of exercise machines and a translucent toughened glass wall. The gym has these around the place to provide some noise reduction and for the interior design appeal.</p>" + "<p>You hear a voice, it is Bambi, but muffled a bit. She is at the machines on the other side of the glass wall, starting to exercise with her mother. Mia is as you expected, an attractive woman a little shorter than Bambi, with a similar figure to her daughter and a prominent tattoo on her hip.</p>" +
				"<p>As they work out you see them chatting, both glancing at you regularly, but the words are indistinct. The impression you get is the standard sort of teasing a mother can do for her daughters lover, and a daughter in reply. Bambi has clearly not discussed issues of magic, mind-control and dungeons.</p>" + "<p>You take a seat for a while, you are not dressed for a work-out, as they finish their work-out. Mia approaches you with Bambi following and making a 'shush' gesture, clearly wanting you to make a normal conversation.</p>" +
				'<p>"Hello, I\'m Mia, so you are fucking my daughter, good for you, just do not expect her to <i>only</i> fuck you!". Not quite the approach you expected, and you hesitate and reply a basic hello. She smiles grabs her daughter and puts an arm around her shoulders,</p>' + '<p>"Well, who she fucks is none of my business. But about business, she tells me you have some interest in the Hotel and that old fuck-wit Kurndorf. He was no leader, he let himself get shot, the fool.", she shakes her head,</p>' +
				'<p>"Somewhere I have a trinket he was supposed to own, but I suspect it is like pieces of the True Cross, there are a forest of them around. Still, I am sure we can come to terms if you want it". You certainly will, your terms not hers! You say some words about discussing it in the future, and she smiles,<p>' + '<p>"Sure, I will be working at the bar of the Broken Inn Hotel for a while. Bambi has asked me to help out for a while, she has some night job and wants me to help out. I\'ll be in town for a couple of weeks, I have a job planned then so I can hang around until then and help out."</p>' +
				'<p>Bambi joins in, "Thank you Mum, but you can stay as long as you like, the job can be yours permanently!". She pauses and looks at you "' + perYou.getPersonName() + " I'll see you back at the hotel some time?\"</p>" + "<p>She is asking you to let them go, as-is and agree to her request.</p>");
			startQuestions();
			addLinkToPlace(md, "leave the Gym", 37);
			WritePlaceFooter(md);
			return true
		}
		if (Place == 435 && sType == "bambimiagym2") {
			setPersonFlag("Bambi", 12);
			md = WritePlaceHeader(false, this.isCharmedBy() ? "" : "td-left-med");
			if (this.isCharmedBy()) this.showPerson("mia3.jpg");
			else this.showPerson("mia1.jpg");
			addPlaceTitle(md, "Bambi and Mia");
			if (this.isCharmedBy()) md.write("<p>You go with Bambi to meet Mia at the gym and they play at working out, but it more a strip-tease to arouse and entertain you. After some time they are naked and inviting you to give them a good work-out!</p>");
			else md.write("<p>Once again Bambi takes you to the gym while she works out with Mia. This time you take a change of gear so you can work out, and not just watch the two women, not that you do not watch them appreciatively.</p>");
			startQuestions();
			if (this.isCharmedBy()) {
				addLinkToPlaceC(md, '"let\'s see some team work here in the gym"', 435, "type=teamwork");
				addLinkToPlaceC(md, '"play together"', 37, "type=playtogether");
				addLinkToPlaceC(md, '"lets all play"', 37, "type=allplay")
			}
			addLinkToPlace(md, "leave the Gym", 37);
			WritePlaceFooter(md);
			return true
		}
		if (Place == 435 && sType == "charmmiagym1") {
			this.other = 1;
			md = WritePlaceHeader(false, "td-left-large");
			this.showPerson("mia2.jpg");
			addPlaceTitle(md, "Mia Under A Charm Spell");
			if (days < 7) md.write('<p>You cast the spell and you notice Bambi looks disapointed. She says "As you wish ' +
				perYou.getLord() + '"</p>');
			else md.write('<p>You cast the spell and you see Bambi smile and comment "About time ' + perYou.getLord() + '"</p>');
			md.write("<p>Mia asks \"What's that Bambi?...Did it just get hot in here?\". Bambi leans over her smiling and slides off the straps of Mia's top and says,</p>" + '<p>"We are two <b>hot</b> women" and she laughs as she looks over at you.</p>');
			startQuestions();
			addLinkToPlace(md, "you have to agree", 435, "type=charmmiagym2&time=" + getQueryParam("time"));
			WritePlaceFooter(md);
			return true
		}
		if (Place == 435 && sType == "charmmiagym2") {
			md = WritePlaceHeader();
			this.showPerson("mia3.jpg");
			addPlaceTitle(md, "Mia Under A Charm Spell");
			md.write("<p>Bambi tells Mia, \"Look there is no-one else around, let's cool off and heat " + perYou.getPersonName() + ' up"</p>' + '<p>The spell is coursing though Mia\'s body but she looks uncertain, so you say "You both look so <i>hot</i>..."</p>' + "<p>Mia needs no more encouragement and they both do a very skilled strip-tease, mostly separately, but Bambi keeps trying to assist her mother and keeping contact. You watch with pleasure, and as they finish sitting naked on one of the exercise machines you tell them,</p>" +
				'<p>"Beautifully done, I hope to see more teamwork like that in the future"</p>' + '<p>Bambi answers "Anytime ' + perYou.getLord() + '" but Mia looks reluctant and says "Well sometimes...but only...", and you interrupt,</p>');
			startQuestions();
			addLinkToPlace(md, '"When I ask, certainly"', 435, "type=charmmiagym3&time=" + getQueryParam("time"));
			WritePlaceFooter(md);
			return true
		}
		if (Place == 435 && sType == "charmmiagym3") {
			days = parseInt(getQueryParam("time"), 10);
			md = WritePlaceHeader(false, "td-left-large");
			this.showPerson("mia4.jpg");
			addPlaceTitle(md, "Mia Under A Charm Spell");
			md.write('<p>Bambi tells Mia, "Yes, anytime our ' + (perYou.isBornMale() ? "Lord" : "Lady") + ' wants us, anytime!"<p>' + '<p>The spell reinforces your words and Bambi\'s and Mia answers "Anytime you want me...us" and the mother and daughter line themselves up. Delightful asses presented for you to use as you want...and you want!</p>' + "<p>Afterwards, you ask Mia about the gem you had talked about with Bambi. Mia reaches out to her clothing, ");
			if (days < 7) md.write('and grabs a crystalline ring but it slips out of her sweaty fingers and rolls immediately under a machine. You try to get it but the machine shifts and the ring shatters into useless fragments. She shrugs, "Oh well, it was just a trinket, I doubt it was really owned by that warlock."</p>');
			else {
				if (whereItem(64) === 0) PlaceI(64);
				md.write('and picks up a crystalline ring but it slips out of her sweaty fingers. It rolls towards a machine but lodges at the edge and sits there. She comments "Oops, but it is fine. It is probably worthless, but you can have it!". It is sitting precariously, you had better pick it up.</p>')
			}
			startQuestions();
			addLinkToPlace(md, "leave the gym", 37);
			WritePlaceFooter(md);
			return true
		}
		if (Place == 435 && sType == "teamwork") {
			var b = Math.random() < .5;
			md = WritePlaceHeader(false,
				b ? "td-left-large" : "");
			this.showPerson(b ? "mia4.jpg" : "mia3.jpg");
			addPlaceTitle(md, "Mia and Bambi");
			md.write("<p>You ask Bambi and Mia to show you some teamwork and the mother daughter team do a very skilled strip-tease, mostly separately, but Bambi keeps trying to assist her mother and keeping contact. You watch with pleasure, and as they finish naked, waiting for you to join them.</p>");
			startQuestions();
			addLinkToPlace(md, "leave the gym", 37);
			WritePlaceFooter(md);
			return true
		}
		if (Place == 37 && sType == "playtogether") {
			md =
				WritePlaceHeader();
			this.showPerson("miabambi4.jpg");
			addPlaceTitle(md, "Mia and Bambi Playing");
			md.write("<p>You notice there are quite a few people around and the changing rooms are also busy. Bambi takes your hand and Mia's and leads you to a small alley that runs along-side the gym. You can easily guess what she has been doing with others out here before.</p>" + "<p>You ask them to play together, and they strip off, and as you watch they caress and play with themselves. As they do they takj about what they want or have fantasised about you doing to them singly or together!</p>");
			startQuestions();
			addLinkToPlace(md, "leave the alley", 37);
			WritePlaceFooter(md);
			return true
		}
		if (Place == 37 && sType == "allplay") {
			md = WritePlaceHeader();
			this.showPerson("miabambi5.jpg");
			addPlaceTitle(md, "Playing with Mia and Bambi");
			md.write("<p>You notice there are quite a few people around and the changing rooms are also busy. Bambi takes your hand and Mia's and leads you to a small alley that runs along-side the gym. You can easily guess what she has been doing with others out here before.</p>" + "<p>They quickly strip off and line themselves up, assess, pussies and bodies ready for you to take however you want!</p>");
			startQuestions();
			addLinkToPlace(md, "leave the alley", 37);
			WritePlaceFooter(md);
			return true
		}
		if (Place == 458 && sType == "charmmiahome1") {
			this.other = 1;
			md = WritePlaceHeader(false, "td-left-large");
			this.showPerson("mia9.jpg");
			addPlaceTitle(md, "Mia Under A Charm Spell");
			md.write('<p>Mia looks at you "If only Bambi and you were not involved..." and you cast the spell "Dai Chu Mai", and she looks at you,</p>' + '<p>"You could dump her, she has many lovers..." and you interrupt, "No, I will not dump her, but what is the problem with a complex relationship"</p>' +
				'<p>Mia moves as the arousal of the spell starts to affect her and smiles, "Well, I do not see an issue if we are discrete I suppose..."</p>' + '<p>You tell her "By all means, but why not simplify things" and she asks how. You answer,</p>');
			startQuestions();
			addLinkToPlaceC(md, '"Simple as ' + perYou.getMaster() + ' and slave"', 458, "type=charmmiahome2");
			WritePlaceFooter(md);
			return true
		}
		if (Place == 458 && sType == "charmmiahome2") {
			days = parseInt(getQueryParam("time"), 10);
			md = WritePlaceHeader();
			this.showPerson("mia10.jpg");
			addPlaceTitle(md, "Mia Under A Charm Spell");
			md.write('<p>She answers, "Well I have played with Domination/Submission but not really my thing" and you tell her</p>' + '<p>"As you say it is just a game, I would be your strong ' + perYou.getMaster() + ' and you my beautiful slave?", and she shakes her head,</p>' + '<p>"Well the occasional game can be fun..." and she sits up as she starts to strip off more of her lingerie. You tell her "Bambi enjoys the game as well, she always calls me ' + perYou.getLord() + ' and considers herself my slave!"</p>' +
				'<p>She says, "I would of thought Bambi would enjoy being a Domme than a Sub" and you tell her,</p>');
			startQuestions();
			addLinkToPlaceC(md, '"Bambi loves both"', 458, "type=charmmiahome3");
			WritePlaceFooter(md);
			return true
		}
		if (Place == 458 && sType == "charmmiahome3") {
			md = WritePlaceHeader();
			this.showPerson("mia11.jpg");
			addPlaceTitle(md, "Mia Under A Charm Spell");
			md.write('<p>Mia removes the rest of her clothing and simply says "' + perYou.getMaster() + '"</p>' + "<p>You embrace her and claim her body, she may not be quite your slave in name, but the spell has made her so in all other ways.</p>" +
				'<p>After you talk about Bambi and playing with both your slave girls. Mia seems reluctant for a moment, but answers, "It can be good to play new games ' + perYou.getPersonName() + "..." + perYou.getMaster() + '...sometimes"</p>' + '<p>You ask Mia about the gem you had talked about with Bambi. Mia reaches out to her side table, and picks up a crystalline ring and puts it on the bed between you. She comments "It is probably worthless, but you can have it!"</p>');
			if (whereItem(64) === 0) PlaceI(64);
			startQuestions();
			addLinkToPlace(md, "talk more to Mia", 458);
			WritePlaceFooter(md);
			return true
		}
		if (Place == 458 && sType == "miasex") {
			md = WritePlaceHeader(false, "td-left-large");
			this.showPersonArray(["miasex1.jpg", "miasex2.jpg", "miasex3.jpg"]);
			addPlaceTitle(md, "Mia");
			md.write("<p>You enjoy your slaves' body.</p>");
			startQuestions();
			addLinkToPlace(md, "talk more to Mia", 458);
			WritePlaceFooter(md);
			return true
		}
		if (Place != 124) return false;
		if (sType == "spilldrink") {
			this.other = 1;
			md = WritePlaceHeader();
			this.showPerson("mia5.jpg");
			addPlaceTitle(md,
				"Mia in the Shower");
			md.write("<p>You pick up the drink and 'accidentally' drop it so most of it spills on Mia's dress. You apologise and she tells you mostly in jest, \"Clumsy little " + (isBritish() ? "bugger" : "bastard") + "! I will have to go and change, and probably have a quick shower.\". You suggest Bambi's room as a place to go and she agrees.</p>" + "<p>She leaves the bar after giving you a smile, you wait a couple of minutes and cautiously follow her to Bambi's room.</p>" + "<p>When you enter you hear the distinct sound of the shower running. You look in and you can see Mia through the frosted glass quickly showering. You feel a bit like some pervert peeking at a woman in the shower...</p>");
			startQuestions();
			addLinkToPlace(md, "leave her showering and return to the bar", 124, "", "You leave her and return to the bar. Not long after Mia returns to her place behind the bar.");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "charmmiashower1") {
			md = WritePlaceHeader();
			this.showPerson("mia6.jpg");
			addPlaceTitle(md, "Mia Under A Charm Spell");
			md.write("<p>You recite the spell, and it is unlikely Mia heard it over the sound of the shower. You call out for her and slide the door of the shower open and see she is just applying some body lotion. You ask her if it feels good,</p>" +
				'<p>"Yes, very, very nice ' + perYou.getPersonName() + '", she does not seem to care you are there. You are unsure if this is the spell or just her uninhibited nature. You try to exert some influence to guide the spell a little, and <i>tell</i> her to massage it into her breasts for <b>you</b>.</p>' + "<p>Without looking at you she works the lotion onto her breasts, massaging sensually, and you see her nipples become hard as her arousal quickly builds. She sighs, and says softly,</p>" + '<p>"I know Bambi will not care, but it is usually against my rules to get involved with her lovers..." and you interrupt her,</p>' +
				'<p>"Rules are to be broken, we should be free to do whatever we want!". You are building on her nature and the spell to bind her to you. She looks at you,</p>' + '<p>"It\'s not a hard and fast rule, more a general guide I suppose".</p>');
			startQuestions("You tell her");
			addLinkToPlaceC(md, '"Let\'s break some rules"', 124, "type=charmmiashower2&time=" + getQueryParam("time"));
			WritePlaceFooter(md);
			return true
		}
		if (sType == "charmmiashower2") {
			days = parseInt(getQueryParam("time"), 10);
			md = WritePlaceHeader();
			this.showPerson("mia7.jpg");
			addPlaceTitle(md, "Mia Under A Charm Spell");
			md.write("<p>You remove your clothing and join Mia in the shower, you embrace her slick body and kiss her. After the kiss she starts caressing you and whispers to you,</p>" + '<p>"While you have the daughter sometimes and the mother now, you are not going to get anything mother/daughter, that is a..." and you quickly interrupt her, you are the one shaping her mind now,</p>' + '<p>"Rule you will not break? I told you rules are meant to be broken, I know Bambi wants you, and she has suggested it in the past, hasn\'t she? She is sexy and so are you.". You see her eyes glow a little, and feel her nipples stiffen against your ' +
				(perYou.isBornMale() ? "chest" : "breasts") + ". She sighs,</p>" + '<p>"Well, maybe a threesome now and then would not be so bad...", and you have to agree, not bad at all! You kiss her again ');
			if (perYou.isMaleSex()) md.write("and feel her hand on your cock. Time for talk has passed, you lift up one of her legs and thrust your cock into her hot, wet pussy. She gasps as you fuck her to an intense and mutual climax.");
			else md.write("and feel her fingers sliding along your folds and into your pussy. Time for talk has passed, and you rub, slide, kiss and lick each other to intense, mutual orgasms.");
			md.write("</p><p>Afterwards, you ask Mia about the gem you had talked about with Bambi. Mia reaches out to her clothing, ");
			if (days < 7) md.write('and grabs a crystalline ring but it slips out of her wet fingers and rolls immediately into the drain! Maybe a plumber could recover it, but you doubt it. She shrugs, "Oh well, it was just a trinket, I doubt it was really owned by that warlock."</p>');
			else {
				if (whereItem(64) === 0) PlaceI(64);
				md.write('and picks up a crystalline ring but it slips out of her wet fingers. It rolls towards the drain but lodges at the edge and sits there. She comments "Oops, but it is fine. It is probably worthless, but you can have it!". It is sitting precariously, you had better pick it up.</p>')
			}
			md.write('<p>As you start redressing you notice Mia is starting to put on some high boots first, and you ask her why, "They look good on me, and I wanted to show off to you, after all I have to compete with Bambi now!"</p>');
			startQuestions();
			addLinkToPlace(md, "return to the bar", 124, "", "", "", "if (whereItem(64) == 124) moveItem(64,0);");
			WritePlaceFooter(md);
			return true
		}
		return false
	};
	per.addPlaceImageLeft = function(lit) {
		if (Place == 458 && this.isHere() && sType === "") {
			if (this.isCharmedBy()) return this.showPerson("miasex3.jpg", "", "", "", "", false, "string");
			return this.showPerson("mia8.jpg", "", "", "", "", false, "string")
		}
		return ""
	};
	per.showPersonChat = function(bGeneral, md) {
		if (sType !== "" || !this.isHere()) return;
		if (Place == 124)
			if (!this.isCharmedBy("You")) {
				if (this.other ===
					0)
					if (!this.checkFlag(1)) addQuestionC(md, 'tell Mia "I\'d like a scotch on the rocks, please."', "Mia", 10801);
					else addLinkToPlaceC(md, 'tell Mia "I\'d like a scotch on the rocks, please." and spill it on her dress', 124, "type=spilldrink");
				return
			} else;
		else if (Place == 458)
			if (this.isCharmedBy()) {
				addLinkToPlaceC(md, '"I want you"', 458, "type=miasex");
				addSleepLink(md, "spend the day with Mia", "", "<p style='position:absolute;top:62%;left:2%;cursor:pointer;margin-top:-12px;font-size:x-large'><b>Going to Bed with Mia</b></p>" +
					'<p style="position:absolute;left:2%;top:65%;cursor:pointer;font-size:1.1em;width:50%">You spend the day in the arms of Mia', "mia9.jpg")
			}
	};
	per.showPersonTextHere = function(md) {
		if (Place == 124 && this.isHere()) md.write("<p>At this time of the day there are only a few patrons at the bar. Mia welcomes you and asks what you would like.</p><p>");
		else if (Place == 458 && this.isHere())
			if (this.isCharmedBy()) md.write("<p>Your MILF slave Mia welcomes you to her apartment, and offers you anything you wish, a drink, her, anything.</p>");
			else md.write("<p>Mia welcomes you to her apartment, She is dressed in her nightie, though it looks more like lingerie. After all she works nights so generally sleeps in the day.</p>")
	};
	per.handleItem = function(no, cmd) {
		if (no == 32 && cmd == 1) {
			if (this.isHere() && this.isCharmedBy()) return examineSilverRingReacts("Mia")
		} else if (no == 14 && cmd == 2) {
			var dc = Math.floor((nTime - this.charmedTime) / 288);
			if (Place == 124 && this.isHere()) {
				if (sType == "spilldrink") {
					CastCharmSpell("Mia", 124, 1, "type=charmmiashower1&time=" + dc);
					return "handled"
				}
				if (!isSpellKnown("Shielded Charm")) return "public";
				if (!this.isCharmedBy()) addComments("You try to cast the spell, and for a moment it seems to affect Mia, but then someone calls out for a drink and she seems to just shake the effect and goes to serve them.</p><p>You do not think she is protected as such but it may be a combination of a strong will and that she is easily distracted. You will have to try somewhere else where you can get her on her own.");
				else addComments("You have already <i>Charmed</i> Mia.");
				return "handled"
			} else if (Place == 435 && (this.isHere() ||
					sType == "bambimiagym1")) {
				if (!isSpellKnown("Shielded Charm")) return "public";
				CastCharmSpell("Mia", 435, 1, "type=charmmiagym1&time=" + dc);
				return "handled"
			} else if (Place == 458 && this.isHere()) {
				CastCharmSpell("Mia", 458, 1, "type=charmmiahome1");
				return "handled"
			}
		}
		return ""
	};
	per.isPhoneable = function() {
		return checkPlaceFlag("Hotel", 11) && Place == 269 && this.isCharmedBy()
	};
	per.callThem = function() {
		if (Place == 269) {
			receiveCall("", 'You call Mia to invite her to join you at the pool for a swim, and she answers, "Love to!". A couple of minutes later she joins you..');
			gotoPlace(Place, "type=miapool");
			WriteCommentsFooter(bChat, bChatLeft)
		}
	};
	per.addPersonPhoneCall = function() {
		if (!this.checkFlag(3) && this.checkFlag(6) && !this.isHere() && !isDay())
			if (makeCall(true, 88)) this.setFlag(3);
		if (!this.checkFlag(4) && this.isCharmedBy() && !this.isHere())
			if (makeCall(true, 89)) {
				this.setFlag(4);
				setPlaceKnown("MiasApartment")
			}
		return false
	};
	per.getPersonSMS = function(id) {
		if (id == 88) return receiveSMS("MIaLF", "Bambi said you asked about my modeling, enjoy!", "miasms1.jpg");
		if (id == 89) return receiveSMS("MIaLF",
			"I am yours anytime you want, visit me at Apartment 12, 42 Celeste Rd", "miasms2.jpg");
		return ""
	}
}

function returnMiku() {
	movePerson("Miku", 408)
}

function initialiseMiku() {
	addPerson("Miku");
	per.isPersonInfo = function() {
		return this.other < 0
	};
	per.getPersonInfo = function() {
		if (this.other == -100) return "<img src='Images/mikucat4.jpg' class='imgpopup' alt='Miku'>" + "<p>Miku has settled in nicely into both your home and her new role as your familiar, though you are not exactly clear on the details of the later, yet.</p>" + "<p>The exact nature of her new abilities is still uncertain, but seems to be largely based on modifying spells you are able to use. For now, Miku is able to transform into a cat at will and often uses this ability to roam around at night and spy on the neighborhood for you. She is able to assume a fully human form as well, but prefers to stay as a human/cat hybrid when inside the house, and on occasion will display distinctively catlike behavior and instincts.</p>" +
			"<p>Miku has become deadly loyal to you, but still retains most of her free will. She can and will refuse orders if she doesn't feel like it, which is often the case, still won't speak about her time before moving to Glenvale, and still needs a lot of pushing to help with chores around the house, though it is getting better. She gets along well with Mom, Tracy and the other girls, but everyone under a charm-spell is prone to at one point become her plaything for a while.";
		return "<img src='Images/miku7.jpg' class='imgpopup' alt='Miku'>" +
			"Of all the curious things about Miku, one probably stands out the most: How is that skinny girl able to eat so much?</p>" + "<p>To say she has a healthy appetite is an understatement, and ever since Miku moved in, you regularly have you restock the fridge in order to keep up with her raids.</p>" + "<p>On the plus side, she is a decent cook and does help out around the house, albeit reluctantly and not nearly as much as you would like.</p>" + "<p>Miku spends most of her time, when not at school, either studying in her room or on the internet, apparently doing research and arguing on witchcraft message boards.</p>" +
			"<p>You have come to know her a little better, but she keeps quiet about her family or life before making the move to Glenvale, and while you found her usually polite and restrained demeanor to not be entirely for show, Miku has a rather filthy mouth and can be very outspoken about her sexuality and opinions when she does not deem it to be a necessity to hold back, like most of the times when she is alone with you."
	};
	per.getPossessionFace = function() {
		return this.other == -100 ? "miku-facecat" : "miku-face"
	};
	per.whereNow = function() {
		var hr = getHour();
		if (this.checkFlag(33) && (hr > 5 && hr < 9 || hr > 11 && hr < 16)) return 45;
		return this.place
	};
	per.passTimeDay = function() {
		if (this.place === 0) {
			if (isCharmedBy("Abby")) this.place = 394
		} else {
			findPerson("Ghost");
			if (this.place == 408 && per.place == 408) this.setFlag(30);
			this.setFlag(34, false);
			this.setFlag(35, false)
		}
		return ""
	};
	per.isPlaceImageRight = function() {
		return Place == 394 && this.place == 394 || Place == 45 && this.isHere() && sType === ""
	};
	per.showPlaceImageRight = function(md) {
		if (Place == 394) this.showPerson("miku2.jpg");
		else if (Place == 45)
			if (getHour() < 12) this.showPerson("mikuface-kitchen1.jpg");
			else this.showPerson("mikuface-kitchen1.jpg")
	};
	per.addPlaceImageLeft = function(lit) {
		if (Place == 408 && this.isHere() && sType === "") {
			if (this.isCharmedBy()) return this.showPersonString("mikucat5.jpg");
			if (this.other == -1) return this.showPersonString("miku9.jpg");
			return this.showPersonString("miku8.jpg")
		}
		return ""
	};
	per.showPersonTextHere = function(md) {
		if (Place == 408 && this.isHere())
			if (this.other == -100) md.write("<p>Your familiar, Miku, turns around and greets you with a polite bow. \u201cHello, " +
				perYou.getPersonName() + " Do you need my assistance with anything?\u201d</p>");
			else if (this.other != -1) md.write("<p>Miku made sure to look as innocent as she can with her cute smile and pigtails, but you have really learned to be on your guard around her.</p>");
		else md.write("<p>Miku stops what she was doing and greets you with a well executed curtsy when you enter the guestroom. \u201cHello, " + perYou.getPersonName() + " Any progress in your research?\u201d</p>");
		else if (Place == 45 && this.isHere()) md.write("<p>Miku is preparing some food and waves to you as you enter the room.</p>")
	};
	per.showEventPopup = function() {
		if (sType == "mikunightevent1") {
			this.setFlag(23);
			showPopupWindow("Restless Night...", "<img src='Images/miku18.jpg' class='imgpopup' alt='Tracy'>" + "You wake up in the middle of the night to get a glass of water and hear suspicious noises from the attic.</p>" + "<p>You open the door just a little and see Miku on her bed with a rather thick vibrator spreading her folds. She doesn't seem to notice you, or pretends not to, and you watch her for a few minutes as she pleasures herself with the toy before deciding to not stretch your luck and heading back to bed.",
				"sleepForNight()");
			setQueryParams("");
			return true
		}
		if (sType !== "") return false;
		if (Place == 394 && this.place == 394 && !this.checkFlag(1)) {
			this.setFlag(1);
			showPopupWindow("Abby and Miku", "<img src='Images/miku1.jpg' class='imgpopup' alt='Miku'>" + "You are surprised to find that Abby already has a visitor when you arrive at her desk, and you easily recognize the girl as Miku Nakamoto-Richards, another Senior-Year student at Glenvale Grammar.</p>" + "<p>In the year since she had transferred to the school, Miku has often been the subject of gossip and rumors among many of the other students, especially Catherine and Amy.</p>" +
				"<p>She's a smart girl, polite and liked by most teachers, but pretty much a loner and known to be a little eccentric. Right now, she is wearing her very own school uniform, one of several she owns with some of them bordering on fetish cosplay.</p>" + "<p>She is said to have asked questions in biology class that made even Ms Logan blush with a completely innocent expression, and once nearly broke a students nose for telling her she's \u201cSo kawaii!\u201d and calling her \u201cMiku-chan\u201d.</p>" +
				"<p>There are a lot of rumors floating around, especially regarding her sexuality, but there is little people actually know about her, and Miku seems to like it that way.</p>" + "<p>Still, one thing that is undeniable is that she is really cute, and you wonder just how many of the more scandalous rumors are true, or could be made true.");
			return true
		}
		if (Place == 408 && this.place == 408) {
			if (!this.checkFlag(6)) {
				this.setFlag(6);
				this.charmedTime = nTime;
				showPopupWindow("Miku in the Attic", "<img src='Images/miku7.jpg' class='imgpopup' alt='Miku'>" +
					"<p>As you enter the guestroom, you find none other than Miku, standing in front of a mirror in a new uniform, which just happens to be short enough to flash her panties to you as she bends forward to supposedly do her make-up.</p>" + "<p>She pretends to not notice you for a few seconds before you cough to get her attention and she turns around to face you.</p>" + "<p>\u201cAh, finally home I see.\u201d She performs an elaborate curtsy with probably one of the sweetest smiles you have ever seen. \u201cI was wondering if you would show up at all, it looked like you were ready to fuck Abby for days straight when I left.\u201d</p>");
				return true
			}
			if (!this.checkFlag(25) && this.checkFlag(24)) {
				this.setFlag(25);
				showPopupWindow("Miku Looks Worried", "<img src='Images/miku19.jpg' class='imgpopup' alt='Miku'>" + "<p>Miku looks tense as you enter the room, to put it mildly, her eyes immediately focusing on you. \u201cThat... thing is gone, is it?\u201d</p>" + "<p>You assure her that Legion is gone and you stroke a truce of sorts with it, and it seems to put her somewhat at ease.</p>" + "<p>\u201cI have never felt anything so powerful and... evil.\u201d She paces through the room. \u201cYou need to find a way to deal with it... not just shoo it away, but deal with it for good.\u201d</p>");
				return true
			}
			if (!this.checkFlag(29) && this.checkFlag(30) && wherePerson("Ghost") == 408) {
				this.setFlag(29);
				this.setFlag(30, false);
				showPopupWindow("Miku and Keana", "<img src='Images/miku19.jpg' class='imgpopup' alt='Miku'>" + "<p>Miku is carefully observing Keana's ghostly shape as you enter the room and only slowly turns her attention to you.</p>" + "<p>\u201cShe is not very talkative, but from what I have gathered she is yours... sort of?\u201d</p>" + "<p>You give Miku a short summary about Keana, her haunting of the hospital, how you bound her and why you decided to relocate her to your home. Miku listens with a mixture of astonishment and disbelieve to your tale, and finally throws her arms up in defeat.</p>" +
					"<p>\u201cFine... If she has to pick this room to haunt then so be it. It is not like she will take up space and this is not even one of the stranger things happening right now.\u201d She folds her arms with a smirk. \u201cBut you really do fuck everything that moans, right?\u201d</p>");
				return true
			}
			if (!this.checkFlag(31) && this.checkFlag(29) && this.checkFlag(30) && wherePerson("Ghost") == 408 && this.other == -100) {
				this.setFlag(31);
				showPopupWindow("Your Familiar and the Ghost", "<img src='Images/mikucat4.jpg' class='imgpopup' alt='Miku'>" +
					"<p>The room feels...different when you enter, almost charged with a strange, supernatural presence while faint, sensual moans seem to reecho from every corner.</p>" + "<p>Keana's body is spread out on the bed and her face a grimace of lust and ecstasy while Miku has both hands stretched out and seems lost in deep focus. You try to speak to her, but she interrupts you with a harsh gesture, telling you to be quiet and watch.</p>" + "<p>Miku circles her fore- and middle fingers and you watch as Keana's body seems to be taken by an intense wave of pleasure, her lips spreading in a silent moan which echoes through the entire room a second later, and Miku, seemingly pleased with the effect, begins to let her hand vibrate slightly.</p>" +
					"<p>You observe Keana's ethereal body twitching on the sheets, her fingers clawing into the fabric, pulling it to her for a second only to lose focus and have them phase through again when another wave hits her.</p>" + "<p>Miku grins proudly and Keana's body jerks into an arch the moment her two fingers point upwards. She holds her second hand out with her palm up and allows it to tremble slightly, the motion directly affecting the ghostly woman, sending blissful shivers through her entire body which seem to rise in intensity with every second until she erupts into a climax powerful enough for even you to feel it.</p>" +
					"<p>Keana looks like she is heavily gasping for air, probably more of a reflex, but slowly calming down after Miku lowered her arms.</p>" + "<p>After a few seconds of resting, she floats towards Miku and presses a kiss to her lips, giving you a wink before phasing out to rest.</p>");
				return true
			}
			if (!this.checkFlag(26) && isPersonHere("Vampyre") && this.other == -100) {
				this.setFlag(26);
				showPopupWindow("Your Familiar and the Vampyre", "<img src='Images/vampbg.png' class='imgpopup' alt='Vampyre'>" + "<p>Miku tenses up the moment you and Lilith enter the attic, and you see her immediately bare her fangs towards the Vampyre with a loud hiss for about a second before she realizes what she just did and covers her lips with one hand.</p>" +
					"<p>\u201cYou have a malkblood as a pet?\u201d Lilith asks with contempt in her voice. \u201cThey are not to be trusted, " + perYou.getMaster() + ". You should put it in a bag and drown it in the nearest pond.\u201d</p>" + "<p>\u201cI am not to be trusted?!?\u201d The comment seems to rile Miku up only more and she seems ready to pounce Lilith, but focuses on you instead. \u201cThis creature smells of death, she will betray you first chance she gets.\u201d</p>" + "<p>\u201cI have been nothing but honest about my intentions to my beloved " +
					perYou.getMaster() + ", and still, " + perYou.getHeShe() + " seems to believe that I will make an exceptional servant.\u201dLilith smirks.\u201d Maybe you are just worried that I will make you obsolete.\u201d</p>" + "<p>You interrupt the pair before things have any chance of escalating and reaffirm your trust in Miku towards Lilith, as well as ordering her to treat your familiar with the respect she deserves, to which the vampyre reluctantly agrees.</p>" + "<p>It looks like not even the charm-spell will make these two get along anytime soon, though.</p>");
				return true
			}
		}
		if (Place == 45 && this.isCharmedBy() && (wherePerson("Mom") != 154 || isCharmedBy("Mom")) && (getHour() > 11 && getHour() < 16) && !this.checkFlag(33) && (wherePerson("Tracy") == 45 || wherePerson("Tracy") == 156)) {
			this.setFlag(33);
			findPerson("Tracy");
			var s = "<img src='Images/mikulunch2.jpg' class='imgpopup' alt='Miku'>" + "Something is rustling behind the kitchen-counter when you enter the room, and Tracy greets you with a light smirk on her lips.</p>" + "<p>\u201cHey little " + per.getYourNameFor() + ", we're preparing lunch, care to help us?\u201d</p>" +
				"<p>You look over the counter and see Miku in front of the fridge, on all fours, naked, and with a huge cucumber suggestively held in her mouth as she waves up to you.</p>" + "<p>Your eyes move to Tracy, and probably sensing what you intent to ask, she goes ahead.</p><p>";
			if (per.isCharmedBy("You")) s += "\u201cShe's quite cute, lil' " + per.getYourNameFor() + ",\u201d She winks to you. \u201cI'll have to work harder if I want to compete with her for your affection.\u201d";
			else s += "\u201cI don't mind, Mom might, but she is out of the house and the more girls willing to tease you, the better.\u201d";
			s += "There is a chuckle from the fridge, and Miku rises to her feet. \u201cI figured you would like a change in dress-code, now that you have the run of the house.\u201d She walks up to you, and whispers to your ear. \u201cI'll hide the ears down here, just in case, they are harder to explain to possible strangers than a bunch of naked girls.\u201d";
			showPopupWindow("Lunchtime!", s);
			return true
		}
		return false
	};
	per.showEvent = function() {
		if (sType === "") return false;
		var md, perAbby;
		if (Place == 394 && sType == "charmmiku1") {
			md =
				WritePlaceHeader();
			this.unCharmThem();
			this.showPerson("miku2.jpg");
			addPlaceTitle(md, "Miku Under a Spell?");
			md.write("<p>\u201cDai Chu, Miku!\u201d You silently whisper the incantation and guide your mana into Miku's body in well practiced motions, though surprisingly, she doesn't react much at first, just looking around briefly as if she heard a faint noise.</p>" + "<p>You decide to observe for now. Miku's attention remains focused on Abby, but something seems to bother her after a while, and you watch as she curiously drives her fingers through her hair, down her neck and over her chest with a sensual gasp.</p>" +
				"<p>\u201cAre you alright Miku?\u201d Abby finally realizes that Miku has stopped paying attention to her and began to meticulously touch her own body, only stopping to answer her friends question.</p>" + "<p>\u201cYes. I am just... feeling a little hot...\u201d</p>" + "<p>\u201cOhhh, that's how I felt the day I met " + perYou.getPersonName() + "!\u201d Abby beams. \u201c" + (perYou.isBornMale() ? "He" : "She") + " came in and murmured something and suddenly I felt really good and really wanted to assist " + perYou.getHimHer() +
				" with -everything- and it was a good thing, too, because up until then I was in a kinda grumpy mood because on the way to work there was this jerk with the green umbrella and he actually...\u201d</p>" + "<p>Miku interrupts her by suddenly taking a step forward and pressing two fingers to Abby's lips. \u201cIt is alright, I just need to... sit down for a moment and try... something.\u201d She looks at you. \u201cYou are " + perYou.getPersonName() + ", right? Would you mind if I open my top a little?\u201d</p>");
			startQuestions();
			addLinkToPlaceC(md, "you don't mind that at all", 394, "type=charmmiku2");
			WritePlaceFooter(md);
			return true
		} else if (Place == 394 && sType == "charmmiku2") {
			md = WritePlaceHeader();
			this.showPerson("miku3.jpg");
			addPlaceTitle(md, "Miku Under a Spell");
			md.write("<p>\u201cThank you.\u201d Miku gives you a radiant smile as she opens the top of her uniform, allows herself to fall onto a nearby couch and, without a second of hesitation, takes off her panties.</p>" + "<p>You watch her with a grin as her eyes close and she wordlessly begins to finger herself, for once leaving Abby completely speechless.</p>" +
				"<p>\u201cThis is no good...\u201d Miku exhales with a frustrated gasp, one hand still in-between her legs while the other begins to rummage through her pocket.\u201d Where did, I... here it is!\u201d</p>");
			startQuestions();
			addLinkToPlaceC(md, "leave her alone for now and watch the show", 394, "type=charmmiku3");
			WritePlaceFooter(md);
			return true
		} else if (Place == 394 && sType == "charmmiku3") {
			md = WritePlaceHeader();
			this.showPersonRorX("miku4.jpg");
			addPlaceTitle(md, "Miku Under a Spell");
			md.write("<p>Miku actually carries a small vibrator in her pocket, so it looks like at least some rumors aren't completely unfounded. At least under the spell, she has no hesitation to spread her legs for you and Abby and press the little pink toy to her clit. \u201cThis is better....\u201d</p>" +
				"<p>The two of you watch in silent fascination as Miku pleasures herself, her body sinking deeper into the couch with a series of cute moans while she circles the vibrator over her clit and slides it past her folds.</p>" + "<p>She is twitching with every little motion her hand makes while shamelessly putting on a show for you, her breathing slowly increasing in pace as she sensually winds herself on the couch and her motions grow faster, more erratic. You could almost swear she is not doing something like this for someone else for the first time.</p>" +
				"<p>\u201c" + perYou.getPersonName() + "...\u201d She suddenly calls out to you in a lust filled voice without opening her eyes. \u201cPlease help me cum... I need you... please...\u201d</p>");
			startQuestions();
			addLinkToPlaceC(md, "help her", 394, "type=charmmiku4");
			WritePlaceFooter(md);
			return true
		} else if (Place == 394 && sType == "charmmiku4") {
			md = WritePlaceHeader(false, "td-left-large");
			this.showPersonRorX("miku5.jpg");
			addPlaceTitle(md, "Miku Under a Spell");
			md.write("<p>No one should say you are not one to help a maiden in distress, and after she begged so nicely it would be cruel to not help her finish.</p>" +
				"<p>Miku eagerly presents her pussy to you as you approach and you gladly push your fingers into her wet mound, twisting them a little and finally pushing in and out with rough, rapid motions.</p>" + "<p>\u201cYes... just like.... ahhhhhhh!\u201d Miku almost screams in pure bliss from your touch, both of her hands clawing into the couch while her entire body convulses from her climax, and as she finally opens her eyes you have a few seconds to recognize the... green glow of the spell... right before you feel the spell infused mana rushing into your hand and back into your body...</p>");
			AddMana(10);
			startQuestions();
			addLinkToPlaceC(md, '"Wait, what?"', 394, "type=charmmiku5");
			WritePlaceFooter(md);
			return true
		} else if (Place == 394 && sType == "charmmiku5") {
			md = WritePlaceHeader();
			this.showPersonRorX("miku6.jpg");
			addPlaceTitle(md, "Miku Under a Spell");
			md.write("<p>It's too late to react now, the sudden rush of arousal hits you like a train and for a moment, you share some of Miku's climax. You feel your senses blur as a pleasant shiver spreads from your arm through your entire body, sending little electric shocks straight into your mind and muddling your thoughts.</p>" +
				"<p>You briefly notice Miku walking away from you with a sly grin, while Abby does her best to keep you from falling over.</p>" + "<p>You also notice that Abby's closeness is very enticing. Her smell, her warmth, her wonderful naked body close to yours... you know you can take her whenever you want, and you want her now...!</p>");
			this.moveThem(408);
			startQuestions();
			startAlternatives(md);
			addLinkToPlaceC(md, "give in and fuck Abby right where she stands", 394, "type=charmmiku6a");
			addLinkToPlaceC(md, "try to fight the urge",
				394, "type=charmmiku6b");
			endAlternatives(md);
			WritePlaceFooter(md);
			return true
		} else if (Place == 394 && sType == "charmmiku6a") {
			md = WritePlaceHeader(false, perYou.isMaleSex() ? "" : "td-left-large");
			perAbby = findPerson("Abby");
			perAbby.showPerson(perYou.isMaleSex() ? "abby13.jpg" : "abby14.jpg");
			addPlaceTitle(md, "Give In");
			md.write("<p>You throw Abby onto the couch, nearly tear off your clothes and, simply put, fuck her.</p>" + "<p>You never wanted someone like this... needed someone like this! Abby is grinding her hip against yours as much as you allow her to while you pin her head down and roughly " +
				(perYou.isMaleSex() ? "push your cock in and out of her pussy" : "grind your pussy against her lips") + ". Carnal lust and desire take over your mind with every motion, and despite the fact that you couldn't care less for her pleasure, her body reacts beautifully to your assault, screaming, moaning, clawing into the couch each time an orgasm wrecks through her and always ready for another round.</p>" + "<p>When your mind finally begins to clear, you look and feel like you just had one of the most intense physical workouts ever, but the memory of what exactly happened is weirdly blurry.</p>" +
				"<p>You are not sure if or how long Miku had been watching the two of you, but by now, she is clearly gone, and you are left confused about what she did.</p>");
			startQuestions();
			WritePlaceFooter(md);
			return true
		} else if (Place == 394 && sType == "charmmiku6b") {
			md = WritePlaceHeader();
			this.setFlag(3);
			perAbby = findPerson("Abby");
			perAbby.showPerson("abby12.jpg");
			addPlaceTitle(md, "Resisting");
			md.write("<p>You push Abby away and try to fight your rising desire, maybe control it, but it takes every ounce of will to not just grab her right where she stands and fuck her silly.</p>" +
				"<p>Your body feels like it is kept in a perpetual pre-climax, muscles twitching, heart racing, your mind filling with images of tits, cocks and pussies.</p>" + "<p>Part of you just wants to give in to these urges, and you are not sure what allows you to power through it, but whether it is the fear of loosing control or a desire to not give in to whatever that little minx did to you, you manage to clear your mind after... you are not sure how long.</p>" + "<p>Abby is looking at you with visible concern and only relaxes a little after you assure her you are alright, and Miku is, of course, nowhere to be seen.</p>");
			startQuestions();
			WritePlaceFooter(md);
			return true
		} else if (Place == 192 && sType == "asksarahmiku") {
			md = WritePlaceHeader();
			findPerson("Lauren").showPerson("lauren12.jpg");
			addPlaceTitle(md, "Asking Sarah about Miku");
			md.write("<p>\u201cA girl who might be distantly related to outsiders? An intriguing concept, is it not?\u201d She looks to Lauren, who nods demurely.</p>" + "<p>\u201cWell, our Family holds extensive records about the spellcasters we have met in our fights against Kurndorfs followers and other dangers, as well as any special skills they might posses...\u201d She thoughtfully pulls in her lower lip, then turns to Lauren.</p>" +
				"<p>\u201cLauren, I believe the books we need are on the topmost shelf, gather them for us!\u201c</p>" + "<p>\u201cYes, my Lady...\u201d Lauren hesitantly moves towards the shelf, but not further, and nervously looks to Sarah.</p>" + "<p>\u201cLauren,\u201d Sarah says sternly. \u201dWe do not have all day, please hurry.\u201d</p>" + "<p>The maid breathes out a defeated sigh, and as she climbs the bookshelf you get a good look at the reason for her hesitation: a lack of panties offering a good look at what is under her already much to short maid outfit.</p>" +
				"<p>It takes Lauren a bit of moving around to find the book she seeks, in part thanks to Sarah's less than optimal guidance, and as she finally hands it over, her head is a deep shade of red.</p>" + "<p>\u201cThis book is written in a very old dialect, I have a rough idea what we are looking for, but it will take us some time to find it.\u201d She once again turns to Lauren. \u201cPlease, prepare some tea and a light snack for us, I am -very- interested in the girls special ancestry, and we may be here for a while.\u201d</p>" +
				"<p>For a second, you think you see Lauren shiver uneasily, but as usual she quickly does as her mistress tells her.</p>");
			startQuestions();
			addQuestionR(md, "look through the book with Sarah", "\u201cI believe this is what we are looking for.\u201dAfter what felt like an eternity trying to understand ancient texts, Sarah presents you with a page detailing the nature of \u201cfamiliars\u201d.</p>" + "<p>\u201cWitches are often said to be in league with familiars, and while assumptions what those supposedly are differed widely around the world, my ancestors note that those found in this part of the country were often feytouched humans.\u201d</p>" +
				"<p>You point out that Miku is Japanese, but Sarah makes a rather compelling point that her family has been living here for a few generations  and it is not unlikely that creatures like the Sidhe and Kami share similar origins to begin with. The familiars in the book had an immense fine control of Mana, able to use it to shift form or manipulate spells to a large degree, but were unable to generate it themselves and suspect-able to be controlled, they were pretty much bred as servants to Warlocks and Witches. However, since Miku's bloodline has been diluted over the centuries, you would have to find a way to basically \u201cTransform\u201d her body to be more like the familiars of old.</p>" +
				"<p>You thank Sarah for her help, and she assures you that it has been a pleasure for her, only asking that you inform her more about any developments with \u201cthe feytouched girl\u201d in return. ", "Sarah", "setPersonOther(\\'Miku\\',-10);setQueryParams()");
			WritePlaceFooter(md);
			return true
		}
		if (Place == 45) {
			if (sType == "tracymikulunch") {
				md = WritePlaceHeader();
				this.setFlag(34);
				var perTracy = findPerson("Tracy");
				var bLover = perTracy.getCharmedLevel() == 2;
				if (bLover) AddImage("tracylunch1.jpg");
				else AddImage(perTracy.isCharmedBy("You") ?
					"tracylunch2.jpg" : "tracylunch3.jpg");
				addPlaceTitle(md, "Lunch with Tracy and Miku");
				md.write("<p>You and Tracy help out around the kitchen by cutting vegetables, stirring the meals and preparing the dishes while Miku happily coordinates your efforts. (Meaning: she is ordering you and Tracy around and really enjoying it)</p>");
				if (bLover) md.write("<p>Miku really knows what she is doing, but the two make it hard for you to concentrate. There isn't a  single minute where Tracy won't stretch herself seductively or \u201caccidentally\u201d spill something on her breasts while Miku will crawl over the counter because it's \u201cfaster\u201d or just happen to need to squeeze her naked body against you because she \u201cneeds\u201d to reach a certain cabinet.</p>" +
					"<p>It's a wonder you get anything done, but you do, and you just happen to have some time to spare until everything is ready.</p>");
				else md.write("<p>Miku really knows what she is doing, and despite her tendency to crawl over the kitchen counter and slightly... eccentric ways to pass the time, it doesn't take long until everything just needs to cook a few minutes longer to be ready and you have some time to spare.</p>");
				startQuestions();
				addQuestionR(md, "wait for the meal to be ready and eat", "You talk to both your sister and Miku for a while as you prepare the Table and dishes before you call down the other girls and have lunch together.</p>" +
					"<p>Miku gives you a kiss to the cheek and returns to the attic afterwards.", "", "setQueryParams()");
				if (perTracy.getCharmedLevel() == 1) addLinkToPlace(md, "let Miku and Tracy have some fun", 45, "type=tracymikuafterlunch1");
				else addLinkToPlace(md, "tell the girls to bend over the counter and present their asses", 45, "type=tracymikuafterlunch2");
				if (bLover) {
					AddPeopleColumnMed(md);
					AddImage("mikulunch4.jpg")
				}
				WritePlaceFooter(md);
				return true
			}
			if (sType == "tracymikuafterlunch1") {
				md = WritePlaceHeader();
				var perTracy =
					findPerson("Tracy");
				AddImage("tracymikulunch1.jpg");
				addPlaceTitle(md, "Tracy and Miku Having Fun");
				md.write("<p>You stay near the oven to stir the pots, and after a few moments of watching you, Miku turns to face your sister.</p>" + "<p>\u201cHey Tracy,\u201d There is a mischievous gleam in her eyes. \u201cShall we have some fun while we wait?\u201d</p>" + "<p>\u201cSure, what do you have in mind?\u201d</p>" + "<p>\u201cOh, you will see.\u201d</p>" + "<p>Miku takes Tracy's hand, sits down on a chair and pulls her into her lap. \u201cIt is good that you no longer wear clothes.\u201d Her arms begin to wrap around your sisters body while she drags her fingertips over her skin. \u201cIt saves us a lot of time.\u201d</p>" +
					"<p>Tracy exhales a surprised gasp, and you are pretty sure Miku uses her Mana to stimulate her the same way she often does when she is with you and watch from the corner of your eye as Tracy's body tenses up.</p>" + "<p>\u201cW...what are you doing...\u201d Tracy gasps as Miku's hands slip between her legs and pull them apart to reveal her glistering wetness to you, her chest heaving slightly.</p>" + "<p>\u201cTesting your little " + (perYou.isBornMale() ? "brothers" : "sisters") + " resolve.\u201d Miku gives you a wink, and her fingers push over your sisters nub and right into her slit, rolling back and forth over her intimate parts and luring sweet, passionate moans from her lips.</p>" +
					"<p>Miku was not kidding when she said she is testing you, and the two are hard to ignore. Tracy seems completely lost in her pleasure, her body sensually arched back against Miku and twitching with every moan, gasp and other noise she lures out of her while your body can't help but react to the sensuous display.</p>" + "<p>You feel your " + (perYou.isMaleSex() ? (perYou.isBornMale() ? "manhood" : "girl-cock") + " pushing against your pants" : "folds dampen") + ", and In the final moments, Miku places a hand on Tracy's mouth to muffle her moans while her fingers push deeply into your sisters body in rough, rapid motions to drive her towards a powerful climax.</p>" +
					"<p>As the two finally settle down, Tracy rolls her head to the side to share a tender kiss with Miku, and you just know that you will need a cold shower after lunch...</p>");
				startQuestionsOnly();
				addLinkToPlace(md, "have a quick shower", 45);
				WritePlaceFooter(md);
				return true
			}
			if (sType == "tracymikuafterlunch2") {
				md = WritePlaceHeader();
				AddImage("tracymikulunch2.jpg");
				addPlaceTitle(md, "Tracy and Miku Afters");
				md.write("<p>For the last 30 minutes, the two have been acting as if they are in a sort of competition who of them is able to tease you better. (It may even be that way, Tracy and Miku get along well, but you know your sister can also get a little jealous, and Miku likes to needle her about it occasionally) and it's time to pay them back a little.</p>" +
					"<p>Miku and Tracy both line up on the counter, and you make sure to give both their asses a firm slap and berate them for taunting you like this, but judging from their giggling, they don't really plan on changing their behavior.</p>" + "<p>Though it's not like you actually want them to, you'd miss opportunities like this if they did.</p>" + (perYou.isMaleSex() ? "\u201cWell,\u201d You finally begin. \u201cSince you two are to blame for my hard on, one of you will help me get rid of it, and that one is...\u201d" :
						"\u201cOkay, you two kittens had your fun with me...\u201d You walk between both of them and knead their asses with both hands. \u201cAnd now it's my turn to play a little..."));
				startQuestionsOnly();
				if (perYou.isMaleSex()) {
					addLinkToPlace(md, "enjoy Miku's Ass", 45, "type=mikusass");
					addLinkToPlace(md, "enjoy Tracy's Pussy", 45, "type=tracyspussy")
				} else addLinkToPlace(md, "give both of them a good spanking", 45, "type=tracymikuspanking");
				WritePlaceFooter(md);
				return true
			}
			if (sType == "mikusass") {
				md = WritePlaceHeader();
				this.showPerson("mikulunch5.jpg");
				addPlaceTitle(md, "Miku's Ass");
				md.write("<p>\u201cMiku!\u201d You announce your decision by firmly slapping both hands on her ass, and using your thumbs to spread her buttocks.</p>" + "<p>Tracy protests at first, but you quickly calm her down by allowing her to spread the lube over your cock and promising to make it up to her another time.</p>" + "<p>Yes, you now always have a tube of lube in the kitchen, it's needed quite often.</p>" + "<p>You finally push both hands against Miku's shoulders and roughly press her body against the counter before squeezing your lubed shaft into her rear with a groan, enjoying the tightness around you while your hip begins to roll forward</p>" +
					"<p>Tracy watches in fascination as Miku's fingers cling to the edge of the counter with what can only be described as a feline growl. Her face switches between pain, lust and pleasure, and you see from the corner of your eye how Tracy's fingers move between her legs as she begins to touch herself as well.</p>" + "<p>You place an encouraging slap on your sisters ass and trail your lube covered fingertips over her warm skin towards her pucker, and soon, the two girls lustful moans drown out nearly everything else as you roughly push your cock into Miku's rear and your fingers play with your sisters pucker.</p>" +
					"<p>Tracy is the first to reach her climax, feverishly rubbing her clit while her body twitches on the counter, and shortly after, you shoot your load into Miku's ass the moment her own orgasm takes her as well.</p>" + "<p>The three of you enjoy the afterglow until lunch is finally ready, and you get to sit down and eat... well, you and Tracy sit, at least.</p>");
				startQuestionsOnly();
				addLinkToPlace(md, "lunch is over", 45);
				WritePlaceFooter(md);
				return true
			}
			if (sType == "tracyspussy") {
				md = WritePlaceHeader();
				AddImage("tracymikulunch3.jpg");
				addPlaceTitle(md, "Tracy's Pussy");
				md.write("<p>\u201cTracy!\u201d You announce your decision by slowly drawing your fingers along your sisters folds and watching her shudder under your touch.</p>" + "<p>\u201cMiku emits an audible groan, pulls her face into a disappointed pout and tells you to better give your sister a good pounding so she has something fun to watch at least.</p>" + "<p>Tracy blows her a cheeky kiss in response, and of course, you intent to not disappoint either of them.</p>" +
					"<p>Tracy spreads her legs and stretches herself as you open your pants, and her body shivers in anticipation when you begin to slowly drag the tip of your cock over her folds and clit and finally thrust into her waiting mound.</p>" + "<p>Your sister moans loudly as you bury the entire length of your shaft inside her with one swift motion, one hand pulling Miku a little closer while the other pins Tracy's neck to the counter.</p>" + "<p>You begin to roll your hip back and forth against your sisters ass and place a slap on Miku's but-cheek. Both girls clearly approve, judging from the noise, and after a few slow thrusts to warm up, you are now taking Tracy with rough, fast strokes while one of your hands has pushed deeply into Miku's warm sex.</p>" +
					"<p>The two girls fill the room with a variety of lewd noises: moaning, gasping and occasionally letting out a cute yelp when you slap their rears. You make sure to keep both their arousal at peak, and while Tracy is the first who reaches her peak, Miku and yourself are not far behind and you pull back to spread your load all over your sisters ass-cheeks as you cum.</p>" + "<p>And not a moment to soon, the clocks signals that dinner is ready, and while Miku eagerly \u201ccleans\u201d Tracy's rear with her tongue, you take your food out of the oven and call everyone in for lunch.</p>");
				startQuestionsOnly();
				addLinkToPlace(md, "lunch is over", 45);
				WritePlaceFooter(md);
				return true
			}
			if (sType == "tracymikuspanking") {
				md = WritePlaceHeader();
				AddImage("tracymikulunch2.jpg");
				addPlaceTitle(md, "A Spanking...A Spanking");
				md.write("<p>You strike both the girls asses in a swift upward motion to send them into a jiggle.</p>" + "<p>\u201cYou two are impossible, you know that?\u201d You place another, harsher strike on Miku's rear, and she moans in delight. \u201cYou know what naughty girls get?\u201d</p>" +
					"<p>Tracy gasps as you slap her rear again, though you are more careful with her than with Miku. \u201cDon't pretend you don't like it, sis....\u201d She answers in a teasing voice, and it earns her another light spanking.</p>" + "<p>\u201cNot the point.\u201d You knead their rears and finally slip your fingers into both their folds. \u201cNow be good girls for a change and let me blow of some steam.\u201d</p>" + "<p>The two of them giggle, but are soon interrupted as you focus on the mana within them to heighten their sensitivity, sending them close to their peak for a few seconds only to draw back a little and listen to their frustrated moans as you spank them once more.</p>" +
					"<p>\u201cThis is cruel...\u201d Tracy breathes out, and Miku follows up. \u201cI love it.\u201d</p>" + "<p>You chuckle softly and turn your attention back to your playthings, carefully alternating between light spankings (Heavier for Miku, she likes it a little more rough), stimulating their clits and pushing your fingers into their heat.</p>" + "<p>Soon, their screams and moans fill the kitchen, with both girls breathing heavily and holding each others hand.</p>" + "<p>With lunch almost ready, it is time to finish up.</p>");
				startQuestionsOnly();
				addLinkToPlace(md, "allow them to cum", 45, "type=tracymikuspankingcum");
				addLinkToPlace(md, "don't let them cum", 45, "type=tracymikuspankingnocum");
				WritePlaceFooter(md);
				return true
			}
			if (sType == "tracymikuspankingcum") {
				md = WritePlaceHeader();
				AddImage("tracymikulunch2.jpg");
				addPlaceTitle(md, "A Spanking...A Spanking");
				md.write("<p>You push both hands deeply into their wetness to find their most sensitive spots, and with a little jolt of mana, send them, over the edge, their bodies tensing up simultaneously as they share a powerful climax and slowly come to rest, though it takes another slap before they thank you in unison.</p>" +
					"<p>Finally, you call the other girls and get to sit down and enjoy lunch together, on pillows, obviously.</p>");
				startQuestionsOnly();
				addLinkToPlace(md, "lunch is over", 45);
				WritePlaceFooter(md);
				return true
			}
			if (sType == "tracymikuspankingnocum") {
				md = WritePlaceHeader();
				AddImage("tracymikulunch2.jpg");
				addPlaceTitle(md, "A Spanking...A Spanking");
				md.write("<p>You push the pair close to their peaks, let the sensation linger briefly and then simply withdraw and turn to the cooking pots.</p>" + "<p>Both girls seem confused at first, and after it took them a moment to gather their thoughts, Tracy is the first to speak. \u201cBut... we are not done!\u201d</p>" +
					"<p>\u201cYes we are,\u201d You smile to her. \u201cThis is a punishment, remember?\u201d There is a brief moment of awkward silence and it looks like Tracy is about to protest, but Miku suddenly bursts out laughing. \u201cYou are learning, " + perYou.getPersonName() + ". I love it when you play the strict mistress.\u201d</p>" + "<p>Tracy seems less happy with what you did, but Miku shushes her, and whatever she just whispered to your sister seems to have lightened up her mood enough to let things go...</p>" +
					"<p>Conspiracy in your own house...! You have to give them another spanking, soon, but for now it's time to sit down and enjoy lunch... on pillows.</p>");
				startQuestionsOnly();
				addLinkToPlace(md, "lunch is over", 45);
				WritePlaceFooter(md);
				return true
			}
		}
		if (Place != 408) return false;
		if (sType == "transformcat0") {
			md = WritePlaceHeader();
			this.showPerson("miku9.jpg");
			addPlaceTitle(md, "Transforming Miku");
			md.write("<p>\u201cWait, we don't know exactly what this spell will do with my body, right?\u201d You stop the incantation, and Miku grins as you admit you don't. \u201cWell, I guess that means you are in luck.\u201d</p>");
			startQuestions();
			addLinkToPlaceC(md, "Miku turns around towards the mirror", 408, "type=transformcat1");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "transformcat1") {
			md = WritePlaceHeader();
			this.showPerson("miku10.jpg");
			addPlaceTitle(md, "Transforming Miku");
			md.write("<p>\u201cI really like these clothes, and it would be a pity if something happens to them, right?\u201d You watch Miku as she leans forward and pulls her panties down, wiggles her hips and lets them slide down to her knees. \u201cYou don't mind if I strip first?\u201d</p>");
			startQuestions();
			addLinkToPlaceC(md, '"Not at all."', 408, "type=transformcat2");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "transformcat2") {
			md = WritePlaceHeader();
			this.showPerson("miku11.jpg");
			addPlaceTitle(md, "Transforming Miku");
			md.write("<p>\u201cGreat.\u201d Miku spins around and lifts her skirt up to playfully wave it from side to side.</p>");
			startQuestions();
			addLinkToPlaceC(md, '"You are not stalling, are you?"', 408, "type=transformcat3");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "transformcat3") {
			md =
				WritePlaceHeader();
			this.showPerson("miku12.jpg");
			addPlaceTitle(md, "Transforming Miku");
			md.write("<p>\u201cI wouldn't dare.\u201d Miku lets the skirt fall down and slowly begins to pull down her top.</p>");
			startQuestions();
			addLinkToPlaceC(md, "watch her", 408, "type=transformcat4");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "transformcat4") {
			md = WritePlaceHeader();
			this.showPerson("miku13.jpg");
			addPlaceTitle(md, "Transforming Miku");
			md.write("<p>\u201cBut this is my last striptease as a free woman, so shut up, and enjoy it!\u201d She laughs and pulls the rest of the uniform down, folding her arms and teasingly wiggling her chest.</p>");
			startQuestions();
			addLinkToPlaceC(md, "make a \u201cZipper over your mouth\u201d motion and enjoy the show", 408, "type=transformcat5");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "transformcat5") {
			md = WritePlaceHeader();
			this.showPerson("miku14.jpg");
			addPlaceTitle(md, "Transforming Miku");
			md.write("<p>Miku throws you a kiss and her uniform to the side while she performs a little spin to give you a good view of her body, something you have been waiting to get for a while now.</p>");
			startQuestions();
			addLinkToPlaceC(md,
				'"Looking Sexy"', 408, "type=transformcat6");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "transformcat6") {
			md = WritePlaceHeader();
			this.showPerson("miku15.jpg");
			addPlaceTitle(md, "Transforming Miku");
			md.write("<p>\u201cI know!\u201d Miku grins and lets herself fall into a nearby armchair, spreading out all limbs and stretching herself with a long, drawn out hum.</p>");
			startQuestions();
			addLinkToPlaceC(md, "compliment her", 408, "type=transformcat7");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "transformcat7") {
			md =
				WritePlaceHeader();
			this.showPerson("miku16.jpg");
			addPlaceTitle(md, "Transforming Miku");
			md.write("<p>\u201cThat was great!\u201d You tell her, and Miku implies a short bow before taking off her collar, stockings and panties, straightening herself and looking at you.</p>" + "<p>\u201cThank you, I think I am ready now, let us proceed.\u201d</p>");
			startQuestions();
			addLinkToPlaceC(md, "finish the incantation", 408, "type=transformcat8");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "transformcat8") {
			md = WritePlaceHeader();
			this.showPerson("miku17.jpg");
			addPlaceTitle(md, "Transforming Miku");
			md.write("<p>Miku closes her eyes as you once again cast the spell, and you feel the vibration of the Soul-bound crystal intensifying when you begin to draw on the power of the soul trapped within. You can feel the Mana spread through her form and begin the transformation.</p>" + "<p>\u201cThis feels... good, different to before, it... ohhhh!\u201d Miku suddenly emits a sensual moan, her head rolling back as she gasps for air.</p>" +
				"<p>You ask if she is alright, and Miku quickly nods</p>" + "<p>\u201cI didn't expect it to feel so... goooood....\u201d Miku's fingers dig into the armchair while her body violently twitches around. You watch as goosebumps form all over her skin and her pussy-lips begin to shine with moistness, the smell of sex growing stronger, assaulting your senses as you begin to see the first changes on Miku's body, her teeth turning into sharp fangs and black fur spreading out from her neck over her upper body.</p>");
			startQuestions();
			addLinkToPlaceC(md, "the soul within the Crystal reaches out to her", 408, "type=transformcat9");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "transformcat9") {
			md = WritePlaceHeader();
			AddImage("quartzglow1.jpg");
			addPlaceTitle(md, "Transforming Miku");
			md.write("<p>You do not notice it at first, but the presence within the Soul-bound Crystal grows stronger as Miku's Transformation progresses, and soon, you feel the malice emanating from it, the will to wrest control of Miku's Transformation, probably Miku herself away from you.</p>" +
				"<p>You focus all your willpower on the Crystal to suppress it while Miku winds herself on the Armchair, her body convulsing with every subtle change, gasping moaning, screaming in pleasure. The fey-blood is strengthening, and you realize you need to act now and bind her to your will before it runs out of control.</p>");
			startQuestions();
			addLinkToPlaceC(md, "focus on suppressing the influence of the crystal first", 408, "type=transformbadend");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "transformbadend") {
			md =
				WritePlaceHeader();
			this.showPerson("mikucat7.jpg");
			addPlaceTitle(md, "Overwhelmed");
			md.write("<p>You focus all your energy into fighting the influence of the trapped soul, but you are unable to keep it from growing stronger and slowly tear control of the transformation and possibly Miku's mind away from you. Worse, you feel your mana draining and realize too late that Miku is actively drawing it from you now to further strengthen herself.</p>" + "<p>You make a last attempt to interrupt the spell, but it is no good, the last of your mana leaves your body and you feel a wave of satisfaction emit from the bound soul as a flash of light blinds you and the spell comes to an end.</p>" +
				"<p>As your vision clears, Miku looks different, her posture, her expression, her very aura has changed, and as she speaks, her voice has an unpleasant rasp to it.</p>" + "<p>\u201cYou did not bind me, and the one you thought to have imprisoned overpowered your will...\u201d She says matter of factly, her eyes focused on you like a cat seizing up its prey as she approaches you with a weirdly sensual sway of her hip.</p>" + "<p>You try to back away from her, but your mind is taken by a near supernatural fear freezing you in place, and with a single, swift motion, she is suddenly right in front of you.</p>" +
				"<p>\u201cHave no fear.\u201d She whispers, and as her lips move close to yours you feel small strands of mana leashing out at your skin. \u201cI may no longer feel the desire to serve you, but I still like you, and I want you to be my " + perYou.getWitch() + ".\u201d</p>" + "<p>You are unable to reply before her lips touch yours and your thoughts are drowned in a wave of pleasure. Soon, you return the kiss, carefully at first, but it does not take long until you eagerly dance with her tongue while your body melts into her embrace.</p>" +
				"<p>You notice how your thoughts are fading, your mind, no your very soul being consumed by your desires, but as she pushes you into the armchair and straddles you, you no longer care. Your arms wrap around the girl to pull her naked body against yours, unwilling to let her go as she drains the last independent thoughts from your mind...</p>");
			startQuestionsOnly();
			addRestartLink(md);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "charmmikucat1") {
			md = WritePlaceHeader();
			AddImage("quartzglow2.jpg");
			addPlaceTitle(md,
				"Charming Miku, your Familiar");
			md.write("<p>You force the additional mana into Miku's body and her eyes open wide, instantly glowing in a bright green as the spell mixes with the mana already within her, reforming her body and seeping into her mind to bind her to you.</p>" + "<p>You feel the frustration from the soul within the Crystal as its influence over Miku wanes and your will overpowers it, and finally, with a bright flash of light, the transformation is completed.</p>");
			startQuestions();
			addLinkToPlaceC(md,
				"rub your eyes", 408, "type=charmmikucat2");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "charmmikucat2") {
			md = WritePlaceHeader(false, "td-left-large");
			this.showPerson("mikucat1.jpg");
			addPlaceTitle(md, "Charming Miku, your Familiar");
			md.write("<p>You are momentarily blinded by the light, and as your vision clears Miku is... gone...</p>" + "<p>Well, not quite, in her place a black cat is lazily lounging on the armchair, curiously looking at you and her surroundings before jumping off and walking around the room.</p>");
			startQuestions();
			addLinkToPlaceC(md, '"Miku?"', 408, "type=charmmikucat3");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "charmmikucat3") {
			md = WritePlaceHeader();
			this.showPerson("mikucat2.jpg");
			addPlaceTitle(md, "Charming Miku, your Familiar");
			md.write("<p>Did the Transformation fail.... or succeed too well? Luckily, Miku does not leave you enough time to truly entertain these thoughts. The cats green eyes flare up and you watch as its body transforms back into the girl you know... well, mostly.</p>" + "<p>\u201cNyao...?\u201d Miku looks around confused for a moment, then shakes her head. \u201cWhy did I... oh!\u201d She drives her fingers over her new pair of cat ears and licks over her somewhat sharpened teeth.</p>" +
				"<p>\u201cI am a fucking catgirl...\u201d She laughs and turns to you. \u201cA Japanese catgirl, no less. But It worked, I can feel your mana flowing through my body! I am able to sense and manipulate it. I am not sure to what extend, but this is exhilarating!\u201d</p>" + "<p>You ask her if she feels any different, and it looks like she has to think about this for a moment.</p>" + "<p>\u201cI think I am still me, well aside from a strange craving to hunt for meat and get belly-rubs...\u201d She looks to you intently. \u201cAnd a newfound sense of purpose.\u201d</p>");
			startQuestions();
			addLinkToPlaceC(md, '"Purpose?"', 408, "type=charmmikucat4");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "charmmikucat4") {
			md = WritePlaceHeader(false, "td-left-large");
			this.other = -100;
			this.showPerson("mikucat3.jpg");
			addPlaceTitle(md, "Charming Miku, your Familiar");
			md.write("<p>\u201cYes, to help and assist you, my " + perYou.getWitch(true) + ".\u201d She smiles and lovers her head demurely. \u201cI am your familiar now, I am spellbound to you and there are no doubts left that this is what I want to be. And I am not sure it is really only the spell making me feel this way.\u201d Her smile turns into a smirk. \u201cI also want you to finally fuck me, that is not a particularly new feeling, though.\u201d</p>" +
				"<p>You reach out with one hand to caress her cheek, and she tenderly nuzzles into your palm.</p>");
			startQuestionsOnly();
			addLinkToPlaceC(md, '"I\'ll be happy to."', 408);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "fuck") {
			md = WritePlaceHeader(false, "td-left-large");
			this.showPersonRorX("mikusex1.jpg");
			addPlaceTitle(md, "Your Familiar's Ass");
			md.write("<p>\u201cYou pull Miku closer and she immediately locks your lips into a deep kiss, playfully teasing your tongue with her own while you squeeze her buttocks with both hands, kneading them briefly and pulling them apart.</p>" +
				"<p>\u201cOhhh... are your hands implying what I think they are implying?\u201d Miku asks with a wide grin, and as you confirm her suspicion, she wastes no time dragging you to the bed.</p>" + "<p>\u201cYou know how to make a girl happy, just let me take care of this.\u201d Miku quickly helps you out of your clothes and uses her tongue and hands with well practiced motions to get you hard and apply lube, which you found she always has a bottle of next to the bed, just in case.</p>" + "<p>She turns around, and in a single, quick motion, you unceremoniously push your entire length into her tight rear.</p>" +
				"<p>Miku releases a brief, decidedly feline, groan of discomfort when you pin her head down, place a firm slap onto her cheeks and begin to slowly push in and out of her ass. You enjoy her tightness and the way her muscles twitch while you pick up pace, and soon she begs you to go even harder, grab her hair and slap her face.</p>" + "<p>It is often quite a workout to satisfy her desires, but in the end, she always enjoys a powerful climax and happily snuggles up against you with a soft purr.</p>");
			startQuestionsOnly();
			addLinkToPlaceC(md, "talk more with Miku", 408);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "bj") {
			md = WritePlaceHeader(false, perYou.isMaleSex() ? "" : "td-left-large");
			if (perYou.isMaleSex()) this.showPersonRorX("mikusex2b.jpg");
			else this.showPerson("mikusex2g.jpg");
			addPlaceTitle(md, "Your Familiar's Mouth");
			if (perYou.isMaleSex()) md.write("<p>Miku pretty much knows what you want of her the moment you order her to knee down, and she eagerly licks her lips in anticipation.</p>" + "<p>You unzip your pants and begin to stroke your manhood, while she moves her arms to her back and opens her mouth wide on your order, barely moving until you are ready to simply push into her mouth.</p>" +
				"<p>You have quickly learned that Miku likes it a rough and were worried about her sharp teeth, at first, but the two of you have learned to adjust and she is pretty good at it. One of your hands is taking a hold of her hair, the other reaching for her cat ear to keep her head in place as you push your cock directly into her throat and rest for a few seconds. You hear gagging noises and a groan of discomfort, but overall, you know she is able to take your entire length with no problems, and after remaining like this for a few seconds, you begin to move your hip back and forth.</p>" +
				"<p>Miku looks up to you with her eyes wide open, and you can feel her unusually rough tongue shifting around to caress the underside of your cock. The sensation is simply amazing! You suspect that she is using small concentrations of mana to heighten your sensitivity, and it only drives you to push into her even harder.</p>" + "<p>You occasionally allow her a moment to catch her breath, but never fully stop pushing in and out of her mouth until you feel your climax approaching and Miku straightens her body in expectation, sticking out her tongue just as you pull back and spray your load into her mouth and over her face.</p>");
			else md.write("<p>You quickly undress and tell Miku that you need her help to unwind a little before you simply let yourself fall onto her bed and beckon her closer.</p>" + "<p>Miku doesn't need a lot of convincing to join you and crawls onto the bed on all fours with a playful purr on her lips, her eyes focused on you as if moving in on her prey while she spreads your legs and slowly drives her tongue over your folds, sending a pleasant shiver into your body.</p>" + "<p>Miku doesn't have quite the experience in pleasing women as she claims to have with men, and you were worried about her teeth at first. But she is still skilled when it comes to using her, unusually rough, tongue on you, playfully flicking it over your clit while her fingers spread your folds to tease you further.</p>" +
				"<p>It doesn't take her much to get you wet and even less time to make you moan and gasp for air, her tongue feeling unusually rough and you suspect that she occasionally sends small sparks of mana into you to raise your sensitivity, and it's hardly something you would complain about.</p>" + "<p>As you reach your climax, you find yourself covered in sweat and your body trembling all over while Miku snuggles up against your side, with a very relaxing purr.</p>");
			startQuestionsOnly();
			addLinkToPlaceC(md,
				"talk more with Miku", 408);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "toysher") {
			md = WritePlaceHeader(false, isExplicit() ? "td-left-large" : "");
			this.showPersonRorX("mikusex4.jpg");
			addPlaceTitle(md, "Toying With Your Familiar");
			md.write("<p>You guide Miku to the bed, and with a light shove, she lets herself falls back and teasingly spreads out her limps for you.</p>" + "<p>\u201cI like it when you are forceful.\u201d She coos happily as you strip out of your own clothes and crawl on top of her, your lips resting above hers.</p>" +
				"<p>\u201cAnd I like to be forceful.\u201d You barely touch her lips during your brief kiss before your own slide down to her chin and you press both hands on her shoulders to lift your body back up. Your fingertips slide down while you focus on the mana in her body and strengthen the spell over her.</p>" + "<p>Miku might have a lot more control over your spell than anyone, but it is still your spell, and with a little focus, you easily raise her arousal to a point where it is hard for her to fight back.</p>" +
				"<p>You spread Miku's legs in a single, swift motion and watch as her expression changes. Her eyes widening, her lips parting as she gasps for air, and her chest starting to twitch with every breather taken while you trail your fingers over her folds and flick over her clit. A smile forming on your lips as you reach into her toy-box, take out one of her toys and begin to insert it into her.</p>" + "<p>In the next minutes, you make sure to keep Miku's arousal at peak, trying out one toy after another from nipple clamps to small suction cups and watching her with delight as she twitches, moans, screams in a weirdly feline way and begs occasionally, continuously being driven close to her peak but never quite allowed to reach it, until you finally decide to push her over the edge and realize just how loud this petite woman can be.</p>");
			startQuestionsOnly();
			addLinkToPlaceC(md, "talk more with Miku", 408);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "toysyou") {
			md = WritePlaceHeader(false, "td-left-large");
			this.showPerson("mikusex3.jpg");
			addPlaceTitle(md, "Your Familiar Toys with You");
			md.write("<p>Miku helps you strip, guides you to lay down on her bed and crawls on top of you. You gasp as her fingers interlock with yours and she pushes your arms down above your head, both your lips meeting for a soft kiss while you feel her grip relaxing, and before you are really able to say anything, both your hands have been shackled to the bedpost.</p>" +
				"<p>\u201cJust trust me, you will love this.\u201d</p>" + "<p>Her lips remain close to your own as she whispers those words, and as she once again kisses you, you feel the familiar sensation of mana seeping into your body. Within seconds, your heartbeat quickens and you feel your folds twitching. Miku's body feels... closer, more present, every single motion of her slender form amplified a thousandfold as her fingertips slide over your armpits to your side and back up, and as her thumbs flick over your nipples, it's like a burst of electricity is shot into your body.</p>" +
				"<p>Green and pink streams of glowing mana have formed between your lips and disperse as she pushes her body up and breaks the kiss, leaving you gasping for air, your tongue subconsciously trailing over your lips, desperate to feel her again.</p>" + "<p>Miku grins down to you, her fingertips sending shivers through your entire body as she drives them over your stomach and spreads your legs to expose your folds to her.</p>");
			if (!isDay() && wherePerson("Ghost") == 408) md.write("<p>Your eyes are unfocused and your mind still taken by the flood of sensations, but you can see Keana's ghostly form floating over you after Miku beckoned the so far passive ghost over to help her out.</p>" +
				"<p>You moan as her fingers take solid form to knead your breasts while Miku presses a little vibrator against your clit, and from then on, the two of them greatly enjoy toying with you. Minutes pass and you are carried from one climax to the next as Miku plays with a variety of beads, clamps and vibrators. 2 pairs of hands caress your body and 2 pairs of lips cover your skin in soft kisses.</p>" + "<p>As they are finally done with you are barely able to think straight for a while, basking in the afterglow of your last climax with one of your girls in each arm while your mind slowly clears.</p>");
			else md.write("<p>You get a glimpse of the long, ribbed vibrator a second before she pushes it into your folds and your body begins to strain violently against the shackles with a loud moan. Two clamps snap close around your nipples, but at this point you barely feel any pain, just the sudden rush of adrenaline pushing you even deeper into ecstasy.</p>" + "<p>Miku seems pleased with your reaction, her fingers circling around your navel, leaving small tickles of mana in its wake, and as she drives down your stomach and briefly graces your clit, the sudden jolt she sends into your body is enough to push you into your first climax.</p>" +
				"<p>More are to follow as she continues to play with you, switching toys, caressing your skin and covering your body in warm kisses.</p>" + "<p>As your last orgasm hits, you are barely able to get up, gasping heavily for air as Miku crawls into your arms and snuggles against you, emitting a soft, relaxing purr while your mind drifts off.</p>");
			startQuestionsOnly();
			addLinkToPlaceC(md, "talk more with Miku", 408);
			WritePlaceFooter(md);
			return true
		}
		return false
	};
	per.showPersonChat = function(bGeneral, md) {
		if (Place ==
			45 && this.isHere()) {
			if (getHour() > 11 && !this.checkFlag(34) && sType === "") addLinkToPlaceC(md, "help Miku and Tracy prepare lunch", 45, "type=tracymikulunch");
			return
		}
		if (Place == 394) {
			if (this.isHere() && !this.checkFlag(2)) addQuestionR(md, "greet the pair", "The two of them greet you, but while Abby instantly shifts the topic towards her &quot;relationship&quot; with you, you are still not really getting much of a word in.</p>" + "<p>At least she is praising you quite a lot, and while Miku occasionally shoots you a curious glance, she remains mostly focused on her friend.",
				"", "setPersonFlag(\\'Miku\\',2)");
			else if (sType == "charmmiku6a") addQuestionR(md, "ask Abby what happened", "&quot;We had the best sex ever!&quot; Abby answers surprisingly concise, you must have taken more out of her than you realize. &quot;You were really passionate, enthusiastic and unusually, well, rough, did Miku do something to you?&quot;</p>" + "<p>She likely did, but you are honestly not sure what.", "Abby", "setPersonFlag(\\'Miku\\',4);setQueryParams()");
			else if (sType == "charmmiku6b") addQuestionR(md,
				"ask Abby what happened", "&quot;Well... something seemed to affect Miku and she suddenly started masturbating, and then you looked like you really needed to masturbate, too, but didn&rsquo;t.&quot;</p>" + "<p>&quot;Maybe it has something to do with what you did the day we met? I often have felt the need to touch myself since then, especially when I think of you, just the other day I was showing a group of  visitors around, so I had to get dressed again, stupid outdated regulations, you know? And there was...&quot;" +
				"<p>You quickly interrupt Abby before she is able to really get going again, the last thing you need now is another endless torrent of words...", "Abby", "setPersonFlag(\\'Miku\\',4);setQueryParams()");
			else if (this.checkFlag(4) && !this.checkFlag(5) && wherePerson("Abby") == 394) addQuestionR(md, "ask if Miku has any Magical skills Abby knows of", "&quot;No... well, she is very interested in the occult, but she does not often talk about it... actually, she does not talk a lot in general when we are together, I wonder why, I mean, come to think of it, she must be leading an exciting life, one day, we were out shopping and when we entered that clothing " +
				getShopStore() + ", you know, the one close to the antique " + getShopStore() + " where they sell those cute lamps, actually, did I tell you my mom once...&quot;</p>" + "<p>You once again have to interrupt Abby before she gets too caught up in what she wanted to say, and you somehow have a good idea why Miku never speaks much when the two are together.", "Abby", "setPersonFlag(\\'Miku\\',5)");
			return
		}
		if (Place == 408 && this.isHere()) {
			switch (this.other) {
				case 0:
					addQuestionR(md, "ask Miku why she is here", "&quot;I figured I might as well pay you a visit, learn a little more about the person who magically enslaved one of my best friends and probably may be my own future " +
						perYou.getMaster() + " as well.&quot;", "Miku", "setPersonOther(\\'Miku\\',1)");
					return;
				case 1:
					addQuestionR(md, "she seems strangely casual about that", "&quot;Abby needed to get laid.&quot; Miku answers bluntly. &quot;She is a really great girl, helpful, good-looking, really extroverted, but she tends to overthink the whole &quot;sex&quot; thing, get needlessly attached and scare potential partners away.&quot;</p>" + "&quot;Something uncomplicated is just what she needs, and as long as you treat her well, I don&rsquo;t mind if she's yours.\u201d She looks you over.</p>" +
						"&quot;And as far as the ones with an affinity for Magic I've met so far go, you seem like a more interesting choice for a " + perYou.getMaster() + ".&quot;", "Miku", "setPersonOther(\\'Miku\\',2)");
					return;
				case 2:
					addQuestionR(md, "ask her what she did back at the aquarium", "\u201cYou mean when you tried, and failed, to turn me into your personal sexslave?\u201d Miku gives you a cheeky grin. \u201cI am not sure myself, I think I used the mana you infused me with to transfer my own arousal to you? It's the first time someone actually used a spell on me and I just...winged it?\u201d</p>" +
						"<p>She seems pretty proud of that.</p>" + "<p>\u201cIf it's any consolation, the spell was already dispersing and would have likely failed anyway, I seem to have an affinity for Mana, but I can not hold or generate it.\u201d", "Miku", "setPersonOther(\\'Miku\\',3)");
					return;
				case 3:
					addQuestionR(md, "an affinity for Mana?", "\u201cYes, I can sense it if I am close to someone, I know some of our teachers and library staff have become affected by spells in the past days, and I know of at least one student who is likely a warlock... he creeps me out, though, his mana feels... wrong.\u201d</p><p>" +
						(isCharmedBy("Tracy") ? "\u201cMiku smirks\u201d I also know that you charmed your sister, good choice, I bet she is great in bed.\u201d" : "\u201cI can also see that you have yet to charm your sister, why the hesitation? She is sexy.\u201d"), "Miku", "setPersonOther(\\'Miku\\',4)");
					return;
				case 4:
					startAlternatives(md);
					if (isCharmedBy("Tracy", "Davy")) addQuestionR(md, "tell her you didn't charm Tracy", "\u201cWell, someone did and is likely having lots of fun fucking her, so you might want to be careful when she is around.\u201d",
						"Miku", "setPersonOther(\\'Miku\\',5)");
					if (isCharmedBy("Tracy", "You"))
						if (getCharmedLevel("Tracy") == 1) addQuestionR(md, "tell her it's only to protect her, you don't have sex with her", "\u201cSure, and watching her parade her cute naked ass around the house is just a bonus, hmh?\u201d She smirks.\u201d</p>" + "<p>\u201cSooner or later you are going to give in to temptation, why torture yourself and delay it?\u201d", "Miku", "setPersonOther(\\'Miku\\',5)");
						else addQuestionR(md, "confirm it, you are having sex with your sister",
							'"She is a cutie is she?" Miku has a wide grin on her face. "I would do the same if she was my sister, so your secret is safe with me."</p>' + '<p>"If you are bothering to keep it secret, that is."', "Miku", "setPersonOther(\\'Miku\\',5)");
					if (!isCharmedBy("Tracy")) addQuestionR(md, "she's your sister, of course you won't charm her!", "Miku scoffs. \u201cIt's just sex, use protection so she won't get pregnant and enjoy yourself. You can't tell me you don't want her, she seems like the teasing type to me.\u201d<p>" +
						"<p>You tell her to drop the topic, and Miku just shrugs. \u201cIt's your choice, really, just giving advice.\u201d", "Miku", "setPersonOther(\\'Miku\\',5)");
					addQuestionR(md, "what you do with your family is not her business", "\u201cIt's okay, I'm not judging, it's your family, and you may be as perverted or conservative with them as you want to be.\u201d</p>" + "<p>You glare at Miku and she finally falls quiet on the topic.", "Miku", "setPersonOther(\\'Miku\\',5)");
					endAlternatives(md);
					return;
				case 5:
					addQuestionR(md,
						"ask her more about her abilities", "\u201cIt is likely hereditary, but does not manifest in every generation, at least my parents pretend to not know what I'm talking about when I ask about it.\u201d Miku pulls an annoyed face.</p>" + "<p>I have done a lot of digging online about magic and the history of witchcraft, joined a few message boards where people claim to have been affected by spells, and finally decided to make the move to Glenvale, a town with one of the most colorful magical histories in the country.\u201d</p>" +
						"<p>\u201cIt turned out to be a good decision, by the way. This is probably the only place where a schoolteacher holds an entire lesson about Mana and how to acquire it.\u201d she chuckles. \u201cMr Beasley is a good source of information if you do it right, but when I tried to use one of these...\u201d She holds up a rustic stone. \u201c...in the wild ranges, the mana generated just... well, faded.\u201d</p>" + "<p>She offers the stone to you. \u201cYou can have it, by the way, it should make up for the Mana you lost when you tried to control my mind and have sex with me.\u201d Miku smiles sweetly. \u201dYou pervert.\u201d",
						"Miku", "setPersonOther(\\'Miku\\',6)");
					return;
				case 6:
					if (perYourBody.NoItems < perYourBody.MaxItems) addQuestionR(md, "take the stone", "You take the stone and feel like you should argue the whole \u201cpervert\u201d thing, but she kind of has a point, and Miku does seem strangely okay with you trying to take over her mind.</p>" + "<p>\u201cGreat, so, now that this is settled, let us talk about me moving in and you finding a way to actually succeed in turning me into your personal sex-slave slash girlfriend.\u201d",
						"Miku", "setPersonOther(\\'Miku\\',7);perYourBody.PutItem(6)");
					else addQuestionR(md, "take the stone", "You take the stone and feel like you should argue the whole \u201cpervert\u201d thing, but she kind of has a point, and Miku does seem strangely okay with you trying to take over her mind.</p>" + "<p>As you try to put the stone into your bag, you find it already overloaded, so you simply place it on a cupboard.", "Miku", "setPersonOther(\\'Miku\\',7);PlaceI(6)");
					return;
				case 7:
					addQuestionR(md, "she wants to be charmed?",
						"\u201cWhat, are you surprised someone actually wants to be your toy?\u201d Miku chuckles bemused. \u201cWell, it is not completely altruistic, of course.\u201d</p>" + "<p>\u201cBy finding out how to charm me, you will likely also find out more about my bloodline and abilities, probably even help me find my full potential, and if you can do that, I'll happily be your plaything.\u201d</p>" + "<p>You are not fully convinced this is a trade she would willingly make, so she elaborates further.</p>" + "<p>\u201cWell, I also really enjoyed the little taste of being under your spell, and Abby looks happy, too. It's a pretty blissful experience: a clear purpose, no concern what \u201cpolite society\u201d may think of your sexuality or fetishes, and sex will always feel amazing, no matter how absolutely mediocre the spellcasters actual performance may be.\u201d</p>" +
						"<p>Miku smiles sweetly, and you decide to not comment on the clear jab towards you, she'll see.", "Miku", "setPersonOther(\\'Miku\\',8)");
					return;
				case 8:
					addQuestionR(md, "wait, moving in?", "You ask if you heard correctly and Miku confirms it. \u201cI am willing to put my entire life into your hands, that is quite a commitment. So yes, I want to get to know you first, see what kind of person, " + perYou.getWitch(true) + " or lover you are.\u201d</p>" + "<p>You pry further if this will not be a problem with her parents or current lodgings, and Miku shakes her head. \u201cLet us just say I do not have much contact with my parents right now and it is for the better, okay?\u201d She seems a little annoyed by the topic.</p>" +
						"<p>\u201cI am not going to beg, but this is non-negotiable, if you want to put me under your spell, I want to know if you are suited to have me. And I believe that I am a pretty good catch, even without my potential magic skills. \u201cMiku spins around with a grin.\u201d", "Miku", "setPersonOther(\\'Miku\\',9)");
					return;
				case 9:
					startAlternatives(md);
					if (isCharmedBy("Mom")) addQuestionR(md, '"Alright, we have a deal, you can live here, It\'s not like anyone will protest"', "\u201cYes, I noticed you are pretty much the " +
						perYou.getMaster() + " of this house, good call, by the way.\u201d She winks to you and smiles happily. \u201cI will gather my things and get the room ready. This will be exciting!\u201d", "Miku", "movePerson(\\'Miku\\',999);setPersonOther(\\'Miku\\',-1);startTimedEvent(\\'returnMiku()\\',12)");
					else addQuestionR(md, '"Alright, I will have to discuss this with my Mom, but it should not be a problem"', "\u201cYou have yet to charm your Mother?\u201d Miku looks at you incredulously. \u201cYou do know she is really hot, right?\u201d",
						"Miku", "setPersonOther(\\'Miku\\',10)");
					addQuestionR(md, '"No deal, Money is tight as it is without her freeloading"', "\u201cHmh, a pity, but as I said, I will not beg, and there are other spellcasters to turn to.\u201d</p>" + "<p>Miku looks disappointed, but remains firm in her stance. \u201cGoodbye, and good luck with your harem building.\u201d</p>" + "<p>She gives you a polite bow and leaves the room, likely not to be seen again.", "Miku", "movePerson(\\'Miku\\',1000);setPersonOther(\\'Miku\\',-1)");
					endAlternatives(md);
					return;
				case 10:
					startAlternatives(md);
					addQuestionR(md, "\"She's my mother, for god's sake!\"", "This suggestion is not even funny, you shut down any form of discussion Miku might want to start over the topic and she accepts it, reluctantly. She does point out, however that you sooner or later will have to make a choice when your mom finds out more about what you are doing.</p>" + "<p>Finally, she leaves to get her belongings.", "Miku", "movePerson(\\'Miku\\',999);setPersonOther(\\'Miku\\',-1);startTimedEvent(\\'returnMiku()\\',12)");
					addQuestionR(md, '"She is kinda sexy, is she...?"', "Miku notices your hesitation and grins, pointing out that you are in a unique position to fulfill any desire you may have and should do so, as well as how everything will be much easier once everyone in the house is under your control.</p>" + "<p>You have to admit that she has a point... but still, you are talking about your mother here.</p>" + "<p>For now, though, Miku doesn't press the issue further and leaves to gather her things.", "Miku", "movePerson(\\'Miku\\',999);setPersonOther(\\'Miku\\',-1);startTimedEvent(\\'returnMiku()\\',12)");
					endAlternatives(md);
					return;
				case -10:
					addQuestionR(md, "review your findings with Miku", "\u201cSo, you say one of my ancestors was someones familiar? Like a Raven? I am not going to grow feathers, am I?\u201d Miku doesn't look like she is entirely convinced, but after you lay out everything you found out, she seems to accept the possibility.</p>" + "<p>\u201cSo, my bloodline has been bred to serve those who are able to generate mana... not what I had hoped for, but this explains a lot.\u201d</p>" + "<p>You ask if she is sure she still wants to go through with this, and Miku gives a determined nod.</p>" +
						"<p>\u201cYes I am.\u201d She chuckles. \u201cOutside of the bedroom, I have never been a particularly submissive girl, even if my parents -really- wanted me to be. And yet, there is something that draws me to you. I have felt it in others, too, like sir Gates when I visited him shortly after arriving in Glenvale or more recently...\u201d She swallows as if having a hard time saying it \u201c...Davy Robins. But you... there is something special about you, and I'm pretty sure others feel that as well, so If I'm to be anyone's familiar, then I choose to be yours, that much control I am able to exert over my life.\u201d She says with determination.</p>" +
						"<p>\u201cAnd who knows what we are going to unleash, the thought that I may be close to unlock my true potential is exciting.\u201d", "Miku", "setPersonOther(\\'Miku\\',-11)");
					return;
				case -11:
					if (!isSpellKnown("Transform")) addQuestionR(md, '"I still need to find a spell able to transform you, though"', "\u201cRight, then hurry up and find it!\u201d Miku blurts out in excitement, then smiles sweetly\u201d Uhm... please?\u201d", "Miku");
					else if (perYourBody.FindItem(52) === 0 || perKurndorf.getQuestRitual() <
						200) addQuestionR(md, '"We still need a Soul-bound Crystal"', "\u201cI wish I would know what that is, but I will check the message boards if anyone does while you do your thing running around.\u201d", "Miku");
					else addQuestionR(md, '"Well, we have everything we need for the transformation"', "\u201cRight.\u201d Miku takes a calming breather and steadies herself. \u201cThis is it then, I... think I am as ready as I will ever be for this, let us do this.\u201d", "Miku", "setPersonOther(\\'Miku\\',-20)")
			}
			if (this.other <
				0 && this.other > -20) {
				addQuestionRO(md, "spend some time with Miku", "You spend some time comparing your findings and chatting for about an hour. Miku is rather inquisitive regarding your sex-life, and while you make sure to not spill every secret about your harem, she does manage to learn more about you than you learn about her, you believe.", "Miku", "WaitHereOnly(12)");
				if (!this.checkFlag(8)) addQuestionR(md, "ask why she is acting so different at school or among other people", "\u201cIt is what people expect of a girl, is it not? Guys like to feel like they are these great pussy-conquerors, so us girls are supposed to pretend to be all shy and pure and hard to get so they keep that illusion.\u201d</p>" +
					"<p>" + (perYou.isMaleSex() ? "\u201cUh, no offense, by the way.\u201d" : "\u201cYou probably know what this is like, right?\u201d") + "</p>" + "<p>\u201cIf you dare to admit that you actually like sex, you are immediately branded a slut, obviously have no standards and fuck everyone because people are fucking idiots.\u201d She emits an annoyed sigh, the topic seems to hit close to home.</p>" + "<p>\u201cWith you, though, I simply do not feel the need to... hide my tastes. You are running around using magic to get people to have sex with you, after all, and we are kind of working on turning me into your plaything as well.\u201d</p>" +
					"<p>\u201cSo, it is just nice to not bother for a change.\u201d", "Miku", "setPersonFlag(\\'Miku\\',8)");
				if (!this.checkFlag(16)) addQuestionR(md, "ask about her family", "\u201cMy father is a fairly strict company man and my mother a submissive housewife to him, they are not here, I am quite happy they are not, and this is all I'm willing to say for the moment.\u201d", "Miku", "setPersonFlag(\\'Miku\\',16)");
				if (wherePerson("Ghost") == 408 && !this.checkFlag(22)) addQuestionR(md, "ask how she gets along with her Roommate",
					"\u201cWell, she's quiet, barely visible when you are not here and always naked.</p>" + "<p>I have lived with worse people, but I wish she would warn me before she suddenly starts reading over my shoulder or walks through me.\u201d", "Miku", "setPersonFlag(\\'Miku\\',22)")
			} else if (this.other == -100) {
				addQuestionRO(md, "spend some time with Miku", "You spend about an hour chatting with Miku, and she briefs you on what she sees during the night, points towards sexy, and usually lonely, women in the neighborhood and shares any new insights she gained online, while you tell her about your newest conquest and any progress in your many endeavors throughout the city.",
					"Miku", "WaitHereOnly(12)");
				if (!this.checkFlag(20)) addQuestionR(md, "ask what it feels like being a cat", "\u201cUnusual, you act more on instinct, rely on new senses... I have spent one night hunting and toying with a mouse and it felt absolutely exhilarating.\u201d</p>" + "<p>\u201cIn a way, the whole world feels different and it is strange how easily I got used to it.\u201d</p>" + "<p>You ask if she will always look like this now, and she shakes her head.</p>" + "<p>\u201cLuckily not... I would have to beat the weeaboos at school off with a stick if I ran around like this...\u201d She chuckles.</p>" +
					"<p>\u201cI am able to assume human form if I want to, but this feels simply the most comfortable to me now.\u201d", "Miku", "setPersonFlag(\\'Miku\\',20)");
				if (!this.checkFlag(32) && this.checkFlag(31)) addQuestionR(md, "what did you and Keana just do?", "Well, I remembered how you mentioned Ghosts being manifestations of Mana, so I figured I might be able to manipulate her ethereal body if I focus on that aspect and we decided to try it out.\u201d She grins. \u201cI would say the experiment was a full success.\u201d",
					"Miku", "setPersonFlag(\\'Miku\\',32)");
				if (!this.checkFlag(27) && this.checkFlag(26)) addQuestionR(md, "ask Miku about Lilith", "\u201cEverything in my being tells me to be weary around her.\u201d Miku answers in a grim voice. \u201cAnd you should be, too.\u201d</p>" + "<p>\u201cShe is a predator, she will not be controlled forever and you should drive a stake into her heart as soon as you are able to.\u201d", "Miku", "setPersonFlag(\\'Miku\\',27)");
				if (perYou.isMaleSex()) {
					addLinkToPlace(md, "use her ass", 408,
						"type=fuck");
					addLinkToPlace(md, "give her some milk", 408, "type=bj")
				} else {
					addLinkToPlace(md, "let her use her toys on you", 408, "type=toysyou");
					addLinkToPlace(md, "use her toys on her", 408, "type=toysher");
					addLinkToPlace(md, "let her use her tongue", 408, "type=bj")
				}
				addSleepLink(md, "spend the night with Miku", "", "<p style='position:absolute;top:62%;left:2%;cursor:pointer;margin-top:-12px;font-size:x-large'><b>Going to Bed with Miku</b></p>" + '<p style="position:absolute;left:2%;top:65%;cursor:pointer;font-size:1.1em;width:50%">You spend the night in the attic and Miku, naked as she is, happily snuggles into your arms with a soft purr',
					this.getImg("mikucat6.jpg"))
			}
		}
		if (sType === "" && (this.other == -1 || this.other == -2)) {
			if (!this.checkFlag(7) && isPersonHere("Victoria") && isCharmedBy("Victoria")) addQuestionR(md, "ask Victoria about Miku", "\u201cI have heard my father talk of warlocks and witches with special abilities, but it was never a focus of his research, so I fear I do not have much to offer when it comes to information about this subject, " + perYou.getMaster() + ".\u201d Victoria explains calmly. \u201cI apologize for disappointing you, but I shall begin research on the matter immediately, if you so wish.\u201d</p>" +
				"<p>You tell Victoria to do so, but decide to keep your own investigations going nevertheless.", "Victoria", "setPersonFlag(\\'Miku\\',7)");
			if (!this.checkFlag(9) && isPersonHere("Gypsy")) addQuestionR(md, "ask Esmeralda about Miku", "Esmeralda humms briefly, mixes her cards and murmurs a phrase in a foreign language.</p>" + "<p>\u201cAn unlikely warrior, someone powerful, but chained, and the blood of the one responsible for these chains... find these, and you have the information you seek.\u201d</p>" + "<p>You ask her if she could be less cryptic, and her answer is a simple \u201cNo.\u201d",
				"Gypsy", "setPersonFlag(\\'Miku\\',9)");
			if (!this.checkFlag(10) && isPersonHere("MrBeasley") && isCharmedBy("MrBeasley")) addQuestionR(md, "ask Mr. Beasley about Miku", "\u201cAh, little Miku, such a sweet student...\u201d Mr Beasley seems lost in a daydream for a moment before you shake him out of it. \u201cRight, she may be of a special bloodline, like my apprentice is, " + perYou.getMaster() + ", but I fear I can not tell you more. Davy or someone in his family might be able to.", "MrBeasley", "setPersonFlag(\\'Miku\\',10)");
			if (!this.checkFlag(11) && isPersonHere("Davy") && isDavyDefeated()) addQuestionR(md, "ask Davy about Miku", "You figured it's worth a shot, remove the gag from Davy mouth and explain to him that you have a few questions, and cooperating now would make his future life much easier.</p>" + "<p>Davy's answer is to tell you rather aggressively to go fuck yourself, as well as a threat of what he will do with you and your family once he is free and something more you did not understand because you had the gag back in by then.</p>" +
				"<p>You will have to get your answer elsewhere and make a mental note to tell Bambi to factor Davy's behavior into the next session.", "Davy", "setPersonFlag(\\'Miku\\',11)");
			if (!this.checkFlag(12) && isPersonHere("Monique") && Place == 8) addQuestionR(md, "ask Monique about Miku", "Monique hums briefly and types something into the computer, then shakes her head. \u201cMost of the books in our library were written by people for whom every witch had special abilities, finding something specific without knowing what exactly we are looking for seems like a lost cause, I'm sorry.",
				"Monique", "setPersonFlag(\\'Miku\\',12)");
			if (!this.checkFlag(13) && isPersonHere("Tina"))
				if (isCharmedBy("Tina")) addQuestionR(md, "ask Tina about Miku", "\u201cOh, she must belong to one of the special bloodlines my brother was looking for!\u201d Tina says, exited that she is able to be of use to you.</p>" + "<p>\u201cI have already told you about our families bloodline, but Davy believes there are others in Glenvale who have special abilities as well.\u201d</p>" + "<p>You ask if she knows more about these people, and Tina eagerly nods.</p>" +
					"<p>\u201cI do, " + perYou.getMaster() + "! There are many tales from around the world of humans mating with creatures from beyond what is called the \u201cVeil\u201d a barrier between our world and others.\u201dThe offspring of these unions have often been the source of powerful bloodlines, and Glenvale had especially many of those, but in-between the witch hunts and their blood diluting over time, not a lot of them survived till today.\u201d</p>" + "<p>You ask if she has more information about those people, and Tina shakes her head. \u201cNo, " +
					perYou.getMaster() + ", but I have heard my brother speaking on the phone about the Gates family likely keeping records about this, and I believe he was devising a plan to obtain them.\u201d</p>" + "<p>This is finally really useful information, and Tina is beaming with pride as you compliment her, eagerly asking if there is anything more she may do for you and invitingly putting her body on display.", "Tina", "setPersonFlag(\\'Miku\\',13);setPersonOther(\\'Miku\\',-2)");
				else if (!isCharmedBy("MrsRobbins",
					"Davy")) addQuestionR(md, "ask Tina about Miku", "\u201cWell, you did help me with mom, and it seems my stupid brother is so afraid of you finding him, that he has left us alone...\u201d Tina considers for a moment, then sights. \u201cThis feels like backstabbing my family, but I'll tell you what I can.\u201d</p>" + "<p>\u201cThere are several bloodlines with ties to magic around the world, and especially in Glenvale thanks to the town's history, and most of these can in one way or another be traced back to the union of human servants and creatures summoned from beyond what is called the \u201cveil\u201d, a sort of barrier between our world and others. So, this girl may have someone like this in her ancestry.\u201d</p>" +
				"<p>You ask how she knows all this, and after a moment of hesitation, Tina replies.</p>" + "<p>\u201cDavy has been obsessed with finding out who in Glenvale might posses such powerful bloodlines or simply magic at all. He told me to inform him whenever I find someone who has, but right now, he can bite me, for all I care.\u201d Tina scoffs.</p>" + "<p>\u201cWait, I actually once heard him talk on the phone about the Gates family, and how they must keep records of the various bloodlines they encountered, I believe he even had a plan to get these records.\u201d",
				"Tina", "setPersonFlag(\\'Miku\\',13);setPersonOther(\\'Miku\\',-2)");
			if (!this.checkFlag(14) && isPersonHere("MsJones") && isCharmedBy("MsJones")) addQuestionR(md, "ask Ms. Jones about Miku", "\u201cSo Ms. Nakamoto is able to sense mana and knows when someone is under a spell... well, this explains her interest in me.\u201d Ms Jones chuckles.</p>" + "<p>\u201cThere are only a few of these people left, but she may have a creature from beyond the veil somewhere in her ancestry.\u201d</p>" + "<p>You ask Ms Jones to elaborate, and she offers the following explanation.</p>" +
				"<p>\u201cWhen I was the demons host, it took great joy in its attempts to breed better servants. It would often summon lesser demons, fey creatures, and sometimes other things to mate with captive and enthralled women who bore their children.\u201d</p>" + "<p>Ms Jones expression shows that, like most of her possession, it is not a pleasant memory, but she speaks on.</p>" + "<p>\u201cOf course, Legions machinations here are not the source of all of these bloodlines around the world, but most can trace their special powers back to someone who offered her body, or had her body offered to one of these creatures.\u201d</p>" +
				"<p>You ask if there is a way to bring out the full potential of Miku's blood, and Ms Jones thinks for a moment.</p>" + "<p>\u201cIf you had a means to Transform her body, it could be used to strengthen the influence of her outsider bloodline... of course, it is advisable to find out what you are going to set free, first, and I doubt the library has records of these, but maybe someone well versed in magical history like the Gates family, has.\u201d", "MSJones", "setPersonFlag(\\'Miku\\',14);setPersonOther(\\'Miku\\',-2)")
		}
		if (this.other ==
			-2 && (Place == 17 || Place == 192) && !this.checkFlag(15))
			if (isCharmedPath() && Place == 17) addQuestionR(md, "ask " + perGates.getPersonNameShort() + " for information about special bloodlines", "My " + capitalizeFirstLetter(perYou.getSex()) + ", you are having interesting adventures it seems, It reminds me of my youth.\u201d Sir Gates muses.</p>" + "<p>\u201cThere are few records of the various magical bloodlines, but my Family has fought the machinations of Kurndorfs followers, and their attempts to bring him back for a long time.\u201d He puffs on his pipe, slowly rises to his feet and heads towards a bookshelf. \u201cThey have kept many records, and quite a few of these pertain the abilities of those among them possessing special bloodlines. I do believe I remember... ah here it is.\u201d</p>" +
				"<p>\u201cHe takes out an old, but very well maintained, book and carefully flips the pages until he finally finds what he was looking for.", "SirRonald", "setPersonFlag(\\'Miku\\',15);setPersonOther(\\'Miku\\',-3)");
			else if (isMurderPath() && Place == 192 && isPersonHere("Sarah")) addQuestionR(md, "ask Sarah for information about special bloodlines", "\u201cA girl able to sense and manipulate mana, but unable to generate it? That sounds fascinating, " + perYou.getMaster() + "!\u201d</p>" + "<p>You ask Sarah if her family has kept any records about witches with special bloodlines, and she considers for a moment.</p>" +
			"<p>\u201cNot directly, no, but uncle Ronnie often told me about our families sacred duty to fight those misusing the gift of magic, like the followers of Kurndorf, and I know we have extensive records of those we fought and their abilities.\u201d She smiles brightly. \u201cWhich, of course, now rightfully belong to my beloved " + perYou.getMaster() + ", just as my heart and soul.\u201d</p>" + "<p>You commend Sarah on her devotion to you, eliciting a blissful gasp as you caress her cheek.</p>" + "<p>\u201cThere is a lot to read through, but I have a rough idea what you might be looking for, " +
			perYou.getMaster() + ", so leave it all to me!\u201d The gesture seems to have filled her with even more enthusiasm, and before you are able to say anything more, Sarah has already vanished in the library.", "Sarah", "setPersonFlag(\\'Miku\\',15);setPersonOther(\\'Miku\\',-3)");
		else if (isConspiracyPath() && Place == 192 && isPersonHere("Sarah") && sType === "") addLinkToPlace(md, "ask Sarah for information about special bloodlines", 192, "type=asksarahmiku");
		if (this.other == -3 && (Place == 17 || Place == 192))
			if (isCharmedPath() &&
				Place == 17) addQuestionR(md, "take a look at what he found", "\u201cThere are several records about witches and warlocks using so called familiars all over the world. Records regarding their nature differ, but there are many cases, especially around Glenvale, where the familiar turned out to be a feytouched, human, bred to be able to manipulate mana at much finer degrees than most spellcasters, but unable to generate it on their own and thus reliant on an actual witch to provide it.\u201d He shows you the pages in the book, though they are written in a rather old dialect, and you have to rely on his word on most parts.</p>" +
				"<p>\u201cAs time passed and knowledge of the veil and what is behind it faded, fewer and fewer of these creatures were able to cross over, but many of their bloodlines remain, and this girl of yours may very well be a descendant from one of them.\u201d</p>" + "<p>\u201cSo, Miku may be a familiar?\u201d You ask. \u201cBut she is Japanese.\u201d</p>" + "<p>\u201cDifferent nations have different legends, like the Sidhe of western and the Kami of eastern mythology. However, at the core, many can be traced back to the same origins. Not to mention that only very few people these days are purely of a single nationality and you have mentioned that her family lived here for a few generations.\u201d</p>" +
				"<p>You ask if it would be possible to help her awaken her abilities fully, but Sir Gates seems to dislike that idea. \u201cYou would need to find a way to transform her body to be more like the familiars of old to realize her full potential, which is nigh impossible.\u201d</p>" + "<p>\u201cAnd likely for the better, too, it would only make her a target for less savory spellcasters.\u201d", "SirRonald", "setPersonOther(\\'Miku\\',-10)");
			else if (isMurderPath() && Place == 192 && isPersonHere("Sarah")) addQuestionR(md,
			"pass the Time until Sarah is back", "You use the time while Sarah scours the library to familiarize yourself with the Mansions layout, musing on how huge it is, especially with Sir Gates living alone for most of the time.</p>" + "<p>It could technically be yours now, just as the Gates family fortune, but for now, you can not be too open about it without raising suspicions. Not to mention if you should even go that far after what you did...</p>" + "<p>You are taken out of your thoughts by Sarah's voice, who finally seems to have concluded her search and awaits you on her knees with one of the books held out for you.</p>" +
			"<p>\u201cI think this is what you are looking form " + perYou.getMaster() + ", this entry talks about a witches familiar, and while assumptions what those supposedly are differed widely around the world, my ancestors note that those found in this part of the country were indeed often feytouched humans.\u201d</p>" + "<p>You point out that Miku is Japanese, but Sarah makes a rather compelling point that her family has been living here for a few generations and it is not unlikely that creatures like the Sidhe and Kami share similar origins to begin with. The Familiars in the book had an immense fine control of Mana, able to use it to shift form or manipulate spells to a large degree, but were unable to generate it themselves and suspect-able to be controlled. They were pretty much bred as servants to Warlocks and Witches. However, since Miku's bloodline has been diluted over the centuries, you would have to find a way to basically \u201cTransform\u201d her body to be more like the familiars of old.</p>" +
			"<p>\u201cYou thank Sarah for the effort, and she happily gazes up to you.\u201d Everything for you, my beloved " + perYou.getMaster() + ". I will be here in case you have more need of me.\u201d", "Sarah", "setPersonFlag(\\'Miku\\',15);setPersonOther(\\'Miku\\',-10)")
	};
	per.showEventSleep = function(wt) {
		if ((Place == 46 || Place == 170) && this.place == 408 && this.other < 0 && this.other > -20 && !this.checkFlag(23) && wt > 24) {
			passTime(true);
			passTime(true);
			dispPlace(46, "type=mikunightevent1");
			return true
		}
		return false
	};
	per.handleItem =
		function(no, cmd) {
			if (no == 32)
				if (cmd == 1)
					if (this.isHere() && this.isCharmedBy()) {
						examineSilverRingStart();
						addComments("<p>It seems to be reacting to Miku's presence... getting warmer the closer you get.</p>" + "</td></tr></table>");
						return "handled"
					}
			if (no == 14 && cmd == 2)
				if (Place == 394 && this.place == 394) {
					CastCharmSpell("Miku", 394, 1, "type=charmmiku1");
					return "handled"
				} else if (Place == 408 && sType !== "transformcat9") {
				addComments("You already know that this won't work, and until you have figured out why, you would just waste your Mana.");
				return "handled"
			} else if (sType == "transformcat9") {
				CastCharmSpell("Miku", 408, 1, "type=charmmikucat1");
				return "handled"
			}
			if (cmd == 1 && (no == 52 || no == 64)) {
				var s = getSoulBoundCrystal(no);
				if (s != "")
					if (this.isHere() && this.other == -20) {
						examineItem(no, "The " + s + " vibrates softly the closer you get to Miku.");
						return "handled"
					}
			}
			if (no == 18 && cmd == 2)
				if (Place == 408 && this.isHere()) {
					if (this.other == -100) {
						addComments("You have already transformed Miku!");
						return "handled"
					}
					if (this.other != -20) return "";
					if (!CastTransform(1, true)) return "handled";
					ClearComments();
					dispPlace(Place, "type=transformcat0");
					return "nofooter"
				}
			return ""
		};
	per.addPersonPhoneCall = function() {
		if (!this.checkFlag(17) && this.other < 0 && getHour() == 12 && this.isCharmedBy())
			if (makeCall(true, 270)) {
				this.setFlag(17);
				this.setFlag(35)
			}
		if (this.checkFlag(17) && !this.checkFlag(18) && !this.checkFlag(35) && Math.floor((nTime - this.charmedTime) / 12) > 24 && getHour() == 12)
			if (makeCall(true, 271)) this.setFlag(18);
		if (!this.checkFlag(19) && !this.checkFlag(35) && (isCharmedBy("Mom") || wherePerson("Mom") != 154) && getHour() ==
			12 && this.checkFlag(18))
			if (makeCall(true, 272)) {
				this.setFlag(19);
				this.setFlag(35)
			}
		return false
	};
	per.getPersonSMS = function(id) {
		if (id == 270) return receiveSMS("Miku", "Something hot and wet awaits you when you are back home (&#94;__&#94;)", "mikusms1.jpg");
		if (id == 271) return receiveSMS("Miku", "It turns out, your sister does like something long and tasty to nibble on. We are leaving some for you. ( &#94; . &#x7E; )", "mikusms2.jpg");
		if (id == 272) return receiveSMS("Miku", "Me and Tracy will be in the Kitchen the next days during lunchtime, hope you find the time to join us.",
			"mikusms3.jpg");
		return ""
	}
}

function LoganAssignment() {
	var perL = findPerson("MissLogan");
	if (perL.other == 1) {
		perL.other = 2;
		perL.place = 9999
	}
}

function RepliesMissLogan(nR) {
	var myName = per.getYourNameFor();
	if (nR == 1) {
		if (per.other == 1) per.other = 2;
		bChat = false;
		addComments(per.addPersonFace());
		addComments('<p>"Good, I wish you luck with the project and don\'t forget to call if you need any help."</p>');
		per.place = 9999
	} else if (nR == 2) {
		if (per.other < 5) per.other = 5;
		PlaceI(5, 141);
		setPlaceKnown("AnatomyClassroom");
		per.place = 0;
		bChat = false;
		addComments(per.addPersonFace());
		addComments("<p>\"My favorite topic. Why don't you come to class later and I'll help you out?\"</p>")
	} else if (nR ==
		6) {
		if (per.other == 6) per.other = 7;
		addComments('<p>"Oh ' + myName + '. Are you here to discuss reproduction?"</p>')
	}
	return true
}

function initialiseMissLogan() {
	addPerson("Miss Logan", Math.random() < .5 ? 70 : 196);
	per.getPossessionFace = function() {
		return "logan-face"
	};
	per.Replies = RepliesMissLogan;
	per.getPersonName = function(full) {
		if (full === true) return this.name;
		return this.isCharmedBy() ? this.getCharmedLevel() == 1 ? this.name + ", your Slave" : this.name + ", your Breeder" : this.name
	};
	per.whereNow = function() {
		if (!isDay()) return 0;
		if (this.place == 196)
			if (!isShopOpen(4)) return 0;
			else return this.place;
		if (isDemonQuestDone() && getDay(true) == "Sun")
			if (this.other <
				5 || this.other >= 5 && this.getCharmedLevel() > 0) return 269;
		if (this.place == 70 && !isShopOpen(2)) return 0;
		return this.place
	};
	per.addPlaceImageLeft = function(lit) {
		if (isShopOpen(2) && Place == 70 && this.isHere() && this.other == 1) return this.showPerson("logan1b.jpg", "", "", "", "", false, "string");
		return ""
	};
	per.showPersonChat = function(bGeneral, md) {
		if (sType !== "") return;
		if (this.other == 1 && (isShopOpen(2) && this.place == 70 && Place == 70 || this.place == 196 && Place == 196 && isShopOpen(4))) {
			startAlternatives(md, "How do you respond to Miss. Logan");
			addQuestionC(md, "ask to do the neurology assignment", "MissLogan", 1);
			addQuestionC(md, "ask to do the reproductive assignment", "MissLogan", 2);
			endAlternatives(md)
		} else if (Place == 269 && this.isHere() && this.isCharmedBy()) addLinkToPlaceC(md, this.getCharmedLevel() == 1 ? "ask Miss Logan to participate in the 'club'" : "discuss water based reproduction with Miss Logan", Place, "type=loganxxx")
	};
	per.isPlaceImageRight = function() {
		if (this.other == 1 && this.whereNow() == 196 && sType === "" && Place == 196) {
			SetRightColumnSize("large");
			return true
		}
		return false
	};
	per.showPlaceImageRight = function(md) {
		this.showPerson("logan1d.jpg")
	};
	per.showEventPopup = function() {
		if (sType !== "") return false;
		if (Place == 70 && this.other == 7) this.other = 6;
		if (!isCharmedBy("MrsRobbins", "Davy") && getPersonOther("Tess") >= 10 && this.other === 0) {
			if (Place == 70 && isShopOpen(2) && this.place == 70) {
				this.other = 1;
				startTimedEvent("LoganAssignment()", 20);
				showPopupWindow("Miss Logan", this.addPersonString("logan1a.jpg", "height:max%", "right") + "In the hallway you see Miss. Logan your anatomy teacher, a teacher who most of her classes drool over her anatomy." +
					"<br><br>" + "She is a very casual teacher with an easy air of friendship who is happy to spend one-on-one time with her students. You have never heard any rumours about her, so strictly professional one-on-one time." + "<br><br>" + "You have been avoiding her, there is a project you must complete, but you have been more interested in your pursuit of the Kurndorf Book. " + "She told you many times that she sees something in you and thinks that you have a great talent in literature and biology and she prodded you way too many times to count to pursue this line of things. However, you never did care about the stuff she tried to ram into your head and overall, you were just too lazy to care about these boring topics. Then again, you are afraid of disappointing her and that\u2019s why you are trying to hide from her." +
					"<br><br>" + "Miss. Logan comes to a halt as she notices you and runs towards you. This is it! You\u2019re busted! You've got to think something up about that unmade project! Or maybe she wants something else and there\u2019s nothing to worry about? As you run through a series of options in your head Miss. Logan arrives right in front of you.");
				return true
			}
			if (Place == 196 && this.place == 196 && isShopOpen(4)) {
				this.other = 1;
				startTimedEvent("LoganAssignment()", 20);
				showPopupWindow("Miss Logan", this.addPersonString("logan1c.jpg",
						"height:max%", "right") + "As you step into the Restaurant you come across your anatomy teacher, a teacher who most of her classes drool over her anatomy. Miss. Logan dining alone, absorbed into her thoughts and doesn\u2019t recognise you at first. " + "She is casually dressed as usual, you would guess she is here get some food. One time your friend Catherine mentioned Miss Logan is fond of bratwurst, though as usual she implied that your teacher was fond of the long sausage more as a cock substitute!" +
					"<br><br>" + "Miss Logan is a very casual teacher with an easy air of friendship who is happy to spend one-on-one time with her students. You have never heard any rumours about her, so strictly professional one-on-one time." + "<br><br>" + "It\u2019s fortunate she has not noticed you because you are trying to avoid her, because there is a project you must complete, but you have been more interested in your pursuit of the Kurndorf  Book." + "<br><br>" + "You try to sneak past her as silently as you can without disturbing her, but all of a sudden she looks up and points a finger at you then motions you to come to her. You despondently walk towards her, knowing that there is a high chance that she will be angry with you over the undone project. " +
					"Now, what was it? Reproductive or Neurology topics that was assigned to you?")
			}
		}
		return false
	};
	per.showEvent = function() {
		var md;
		if (Place != 269 && Place != 234) return false;
		var bBreed = this.getCharmedLevel() == 2;
		if (sType == "recharmlogan1") {
			this.charmThem(2);
			md = WritePlaceHeader(false, "td-left-med");
			this.showPersonRorX("logan-pool-recharm" + (perYou.isMaleSex() ? "b" : "g") + ".jpg");
			addPlaceTitle(md, "Miss Logan Under A Charm Spell - Again");
			md.write("<p>Once again you cast the spell on your teacher, this time with the intent of further following up her talk of reproduction and breeding.</p>" +
				"<p>As you talk about this Miss Logan loses all control, but this is a public place. You tell Miss Logan you need to continue this in a more private place. She refits her bikini top and grabs your hand and drags you to the hotel front desk. She quick rents a room, and you see a knowing look on the person at the desk, while this is no 'love hotel' or one that rents by the hour, still they must get quite a number of people having private...lessons. Fortunately a room is available, not yet ready for a customer so the bed it still being readied and some other cleaning materials are around.</p>" +
				"<p>A little later you are in the room, Miss Logan tearing off her bikini....</p>");
			if (perYou.isMaleSex()) {
				this.setFlag(1);
				md.write("<p>You enjoy the pleasures of Miss Logan for the next twenty minutes, as she instructs you in the best positions and ways to maximise the chance of pregnancy.</p>" + "<p>After she seems confident you have successfully bred her, but that is more the influence of the spell on her mind. Still there is nothing stopping you trying again and again if she is not. As far as you know the charm spell does not affect the fertility of women you cast it on...</p>")
			} else md.write("<p>You enjoy the pleasures of Miss Logan for the next twenty minutes, and she instruct you in the best positions to increase the chance of pregnancy. She emphasises that if you orgasm it may increase the chance of conception. You had thought you had heard conflicting information on this, but Miss Logan is adamant, and besides she is very good at making you orgasm!</p>" +
				"<p>After she is a little disappointed that you could not breed her, and asks if you can arrange it with a friend of yours? It is impressive how the spell has shaped her mind, created this considerable desire, at leasts as far as you know the charm spell does not affect the fertility of women you cast it on...</p>");
			md.write("<p>As you dress you have to think that in all of the years of attending school you never dreamed that an anatomy lesson could be so much fun.</p>");
			startQuestionsOnly();
			addLinkToPlace(md,
				"return to the pool", 269);
			if (perYou.isMaleSex()) {
				AddRightColumn(md);
				AddImageRandom("GenericSex/creampie", 2)
			}
			WritePlaceFooter(md);
			return true
		}
		if (sType == "loganxxx") {
			md = WritePlaceHeader();
			this.showPerson(Place == 269 ? "logan13.jpg" : "logan8.jpg");
			addPlaceTitle(md, "Miss Logan");
			md.write("<p>&quot;I'm always ready to teach,&quot; says the teacher in heat. " + "&quot;All you have to do is ask and it is all yours.&quot;</p>");
			startQuestions();
			if (perYou.isMaleSex()) {
				addLinkToPlaceC(md, bBreed ? "breed Miss Logan" :
					'"How about a test on reproduction"', Place, "type=loganfuck");
				addLinkToPlaceC(md, bBreed ? "breasts are important for your breeder" : '"Teach me the purpose of breasts"', Place, "type=logantitfuck");
				addLinkToPlaceC(md, bBreed ? '"Get me ready to breed you"' : '"Can I have an oral exam"', Place, "type=loganbj")
			} else addLinkToPlaceC(md, bBreed ? '"Let\'s practice getting ready for breeding"' : '"Can I have an oral exam"', Place, "type=loganbj");
			if (Place == 269) addLinkToPlace(md, "return to the pool", 269);
			else addLinkToPlace(md,
				"exit the room", 70);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "loganbj") {
			md = WritePlaceHeader(false, Place == 269 && !isExplicit() ? "td-left-med" : "");
			if (Place == 269) this.showPersonRorX("logan16.jpg");
			else if (isExplicit())
				if (perYou.isMaleSex()) this.showPersonRandomX("logan10b", 2);
				else this.showPersonRandomX("logan6g", 2);
			else this.showPerson(perYou.isMaleSex() ? "logan10b.jpg" : "logan10g.jpg");
			addPlaceTitle(md, "Miss Logan");
			md.write("<p>Miss Logan examines you orally.</p>" + "<p></p>");
			if (Place == 269) addLinkToPlace(md,
				"return to the pool", 269);
			else addLinkToPlace(md, "exit the room", 70);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "logantitfuck") {
			md = WritePlaceHeader();
			if (Place == 269) this.showPersonRorX("logan14.jpg");
			else if (isExplicit()) this.showPersonRandomX("logan9", 2);
			else this.showPerson("logan9.jpg");
			addPlaceTitle(md, "Miss Logan");
			md.write("<p>Miss Logan demonstrates an important function of breasts.</p>" + "<p></p>");
			if (Place == 269) addLinkToPlace(md, "return to the pool", 269);
			else addLinkToPlace(md, "exit the room",
				70);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "loganfuck") {
			md = WritePlaceHeader();
			if (Place == 269)
				if (isExplicit())
					if (perYou.isMaleSex() && bBreed) this.showPersonRandomX("logan15", 2);
					else if (perYou.isMaleSex()) this.showPersonX("logan14.jpg");
			else this.showPersonRandomX("logan6g", 2);
			else if (perYou.isMaleSex() && bBreed) this.showPersonRandomX("logan15", 2);
			else if (perYou.isMaleSex()) this.showPerson("logan14.jpg");
			else this.showPerson("logan6g.jpg");
			else if (isExplicit())
				if (perYou.isMaleSex()) this.showPersonRandomX("logan6b",
					2);
				else this.showPersonRandomX("logan6g", 2);
			else if (perYou.isMaleSex()) this.showPersonRorX("logan6b.jpg");
			else this.showPerson("logan6g.jpg");
			if (bBreed && perYou.isMaleSex()) this.setFlag(1);
			addPlaceTitle(md, "Miss Logan");
			md.write("<p>Miss Logan gives you a practical test on methods of reproduction.</p>" + "<p></p>");
			if (Place == 269) addLinkToPlace(md, "return to the pool", 269);
			else addLinkToPlace(md, "exit the room", 70);
			WritePlaceFooter(md);
			return true
		}
		return false
	};
	per.showPersonTextHere = function(md) {
		if (isShopOpen(2) &&
			this.other == 1) md.write("<p>Miss Logan, your anatomy teacher, greets you in the hallway.</p><p>She asks which project you are interested in. The options are Neurology or The Reproductive System.</p>")
	};
	per.handleItem = function(no, cmd) {
		if (no == 14 && cmd == 2) {
			if (Place == 70 && this.isHere())
				if (this.other == 1) {
					if (isSpellKnown("Shielded Charm")) addComments("Even using Shielded Charm, it is really just too public here. It would be best to find a more private place.");
					else addComments("It is really just too public here. It would be best to find a more private place.");
					return "handled"
				}
			if (Place == 196 && this.isHere()) {
				if (!isSpellKnown("Shielded Charm")) addComments("Even using Shielded Charm, it is really just too public here. It would be best to find a more private place.");
				else addComments("It is really just too public here. It would be best to find a more private place.");
				return "handled"
			}
			if (Place == 234 && (this.other > 5 && this.other < 999)) {
				if (this.getCharmedLevel() == 2) addComments("Miss Logan is already under your charm spell, and she is focused on breeding and reproduction. You do not think you will be able to shake her of this obsession.");
				else if (this.getCharmedLevel() == 1) addComments("Miss Logan is already under your charm spell, but it is possible you may be able to firther discuss reproduction with her, but for some reason you think you will have to do this somewhere else...");
				else CastCharmSpell("MissLogan", 253, 1);
				return "handled"
			}
			if (Place == 269 && this.isHere()) {
				if (!isSpellKnown("Shielded Charm")) addComments("Don't cast the spell here. It is too public.");
				else if (!isCharmedBy("Bambi", "You")) addComments("You may need access to a room here at the hotel, and they are out of your price range. Talk to the staff first, well by talk, maybe more lie charm!");
				else CastCharmSpell("MissLogan", Place, 2, "", "", "type=recharmlogan1");
				return "handled"
			}
		}
		return ""
	}
}

function RepliesMom(nR) {
	var perMom = per;
	if (nR == 2600) {
		this.other = 1;
		addComments('"Hello honey.  How was your day today?" she asks, rolling her eyes slightly to let you know that her day wasn\'t one of her best.')
	} else if (nR == 2601) {
		AddCash(20);
		this.other = 2;
		addComments('"I suppose twenty ' + getCurrencyName() + ' is alright but you have to pay me back as soon as you get some more money."')
	} else if (nR == 2605) {
		this.other = 5;
		addComments('<p><i>You hand your shirt over and slip a new one on.</i></p><p>"These red stains look odd," says Mom. "I had better wash it straight away."</p>')
	} else if (nR ==
		2607) {
		AddCash(5);
		this.other = 9;
		if (!isPlaceKnown("ShoppingCenter")) setPlaceKnown("ShoppingCenter");
		addComments('"Sure, take five ' + (isBritish() ? "pounds" : "dollars") + " but don't forget to bring back the change.\"")
	} else if (nR == 2610) {
		this.other = 11;
		AddCash(20);
		if (!isPlaceKnown("ShoppingCenter")) setPlaceKnown("ShoppingCenter");
		addComments('"You always ask for money. Here, take ' + sCurrency + '20 to buy some groceries at the shops and you can keep the change for the taxi."')
	}
	if (nR == 5210) {
		var perK = findPerson("OfficerKhan");
		perK.charmed = 15;
		setPersonOther("Anita", 12);
		addComments('<p>"Oh, I just heard from the news room at work! That poor policewoman was shot in the back by that crazy woman Anita.  I heard that she was last seen in the park running away from the scene of the crime. I am not sure if the Officer is alive she was in a critical condition when they found her."</p>')
	}
	if (nR == 2900) {
		per.setFlag(8, false);
		if (wherePerson("Sarah") == 1)
			if (isConspiracyPath()) movePerson("Sarah", 192);
			else movePerson("Sarah", 17);
		if (getPersonOther("Sarah") ===
			0) setPersonOther("Sarah", 1);
		if (wherePerson("AdeleRoss") === 0) movePerson("AdeleRoss", 16);
		addComments('"Oh, have you heard about the Gates family? ' + perGates.getPersonNameShort() + "'s niece arrived from out of town and is staying at the mansion. There is lots of excitement at the estate.\"<br>")
	}
	if (nR == 14460) {
		movePerson("Jesse", 6);
		addComments('"Oh yes, just a little bit ago.  She was so nice I told her to wait in the living room for you.", she says.<br>')
	}
	if (nR == 2620) {
		this.setFlag(6);
		setPersonFlag("Kristin",
			12);
		addComments('"Well...I suppose I can be a guarantor for you as long as you promise to make all payments from your part-time job" She says and then she calls the bank to arrange for an appointment for you. She tells you "No appointment is needed you can visit the manager anytime you need to apply, but this is a single try!"<br>')
	}
	return true
}

function IncreaseMomsArousal(no, evt) {
	var perM = findPerson("Mom");
	if (perM.extra[0] == -1) return;
	if (no === undefined) no = 1;
	if (no == -1) {
		perM.extra[0] = -1;
		perM.setFlag(1, false);
		perM.setFlag(25)
	} else startTimedEvent("addMomsArousal(" + no + "," + evt + ")", 6)
}

function addMomsArousal(no, evt) {
	var perM = findPerson("Mom");
	if (perM.extra[0] == -1) return;
	if (no === undefined) no = 1;
	perM.extra[0] += no;
	perM.setFlag(1);
	if (evt !== undefined) perM.setFlag(evt)
}

function initialiseMom() {
	addPerson("Mom");
	per.Replies = RepliesMom;
	per.getPersonName = function(full) {
		return full === true ? "Mom" : "Your Mother"
	};
	per.getPersonAddress = function() {
		return "16 Kollam St, Glenvale"
	};
	per.isPersonInfo = function() {
		return true
	};
	per.getPersonInfo = function() {
		if (this.getCharmedLevel() == 1) return "<img src='Images/" + this.getImg("mom37.jpg") + "' style='width:30%;float:right;margin-left:5px' alt='Mom'>After all that had happened, you felt like it was the right choice to place Mom under your power as well. After all, she is now well protected from those who would want to take advantage of her, not to mention perfectly okay with whatever you do with your magic, including the charmed girls you bring home.</p><p>The two of you have yet to break the final taboo and become intimate, but she is clearly a lot less inhibited now. In fact, she went from just being unashamed of nudity to openly teasing and sometimes downright flirting with you and even Tracy, opting to often wear sexy outfits to work and little more than racy underwear inside the house, if anything all.";
		if (this.isCharmedBy()) return "<img src='Images/" + this.getImg("mom9-night.jpg") + "' style='width:30%;float:right;margin-left:5px' alt='Mom'>After what your Mom\u2019s been through it was the best for her to be brought under your power. You postponed the inevitable, but you knew since the beginning that you have to do this one day. It\u2019s not that bad if you think about it; you have your mother, who\u2019s always been a great Mom to you, ready to live her life fully. Not to mention that she\u2019s a definite MILF and an experienced lover, she can bring love and tenderness only a mother can do to her child.</p><p>Your Mom is sitting comfortably in her chair in her bedroom. As you come across her room she drags you in and kisses you, after the full on mouth to mouth action she asks you how day\u2019s going so far and slowly licks your ears seductively. She perfectly knows how to treat you!";
		return "<img src='Images/" + this.getImg("mom7-day.jpg") + "' style='width:30%;float:right;margin-left:5px' alt='Mom'>Your Mom, Alexandra, she is a production manager at the local TV station."
	};
	per.getArousal = function() {
		return this.extra[0]
	};
	per.getPossessionFace = function() {
		return "mom6a"
	};
	per.whereNow = function() {
		if (Place == 45 && getQueryParam("event") === "mombreakfast") return 45;
		return this.place
	};
	per.passTimeDay = function() {
		if (this.checkFlag(26)) this.setFlag(20);
		this.setFlag(16, false);
		if (Math.floor(this.hoursCharmed("skip") /
				24) >= 5 && this.checkFlag(19) && !this.checkFlag(32))
			if (!isCharmedBy("Gabby")) {
				if (!isMurderPath() && checkPersonFlag("Gabby", 7) && !checkPersonFlag("Gabby", 13)) return "";
				this.moveThem(998);
				movePerson("Gabby", 998)
			}
		return ""
	};
	per.passTimeNight = function() {
		if (this.checkFlag(14))
			if (this.place == 415) {
				this.place = 154;
				if (wherePerson("Gabby") != 347) movePerson("Gabby", 452);
				if (Place == 45 || Place == 46) return "You hear Mom return home from the T.V Station."
			}
		return ""
	};
	per.addPlaceImageLeft = function(lit) {
		if (getQueryParam("event") ===
			"mombreakfast") return this.showPersonString("mom30.jpg");
		return ""
	};
	per.showEventPopup = function() {
		if (sType == "momtaxi") {
			AddCash(-10);
			showPopupWindow("Mom's Help", "<img src='Images/" + (Place == 45 ? "momtaxi2.jpg" : "momtaxi1.jpg") + "' class='imgpopup' alt='Mom'>" + "<p>You find a taxi and explain your lack of money and that your Mom has promised to pay for it on arrival. The driver looks uncertain but eventually agrees to taking you, but not before threatening calling the police if you do not pay!</p><p>You arrive " +
				(Place == 45 ? "home and Mom is waiting outside with a smile and she pays the taxi driver." : "at the TV Station and Mom is waiting for you in the parking lot, she pays the taxi driver and is clearly annoyed at being disturbed, unusually so!") + "</p><p>You apologise to Mom and make a note in your phone to pay her back as soon as you can. She gives you a kiss and " + (Place == 45 ? "returns inside your home" : "heads back to work") + ".</p>");
			return true
		}
		if (this.place == 154 && this.checkFlag(14) && getHour() > 7 && getHour() <
			18) {
			var d = getDay(true);
			if (d != "Sat" && d != "Sun") {
				this.place = 415;
				if (wherePerson("Gabby") != 247) movePerson("Gabby", 415);
				if (sType === "" && (Place == 45 || Place == 46)) {
					WriteComments(this.addPersonFace() + "Mom gives you a kiss goodbye as she heads off to work");
					return true
				}
			}
		}
		if (sType === "" && Place == 45 && !this.checkFlag(15) && getHour() >= 6 && getHour() < 8 && this.isCharmedBy() && isCharmedBy("Tracy")) {
			showPopupWindow("Mom's Breakfast", "<img src='Images/" + this.getImg("mom29.jpg") + "' class='imgpopup' alt='Mom'>" + "<p>\u201cGood Morning, hun!\u201d Mom is up early and greets you wearing little more than a happy smile and some see-through lingery as you enter the kitchen.</p>" +
				"<p>\u201cYou've been working so hard off late, Ive felt the least I could do is make sure you'll get a hearty breakfast each morning, so just sit down and let your Mother pamper you a little.\u201d</p>" + "<p>She gives you a playful wink and turns around, leaning forward just enough to invitingly present her ass to you...</p>" + "<p>There are moments you just love being a " + perYou.getWitch(true), "setPersonFlag('Mom',15);dispPlace(45,'event=mombreakfast')", "", true);
			return true
		}
		if (sType == "momgabbyoffice2") {
			showPopupWindow("Mom and Gabby",
				"<img src='Images/People/Gabby/gabby-mom10.jpg' class='imgpopup' alt='Mom Gabby'>" + "\u201c" + perYou.getPersonName() + " is right.\u201d She states with a husky voice and begins to undress. \u201cI'm so horny I can barely work.\u201d</p>" + "<p>\u201cB... but...\u201d Gabby stammers, taken aback by Mom's boldness.</p>" + "<p>\u201cNo buts!\u201d Gabby's bra lands on the floor next to you. \u201cThe sooner we make each other cum the sooner we can get back to work.\u201d", "dispPlace(Place,'type=momgabbyoffice3')",
				"", true);
			return true
		}
		if (sType == "momgabbyoffice3") {
			showPopupWindow("Mom and Gabby", "<img src='Images/People/Gabby/gabby-mom11.jpg' class='imgpopup' alt='Mom Gabby'>" + "\u201cMom presses Gabby's head against her breasts before she is able to say anything else, and after a moment of hesitation, the smaller woman's tongue begins to play with her nipples.</p>" + "<p>\u201cYour... " + (perYou.isBornMale() ? "Son" : "Daughter") + " is still watching us, Alex...\u201d She whispers in-between licks, her body starting to tremble under Mom's firm touch.</p>" +
				"<p>\u201cAnd it turns you on that " + perYou.getHeShe() + " does.\u201d</p>" + "<p>That certainly was more of a statement than a question.", "dispPlace(Place,'type=momgabbyoffice4')", "", true);
			return true
		}
		if (sType == "momgabbyoffice4") {
			showPopupWindow("Mom and Gabby", "<img src='Images/People/Gabby/gabby-mom12.jpg' class='imgpopup' alt='Mom Gabby'>" + "What little cloth still remained quickly flies into various corners of the room, and while Gabby refused to comment on Mom's last words, her silence probably says it all.</p>" +
				"<p>When Mom finally goes down on her, your presence seems almost forgotten safe for occasional glances into your direction.</p>" + "<p>Gabby spreads her legs widely to make sure you have a good view, and as Mom begins to playfully flick her tongue over her assistance's little nub you realize: she is good at this...</p>" + "<p>Mom never spoke about having other lovers than your father, but she is definitely not doing this for the first time. Her tongue is skilled, and she knows exactly where to touch and stimulate another woman to the point that Gabby has a hard time to not scream her pleasure into the room. Mom brings her to climax in record time and with a satisfied smile on her lips as she gives you a knowing wink.",
				"WaitHereOnly(3)", "", true);
			return true
		}
		if (Place == 371 && sType == "byesuitcase") {
			showPopupWindow("Mom", "<img src='Images/" + this.getImg("mom15.jpg") + "' class='imgpopup' alt='Mom'>" + "This was... weird, to say the least. This isn't the first all-nighter Mom did during a busy week, and it's absolutely not like her to let it affect her. Not to mention, while she was always shameless when it came to her body, you don't recall her ever acting sexually or teasing towards you (Unlike Tracy).</p>" + "<p>And of course, the way she looked at Gabby didn't escape you either.</p>" +
				"<p>You are still contemplating what might be happening on your way to the reception area, but Nina catches your attention.</p>" + "<p>\u201cAnd she's, like, making a huge fuss out of some people seeing ghosts, you know?\u201d</p>" + "<p>\u201cYes! As if crazy people believing magic and ghosts and stuff is real are all that unusual in Glenvale... And now she's having the whole station in a buzz, keeping people on the field all day and...", 'dispPlace(371,"type=byesuitcase2")');
			return true
		}
		if (sType !== "") return false;
		if (Place == 415 && Math.floor(this.hoursCharmed("skip") / 24) >= 4 && this.checkFlag(26) && !this.checkFlag(32)) {
			showPopupWindow("Mom", "<img src='Images/radio-corridor.jpg' class='imgpopup' alt='Hall'>" + "You knock on the door once, then twice and finally a third time before one of the studio staff notices you.</p>" + "<p>\u201cThe manager and her assistant are out today, something about having to do important preparations.\u201d</p>" + "<p>It's strange, Mom didn't say anything about that, and when you ask where they are, he doesn't seem to know.</p>" +
				"<p>\u201cSorry, Miss Halliway tends to be secretive about these things, and of late she seems to have the manager wrapped around her finger so much she'll go along with everything, if you ask me.\u201d</p>" + "<p>\u201cThey have always made sure to be back by nightfall before the studio gets closed to finish their work, though.\u201d", "dispPlace(371)");
			return true
		}
		if (this.checkFlag(25) && this.checkFlag(3) && !this.checkFlag(27))
			if (!isAtLocation(45) && getPersonOther("Sarah") > 0 && isCharmedBy("Tina"))
				if (isMurderPath()) {
					if (getPersonCharm("OfficerKhan") >=
						15 || isDavyDefeated()) this.setFlag(27)
				} else this.setFlag(27);
		if (Place == 154 && this.isHere()) {
			if (!this.checkFlag(10)) {
				this.setFlag(10);
				showPopupWindow("Mom", "<img src='Images/" + this.getImg(isDay() ? "mom1a-day" : "mom1a-night") + ".jpg' class='imgpopup' alt='Mom'>" + "Your mother Alexandra, Alex to her friends and Mom to you, is one of the most precious thing in your life, next to Tracy. They have always been the closest ones to you, not just because they\u2019re family, but they were always there for you and support you in anything.</p>" +
					'<p>Mom is especially a real sweetheart, she even slapped another mom on the face because she called you  "a weirdo who creeps out the other kids" at the playground years ago.</p>' + "You can't really imagine what she would react if told her about your quest for the spells in the Book. You do want to share the experience and joy with her, tough. You want her to relax and have fun after she\u2019s been working hard for 25 years, she deserves some rest.");
				return true
			}
			if (perYou.isShot() && !this.checkFlag(12)) {
				this.setFlag(12);
				perYou.setInjury(4);
				AddCash(5);
				showPopupWindow("Tracy Looks Worried", "<img src='Images/" + this.getImg("momshot1.jpg") + "' class='imgpopup' alt='Mon'>" + "Mom looks like she has just got out of the shower, she just drops her towel and embraces you,</p>" + '<p>"' + perYou.getPersonName() + ' never do that again!", she is clearly upset, but you are a little distracted, she is after all completely naked. Then again she has little modesty around you and Tracy.</p>' + "<p>She lets you go and retrieves her towel, not covering herself but to start to dry herself off. As she does she asks you to tell her all about what happened. You do, well as much as you think you should...</p>" +
					'<p>When you finish Mom tells you "The police said that you were robbed before they found you...Here, take this ' + sCurrency + "5.00.  I know its not much, but at least you're not broke anymore.\"</p>");
				return true
			}
		}
		if (Place != 45 || this.place != 154) return false;
		if (!this.checkFlag(9) && isDay() && nFromPlace == 44) {
			showPopupWindow("A Delivery for Mom", "<img src='Images/People/Zoey/zoey0b.jpg' class='imgpopup' alt='Delivery Girl'>" + "<p>As you approach your front door, you see a cute delivery girl knocking on the door" +
				(checkPersonFlag("Madison", 8) ? ", the same girl from before" : "") + ". You ask her what she wants and she turns,<br><br>" + '"Hello, I have a document package from the TV Station", your mother often gets some papers delivered to your home. For some reason the TV Station refuses to embrace the online world. The delivery girl asks you to sign for the package and hands it to you.<br><br>' + (isSpellKnown("Charm") ? "Unfortunately the girl did not give her name and she is not wearing a name badge, so you cannot even consider trying to cast a spell on her, even if it was not quite so public here.<br><br>" :
					"") + "With her business done she leaves you, riding off on a small scooter towards the shopping center. You take the package inside to drop it off in your mother's room.", "setPersonFlag('Mom',9);dispPlace()");
			return true
		}
		var bTracyHere = wherePerson("Tracy") == 45 || wherePerson("Tracy") == 156;
		var perTess = findPerson("Tess");
		var perTanika = findPerson("MrsTanika");
		var perAnita = findPerson("Anita");
		var perMiku = findPerson("Miku");
		if (perTess.place == 45 && !perTess.checkFlag(7)) {
			showPopupWindow("", '<img src="Images/tess21.jpg" style="float:right;width:35%;margin-left:5px" alt="Tess">' +
				"<p style='text-align:center;margin-top:-12px;font-size:x-large'><b>Tess with Mom" + (bTracyHere ? " and Tracy" : "") + "</b></p>" + "As you enter the " + (nFromPlace == 44 ? "front door of your home" : "living room") + ", you hear some voices in conversation, your mother is talking to someone,</p>" + '<p>"...so your relationship with ' + perYou.getPersonName() + '"</p>' + '<p>"Yes, I love ' + perYou.getHimHer() + ' it was love at first sight!" and you recognise the voice as Mrs. Adams, that is Tess.</p>' + (bTracyHere ? '<p>"What do you see in my Little ' +
					(perYou.isBornMale() ? "Bro" : "Sis") + '?" you hear Tracy ask. Mom must have not heard Tracy clearly and quickly tells her "' + perYou.getPersonName() + ' is not yours only!"</p>' : "") + '<p>Mom continues, "What about your husband? But more to the point, why should we let you have ' + perYou.getPersonName() + '?", Mom has an odd sound to her voice, but she must be teasing Tess, so you step in and say "Mom please go easy on Tess!"</p>' + "<p>Tess sees you and almost leaps to her feet in her happiness, and immediately trips over. You smile and help your beautiful klutz to her feet as your mother " +
				(bTracyHere ? "and Tracy watch" : "watches") + ". Tess glances at her and to make a point embraces you and kisses you passionately.</p>" + '<p>Your mother tells Tess, "Well in that case you are welcome, visit any time you like", from her expression she seems to genuinely likes Tess.</p>' + '<p>Tess smiles at your mother and then looking you she says, "I will wait for you in your <i>bedroom</i>" and she leaves you with your mother. You mother looks at you and just says,<br><br>' + '"You are one lucky ' + perYou.getSex() +
				'"' + (bTracyHere ? '<p>Tracy adds "Unbelievably lucky!"</p>' : ""), "setPersonFlag('Tess',7);movePerson('Tess',46)");
			return true
		}
		if (perTanika.place == 45 && !perTanika.checkFlag(2) && !isDay()) {
			var clvT = perTanika.getCharmedLevel();
			var s = '<img src="Images/' + perTanika.getImg(this.isCharmedBy() ? "tanika12d" : "tanika12e") + '.jpg" style="float:right;width:40%;margin-left:5px" alt="Mom and Tanika"><p>' + (bTracyHere ? 'When you enter the lounge room Tracy greets you, "You are in trouble little ' + (perYou.isBornMale() ? "Bro" :
					"Sis") + ", one of your teachers is here! It is Mrs. Ice Queen, she is in Mom's bedroom with her\". She used a nickname she used for Mrs. Tanika back when she attended your school." : "You enter the lounge room and no one is there. You realise the noise is coming from your mothers's bedroom.") + "</p><p>You step towards the bedroom and you hear your Mom say something angrily but before you get there the door opens and Mrs. Tanika and your mother step out. Mom looks annoyed but when she sees you she looks a little embarrassed,</p>" +
				'<p>"' + perYou.getPersonName() + '! I was just..talking to your teacher...and...and she tells me that you promised that she could temporarily sleep here on our couch, something about an argument with her husband and how you offered. Really, you should ask me first, especially for <i>her</i>, I mean you should have asked!" she looks over at Mrs. Tanika. You remember in the past your mother had some arguments with Mrs. Tanika, some dispute when Mom was doing some volunteer work at the school. You would not be surprised it was just that they both have...forceful personalities. Mrs. Tanika smiles at you,</p><p>';
			if (clvT == 2) s += '"Well, ' + perYou.getPersonName() + " is a good student, except for " + perYou.getHisHer() + " grades, and I am sure I can tutor " + perYou.getHimHer() + " to repay, there are some " + (perYou.isBornMale() ? " particularly 'hard' problems" : "'oral' quizzes") + ' I can help with"</p>' + "<p>Mom still looks annoyed but finally agrees and she retreats to her room" + (bTracyHere ? " and Tracy chuckles and she goes into the kitchen to get some ice cream, asking if you want some too, but you are too distracted" :
				"") + '. Mrs Tanika leans over an whispers "I packed some lingerie, let me model them for you" and she heads over to your room.';
			else s += '"' + (!perYou.isBornMale() ? "Mistre..Miss" : "Master...Mister") + " " + perYou.getPersonName() + " is my best student and I am sure I can tutor " + perYou.getHimHer() + ' however they want of me"</p>' + '<p>Mom still looks annoyed, and surprised at the "best student" bit, your grades are not really that good. At least Mom did not seem to notice your slave\'s odd turn of phrase and finally agrees before she retreats to her room' +
				(bTracyHere ? " and Tracy looks curiously at Mrs. Tanika but she shrugs and goes into the kitchen to get some ice cream, asking if you want some too, but you are too distracted" : "") + '. Mrs Tanika leans over an whispers "' + perYou.getMaster() + ' I am yours, I will wait in your bedroom" and she heads over to your room.';
			showPopupWindow("Mrs Tanika with Mom" + (bTracyHere ? " and Tracy" : ""), s, "setPersonFlag('MrsTanika',2);movePerson('MrsTanika',46)", "color:black;background-color:white");
			return true
		}
		if (perAnita.place ==
			45 && !perAnita.checkFlag(9)) {
			showPopupWindow("Anita with Mom" + (bTracyHere ? " and Tracy" : ""), '<img src="Images/' + perAnita.getImg("anita9c.jpg") + '" class="imgpopup" alt="Anita">' + "As you enter the " + (nFromPlace == 44 ? "front door of your home" : "living room") + ", you hear your mother yelling,</p>" + '<p>"...sWhat do you mean, you only answer to ' + perYou.getPersonName() + '! This is my house you little..."</p>' + (bTracyHere ? '<p>Tracy quick interrupts "What Mom means is what is you relationship with my Little ' +
					(perYou.isBornMale() ? "Bro" : "Sis") + '?. Mom quickly tells Tracy "That\'s not what I meant!"</p>' : "") + '<p>You quickly decide that you must get involved and call out to Mom, "Mom, let me explain!", as you frantically try to work out how to explain Anita. Anita of course just makes it worse,</p>' + '<p>"Commander, I am here as you ordered!", ' + (bTracyHere ? "As one Mom and Tracy say" : "Mom exclaims") + ' Commander, ordered?"</p>' + '<p>You look pointedly at Anita, "Anita, very funny. Mom, Anita is a bit of a nut about military things and gets carried away. We are just working together on a history project at school about...militia organisations in the 20th century. If it is ok can she overnight sometimes, her home is under going major renovations?"</p>' +
				"Mom looks at you suspiciously, but she reluctantly agrees. You can tell, she really dislikes Anita, you will have to take care to not give her an excuse to kick Anita out of the house.</p>" + (bTracyHere ? "<p>Tracy adds \"I'm sure you will be working together on an <b>organ</b>isation. Well Commander Little " + (perYou.isBornMale() ? "Bro" : "Sis") + ', what are your orders?" and she laughs as she waves and goes into her room.</p>' : ""), "setPersonFlag('Anita',9);movePerson('Anita',46)", "background-color:white;color:black;text-shadow:-1px 0px white, 0px 1px white, 1px 0px white, 0px -1px white;");
			return true
		}
		if (perMiku.place == 408 && perMiku.checkFlag(6) && !perMiku.checkFlag(20) && Math.floor((nTime - perMiku.charmedTime) / 12) > 24) {
			showPopupWindow("Miku with Mom" + (bTracyHere ? " and Tracy" : ""), '<img src="Images/' + perMiku.getImg("miku9.jpg") + '" class="imgpopup" alt="Miku">' + "It looks like Mom has been interrogating Miku for a while when you return home, and they are still in full swing.</p>" + "<p>\u201cSo,\u201d you hear her voice from the living room. \u201cYou have been living with a friend who kicked you out and " +
				perYou.getPersonName() + " offered you to live in our attic so you don't have to move back in with your parents in Somerton?\u201d</p>" + "<p>\u201cThat is correct, Ma'am.\u201d</p>" + "<p>\u201cAnd you are not actually interested in each other?\u201d</p>" + "<p>You hear Miku giggle. \u201cWell, your " + (perYou.isBornMale() ? "son" : "daughter") + " is very attractive, as you surely know, but I believe that " + perYou.getHeShe() + " already has a lover, and I really need to focus on passing the final year and finding a source of income.\u201d</p>" +
				"<p>There is a short pause in which you are sure your Mom gives Miku a scrutinizing look, but in the end, she sounds pleased.</p>" + "<p>\u201cThat is a very responsible attitude, Ms. Nakamoto.\u201d</p>" + "<p>\u201cPlease, just call me Miku.\u201d</p>" + "<p>\u201cWell, Miku, Welcome to our home, and don't worry about the rent for now. We'll work something out.\u201d</p>" + "<p>You enter the living room just as both of them are about to leave it, and Mom takes you aside for a moment.</p>" + "<p>\u201cYour friend is really a well-behaved and polite young lady. I admit I had my doubts about her living here, but I think she will fit in just fine.\u201d</p>" +
				"<p>You look to Miku, who smiles back to you, and wonder for a moment if Mom really spoke to the same girl you got to know... but at least there will be no problem with her living here...</p>" + "<p>Well, for now.", "setPersonFlag('Miku',20)");
			return true
		}
		return false
	};
	per.showEventGabbysHome = function() {
		var md;
		var stage = getQueryParam("stage");
		if (sType === "" || sType == "freeingmom") {
			md = WritePlaceHeader();
			this.showPerson("mom16.jpg");
			addPlaceTitle(md, "Mom");
			md.write("<p>Mom is calmly kneeing in Gabby's living room, her eyes vacant and her body unmoving, waiting for Gabby to return. She looks confused when she sees you instead, but otherwise barely acknowledges your presence.</p>" +
				"<p>You address her, and she reacts with an affirming hum, her voice calm and her mind open, it would be easy to just undo Gabby's programming now and return her, mostly, to her old self, on the other hand... her mind is completely defenseless now... and putting her under your spell would allow you to... protect her.</p>");
			startQuestionsOnly();
			switch (stage) {
				case "":
					addQuestionR(md, "speak to her", '"Can you hear me, Mom?"</p>' + '<p>"...Yes."</p>' + "<p>Mom stirs as you address her, but remains in trance, her body swaying slightly.</p>" +
						'<p>"How do you feel?"</p>' + '<p>"I feel good. Very sexy... and submissive." She mumbles the words with a dazed smile, adding after a moment. "A sexy woman obeys her mistress, after all."', "", "setQueryParams(\\'type=freeingmom&stage=stage2\\')");
					break;
				case "stage2":
					addQuestionR(md, "wake her up", "If you wake her up now Mom will still be Gabby's slave, and you don't really know if she'll allow you to put her under again.</p>" + "<p>Better to make sure either free of Gabby's influence or otherwise protected. ",
						"", "setQueryParams(\\'type=" + sType + "&stage=stage3\\')");
					break
			}
			addLinkToPlaceC(md, "leave for now", 38);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "momnecklace" || sType == "momnecklacemaster") {
			md = WritePlaceHeader();
			this.setFlag(32);
			this.showPerson("mom16.jpg");
			addPlaceTitle(md, "Freeing Mom");
			md.write("<p>Mom's attention focuses on the little trinket, her eyes following it's every move. \u201cMistresses Necklace...\u201d Her lips form a dazed smile. \u201dMakes me feel... tingly.\u201d</p>" + "<p>\u201cIt's mine now.\u201d You explain. \u201cMiss Halliway has become my " +
				(getCharmedLevel("Gabby") == 4 ? "Slave" : "Lover") + " and gave it to me.\u201d</p>" + "<p>Mom's head rolls to the side, even more confused now.</p>");
			startQuestionsOnly();
			if (sType != "momnecklacemaster") {
				startAlternatives(md);
				addLinkToPlaceC(md, '"I am your ' + perYou.getMaster() + ' now"', Place, "type=momnecklacemaster", "\u201cNo, you are not.\u201d</p><p>Well, that was a surprisingly firm answer for someone who is in a highly suggestible state of mind.</p><p>\u201cI can not... with my own " + (perYou.isBornMale() ?
					"Son" : "Daughter") + ". Would be... wrong.\u201d</p><p>Mom's body stirs, and you notice a spark of awareness in her eyes. You consider pushing further, but the trance alone seems to not be enough to make her break that last taboo.");
				addLinkToPlaceC(md, '"Forget everything Gabby told you and be yourself again"', Place, "type=momnecklacefree");
				endAlternatives(md)
			} else addLinkToPlaceC(md, "leave for now", 38);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "momnecklacefree") {
			md = WritePlaceHeader();
			this.showPerson("mom16.jpg");
			addPlaceTitle(md, "Freeing Mom");
			md.write("<p>You slowly swing the necklace from side to side in a steady rhythm, waiting for Mom's eyes to be completely focused on its movements.</p>" + "<p>\u201cThings have changed, you do not desire Gabby, and you are not submissive to anyone.\u201d</p>" + "<p>\u201cBut... A sexy woman obeys her mistress...\u201d She repeats her mantra yet again, and you shake your head.</p>" + "<p>\u201cA sexy woman does what she wants and has fun.\u201d</p>" + "<p>\u201cI'd... like to have fun... again.\u201d She smiles.</p>" +
				"<p>\u201cThat's right, you just focus on enjoying life, there is no need to submit to anyone for that, you are in charge.\u201d</p>" + "<p>\u201cI am in charge...\u201d The last one seems to resonate especially well with her, as expected.</p>" + "<p>\u201cYou are... right... stupid to... forget that.\u201d</p>" + "<p>\u201cAnd you'll remind Gabby that you are in charge when you see her?\u201d</p>" + "<p>\u201cYes, " + perYou.getPersonName() + ". I am in charge I am a sexy woman in charge of her own life.\u201d</p>" +
				"<p>Well, that must be days of mental reprogramming undone with a simple reminder just how much Mom likes to be on top.</p>");
			startQuestionsOnly();
			addLinkToPlaceC(md, "count to three and wake her up", Place, "type=momnecklacefree2");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "momnecklacefree2") {
			md = WritePlaceHeader();
			this.showPerson("mom17.jpg");
			this.setFlag(14);
			addPlaceTitle(md, "Mom Freed");
			md.write("<p>\u201cOh... I think I dozed off. Where...\u201d Mom looks around in confusion, and quickly closes her blouse \u201c" +
				perYou.getPersonName() + "? Why are you here?\u201d</p>" + "<p>You tell her that Gabby has told you to check on her, and make up a story about how she was really tired and needed a quiet place to rest.</p>" + "<p>\u201cIs that... so?\u201d Mom obviously doesn't remember any of it happening. \u201cThe long times really must be getting to me, I better tell Gabby that I have to cut back a little.</p>");
			startQuestionsOnly();
			addLinkToPlaceC(md, "sounds like a good idea", 38, "", "\u201cI agree. But for now, I need to finish things up at work.\u201d Mom rises to her feet. \u201cThank you for checking up on me, honey. I'll appreciate it.</p><p>You two trade kisses to the cheek and Mom walks out of the door with the promise to cook something nice for you and Tracy tonight.</p><p>You'll may have to come clear with her about what is happening sooner or later, and maybe find a way to protect her without, but for now, you are happy that she is still herself.</p><p>You follow her out of the house to check on other things.",
				"", "movePerson('Mom',154);movePerson('Gabby',452)");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "momghcharm1") {
			md = WritePlaceHeader();
			this.showPerson("mom18.jpg");
			this.setFlag(1, false);
			this.setFlag(14);
			this.charmedTime = 0;
			addPlaceTitle(md, "Mom Under A Charm Spell");
			md.write("<p>Mom's body is twitching under the sudden surge of arousal building inside her, and your heart beats faster as she subtly shifts position to spread her legs some more.</p>" + "<p>\u201cSo... hot...\u201d</p>" + "<p>It's working. Her back straightens, and her blouse slips down as she rolls her shoulders back to push her chest forward with an audible gasp, but she is still in trance, defenseless and acting completely on instinct.</p>" +
				"<p>\u201cWhat... is happening?\u201d</p>" + "<p>Her eyes focus on you, and even with her mind the way it is you can see the struggle between her growing desire and her subconscious telling her that something is very wrong, and maybe it is...</p>" + "<p>Maybe you should leave it at that.</p>" + "<p>She is protected against the likes of Gabby, Davy and Legion.</p>" + "<p>She will be very accepting of whatever you do with your magic.</p>" + "<p>There is no need to go any further, unless...</p>");
			startQuestionsOnly();
			startAlternatives(md);
			addLinkToPlaceC(md, "stop here, there are lines that should not be crossed", Place, "type=momghcharmmin1");
			addLinkToPlaceC(md, "go all the way", Place, "type=momghcharmfull1");
			endAlternatives(md);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "momghcharmmin1") {
			md = WritePlaceHeader();
			this.charmThem(1);
			this.showPerson("mom19.jpg");
			addPlaceTitle(md, "Mom Under A Charm Spell");
			md.write("<p>You tell your Mom to not be alarmed. The last days have been stressful, and she just needs to relax.</p>" +
				"<p>\u201cRelax...\u201d Mom smiles, her posture easing up.</p>" + "<p>\u201cThat's right, you do not desire Gabby, and you do not desire me. You are not submissive to anyone.\u201d</p>" + "<p>\u201cA sexy woman obeys her mistress...\u201d She repeats her mantra yet again, and you shake your head.</p>" + "<p>\u201cA sexy woman does what she wants and has fun.\u201d</p>" + "<p>\u201cI'd... like to have fun... again.\u201d She smiles.</p>" + "<p>\u201cThat's right, you just focus on enjoying life, there is no need to submit to anyone for that, you are in charge.\u201d</p>" +
				"<p>\u201cI am in charge...\u201d The last one seems to resonate especially well with her, as expected.</p>" + "<p>\u201cYou are... right... stupid to... forget that.\u201d</p>" + "<p>\u201cAnd you'll remind Gabby that you are in charge when you see her?\u201d</p>" + "<p>\u201cYes, " + perYou.getPersonName() + ". I am in charge I am a sexy woman in charge of her own life.\u201d</p>" + "<p>Well, that must be days of mental reprogramming undone with a simple reminder just how much Mom likes to be on top.</p>");
			startQuestionsOnly();
			addLinkToPlaceC(md, "count to three and wake her up", Place, "type=momghcharmmin2");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "momghcharmmin2") {
			md = WritePlaceHeader();
			this.showPerson("mom27.jpg");
			addPlaceTitle(md, "Mom Under A Charm Spell");
			md.write("<p>\u201cOh... I think I dozed off. Where...\u201d Mom looks around in confusion, not bothering to close her blouse. \u201c" + perYou.getPersonName() + "? Why are you here?\u201d</p>" + "<p>You tell her that Gabby has told you to check on her, and make up a story about how she was really tired and needed a quiet place to rest.</p>" +
				"<p>\u201cIs that... so?\u201d Mom obviously doesn't remember any of it happening, but it doesn't look like she is particularly bothered by it.</p>" + "<p>\u201cWell, thanks for checking on me, I'm feeling good... great even.\u201d Mom smiles. \u201cI think we are also nearing the end of our crunch, so I'll be home a bit more.\u201d</p>");
			startQuestionsOnly();
			addPopupLink(md, "looking forward to it", "Leaving", '<img src="Images/' + this.getImg("mom26.jpg") + '" class="imgpopup" alt="Mom">' + "\u201cMe too. But for now, I need to finish things up at work.\u201d Mom rises to her feet and begins walking towards the door as she is, only stopping when you remind her to close her blouse and pull up her pants.</p>" +
				"<p>\u201cOh right, we don't want anyone to see something naughty.\u201d She gives you a... playful wink. \u201cI'll see you at home tonight and make sure to cook something nice.", false, "movePerson('Mom',154);movePerson('Gabby',452);dispPlace(38)");
			WritePlaceFooter(md);
			return true
		}
		if (sType.indexOf("momghcharmfull") != -1 && this.charmedTime > 3 && !this.isCharmedBy() || sType == "momghcharmfail1") {
			this.charmThem(1);
			setQueryParams("type=momghcharmfail1");
			md = WritePlaceHeader();
			this.showPerson("mom18.jpg");
			addPlaceTitle(md,
				"Too far - Mom Partly Under A Charm Spell");
			md.write("<p>\u201cNo.\u201d</p>" + "<p>Something is not right, Mom doesn't even allow you to finish speaking, and her eyes are no longer on the necklace.</p>" + "<p>\u201cI know that it is common for teenagers to lust after their parents or siblings, but we can not go that far, no matter how much I... how much you want it.\u201d</p>" + "<p>You pushed too hard. She has clearly broken the trance, and even in her highly aroused state, she manages to look at you sternly, blocking any attempt to explain yourself.</p>");
			if (this.checkFlag(29)) md.write("<p>\u201cNo backtalk!\u201d She interrupts you again. \u201cYou have your sister. I know how intimate you two have become, and I am willing to turn a blind eye to it, no matter how hot... I mean, how wrong it is what you two... do.\u201d She shudders blissfully from the memory, but remains dead set in her ways. \u201cBut I am off limits your desires, understood?\u201d</p>");
			else md.write("<p>\u201cNo backtalk!\u201d She interrupts you again. \u201cYou have other girls around you, like that cute, sexy blonde who...\u201d She trails off as if her mind remembers something for a second, pulling in her lower lip briefly before speaking on. \u201cWho visited us.\u201d</p><p>\u201cBut I am off limits your desires, understood?\u201d</p>");
			md.write("<p>\u201cYes Mom.\u201d</p>" + "<p>It's the last word Mom is willing to speak of it. The spell clearly worked, you can feel the effect within her, but the time when you are able to influence her the most has passed and you doubt you can get her to break the last Taboo, now.</p>" + "<p>And maybe that's even for the best.</p>");
			startQuestionsOnly();
			addLinkToPlaceC(md, "let her get dressed and ready to leave", Place, "type=momghcharmfail2");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "momghcharmfail2") {
			md =
				WritePlaceHeader();
			this.showPerson("mom26.jpg");
			addPlaceTitle(md, "Too far - Mom Partly Under A Charm Spell");
			md.write("<p>Whatever hard feelings Mom may have are quickly forgotten. You tell her that Gabby has told you to check on her, and make up a story about how she was really tired and needed a quiet place to rest, and how you just found her the way she was.</p>" + "<p>Mom obviously doesn't remember any of it happening, but it doesn't look like she is particularly bothered by it.</p>" + "<p>\u201cWell, thanks for checking on me, I'm feeling good... great even.\u201d Mom smiles. \u201cI think we are also nearing the end of our crunch, so I'll be home a bit more.\u201d</p>");
			startQuestionsOnly();
			addPopupLink(md, "looking forward to it", "Leaving", '<img src="Images/' + this.getImg("mom26.jpg") + '" class="imgpopup" alt="Mom">' + "\u201cMe too. But for now, I need to finish things up at work.\u201d Mom rises to her feet and begins walking towards the door as she is, only stopping when you remind her to close her blouse and pull up her pants.</p>" + "<p>\u201cOh right, we don't want anyone to see something naughty.\u201d She gives you a... playful wink. \u201cI'll see you at home tonight and make sure to cook something nice.",
				false, "movePerson('Mom',154);movePerson('Gabby',452);dispPlace(38)");
			WritePlaceFooter(md);
			return true
		}
		var q1 = getQueryParam("q1");
		var q2 = getQueryParam("q2");
		var q3 = getQueryParam("q3");
		if (sType == "momghcharmfull1") {
			md = WritePlaceHeader();
			this.showPerson("mom18.jpg");
			addPlaceTitle(md, "Mom Under A Charm Spell");
			md.write("<p>No, you want more.</p>" + "<p>You have to finally admit it to yourself: You didn't just cast that spell to protect her, you did it for the same reason you always do: You want to claim this woman as your own, dominate her mind and do things with her no " +
				(perYou.isBornMale() ? "son" : "daughter") + " should want to do with " + perYou.getHisHer() + " mother.</p>" + "<p>And why should you not? She is quite attractive and has never been shy about it around you, so it's only natural to desire her... right?</p>" + "<p>You let this thought rest in your head for a moment. Did you always have these... feelings and just never dared to act on them or did they develop recently after you have learned to use magic?</p>" + "<p>It doesn't mater, you have made your decision, and you will follow up on it, of course, that may be easier said than done.</p>" +
				"<p>Mom can be stubborn. She wants to always be in charge and incest is a big taboo to break through. You will need to choose your words a lot more carefully than you usually do.</p>");
			startQuestionsOnly();
			if (q1 != "asked") addLinkToPlaceC(md, '"Everything is fine, just relax"', Place, "type=momghcharmfull1&q1=asked&q2=" + q2 + "&q3=" + q3, "\u201cEverything... fine... okay...\u201d Mom smiles to you, her posture changing subtly.", "Mom");
			if (q2 != "asked") addLinkToPlaceC(md, "\u201dYou want to do what I say.\u201d",
				Place, "type=momghcharmfull1&q1=" + q1 + "&q2=asked&q3=" + q3, "\u201cNo...\u201d She says firmly. \u201cI'm not taking... orders... from.... my own kids.\u201d</p><p>Even now she has to be in charge? Damn...", "Mom", "findPerson('Mom').charmedTime++");
			if (q3 != "asked") addLinkToPlaceC(md, '"I want to fuck you, now!"', Place, "type=momghcharmfull1&q1=asked&q2=" + q2 + "&q3=asked", "\u201cWhat!?!\u201d Mom's eyes rush open.</p><p>\u201cYou can't be serious young " + (perYou.isBornMale() ? "Man" : "Lady") + ", you and I will have to... have to...</p><p>The pink glow in her eyes flares up, and she focuses her attention back on the necklace, slowly drifting back into her trance.</p><p>\u201c...talk... later...\u201d</p><p>That was too close, without the spell she would have surely woken up and even like this you know she'll be a lot more guarded against the idea of incest.</p><p>Brute force is not going to help you here.",
				"Mom", "findPerson('Mom').charmedTime++");
			addLinkToPlaceC(md, "\u201dI think you are very sexy, I could look at your body all day.\u201d", Place, "type=momghcharmfull2");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "momghcharmfull2") {
			md = WritePlaceHeader();
			this.showPerson("mom18.jpg");
			addPlaceTitle(md, "Mom Under A Charm Spell");
			md.write("<p>Mom blushes slightly. \u201cThanks, but you... shouldn't... It's wrong...\u201d She stirs a little, but it doesn't look like she is waking up</p>");
			startQuestionsOnly();
			if (q1 != "asked") addLinkToPlaceC(md, '"Id love to do a lot of \u201cwrong\u201d things with you"', Place, "type=momghcharmfull2&q1=asked&q2=" + q2 + "&q3=" + q3, "Mom's body twitches,.\u201cNo... not in this case... not with your own...\u201d Her eyes are showing awareness, and you quickly roll back.</p><p>\u201cIt's alright, just relax, you will not have to do anything \u201cwrong\u201d, Mom.\u201d</p><p>\u201cNot do... anything wrong.... okay...\u201d</p><p>Phew, that was close, you need to be more careful.",
				"Mom", "findPerson('Mom').charmedTime++");
			if (q2 != "asked") addLinkToPlaceC(md, "\u201dHow can it be wrong when it feels so right?\u201d", Place, "type=momghcharmfull2&q1=" + q1 + "&q2=asked&q3=" + q3, "\u201cDoesn't... feel right... feels wrong you should stop, I should...\u201d</p><p>Mom attempts to cover herself, but you quickly interrupt her, telling her to focus back on the necklace and relax.</p><p>\u201cI should... relax... not worry... A sexy woman is not ashamed of her body...\u201d</p><p>That was a close call. You'll have to wear down her resistance first.\u201d",
				"Mom", "findPerson('Mom').charmedTime++");
			if (q3 != "asked")
				if (this.checkFlag(28)) addLinkToPlaceC(md, "So was watching me and Tracy\u201d", Place, "type=momghcharmfull3");
				else addLinkToPlaceC(md, "\u201dI can't help it, you keep teasing me\u201d", Place, "type=momghcharmfull3");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "momghcharmfull3") {
			md = WritePlaceHeader();
			this.showPerson("mom18.jpg");
			addPlaceTitle(md, "Mom Under A Charm Spell");
			if (this.checkFlag(28)) md.write("<p>\u201cMy beautiful children...\u201d Her mind seems to drift off into the memory \u201cSo sexy... but... it wasn't right...\u201d</p>" +
				"<p>\u201cShould have stopped them...\u201d She looks rather uncomfortable, so you proceed carefully.</p>" + "<p>\u201cBut you didn't, why not?\u201d</p>" + "<p>\u201cSo... sexy... Had to... watch, had to...\u201d Her blush deepens. \u201cTouch myself.\u201d She breathes in to calm herself. \u201cI am... a bad mother. \u201c</p>");
			else md.write("<p>\u201cI... I am...?\u201d</p>" + "<p>\u201cYes, you keep showing off your sexy body around the house, how could I not desire you?\u201d</p>" + "<p>\u201c...\u201d Mom is silent, contemplating your words.</p>" +
				"<p>\u201cYou are a sexy woman who is not ashamed of her beautiful body. It is only natural for me to want you.\u201d</p>" + "<p>\u201c...\u201d</p>" + "<p>\u201cI shouldn't... I'm a bad mother...\u201d</p>");
			startQuestionsOnly();
			if (q1 != "asked") addLinkToPlaceC(md, "\u201dYou are a great mother!\u201d", Place, "type=momghcharmfull3&q1=asked&q2=" + q2 + "&q3=" + q3, "\u201cThank you... but...\u201d She hesitates.</p><p>\u201c...but these feelings... they are.... wrong...\u201d", "Mom");
			if (q2 != "asked") addLinkToPlaceC(md,
				'"Sometimes it\'s good to be bad"', Place, "type=momghcharmfull3&q1=" + q1 + "&q2=asked&q3=" + q3, "\u201cNo!\u201d</p><p>That was surprisingly firm.</p><p>\u201cCan't... shouldn't...\u201d</p><p>This was clearly the wrong approach, you manage to calm her before she wakes up, but she is likely more guarded now.", "Mom", "findPerson('Mom').charmedTime++");
			if (q3 != "asked") addLinkToPlaceC(md, '"Having needs is not "bad""', Place, "type=momghcharmfull4");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "momghcharmfull4") {
			md =
				WritePlaceHeader();
			this.showPerson("mom18.jpg");
			addPlaceTitle(md, "Mom Under A Charm Spell");
			md.write("<p>You assure her that there is nothing wrong with what she feels, that she is a sexy, confident woman, and should not be worried if someone desires her, even if it's her own children.</p>" + "<p>\u201cA sexy woman is not afraid to show off her sexuality...\u201d She repeats another part of her Mantra with a smile.</p>" + "<p>\u201cAnd it's okay if you return those feelings. It is only natural to be physically attracted to those you love, and you do love your children.\u201d</p>" +
				"<p>\u201cSo... proud of them...\u201d Mom has a wide smile on her lips. \u201cSuch good... kids...\u201d</p>");
			startQuestionsOnly();
			if (q1 != "asked") addLinkToPlaceC(md, "\u201dKids who have sexual needs their mother should fulfil\u201d", Place, "type=momghcharmfull4&q1=asked&q2=" + q2, "\u201cWhat? No!\u201d Mom stirs. \u201cI don't... I won't...\u201d</p><p>You pushed her too quickly, and if not for the charm muddling her thoughts and the necklace keeping her mind focused, she might even have awoken from her trance...</p><p>Better be more careful.",
				"Mom", "findPerson('Mom').charmedTime++");
			if (q2 != "asked") addLinkToPlaceC(md, "\u201cKids who have become attractive grown-ups.\u201d", Place, "type=momghcharmfull5");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "momghcharmfull5") {
			md = WritePlaceHeader();
			this.showPerson("mom18.jpg");
			addPlaceTitle(md, "Mom Under A Charm Spell");
			md.write("<p>\u201c...yes.\u201d Mom hesitates before answering.</p>" + "<p>\u201cSexy, even. Just like their mother.\u201d</p>" + "<p>\u201c...\u201d</p>" + "<p>\u201cYes.\u201d</p>" + "<p>\u201cAnd it is not unnatural to be attracted to someone sexy, so there is nothing to be ashamed off.\u201d</p>" +
				"<p>\u201cNo... It's not\u201d</p>" + "<p>\u201cEven if they are family.\u201d</p>" + "<p>Mom stirs again, something in her still fighting the idea, but she agrees.</p>" + "<p>\u201cNo... being attracted to family... is nothing to be ashamed off.\u201d</p>" + "<p>This feels like a breakthrough, maybe you can push her a little more.</p>");
			startQuestionsOnly();
			if (q1 != "asked") addLinkToPlaceC(md, "ask her to suck your " + (perYou.isMaleSex() ? "cock" : "clit"), Place, "type=momghcharmfull5&q1=asked&q2=" + q2 + "&q3=" + q3,
				"\u201cI would never...!\u201d Young " + (perYou.isBornMale() ? "Man" : "Lady") + ", how can you even... think... that... ahhhh.\u201d</p><p>You needed to intensify the effect of the spell to scatter her focus this time, and even as her eyes return to the swinging Necklace, they clearly show more awareness than before.", "Mom", "findPerson('Mom').charmedTime++");
			if (q2 != "asked") addLinkToPlaceC(md, "ask her to do a backflip", Place, "type=momghcharmfull5&q1=" + q1 + "&q2=asked&q3=" + q3, "Mom just stares at you in a mix of confusion and annoyance, and you have to admit that this was a really dumb joke.");
			if (q3 != "asked") addLinkToPlaceC(md, "ask her to undress", Place, "type=momghcharmfull6");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "momghcharmfull6") {
			md = WritePlaceHeader();
			this.showPerson("mom20.jpg");
			addPlaceTitle(md, "Mom Under A Charm Spell");
			md.write("<p>\u201cWell... We are family...\u201d</p>" + "<p>Mom removes her jeans and blouse, and while you have seen her naked many times, this time it is different.</p>" + "<p>She is actively posing for you, pressing her chest out and letting the straps of her bra fall down her shoulders, her eyes showing hints of her awareness returning, but also barely restrained desire.</p>" +
				"<p>\u201cThis is... more comfortable...\u201d</p>" + "<p>\u201cAnd Sexy.\u201d You add.</p>" + "<p>\u201cYes... sexy...\u201d</p>");
			startQuestionsOnly();
			if (q1 != "asked") addLinkToPlaceC(md, '"You are a bit of an exhibitionist slut, are you not?"', Place, "type=momghcharmfull6&q1=asked&q2=" + q2 + "&q3=" + q3, "\u201cI am an exhibitionist...\u201d Mom Stops mid sentence. \u201cI am NOT a slut!\u201d</p><p>Her eyes sharpen in outrage.</p><p>\u201cHow can you even say something like that to your own mother? I should.... should...\u201d</p><p>\u201cYou should focus on the necklace, forget what I just said.\u201d</p><p>\u201cFocus... on necklace... forget...\u201d</p><p>This was too close, you should have known that Mom reacts badly to being called a slut...",
				"Mom", "findPerson('Mom').charmedTime++");
			if (q2 != "asked") addLinkToPlaceC(md, '"There is nothing as sexy as a woman who is not afraid to show her sexuality.."', Place, "type=momghcharmfull5&q1=" + q1 + "&q2=asked&q3=" + q3, "\u201cThere is nothing as sexy as a woman who is not afraid to show her sexuality...\u201d Mom calmly repeats this part her Mantra, falling a bit deeper back into her trance but not making any progress.");
			if (q3 != "asked") addLinkToPlaceC(md, '"Do you like it when me and Tracy look at your naked body?"',
				Place, "type=momghcharmfull7");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "momghcharmfull7") {
			md = WritePlaceHeader();
			this.showPerson("mom20.jpg");
			addPlaceTitle(md, "Mom Under A Charm Spell");
			md.write("<p>There is a moment of hesitation before she answers.</p>" + "<p>\u201cYes...\u201d</p>" + "<p>\u201cIn fact you want them to, right? You like to feel sexy, to feel desired.\u201d</p>" + "<p>\u201cYes.... but... I shouldn't...\u201d</p>" + "<p>\u201cLook at the necklace, and repeat it again: being attracted to family members is nothing to be ashamed off.\u201d</p>" +
				"<p>\u201cBeing attracted to.... family is nothing to be ashamed off.\u201d</p>" + "<p>\u201cAnd it's only natural to desire more, to want to be closer.\u201d</p>" + "<p>\u201cOnly natural... to want more... to be close.\u201d</p>" + "<p>Her bra slips down, and you are pretty sure you nearly have her, only one final push.</p>");
			startQuestionsOnly();
			addLinkToPlaceC(md, "show her that she wants more", Place, "type=momghcharmfull8");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "momghcharmfull8") {
			md = WritePlaceHeader();
			this.showPerson("mom21.jpg");
			addPlaceTitle(md, "Mom Under A Charm Spell");
			md.write("<p>\u201cI... not some... hussy lusting after her own " + (perYou.isBornMale() ? "Son" : "Daughter") + ".... no matter how... attractive " + perYou.getHeShe() + " grew up to be.\u201d</p>" + "<p>\u201cBut you are showing off to me now.\u201d</p>" + "<p>\u201cJust... more comfortable... I...\u201d</p>" + "<p>\u201cYou have masturbated to the thought of me having sex with Jesse.\u201d</p>" + "<p>\u201c...\u201d Mom is silent, but her underwear is stained by wetness and her breathing quick and erratic.</p>");
			if (this.checkFlag(28)) md.write("<p>\u201cYou have watched me and Tracy, and it aroused you.\u201d</p>" + "<p>\u201cIt... did...\u201d Mom blushes heavily now.</p>");
			md.write("<p>\u201cYou need to be true to your feelings, Mom. Your children are grown-ups, now, and just like you, they have needs and desires, just like you. And no one should be ashamed of their desires.\u201d</p>" + "<p>\u201cYes... no one... should be ashamed... among family...\u201d</p>");
			startQuestionsOnly();
			if (q1 != "asked") addLinkToPlaceC(md,
				"tell her she is a slave to your desires.", Place, "type=momghcharmfull8&q1=asked&q2=" + q2, "\u201cI am a slave to... what?!\u201d Mom's eyes rush open.</p><p>\u201cYoung " + (perYou.isBornMale() ? "Man" : "Lady") + ", this is not going to happen, I am... am... ahhh...\u201d</p><p>You actually have to bring her close to orgasm this time to get her to calm down, and it takes you even longer to get her to focus back on the necklace. Just how did Gabby do this?</p><p>It may just be easier to get her to submit to her coworker than to her kids... after all, Mom always makes it clear she is in charge around the house...",
				"Mom", "findPerson('Mom').charmedTime++");
			if (q2 != "asked") addLinkToPlaceC(md, "assure her that she is in charge of her desires.", Place, "type=momghcharmfull9");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "momghcharmfull9") {
			md = WritePlaceHeader();
			this.charmThem(4);
			this.showPerson("mom21.jpg");
			addPlaceTitle(md, "Mom Under A Charm Spell");
			md.write("<p>If there is one thing you know about Mom, it is that she is always in charge, at least around the house. She has to be, and you doubt that even the Dai Chu could change that, so this is the best angle to play.</p>" +
				"<p>She is in control, she has to think that she it is her desire to become intimate with her children, and maybe it even is.</p>" + "<p>\u201cI am in charge... it is my decision to become... closer to my Kids.\u201d</p>" + "<p>\u201cAs a Mother, you want to guide them and be there for them, help them understand their sexuality.\u201d</p>" + "<p>\u201cI want to... be there, help them... understand... sexuality...\u201d</p>" + "<p>\u201cAnd there is nothing wrong with it, it is only natural for family to be this close.</p>" +
				"<p>\u201cYes... only... natural... nothing... to be ashamed off...\u201d</p>" + "<p>\u201cGood, and now, as I count to three, you will slowly wake up. You will remember to have called me here, and that you decided to await me as you are now.</p>" + "<p>\u201cYes...\u201d</p>" + "<p>\u201cYou will remember your desires and not be ashamed of them. You want your children to be happy, you want to fulfill their needs.\u201d</p>" + "<p>\u201cFulfill... their needs...\u201d Mom looks about ready to burst with arousal, and you begin your countdown.</p>" +
				"<p>One.</p>" + "<p>Two.</p>");
			startQuestionsOnly();
			addLinkToPlaceC(md, "Three", Place, "type=momghcharmfull10");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "momghcharmfull10") {
			md = WritePlaceHeader();
			this.showPerson("mom22.jpg");
			addPlaceTitle(md, "Mom Under A Charm Spell");
			md.write("<p>\u201c" + perYou.getPersonName() + "?\u201d Moms eyes snap back into focus, and she looks around in confusion. \u201cWhy am I naked in Gabby's house and... why are you here?\u201d</p>" + "<p>\u201cYou called me here Mom, remember?\u201d You do your best to play ignorant, Mom may be fully under the effect of the spell, as you can see in her eyes, but it's still best to let her take the initiative. \u201cYou said you needed me for something.\u201d</p>" +
				"<p>\u201cRight, of course I... wanted to talk to you.\u201d Mom doesn't even seem to notice that you are shamelessly ogling her naked body. \u201cI had... time to think in the last days, and I know you have become very sexually... active.\u201d</p>");
			if (this.checkFlag(28)) md.write("<p>\u201cNot only with other girls, but also with your sister, which I... don't disapprove. Family should be able to share such things, after all.\u201d</p>");
			md.write("<p>You try to say something, but she shushes you. \u201cDo not interrupt me, I have raised you better than that!\u201d</p>");
			startQuestionsOnly();
			addLinkToPlaceC(md, '"Sorry Mom"', Place, "type=momghcharmfull11");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "momghcharmfull11") {
			md = WritePlaceHeader();
			this.showPerson("mom23.jpg");
			addPlaceTitle(md, "Mom Under A Charm Spell");
			md.write("<p>\u201cThat's better.\u201d</p>" + "<p>\u201cAs I was trying to say,\u201d She takes off her panties as she speaks. \u201c...it made me realize how I... never have spoken to both of you on matters of Sexuality. You are growing up so fast, and as a good mother I need to... help you understand these things.\u201d</p>" +
				"<p>She approaches you with a seductive sway of her hip, her eyes full of lust as she moves closer.</p>" + "<p>\u201cNow, undress, and no backchat!\u201d As if you would even dream of it. \u201cThis may seem unusual, but I am your mother, and I know what is best for you.\u201d</p>");
			startQuestionsOnly();
			addLinkToPlaceC(md, '"Yes, Mom"', Place, "type=momghcharmfull12");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "momghcharmfull12") {
			md = WritePlaceHeader(false, perYou.isMaleSex() ? "td-left-med" : isExplicit() ?
				"td-left-large" : "");
			if (perYou.isMaleSex())
				if (isExplicit()) this.showPersonX("mom24m.jpg");
				else this.showPerson("mom12b.jpg");
			else if (isExplicit()) this.showPersonX("mom24f.jpg");
			else this.showPerson("mom12g.jpg");
			addPlaceTitle(md, "Mom Under A Charm Spell");
			if (perYou.isMaleSex()) md.write("<p>A part of you can't believe that this is actually happening. Your own mother knees in front of you and sucks on your cock with a vigor you've never seen from her. Engorging herself on your shaft and even forcing it deeply into her throat at one point, something you'd have never imagined her knowing how to do.</p>" +
				"<p>\u201cYou've grown into such a big boy, hun.\u201d She pulls back with a silent plop and guides you to lay down on your back. \u201cNow just relax and let Mommy take care of you.\u201d</p>");
			else md.write("<p>A part of you can't believe that this is actually happening. Your own mother knees in front of you and licks your pussy with enthusiasm you've never expected to see from her. Flicking her tongue skillfully over your clit, and caressing your folds with enough skill to make you wonder just how much experience with other women she must have kept secret from you and Tracy.</p>" +
				"<p>\u201cYou've grown into such a beautiful woman, hun.\u201d She places a last kiss to your little nub and pulls you off the couch. \u201cNow just relax and let Mommy take care of you.\u201d</p>");
			startQuestionsOnly();
			addLinkToPlaceC(md, "lie down and follow her lead", Place, "type=momghcharmfull13");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "momghcharmfull13") {
			md = WritePlaceHeader();
			if (perYou.isMaleSex()) this.showPersonRorX("mom11bb.jpg");
			else this.showPerson("mom25f.jpg");
			addPlaceTitle(md, "Mom Under A Charm Spell");
			if (perYou.isMaleSex()) md.write("<p>Mom is a good lover: Attentive, caring and far more sensual than you have ever imagined it.</p>" + "<p>She straddles you and quickly removes what remains of your clothing, drawing her fingers over your chest and placing soft kisses to your neck before finally guiding your cock into her womanhood with a soft gasp.</p>" + "<p>The experience is as hot as it is surreal. She moves slowly at first, carefully, but as you both adjust to each others movements, lust and passion take over. For a few precious minutes you allow yourself to get lost within the moment, enjoying her warmth, her smell, and the feel of every motion bringing you closer to the peak.</p>" +
				"<p>As you finally climax, she pulls you into a kiss and comes to rest on top of you, gasping for air, not daring to speak.</p>");
			else md.write("<p>Mom is a good lover: Attentive, caring and far more sensual than you have ever imagined it.</p>" + "<p>Her fingers caress your legs as she spreads them apart and aligns her hip with yours, and a soft gasp leaves your lip as her warm folds press against your own and you feel your most sensetive spots touch.</p>" + "<p>The experience is as hot as it is surreal. She moves slowly at first, carefully, but as you both adjust to each others movements, lust and passion take over. For a few precious minutes you allow yourself to get lost within the moment, enjoying her warmth, her smell, and the feel of every motion bringing you closer to the peak.</p>" +
				"<p>As you finally climax, she pulls you into a kiss and comes to rest on top of you, gasping for air, not daring to speak.</p>");
			startQuestionsOnly();
			addLinkToPlaceC(md, "just rest for a bit", Place, "type=momghcharmfull14");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "momghcharmfull14") {
			md = WritePlaceHeader();
			this.showPerson("mom26.jpg");
			addPlaceTitle(md, "Mom Under A Charm Spell");
			md.write("<p>\u201cI needed that...\u201d Mom breathes out after a while and sits up. \u201cI... still have work to do at the studio, but thank you for... coming.\u201d</p>" +
				"<p>It's probably silly to have to giggle at that, doesn't keep you from doing it, though.</p>" + "<p>\u201cWork is almost wrapped up, and I'll be back home again.\u201d Both of you get up and dressed, and even now you still see her casting you longing glances.</p>" + "<p>\u201cI hope I see you tonight, hun.\u201d She gives you a kiss on the lips. \u201cWe have a lot to make up for. Take care.\u201d</p>" + "<p>And with that, she's out of the house and back to work. Things are going to be very different back home now, but overall it's been a very successful day.</p>");
			startQuestionsOnly();
			addLinkToPlaceC(md, "Leave Gabby's home", 38, "", "", "", "movePerson('Mom',154);movePerson('Gabby',452)");
			WritePlaceFooter(md);
			return true
		}
		return false
	};
	per.showEvent = function() {
		var md, d, stage;
		if (sType == "mompool") {
			WaitHereOnly(6);
			md = WritePlaceHeader();
			this.showPerson("mom-poolu.jpg");
			addPlaceTitle(md, "Swimming with Mom");
			md.write("<p>Mom arrives and changes into her one-piece swimsuit, but she is not in any hurry to swim, she is just happy to chat and take a break..</p>");
			startQuestionsOnly();
			addLinkToPlaceC(md, "say goodbye to Mom", Place);
			WritePlaceFooter(md);
			return true
		}
		if (Place == 415) {
			if (sType == "givesuitcase1" || sType == "givesuitcase2") {
				stage = getQueryParam("stage");
				md = WritePlaceHeader();
				this.showPerson("mom14.jpg");
				addPlaceTitle(md, "Delivering the Suitcase");
				md.write("<p>Mom goes over the suitcase to make sure everything is in there, and her cheeks suddenly erupt into a deep blush when she finds the lacy underwear you packed.</p>" + "<p>\u201cHoney... where did you find these?\u201d</p>");
				startQuestionsOnly();
				if (stage == "") addLinkToPlace(md, "show her the list she made", Place, "type=" + sType + "&stage=stage2", "\u201cI... wrote that?\u201d Mom looks genuinely confused for a moment. \u201cI guess I did.\u201d She scratches the back of her head. \u201cIn any case, thank you for getting everything on such short notice, you are a lifesaver.\u201d");
				else if (stage == "stage2") addLinkToPlace(md, "ask if she is alright", Place, "type=" + sType + "&stage=stage3", "\u201cYes, honey, don't worry. I think the work-stress is just getting to me a little.\u201dMom chuckles uneasily as she puts the underwear away. \u201cI'm even missing a few hours last night, and Gabby told me I fell asleep on my desk. So I may just have been a little distracted when I made that list.\u201d");
				else {
					startAlternatives(md);
					addLinkToPlace(md, "tell her that you think she would look sexy in those clothes, if it's any consolation", Place, "type=" + sType + "next", "Mom laughs and gives you a surprisingly playful wink. \u201cThank you, dear. Maybe I should start wearing some of these around the house and...\u201d");
					addLinkToPlace(md, "tell her that finding them was a little awkward", Place, "type=" + sType + "next", "\u201cHey, even a mother might want to feel sexy once in a while, you know?\u201d Mom actually seems a little offended by your words. \u201cMaybe I need to wear some of these around the house so you and Tracy get used to...");
					endAlternatives(md)
				}
				WritePlaceFooter(md);
				return true
			}
			if (sType == "givesuitcase1next" || sType == "givesuitcase2next") {
				md = WritePlaceHeader();
				findPerson("Gabby").showPerson("gabby1.jpg");
				addPlaceTitle(md, "Delivering the Suitcase");
				md.write("<p>\u201cThis would hardly be appropriate, right Alex?\u201d You didn't even notice Gabby around... just how long had she been listening?</p>" + "<p>\u201cRight... it would not be.\u201d Mom suddenly looks somehow confused, again, and you notice that she doesn't look at Gabby directly, but rather at the necklace she wears. \u201cI'm not even sure why I suggested this...\u201d</p>" +
					"<p>\u201cThe long hours are just getting to both of us.\u201d Gabby replies with a kind voice before turning to you, her features hardening a little.</p>" + "<p>\u201cThank you for your help, " + perYou.getPersonName() + " but your mother and I really need to get to work and can not afford any more delays. You will have plenty of time to catch up later, I am sure.\u201d</p>" + "<p>You are about to reply, but Mom cuts you off.</p>" + "<p>\u201cI hate to admit it, but she's right, honey.\u201d Mom closes the suitcase and gives you a kiss on the cheek. \u201cThank you again for the help. I promise we'll talk later!\u201d</p>");
				startQuestionsOnly();
				addLinkToPlace(md, "say your goodbyes and leave.", 371, "type=byesuitcase");
				WritePlaceFooter(md);
				return true
			}
			if (sType == "givesuitcase3" || sType == "givesuitcase4") {
				md = WritePlaceHeader();
				this.showPerson("mom14.jpg");
				addPlaceTitle(md, "Delivering the Suitcase");
				md.write("<p>Mom goes over the suitcase to make sure everything is in there and, to your surprise, doesn't even flinch when she sees the lacy underwear she asked you to pack.</p>" + "<p>Hell, she even takes one of the more revealing pieces out and has a long, thoughtful look at it.</p>" +
					"<p>\u201cI haven't really had an opportunity to wear these in a while, you know, do you think I would still look sexy in them, Hun?\"</p>");
				startQuestionsOnly();
				startAlternatives(md);
				addLinkToPlace(md, '"Of course!"', Place, "type=" + sType + "next", "\u201cYou are a little charmer, dear.\u201d Did... your Mom just give you a playful wink? \u201cMaybe... you would like me to model some of these? I have been feeling a little...");
				addLinkToPlace(md, '"This is awkward..."', Place, "type=" + sType + "next", "\u201cNow, don't be like this, Hun.\u201d Mom is striking a... sexy pose? \u201cI tell you what, maybe I should model some of these. That way you get to decide if it's really....");
				endAlternatives(md);
				WritePlaceFooter(md);
				return true
			}
			if (sType == "givesuitcase3next" || sType == "givesuitcase4next") {
				md = WritePlaceHeader();
				findPerson("Gabby").showPerson("gabby1.jpg");
				addPlaceTitle(md, "Delivering the Suitcase");
				md.write("<p>\u201cThis would hardly be appropriate, right, Alex?\u201d You didn't even notice Gabby around... just how long had she been listening?</p>" + "<p>\u201cRight... it would not be.\u201d Mom suddenly looks somehow confused, again, and you notice that she doesn't look at Gabby directly, but rather at the necklace she wears. \u201cI don't know what I was thinking, mistr... Miss Halliwell.\u201d</p>" +
					"<p>\u201cIt's okay, the long hours are just getting to both of us.\u201d Gabby replies with a kind voice before turning to you, her features hardening a little.</p>" + "<p>\u201cThank you for your help, " + perYou.getPersonName() + " but your mother and I really need to get to work and can not afford any more delays. You will have plenty of time to catch up later, I am sure.\u201d</p>" + "<p>You are about to reply, but Mom cuts you off.</p>" + "<p>\u201cI hate to admit it, but she's right, honey.\u201d Mom closes the suitcase and gives you a kiss on the cheek. \u201cThank you again for the help. I promise we'll talk later!\u201d</p>");
				startQuestionsOnly();
				addLinkToPlace(md, "say your goodbyes and leave.", 371, "type=byesuitcase");
				WritePlaceFooter(md);
				return true
			}
		}
		if (Place == 452 && this.isHere()) return this.showEventGabbysHome();
		if (sType === "" && Place == 45 && this.checkFlag(15) && !this.checkFlag(16) && getHour() >= 6 && getHour() < 8) setQueryParams("event=mombreakfast");
		if (sType == "breakfastfun") {
			md = WritePlaceHeader();
			this.showPerson("mom31.jpg");
			this.setFlag(16);
			addPlaceTitle(md, "Mom for Breakfast");
			if (perYou.isMaleSex()) md.write("<p>\u201cGood Morning, Mom.\u201d She surely offers an enticing view, and you make sure she knows just how enticing she is by greeting her with a long hug her from behind and pressing the growing bulge in your pants against her rear, making her gasp in surprise.</p>" +
				"<p>\u201cOh dear...\u201d Mom rubs her backside against your crotch. \u201cYou are so hard already... but that can't be helped at your age, right?\u201d She briefly bites her lower lip, contemplating. \u201cWell, Mommy is here for you if you need some... relive. Just so you know.\u201d</p>" + "<p>This is not something you need to hear twice. You move what little cloth she wears out of the way and bend your Mom over the countertop, her body trembling in anticipation as you tease her with the tip of your cock for a few seconds and finally push into her wetness.</p>" +
				"<p>Mom moans softly as you begin to move your hip, bracing herself against your thrusts while both her hands spread her asscheeks for you, and with such a sexy view, it really doesn't take long until you climax and shoot your load into her.</p>");
			else md.write("<p>\u201cGood Morning, Mom.\u201d You move in to give her a tender hug from behind. \u201cThank you for all the hard work.\u201d</p>" + "<p>\u201cYou are welcome, dear, it's a pleas...sure...\u201d Mom suppresses a soft moan as your hands wander to her breasts, pushing her bra out of the way and playing with her nipples. \u201cHunny, this is not the time to... ohhh... I need to...\u201d</p>" +
				"<p>You press soft kisses to the back of her neck and nestle your body against her, one hand wandering down, fingertips brushing over her stomach and sliding into her panties.</p>" + "<p>\u201cW...wait! This is... H...how do you make this feel so... ahhhhh...\u201d</p>" + "<p>Your usually fairly domineering mother is completely helpless under your skilled touch, and within seconds, whatever protest she might have is replaced by soft gasps and sensual moans as you insert your fingers into her warm folds and play with her little nub, enjoying the feel of her body twitching in your arms and trembling under one lustful shudder after another as you bring her closer to the peak, turn her head to the side to give her a deep kiss and finally bring her to climax.</p>");
			if (isPersonHere("Tracy")) md.write("<p>As you pull away, you notice that Tracy has been watching the two of you, eyes wide and her fingers between her legs. \u201cWow... I'm a bit jealous now...\u201d She chuckles. \u201cBut I'm still happy to see you and Mom bonding like that.\u201d</p>");
			if (wherePerson("Miku") == 408) md.write("<p>Miku is sporting one of the biggest grins you've ever seen on her, she gives you a wink as you move back to your seat before moving towards the countertop and help Mom with the rest of breakfast.</p><p>\u201cI love this place.\u201d</p>");
			startQuestionsOnly();
			addLinkToPlace(md, "help her clean up", 45);
			WritePlaceFooter(md);
			return true
		}
		if (Place != 154) return false;
		var perTracy = findPerson("Tracy");
		var clvT = perTracy.getCharmedLevel();
		var perGabby = findPerson("Gabby");
		var clvG = perGabby.getCharmedLevel();
		if (sType == "searchclothes") {
			md = WritePlaceHeader();
			this.showPerson("mom-underwear.jpg");
			this.setFlag(21);
			addPlaceTitle(md, "Resist!");
			md.write("<p>The first part of the list contains nothing too outlandish. A lady's skirt, a pair of pants, blouses and 2 towels. You don't really know your way around Mom's room, but everything is where you might expect it to be and easy to find.</p>" +
				"<p>The second part is... strange, though.</p>" + "<p>The other items are not exactly hidden, but placed in a way that no one would just stumble upon them by chance. You certainly wouldn't have found them without Mom's instructions, and as it turns out that's with good reason.</p>" + "<p>You have found your mothers secret drawer for \u201cladies underwear\u201d. Lacy Bra's, form fitting lingerie, a few thongs, garter belts and even a bunch of small sex toys...</p>" + "<p>You, frankly, have no idea why Mom would guide you to these items, or why she would need any of them at work...</p>" +
				"<p>Hell, until now you had no idea she even owns a collection like this. Sure, she was never the bashful type, and she does like sexy outfits, but finding this is...</p>");
			startQuestionsOnly();
			startAlternatives(md);
			addLinkToPlace(md, "Hot! You really want to see her wearing this!", 154, "type=searchclothesimagine");
			addLinkToPlace(md, "Awkward... better hurry up and just be done with it.", 45, "", "You -really- don't want to imagine your own Mom in sexy lace underwear and playing with some of the... items in there, so you do your best to ignore whatever implication they might have as you put everything into a small suitcase and go on your way to deliver everything.",
				"", "perYou.AddItem(66)");
			endAlternatives(md);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "searchclothesimagine") {
			md = WritePlaceHeader();
			this.showPerson("mom13.jpg");
			addPlaceTitle(md, "Imagining...");
			md.write("<p>You really should just get everything you need from the list and get out, and yet, your fantasy is going wild as you dig deeper into the naughty little treasure trove.</p>" + "<p>You know it is wrong, but thinking back to legions visit, to walking in on her as she, well...</p>" + "<p>You can't help but see her less as your Mom and more as the sexy woman she is...</p>" +
				"<p>\u2026Someone with needs and desires you are sure she has put aside to tend to her family far too long, and you wonder... just maybe...</p>" + "<p>\u2026 you could help her fulfill these desires, allow her to relax a little and just... let herself go.</p>");
			startQuestionsOnly();
			addLinkToPlace(md, "Focus and gather the things you need", 45, "", "You quickly shake yourself out of your fantasies and neatly place everything on the list into one of moms suitcases.</p><p>Having thoughts like this is... weird. Did you always have these desires and just never admitted to them, or is more happening to you than you are wiling to admit to yourself?</p><p>You may have to confront these feelings sooner or later, but that as it may, you got everything you came for and should head over to the TV station. ",
				"", "perYou.AddItem(66)");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "mresist") {
			md = WritePlaceHeader();
			this.showPerson("mom4b.jpg");
			this.setFlag(29);
			addPlaceTitle(md, "Resist!");
			md.write("<p>You tell Mom to try and resist the influence she is under, the glamour or other effect from Jesse. She does not seem to question exactly what you mean but your words seem to strongly affect her. She sits up and stops caressing herself, one hand is resting on her pussy, but it might be more modesty. She tells you,</p>" +
				'<p>"Yes, it is so much clearer, so much...less hot...I will try to stop thinking about such things"</p>' + "<p>Interesting, it seems she was still under some sort of spell from the demon but it seems to have been more subtle, influencing her not controlling her. Subtle and appears easily broken. You think Mom will be back to normal from now.</p>");
			IncreaseMomsArousal(-1);
			startQuestionsOnly();
			addLinkToPlace(md, "leave your Mom to calm down", 45);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "mgivein") {
			md =
				WritePlaceHeader();
			this.setFlag(29);
			this.showPerson("mom4c.jpg");
			addPlaceTitle(md, "Nothing wrong at all!");
			IncreaseMomsArousal(1);
			md.write("<p>You tell Mom that feeling...odd...is completely normal, and there is nothing wrong with how she has been feeling. In fact you are happy to see this side of her since she seldom speaks of sex. After all Mothers and their children should be able to freely talk of their feelings and sex.</p>" + "You see that you words visibly affect her, interesting, it seems she is still under some sort of spell from the demon but it seems to have been more subtle, influencing her not controlling her. Mom moves, her breasts hanging beautifully as kneels on her chair, and she says a little hesitantly,</p>" +
				'<p>"Alright...but Mommy really, really needs to do something, please leave me for now, we can...talk...later"</p>' + "<p>You see why she is so hesitant, one of her hands is furiously rubbing her pussy. She looks at you imploringly, you wonder if it is to touch her or to leave, but you decide you should leave for now. You slowly step to the door and look back and see your mother orgasming, biting her lip to try to be quiet. You see no sign she is slowing down her masturbation, it would seem your mother is multi-orgasmic...</p>");
			startQuestionsOnly();
			addLinkToPlace(md, "leave your Mom to what she is doing", 45);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "tracy") {
			md = WritePlaceHeader();
			this.setFlag(31);
			this.showPersonDN("mom1e.jpg");
			addPlaceTitle(md, "Mom Asking About Tracy");
			md.write('<p>Mom asks you "Tracy has been acting strangely recently, often wearing little or no clothing around the house. ' + 'Do you know why, she has been quite evasive with me but did accidently mention your name as if you might know something."</p>' + "<p>You wonder how to answer her, anything from deny everything to the truth.</p> ");
			startQuestionsOnly();
			addLinkToPlaceC(md, 'Lie - "I have no idea"', 154, "type=tracydeny");
			addLinkToPlaceC(md, 'Partial - "Davy was blackmailing her"', 154, "type=tracydavy");
			if (clvT == 2) addLinkToPlaceC(md, 'Almost True - "Tracy and I are now lovers"', 154, "type=tracylovers");
			else addLinkToPlaceC(md, 'Mostly True - "I have helped protect her"', 154, "type=tracyprotect");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "tracydeny") {
			md = WritePlaceHeader();
			this.setFlag(25);
			this.showPersonDN("mom1e.jpg");
			addPlaceTitle(md,
				"Denial");
			md.write("<p>You tell Mom that you have no idea why Tracy is acting differently, and that she is probably just a way she is deciding to act now.</p> " + "<p>You can see Mom does not believe you at all, but she leaves it there and does not press the issue.</p>");
			startQuestionsOnly();
			addLinkToPlace(md, "leave your Mom's bedroom", 45);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "tracydavy" || sType == "tracyprotect") {
			md = WritePlaceHeader();
			this.setFlag(25);
			this.showPersonDN("mom1e.jpg");
			addPlaceTitle(md,
				"Davy's Fault");
			md.write("<p>You tell Mom that Davy had been influencing Tracy recently, possibly using blackmail but you do not know the exact details. You have spoken to Tracy and have been able to sort the issue out and broken Davy's hold over her. Tracy should start acting more normal (at leave she will when you tell her to do so around Mom).</p> " + "<p>Mom seems happier, but she expresses some anger at Davy and tries to get you to report this to the police or at least to the school. You tell her Tracy did not want to do anything like this and Mom leaves the issue, for now.</p>");
			startQuestionsOnly();
			addLinkToPlace(md, "leave your Mom's bedroom", 45);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "tracylovers") {
			md = WritePlaceHeader();
			this.showPersonDN(this.extra[0] > 0 ? "mom1f.jpg" : "mom1a.jpg");
			addPlaceTitle(md, "Lovers");
			md.write("<p>You tell Mom that Tracy and you have recently become lovers. ");
			if (this.extra[0] > 0) {
				IncreaseMomsArousal(1, 30);
				md.write('Mom looks a little flustered and replies, "You know that is very hot...I mean wrong. Don\'t let anyone else know", and you see she blushes. She then asks you to leave her alone.</p>')
			} else {
				md.write('Mom looks surprised, "That is wrong, you must end your relationship immediately, promise me!", you tell her you will, but actually meaning you will keep it better hidden.</p>');
				this.setFlag(30)
			}
			startQuestionsOnly();
			addLinkToPlace(md, "leave your Mom's bedroom", 45);
			WritePlaceFooter(md);
			return true
		}
		if (this.checkFlag(27) && !this.checkFlag(26)) {
			md = WritePlaceHeader(false, "td-left-med");
			this.showPerson("mom1g.jpg");
			addPlaceTitle(md, "Mom Leaving");
			md.write("<p>You check your mothers room and the door is locked, and you hear her call out, \"I'm here " + perYou.getPersonName() + '"</p>' + "<p>You see her near the front door, with a bag, clearly about to leave. You ask where she is going,</p>");
			if (this.isCharmedBy()) md.write('<p>"With all this strange stuff going on around town I have been called in to help put together some special reports for the News, both for radio and TV.</p>' + "<p>This could be a long shift, so I have taken a change of clothes, I'll change at work. Now make sure to come and visit me at work, I am sure we can arrange to..talk..privately.\"</p>" + '<p>You tell her goodbye, and as she steps out you hear her make a phone call "Gabby, I\'ll be there soon.", you have met her assistant Gabriella a few times, or Gabby for short. She was always very focused on work and seems devoted to your mother.</p>');
			else md.write('<p>"With all this strange stuff going on around town I have been called in to help put together some special reports for the News, both for radio and TV.</p>' + "<p>This could be a long shift, so I have taken a change of clothes, I'll change at work. Stay in contact, I will let you know when I should get back home.\"</p>" + '<p>You tell her goodbye, and as she steps out you hear her make a phone call "Gabby, I\'ll be there soon.", you have met her assistant Gabriella a few times, or Gabby for short. She was always very focused on work and seems devoted to your mother.</p>');
			md.write("<p>You then hear your mother briskly walking away, you have always told her to get a car, but she keeps telling you to exercise more, it is good for your figure.</p>");
			this.moveThem(415);
			this.setFlag(26);
			this.charmedTime = 0;
			startQuestionsOnly();
			addLinkToPlace(md, "close the front door", 45);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "momfuck") {
			var chc = Math.floor(Math.random() * 2);
			md = WritePlaceHeader(false, !perYou.isMaleSex() || chc === 0 && isExplicit() && perYou.isMaleSex() ? "td-left-large" : "");
			if (isExplicit())
				if (perYou.isMaleSex()) this.showPersonX(chc ===
					0 ? "mom11ba.jpg" : "mom11bb.jpg");
				else this.showPersonRandomX("mom11g", 2);
			else if (perYou.isMaleSex()) this.showPersonRandom("mom11b", 2);
			else this.showPerson("mom11ga.jpg");
			addPlaceTitle(md, "Alone time with Mom");
			if (perYou.isMaleSex()) md.write("<p>Words aren't needed, in fact, they rarely are ever since your mother has been placed under your spell. Mom knows what you need the moment you enter the room, and within seconds, you find yourself naked on the bed and her crawling on top of you.</p>" + "<p>You share a deep, loving kiss with her, tasting her lips and letting her play with your tongue as your manhood begins to press against her crotch.</p>" +
				"<p>\u201cMy son has grown into such a big, strong man...\u201d She whispers sensually. \u201cI couldn't be more proud.\u201d</p>" + "<p>Her fingers trace over the thick shaft, clearly enjoying the effect she has on you, and her lips touch yours for a last, feint kiss before she straddles you, guiding your cock into her waiting folds and starting to rhythmically move her hips.</p>" + "<p>It feels wonderful.</p>" + "<p>You know Mom has not been with a man for years, but she is still an experienced lover and knows exactly what to do to push your buttons, allowing you to just let yourself fall back as she tends to your needs, her fingers caressing your arms and chest and her lips pressing soft kisses to your neck and shoulders all while she never stops moving her hips until both of you share an intense climax.</p>");
			else md.write("<p>Words aren't needed, in fact, they rarely are ever since your mother has been placed under your spell. Mom knows what you need the moment you enter the room, and within seconds, you find yourself naked on the bed and her crawling on top of you.</p>" + "<p>You share a deep, loving kiss with her, tasting her lips and letting her play with your tongue as her knee pushes between your tights to slowly spread your legs.</p>" + "<p>\u201cMy little girl has grown into such a beautiful, young woman...\u201dShe whispers softly. \u201cI couldn't be more proud.\u201d</p>" +
				"<p>You feel her fingers brushing over your folds and teasing your clit, a soft gasp leaving your lips as she delves deeper into your sex and begins to massage you.</p>" + "<p>It feels wonderful.</p>" + "<p>You don't know just how much experience your Mom has with younger lovers or other women, but she knows exactly what to do to push your buttons and drive you crazy, using her fingers, lips and whole body to tend to your every need and expertly bring you to climax.</p>");
			startQuestionsOnly();
			addLinkToPlace(md,
				"talk more with Mom", 154);
			addLinkToPlace(md, "leave your Mom's bedroom", 45);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "mombj") {
			md = WritePlaceHeader(false, !perYou.isMaleSex() && isExplicit() ? "td-left-large" : "");
			if (isExplicit()) this.showPersonRandomX(perYou.isMaleSex() ? "mom12b" : "mom12g", 2);
			else this.showPerson(perYou.isMaleSex() ? "mom12b.jpg" : "mom12g.jpg");
			addPlaceTitle(md, "Alone time with Mom");
			if (perYou.isMaleSex()) md.write("<p>Mom seems to know of your intent even before you speak the words and gestures you to come closer with a soft smile.</p>" +
				"<p>\u201cOh honey,\u201d She purrs softly, her hands brushing over the growing bulge in your pants. \u201cIt is hard on a young man to live in a house with so many sexy women, isn't it?\u201d You don't really need to answer that, her hands are already on your zipper and her lips close to your crotch.</p>" + "<p>\u201cJust relax and let Mommy take care of this, you'll feel better in a moment.\u201d</p>" + "<p>It still feels like a weird dream to do this, but it's a sexy one. Your mothers lips eagerly wrap around your cock and push forward all the way to the base until the tip enters her throat and remains there for precious seconds before she pulls back to catch some air.</p>" +
				"<p>She is enjoying this.</p>" + "<p>Mom alternates between using her hands, her tongue and her lips to coat your manhood in saliva and pleasure you, bringing you closer and closer to climax until it is finally too much to bear and you unload yourself into her mouth, making her swallow every drop.</p>");
			else md.write("<p>Mom seems to know of your intent even before you speak the words and gestures you to come closer with a soft smile.</p>" + "<p>\u201cDon't worry, I know what I was like at your age, hun.\u201d She speaks softly and pulls you into a gentle embrace. \u201cJust relax and let Mommy take care of your needs, you'll feel better in a moment.\u201d</p>" +
				"<p>It still feels like a weird dream to do this, but it's a sexy one. Your mother kisses you on the lips and moves behind you to help you out of your clothes, her lips teasing your neck and earlobe, moving down to your shoulder-blades and the small of your back as more and more of your clothes are taken off and finally pressing a soft kiss to the spot right above your buttocks.</p>" + "<p>She knows how to press your buttons in a way only a mother could, and as you turn around and sit down on the bed, you are wet enough that no further preparation is needed. Her tongue caresses your folds and playfully flicks over your clit, only stopping to place tender kisses all over your tights to allow you to briefly catch your breath.</p>" +
				"<p>You gasp and moan, cling to the sheets and bite your lower lip as your mother plays with your most sensitive parts, drags out the final moments agonizingly long and finally pushes you into an intense, satisfying orgasm.</p>");
			startQuestionsOnly();
			addLinkToPlace(md, "talk more with Mom", 154);
			addLinkToPlace(md, "leave your Mom's bedroom", 45);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "momtracythreesome") {
			md = WritePlaceHeader(false, "td-left-large");
			this.showPerson("Endings/endgame1-harem10.jpg");
			addPlaceTitle(md,
				"Alone time with Mom");
			md.write("<p>\u201cYou've started without me!\u201d Tracy pulls a cute pout when she sees you and Mom already naked in each others arms, and jokingly has you promise to make it up to her before joining you on the bed.</p>" + "<p>Tracy is one of the very few, if not the only other woman in your life Mom unconditionally accepts next to her. You had expected that you would need to convince both of them to\u201dgrow closer as a family\u201d the first time, but they had already made up their minds long before you even brought it up, and getting both of them into the same bed was just a formality.</p>" +
				"<p>Even with your ever growing harem of girls, Mom and Tracy still hold a special place in your heart. You are just as focused on making sure the two enjoy themselves as they are on your pleasure, and especially Mom takes great care to split her attention evenly between you and your sister.</p>" + "<p>You trade sloppy kisses and tender affections with both of them, enjoying their eager hands on your skin, their lips on your neck, chest and cock/pussy and make sure to give back to your family as much as you get. For the next half hour, Mom's bedroom is filled with sensual moans, lewd smacking noises and the occasional lighthearted giggle as you redefine \u201cfamily time\u201d in a way none of you would have ever even dreamed off.</p>" +
				"<p>And it certainly does make you \u201ccome\u201d closer together.</p>");
			startQuestionsOnly();
			addLinkToPlace(md, "talk more with Mom", 154);
			addLinkToPlace(md, "leave your Mom's bedroom", 45);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "momgabbywatch") {
			md = WritePlaceHeader();
			perGabby.showPerson("gabby-mom1.jpg");
			addPlaceTitle(md, "Watching Mom and Gabby");
			md.write("<p>Gabby looks exited, but uncertain, and Mom seems hesitant as well until you explain how you could learn something about sex from watching two beautiful and experienced women make love, which easily convinces her to let you stay.</p>" +
				"<p>It's probably one of the rare cases where Gabby is the more hesitant one, but both woman are still easily swept away by their lust and the spells effects as they begin to touch and kiss each other.</p>" + "<p>You watch as your mother pins Gabby to the bed and kisses her inner thighs, her lips moving closer to her partners folds, tracing them and suckling on her clit to make the other woman moan in delight.</p>" + "<p>Soon, the only indication that they even remember you are here is the way they both make sure that you always have a good view at what they do, always posing a little and presenting their most intimate areas for your enjoyment.</p>");
			startQuestionsOnly();
			addLinkToPlace(md, "talk more with Mom", 154);
			addLinkToPlace(md, "leave your Mom's bedroom", 45);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "momgabbyjoin") {
			md = WritePlaceHeader();
			perGabby.showPerson("gabby-mom6.jpg");
			addPlaceTitle(md, "Joining Mom and Gabby");
			md.write("<p>\u201cOf course, family should always share.\u201d Mom is a lot more enthusiastic about this than Gabby, but the later would never dare argue with her on any of these matters, and by heightening her lust with the Dai Chu, you quickly get her to warm up to the idea as well.</p>" +
				"<p>Mom is in charge of course, especially in bed, and you get to lean back and have two beautiful mature women tend to your every need. Both your Mom and her lover take turns pleasuring you, and you enjoy how they press their naked bodies against yours while they trade kisses and tender affections with you and each other.</p>" + "<p>Time just flies as their hands travel all over you skin and their lips and tongues play with your " + (perYou.isMaleSex() ? "cock" : "pussy") + ", inevitably rushing into the grand finale where all three of you are brought to climax one after the other and you all snuggle up together to bask in the afterglow.</p>");
			startQuestionsOnly();
			addLinkToPlace(md, "talk more with Mom", 154);
			addLinkToPlace(md, "leave your Mom's bedroom", 45);
			WritePlaceFooter(md);
			return true
		}
		if (!this.checkFlag(1)) return false;
		if (perGabby.isHere()) {
			this.setFlag(1, false);
			return false
		}
		if (!this.isHere()) return false;
		if (this.checkFlag(2) && !this.checkFlag(3)) {
			md = WritePlaceHeader();
			if (isExplicit()) this.showPersonRandomX("mom3", 3);
			else this.showPerson("mom3.jpg");
			this.setFlag(1, false);
			this.setFlag(3);
			addPlaceTitle(md, "Interrupting Mom In Her Bedroom");
			md.write("<p>After your meeting with the demon you are worried about your mother and open the door to check she is alright. You stifle an exclamation as you look in and see your mother has removed her clothes and is frantically masturbating and softly talking to herself,</p>" + '<p>"why have I been feeling so strange since that girl visited...oh yes, ' + perYou.getPersonName() + (perYou.isBornMale() ? " must have fucked her" : " must have licked her") + ", oh it's so bad of me to think about it...I can't stop...don't want to stop\"</p>" +
				"<p>She cries out, but quickly covers her mouth as her hips thrust as she has a massive orgasm, copious fuilds squirting out her passion. She collpases in the aftermath of her impressive orgasm.</p>");
			startQuestionsOnly();
			addLinkToPlace(md, "quietly close the door, aroused", 45, "", "You leave the room, finding it difficult to put what you just saw out of your mind", "", "setPersonFlag('Mom',3);setPersonFlag('Mom', 1, false)");
			addLinkToPlace(md, "quickly close the door, embarrassed", 45, "", "You leave her room, determined to put what you saw out of your mind, she is your mother!",
				"", "setPersonFlag('Mom',3);setPersonFlag('Mom', 1, false);IncreaseMomsArousal(-1)");
			WritePlaceFooter(md);
			return true
		} else if (this.checkFlag(4) && !this.checkFlag(5)) {
			md = WritePlaceHeader();
			if (isExplicit()) this.showPersonRandomX("mom3", 3);
			else this.showPerson("mom3.jpg");
			this.setFlag(1, false);
			this.setFlag(5);
			addPlaceTitle(md, "Visiting Mom In Her Bedroom");
			md.write("<p>After your love-making with Tracy you cannot help but think more about your mother and you are drawn to talk more to her, especially after those events with the Demon,</p>" +
				'<p>"oh yes, Tracy and ' + perYou.getPersonName() + " I saw them, lovers in each others arms, oh it's so bad of me to think about it...to watch it...I can't help it...\"</p>" + "<p>She cries out, but quickly covers her mouth as her hips thrust as she has a massive orgasm, copious fuilds squirting out her passion. She collpases in the aftermath of her impressive orgasm.</p>" + "<p>You consider confronting her, but you doubt she will be receptive, as she has always avoided discussing matters of her sexuality with you.</p>");
			startQuestionsOnly();
			addLinkToPlace(md, "quietly close the door", 45);
			WritePlaceFooter(md);
			return true
		} else if (this.checkFlag(30) && !this.checkFlag(29)) {
			md = WritePlaceHeader(false, "td-left-med");
			this.showPerson("mom4a.jpg");
			this.setFlag(25);
			addPlaceTitle(md, "Visiting Mom In Her Bedroom");
			md.write('<p>You tap on Moms door and hear a sound, thinking she said "Come In", walking in you see her naked body shuddering, as she is more like "Cumming".</p>' + "<p>Mom looks up and notices you, and looks flustered, embarrassed but you notice her hand is slowly rubbing her pussy and her other hand is still cupping one of her breasts. It is clear she is struggling to work out what to say, but then she says,</p>" +
				'<p>"' + perYou.getPersonName() + " please leave Mommy alone, I want...don't want you here now...Sorry I have been feeling so, odd, recently, just leave me alone\"</p>" + "<p>You see her hand is rubbing her pussy faster, she does not seem to be aware she is doing it. Her other hand pinches one of her nipples.</p>" + "<p>What do you do?</p>");
			startQuestionsOnly();
			addLinkToPlaceC(md, '"Mom, Jesse affected you, try to resist it"', 154, "type=mresist", "", "", "setPersonFlag('Mom', 1, false)");
			addLinkToPlaceC(md, '"We all feel <i>odd</i> in that way"',
				154, "type=mgivein", "", "", "setPersonFlag('Mom', 1, false)");
			addLinkToPlace(md, "leave as she asks", 45);
			WritePlaceFooter(md);
			return true
		} else {
			md = WritePlaceHeader();
			if (isExplicit()) this.showPersonRandomX("mom3", 3);
			else this.showPerson("mom3.jpg");
			this.setFlag(1, false);
			addPlaceTitle(md, "Visiting Mom In Her Bedroom");
			md.write("<p>You step in to visit your mother, and you see she is a bit distracted,</p>" + '<p>"oh yes, ' + perYou.getPersonName() + ' yes, that is it...just there..."</p>' + "<p>She cries out, but quickly covers her mouth as her hips thrust as she has a massive orgasm, copious fuilds squirting out her passion. She collpases in the aftermath of her impressive orgasm.</p>");
			if (!this.isCharmedBy()) md.write("<p>You consider confronting her, but you doubt she will be receptive, as she has always avoided discussing matters of her sexuality with you.</p>");
			startQuestionsOnly();
			if (this.isCharmedBy()) addLinkToPlace(md, "watch and talk to Mom when she is finished", 154);
			addLinkToPlace(md, "quietly close the door", 45);
			WritePlaceFooter(md);
			return true
		}
	};
	per.showPersonTextHere = function(md) {
		if (Place == 46 && (wherePerson("Tess") == 45 || wherePerson("MrsTanika") == 45 && !isDay() || wherePerson("Anita") ==
				45)) md.write("<p>You hear some noise from the living room, it sounds like Mom " + (wherePerson("Tracy") == 45 || wherePerson("Tracy") == 156 ? "and Tracy " : "") + "talking to someone.</p>");
		else if (Place == 45 && getQueryParam("event") == "mombreakfast") md.write("<p>Your mother is bending over the countertop, focused on preparing breakfast.</p>")
	};
	per.showPersonChat = function(bGeneral, md) {
		if (!this.checkFlag(35) && !this.checkFlag(32) && isPersonHere("Tracy") && this.checkFlag(26) && this.place >= 998 && Math.floor(this.hoursCharmed("skip") /
				24) > 4)
			if (this.place != 999) addQuestionR(md, "ask Tracy if she has heard anything from Mom", "\u201cOh, yes. She actually just called and told me that she needs a vacation and will be gone for at least a few weeks.\u201d</p>" + "<p>\u201cIt took me by surprise as well, but she said the last days at work were really stressful, and she almost had a breakdown. So she took her extra hours and remaining vacation days while her assistant booked a last minute flight and took care of the rest.\u201d</p>" + "<p>\u201cGabb... Miss Halliway is actually going on vacation with Mom, who would have expected that?.\u201d",
				"Tracy", "movePerson(\\'Mom\\',999)");
			else addQuestionR(md, '"Did she tell you where she\'s going?"', "\u201cCome to think of it... no, and neither did she tell me how to contact her.\u201d Tracy looks thoughtful.</p>" + "<p>\u201cThat's really not like Mom at all, is it? I mean, it might just be the accumulated stress, but I hope she's alright.\u201d", "Tracy", "movePerson(\\'Mom\\',1000);setPersonFlag(\\'Mom\\',35)");
		if (Place == 45 && getQueryParam("event") == "mombreakfast") addLinkToPlace(md, "have some \u201cfun\u201d with Mom",
			154, "type=breakfastfun");
		if (this.isHere() && Place != 452 && sType === "")
			if ((isSpellKnown("Charm") || checkPersonFlag("Kylie", 7)) && !this.checkFlag(18)) addQuestionR(md, '"Do we have other family here in Glenvale?"', "You are fairly sure one of Mom's sisters and her family recent moved to Glenvale, but Mom has not really talk about them. Recently you think she visited them but on her own, so you ask Mom about it. Mom reples,</p>" + '<p>"Brandi and your cousin Kylie recently moved here. Brandi and I have been having difficulties for a while but I think we have it sorted out...somewhat."</p>' +
				"<p>You were never told any details of these difficulties, neither Mom or Tracy ever told you. While you think on this Mom continues,</p>" + '<p>"You may run across your cousin, she recently started at your school. She is quite athletic so you may play against her, if I can convince you to join a team this year."</p>' + "<p>An old argument, so you leave the topic there.", "Family", "setPersonFlag(\\'Mom\\',18)");
			else if (checkPersonFlag("Kylie", 7) && !this.checkFlag(17)) addQuestionR(md, '"Can you arrange for me to visit Aunt Brandi\'s"',
			"You mention to Mom about meeting Kylie, not anything more, and about how Kylie would not let you visit her home. It seems Aunt Brandi does not allow Kylie to have many visitors. Mom reples,</p>" + "<p>\"Brandi has alway been over-protective of Kylie, and any family members. It's a bit silly try to restrict a girl of Kylie's age from seeing people, Brandi cannot control Kylie all the time\"</p>" + "<p>Considering your encounter at the fields and street you have to agree with Mom, but refrain from saying anything other than a general agreement.</p>" +
			"<p>Mom continues, &quot;Ok, I'll speak to Brandi and arrange something, not sure how soon.\" <i>more not implemented</i>", "Mom and Kylie", "setPersonFlag(\\'Mom\\',17)");
		if (Place == 372 && !isDay() && this.whereNow() == 415) {
			var d = Math.floor(this.hoursCharmed("skip") / 24) + 1;
			if (d < 3 && checkPersonFlag("Gabby", 3) || d > 2 && checkPersonFlag("Gabby", 4)) addLinkToPlace(md, "look into Mom's office", Place, "", "You check but just seem Mom and Gabby working, and decide it is best not to interrupt them");
			else addLinkToPlace(md,
				"look into Mom's office", 415, "type=lookmomgabby" + (d < 3 ? "1" : "2"))
		}
		if (Place != 154) return;
		if (!this.isHere() && this.checkFlag(19) && !this.checkFlag(21)) addLinkToPlaceC(md, "look for the items from Mom's list", 154, "type=searchclothes");
		if (!this.isHere()) return;
		var perGabby = findPerson("Gabby");
		var clvG = perGabby.getCharmedLevel();
		if (this.charmed === 0) {
			if (this.other === 0) addQuestionC(md, '"Hey Mom"', "Mom", 2600);
			else if (this.other == 1) addQuestionC(md, '"Know how to make a little cash, Mom?"', "Mom", 2601);
			if (perYou.getExperience() >
				7 && this.other < 7) addQuestionC(md, '"Have any cash so I could run some errands at the ' + getShopStore() + 's, Mom?"', "Mom", 2607);
			if (perYou.getExperience() > 12 && this.other < 10 && nMoney < 20) addQuestionC(md, '"Could I have a bit of cash for the taxi?"', "Mom", 2610);
			if (perJesse.getDemonPath() == 60 && perJesse.place != 6) addQuestionC(md, '"A visitor, Mom?  Who? When was this?"', "Mom", 14460);
			if (isCharmedBy("Tracy") && !this.checkFlag(31)) addLinkToPlaceC(md, '"What about Tracy"', 154, "type=tracy")
		} else {
			if (this.getCharmedLevel() ==
				4)
				if (perYou.isMaleSex()) {
					addLinkToPlace(md, "be a motherfucker", 154, "type=momfuck");
					addLinkToPlace(md, "ask for a blowjob", 154, "type=mombj")
				} else {
					addLinkToPlace(md, "ask her to lick you", 154, "type=mombj");
					addLinkToPlace(md, "be a motherfucker", 154, "type=momfuck")
				}
			if (perGabby.isHere()) {
				if (this.getCharmedLevel() > 0) addLinkToPlace(md, "ask if you may watch", 154, "type=momgabbywatch");
				if (this.getCharmedLevel() != 1) addLinkToPlace(md, "ask if you may join", 154, "type=momgabbyjoin")
			} else if (this.getCharmedLevel() !=
				1 && getCharmedLevel("Tracy") == 2) addLinkToPlace(md, "call in Tracy for some family time", 154, "type=momtracythreesome")
		}
		if (getPersonCharm("OfficerKhan") == 10) addQuestionC(md, '"Hey Mom, what did you hear about ' + getOfficer() + ' Khan?"', "Mom", 5210);
		if (this.checkFlag(8) || wherePerson("Sarah") == 1 && getPersonOther("Sarah") === 0) addQuestionC(md, '"Any news from around town, Mom?"', "Mom", 2900);
		if (this.other > 1 && this.other < 5 && isMurderPath()) addQuestionC(md, '"Could you, uh... possibly wash my shirt for me?"', "Mom", 2605);
		if (this.other > 0 && !isCharmedPath() && !this.checkFlag(6) && perYou.getBankBalance() > 0 && !checkPersonFlag("Kristin", 13)) addQuestionC(md, '"Do you think you could help me get a credit card?"', "Mom", 2620);
		if (perGabby.isHere() && this.isCharmedBy()) addSleepLink(md, "ask to share the bed this night", "Sleeping with Mom and Gabby", '<p style="position:absolute;left:25%;top:85%;cursor:pointer;font-size:1.1em;width:70%">' + "You sleep tightly, snuggled between your hot Mom and her equally hot lover with lots of lewd dreams.",
			"People/Gabby/gabby-mom7.jpg");
		else if (this.getCharmedLevel() > 1) addSleepLink(md, "ask Mom to spend the night", "Sleeping with Mom", '<p style="position:absolute;left:5%;top:75%;cursor:pointer;font-size:1.1em;width:90%">' + "You ask Mom if you can sleep in her bed tonight,<br>" + '"Like when you were a child", she asks, knowing well that it will not be the same.', "mom-bed1.jpg")
	};
	per.showEventSleep = function(wt) {
		if (Place !== 46 && Place !== 170 && !perYou.checkFlag(14) && this.whereNow() == 154) perYou.setFlag(14);
		return false
	};
	per.handleItem = function(no, cmd) {
		if (no == 14 && cmd == 2)
			if (Place == 154) {
				if (this.isCharmedBy()) addComments("<img src='Images/" + this.getImg("mom6a.jpg") + "' style='width:20%;float:right;margin-bottom:1em;margin-left:5px' alt='Mom'>Your mother is already under your charm spell");
				else if (this.extra[0] < 1 && !this.checkFlag(2)) addComments("<img src='Images/" + this.getImg("mom6a.jpg") + "' style='width:20%;float:right;margin-bottom:1em;margin-left:5px' alt='Mom'>Not your mother!");
				else if (!this.checkFlag(7)) {
					var cost =
						perYou.checkFlag(17) ? 9 : 10;
					if (nMana < cost) addComments("You do not have enough mana to cast the spell.");
					else {
						setCommentsNoClick('<div style="margin-top:1em;margin-bottom:1em;margin-left:2em;margin-right:2em;cursor:default;">' + '<table><tr><td width="80%"><p>You decide to take the step and...protect..your mother and quietly recite the spell. You smell a faint smell of brimstone...</p>');
						addOptionLink("comments", "...but otherwise nothing happens", "setPersonFlag('Mom',7);dispPlace(undefined,'','<img src=\\'Images/" +
							this.getImg("mom6a.jpg") + "\\' style=\\'width:20%;float:right;margin-bottom:1em;margin-left:5px\\' alt=\\'Mom\\'>The spell fails, that demon must still be affecting her in some way!</p><p>If you want to...protect...her then you will have to find another way.')");
						addComments('</td><td width="20%"><img src="Images/' + this.getImg("mom6a.jpg") + '" style="width:95%;" alt="Mom"></td></tr></table>')
					}
				} else if (this.checkFlag(32) && !this.isCharmedBy()) addComments("<img src='Images/" + this.getImg("mom6a.jpg") + "' style='width:20%;float:right;margin-bottom:1em;margin-left:5px' alt='Mom'>You decided not to charm Mom at Gabby's home, so that is it, no point in changing your mind now.");
				else addComments("<img src='Images/" + this.getImg("mom6a.jpg") + "' style='width:20%;float:right;margin-bottom:1em;margin-left:5px' alt='Mom'>The spell still fails, the effects of the demon must be still present");
				return "handled"
			} else if (Place == 452 && !this.isCharmed())
			if (sType == "momnecklacemaster" || sType == "momnecklace") {
				CastCharmSpell("Mom", Place, 1, "type=momghcharm1");
				return "handled"
			} else {
				if (!this.checkFlag(32)) {
					addComments("You might need the necklace to undo Gabby's hypnosis, better get it before using the spell.");
					return "handled"
				}
			}
		else if (Place == 415) {
			if (sType.indexOf("lookmomgabby") != -1) addComments("You whisper the words and begin to cast the spell but something... is not right. A strange feeling of dread washes over you, as if it would be a really bad idea to use that spell now...</p>" + "<p>Maybe Gabby has some sort of protection in place? You can't risk it, better learn more about her and the necklace, first.");
			else if (this.checkFlag(32) && !this.isCharmedBy()) addComments("<img src='Images/" + this.getImg("mom6a.jpg") +
				"' style='width:20%;float:right;margin-bottom:1em;margin-left:5px' alt='Mom'>You decided not to charm Mom at Gabby's home, so that is it, no point in changing your mind now.");
			else if (this.isCharmedBy() && !isCharmedBy("Gabby")) addComments('The spell has no effect at all! Gabby looks at you oddly "What was that?" but is otherwise unaffected. Does this mean she is protected or that there is something else odd.');
			else if (!this.isCharmedBy()) addComments("You cannot charm both your mother and Gabby at once, you will have to separate them.");
			else addComments("You read a spell.... but it fizzles.");
			return "handled"
		}
		return ""
	};
	per.isPhoneable = function() {
		if ((this.place == 154 || this.place == 415) && perYou.isStuck()) return true;
		return checkPlaceFlag("Hotel", 11) && Place == 269 && this.whereNow() == 154
	};
	per.callThem = function() {
		if (Place == 269) {
			gotoPlace(Place, "type=mompool");
			receiveCall("", 'You call Mom to invite her to join you at the pool for a swim, and she immediately answers, "Sure ' + perYou.getPersonName() + ", why not. I'll be there in a while!\"");
			WriteCommentsFooter(bChat,
				bChatLeft)
		} else if (perYou.isStuck()) {
			if (isAtLocation(16))
				if (this.checkFlag(36)) receiveCall("", "You have no idea how to get back to town and call Mom for help,</p>" + '<p>"Ok, ' + perYou.getPersonName() + ' I can afford it this once, but you will have to pay me back! Tell the taxi driver I will pay the fare and have them call me if they doubt you."</p>' + addLinkToPlace("string", '"Thanks Mom', wherePerson("Mom") == 154 ? 45 : 359, "type=momtaxi") + addOptionLink("string", '"Not yet Mom, I\'ll call you back"', "dispPlace()"));
				else {
					this.setFlag(36);
					receiveCall("", "You realise you are a bit stuck and cannot quite work out how to get back to town, not enough money for the taxi " + (isSpellKnown("Teleport") ? "or mana to teleport somewhere else" : "") + ". You decide to call Mom for help. When she answers you avoid directly asking but Mom reaslises something is up and gets you to explain. She tells you,</p>" + '<p>"' + perYou.getPersonName() + ' you know money is tight, it would be difficult for me to pay for a taxi for you. Is there anyone else there who can help you out? Please check and I will see if I can afford to pay for a taxi for you. Call me back if you cannot work out anything."')
				}
			else if (this.checkFlag(37)) receiveCall("",
				"You have no idea how to get back to town and call Mom for help,</p>" + '<p>"Ok, ' + perYou.getPersonName() + ' I can afford it this once, but you will have to pay me back! Tell the taxi driver I will pay the fare and have them call me if they doubt you."</p>' + addLinkToPlace("string", '"Thanks Mom', wherePerson("Mom") == 154 ? 45 : 359, "type=momtaxi") + addOptionLink("string", '"Not yet Mom, I\'ll call you back"', "dispPlace()"));
			else {
				this.setFlag(37);
				receiveCall("", "You realise you are a bit stuck and cannot quite work out how to get back to town, not enough money for the taxi " +
					(isSpellKnown("Teleport") ? "or mana to teleport somewhere else" : "") + ". You decide to call Mom for help. When she answers you avoid directly asking but Mom reaslises something is up and gets you to explain. She tells you,</p>" + '<p>"' + perYou.getPersonName() + ' you know money is tight , it would be difficult for my to pay for a taxi for you. Is there anyone else there who can help you out? Please check and I will see if I can afford to pay for a taxi for you. Call me back if you cannot work out anything."')
			}
			WriteCommentsFooter(bChat,
				bChatLeft)
		}
	};
	per.addPersonPhoneCall = function() {
		if (perYou.checkFlag(14) && !this.checkFlag(11))
			if (makeCall(true, 200)) this.setFlag(11);
		if (this.checkFlag(20) && !this.checkFlag(19) && !bNewSMS)
			if (makeCall(false, "Mom", "\u201cHello " + perYou.getPersonName() + "!\u201d Mom's voice chimes out of the phone. \u201cI'm sorry honey, but it seems I have miscalculated just how long I will be needed here, could you do me a favor and get a few extra clothes from home?\u201d</p>" + "<p>Of course, it's no problem, and Mom sends you a small list of items with descriptions where to find them. She apologizes several times for not being at home for a few days, telling you where to find food, to do homework and not forget to study until you hear Gabby's voice in the background, impatiently calling her back to work.</p>" +
					"<p>\u201cI'm sorry, " + perYou.getPersonName() + "!.\u201d Mom laughs. \u201cMy \u201cbeloved\u201d assistant sometimes forgets that she is not the one in charge. I'll see you in a bit!\u201d</p>" + "<p>Mom hangs up, and you quickly open the list she had sent you. It contains enough clothes for 5 days, so this is likely how long she'll be with Gabby, but you may really want to bring everything to her as soon as possible.\"")) {
				this.setFlag(19);
				this.charmedTime = nTime;
				return true
			}
		if (this.checkFlag(20) && (!this.checkFlag(21) ||
				perYou.FindItem(66) > 0) && getHour() >= 18 && !this.checkFlag(32)) {
			var d = Math.floor(this.hoursCharmed("skip") / 24) + 1;
			switch (d) {
				case 1:
					if (!this.checkFlag(22))
						if (makeCall(true, 201)) this.setFlag(22);
					break;
				case 2:
					if (!this.checkFlag(23))
						if (makeCall(true, 202)) this.setFlag(23);
					break;
				case 4:
					if (!this.checkFlag(24))
						if (makeCall(true, 203)) this.setFlag(24);
					break
			}
		}
		return false
	};
	per.getPersonSMS = function(id) {
		if (id == 200) return receiveSMS("Mom", "Hey " + perYou.getPersonName() + " tell me if you are not going to spend the night at home, I missed you") +
			replyToSMS("Sorry Mom!");
		if (id == 201) return receiveSMS("Mom", "It's getting late, hun. Did something happen?") + replyToSMS("Agh, sorry Mom, something came up and I didn't make it.") + receiveSMS("Mom", "Don't worry about it. They lock the studio now for security reasons, but please make sure you bring everything tomorrow.") + replyToSMS("Will do.");
		if (id == 202) return receiveSMS("Mom", perYou.getPersonName() + "? I'm still waiting for you, and you are usually not that unreliable. Is everything alright?") + replyToSMS("Yes, of course. I must have gotten caught up in my homework, I'll bring everything by tomorrow.") +
			receiveSMS("Mom", "Please do so. Will it help if I promise to model the underwear?") + replyToSMS("What?") + receiveSMS("Mom", "Please ignore the last text, I really don't know why I wrote this.");
		if (id == 203) return receiveSMS("Mom", "You don't need to worry about the clothes anymore, dear. It turned out I really didn't need much to wear, anyway.") + replyToSMS("What do you mean?") + replyToSMS("Mom?");
		return ""
	}
}

function HydromancyBook() {
	if (!perYou.checkFlag(29) && isSpellKnown("Clairvoyance")) addComments('</p><p>She also points out a book on the shelf about divining using water, "This book talks about scrying with water and mentions Clairvoyance and Mana, maybe it will be of interest to you?". You will have to read it when you have a bit of free time.')
}

function RepliesMonique(nR) {
	var bCharm = per.isCharmedBy();
	var myName = per.getYourNameFor();
	if (nR == 21) {
		per.setFlag(2);
		if (!bCharm) addComments('"Sure, I love puzzles. What is it?" She asks.');
		else addComments('"Of course, ' + myName + '.  Anything you desire is yours."')
	} else if (nR == 51) {
		if (per.charmed < 2) per.charmed = 2;
		dispPlace(Place, "act=" + (perYou.isMaleSex() ? "bj" : "lick"));
		return false
	} else if (nR == 52) {
		Place = 8;
		per.charmed = 3;
		per.place = 10;
		bChat = false;
		addComments(per.addPersonFace());
		addComments('"More magic," says Monique. "Yes ' +
			myName + ', I will search for what you need."</p><p>With that she leaves the reference mentioning she has some ideas of where to research some information.')
	} else if (nR == 53) {
		PlaceI(5, 10);
		per.charmed = 4;
		addComments('Monique breathes, "I have found a strange stone ' + myName + '. I think that it is magical. Please take it."');
		HydromancyBook()
	} else if (nR == 54) {
		per.charmed = 5;
		per.place = 8;
		bChat = false;
		addComments(per.addPersonFace());
		addComments('"Yes ' + myName + '. I will keep searching for more magic," says Monique, quickly leaving to obey your commands.')
	} else if (nR ==
		55) {
		if (per.charmed < 2) per.charmed = 2;
		if (!isExplicit() && !perYou.isMaleSex()) dispPlace(Place, "act=plainfuck");
		else dispPlace(Place, "act=" + (perYou.isMaleSex() ? "fuck" : "strap"));
		return false
	} else if (nR == 61) {
		per.other = 2;
		addComments('"Mmm," murmurs Monique. "Do you know the author\'s name or the title? Or do you have any detailed <b>references</b> to the book to <b>give</b> me?"');
		if (gameState.nRightBarState != 1) showRightBar(1)
	} else if (nR == 63) {
		per.other = 11;
		if (!bCharm) addComments('"I have discovered something on the computers that you might be interested in," says Monique.');
		else addComments('"Oh ' + myName + '! I have found something on the computers!" says Monique, very pleased with herself.');
		addComments('  "According to historical records Mrs. Stears bore a son from the warlock Kurndorf. Since then seemingly magical coincidences have always revolved around the Stears family."');
		HydromancyBook()
	} else if (nR == 64) {
		per.other = 12;
		if (!bCharm) addComments('"Don\'t you know?" ');
		else addComments('"Oh ' + myName + ", thats the part I'm so excited about!\" ");
		addComments('replies Monique. "The last of the Stears was named Tara Stears.  She married a man by the name of Jeff Robbins, and has since had two children including one daughter named Geraldine."')
	} else if (nR ==
		65) {
		per.other = 13;
		perDavy.setQuestBlueBottle(1);
		addComments('"Yes! Mrs. Robbins is Davy and Tina\'s mother. They are descendants of Kurndorf."');
		if (!isPlaceKnown("RobbinsHouse")) {
			PlaceI(7);
			if (!bCharm) addComments('  Monique continues, "I took the liberty of getting their address for you from the phone book.  Here, take it."');
			else addComments('  Monique writes something down on a slip of paper.  "Here it is, ' + myName + ".  Have I done well?")
		}
	} else if (nR == 66) {
		if (per.other == 13) per.other = 14;
		else if (per.other ==
			4) per.other = 5;
		if (!bCharm) addComments('<p>"I\'ll see what else I can come up with," answers Monique. "At least it gives me something to do."</p><p>"One term I did see linked to Kurndorf was \'<b>Hellgate</b>\' and a name \'<b>Legion</b>\' but these are too generic to research quickly."');
		else addComments('"As you wish, ' + myName + '. I shall do as you command." She says, a shiver of pleasure running down her spine.');
		if (per.place > 0) per.place = 8
	} else if (nR == 67) {
		per.other = 3.1;
		addComments('<img src="Images/graveyard.jpg" style="width:20%;float:right;margin-left:5px;margin-bottom:1em" alt="Graveyard">"Just a bit of silliness...", she hesitates and looks behind her startled as if there was someone or something there. She continues,<br><br>"Sorry, I felt a chill...as I was saying, it was just a silly enquiry of public information but he offered a substantial donation to the library for a detailed history of the undead in Glenvale. You know, reports of ghost sightings, supposed vampires and the such. I collated all the reports I could find and delivered them. He said the information was useful, mainly in the timings of the reports."');
		startTimedEvent("if(getPersonOther('Monique')==3.1)setPersonOther('Monique',4)", 2)
	} else if (nR == 80) {
		setPersonFlag("Pamela", 9);
		addComments('Monique examines the bracelet and consults her computer, "' + myName + ', there is a small engraving, and a translation just reads "Twin Souls". I am sorry I cannot find anything else relevant.')
	} else if (nR == 192) {
		addComments("\"I have found a reference to the <b>'Wild Ranges'</b> but I do not know where they are. I would suggest you speak to someone with more knowledge on matters of the occult. What about the person who wrote that paper you showed me before?\"");
		setPlaceKnown("WildRanges")
	} else if (nR == 200) {
		addComments('"There is one text book on hypnosis listed in the catalogue, "Hypnotize this", but it was checked out last year and it was reported as lost by the person who checked it out"</p><p>You ask who had checked the book out?,</p><p>');
		if (bCharm) addComments('"' + myName + ' the person is Gabriel Halliway, we have an old address for her, but when we last contacted her about the book it seems she had moved."</p><p>Well that is not much of a problem, Miss Halliway is your mothers personal assistant!</p>');
		else addComments("\"I'm sorry " + myName + ', we cannot give out that information"</p>');
		per.setFlag(17)
	} else if (nR == 251) {
		var perAbby = findPerson("Abby");
		if (perAbby.getQuestDragonGem() == 1) perAbby.setQuestDragonGem(2);
		setPlaceKnown("Museum");
		if (whereItem(29) === 0) PlaceI(29, 240);
		if (!bCharm) addComments('<p>"Let me see," she says, turning to the computer.  After a few minutes of seemingly random clicking she perks up a bit.  "Ah, here we are."</p><p><img src="Images/Items/gem1.jpg" style="width:15%;float:right;margin-left:5px;margin-bottom:1em" alt="Gem">"It says here ');
		else addComments('<p>"Of course, ' + myName + '.  Right away." She says, turning to the computer and feverishly scouring the digital records for the information you requested.  "Here ' + myName + ', I have found something."</p><p><img src="Images/Items/gem1.jpg" style="width:15%;float:right;margin-left:5px;margin-bottom:1em" alt="Gem">"According to this ');
		addComments("there was once a gem that supposedly was so hot to the touch that it would burn anyone who attempted to hold it.  They believed that the heat was a manifestation of the raw magical power held within the stone. It was kept in a secret place near Glenvale alley but was later stolen. Monique shows you an illustration that is supposed to be the magic gem in question.</p>" +
			'<p>The thieves were evidently caught, along with many other stolen artifacts, but the gem was never recovered.  Something else, it seems one of them sustained severe burns to his hands during the attempt. Odd."</p>')
	} else if (nR == 307) {
		bChat = false;
		per.place = 8;
		setPlaceFlag("Hotel", 8);
		addComments(per.addPersonFace());
		addComments('"Hello ' + myName + '." She whispers.  "I overheard Davy asking the barmaid a few questions. Something about a hidden cellar under the hotel. I tried to find it ' + myName + ", but its evidently the <i>hidden</i> cellar for a reason.  I'm so sorry " +
			myName + '.  If only I could find the hotel blueprints, I could use it to find the cellar.", she says.</p><p>She gets up to leave - presumably to look for the hotel plans at the library.')
	} else if (nR == 1105) {
		perDavy.setPathHellgate(10);
		addComments('"As you wish, ' + myName + '.  I will go there immediately."');
		per.place = 8
	} else if (nR == 1110) {
		Place = 235;
		if (perDavy.getPathHellgate() == 10) perDavy.setPathHellgate(11);
		addComments('"Here we go...  Oh, look ' + myName + '! Davy has been reading about Glenvale."')
	} else if (nR ==
		1410) {
		if (!isPlaceKnown("Alley")) setPlaceKnown("Alley");
		setBeasleyServant(11);
		if (!bCharm) addComments("Let me see. The computer doesn't say much about it. ");
		else addComments('"One moment, ' + myName + ', let me see what I can find," she says, typing away at the computer.  ');
		addComments('Ah, here is something. A picture of a bull is in an old alley not far from here. That might be the answer."');
		return false
	} else if (nR == 2717) {
		perKurndorf.setQuestSeance(18);
		if (!bCharm) addComments('"Here is some information about what you want," says Monique and places an article on the desk.');
		else addComments('"As you wish ' + myName + '," Monique says, happy to serve you in any way she can.  A short while later she hands you an article.  "This is the most complete article I could find ' + myName + '.  I hope you are pleased."');
		PlaceI(26, 8)
	} else if (nR == 999) {
		setPersonOther("Kate", 998);
		addComments('<p>"Sure, ' + myName + ".  That's easy.  We'll just use Yahoo yellow pages.  What's the name?\" She asks innocently as she turns back towards the screen.</p>")
	} else if (nR == 998) {
		addComments('<p>"Yep, here we go." She says, printing out the address for you and then turning back to her research.</p>');
		setPersonOther("Kate", 997);
		if (whereItem(3) != Place) {
			PlaceI(3);
			setPlaceFlag("Alley", 6)
		}
	} else if (nR == 1E3) {
		addComments('"It is not in my references, ' + myName + ', sorry." she replies.');
		return false
	} else return RepliesPuzzles(nR);
	return true
}

function RepliesPuzzles(nR) {
	findPerson("Monique");
	if (Place == 8) addComments("<p><b>Monique</b></p>");
	else if (Place == 45) addComments("<p><b>Your Sister, Tracy</b></p>");
	if (nR == 73) {
		if (per.checkFlag(33)) addComments("\"That's a hard one. I know, it must be 'one word' What do you think?\"");
		else if (per.checkFlag(34)) addComments("\"That's a hard one. I know, it must be a 'bookkeeper' What do you think?\"");
		else if (per.checkFlag(35)) addComments("\"That's a hard one. I know, it must be 'balance' What do you think?\"");
		per.setFlag(3, false)
	} else if (nR == 74) {
		if (perDavy.checkFlag(33)) addComments("\"That's easy. I think that it is the letter, 'e' Am I right?\"");
		else if (perDavy.checkFlag(34)) addComments("\"That's easy. it is from a song by Meatloaf \"I'd do anything for love, but I won't do that\", so try 'but I wont do that' Am I right?\"");
		else if (perDavy.checkFlag(35)) addComments('"There are not many clues there, but you say he likes various type of Heavy Metal music, so do I by the way. My guess is this is from Metallica\'s song "Enter Sandman". I think that it is the word, \'Sandman\' Am I right?"');
		per.setFlag(4, false)
	} else if (nR == 75) {
		if (checkPlaceFlag("Crypt", 3)) addComments("\"That's easy. it is the word, 'modest' Am I right?\"");
		else if (checkPlaceFlag("Crypt", 4)) addComments("\"That's easy. it is the word, 'mason' Am I right?\"");
		else addComments("\"That's easy. it is the word, 'garlic' Am I right?\"");
		per.setFlag(5, false)
	}
	per.setFlag(2, false);
	return true
}

function RepliesLibraryResearch(nR) {
	addComments("<p><b>References</b></p>");
	if (nR == 251) {
		var perAbby = findPerson("Abby");
		if (perAbby.getQuestDragonGem() == 1) perAbby.setQuestDragonGem(2);
		setPlaceKnown("Museum");
		if (whereItem(29) === 0) PlaceI(29, 240);
		addComments("<p>One old history book mentions that there was once a gem that supposedly was so hot to the touch that it would burn anyone who attempted to hold it.  The people of that time, being much more superstitious than today, believed that this heat was a manifestation of the raw magical power held within the stone. For many years the gem was imprisoned in a secret place near Glenvale alley until some thieves raided the cell and took the gem." +
			"<br>The thieves were caught, along with many other stolen artifacts, but the gem has never been recovered.  Interestingly, a medical report written shortly after the thieves' capture mentions that one had sustained severe burns to his hands very recently.</p>")
	} else if (nR == 2717) {
		perKurndorf.setQuestSeance(18);
		addComments("After searching for almost an hour you locate an article in the mythology journal section that you think might work.");
		PlaceI(26, 8)
	}
	return true
}

function initialiseMonique() {
	addPerson("Monique", 8);
	per.Replies = RepliesMonique;
	per.isPersonInfo = function() {
		return this.other > 0
	};
	per.getPersonInfo = function() {
		var s = "<img src='Images/monique2.jpg' class='imgpopup' alt='Monique'>";
		if (this.isCharmedBy()) return s + "Monique is your ever faithful slave, ready to serve you in any way you desire.<br>She is a little nervous and often teased for it by the other staff members.";
		return s + "Monique is the database administrator for the Glenvale Library.<br><br>A lovely woman with a nervous disposition."
	};
	per.whereNow = function() {
		if (this.place != 8 || this.place != 237) return isDay() ? this.place : 237;
		if (isShopOpen(2, 1, true)) return 8;
		return 237
	};
	per.passTimeNight = function() {
		if (this.place == 279 && Place != 279) {
			this.place = 8;
			return '<table><tr><td style="width:15%;vertical-align:top"><img src="UI/phonecall.png" style="width:95%" alt="Phone Call"></td><td><p><b>Phone call from Monique</b><br>"Hannah is closing the shop, I will have to go home now, please let us do this another day ' + perYou.getMaster() + '"</p></td></tr></table>'
		}
		return ""
	};
	per.isPlaceImageRight = function() {
		return this.whereNow() == 279 && Place == 279
	};
	per.showPlaceImageRight = function(md) {
		this.showPerson("monique12a.jpg")
	};
	per.showPersonTextHere = function(md) {
		if (this.whereNow() == 279 && Place == 279)
			if (!this.checkFlag(19)) {
				md.write("<p>Hannah seems to be talking to a friend, and only after they turn around to face you, you actually recognize the other girl as Monique, whose new outfit is the complete opposite of everything you have seen her in so far.</p>" + "<p>\u201c" + perYou.getPersonName() +
					"!\u201d Monique jumps as she sees you, fidgeting nervously for a moment while her eyes dart between Hannah and you, before she places both hands on her hips and tries to assume a confident posture.</p>" + "<p>\u201cI... bought these a while back but never really had the courage to wear it... or show it to someone... how do I look?\u201d</p>" + "<p>\u201cLike you're ready to " + (perYou.isMaleSex() ? "suck his cock" : "lick her pussy") + ".\u201d Hannah chimes in before you are able to answer, and Monique's head turns into a deep shade of red. \u201cHannah!\u201d</p>" +
					"<p>\u201cBitch, I already told you that you look gorgeous, stop being so nervous and enjoy it.\u201d The two share a laughter, and you agree that you really like Monique's look, putting her more at ease");
				if (!isSpellKnown("Shielded Charm")) md.write(" as she takes you aside and whispers.</p>" + '<p>"There is writing on the back of the gem and it describes a ritual, let me help you to learn it..." Hannah cheekily interrupts, "Hey this is my customer, no touting for business here Ho!", and she laughs, it would seem they enjoy some crude banter...</p>');
				else md.write(".</p>");
				this.setFlag(19)
			} else {
				md.write("<p>You see Hannah. the mechanic, and Monique chatting, discussing some repair work on a truck. The friends are laughing and talking animatedly to each other. ");
				if (!isCharmedBy("Hannah")) {
					md.write('Hannah tears herself away and turns to you with her "talking to the customer" smile.  "Can I help you with something?" she asks.</p>');
					if (!isSpellKnown("Shielded Charm")) md.write("<p>Monique steps over and whispers to you,<br/>" + '"There is writing on the back of the gem, it describes a ritual, let me help you to learn it..."');
					else md.write("<p>Monique smiles at you, waiting for your next request and starts to speak...")
				} else {
					md.write('Hannah seems excited that you have returned.  "How may this humble servant be of service?  Perhaps you would like me to... check your fluids?" she asks, a hint of mischief in her eyes.</p>');
					if (!isSpellKnown("Shielded Charm")) md.write("<p>Monique tells you,<br/>" + '"There is writing on the back of the gem, it describes a ritual, let me help you to learn it?"</p>');
					else md.write("<p>Monique smiles at you, waiting for you next request and starts to speak...</p>");
					md.write('<p>Hannah cheekily says, "Maybe we can work together to service your ride?"</p>')
				}
			}
	};
	per.showPersonChat = function(bGeneral, md) {
		if (this.whereNow() == 279 && Place == 279 && sType === "") {
			if (!isSpellKnown("Shielded Charm")) addOptionLinkC(md, "ask Monique to teach you the spell", isRunes() ? "Research('Spell', 'NeoOne')" : "dispPlace(280,'type=monique')");
			addPopupLinkC(md, "ask Monique to return to the library", "Monique Leaves", "<p><img src='Images/monique12b.jpg' style='width:30%;float:right;margin-left:5px' alt='Monique'>" +
				"You casually tell Monique to return back to the library, and you see she quickly pulls off her top,</p>" + '<p>"I will have to change, but when you next visit the Library I hope you will take me for a ride!"</p>' + '<p>Hannah comments "You go girl!"</p>', true, "movePerson('Monique',8);dispPlace();");
			if (!isCharmedBy("Hannah")) addLinkToPlaceC(md, "perform a quick stress-test with Monique", Place, "type=moniquecheck")
		}
		if (this.isHere() && wherePerson("Hannah") == 457 && !this.checkFlag(20)) addQuestionR(md, "ask about Hannah",
			"\"Hannah said she has to visit relatives for a few days. She didn't seem happy about it, though, and I have no idea when she will be back.\u201c</p>" + "<p>\u201cOf course.\u201c She smiles sweetly.\u201cThis means we have the whole apartment to ourselves right now.\u201c", "Monique", "setPersonFlag(\\'Monique\\',20);setPersonFlagAfterTime(\\'Hannah\\',6,true,35)");
		if (Place == 10 && isShopOpen(2) && this.isHere()) {
			if (this.charmed == 3) addQuestionC(md, "ask Monique if she has found anything", "Monique", 53);
			if (this.other ==
				10) addQuestionC(md, "ask Monique what she is doing back at the school", "Monique", 63);
			else if (this.other == 11) addQuestionC(md, 'ask "What about the Stears family?"', "Monique", 64);
			else if (this.other == 12) addQuestionC(md, 'ask "So...  That means Mrs Robbins is ..."', "Monique", 65);
			else if (this.other == 13) addQuestionC(md, "tell Monique to research more about the Robbinses", "Monique", 66);
			else if (this.charmed === 4 || this.charmed === 5) {
				if (this.charmed === 4 && !this.checkFlag(18)) {
					startAlternatives(md);
					addPopupLinkC(md,
						"tell Monique to play with herself as a reward", "Rewarding Monique", "<img src='Images/" + (isExplicit() ? "Explicit/" : "") + "monique14.jpg' class='imgpopup' alt='Monique'>" + 'Monique does as she is ordered. "Oh thank you ' + this.getYourNameFor() + '," she cries.' + "<br><br>" + "Monique enjoys herself, thanking you for being so kind.", true, "setPersonFlag('Monique',18);dispPlace();");
					addPopupLinkC(md, "tell Monique she may pleasure you as a reward", "Rewarding Monique", "<img src='Images/" + (isExplicit() ? "Explicit/" :
						"") + (!perYou.isMaleSex() && isExplicit() ? "monique10ga" : "monique14b") + ".jpg' class='imgpopup' alt='Monique'>" + 'Monique does as she is ordered, for her your pleasure is her pleasure. "Oh thank you ' + this.getYourNameFor() + '," she cries.' + "<br><br>" + "Monique enjoys herself giving you pleasure and afterwards thanking you for being so kind.", true, "setPersonFlag('Monique',18);dispPlace();");
					endAlternatives(md)
				}
				addQuestionC(md, "order Monique to find you some more magic", "Monique", 54)
			}
		}
	};
	per.showEventPopup =
		function() {
			if (Place == 8 && sType == "moniquereadingharder") showPopupWindow("Monique Reading", "<img src='Images/monique3a.jpg' style='width:40%;float:right;margin-left:5px' alt='Monique'>" + "You see the book, Fifty Shades of Grey on Monique\u2019s desk and you become curious.<br><br>" + '"Why are you reading that?", you point to the book, acting somewhat angered.<br><br>' + '"Ohh, ' + perYou.getMaster() + ", it was before you came along that I\u2019ve read that book! It's such a famous book I knew I had to read to it! And I always had a thing for erotic novels, especially ones featuring BDSM.\", she says defensively.<br><br>" +
				"\"For a moment I thought I couldn't satisfy your needs, that's why you're reading it.\", you tell her cunningly. You want her to feel bad and shameful. " + "Monique spins around, rushing towards you and start to kneel in front of you, bowing at your feet.<br><br>" + '"Forgive me, ' + perYou.getMaster() + "! That was not my intention, this book was just lying around. I didn't even like it! Please, forgive this slut of yours for her wrong doing!\", Monique says, begging you.<br><br>" + '"Well, from now on, you don\'t need these types of damn books! All you need is me to live out your desires. Do you understand?", you ask your librarian.<br><br>' +
				'"Yes, of course!", she bows her head while simultaneously kissing your feet.<br><br>' + '"I am very disappointed in you. You have to earn my trust again!", you say. You see she\'s fighting with her tears, so after a few seconds of silent waiting you hug her and give her a kiss on her pretty face.<br><br>' + '"I understand, ' + perYou.getMaster() + '! I should have known better that there can be nothing else in my life except you!", she says somewhat relieved. ' + "You tell her to go back to work. She bows one last time and returns to her desk, but with one quick action she throws the book into the garbage bin. You smile to yourself. You know it was all just a play to encourage her to work harder. You have done what you wanted, now she will be extremely focused to earn back your attention and trust.",
				"setPersonFlag('Monique',16)", "top:5vh;height:85vh");
			if (Place == 8 && sType == "moniquereadingkinks") showPopupWindow("Monique Reading", "<img src='Images/monique3a.jpg' style='width:40%;float:right;margin-left:5px' alt='Monique'>" + "You see the book, Fifty Shades of Grey on Monique\u2019s desk and become curious.</p>" + '<p>"Why are you reading that?" You ask, and inevitably startle her.</p>' + "<p>\u201cOhhh, " + perYou.getMaster() + ", it was before you came along that I\u2019ve read that book! It's such a famous book I knew I had to read to it! And I always had a thing for erotic novels, especially ones featuring BDSM.\" she says defensively.</p>" +
				"<p>\u201cBDSM?\u201d You smirk. \u201cYou are not keeping any kinky desires a secret from me, are you, Monique?\u201d</p>" + "<p>\u201cNo!\u201d Monique spins around and almost falls off her chair. \u201cI mean, I would never intentionally keep secrets from you! The topic is fascinating but that doesn't mean I would want you to tie me up and spank me or even \u201cwant\u201d you to do anything and I didn't even like that book so please forgive me, I...\"</p>" + "<p>You interrupter her before she can talk herself into a nervous frenzy and assure her that you are not mad at her, calming her a little before asking the essential question.</p>" +
				"<p>\u201cBe honest, Monique, do you fantasize about being tied up and dominated?\u201d</p>" + "<p>\u201cI...Yes.\u201d Monique is clearly struggling with herself before she admits it. \u201cB-... but I would never dare to actually demand of you to...\u201d</p>" + "<p>\u201cSimple answers.\u201d You interrupt her, and she falls silent. \u201cI expect you to tell me of such desires in the future, and if you are a good slave, and I am able to, I may even fulfill them.\u201d</p>" + "<p>Monique's eyes light up s you say that, and she looks up to you with utter devotion now. \u201cOf course! I mean, I don't think I'm ready for...\u201d She looks at the book. \u201c...this just yet, but thank you, " +
				perYou.getMaster() + ", Thank you!\u201d</p>" + "<p>The two of you share a hug and a brief kiss before Monique heads back to work with renewed devotion for you. Finding out about her hidden desires is a good step towards making her enjoy her enslavement even more, and who wouldn't like to have a happy, kinky slavegirl?\"", "setPersonFlag('Monique',16)", "top:5vh;height:85vh");
			if (sType !== "") return false;
			if (Place == 8 && isShopOpen(2, 1, true) && this.isHere() && this.charmed > 4 && !this.checkFlag(16)) showPopupWindow("Monique Reading",
				"<img src='UI/books/shadesbook.jpg' style='width:15%;float:right;margin-left:5px' alt='Book'>" + "You see the book, Fifty Shades of Grey on Monique\u2019s desk and you become curious.</p>" + addOptionLink("string", "This is a good opportunity to get her to work even harder", "dispPlace(Place,'type=moniquereadingharder')", "chatblock", "width:50%;margin-left:10%") + addOptionLink("string", "This is a good opportunity to learn about her kinks", "dispPlace(Place,'type=moniquereadingkinks')", "chatblock", "width:50%;margin-left:10%") +
				addOptionLink("string", "On second thought, you just ignore it", "setPersonFlag('Monique',16);dispPlace(Place,'','Monique really may enjoy whatever books she likes, no need to interfere here.')", "chatblock", "width:50%;margin-left:10%"), "", "", true, true);
			return false
		};
	per.showEvent = function() {
		var md;
		if (Place == 269 && sType == "moniquepool") {
			WaitHereOnly(6);
			md = WritePlaceHeader();
			this.showPerson("monique-pool.jpg");
			addPlaceTitle(md, "Swimming with Monique");
			md.write("<p>Monique steps out of the changing room dressed in a sexy bikini, looking a bit more confident than usual. Unfortunately spoiled a little when she starts as she glances over at a noise, it was just someone diving into the pool.</p>" +
				"<p>You encourage her to join you for a swim, but you canny help but admire her figure and that areas here are quite disrete and private...</p>");
			startQuestions();
			addLinkToPlaceC(md, "it is fairly private here...", Place, "type=moniquepoolsex");
			addLinkToPlaceC(md, "chat to her and then say goodbye to Monique", Place);
			WritePlaceFooter(md);
			return true
		}
		if (Place == 269 && sType == "moniquepoolsex") {
			md = WritePlaceHeader(false, "td-left-med");
			this.showPerson("monique-pool-sex.jpg");
			addPlaceTitle(md, "Being Discrete and Private with Monique");
			md.write("<p>You ask your nervous librarian to play with you more privately, and she seductively removes most of her bikini, ready for you!</p>");
			startQuestions();
			addLinkToPlaceC(md, "later...say goodbye to Monique", Place);
			WritePlaceFooter(md);
			return true
		}
		if (Place == 283) {
			if (sType == "moniquebj") {
				md = WritePlaceHeader();
				if (isExplicit())
					if (perYou.isMaleSex()) this.showPersonX("monique14b.jpg");
					else this.showPersonRandomX("monique10g", 2);
				else if (perYou.isMaleSex()) this.showPerson("monique14b.jpg");
				else this.showPersonRandom("monique10g",
					2);
				addPlaceTitle(md, "Monique's Soft Lips");
				if (perYou.isMaleSex()) {
					md.write("<p>Sometimes, words are not needed. Monique stands in front of you at the ready, and as you open your pants and gesture to the ground before you, your ever faithful slave immediately understands and crouches down.</p>" + "<p>Monique's tongue begins to slide eagerly over your manhood, covering you in her saliva and using her hand to get you erect, and doing a good job at it. You place one hand on your hip and drive the other through her hair, watching her as her lips wrap over the tip and begin to slide back and forth, enjoying your slaves administration.</p>" +
						"<p>\u201cYou practiced, did you?\u201d You ask her, and the response is a muffled grunt of confirmation before she takes you in all the way to the base as if to show of the results of it. You definitely approve.</p>" + "<p>It doesn't take her long to bring you close to the edge and when the moment comes, you take a hold of her hair to keep her in place and shoot your load into her mouth.</p>" + "<p>Monique waits patiently, swallowing every drop as ordered and eagerly cleaning when might be left with her tongue after you let go of her.</p>");
					if (wherePerson("Hannah") == 237) md.write("<p>At one point during the session, you see Hannah passing by the door with a snack in hand, giving the two of you a thumbs up and remaining there to watch for a while before heading back into her own room.</p>")
				} else {
					md.write("<p>You grab Monique's hair and pull the woman into a kiss as a greeting before simply sitting down on her chair and ordering her to knee in front of you.</p>" + "<p>Monique is taken aback by your directness at first, nervously fidgeting with her fingers before quickly following up on your order and helping to undress you.</p>" +
						"<p>You smile as you wait for her to finish and lazily lean back, one of your legs now resting on her desk to present your sex to her. \u201cYou know what to do, my pet.\u201d</p>" + "<p>\u201cY...yes Mistress.\u201d Monique clearly isn't used to such a treatment, and it does take her a moment to \u201cfind her flow\u201d so to say, but with a few subtle pointers from you, she begins to lure the first subtle moans from your lips.</p>" + "<p>You praise her advances and she seems to grow more confident, her tongue now flicking over your clit before she sucks it inside with her lips and decides to use her fingers to help out.</p>" +
						"<p>Soon, her efforts bear fruit, you feel your body tremble a little as your climax begins to build up and firmly take a hold of Monique's hair and press her closer against your twitching fold as you finally reach your peak. Once again praising your eager pets success.</p>");
					if (wherePerson("Hannah") == 237) md.write("<p>At one point during the session, you see Hannah passing by the door with a snack in hand, giving the two of you a thumbs up and remaining there to watch you for a while before heading back into her own room.</p>")
				}
				startQuestions();
				addLinkToPlace(md, "talk more to Monique", 283);
				addLinkToPlace(md, "leave Moniques's room", 237);
				addLinkToPlace(md, "leave the apartment", 194);
				WritePlaceFooter(md);
				return true
			}
			if (sType == "moniquefuck") {
				md = WritePlaceHeader(false, isExplicit() ? "" : "td-left-large");
				if (perYou.isMaleSex()) this.showPersonRorX("monique18.jpg");
				else this.showPersonRandom("monique11g", 3);
				addPlaceTitle(md, "Take Monique");
				if (perYou.isMaleSex()) {
					md.write("<p>Well, for starters,\u201d You tell her with a smile. \u201c...you could slip out of your clothes, lie down on the bed and let me fuck you, my lovely servant.\u201d</p>" +
						"<p>There is a moment of hesitation in which Monique seems to process what you just said and a profound blush appears on her cheeks.</p>" + "<p>\u201cOh! Of course!\u201d She hastily pushes her nightie over her head.\u201d Please pardon the delay, Master, I did not mean to make you wait!\u201d</p>" + "<p>You admit that it's cute how she still gets nervous and is taken aback by direct orders like these, but still tell her that you expect better of your servants, and order her to put on a bit of a show while you remove your own clothes to make up for the delay, and Monique eagerly complies.</p>" +
						"<p>Monique is no professional stripper and her nerves sometimes get the better of her when she serves you like this, but she tries her best to move sensually, and you certainly enjoy watching her slowly remove that nightie, take off her glasses and finally recline with a gentle moan and push up her hip to remove her panties.</p>" + "<p>\u201cLovely show, my pet.\u201d You comment her and slip on the bed, aligning your cock with her folds. \u201cIs your pussy ready for me?\u201d</p>" + "<p>\u201cY....yes master.\u201d Monique nods quickly and bites her lower lips, watching you expectantly.</p>" +
						"<p>\u201cGood girl.\u201d You push into her without further delay and begin to grind your hip against her body, your motions quickly picking up in pace.</p>" + "<p>\u201cOhhh, Thank... thank you, master.\u201d Monique rolls her head back and just lets you take her, her lovely breasts jiggling with every rough motion you make and her fingers feverishly rubbing over her clit to stimulate her further.</p>" + "<p>It doesn't take long for both of you to reach your climax, and as you do, you place one of her legs against her shoulder and lean forward, embedding your cock as deeply into her as you can as you shoot of your load while her body twitches underneath you.</p>");
					if (wherePerson("Hannah") == 237) md.write("<p>Monique's body slowly comes to rest, and you see that Hannah has apparently decided to check on the two of you, likely attracted by Monique's moans. She is standing in the doorway, breasts exposed and her hand deep inside her pants, giving you a sly grin as she realizes you finally noticed her.</p>")
				} else {
					md.write("<p>\u201cWell, for starters,\u201d You tell her with a smile. \u201c...you could slip out of your clothes, lie down on the bed and let me fuck you, my lovely servant.\u201d</p>" +
						"<p>There is a moment of hesitation in which Monique seems to process what you just said and a profound blush appears on her cheeks.</p>" + "<p>\u201cOh! Of course!\u201d She hastily pushes her nightie over her head.\u201d Please pardon the delay, Mistress, I did not mean to make you wait!\u201d</p>" + "<p>You admit that it's cute how she still gets nervous and is taken aback by direct orders like these, but still tell her that you expect better of your servants, and order her to put on a bit of a show while you remove your own clothes to make up for the delay, and Monique eagerly complies.</p>" +
						"<p>Monique is no professional stripper and her nerves sometimes get the better of her when she serves you like this, but she tries her best to move sensually, and you certainly enjoy watching her slowly remove that nightie, take off her glasses and finally recline with a gentle moan and push up her hip to remove her panties.</p>" + "<p>You use the time to undress and prepare your trusty strap on, making sure Monique has a good view as you fasten the straps and spread a bit of lube around it.</p>" +
						"<p>\u201cYou know what happens next, do you?\u201d You ask in a teasing voice, and Monique quickly nods. \u201cYes Mistress\u201d.</p>" + "<p>\u201cTurn around!\u201d</p>" + "<p>Your pet immediately complies and presents her rear to you, her legs slightly spread and her body shaking in anticipation as you move behind her and begin to rub the tip of the strap-on over her clit and folds and finally push all the way into her with a single, rough motion.</p>" + "<p>Monique reacts beautifully, Her body jerks forward, but she immediately catches herself and pushes her hip against yours while you begin to move, her fingers digging into sheets with every rough motion.</p>" +
						"<p>\u201cHmmyesyesyes... thank you mistress.\u201d Monique groans, screams, and occasionally gives a little yelp when you slap her rear or pull her hair, enjoying every little bit of stimulation and quickly reaching her peak, her entire body shuddering under the sensation and finally collapsing on the bed, gasping for air.</p>");
					if (wherePerson("Hannah") == 237) md.write("<p>Monique's body slowly comes to rest, and you see that Hannah has apparently decided to check on the two of you, likely attracted by Monique's moans. She is standing in the doorway, breasts exposed and her hand deep inside her pants, giving you a sly grin as she realizes you finally noticed her.</p>")
				}
				startQuestions();
				addLinkToPlace(md, "talk more to Monique", 283);
				addLinkToPlace(md, "leave Moniques's room", 237);
				addLinkToPlace(md, "leave the apartment", 194);
				WritePlaceFooter(md);
				return true
			}
			if (sType == "endcharm") {
				md = WritePlaceHeader();
				this.showPerson("moniquehome7.jpg");
				addPlaceTitle(md, "Slave Monique");
				md.write('<p>"Please command me, ' + perYou.getMaster() + '.  I live to serve, and I serve only you."' + "Monique says in a honeyed voice, her fingers lightly pinching her nipples and every pore of her being dripping sex.</p>" +
					"<p>You have added a servant to your harem. Monique is eager to do whatever you want, and to please you in any and every way she can. All you have to do is command her and she is yours.</p>");
				startQuestions();
				addLinkToPlace(md, "talk more to Monique", 283);
				addLinkToPlace(md, "leave Moniques's room", 237);
				addLinkToPlace(md, "leave the apartment", 194);
				WritePlaceFooter(md);
				return true
			}
		}
		if (Place != 279 || this.whereNow() != Place) return false;
		if (sType == "moniquecheck") {
			md = WritePlaceHeader();
			this.showPersonRorX(perYou.isMaleSex() ?
				"monique17.jpg" : "monique16.jpg");
			addPlaceTitle(md, "Moniques Test");
			if (perYou.isMaleSex()) md.write("<p>You tell Monique that you want to look further into the stones writing and take her to the back of the workshop, where a Van had been rather conveniently placed. It's deep enough inside to be safe from nosy passersby', and large enough to block even Hannah's view, which gives you an idea.</p>" + "<p>Monique begins to dutifully spread out her notes and opens one page of the book, pretty much oblivious to the fact that you have already opened your pants and letting your manhood hang down freely behind her head.</p>" +
				"<p>Suffice to say, she is startled when she spins around and comes face to face with your half erect cock, her eyes widening with a gasp and rolling up to you.</p>" + "<p>\u201cHere?\u201d She whispers, and you simply nod.</p>" + "<p>\u201cBut...\u201d She looks around if anyone might see her, and you shake your head. \u201cNo one will notice, if you can be quiet.\u201d</p>" + "<p>Monique pulls her lower lip in and once more glances around, her hands shaking a little as she reaches for your shaft, and begins to thoroughly wet it with her tongue until it stands fully erect and her lips wrap around it.</p>" +
				"<p>You allow her to move her head a few times, but don't intend to let her off that easy, firmly grabbing her hair to pull her away from you while motioning her to take off her pants.</p>" + "<p>Monique nervously looks around once more, but follows suit surprisingly fast, getting rid of her jeans while you sit down, and straddling you when you pull her closer.</p>" + "<p>She wastes no time to guide the tip of your cock to her sex and push her hip down, barely able to muffle a lewd noise as she does so, and begins to push her body up and down.</p>" +
				"<p>\u201cSurprisingly eager all of the sudden...\u201d You teasingly whisper to her ear and place two fingers on her clit, and this time you need to stifle her moan by placing your other hand on her lips.</p>" + "<p>\u201cShhh...\u201d you remind her playfully. \u201cOr do you want your friend to find you?\u201d</p>" + "<p>Monique shakes her head, but her face is flushed red and, all nervousness aside, you are not sure you have ever seen her so aroused. Her pussy is almost clamping down on your intruding manhood with every motion she makes while her entire body trembles in your grasp.</p>" +
				"<p>She spreads her lips and begins to suck on your fingers, doing her best to stifle the amount of noise she makes until you suddenly feel her folds constrict harder around her, her Climax sudden and powerful, even without the need to amplify it with the spell, and quickly dragging you along with it.</p>" + "<p>You like this side of the usually ever nervous Monique, and as she begins to redress, you tell her that you will keep her underwear as a reminder of this little adventure, stiffing any protest by pressing a finger to her lips and smiling at her.</p>" +
				"<p>Monique returns the smile and nods, taking her clothes and returning to the front of the " + getShopStore() + ", where Hannah is still working on her Bike, none the wiser... well... maybe... did she just give Monique a wink?</p>");
			else md.write("<p>You tell Monique that you want to look further into the writing and take her to the back of the workshop, where a Van had been rather conveniently placed. It's deep enough inside to be safe from nosy passersby', and large enough to block even Hannah's view, which gives you an idea.</p>" +
				"<p>Monique begins to dutifully spread out her notes and opens one page of the book, pretty much oblivious to the fact that you have already stripped out of your clothing, and just wait for her to turn around.</p>" + "<p>Suffice to say, she is startled when she finally does and comes face to face with your already waiting mound, her eyes widening with a gasp and rolling up to you.</p>" + "<p>\u201cHere?\u201d She whispers, and you simply nod.</p>" + "<p>\u201cBut...\u201d She looks around if anyone might see her, and you shake your head. \u201cNo one will notice, if you can be quiet.\u201d</p>" +
				"<p>Hannah pulls her lower lip in and once more glances around, her hands shaking a little as she reaches to spread your folds and begins to drag her tongue along the entire length.</p>" + "<p>You allow her to lick you a few times, her tongue tickling your clit, just like practiced, you but don't intend to let her off that easy, firmly grabbing her hair after a while to pull her away and motioning for her to take off her pants.</p>" + "<p>Monique nervously looks around once more, but follows suit surprisingly fast, getting rid of her jeans while you open the door to the back of the van and order her to spread her legs for you.</p>" +
				"<p>Monique pulls in her lower lip and complies while you start to tease her with your fingers, spreading her folds to massage her inner walls and rubbing over her clit before placing one knee onto the van and pulling her hip against yours with a forceful yank.</p>" + "<p>Monique barely stifles a moan as your folds begin to rub against her pussy, your thumb still flicking over her clit as you lean in to press a finger to her lips.</p>" + "<p>\u201cShhh...\u201d you remind her playfully. \u201cOr do you want your friend to find you?\u201d</p>" +
				"<p>Monique shakes her head, but her face is flushed red, but all nervousness aside, you are not sure you have ever seen her so aroused. Her entire body is trembling as you push two fingers past her lips for her to suck on and begin to grind your hip against hers</p>" + "<p>Her tongue lewdly trails around your fingers while she does her best to stifle the amount of noise she makes with decreasing efficiency, her muffled moans getting louder the moment your free hand returns to her clit, and her Climax sudden and powerful, even without the need to amplify it with the spell.</p>" +
				"<p>You like this side of the usually ever nervous Monique, and as she begins to redress, you tell her that you will keep her underwear as a reminder of this little adventure, stiffing any protest by pressing your soaked finger to her lips and smiling at her.</p>" + "<p>Monique returns the smile and nods, taking her clothes and returning to the front of the " + getShopStore() + ", where Hannah is still working on her Bike, none the wiser... well... maybe... did she just give Monique a wink?</p>");
			startQuestions();
			addLinkToPlaceC(md, "talk to Hannah some more", 279);
			WritePlaceFooter(md);
			return true
		}
		return false
	};
	per.handleItem = function(no, cmd) {
		if (no == 14 && cmd == 2)
			if (Place == 8 && this.isHere()) {
				if (checkPlaceFlag("Library", 2) || isSpellKnown("Shielded Charm"))
					if (this.other === 0) addComments("You do not know her name, so the spell will not work.");
					else CastCharmSpell("Monique", 20, 1);
				else addComments("Don't cast the spell here. It is too public.");
				return "handled"
			} else if (Place == 283) {
			if (this.other === 0) addComments("You do not know her name, so the spell will not work.");
			else CastCharmSpell("Monique", 20, 1, "type=charmhome");
			return "handled"
		}
		return ""
	};
	per.isPhoneable = function() {
		return checkPlaceFlag("Hotel", 11) && Place == 269 && this.isCharmedBy()
	};
	per.callThem = function() {
		if (Place == 269)
			if (this.place != 8) WriteComments("You call Monique to invite her to join you at the pool for a swim, but there is no answer");
			else if (isShopOpen(2, 1, true)) WriteComments("You call Monique to invite her to join you at the pool for a swim, but she timidly answers that the library is open now, but once it closes she can");
		else {
			gotoPlace(Place, "type=moniquepool");
			receiveCall("", 'You call Monique to invite her to join you at the pool for a swim, and she answers hesitantly, "Ok, I\'ll be there soon".');
			WriteCommentsFooter(bChat, bChatLeft)
		}
	};
	per.getPersonSMS = function(id) {
		switch (id) {
			case 190:
				return receiveSMS("Monique", "Okay... It's a little embarrassing, but I really hope you like it, " + perYou.getMaster() + ".", "moniquesms1.jpg") + replyToSMS("It's lovely. :)") + receiveSMS("Monique", "Thank you, " + perYou.getMaster() + " And Hannah was right, this is exciting!")
		}
		return ""
	}
}

function RepliesMotherSuperior(nR) {
	switch (nR) {
		case 15101:
			setPlaceFlag("Church", 7);
			setQueryParams("type=stopped&from=chalice");
			break;
		case 15102:
		case 15103:
		case 15104:
			if (!checkPlaceFlag("Church", 7)) {
				setPlaceFlag("Church", 7);
				setQueryParams("type=stopped&from=" + nR)
			} else {
				bChatLeft = false;
				addComments(per.addPersonFace());
				addComments('Mother Superior appears before you wagging her finger as if to wield a sword against you.  "And just where do you think <i>you\'re</i> going?" she asks.  "You have no business other than here in this place of God."</p>')
			}
			break;
		case 3E3:
			setPersonFlag("Ghost", 12);
			addComments("You ask the Mother Superior about ghosts and what keeps them tied to a particular place, and if they can move from that place,</p>" + '<p>"My ' + perYou.getWitch(true) + " the church does not acknowledge the existence of ghosts, the dead go to their eternal reward. Demons and evil spirits can walk the earth but an exorcist is needed to handle them.</p>" + 'Except, you may wish to speak to Sister Desiree, before she became a Nun she had some experience with ghosts as a so-called ghost hunter."</p>');
			break
	}
	return true
}

function initialiseMotherSuperior() {
	addPerson("Daria", 382);
	per.Replies = RepliesMotherSuperior;
	per.isPersonInfo = function() {
		return this.checkFlag(12)
	};
	per.getPersonInfo = function() {
		return "<img src='Images/" + this.getImg("mothersuperior5a.jpg") + "' class='imgpopup' alt='Mother Superior'>" + "Daria, the Mother Superior, is the zealous leader of the Cult of Flesh. A religious group believing that you are their " + (perYou.isBornMale() ? "God" : "Goddess") + ". She serves you without ever questioning your will and would go miles just to please you in the slightest way.<br><br>" + "Daria was strangely unresponsive to your suggestions. It was her faith and strong will that guided her against you. It was a rocky road to charm her, but you\u2019ve done it. Immediately after you enslaved her, she begged for forgiveness. She told you that you are her " +
			(perYou.isBornMale() ? "God" : "Goddess") + " and that she wishes to convert herself to a completely new religion. This religion accepts you as the one true " + (perYou.isBornMale() ? "God" : "Goddess") + " who should lead all mankind.<br><br>" + "This is all surrealistic to you. People who think you are some kind of demigod\u2026You think Daria is crazy and the charm spell you\u2019ve put on her altered too much of her personality. Still, she is madly in love with you and you can use her fine body anytime. So something good come out of it, right?"
	};
	per.getPersonAddress = function() {
		return checkPlaceFlag("Church", 5) || checkPlaceFlag("Church", 7) ? "Lady of our Heavenly Father Church" : ""
	};
	per.getPersonGender = function() {
		return this.checkFlag(10) ? "futa" : "woman"
	};
	per.getPossessionFace = function() {
		return "mothersuperior-face"
	};
	per.possessThem = function() {
		if (!this.checkFlag(1))
			if (this.checkFlag(6) && wherePerson("Leanne") != 382) {
				addComments("You try to complete the spell and once again possess the Mother Superior, and you feel an incredible sensation of utter rejection. You realise you will never be able to possess the Mother Superior again!");
				return false
			} else {
				Place = 382;
				addComments("<p>You possess the Mother Superior from the Lady of Our Heavenly Father. You may move her within the Church grounds.</p>");
				return true
			}
		else if (!this.checkFlag(2) && !this.checkFlag(3) && !this.checkFlag(5))
			if (nTime - this.extra[0] < 288) {
				addComments("You try to complete the spell and once again possess the Mother Superior, and you start to see through her eyes as the spell takes effect. You then feel her very confused emotions, and turbulent mixture of lust, regret and anger. You are suddenly rejected and return to your own body. The spell would have worked but she is just too troubled and strong willed. You may be able to succeed, but you should wait more time, maybe tomorrow?");
				return false
			} else {
				Place = 382;
				AddMana(10);
				addComments("<p>You possess the Mother Superior from the Lady of Our Heavenly Father. You may move her within the Church grounds.</p>");
				return true
			}
		else addComments("You try to possess the Mother Superior again, but it fails. It seems she is either resisting it now, or she has been affected by your previous attempts. You should try visiting her in person");
		return false
	};
	per.dispossessThem = function() {
		this.setFlag(6);
		return true
	};
	per.showEvent = function() {
		if (Place !=
			384) return false;
		var md;
		var idx;
		if (sType.substr(0, 5) == "charm") {
			md = WritePlaceHeader();
			var bWitch = getQueryParam("witch") == "true";
			var perSister = findPerson("Desiree");
			idx = parseInt(sType.charAt(5), 10) + 5;
			if (sType == "charm2") this.showPerson("mothersuperior7g.jpg");
			else if (sType == "charm3" && perYou.isMaleSex() && isExplicit()) this.showPersonX("mothersuperior8bg.jpg");
			else this.showPerson("mothersuperior" + idx + ".jpg");
			addPlaceTitle(md, "Mother Superior Under a Charm Spell");
			if (sType == "charm1") {
				md.write("<p>While the Mother Superior is still in the trance you recite the words of the charm spell, and you hear her call out something incoherent. She sits up and opens her eyes, the trance is broken!</p>" +
					"<p>She looks a little confused");
				if (perSister.isHere()) md.write(", and glances at Sister Desiree, and then intensely back at you.");
				else md.write(", but then almost stares at you.");
				md.write(" You are unsure if she has noticed that she has removed a lot of her habit while under the trance, especially as she raises her hands. Maybe she is planning to rearrange her habit, but she stops and addresses you,</p>" + '<p>"This is my private cell, I do not want visitors, please leave now"</p>' + "<p>You notice her words are less harsh than before, not telling you to leave but asking you. You start to speak but she speaks at the same time, lost in thought,</p>" +
					'<p>"I know you, I can feel it in my heart and soul, who are you?"</p>' + "<p>You explain that you are a friend of Leanne's and as you do she looks startled,</p>" + '<p>"It was you, in my head making me do those naughty things! What are you, how can you do such things? You must be a demon!"</p>');
				startQuestions();
				addLinkToPlaceC(md, '"Not at all, you did everything"', 384, "type=charm2");
				addLinkToPlaceC(md, '"I am a ' + perYou.getWitch() + ' and your heart is mine"', 384, "type=charm2&witch=true")
			} else if (sType ==
				"charm2") {
				if (bWitch) {
					this.charmThem(4);
					md.write('<p>"I am a ' + perYou.getWitch() + ' and I have completely controlled your heart and soul. Everything you did was by my will and for my desires."</p>' + '<p>Daria responds shocked, "Your desires! You are a servant of evil..."</p>' + '<p>Forcefully you shout "Shut up! I serve no one, I owe allegiance to nothing. You on the other hand are mine and only mine! Your body and soul"</p>' + '<p>Daria looks shocked, "No..no...please help me G..."</p>' + "<p>Again you force the issue,</p>")
				} else {
					md.write('<p>"I did not make you do anything, as just present astrally watching. Everything you did was because you wanted to. You desired Leanne and gave into temptation');
					if (perSister.isHere()) md.write(" and you dominated Sister Desiree for your own pleasure.");
					else md.write(" and the second time you did those naughty things because you wanted to.");
					md.write('<p> I was able to subtly influence you to get help to defeat the demon that had affected Leanne. We are actually allies!"</p>' + '<p>Daria replies, "No, that is not possible...", and you tell her,</p>' + '<p>"Yes it was, I banished the demon and now I need more help now"</p>' + "<p>She looks at you uncertain, the spell is affecting her but she has not surrendered to it yet.</p>")
				}
				startQuestions();
				if (bWitch) addLinkToPlaceC(md, '"You can only ask me for help!"', 384, "type=charm3&witch=true");
				else addLinkToPlaceC(md, '"Help me"', 384, "type=charm3")
			} else if (sType == "charm3") {
				if (bWitch) md.write('<p>Daria nervously says "Please release me...", and you know you have her. There is no choice in your reply,</p>' + "<p>\"No, you are mine, forever more to do anything I want with you or your body. I shall grant your request in another way and 'release' your desires\"</p>" + "<p>Daria sighs, surrendering completely. She removes her clothing ready for her new " +
					perYou.getWitch() + " " + perYou.getMaster() + "</p>" + "<p>You take your new slave nun, enjoying her body and her submission!</p>");
				else md.write('<p>Daria asks "Help you in what way", as she looks you up and down.</p>' + "<p>You reply with a passionate kiss that takes her by surprise, but she does not resist.</p>" + "<p>You mutually explore each others bodies and experience considerable pleasure with each other.</p>" + '<p>After Daria says "You can ask for the churches, and my help, again at any time"</p>');
				startQuestions();
				addLinkToPlaceC(md, "talk to Daria more", 384);
				addLinkToPlace(md, "leave the room", 406)
			}
			WritePlaceFooter(md, "", false, true);
			return true
		} else if (getQueryParam("trance") == "yes") {
			md = WritePlaceHeader();
			AddMana(-1);
			this.showPerson("mothersuperior4b.jpg");
			addPlaceTitle(md, "Mother Superior in a Trance");
			md.write('<p>You tell Daria "Is that a purple carrot" as you touch her arm as you gesture. As you do you use the augmented hypnotic technique to drop her immediately into a hypnotic trance. In seconds she drowsily falls into the trance.</p>' +
				"<p>As a test you tell her it is very hot in here and she needs to remove some clothing, and without hesitation she removes part of her habit. For the moment you have her <b>will under your control!</b></p>" + "<p>You are about to ask her something else but she starts the mutter, you can hear and see she is resisting, the trance will end soon!</p>");
			startQuestions();
			addLinkToPlaceO(md, "she wakes up", 406);
			WritePlaceFooter(md);
			return true
		} else if (sType == "transformcock") {
			CastTransform(1);
			this.setFlag(10);
			md = WritePlaceHeader(true, "", "black");
			showPopupWindow("Transformation", '<img src="Images/' + (isExplicit() ? "Explicit/" : "") + this.getImg("mothersuperior11.jpg") + '" style="width:35%;float:left;margin-right:6px;margin-top:1em;margin-bottom:2em" alt="futa">' + '<p>You cast the spell and Daria cries out, "God, what is this" and pulls apart her habit. You see a large cock growing from her groin above where her pussy is.</p>' + "<p>As she groans you can distinctly hear someone laughing but it is drowned out as Daria cries out in ecstasy as her new cock spasms in her first male ejaculation.</p>" +
				"<p>Daria is confused why you did this and you cannot help but wonder if it was a good thing, but then again as you watch her stroking her new cock you put these worries out of your mind.");
			setQueryParams("");
			WritePlaceFooter(md, "", true, true);
			return true
		} else if (sType == "transformbreasts") {
			CastTransform(1);
			this.setFlag(11);
			md = WritePlaceHeader(true, "", "black");
			showPopupWindow("Transformation", '<img src="Images/GenericSex/be d.gif" style="width:35%;float:left;margin-right:6px;margin-top:1em;margin-bottom:2em" alt="BE">' +
				'<p>You cast the spell and Daria cries out, "God, what is this" and pulls apart her habit. You see her breasts swelling, growing larger and larger.</p>' + "<p>As she groans you can distinctly hear someone laughing but it is drowned out as Daria cries out in ecstasy as her breasts stop growing.");
			setQueryParams("");
			WritePlaceFooter(md, "", true, true);
			return true
		}
		if (sType == "troubled") {
			this.setFlag(12);
			md = WritePlaceHeader();
			var be = this.checkFlag(11) ? "-be" : "";
			var futa = this.getPersonGender() == "futa" ? "f" : "g";
			var fb = futa + be;
			this.showPerson("mothersuperior7" + fb + ".jpg");
			addPlaceTitle(md, "Daria is Troubled");
			var perSister = findPerson("Desiree");
			var bDesireeHere = perSister.isHere() && !perSister.checkFlag(1);
			var sTitle = perYou.isBornMale() ? "Lord" : "Goddess";
			md.write('<p>You ask "There is something bothering you, Daria, out with it my slave."</p>' + '<p>Daria answers, "Ohh, ' + perYou.getPersonName() + '! I\u2019ve been so wrong.  I was following the bad road all along. I thought you were a demon, a witch who only brings chaos to our world."</p>' +
				'<p>You reply, "Well, you were stubborn one, that\u2019s obvious. You were one of the hardest woman to enslave I\u2019ve ever met so far.  Also, stopping me from entering the church\u2026now that was harsh, wasn\u2019t it?"</p>' + '<p>Daria tells you, "Aww, how stupid was I\u2026I am a sinner, ' + perYou.getMaster() + '! I am useless to you. Forgive me for all the trouble I\u2019ve caused. Punish me whenever you want and however you want. I need to atone for my actions."</p>' + '<p>You reply, "Don\u2019t worry, I\u2019ll make sure you are properly punished\u2026Now was there anything else?"</p>' +
				'<p>Daria answers, "Yes, ' + perYou.getPersonName() + '! An important one. Please, I beg of you, listen to my full story, ohh, your holiness. During the process of my enslavement, which you have guided me through marvelously might I add, you awoken something in me. My whole life I\u2019ve worshipped the wrong god, I served the wrong religion. I now see that I need to change, convert to something different\u2026"</p>' + '<p>You reply, "Your holiness\u201d\u2026\u201dconvert to something different\u201d\u2026.I don\u2019t follow you, my slave\u2026"</p>' +
				'<p>Daria answers, "Forgive me, forgive this stupid slut for her ramblings\u2026I mean I understand who you are now\u2026you are the Messiah I\u2019ve been waiting for..."</p>' + '<p>You reply, "Hey there! That\u2019s definitely something I\u2019ve never heard before! Elaborate!"</p>' + '<p>Daria answers, "You handle powers I\u2019ve never seen before! You\u2019ve already gathered dozens of slaves in such a small of period of time. Everywhere you go, people bow their heads to you. You bring a new order into Glenvale, I can see that perfectly! You are the one whom I wish to worship\u2026You are MY ' +
				(perYou.isBornMale() ? "God" : "Goddess") + '! If you ever let me, I will forever serve you with ALL I have. Nothing, beside obeying EVERYTHING you say, is important to me anymore."</p>' + '<p>You reply, "My god, Daria, what are you  talking about\u2026this is completely new\u2026"</p>' + '<p>Daria answers, "Ohh, how naive you are. Still thinking that there is someone above, still don\u2019t see that you are the one\u2026You see, ohh almighty, you see\u2026that I\u2019ve lived my life believing in the christian God and Jesus. This God never showed himself to me, never gave a slight reference that he exists, but I believed in Him\u2026Not anymore\u2026not anymore; you have proven to me that you are the ONE I have to follow\u2026and I shall do it, if YOU, let me, oh your holiness.:"</p>' +
				'<p>You reply, "You are definitely crazy. I\u2019m just a regular ' + (perYou.isBornMale() ? "guy" : "gal") + " who happens to have magical powers. That doesn\u2019t mean I am your " + (perYou.isBornMale() ? "god" : "goddess") + '\u2026"</p>' + '<p>Daria answers, "To me, you are, and you can\u2019t change that\u2026Just let me believe in YOU, my ' + sTitle + '! I will never disturb you if you wish so\u2026"</p>' + '<p>You reply, "All right, I will think about it\u2026What would change anyway?"</p>' + '<p>Daria answers, "Ohh, not much, my Creator. Nothing that would ever harm you. To show you my seriousness, I hereby offer you everything I have and more. This church, everyone and everything in it is forever yours. Let your new religion be called; The Faith of Flesh."</p>' +
				'<p>You reply, "What? Faith of Flesh? What does that even mean?!"</p>' + '<p>Daria answers, "You control anyone by thought. You can use their bodies, alter their minds. You are the God of Flesh\u2026It is appropriate to name your cult after you and power."</p>' + '<p>You reply, "Okkkayyy\u2026cult, what kind of cult?"</p>' + '<p>Daria answers, "So silly\u2026so young\u2026so funny\u2026Ahh, my ' + sTitle + ', you are perfect in every way. I was talking about the Cult of Flesh, your religious followers. If you let me, I would gladly lead them. No greater honor I could achieve in my existence."</p>' +
				'<p>You reply, "Whatever Daria. Just don\u2019t convert and advertise this cult of yours openly\u2026"</p>' + '<p>Daria answers, "Ohhh, no, your Holiness! I would never do that. I would never do anything without your blessing."</p>' + '<p>You reply, "Are we finished, Daria? Anything you want to talk about?"</p>');
			if (bDesireeHere) md.write('<p>Daria answers, "This one, ohh, Holiness. What do you wish to do with her?", Daria points at the nun who is still hanging on a rope, mouth pecked. She is talking about Desiree, obviously.</p>' +
				'<p>You reply, "I don\u2019t have plans with her for now. Do as you wish."</p>' + '<p>Daria tells you, "May I offer her to you as your second follower, my ' + (perYou.isBornMale() ? "Lord" : "Goddess") + '? She is obviously eager to join The Faith of Flesh, am I right, slave?". Daria scornfully eyes the young nun. Sister Desiree bows her up and down as fast as she can, you can read her devotion to you from her face.</p>' + '<p>Daria continues, "It is done then. I will look after myself that she is properly educated in her faith\u2026Thank you for accepting us as your servants. We will not fail you!"</p>');
			else md.write('<p>Daria answers, "The young sister, Desiree has already received your blessing, my ' + (perYou.isBornMale() ? "Lord" : "Goddess") + '. May I take her as a follower of the one, true faith?" Daria speaks a bit angrily about Desiree. It\u2019s obvious she would like to regulate her a bit.</p>' + '<p>You tell her, "I don\u2019t have plans with her for now. Do as you wish."</p>' + '<p>Daria answers, "It is done then. I will look after myself that she is properly educated in her faith\u2026"</p>');
			startQuestions();
			addLinkToPlace(md, "talk more with Daria", 384);
			WritePlaceFooter(md);
			return true
		}
		return false
	};
	per.showPersonChat = function(bGeneral, md) {
		if (this.isCharmedBy() && !this.checkFlag(12) && this.isHere()) addLinkToPlaceC(md, '"There is something bothering you, Daria, out with it my slave."', 384, "type=troubled")
	};
	per.handleItem = function(no, cmd) {
		if (cmd == 1 && (no == 52 || no == 64)) {
			var s = getSoulBoundCrystal(no);
			if (s != "")
				if (this.isHere() && !(this.checkFlag(10) || this.checkFlag(11))) {
					if (!this.isCharmedBy()) examineItem(no,
						"The " + s + " trembles weakly, you suspect you need a magical link to the Mother Superior before it will work.");
					else examineItem(no, "The " + s + " vibrates softly the closer you get to Daria.");
					return "handled"
				}
		}
		if (no == 18 && cmd == 2) {
			if (Place == 384 && this.place == 384) {
				if (this.checkFlag(10) || this.checkFlag(11)) {
					addComments("You have already transformed her");
					return "handled"
				}
				if (!CastTransform(1, true)) return "handled";
				if (!this.isCharmedBy()) addComments("The spell does not work, but there is an effect, you believe it may work at another time. You probably need to completely control her first.");
				else {
					setCommentsNoClick('<div class="conversebubble" style="cursor:default">' + '<table><tr><td width="80%"><p>You decide to try the transformation spell on Daria and tell her to prepare herself. As you start to recite the spell she falls into a sort of trance, her habit falling open. As it does your attention is drawn to...</p>');
					addOptionLink("comments", "her breasts", "ClearComments();dispPlace(" + Place + ",'type=transformbreasts')");
					addOptionLink("comments", "her groin", "ClearComments();dispPlace(" + Place +
						",'type=transformcock')");
					addComments('</td><td width="20%"><img src="Images/' + this.getImg("mothersuperior4b.jpg") + '" style="width:95%;" alt="Transform"></td></tr></table>');
					return "handled"
				}
				return "handled"
			}
			if (this.isHere()) {
				if (!CastTransform(1, true)) return "handled";
				addComments("The spell does not work, but there is an effect, you believe it may work at another time. You probably need to completely control her first.");
				return "handled"
			}
		}
		return ""
	}
}

function RepliesMrsGranger(nR) {
	var perMG = per;
	var bCharm = this.isCharmedBy();
	var clv = this.getCharmedLevel();
	var myName = this.getYourNameFor();
	var perKate = findPerson("Kate");
	var rnd = Math.random();
	if (nR === 1) {
		if (perKate.place === 1) {
			if (!bCharm)
				if (!checkPlaceFlag("GrangerHouse", 2))
					if (rnd < .5) addComments('<p>"Oh yes, she arrived home a short while ago. She mentioned that she had invited you to visit, her room is there" and she tells you where Kate\'s room is.</p>');
					else addComments("<p>\"Yes dear, Kate's in her room, she mentioned she was hoping you would visit.\". She then tells you where Kate's room is.</p>");
			else if (rnd < .5) addComments('<p>"Coming back for more punishment? Kate\'s in her room. Keep things friendly, no naughty stuff yet."</p>');
			else addComments('<p>"Oh yes, she arrived home a short while ago. No naughty stuff yet!"</p>');
			else addComments('<p>"Oh yes ' + myName + ', she arrived home a short while ago. Would you like to play with <i>me</i> now?"</p>');
			setPlaceFlag("GrangerHouse", 2)
		} else if (!bCharm) addComments("<p>\"Kate? No, she stepped out a bit ago and hasn't come home yet. Do you want to wait here for her, I'll make sure to text you when she returns?\"</p>");
		else if (clv == 1) addComments("<p>\"Kate? I'm afraid not.  She left a little bit ago and hasn't come home yet. While she is gone " + myName + ", let me help you relax.</p>");
		else if (rnd < .5) addComments("<p>\"Kate? I'm afraid not.  She left a little bit ago and hasn't come home yet. Why do you want her, " + myName + ", when you could have her mother? I can do things Kate can't even imagine,\" she says jealously.</p>");
		else addComments("<p>\"Kate? I'm afraid not.  She left a little bit ago and hasn't come home yet. Why do you want her, " +
			myName + ', when you could have her mother? I will do things for you she would never do!" she says jealously.</p>');
		this.setFlag(9);
		perKate.setFlag(16)
	} else if (nR == 240) {
		this.extra[1] = 1;
		if (rnd < .33) addComments('<p>"How sweet of you to say nice things. Thank you."</p>');
		else if (rnd < .66) addComments('<p>"I am sure you should be saying those things to Kate, not me, but thank you anyway."</p>');
		else addComments('<p>"Kate gets her beauty from me after all! Just kidding, thank you for your nice words."</p>')
	} else if (nR ==
		241) {
		this.extra[1] = 2;
		if (rnd < .33) addComments('<p>"Work out? Oh I go to the gym regularly when I am not in the field on an archeology dig. The digs themselves are rather strenuous so are plenty of exercise. Thanks for noticing, I try to stay in shape."</p>');
		else if (rnd < .66) addComments('<p>"My work is very physical and I like to go dancing regularly. These help me to keep fit with the occasional trip to the gym. Thanks for noticing."</p>');
		else addComments('<p>"Kate is the fitness freak in this familiy, but I often work out with her. My work is also quite strenuous and helps me to maintain my figure. Thanks for noticing!"</p>');
		addComments('<p>She smiles, "I am partial to a good massage, they help after a good work-out or a hard days work."</p>')
	} else if (nR == 242) {
		addComments("<p>She explains about her work on the early settlement of this region but she does not try to bore you with technicalities. She mentions how they often find interesting artifacts. You ask her what she has found recently,</p>" + '<p>"Last week I found this old stone near the Wild Ranges. Here, do you want to see it?"  She hands you a stone from her mantle.</p>');
		if (this.extra[1] < 10) {
			this.extra[1] = 10;
			perYourBody.PutItem(5);
			addComments('<p>"It has no value or interest archaeologically, I just liked it. If you want you can have it"</p>')
		}
	} else if (nR == 243) {
		if (rnd < .66) addComments('<p>She quickly gets you a glass of water and apologies "Sorry I cannot get you anything better, maybe when you are a little older".</p>');
		else addComments("<p>Sorry we do not have anything better, Kate does not like soft drinks and she does not like others using her sports-drinks. I prefer a nice wine, or a good coffee, but we are currently out.</p>");
		if (this.extra[1] == 1) this.extra[1] = 1.1
	} else if (nR == 245) {
		if (this.extra[1] < 5) this.extra[1] = 6;
		this.setFlag(33);
		addComments('<p>"Yes, you can help. I\'m having trouble organizing a party. Are you any good with puzzles? I have a reward for you if you can solve it."</p>');
		if (!checkPlaceFlag("Park", 3)) {
			setPlaceFlag("Park", 3);
			PlaceI(5, 26)
		}
	} else if (nR == 246) {
		if (this.extra[1] < 5) this.extra[1] = 6;
		this.setFlag(34);
		addComments('<p>"Yes, you can...help me. I have a little thing bothering me. Are you any good with puzzles? I have a pleasant reward for you if you can solve it."</p>');
		if (!checkPlaceFlag("Park", 3)) {
			setPlaceFlag("Park", 3);
			PlaceI(5, 26)
		}
	} else if (nR == 2415) {
		addComments('<p>"Yes ' + myName + ', I believe I may have.  I found this last week near the Wild Ranges.  Here, take it.  All that I have is yours."</p>');
		if (this.extra[1] < 16) {
			this.extra[1] = 16;
			perYourBody.PutItem(5)
		}
	} else if (nR == 231) {
		this.other = 2;
		addComments(this.addPersonFace());
		if (clv == 1) addComments('"Well no my dear, have you heard there is something important there?", Mrs Granger replies. You tell her a little about what you have heard about the place and it\'s importance in the early days of Glenvale and the time of the covens.</p><p>"Alright dear, I have some free time, I will do a survey of the area. I will meet you back here if I find anything."</p>');
		else addComments('"Whatever you say dear", Mrs Granger replies. "I will meet you back here if I find anything."</p>');
		if (isDay()) {
			this.place = 34;
			this.other = 2.1
		} else addComments('<p>She notices that night has fallen, "I will go there first thing in the morning, dear. Maybe you would like to spend the night?"</p>')
	} else if (nR == 232)
		if (Math.round(this.other * 10) < 22) {
			addComments('"Oh sorry Hon, I have not finished the survey. It was definitely a site of importance to the witch covens but that is well know to local historians.," she says "Please let me have a little longer to continue the work tomorrow."</p>');
			this.other = 2
		} else {
			if (!isPlaceKnown("Tunnel")) setPlaceKnown("Tunnel");
			if (Math.round(this.other) == 2) this.other = 3;
			addComments('"Oh what a marvelous discovery! I found a tunnel at the base of the Wild Ranges," she says in excitement. "It appears to be one I have seen mentioned in some old works and it is said to be the path to the \'Stones of Death\' most likely some old burial or funeral site. I could only do a brief check but it appears to be safe to use."</p><p>"The old tales and legends of this town talk about a place of the dead that no-one should dare enter without some sort of protection."</p><p>' +
				(clv == 1 ? '"So ' + myName + ', maybe we should celebrate in some way?"' : '"So Hon, maybe we should celebrate in each others arms?"') + "</p>")
		}
	else if (nR == 233) {
		PlaceI(5, 177);
		this.other = 4;
		addComments('"Yes, you would not believe there was another old stone there," she says.')
	} else if (nR == 1E3) {
		this.setFlag(7);
		addComments('"Well Kate could come home at any time, so we should call a rain-check for our celebration" she says a little regretfully.')
	} else if (nR == 2502) {
		setPlaceKnown("Museum");
		this.other = 5;
		addComments(this.addPersonFace());
		addComments('<p>"A dragon gem," she says a little bewildered. "I have never heard of such a thing. Perhaps there might be something at the museum."</p>');
		if (isDay()) this.place = 1;
		else addComments('<p>She notices that night has fallen, "I will go there first thing in the morning, dear. Maybe you would like to spend the night?"</p>')
	} else if (nR == 2503) {
		setPlaceKnown("Museum");
		if (this.other < 5) this.other = 5;
		addComments(this.addPersonFace());
		addComments('<p>"The dragon vase," she says a little bewildered. "If that\'s what you\'d like then of course I would be happy to do <i>anything</i> to help.  Off to the museum!"</p>');
		if (isDay()) this.place = 1;
		else addComments('<p>She notices that night has fallen, "I will go there first thing in the morning, dear. Maybe you would like to spend the night?"</p>')
	} else if (nR == 236) {
		bChat = false;
		this.place = 177;
		if (this.other == 5) this.other = 4;
		addComments(this.addPersonFace() + '<p>"Yes, my dear", she leaves you with a longing look</p>')
	} else if (nR == 2354) {
		if (this.other > 0 && this.other < 55) this.other = 55;
		var perAbby = findPerson("Abby");
		if (perAbby.getQuestDragonGem() < 6) perAbby.setQuestDragonGem(6);
		setPlaceKnown("MechanicsShop");
		if (bCharm) {
			addComments('<p>"The vase is worthless ' + myName + " but, according to Glenvale history, something of value is inside. How odd, the vase is made of steel. It would be very hard to break. ");
			addComments('Take it to the mechanics workshop. They might be able to open it."</p>')
		} else addComments('<p>"A dragon vase, huh?  Where did you get that?" She asks, taking a look at the vase.  "Huh... " She says at the curious metallic sound as she taps it.  "Made of metal?  You\'d have to have a mechanics workshop to get that thing open... wonder how they made it..."</p>')
	}
	return true
}

function LeaveMinMrsGranger(recharm) {
	var perMG = findPerson("MrsGranger");
	if (recharm !== true) {
		perMG.charmThem(1);
		PlaceI(5, 43)
	}
	dispPlace(43, "");
	bChat = false;
	WriteComments(perMG.addPersonFace() + "You tell Mrs Granger you have to leave now and exit the house. Mrs. Granger looks at you oddly as you leave as she starts to deal with the spell.</p>" + "<p>She will be affected by the spell but you have chosen to not try to reinforce or guide her so the effect will be minimal.</p>" + (recharm !== true ? '<img src="UI/themes/theme0/stone.png" style="width:5%;float:right">' +
		"<p>As you step out of the house you see she is starting to peel off her dress and you trip over something on the door-step in your distraction. The door closes and you glance down, and see it a stone being used as a door-stop, it looks like a magic stone!" : ""))
}

function initialiseMrsGranger() {
	addPerson("Mrs. Granger", 177, "MrsGranger", "Turquoise");
	per.extra = [0, 0];
	per.Replies = RepliesMrsGranger;
	per.getNextDress = function(drs) {
		var clv = this.getCharmedLevel();
		if (clv == 3) return "ShinyBlue";
		else if (clv == 1) return "Leather";
		return "Turquoise"
	};
	per.getPersonName = function(full) {
		if (full === true) return "Mrs. Marie Granger";
		var clv = this.getCharmedLevel();
		if (clv == 4) return "your slave, Mrs Granger";
		if (clv == 3) return "Slut Mrs Granger";
		return "Mrs. Granger"
	};
	per.getPersonAddress = function() {
		return isPlaceKnown("GrangerHouse") &&
			this.checkFlag(8) ? "34 Yoolaroo Dr, Glenvale" : ""
	};
	per.getPossessionFace = function() {
		return "granger-face"
	};
	per.getYourNameFor = function() {
		var clv = this.getCharmedLevel();
		if (clv === 0) return perYou.getPersonName();
		if (clv == 1 || clv == 3) return "dear " + perYou.getPersonName();
		if (clv == 2) return "my Love";
		return perYou.getMaster()
	};
	per.isPersonInfo = function() {
		return true
	};
	per.getPersonInfo = function() {
		if (!this.isCharmedBy()) return this.addPersonString("granger0.jpg", "height:max%", "right") + "Mrs. Granger, the hot mother of Kate, very friendly and a bit flirtaceous.";
		else if (this.getCharmedLevel() > 1) return this.addPersonString("granger-home-day.jpg", "height:max%", "right") + 'Mrs. Granger, the hot mother of Kate is at your disposal and is an eager slave to you and only you! She already filled you in about the settlers and town\u2019s history briefly, but she offered if you have the time and interest you can always visit her and have a talk about it over a tea or coffee or of course, after a hot sex. She became a sexual predator who\u2019s only prey is you, she is more than willing to have a second or third round of sexual intercourse long after you exhausted yourself on her. She always ask for more! She has a great physique too and she endures even your hardest and longest "pushes".<br><br>' +
			"Mrs. Granger is standing in the living room, hotter than ever, ready to bring you out of your clothes. You just have to say the word!";
		else return this.addPersonString("granger-home-day.jpg", "height:max%", "right") + 'By leaving the house, you have interrupted the charm process so she only got half of dose to make her a slave to you. She stuck in the middle, thus becoming kind of like your fuckbuddy over the days since you have charmed her. She\u2019s a great friend too, by having her mind relatively free from your powers. She\u2019s a sexual predator who\u2019s only prey is you, she is more than willing to have a second or third round of sexual intercourse long after you exhausted yourself on her. She always ask for more! She has a great physique too and she endures even your hardest and longest "pushes"<br><br>' +
			'Mrs Granger dresses a bit more "open and freely", but she still retains her style and doesn\u2019t go full slut for you. She offers you treats and a glass of water which you gladly accept and the two of you sit down in the living room for a talk.'
	};
	per.passTimeDay = function() {
		if (this.place == 177 && this.other == 5) {
			this.place = 1;
			if (Place == 177) return this.addPersonFace() + "<p>In the morning Mrs Granger gives you a kiss and tells you she is off to the <b>Museum</b>.</p>"
		}
		if (this.place == 177 && Math.floor(this.other) ==
			2 && this.other < 2.2) {
			this.place = 34;
			this.other = 2.1;
			if (Place == 177) return this.addPersonFace() + "<p>In the morning Mrs Granger gives you a kiss and tells you she is off to the <b>Wild Ranges</b>.</p>"
		}
		if (this.dress != this.getNextDress()) {
			this.dress = this.getNextDress();
			this.setFlag(6, false)
		}
		return ""
	};
	per.passTimeNight = function() {
		if (this.place == 1 && this.other == 5) {
			this.place = 177;
			if (Place == 240) return this.addPersonFace() + "<p>As the museum starts to close Mrs. Granger tells you she will return <b>home</b> for the night and return tomorrow</p>"
		}
		if (this.place ==
			34 && Math.floor(this.other) == 2) {
			this.place = 177;
			if (Place == 34) return this.addPersonFace() + "<p>As night starts to fall Mrs. Granger tells you she will return <b>home</b> for the night and return tomorrow</p>"
		}
		return ""
	};
	per.showEventPopup = function() {
		if (Place == 177 && this.place === 177)
			if (!this.isCharmedBy()) {
				if (!this.checkFlag(8)) {
					showPopupWindow("Mrs. Granger", "<img src='Images/" + this.getImg("granger0") + ".jpg' style='width:30%;float:right;margin: 0px 0px 0px 5px' alt='Mrs Granger'>" + "Smiling, Kate's mother greets you and asks you into the house. Looking around you can see Mrs. Granger is alone and you curse silently to yourself. Not wanting to appear rude you wait until you are in the front room.You once heard Kate mention that her mother works as an archaeologist, and you think she said her mother has a 'top' position but only works part-time due to budget issues at her...university? Well that certainly explains where Kate got her brains from, and looking at Mrs. Granger now, at lot of her beauty as well!<br><br>" +
						"Mrs. Granger is quite the looker herself, Kate has similar traits and expressions to her mother, but they\u2019re both different enough to you to know that you want to bang both of them. Hey, Mrs. Granger is an archaeologist, so she must know a lot about the local history and such! She seems helpful enough to give you some tips about where to look for old items or abandoned places of magic. However, it would be easier if you could get her to be more submissive and obedient to you, an ally whom you you could always trust.",
						"setPersonFlag('MrsGranger',8)");
					return true
				}
			} else if (this.getCharmedLevel() != 4 && !this.checkFlag(6) && this.dress !== "Turquoise" && sType === "") {
			this.setFlag(6);
			var clv = this.getCharmedLevel();
			showPopupWindow("Mrs. Granger Charmed", "<img src='Images/" + this.getImg(isDay() ? "granger-home-day.jpg" : "granger-home-night.jpg") + "' class='imgpopup' alt='Mrs Granger'>" + "Mrs. Granger invites you in and you see she had changed since you last visited and she is now wearing " + (clv == 1 ? (isDay() ? "a red top and some tight leather pants" :
					" some tight exercise gear") + ". She looks at you with a slight blush as she notices your appreciative look, the spell is clearly affecting her. She smiles and says<br><br>" + '"I felt like a change, ' + perYou.getPersonName() + ' dear. Now is there anything I can do to make you comfortable?"<br><br>' + "She seems to be acting similar to before the spell, but more friendly and sensual." : (isDay() ? "a revealing tight blue dress" : " some blue lingerie") + ". She looks at you with an open look of desire, she is completely under the spell and embracing your earlier comments about being a slut. She smiles and says<br><br>" +
				'"I felt like a change, ' + perYou.getPersonName() + ' dear, something more to my taste and yours. Now is there anything I can do to make you comfortable?"'));
			return true
		}
		return false
	};
	per.showEvent = function() {
		var md;
		var img;
		if (Place == 278 && this.health == 99 && sType === "") {
			if (this.checkFlag(3)) {
				md = WritePlaceHeader();
				var bOk = wherePerson("OfficerKhan") == 278;
				this.showPerson("!granger14-arrest1.jpg");
				addPlaceTitle(md, "Arresting Mrs. Granger");
				md.write("<p>As you enter the ward to visit Mrs. Granger you see a curtain around her bed and a nurse stops you and tells you that a police " +
					getOfficer(false) + " is with her, and is about to take her to jail. The doctors had given their clear for her to leave the hospital.</p>" + "<p>As you as talking to the nurse you hear Mrs. Granger's voice talking to the " + getOfficer(false) + " and some rustling and a grunt. You are worried she is going to get hurt again resisting arrest and run over and see ");
				if (bOk) md.write(getOfficer() + " Khan standing to one side");
				else md.write("a police " + getOfficer(false) + " you do not recognise standing to one side");
				md.write(" and Mrs. Granger is sitting on the bed, her hands tied and a ball-gag in her mouth. For a moment she looks distressed, but quick smiles. ");
				if (bOk) md.write(getOfficer() + " Khan quickly explains, ");
				else md.write("The " + getOfficer(false) + " explains with some discomfort, ");
				md.write("\"She asked to put on a show for you, before I arrest her. The 'items' are all hers\"</p>" + '<p>You remove her gag and she says dramatically "Oh Hon, I am being taken away in bondage dire, and not the nice, kinky kind!"</p>' +
					"<p>You glance and " + (bOk ? getOfficer() + " Khan" : "the " + getOfficer(false)) + " pointedly taps on their watch but then looks away. You have a little time it seems, so you play along with Mrs. Gramger.</p>" + '<p>You replace her gag and whisper to her, "You mean kinky like this?" and remove her bra and start to slap her breasts. She dramatically moans, and you pinch her nipples, and you say something completely true. "You like this <b>slave</b>, don\'t you?", she nods her head...</p>');
				startQuestions();
				if (wherePerson("OfficerKhan") ==
					278) addLinkToPlaceC(md, getOfficer() + " Khan coughs...", 278, "type=leaving2");
				else addLinkToPlaceC(md, "the " + getOfficer(false) + " coughs...", 278, "type=leaving2")
			} else {
				md = WritePlaceHeader();
				this.showPerson("!granger14-leaving1.jpg");
				addPlaceTitle(md, "Discharging Mrs. Granger");
				md.write("<p>Mrs. Granger is next to her bed and looks like she was dressing. She is almost glowing with health, and she is looking happy as she sees you. Immediately she starts to open her top to expose her breasts for you.</p>" +
					'<p>"Hi Hon, I got the clear to leave the hospital and go home, but I have this odd feeling in my chest. Maybe you should examine me?"</p>' + "<p>You see she is wearing a stethoscope, where did she find that? You play along and feel...examine her breasts, but after a little you feel conscious of how public it is here.</p>");
				startQuestions();
				addLinkToPlaceC(md, '"Shouldn\'t you get dressed?"', 278, "type=leaving2")
			}
			WritePlaceFooter(md);
			return true
		}
		if (Place == 269 && sType == "grangerpool") {
			WaitHereOnly(6);
			md =
				WritePlaceHeader();
			this.showPerson("granger-pool.jpg");
			addPlaceTitle(md, "Swimming with Mrs. Granger");
			md.write("<p>Mrs. Granger arrives and changes into her bikini, and looks at you smiling and seductively, as she always does.</p>");
			startQuestions();
			if (this.dress != "Leather") addLinkToPlaceC(md, "it is fairly private here...", Place, "type=grangerpoolsex");
			addLinkToPlaceC(md, "say goodbye to Mrs. Granger", Place);
			WritePlaceFooter(md);
			return true
		}
		if (Place == 269 && sType == "grangerpoolsex") {
			md = WritePlaceHeader(false,
				this.dress == "ShinyBlue" ? "td-left-med" : "");
			this.showPerson("granger-pool-sex.jpg");
			addPlaceTitle(md, "More Than Swimming With Mrs. Granger");
			md.write("<p>You accept her implied seductopn, and she removes the rest of her bikini ready for you to take her!</p>");
			startQuestions();
			addLinkToPlaceC(md, "later...say goodbye to Mrs. Granger", Place);
			WritePlaceFooter(md);
			return true
		}
		if (sType === "") return false;
		var clv;
		if (Place == 177) {
			var perKate = findPerson("Kate");
			if (sType == "recharm1") {
				clv = this.getCharmedLevel();
				if (clv != 1) this.charmThem(1);
				else if (clv != 4) this.charmThem(4);
				else this.charmThem(3);
				md = WritePlaceHeader();
				this.showPersonDN("recharm1.jpg");
				addPlaceTitle(md, "Mrs. Granger Under A Charm Spell - Again");
				md.write("<p>Once again the magic courses through her, pulsing within her body, causing the heat to grow, stronger and stronger. " + "She can't help but let her gaze fasten upon you, her lips suddenly dry, beckoning her to give them a slow, nervous lick across their expanse.</p>" + "<p>She draws a deep, staggering breath, teeth lightly biting into her lower lip, before releasing it in a slow, needy moan, her voice trembling with hunger.</p>" +
					"<p>Whthout your asking she start to remove her top...</p>");
				startQuestions();
				if (clv != 1) addOptionLink(md, "leave the house and Mrs. Granger as she gets used to the spell?", "LeaveMinMrsGranger(false)");
				if (clv != 2) addLinkToPlaceC(md, "tell Mrs. Granger she needs more", Place, "type=recharm2", "", "", "charmPerson('MrsGranger',2);");
				if (clv != 3) addLinkToPlaceC(md, "tell her she is a slut", Place, "type=recharm2", "", "", "charmPerson('MrsGranger',3);");
				if (clv != 4) addLinkToPlaceC(md, "order Mrs. Granger to strip", Place,
					"type=recharm2", "", "", "charmPerson('MrsGranger',4);");
				WritePlaceFooter(md);
				return true
			}
			if (sType == "recharm2") {
				clv = this.getCharmedLevel();
				md = WritePlaceHeader();
				this.showPersonDN("recharm2.jpg");
				addPlaceTitle(md, "Mrs. Granger Under A Charm Spell - Again");
				switch (this.getCharmedLevel()) {
					case 2:
						md.write('<p>"Mmm... yes... yes, I think I do..." she half-moans as she looks at you, eyes pulsing with both the gleam of magic and a building passion for you, ' + '"Can you do me a favor? I think I need your help in a <i>very</i> special way..."</p>');
						break;
					case 3:
						md.write("<p> Your words beat into her consciousness and she sighs,</p>" + '<p>"I do like to be naughty at times, nearly exposing myself or flirting a lot"</p>' + "<p>She pauses and her fingers lightly touch her pussy sliding up and down as your words sink in</p>" + '<p>"I suppose I am a bit of a slut.."</p>');
						break;
					case 4:
						md.write('<p>"Mmm... yes... yes, I will...' + perYou.getMaster() + '" she half-moans as she looks at you, eyes pulsing with both the gleam of magic and a building passion for you, ' +
							'"Can you do me a favor? I think I need your help in a <i>very</i> special way..."</p>');
						break
				}
				startQuestions();
				addLinkToPlaceC(md, "talk more to her", 177);
				WritePlaceFooter(md);
				return true
			}
			if (sType == "katejoin") {
				md = WritePlaceHeader();
				this.setFlag(12);
				this.setFlag(13);
				this.showPerson("!grangerfamily1a.jpg");
				addPlaceTitle(md, "The Granger Family");
				md.write("<p>You ask Mrs. Granger to invite Kate to join you, and you see a flash of jealousy pass over her face. She smiles after a moment and steps out of the room. Some time passes and you can just hear a little soft conversation before she returns with her daughter Kate.</p>" +
					'<p>Mrs. Granger tells you with Kate posed next to her, "Well Hon, we have talked about it, sharing you that is. Kate talked me around to it, so it\'s a family affair now"</p>');
				startQuestions();
				addLinkToPlaceC(md, "talk more to them", 177);
				WritePlaceFooter(md);
				return true
			}
			if (sType == "familytimewatch") {
				if (isExplicit()) img = this.showPersonRandomX("!grangerfamily3", 3, "", "", "", "", 0, false, "string");
				else img = "";
				md = WritePlaceHeader(false, img.indexOf("grangerfamily3a") != -1 ? "" : "td-left-med");
				if (isExplicit()) md.write(img);
				else this.showPerson("!grangerfamily3.jpg");
				addPlaceTitle(md, "The Granger's at Play");
				md.write('<p>You ask Mrs. Granger and Kate to play together. Interestingly Mrs. Granger is quite enthusiastic and takes a rather dominant role over Kate, making it clear that daughters should always help their mothers "first"</p>' + "<p>Despite this play, you can see they are more playing for your arousal and interest, so it is more like show than of two lovers allowing you to watch. That is fine by you, they are your slaves after all, and you had to go through a lot to get them and plan to enjoy them as much as you can!</p>");
				startQuestions();
				addLinkToPlaceC(md, "talk more to them", 177);
				WritePlaceFooter(md);
				return true
			}
			if (sType == "familytimejoin") {
				md = WritePlaceHeader(false, perYou.isMaleSex() ? "td-left-med" : "");
				if (perYou.isMaleSex())
					if (!isExplicit()) this.showPerson("!grangerfamily4.jpg");
					else this.showPersonRandomX("!grangerfamily4", 2);
				else this.showPerson("!grangerfamily2.jpg");
				addPlaceTitle(md, "Playing with the Granger Family");
				md.write("<p>After all you have been through for and with Kate and Mrs. Granger, it is time to enjoy the fruits of your efforts and the both of them! Time for yout hot school friend and her equally hot mother to thank you properly with their bodies.</p>");
				startQuestions();
				addLinkToPlaceC(md, "talk more to them", 177);
				WritePlaceFooter(md);
				return true
			}
			if (sType === "comfortable") {
				md = WritePlaceHeader();
				this.showPersonDN("granger-comfort.jpg", "height:max");
				addPlaceTitle(md, this.getPersonName());
				md.write("<p>Mrs. Granger makes herself comfortable for you. &quot;What are you waiting for, dear?&quot; she asks. Her invitation is clear, or would you prefer to just talk more to her.</p>");
				startQuestions();
				if (!this.checkFlag(12) && perKate.place == 1 && (perKate.isCharmedBy("You") ||
						perKate.checkFlag(22)))
					if (perKate.isCharmedBy("You")) addLinkToPlace(md, "ask Mrs. Granger to invite Kate to join us", 177, "type=katejoin");
					else addQuestionR(md, "ask Mrs. Granger to invite Kate to join us", "You mention the idea of asking Kate joining you and Mrs. Granger, and you see a small flash of jealousy pass over her face. She smiles and says she will ask Kate, but you stop her,</p>" + "<p>You can see she would prefer to keep you to herself, but also you doubt Kate would go along with it, while she loves you, this will clearly show you have her mother under control and it will probably end badly!",
						"", "setPersonFlag(\\'MrsGranger\\',12)");
				if (perYou.isMaleSex()) {
					addLinkToPlace(md, "fuck her", Place, "type=fuck");
					addLinkToPlace(md, "fuck her mouth", Place, "type=bj")
				} else {
					addLinkToPlace(md, "have her lick you", Place, "type=bj");
					addLinkToPlace(md, "make love to her", Place, "type=fuck")
				}
				addLinkToPlaceC(md, this.checkFlag(13) ? "talk more to them" : "talk to Mrs. Granger", 177);
				addLinkToPlace(md, "exit the house", 43);
				WritePlaceFooter(md);
				return true
			}
			if (sType == "fuck") {
				if (perYou.isMaleSex()) {
					md = WritePlaceHeader();
					if (isExplicit()) {
						var nd = this.dress == "Leather" && !isDay() || this.dress == "Turquoise";
						this.showPersonRandomX((nd ? "!" : "") + "granger17", 3, "height:max", "", "", "", 0, this.dress == "ShinyBlue" || this.dress == "Leather" && isDay())
					} else this.showPerson((this.dress == "ShinyBlue" ? "" : "!") + "granger17.jpg", "", "", "", "", this.dress == "ShinyBlue")
				} else {
					md = WritePlaceHeader(false, "td-left-large");
					if (!isDay() && this.dress == "ShinyBlue") this.showPersonRandom("granger18", 2, "", "", "", "", 0, true);
					else this.showPersonRandom("!granger18", 2)
				}
				addPlaceTitle(md,
					this.getPersonName());
				if (perYou.isMaleSex()) md.write("<p>After disrobing upon after following her into the bedroom, you catch sight of her, already nude and happy to see you have clearly come here for pleasure rather than business. You sit on her bed and motion for her to sit on your lap. She smiles and saunters over to server her beloved Master, and lowers herself upon your engorged cock. She grinds and slides around in your lap as you firmly thrust up into your slave's quivering pussy. Before long her gasps of delight are met with those of your own, and you cum deep within her.</p>" +
					'<p>"Thank you Hon" is all she says, the first words either of you have spoken during the entire exchange.</p>');
				else md.write("<p>You remember your first sexual experiments with another girl your age, and while it is a very pleasant memory, you recall a lot of awkward fiddling and trying to figure out what to do with each other.</p>" + "<p>Being with Mrs Granger is nothing like that.</p>" + "<p>Marie, as she likes to be called, really knows her body, and with the spell having removed any doubt or restrain she might have had from her mind, she is eager to use that knowledge for your pleasure as much as hers.</p>" +
					"<p>You usually allow the more experienced woman to take charge during your lust-filled encounters and have never regretted it. Her touch is at the same time tender and rough, often pinning you down possessively as she covers your body in kisses or slowly explores your most sensitive areas with her hands.</p>" + "<p>Right now, she has spread your legs and roughly pulled you close to her. Her eyes are watching your every reaction with hunger, and lustful noises from both of you fill the room every time she grinds her sex against yours, passionately carrying both of you to yet another climax.</p>" +
					"<p>You collapse on the bed and breath in deeply with your body still tingling from the aftermath, but there is little time for a break. Marie is already crawling on top of you and you feel her thigh sliding in-between your legs and her lips hovering above yours without saying a word, hoping you are ready for another round.</p>");
				startQuestions();
				addLinkToPlaceC(md, this.checkFlag(13) ? "talk more to them" : "talk to Mrs. Granger", 177);
				addLinkToPlace(md, "exit the house", 43);
				WritePlaceFooter(md);
				return true
			}
			if (sType ==
				"bj") {
				if (perYou.isMaleSex())
					if (isExplicit()) {
						md = WritePlaceHeader(false, "td-left-large");
						this.showPersonRandomX("!granger16b", 3)
					} else {
						md = WritePlaceHeader();
						this.showPerson("!granger16b.jpg")
					}
				else {
					md = WritePlaceHeader(false, "td-left-large");
					this.showPersonRandom("!granger16g", 2)
				}
				addPlaceTitle(md, this.getPersonName());
				if (perYou.isMaleSex()) md.write("<p>The change your spell brought forth within Kate's Mom is almost scary.</p>" + "<p>The way her eyes follow you whenever you visit remind you of a cat ready to pounce on its prey, and it takes her only seconds to follow your order to kneel in front of you and open your pants.</p>" +
					"<p>Mrs. Granger frees your shaft with shaky hands, spits on it and proceeds to use both hands to spread her saliva, constantly licking her upper lip and keeping her gaze locked on your manhood as it hardens under her touch.</p>" + "<p>She's obviously impatient and her eyes filled only with need and desire.</p>" + "<p>You groan in pleasure as your manhood finally reaches its full size, and almost immediately feel her lips wrap around the tip and her head moving forward. The woman's arms lock around your hip as she greedily pushes the entire length into her mouth, and you enjoy the tightness of her throat constricting around you as she pushes her lips all the way to the base.</p>" +
					"<p>A content sigh vibrates from her lips, her eyes closed, and she remains like this for several seconds, her fingertips digging into your asscheeks as if afraid you might pull away from her and she only allows herself to pull back when she finally needs to gasp for air.</p>" + "<p>You watch in fascination as she quickly recovers, presses her face against your manhood without letting go of your hip and steadies her breathing before she guides you right back into her mouth. Her entire body begins to roll back and forth in sensual, rhythmic motions, forcing your manhood in and out of her throat with greedy abandon, and even if you wanted to hold your orgasm back, you are not sure you could have.</p>" +
					"<p>Mrs Granger feels your climax approaching and tightens the grip around your hip, her head jerking back and forth violently the last seconds until you finally shoot your load into her mouth and she greedily drinks every single drop.</p>");
				else md.write("<p>You have barely finished giving the order as Mrs Granger already wordlessly throws you on a nearby couch and begins to take off your clothes, well, more like tearing them off.</p>" + "<p>You have to restrain her enthusiasm a little out off fear that you are left without anything to wear, and while she does slow down, her lack of patience is obvious. Your last remaining clothes are hastely pushed aside, and as your underwear finally flies into an undisclosed corner of the room, her lips are already firmly placed on your folds and her tongue slowly drags along their entire length.</p>" +
					"<p>You exhale a soft gasp as she flicks it over your clit and  allow your body to lie back, arms spread out behind you to let her tend to your needs.</p>" + "<p>Mrs Granger spreads your legs wide and takes in your scent. You enjoy the sensation of her fingers parting your folds, and your breath quickens as she begins to tickle your clit with her tongue. You close your eyes as the first waves of pleasure rush through your body and shiver blissfully as her thumbs gently massage your sensitive petals two fingers push into your warm canal to massage your inner walls, causing you to dig your own fingers into the pillows beneath.</p>" +
					"<p>In the following minutes, she watches every single of your reactions with delight, and you feel her fingers trailing over your legs and stomach to send pleasant shudders through your body, frequently tending to your sex while the motions of her tongue on your sensitive areas lure one lewd moan after another from your lips.</p>" + "<p>When you finally reach your peak, your entire body trembles under her touch while Mrs Granger greedily laps up your juices, and as you open your eyes again, her gaze is focused on you, eager, if not pleading, to continue, taste you again, and maybe even do more.</p>");
				startQuestions();
				addLinkToPlaceC(md, this.checkFlag(13) ? "talk more to them" : "talk to Mrs. Granger", 177);
				addLinkToPlace(md, "exit the house", 43);
				WritePlaceFooter(md);
				return true
			}
		}
		if (Place == 278 && sType == "mariefrisky") {
			md = WritePlaceHeader(false, perYou.isMaleSex() && !isExplicit() && this.checkFlag(10) ? "" : "td-left-med");
			if (perYou.isMaleSex())
				if (this.checkFlag(10)) this.showPersonRorX("!granger14cb.jpg");
				else this.showPersonRorX("!granger14db.jpg");
			else this.showPersonRandomRorX("!granger16g", 2);
			addPlaceTitle(md,
				"Frisky Mrs. Granger");
			if (perYou.isMaleSex())
				if (this.checkFlag(10)) md.write("<p>Mrs. Granger gives you a blowjob on the hospital bed</p>");
				else md.write("<p>You fuck Mrs. Granger on the hospital bed</p>");
			else md.write("<p>Mrs. Granger licks you and you play with her on the hospital bed</p>");
			startQuestions();
			addLinkToPlaceC(md, "open the curtains again", 278);
			WritePlaceFooter(md);
			return true
		}
		if (Place == 278 && sType == "leaving2") {
			this.health = 100;
			if (this.checkFlag(3)) {
				md = WritePlaceHeader();
				this.place = 261;
				this.showPerson("!granger14-arrest2.jpg");
				addPlaceTitle(md, "Arresting Mrs. Granger");
				md.write("<p>You quickly untie and remove Mrs. Granger's gag. She partially re-dresses and then ");
				if (wherePerson("OfficerKhan") == 278) md.write(getOfficer() + " Khan");
				else md.write("the " + getOfficer(false));
				md.write(" secures and handcuffs Mrs. Granger. They then walk out of the ward, Mrs. Granger looking at you over her shoulder and calls out \"Visit and we can play 'Jailbird and Prison Guard'\"</p>");
				startQuestions();
				addLinkToPlace(md, "follow them out of the ward", 214)
			} else {
				this.place = 177;
				md = WritePlaceHeader();
				this.showPerson("!granger14-leaving2.jpg");
				addPlaceTitle(md, "Mrs. Granger Leaving");
				md.write('<p>Mrs. Granger looks a little disappointed, "Of course Hon, we can always play Doctors and Nurses at home"</p>' + "<p>She resumes dressing and gives you a kiss, explaining she has to go and speak to the nurses. You make arrangements to meet her back at her home when you can.</p>");
				startQuestions();
				addLinkToPlace(md,
					"leave the ward", 214)
			}
			WritePlaceFooter(md);
			return true
		}
		return false
	};
	per.showPersonTextHere = function(md) {
		if (Place == 278 && this.place == 278)
			if (this.health < 74) md.write("<p>Mrs. Granger is sitting up but she seems very weak. She smiles at you meekly and begs forgiveness for not being available to you.</p>");
			else {
				md.write("<p>Mrs. Granger is sitting up and she seems to be getting better, so much so she is looking almost...frisky. ");
				if (this.checkFlag(11)) md.write("You see her glasses on her bed-side table.</p>");
				else md.write("You see a pair of glasses sitting a a table next to her bed. You have never seen her wearing glasses before.</p>")
			}
		if (Place == 275)
			if (this.other >= 50 && this.other < 54 && this.place == 275.5) md.write("<p>Mrs. Granger is lying in one of the beds. She looks bad: a heart monitor measures her erratic pulse.</p>");
			else if (this.other >= 54 && perYourBody.FindItem(29) !== 0 && this.place == 278) md.write("<p>Mrs. Granger is no longer in the unit. She must have been transported to one of the wards.</p>")
	};
	per.showPersonChat =
		function(bGeneral, md) {
			if (Place == 278 && this.isHere()) {
				if (this.other == 54) addQuestionC(md, "ask Mrs. Granger about the vase", "MrsGranger", 2354);
				if (this.health > 74)
					if (!this.checkFlag(11)) addPopupLinkC(md, "ask about the glasses", "Glasses?", "<img src='Images/" + this.getImg("granger14e", "") + ".jpg' class='imgpopup' alt='Nurse'>" + "You ask Mrs. Granger about her glasses, you have never seen her wearing them before,<br><br>" + '"I usually wear contacts, but they were lost when I was..hurt. Do you like me wearing glasses?"<br><br>' +
						'"She stands up and puts on her glasses, as she does what little she is wearing falls away. She looks at you seductively, she if definitely feeling much better! You look at her figure and tell her how you very much like to see her wearing her glasses,<br><br>' + "She smiles and redresses and lies down,<br><br>" + '"I do not really like wearing them, but if you like me in them Hon, I will wear them for you"', false, "setPersonFlag('MrsGranger',11)");
					else if (sType === "" && this.health != 99) addLinkToPlace(md,
					"draw the curtain around Mrs. Granger's bed", 278, "type=mariefrisky", "", "setPersonFlag('MrsGranger',10,!checkPersonFlag('MrsGranger',10))")
			} else if (Place == 275)
				if (this.other == 50 && this.place == 275.5) addPopupLinkC(md, "ask about Mrs. Granger", "Intensive Care Nurse", "<img src='Images/megan1b.jpg' class='imgpopup' alt='Nurse'>" + "You enter the public area of the ICU and you see a nurse there, she seems to be testing a piece of medical equipment. You ask her about Mrs. Granger,<br><br>" + '"Mrs Granger is in a very dangerous condition. I\'m sorry, but you are going to have to leave unless you are a relative of hers."<br><br>' +
					"There is no way you can claim to be a relative, after all you called her Mrs. Granger. While thinking you look at the nurse appreciatively, you have to admire the choice of uniforms in this hospital. " + "As you do the nurse looks at you knowingly,<br><br>" + '"There is a lot more to being a nurse than being some ' + perYou.getSex() + "'s sexual fantasy, please leave and we will do our best for your friend\"", false, "setPersonOther('MrsGranger', 51);dispPlace();")
		};
	per.handleItem = function(no, cmd) {
		if (no ==
			14 && cmd == 2)
			if (Place == 177 && this.place == 177) {
				CastCharmSpell("MrsGranger", 33, 1, "", "", "type=recharm1");
				return "handled"
			}
		return ""
	};
	per.isPhoneable = function() {
		return checkPlaceFlag("Hotel", 11) && Place == 269 && this.isCharmedBy()
	};
	per.callThem = function() {
		if (Place == 269)
			if (this.place != 177) WriteComments("You call Mrs. Granger to invite her to join you at the pool for a swim, there is no answer.");
			else {
				gotoPlace(Place, "type=grangerpool");
				receiveCall("", 'You call Mrs. Granger to invite her to join you at the pool for a swim, and she answers, "Of course, dear, I will get my things and meet you there"');
				WriteCommentsFooter(bChat, bChatLeft)
			}
	};
	per.addPersonPhoneCall = function() {
		if (Place != 177 && Place != 139 && Place != 108 && Place != 35 && this.isCharmedBy() && this.checkFlag(9) && this.whereNow() == 177) {
			findPerson("Kate");
			if (per.place == 1)
				if (makeCall(true, 220)) this.setFlag(9, false)
		}
		return false
	};
	per.getPersonSMS = function(id) {
		if (id == 220) return receiveSMS("MarieMILF", "My daughter is home, but her mother will do a lot more to you", "grangersms1.jpg");
		return ""
	}
}

function RepliesMrsRobbins(nR) {
	var bCharm = per.isCharmedBy("You");
	var myName = per.getYourNameFor();
	var bDCharm = per.isCharmedBy("Davy");
	var perG = per;
	var perT = findPerson("Tina");
	if (nR == 500) {
		addComments('"Oh, it is down the hall, second on the left", she gestures towards the room."');
		setPlaceKnown("DavysRoom")
	} else if (nR == 640) {
		if (!bDCharm) addComments("\"Davy? He was here earlier and mentioned your name. Then he said something like 'Dai Chu' and everything went blank. I woke up to see you here.\"");
		else addComments('"Oh Davy," Mrs. Robbins murmurs to herself. "My son. He is such a good boy. He knows how to treat his mother."');
		perG.setFlag(1)
	} else if (nR == 613) {
		if (bDCharm) addComments("\"Your teacher? I don't even know the man, I'm sure my darling Davy has never met with him here.\"");
		else addComments("\"Your teacher? I don't even know the man, I'm sure Davy has never met with him here.\"");
		perG.setFlag(3)
	} else if (nR == 631) {
		perT.charmed = 3;
		addComments("")
	} else if (nR == 5901) {
		perDavy.setQuestBlueBottle(2);
		if (!bCharm)
			if (bDCharm) addComments('"Davy has never acted strangely," says Mrs. Robbins, rubbing her crotch. "But I never realised how attractive my son was until he opened the blue bottle today."');
			else addComments('"Davy?  Well, he did begin acting strangely after he opened the blue bottle.  That\'s when he said those words..." she says, trying to remember what happened after that.');
		else addComments('"Yes, ' + myName + ".  It began when he opened the bottle this morning.  I believe that's when he enslaved me, " + myName + ", because I don't remember much between then and when I my true " + myName + ' took me."')
	} else if (nR == 5902) {
		perDavy.setQuestBlueBottle(3);
		if (!bCharm)
			if (bDCharm) addComments('"Our special heirloom. Why are you asking so many questions about Davy?  Does he know you\'re here?"');
			else addComments('"Our special heirloom. That bottle has been passed down through my family for generations. Since... well, a long time, at the very least!"');
		else {
			addComments('"It is an heirloom of my family, ' + myName + ".  Or, at least, it was.  Now all that I am, and all that I have is yours, " + myName + ".  Take anything you like.");
			if (perT.charmed === 0) addComments(" Including my daughter if she suits you. Yes!  You must take her " + myName + '!  She must learn what it means to serve you as I do."');
			else addComments('"')
		}
	} else if (nR ==
		6100) addComments('"Oh yes, ' + myName + "!  She has a young and supple body that I'm sure would please you, " + myName + ', plus my son Davy mentioned something about her being a witch.  I\'m sure she would make an excellent <i>slave</i> for you," she says getting rather excited. "I threw her into the bedroom so Davy could take her when he got back.  Please, ' + myName + ', take her before my unworthy son returns!  He does not deserve her!"');
	else if (nR == 5903) {
		perDavy.setQuestBlueBottle(4);
		if (!bCharm)
			if (bDCharm) addComments("\"I don't have it anymore.  I sold it for " +
				sCurrency + "2000 to that " + perGates.getPersonName() + " fellow.  I'm sure Davy will be very pleased with me.  He may even fuck me again.  Mmmm...\" She trails off, evidently lost in memory.");
			else addComments("\"Oh, I'm sorry " + myName + ". When Davy opened the bottle he acted so odd. I thought that he was sick then he said those strange words <i>Dai Chu</i> and I loved him more than a mother should. After he left, " + perGates.getPersonName() + " came by and offered me " + sCurrency + '2,000 for the bottle. So I... I sold it to make Davy happy about the money."');
		else addComments("\"Oh, I'm sorry " + myName + '!" she says, getting down on her knees to beg forgiveness. "If I had known I was to be <i>your</i> slave instead of my worthless son Davy I would never have...  I...  I sold it, ' + myName + " - to " + perGates.getPersonName() + '. I gave all the money to Davy.  Otherwise it would be yours, just as I am."')
	}
	return true
}

function initialiseMrsRobbins() {
	addPerson("Mrs. Robbins", 176);
	per.charmThem(1, "Davy");
	per.Replies = RepliesMrsRobbins;
	per.getPersonAddress = function() {
		return this.checkFlag(2) ? "36 Yoolaroo Dr, Glenvale" : ""
	};
	per.getPersonName = function(full) {
		return full !== true && this.isCharmedBy("You") ? "Slave Geraldine" : this.name
	};
	per.getPossessionFace = function() {
		return this.isCharmedBy("You") ? "robbinsc-face" : "robbinsu-face"
	};
	per.whereNow = function() {
		if (this.place == 176 && Place == 130 && this.isCharmedBy("You") && isCharmedBy("Tina",
				"You")) return Place;
		return this.place
	};
	per.isPersonInfo = function() {
		return this.isCharmedBy("You")
	};
	per.getPersonInfo = function() {
		if (Place == 176 && isCharmedBy("Tina")) return "<img src='Images/robbins8b.jpg' class='imgpopup' alt='Geraldine and Tina'>" + "Geraldine and Tina Robbins, mother and daughter of the Robbins family. You have taken them from Davy and made them your own.<br><br>" + "Each has their own qualities, Tina is beautiful and knows the way of witches and the occult. Geraldine is pretty, mostly ignorant of the occult, but she is determined and domineering...when you let her.";
		else return "<img src='Images/robbins5.jpg' class='imgpopup' alt='Geraldine'>" + "Mrs Robbins has been charmed by her very own son! You knew she acted weird when you asked about Davy. She talked like she was obsessed about him! An effect that only the mind control spell brings out. Now, she\u2019s only interested in you and being your servant. After you broke Davy\u2019s spell it was the most logical step to bring Mrs Robbins under your power. However, she\u2019s dumb as a rock and is no big use to you. She doesn\u2019t know anything about the world of magic and what her son\u2019s plans were. In compensation of her lack of knowledge she offered the house and everything in it, even her daughter to you!</p>" +
			"<p>She told you that the tales were true, the Robbins family really is a descendant of Kurndorf and they were a force to be reckoned with in the last century. Their power has decreased in the years, that\u2019s why they needed to sell the mansion that now Richard Gates owns.</p>" + "<p>Mrs Robbins ushers you in the house immediately after you rang the bells. She is eager to serve you in all the ways possible!"
	};
	per.showEventPopup = function() {
		if (sType !== "") return false;
		if (Place == 176 && !this.checkFlag(2)) {
			showPopupWindow("Mrs. Robbins",
				"<img src='Images/robbins0.jpg' class='imgpopup' alt='Mrs Robbins'>" + "Mrs Robbins, the mother of your nemesis Davy has a lot common with her son. She\u2019s rude, pompous and doesn\u2019t make a good first impression in you. Mrs Robbins must be around her early 40\u2019s but she keeps herself in good shape. Something is odd though, as if you feel some kind of force around her.</p>" + "<p>The house itself is large and radiates wealth with all the exotics statues, paintings and furnitures. You can only see glimpses of the house and rooms because Mrs Robbins is always on guard and stopping you from further exploring the house on your own. You should talk to her, she\u2019s Davy\u2019s mother after all. She must know something!</p>" +
				"<p>Before you can ask her she frowns at you and tersely introduces herself as Geraldine Robbins. Her speech is polite but similarly terse as she says,</p>" + (perYou.isBornMale() ? '"My daughter is not receiving callers, <i>ever</i> again", and you see her glance at a bedroom door down the hall leading from the room you are in. She almost loses interest in you, seeming to be thinking about something more appealing.' : '"My darling son did not send you did he? Well he should of!", and you see her glance at a bedroom door down the hall leading from the room you are in. She reaches out to touch your shoulder, "Why not wait somewhere more comfortable for him?"'),
				"setPersonFlag('MrsRobbins',2)");
			return true
		}
		if (Place != 130 || sType !== "" || !this.isCharmedBy("Davy") || checkPlaceFlag("RobbinsHouse", 9) || perYou.isBornMale()) return false;
		setPlaceFlag("RobbinsHouse", 9);
		showPopupWindow("Mrs Robbins", "<img src='Images/robbins1m.jpg' style='width:30%;float:right;margin-left:5px' alt='Blocked'>" + (getPersonOther("Tina") === 0 ? 'Mrs. Robbins screams, "Another girl for my lovely son! In you go to my bedroom you bitch and don\'t come out until Davy has cast his pretty spell."' : "Mrs. Robbins throws you back into the bedroom. \"I told you to get into the bedroom you bitch!  Davy hasn't come home to claim you yet and you're not leaving till he does!") +
			"<br><br>She slams and locks the door to the bedroom");
		return true
	};
	per.showEvent = function() {
		var md;
		if (Place == 269 && sType == "geraldinepool") {
			WaitHereOnly(6);
			md = WritePlaceHeader();
			this.showPerson("robbins-pool.jpg");
			addPlaceTitle(md, "Swimming with Geraldine");
			md.write("<p>Geraldine arrives, dressed in a pink bikini, and she seductively poses for you.</p>");
			startQuestions();
			addLinkToPlaceC(md, "it is fairly private here...", Place, "type=geraldinepoolsex");
			addLinkToPlaceC(md, "say goodbye to Geraldine", Place);
			WritePlaceFooter(md);
			return true
		}
		if (Place == 269 && sType == "geraldinepoolsex") {
			md = WritePlaceHeader();
			this.showPerson("robbins-pool-sex.jpg");
			addPlaceTitle(md, "Being Discrete and Private with Geraldine");
			md.write("<p>You ask Geraldine to play with you more privately, and she seductively removes most of her swimsuit and lies back waiting for you.</p>");
			startQuestions();
			addLinkToPlaceC(md, "later...say goodbye to Geraldine", Place);
			WritePlaceFooter(md);
			return true
		}
		if (Place != 130) return false;
		var herName = this.getPersonName();
		var perTina = findPerson("Tina");
		if (sType == "geraldineprivate") {
			md = WritePlaceHeader();
			if (perTina.isCharmedBy()) this.showPerson("robbins9b.jpg");
			else this.showPerson("robbins9a.jpg");
			addPlaceTitle(md, "Geraldine in Davy's Bedroom");
			md.write("<p>You tell Mrs Robbins that it would be nice to speak to her privately. She smiles and leads you into " + (perTina.isHere() ? "a" : "her") + " bedroom.</p>" + '<p>She sits on her bed and asks, "Well, we didn\'t just come here to talk did we?"</p>');
			startQuestions("You didn't, you came here to...");
			if (perYou.isMaleSex()) {
				addLinkToPlace(md, "fuck her", Place, "type=geraldinefuck");
				addLinkToPlace(md, "get a blowjob", Place, "type=geraldinebj")
			} else {
				addLinkToPlace(md, "have her lick you", Place, "type=geraldinebj");
				addLinkToPlace(md, "have sex with her", Place, "type=geraldinefuck")
			}
			if (!isDay() && !perTina.isHere()) addPopupLinkC(md, "go to bed for the night with Geraldine", "Bedding Geraldine", '<img src="Images/robbins12a.jpg" class="imgpopup" alt="Geraldine">' + "You call Geraldine to join you. She is very happy, and puts on a show for you, dressing up and then stripping for you.<br><br>One thought crosses your mind before you lie down for the night, why does she own a dominatrix style outfit?",
				true, "sleepForNight(130, 'When you wake in the morning Geraldine has left to prepare breakfast.');");
			addLinkToPlace(md, "return to the living room", 176);
			addLinkToPlace(md, "leave the house", 43);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "geraldinefuck") {
			md = WritePlaceHeader(false, perYou.isMaleSex() ? "td-left-med" : "");
			if (isExplicit())
				if (perYou.isMaleSex()) this.showPersonRandomX("robbins11b", 2);
				else this.showPersonX("robbins11g.jpg");
			else if (perYou.isMaleSex()) this.showPerson("robbins11b.jpg");
			else this.showPerson("robbins11g.jpg");
			addPlaceTitle(md, herName);
			if (perYou.isMaleSex()) md.write("<p>\u201cYou will undress. You will bend over your bed, and you will present your pussy to me, understood?\u201d</p>" + "<p>Pretty much from the first time Geraldine had given herself to you, you noticed how she reacts best to a firm voice and harsher treatment, and you were surprised how naturally both came to you after spending some time with her.</p>" + "<p>\u201cYes, " + perYou.getMaster() + "!\u201d Geraldine trembles with excitement as she hastily throws her clothes away, and when she finally bends over and spreads her legs, her folds are already dripping with need.</p>" +
				"<p>\u201cSo horny...\u201d You draw your fingers through her slit and smear her juices over her ass. \u201cWhat do you think your son would say, seeing you offering your needy snatch to his rival?\u201d</p>" + "<p>\u201cHe'd be furious, " + perYou.getMaster() + "!\u201d Geraldine shakes her ass impatiently. \u201cThat stupid boy can only wish he would make me feel the way you do!\u201d</p>" + "<p>It's almost eerie how completely Geraldine has given herself and by extend her family to you. Davy is your enemy, and so he is hers, family bonds or not.</p>" +
				"<p>\u201cYou want him to see you, do you?\u201d You place a harsh slap on her ass and open your pants. \u201cYou want him to watch as I make you scream and beg on his own bed.\u201d</p>" + "<p>\u201cYes, " + perYou.getMaster() + "!\u201d Geraldine twitches under the strike and you immediately push your cock into her wetness, mercilessly pounding away.</p>" + "<p>\u201cAnd you want him to watch as I make you cum over and over again, isn't that so?\u201d Another strike to her butt-cheeks makes her yowl in delight while you pick up the pace, taking her with increased roughness.</p>" +
				"<p>\u201cOh yes, " + perYou.getMaster() + "! Yesyesyes!\u201d</p>" + "<p>\u201cThen cum for me, Slave!\u201d You strike her ass again and Geraldine groans in pure bliss. \u201cShow me how much you enjoy my cock.\u201d</p>" + "<p>\u201cYes " + perYou.getMaster() + "!\u201d \u201cThank you " + (perYou.isBornMale() ? "Mastahhhh" : "Mistreeeh") + "...!\u201d</p>");
			else md.write("<p>Pretty much from the first time Geraldine gave herself to you, you had noticed how she reacts best to a firm voice and harsher treatment, and you were surprised how naturally both came to you after spending some time with her.</p>" +
				"<p>\u201cYou will undress yourself, Slave, and you will help me out of my clothes, carefully.\u201c You put emphasis on the last word, Geraldine has a habit of getting a little too enthusiastic and you don't want to risk walking home with torn clothes.</p>" + "<p>Of course, your slave does as she is told, her hands shaky as she slowly peels you out of your clothes and her eyes still impatiently following your every motion when she is finally done.</p>" + "<p>You watch her body shiver in pleasure when you commend her on the good work, and her eyes follow you impatiently as you walk across the room and sit down on her bed with a cocky smirk.</p>" +
				"<p>\u201cAnd now, you will show me just how good an experienced woman can be, slave.\u201d</p>" + "<p>\u201cGladly!\u201d Geraldine darts forward like a beast unleashed and pulls you to the edge of the bed, her tongue and lips tasting your bare skin as her hands begin to explore every inch of your body.</p>" + "<p>You gasp softly as the sucks in your little nub and places a kiss right above your bellybutton, and your body shudders in delight when she begins to massage and lick your breasts. Geraldine clearly knows how to touch another woman, and soon, you find yourself close to orgasm, her fingers deeply embedded within your sensitive sex while she watches your every motion, eyes completely mesmerized as your head rolls back and your first climax washes over you.</p>" +
				"<p>You take a moment to catch your breath, but it doesn't look as if Geraldine is done just yet. Her fingers shift a little, and as her  lips begin to touch your neck, you know  she will tend to you tirelessly until either you or she is unable to go on, and that can take a while.</p>");
			startQuestions();
			addLinkToPlace(md, "return to the living room", 176);
			addLinkToPlace(md, "leave the house", 43);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "geraldinebj") {
			if (isExplicit())
				if (perYou.isMaleSex()) {
					md = WritePlaceHeader();
					if (perTina.isCharmedBy()) this.showPersonX("robbins10bsolo.jpg");
					else this.showPersonRandomX("robbins10b", 4)
				} else {
					md = WritePlaceHeader(false, perYou.isMaleSex() ? "td-left-med" : "");
					this.showPerson("robbins10g.jpg")
				}
			else {
				md = WritePlaceHeader(false, perYou.isMaleSex() ? "td-left-med" : "");
				if (perYou.isMaleSex()) this.showPersonRandom("robbins10b", 2);
				else this.showPerson("robbins10g.jpg")
			}
			addPlaceTitle(md, herName);
			if (perYou.isMaleSex()) md.write("<p>\u201cWhat do you think we came here to do, slave?\u201d You take a handful of Geraldine's hair and harshly push her face against your crotch, much to the woman's delight.</p>" +
				"<p>\u201cTo have dirty sex in my bedroom, " + perYou.getMaster() + ".\u201d Your slave coos and rubs her face lovingly against the bulge in your pants.</p>" + "<p>\u201cYou would like that, would you?\u201d You take a step back but keep the grip on her hair up to force her off the bed and to kneel in front of you. \u201cSucking off your son's rival, taking " + perYou.getHisHer() + " cock into your throat...\u201d</p>" + "<p>\u201cYes... oh so much yes!\u201d She twitches impatiently, her hands fiddling with your zipper until she finally frees the already half erect shaft.</p>" +
				"<p>\u201cImagine him seeing you now...\u201d She doesn't even react to your words, her lips and tongue are eagerly sliding all over your manhood, and the moment you are finally fully erect, she pushes you all the way down into her throat.</p>" + "<p>\u201cSo eager, so horny...\u201d You push her head forward the last few millimeters and her lips wrap around the base. \u201cSo very enthusiastic.\u201d</p>" + "<p>It may be a residual effect of her time under Davy's spell, but Geraldine loves dirty talk like this and is genuinely turned on by it. So what started as a few off remarks, have turned into an integral part of your time with her.</p>" +
				"<p>Geraldine gags up after a few seconds, and you pull back to allow her to breath in only to push right back into her, quickly falling into a comfortable rhythm until you finally reach your peak and unload yourself into her throat.</p>");
			else md.write("<p>\u201cWhat do you think we came here to do, slave?\u201d You take a handful of Geraldine's hair and harshly push her face against your crotch, much to the woman's delight.</p>" + "<p>\u201cTo have dirty sex in my room, Mistress. Your slave coos and lovingly rubs her face against the fabric covering your crotch.</p>" +
				"<p>\u201cYou would like that, would you?\u201d You take a step back but keep the grip on her hair up to force her to kneel in front of you. \u201cLicking the pussy of your son's rival, spilling her juices all over your slutty face.\u201d</p>" + "<p>\u201cYes... oh so much yes!\u201d She twitches impatiently and begins to undress you, eager to taste your skin.</p>" + "<p>\u201cImagine him seeing you now...\u201d She doesn't even react to your words. Her lips and tongue eagerly wander all over your skin, kissing your thighs, licking your ass, slowly moving up inch by inch and finally pushing her face in-between your legs.</p>" +
				"<p>\u201cSo eager, so horny...\u201d You drive your fingers through her hair and spread your legs just enough for her tongue to reach your clit. \u201cSo very enthusiastic.\u201d</p>" + "<p>It may be a residual effect of her time under Davy's spell, but Geraldine loves dirty talk like this and is genuinely turned on by it. So what started as a few off remarks, have turned into an integral part of your time with her.</p>" + "<p>You gasp softly under her attention and make sure to hold her head in place, though it isn't really needed at all. Geraldine's arms pull around your legs as if afraid you might be the one to let go and her tongue eagerly explores your folds and teases your clit, expertly raising your arousal until you gasp and moan under her skillful motions, keeping one hand on her head and your fingers wrapped around her hair until you finally reach your peak.</p>" +
				"<p>\u201cGood girl... now make sure to clean it all up.\u201d</p>");
			startQuestions();
			addLinkToPlace(md, "return to the living room", 176);
			addLinkToPlace(md, "leave the house", 43);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "motherdaughter") {
			md = WritePlaceHeader(false, "td-any");
			WaitHereOnly(6);
			if (perYou.isMaleSex()) this.showPersonRorX("robbinsthreesomeb.jpg", "height:max");
			else this.showPerson("robbinsthreesomeg.jpg", "height:max");
			addPlaceTitle(md, "Mother/Daughter Time");
			md.write("<p>Both mother and daughter happily guide you into the bedroom together, eagerly covering your body in tender affections and removing your clothes.</p>" +
				"<p>Tina is a little more hesitant, mostly focused on your pleasure and desires, but, submissive as she is, easily gets carried away by her mothers domineering personality and shameless enthusiasm, growing bolder and more passionate every minute you are together.</p>" + "<p>Geraldine, on her end, practically offers her daughter up to you. Whenever she is not tending to you, she is often trading sloppy, tongue heavy kisses with the girl and always makes sure that Tina presents herself well. Shoulders back, tits out, legs spread, back arched, ass up... it's one of the very few times you allow her to somewhat take charge and she always savors the opportunity to make sure her daughter is looking her best whichever way you may decide to take her.</p>" +
				"<p>And you know plenty of ways to enjoy the pair. Sometimes you actively pleasure one or both of them with hands or lips, sometimes you just lean back and let them tend to you and sometimes you just have wild sex with one of them while the other watches. Both mother and daughter never fail to do their utmost to please you, and you have come to quite enjoy your visits to the Robbin's residence.</p>");
			startQuestions();
			addLinkToPlace(md, "leave the bedroom", 176);
			WritePlaceFooter(md);
			return true
		}
		if (sType ==
			"foursome") {
			md = WritePlaceHeader(false, perYou.isMaleSex() && isExplicit() ? "td-left-med" : "");
			WaitHereOnly(6);
			var perMayor = findPerson("Mayor");
			if (perYou.isMaleSex() && isExplicit()) perMayor.showPersonX("mayorrobbinsb.jpg");
			else perMayor.showPerson("mayorrobbins.jpg");
			addPlaceTitle(md, "All-in Playtime");
			md.write("<p>You invite Geraldine, Tina and Mayor Thomas to join you in the bedroom to indulge in some group play.</p>");
			startQuestions();
			addLinkToPlace(md, "leave the bedroom", 176);
			AddPeopleColumnMed(md);
			this.showPerson("robbinsmayor.jpg");
			WritePlaceFooter(md);
			return true
		}
		return false
	};
	per.showPersonChat = function(bGeneral, md) {
		if (Place == 130 && !isPersonHere("Tina") && sType === "" && this.isCharmedBy("You")) {
			if (!isDay()) addPopupLinkC(md, "go to bed for the night with Geraldine", "Bedding Geraldine", '<img src="Images/robbins12a.jpg" class="imgpopup" alt="Geraldine">' + "You call Geraldine to join you. She is very happy, and puts on a show for you, dressing up and then stripping for you.<br><br>One thought crosses your mind before you lie down for the night, why does she own a dominatrix style outfit?",
				true, "sleepForNight(130, 'When you wake in the morning Geraldine has left to prepare breakfast.');")
		} else if (Place == 176 && this.isHere() && sType === "") {
			var perTina = findPerson("Tina");
			if (perDavy.other > 0 && !this.checkFlag(3)) addQuestionC(md, '"Mrs Robbins, has Davy been meeting Mr Beasley recently?"', "MrsRobbins", 613);
			if (perDavy.getQuestBlueBottle() == 1) addQuestionC(md, '"Mrs Robbins, has Davy been acting strangely recently?"', "MrsRobbins", 5901);
			else if (perDavy.getQuestBlueBottle() == 2) addQuestionC(md, '"Do you know anything about a blue bottle?"',
				"MrsRobbins", 5902);
			else if (perDavy.getQuestBlueBottle() == 3) addQuestionC(md, '"Can I see it?  The bottle?"', "MrsRobbins", 5903);
			if (!this.isCharmedBy())
				if (isInvisible()) addLinkToPlace(md, "check the bedroom", 130, "While the invisibility spell lasts you walk behind Mrs. Robbins and enter the bedroom quickly so she does not notice. As you do the spell immediately ends.");
				else addPopupLink(md, perTina.checkFlag(1) ? "go to Mrs Robbins bedroom" : "check the bedroom", "Mrs. Robbins", "<img src='Images/robbins1m.jpg' class='imgpopup' alt='Blocked'>" +
					"<p>Mrs. Robbins blocks your way to her bedroom.</p>" + '<p>"Excuse me, but you are a visitor to my house, you cannot just wander around. If you have nothing else to discuss then please leave."</p>', false, "Leave(true);");
			else if (this.isCharmedBy("Davy"))
				if (!isInvisible())
					if (perYou.isBornMale()) addPopupLink(md, perTina.checkFlag(1) ? "go to Mrs Robbins bedroom" : "check the bedroom", "Mrs. Robbins", "<img src='Images/robbins1m.jpg' class='imgpopup' alt='Blocked'>" + "<p>Mrs. Robbins blocks your way to her bedroom.</p>" +
						"<p>\"No way! That room is locked for Da...a reason. You won't get in there while I'm around.\"</p>" + '<p>She rudely pushes you away from the door and tells you<br>"It is time you left my house"', false, "Leave(true);");
					else addLinkToPlace(md, perTina.checkFlag(1) ? "go to Mrs Robbins bedroom" : "check the bedroom", 130, "", "", "", "ThrownToBedroom()");
			else addLinkToPlace(md, "check the bedroom", 130, "While the invisibility spell lasts you walk behind Mrs. Robbins and enter the bedroom quickly so she does not notice. As you do the spell immediately ends.");
			else {
				var bTinaAwake = perTina.isCharmedBy() && !(perTina.isVampyre() && (isDay() || !perTina.checkFlag(6)));
				if (!isPlaceKnown("DavysRoom")) addQuestionC(md, '"Where is Davy\'s room?"', "MrsRobbins", 500);
				if (bTinaAwake) addLinkToPlace(md, "'talk' to Tina in her bedroom", 163);
				else addLinkToPlace(md, perTina.checkFlag(1) ? this.isCharmedBy("You") ? "go to Slave Geraldine's bedroom" : "go to Mrs Robbins bedroom" : "check the bedroom", 130);
				addLinkToPlace(md, "'talk' to Slave Geraldine privately", 130, "type=geraldineprivate");
				if (bTinaAwake) {
					addLinkToPlaceC(md,
						"take both into Slave Geraldine's bedroom", 130, "type=motherdaughter");
					if (wherePerson("Mayor") == 176 && isCharmedBy("Mayor", "You")) addLinkToPlaceC(md, '"Let\'s <i>all</i> of us have some fun"', 130, "type=foursome")
				}
				if (!perTina.isCharmedBy() && perTina.other === 0) addQuestionC(md, '"Geraldine, is your daughter home?"', "MrsRobbins", 6100)
			}
		}
	};
	per.showPersonTextHere = function(md) {
		if (Place == 176 && this.isHere() && !isInvisible()) {
			var bDCharm = this.isCharmedBy("Davy");
			var perTina = findPerson("Tina");
			if (this.isCharmedBy("You") &&
				perTina.isCharmedBy()) md.write("<p?Geraldine and Tina Robbins are keen to see you return to their home. The ladies look like they are ready to do whatever you ask.");
			else if (this.isCharmedBy("You")) md.write("<p>Geraldine Robbins looks at you with hunger in her eyes, obviously happy that you've returned, and more than willing to do anything you ask.");
			else if (perYou.isBornMale() || !bDCharm) md.write("<p>On entering the front door you meet with the family's mother. Not being used to visitors, Mrs Robbins frowns at you. Her speech is polite but terse as she asks you what you want.");
			else if (checkPlaceFlag("RobbinsHouse", 9)) md.write('<p>On entering the front door you meet Mrs Robbins again, she moves step between you and the front door, "Now you sneaky little bitch, get back in the bedroom and wait there for my darling Davy!"');
			else md.write('<p>On entering the front door you meet with the family\'s mother. Not being used to visitors, Mrs Robbins is acting friendly towards you, and reaches out to touch your shoulder, "Why not wait somewhere more comfortable for my darling Davy?".');
			if (this.isCharmedBy("You") && wherePerson("Ellie") == 93) md.write(" Geraldine tells you that a girl is here visiting her son and has gone into his room, She gestures to the room.");
			md.write("</p>")
		}
	};
	per.handleItem = function(no, cmd) {
		if (no == 14 && cmd == 2)
			if (Place == 176 && this.isHere()) {
				var bDCharm = isCharmedBy("MrsRobbins", "Davy");
				if (wherePerson("Mayor") == 176) {
					if (!isCharmedBy("MrsRobbins", "You"))
						if (isSpellKnown("Shielded Charm")) addComments("This gathering is a little too intimate, even for Shielded Charm.");
						else addComments("Can't cast that here, its too public.")
				} else if (!this.isCharmedBy()) CastCharmSpell("MrsRobbins", 79, 1);
				else if (bDCharm) addComments("You attempt to cast the spell, but if fails to take effect... Evidently she is already under the effects of a charm spell...  Someone <i>else's</i> spell.");
				return "handled"
			}
		return ""
	};
	per.isPhoneable = function() {
		return checkPlaceFlag("Hotel", 11) && Place == 269 && this.isCharmedBy()
	};
	per.callThem = function() {
		if (Place == 269) {
			gotoPlace(Place, "type=geraldinepool");
			receiveCall("", "You call Geraldine to invite her to join you at the pool for a swim, and she answers that it is agreeable and will be there in a while.");
			WriteCommentsFooter(bChat, bChatLeft)
		}
	};
	per.addPersonPhoneCall = function() {
		if (this.hoursCharmed() > 24 && !this.checkFlag(4))
			if (makeCall(true, 300)) this.setFlag(4);
		return false
	};
	per.getPersonSMS = function(id) {
		if (id == 300) return receiveSMS("Geraldine", "Tina took this of me last Halloween", "robbinssms1.jpg");
		return ""
	}
}

function initialiseMrsTanika() {
	addPerson("Mrs. Tanika");
	per.getPossessionFace = function() {
		return "tanika-face"
	};
	per.getPersonName = function(full) {
		if (full === true) return this.name;
		if (this.isCharmedBy()) {
			var clv = this.getCharmedLevel();
			if (clv == 4) return "Slave Tanika";
			if (clv == 3) return "Fuck-toy Tanika";
			if (clv == 2) return "Susan Tanika, your lover";
			return "Mrs. Tanika, your servant"
		} else return this.name
	};
	per.getPersonNameShort = function() {
		if (this.isCharmedBy()) {
			var clv = this.getCharmedLevel();
			if (clv == 4) return "Slave Tanika";
			if (clv == 3) return "Fuck-toy Tanika";
			if (clv == 2) return "Susan Tanika";
			return "Mrs. Tanika"
		}
		return this.name
	};
	per.isPersonInfo = function() {
		return true
	};
	per.getPersonInfo = function() {
		switch (this.getCharmedLevel()) {
			case 0:
				return "<img src='Images/tanika1a.jpg' style='width:30%;float:right;margin-left:5px' alt='Ms. Tanika'>" + "Mrs. Tanika, your math teacher, you do not really like her, she is a rather strict and standoff-ish teacher who seldom smiles. She has a body to die for but she is either uncaring or looks down on her students. Your friend Catherine once suggested she might get off on humiliating people, and be a closet dominatrix. Then again Catherine always assumes people are kinky, maybe she is right.";
			case 1:
			case 2:
				return "<img src='Images/tanika10.jpg' style='width:30%;float:right' alt='Ms. Tanika'>" + "Mrs. Tanika, your math teacher, and now lover. She is still strict and stand-offish to others, but she is your lover now!";
			case 3:
				return "<img src='Images/tanika12b.jpg' style='width:30%;float:right' alt='Ms. Tanika'>" + "Mrs. Tanika, once your math teacher and married woman, now she is your fuck-toy, a plaything to satisfy all your sexual desires.";
			case 4:
				return "<img src='Images/tanika12b.jpg' style='width:30%;float:right' alt='Ms. Tanika'>" +
					"Mrs. Tanika, once your math teacher, she is now your slave, utterly submissive to you, thinking only how to please you."
		}
	};
	per.whereNow = function() {
		return !isDay() && !this.isCharmedBy() ? 0 : this.place
	};
	per.passTimeDay = function() {
		if ((this.place == 46 || this.place == 45) && this.getCharmedLevel() == 2) {
			this.place = 242;
			if (Place == 46 && this.place == 46) return "<p>In the morning Mrs Tanika gives you a kiss and tells you she is off to work.</p>"
		}
		return ""
	};
	per.passTimeNight = function() {
		if (this.place == 242 && this.getCharmedLevel() ==
			2 && !this.checkFlag(4)) {
			this.place = this.checkFlag(2) ? 46 : 45;
			if (Place == 242) return "<p>As night falls Mrs Tanika leaves school for the day.</p>"
		}
		return ""
	};
	per.showEvent = function() {
		var md, clv;
		if (sType == "tanikaxxx") {
			clv = this.getCharmedLevel();
			var tn = this.getPersonNameShort();
			var mtn = clv == 3 ? "your toy, Mrs. Tanika" : clv != 4 ? tn : "your slave, Mrs. Tanika";
			var bSchool = this.place == 242;
			if (bSchool) {
				md = WritePlaceHeader();
				this.showPerson("tanika10.jpg");
				addPlaceTitle(md, tn + " In The Teacher's Lounge");
				md.write("<p>" +
					capitalize(mtn) + " stands, showing off her body for you.</p>")
			} else switch (clv) {
				case 1:
					md = WritePlaceHeader();
					this.showPerson("tanika12i.jpg");
					addPlaceTitle(md, tn + " In Your Bedroom");
					md.write("<p>Your teacher kneels on the bed, making herself available to give her student a test.</p>");
					break;
				case 2:
					md = WritePlaceHeader(false, "td-left-large");
					this.showPerson("tanika12h.jpg");
					addPlaceTitle(md, tn + " In Your Bedroom");
					md.write("<p>" + tn + " kneels on the bed, making herself available for her lover.</p>");
					break;
				case 3:
					md = WritePlaceHeader();
					this.showPerson("tanika12b.jpg");
					addPlaceTitle(md, tn + " In Your Bedroom");
					md.write("<p>" + tn + " kneels on the bed, making herself available for her " + perYou.getMaster() + ".</p>");
					break;
				case 4:
					md = WritePlaceHeader(false, "td-left-med");
					this.showPerson("tanika12g.jpg");
					addPlaceTitle(md, tn + " In Your Bedroom");
					md.write("<p>" + tn + " steps into the bathroom for a moment, and emerges partly bound with a gag and lies on the bed, making herself available for her " + perYou.getMaster() + ".</p>");
					break
			}
			startQuestions();
			if (clv < 3) {
				if (perYou.isMaleSex() || perYourBody.FindItem(45) > 0) addLinkToPlaceO(md, "fuck her", Place, "type=tanikafuck");
				if (!perYou.isMaleSex() || perYou.isMaleSex() && isExplicit()) addLinkToPlaceO(md, "ask her to " + (perYou.isMaleSex() ? "give you a blowjob" : "lick you"), Place, "type=tanikabj")
			} else if (clv == 4) {
				if (perYou.isMaleSex() || perYourBody.FindItem(45) > 0) addLinkToPlaceO(md, "fuck your slave", Place, "type=tanikafuck");
				if (!perYou.isMaleSex() || perYou.isMaleSex() && isExplicit()) addLinkToPlaceO(md,
					"Have your slave orally service you", Place, "type=tanikabj")
			} else {
				if (perYou.isMaleSex() || perYourBody.FindItem(45) > 0) addLinkToPlaceO(md, "fuck your toy", Place, "type=tanikafuck");
				if (!perYou.isMaleSex() || perYou.isMaleSex() && isExplicit()) addLinkToPlaceO(md, "use your fucktoy&apos;s mouth", Place, "type=tanikabj")
			}
			if (wherePerson("Tess") == 46 && !bSchool) {
				addLinkToPlace(md, "ask " + tn + " and Tess to work together for you", 170, "type=tesstanikathreesome");
				addLinkToPlace(md, "ask " + tn + " and Tess to play together", 170,
					"type=tanikatesssex")
			}
			if (clv == 2)
				if (bSchool && this.checkFlag(4)) addQuestionR(md, '"Why don\'t you visit me at home tonight?"', 'You suggest that Susan could visit your home again tonight, and she smiles. "I\'d love to, see you there tonight"</p>', "MrsTanika", "setPersonFlag(\\'MrsTanika\\',4,false)");
				else if (!bSchool && !this.checkFlag(4)) addQuestionR(md, '"Could you stop visiting at night for a while?"', "You apologies but ask that Susan stop visiting at night for a while, explaining that things are complicated and you may not be home often for a while. She is disappointed but agrees for now.</p>",
				"MrsTanika", "setPersonFlag(\\'MrsTanika\\',4)");
			if (!isDay() && !bSchool) {
				var mtn = clv == 3 ? "your toy, Mrs. Tanika" : clv == 2 ? tn : "your slave, Mrs. Tanika";
				addPopupLink(md, "take " + mtn + " to bed for the night", "Bedding " + tn, '<img src="Images/' + (clv == 3 ? "tanika14b" : "tanika14a") + '.jpg" style="position:absolute;width:100%;bottom:0" alt="Tanika"></p>' + '<p style="position:absolute;left:2%;top:2em;cursor:pointer;font-size:1.1em;width:50%">As you prepare to go to bed for the night you call ' + (clv == 2 ? " " : "your ") + mtn +
					" to join you. You are still surprised how sexy and passionate your once cold and distant teacher is.", true, "sleepForNight(46)", false, undefined, "background-color:#48250F;color:white;top:10%;left:5%;width:85%;height:80%;padding:0")
			}
			if (clv == 3) addLinkToPlaceO(md, "finish playing with your toy", Place);
			else if (clv == 4) addLinkToPlaceO(md, "finish talking to your slave", Place);
			else addLinkToPlaceO(md, "finish talking to Mrs. Tanika", Place);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "tanikafuck" || sType == "tanikabj") {
			clv =
				this.getCharmedLevel();
			if (sType == "tanikafuck") {
				if (perYou.isMaleSex()) {
					md = WritePlaceHeader(false, "td-left-large");
					this.showPersonRandomRorX("tanika8b", isExplicit() ? 3 : 1)
				} else {
					md = WritePlaceHeader(false, isExplicit() ? "td-left-med" : "td-left-large");
					his.showPersonRandomRorX("tanika8g", isExplicit() ? 4 : 2)
				}
				if (clv == 3) {
					addPlaceTitle(md, "Fucking your Fuck-Toy");
					if (perYou.isMaleSex()) md.write("You mount your fuck-toy, telling her how that now she is truly a cock-ornament and how great she looks. You then slap her ass and start to fuck her, concentrating on your own pleasure. As you are getting close to cumming, you feel your slut shudder in orgasm and that triggers your orgasm and cum hard into her pussy. As you pull out you tell her that she is a good cum-dump.</p>");
					else md.write("You put on your strap-on and mount your new fuck-toy. Mrs. Tanika is clearly inexperienced with this and you tell her that she will have to get used to this and pleasing you in other ways. You find the strap-on is pleasurable and as you near your orgasm you hear Mrs. Tanika cry out her orgasm. This triggers you orgasm and you orgasm hard. As you remove your strap-on you tell Mrs. Tanika that she is a good toy.</p>")
				} else if (clv == 4) {
					addPlaceTitle(md, "Your slave Mrs. Tanika");
					if (perYou.isMaleSex()) md.write("You mount your slave, and tell her how sexy she is. You then slap her ass and start to fuck her and she enthusiastically participates. She orgasms twice before you finally cum into her pussy. As you pull out you tell her that she is a good slave.");
					else md.write("You put on your strap-on and mount your new slave. Mrs. Tanika is clearly inexperienced with this and you tell her you will teach her everything she needs to know as a good slave. You both orgasm close to each other, Mrs. Tanika looking relieved and you tell her she is a good slave!</p>")
				} else {
					addPlaceTitle(md, "Fucking Mrs. Tanika");
					if (perYou.isMaleSex()) md.write("You move behind Mrs. Tanika and caress her ass, and tell her how sexy she is. You then slap her ass and start to fuck her and she enthusiastically participates. She orgasms twice before you finally cum into her pussy. As you pull out she raggedly tells you that she loves you.");
					else md.write("You put on your strap-on and move behind Mrs. Tanika and caress her ass. Mrs. Tanika is clearly inexperienced with this and you tell her you will teach her everything she needs to know. You both orgasm close to each other, Mrs. Tanika looking relieved and tells you that she loves you</p>")
				}
			} else {
				md = WritePlaceHeader(false, perYou.isMaleSex() || !isExplicit() ? "td-left-large" : "");
				this.showPersonRandomRorX(perYou.isMaleSex() ? "tanika9b" : "tanika9g", perYou.isMaleSex() ? isExplicit() ? 4 : 1 : 2);
				if (clv ==
					4) {
					addPlaceTitle(md, "Your slave Mrs. Tanika");
					if (perYou.isMaleSex()) md.write("You tell your slave to give you a blowjob! She kneels and gives you a surprisingly expert blowjob and you cum hard in her mouth. Without a word from you she swallows.</p>");
					else md.write("You tell her that she will now lick you to an orgasm. She kneels uncertain how to proceed and you sit down and give her instructions to service you. While she is inexperienced she has clearly received this sort of attention before and is able to bring you to a pleasant orgasm. You tell her she is a good slave and that you will teach her and do better in future.</p>")
				} else if (clv ==
					3) {
					addPlaceTitle(md, "Your slave Mrs. Tanika");
					if (perYou.isMaleSex()) md.write("You tell her she is a cum-dump, and a cock-sucker and to demonstrate! She kneels and gives you a surprisingly expert blowjob and you cum hard in the sluts mouth. You tell your fuck-toy to swallow, and she does.</p>");
					else md.write("You tell her she is a lesbian toy, and that she will now lick your to an orgasm. She kneels uncertain how to proceed and you sit down and give her instructions to service you. While she is inexperieced she has clearly received this sort of attention before and is able to bring you to a pleasant orgasm. You tell her she is a good fuck-toy and that she will have to learn and do better in future.</p>")
				} else {
					addPlaceTitle(md,
						"Mrs. Tanika's Oral Exam");
					if (perYou.isMaleSex()) md.write('You ask Mrs. Tanika to give you a blowjob and with a slight frown she says "Alright I suppose this once.." She kneels and gives you a surprisingly expert blowjob and you cum hard in her mouth. You look at your surprising skilled teacher and watch her swallow with pleasure.</p>');
					else md.write("You ask Mrs. Tanika to lick your pussy, and she looks a bit uncertain. She kneels and you sit down and give her some instructions. While she is inexperieced she has clearly received this sort of attention before and is able to bring you to a pleasant orgasm. You look at her and she is smiling a little awkwardly, not yet comfortable with this.</p>")
				}
			}
			startQuestions();
			if (clv == 3) {
				addLinkToPlaceO(md, "continue playing with your toy", Place, "type=tanikaxxx");
				addLinkToPlaceO(md, "finish playing with your toy", Place)
			} else if (clv == 4) {
				addLinkToPlaceO(md, "continue talking to your slave", Place, "type=tanikaxxx");
				addLinkToPlaceO(md, "finish talking to your slave", Place)
			} else {
				addLinkToPlaceO(md, "continue talking to Mrs. Tanika", Place, "type=tanikaxxx");
				addLinkToPlaceO(md, "finish talking to Mrs. Tanika", Place)
			}
			WritePlaceFooter(md);
			return true
		}
		if (sType == "tanikatesssex" && (Place ==
				170 || Place == 46)) {
			md = WritePlaceHeader();
			var sTanika = this.getPersonName();
			this.showPersonRandomRorX("tanikatess", 2);
			addPlaceTitle(md, "Tess and " + sTanika + " Playing Together");
			md.write("<p>You ask Tess and " + sTanika + ' to play with rach other for your pleasure. Tess looks a little uncertain, but responds "For you my love, anything".</p>' + "<p>" + sTanika + " is not very experienced at this and confesses to seldom having sex with a woman before, and Tess is even more reserved. After a little while they get more involved and bring each other to orgasm.</p>");
			startQuestions();
			addLinkToPlace(md, "return to your bedroom", 46);
			WritePlaceFooter(md);
			return true
		}
		return false
	};
	per.showPersonTextHere = function(md) {
		if (this.whereNow() == 46 && (sType == "tessplaymore" || sType == "anitabj" || sType == "anitafuck")) md.write("<p>Susan always looks like she is taking mental notes when you are with someone else. Your " + (this.getCharmedLevel() == 2 ? "lover" : this.getCharmedLevel() == 4 ? "slave" : "fucktoy") + " is rather attentive, though you are not sure if she intents to learn something herself or will give lessons to your other women later.</p>")
	};
	per.handleItem = function(no, cmd) {
		if (no == 14 && cmd == 2)
			if (Place == 242 && this.isHere()) {
				CastCharmSpell("MrsTanika", 400, 1);
				return "handled"
			}
		return ""
	}
}

function initialiseMrTanika() {
	addPerson("Mr. Tanika", 470);
	per.getPersonGender = function() {
		return "man"
	}
}

function RepliesMsJones(nR) {
	var myName = per.getYourNameFor();
	var sMaster = perYou.isMaleSex() ? "mon Ma\u00eetre" : "ma Ma\u00eetresse";
	if (nR == 1001) {
		setPersonOther("Anita", 101);
		addComments('"I am szorry, ' + myName + ". I have not zeen Zzhis 'Anita'. Why do you ask?\"<br>")
	}
	if (nR == 4600) addComments('"Magic stones? You should ask zee Monsier Beasley, he knows about zuch things."<br>');
	else if (nR == 1406) {
		setBeasleyServant(7);
		addComments('"I do not know. Monsieur Beasley is usually in school but sometimes he visits zee library. Perhaps you could try there."<br>')
	} else if (nR ==
		2E3) {
		per.other = 1;
		addComments('"I think it was after I was freed from my... third or fourth owner?\u201d She ponders. \u201cI realized that there was no escape from it, as I could not leave the area around the gate and those with magic would always be drawn to me. Not to mention that I had come to... quite enjoy the sensation of being charmed." She pulls in her lower lip briefly.</p>' + '<p>"So, I decided that if I am destined to always be someones slave, I may as well enjoy myself and devoted my very being to stand out of the crowd and be the best Slave I could be, picking up skills where I could when I was free and convincing many of my owners to train me further."</p>' +
			"<p>She focuses on you. \u201cI take pride in what I am and that I am good at it. I want to be the best servant I can be and help you be the best " + perYou.getMaster() + " you can be.\u201d</p>" + "<p>There is an unusually serious look in her charmed eyes, and you get a sense of noble determination from your slave, at least for a few seconds, before she suddenly starts to laugh playfully.</p>" + "<p>\"But please remember, I also want to provide you with sex, lots of it. It's been far too long and don't think I have nearly exhausted my repertoire by now, my " +
			perYou.getMaster() + '."')
	} else if (nR == 2001) {
		per.other = 2;
		addComments('"Do you like it, ' + sMaster + '?" She asks with a laughter. "Every few years, I need to come up with a new look and identity, so people don\'t grow suspicious about my eternal youth. This decenium, I have decided to be Emmanuelle F\u00e9licitas Jones from beautiful France, who had come to ' + (isBritish() ? "Angleterre" : "Am\u00e9rique") + " to work as a maid for a few years and ended up teaching French at Glenvalle Grammar.</p>" + '<p>"Still have the old uniform, by the way.\u201d She winks to you.')
	} else if (nR ==
		2002) {
		per.other = 3;
		addComments('\u201cI believe he has a huge ego, a larger sense of entitlement and a lot of newfound power, which is a dangerous combination." She explains in a serious tone. "He pretty much tried to charm me the day he found out about his magic powers, and when he realized I was somewhat claimed and thus protected at the time, he ran away in a  panic and has been avoiding me ever since."</p>' + '<p>"It is going to wreak havoc on his grades.\u201d She adds matter of factly, then looks at you with a smile.</p>' +
			'<p>"I am so very thankful that you claimed me before he or Beasley had a chance to undo my protection, my ' + perYou.getMaster() + ", I'd much rather be your little fucktoy then his.\"")
	} else if (nR == 2003) {
		per.other = 4;
		addComments('"He was the son of  wealthy family from abroad, my ' + perYou.getMaster() + '. A warlock with innate magical power similar to the Robins boy, maybe even related to the same bloodline.\u201d She seems hesitant to speak on, the memory clearly painful. \u201cI loved him, deeply, not only because of the charm. He radiated power and potential and I was determined to help him realize it, but he was also greedy and petty, always looking for more of everything, never willing to appreciate what he had and always ranting about \u201csomeone powerful\u201d guiding him to his destiny as the ruler of this town, no, the entire country!" She puts a mocking emphasis on the last bit.</p>' +
			'<p>"He even declared himself a divine being and formed a small cult around his person."')
	} else if (nR == 2004) {
		per.other = 5;
		addComments('"One of his enforcers and personal concubines, my ' + perYou.getMaster() + '." She says with pride, then chuckles bitterly. "And no, while plenty of drugs and orgies were part of his Cult, he \u201cdied\u201d when he attempted an old ritual he found the gods know where that heavily damaged his very soul but kept the tether binding me intact. He is comatose and his Parents have moved away to care for him, but I know he will never wake up again"')
	} else if (nR ==
		2005) {
		per.other = 6;
		addComments('"The ritual promised power to a greedy man who only surrounded himself with people who were magically compelled to encourage and adore him. Thanks to his Harem, he thought himself infallible, and it cost him dearly."</p>' + "<p>She looks deep into your eyes after finishing, and you can practically feel the strands of mana binding her shiver.</p>" + '<p>"Do not repeat his mistake, my ' + perYou.getMaster() + ', I would hate to loose you that way, too."</p>' + '<p>The shivering stops, and you see the happy, adoring expression return to her. "Or be bound to someone for a small eternity with no chance of having sex with him, that was seriously the worst."</p>')
	} else if (nR ==
		2100) {
		per.setFlag(6);
		addComments('"We had a brief affair shortly after she had joined the school staff. Did you know she was actually rather shy and timid back then?"</p>' + '<p>She smiles wistfully as she speaks. "It was nothing too serious, but I enjoy teaching, she had been very eager to learn and I would not mind to be allowed to reminisce with her about old times, now that she is practically part of the family."')
	} else if (nR == 2200) {
		per.setFlag(8);
		addComments("\u201cIt was actually not as bad as one might think, but she was constantly in my back, telling me to dress more proper, stop flirting, rebuke the advances of colleagues and students faster, not sit on the tables and generally be less.... me.\u201d</p>" +
			"She breathes out a sigh, then smiles to you. \u201cBut now that we have found common ground in our devotion to you, my " + perYou.getMaster() + ", we can both finally be as we are and leave our differences behind, maybe even get to know each other a little better.\u201d")
	} else if (nR == 3E3) {
		setPersonFlag("Ghost", 10);
		addComments("You ask Ms. Jones about ghosts and what keeps them tied to a particular place, and if they can move from that place,</p>" + '<p>"Well that is an odd question ' + perYou.getMaster() +
			' are you having problems with a spirit, they are almost always harmless, unless you are in a Place of Power. Or do you know a particularly cute one?"</p>' + '<p>She smiles a bit mischievously, "No don\'t tell me let me fantasise about it. But it is simple, as long as you have a magical tie to them. Either an item of personal importance or a magical binding or a link of other sort. If you do, take them by the hand, and lead them wherever you desire and keep them there until dawn. The following night they will be there again and will stay there. In some cases you may need to repeat, but mostly they will stay."')
	}
	return true
}

function initialiseMsJones() {
	addPerson("Ms. Jones", 0);
	per.Replies = RepliesMsJones;
	per.isPersonInfo = function() {
		return true
	};
	per.getPersonInfo = function() {
		if (!this.isCharmedBy()) return this.addPersonString("jones1a.jpg", "height:max%", "right") + "Ms. Jones has an office in one of the older parts of the school, and when you enter the room you see Ms. Jones sitting on her desk. It is strange how often you see Ms. Jones doing something...eccentric. It is not that she is a playful free-spirit, just that she is a little odd. Odd, but very sensual who borderline flirts with her students to get them to pay attention and work harder. Well something is certainly <i>harder</i> for her." +
			"<br><br>" + "The other distinct thing about her is her French accent, some would say outrageous and over the top, others cute and sensual. One time your friend Amy mentioned she had gone on a holiday to France with her family, and people there did not speak how Ms. Jones does. Then again there are many regional dialects and accents in France from what you have looked up." + "<br><br>" + "You wonder how easily you could learn French if she would be devoted to you. She could even give you private lessons and could tutor you. If her over attached and too playful character would not drive you mad of course because she can be a little bit annoying at times. It depends solely on what you want to do with her.";
		else return this.addPersonString("jones1c.jpg", "height:max%", "right") + "Ms Jones, formerly known to be an eccentric french teacher with an exaggerated accent, is now your devoted slave. An over 400 Year old slave, bound to something she calls \u201cthe gate\u201dand maintaining an extensive knowledge of History, Linguistics, Firearms, Martial Arts and the occult which is only eclipsed by her almost scary expertise with even the most obscure aspects of sexuality and her eagerness to apply it.<br><br>" +
			"You know the majority of people under your charm spell are barely able to keep their hands off you or even themselves for long most of the time when you are around, yet, Ms Jones now carries herself with a refined sense of purpose and discipline while still oozing barely constrained passion and desire just waiting to break through on your command.<br><br>" + "Over time, you have come to realize that despite being fully devoted to you and your needs, she has managed to never neglect her other duties, diligently tending to her classes and taking the time to keep her own skills sharp. She even insists on providing private lessons in actual French to you, despite your grades being pretty much safe now, and while most of them ether end or start with both of you naked on various furniture, you do find your grasp of the language vastly improving, as well as other skills.<br><br>" +
			"She had been claimed by several of the Witches and Warlocks drawn here by the gate in the past centuries, and you have begun to wonder if she will remember you as just another footnote in her long line of masters and mistresses, or something more."
	};
	per.getPersonName = function(full) {
		if (full === true) return this.name;
		return this.isCharmedBy() ? "Ms Jones, your Slave" : "Ms Jones, French Teacher"
	};
	per.whereNow = function() {
		if (!isDay()) return 0;
		if (Place == 143) return Place;
		return this.place
	};
	per.showEventPopup =
		function() {
			if (sType !== "") return false;
			if (Place == 242 && !this.checkFlag(11) && isShopOpen(2) && this.isHere()) {
				showPopupWindow("Ms Jones", "<img src='Images/jones14.jpg' class='imgpopup' alt='Jones'>" + "Miss Emanuelle-Felicitas Jones, your french teacher, has been using the teachers lounge for the last few weeks while her own office is undergoing renovations. She had one of the spare desks moved into the room, so it is no surprise that you find her sorting through her students homework as you enter it.</p>" +
					"<p>Ms Jones is a very sensual but also rather odd teacher, who borderline flirts with her students, both male and female, to get them to pay attention and work harder.</p>" + "<p>Her outfits are usually about as revealing as she is able to get away with as a teacher and you remember how a group of parents once tried to get her expelled for it.</p>" + "<p>She is always speaking in a thick, french accent somewhere between playfully sensual and outrageously over the top, and your friend Amy, who once spend a family vacation in France, claims no one there spoke the way Ms. Jones does. Then again, you know that there are many regional accents to be taken into account.</p>" +
					"<p>The students in your class love to come up with wild theories about her being a foreign spy, a stripper trying to turn over a new leaf or even an undercover cop, but there is one thing they all agree on: She has an amazing body.</p>" + "<p>You have often fantasized about what it would be like get \u201cprivate lessons\u201d from her, and now that you have learned the Dai Chu, it is hard to resist the temptation to make these fantasies come true.");
				this.setFlag(11);
				return true
			}
			if (isShopOpen(2) &&
				!this.checkFlag(2) && Place == 145 && this.isHere()) {
				this.setFlag(2);
				if (!this.checkFlag(11)) this.showPersonInfo(mdCache);
				else showPopupWindow("Ms Jones", "<img src='Images/jones14.jpg' class='imgpopup' alt='Jones'>" + "You find Ms. Jones in her office in one of the older parts of the school, and when you enter the room you see her sitting on her desk.</p>" + "<p>It is strange how often you see that woman doing something...eccentric. It is not that she is a playful free-spirit, just that she is a little odd.</p>" +
					"<p>At least she is one of the very few teachers who is always happy to meet her students, even after classes, and she welcomes you with a warm smile, asking if you need any help in her usual over the top accent.");
				return true
			}
			if (Place == 145 && !this.checkFlag(5) && this.hoursCharmed() > 8 && isCharmedBy("MissLogan") && this.isHere()) {
				showPopupWindow("Ms Jones knows...", "<img src='Images/jones1a.jpg' style='width:30%;float:right;margin-left:5px' alt='Ms. Jones'>" + "\u201c" + perYou.getMaster() + "!\u201d As per usual, Ms. Jones falls onto one knee and lowers her head the moment you enter her classroom.</p>" +
					"<p>\u201cI trust Miss Logan is still expertly skilled in the art of " + (perYou.isMaleSex() ? "sucking cocks" : "licking pussies") + "?\u201d</p>" + "<p>You are a little taken aback by the directness of her question, but have to admit to her that she, coarse language aside, is indeed correct about her assumption.</p>" + "<p>\u201cWonderful! I assure you that she will be one of your most delightful playthings, and if you are so inclined....\u201d She looks up to you with a cheeky wink.\u201dYou may always thank me later.\u201d</p>");
				this.setFlag(5);
				this.extra[0] = nTime;
				return true
			}
			if (Place == 145 && !this.checkFlag(7) && this.hoursCharmed() > 8 && isCharmedBy("MrsTanika") && this.isHere()) {
				showPopupWindow("Ms Jones knows...", "<img src='Images/jones4a.jpg' style='width:30%;float:right;margin: 0px 0px 0px 5px' alt='Jones'>" + "Ms Jones looks excited as you enter her classroom, cheerfully following her usual ritual and getting down on one knee to greet you.<br><br>" + "\u201cI have noticed you have taken Susan into the fold, a marvelous decision, my " +
					perYou.getMaster() + ".\u201d<br><br>" + "You caress her cheek, telling her how you are glad that she approves, but ask why it gets her so exited. A question your slave happily answers:<br><br>" + "\u201cShe is -much- easier to work with now.\u201d She kisses your hand and rises to her feet. \u201cShe always had such a huge stick up that sexy ass of hers and definitely needed a little bit of attitude adjustment. In Fact...\u201d She smashes her ruler into the palm of her hand with a wide grin. \u201cIf you allow me, I would -love- to help you with that. There is -much- I could teach her and I bet she has no idea how to properly use that barbed tongue of hers.\u201d");
				this.setFlag(7);
				return false
			}
		};
	per.showEvent = function() {
		var md;
		var clv;
		var perLeanne;
		if (sType == "msjonespool") {
			WaitHereOnly(6);
			md = WritePlaceHeader();
			this.showPerson("jones-pool.jpg");
			addPlaceTitle(md, "Swimming with Ms. Jones");
			md.write("<p>Ms. Jones arrives and changes into her bikini, ready to serve you in any way you wish!</p>");
			startQuestions();
			addLinkToPlaceC(md, "she is certainly willing to do more..", Place, "type=msjonespoolsex");
			addLinkToPlaceC(md, "say goodbye to Ms. Jones", Place);
			WritePlaceFooter(md);
			return true
		}
		if (Place == 269 && sType == "msjonespoolsex") {
			md = WritePlaceHeader(false, "td-left-large");
			this.showPerson("jones-pool-sex.jpg");
			addPlaceTitle(md, "Being Discrete and Private with Ms. Jones");
			md.write("<p>You ask your teacher to play with you more privately, and she seductively removes most of her swimsuit and lies back waiting for you.</p>");
			startQuestions();
			addLinkToPlaceC(md, "later...say goodbye to Ms. Jones", Place);
			WritePlaceFooter(md);
			return true
		}
		if (Place == 145 && this.checkFlag(3) && !this.checkFlag(4)) {
			this.setFlag(4);
			md = WritePlaceHeader();
			var perV = findPerson("Vampyre");
			this.showPerson("jones11.jpg");
			if (perV.isHere()) {
				addPlaceTitle(md, "Ms. Jones and the Vampyre");
				perV.showPerson("vamp11b.jpg", "25%", "right");
				md.write("<p>You walk into the classroom, silently followed by the vampyre. You almost feel it as the vampyre suddenly moves to one side. The as you look to see what is happening you see Ms. Jones leap to her feet holding a ruler as a weapon, as a wooden stake!</p>" + "<p>The vampyre looks ready to attack, and the way Ms. Jones looks you would say she is perfectly ready and able to defend herself! You have to stop whatever is happening and call out,</p>" +
					'<p>"Stop this now!", but for a long moment nothing happens, and then the vampyre steps to your side. Ms. Jones sits on her desk, but you can see both seem to be ready to attack or defend at a moments notice, so it is more a cease fire than a truce. You demand Ms. Jones explain,</p>' + '<p>"Yes ' + perYou.getMaster() + ', I felt the gate open, the one the demon created all those years ago that I...witnessed. Things passed though and the power of the gate would have revived others. I wanted to warn you to avoid places of power like the Sacred Clearing as those creatures will be drawn there, but I see you have found one of those beings. Is it under your control?..."</p>' +
					'<p>The vampyre interrupts, "Demon Bitch! I am controlled by no-one, this ' + perYou.getWitch() + ' is my plaything, they think I am under their spell...What are you still doing here, I slew you 300 years ago"</p>' + "<p>Ms. Jones looks at you, \"This thing does not have the power to slay me, and like all of it's kind lies whenever it speaks. It is a powerful slave for you " + perYou.getMaster() + ' take care not to feed it too much or it may overcome your <b>control</b>!"</p>' + "</p>You decide you had better separate these two as quickly as possible. You had forgotten how Ms. Jones has described how she was a warrior in the past, and this has shown she is very capable in that way. You thank her for her warning, but as you do you see the venomous gaze of the vampyre on her, and</p>");
				startQuestions();
				addLinkToPlaceO(md, "chastise Ms. Jones, the vampyre is a 'she' and a powerful ally", 70, "", "Ms. Jones apologises and says she will call the thing a she in future. The vampyre almost hisses, but follows you out of the classroom, with a slight smile on her lips", "", "setPersonOther('Vampyre',getPersonOther('Vampyre',1) + 1, 1)");
				addLinkToPlaceO(md, "order the vampyre to never attack without your command", 70, "", "The vampyre says nothing as she follows you out of the classroom, you think a sign she has agreed.",
					"", "setPersonOther('Vampyre',getPersonOther('Vampyre',1) + 5, 1)")
			} else {
				addPlaceTitle(md, "Ms. Jones on the Vampyre");
				md.write("<p>Ms. Jones is waiting for you in the classroom, uncharacteristically serious looking. You ask what she wanted to talk to you about,</p>" + "<p>" + perYou.getMaster() + ', I felt the gate open, the one the demon created all those years ago that was in my body. Things passed though and the power of the gate would have revived others. I wanted to warn you to avoid places of power like the Sacred Clearing as those creatures will be drawn there. Take care some creatures will of wakened from long slumbers and be a threat to you."</p>' +
					"<p>You consider mentioning the vampyre to her, but reconsider, it is just an odd feeling you are getting from her. She continues,</p>" + '<p>"' + perYou.getMaster() + ' I have been extensively trained in the ways of a warrior, my body is trained for more than sex, I keep fit for combat as well as love. If you need protection call upon me at any time!"</p>' + "<p>You remember how she had mentioned about being a warrior previously when you first charmed her, and thank her for her warnings and offer of protection.</p>");
				startQuestions();
				if (isPlaceKnown("AnitasLair")) addLinkToPlace(md, "visit Anita's hiding place", 252);
				addLinkToPlace(md, "exit the office", 70)
			}
			WritePlaceFooter(md);
			return true
		} else if (sType == "askleanne") {
			perLeanne = findPerson("Leanne");
			clv = this.getCharmedLevel();
			md = WritePlaceHeader();
			if (clv > 0) this.showPerson("jones10b.jpg");
			else this.showPerson("jones10a.jpg");
			addPlaceTitle(md, perLeanne.checkFlag(9) ? "Asking the High Priestess" : "Asking Ms. Jones");
			md.write("<p>You ask Ms. Jones about demons and the nature of how they enslave people.");
			if (perLeanne.checkFlag(9)) md.write(" As you do you are struck by the similarity of the image on the tarot card Esmeralda showed you and Ms. Jones.");
			md.write("</p>");
			if (clv > 0) {
				md.write("<p>Your beautiful slave stands and looks thoughtful and then she seductively strips off her clothing, making a show for you. At the end she takes a book off a shelf and opens it and sits down, resting her full breasts on it. She looks at you");
				if (perLeanne.checkFlag(9)) md.write(" and again you are struck by the similarity as she has raised one hand like you saw in the image on the card. Your thought is interrupted");
				md.write(',</p><p>"Of course, I remember well the ways of the demon that possessed me, and rituals both obscene and mundane. What you seek is complex, first you must ensure the demon who did this is gone, bound or exorcised."</p>');
				if (isDemonInTown()) md.write("<p>You tell her the demon is still loose, and she looks at you sadly,</p>" + '<p>"Then there is little you can do, if you try the demon will reassert their control and you will lose them again. You will also need the person\'s soul, preferably along with the soul of the demon. Be warned about trying to bargain with the demon for it, they will ask a steep price."</p>' +
					"<p>You tell her you will return once you have dealt with the demon</p>");
				else {
					perLeanne.setFlag(8);
					if (isDemonGone()) md.write("<p>You tell her the demon is gone, fled from the town, and she looks at you sadly,</p>" + '<p>"Then all is lost, the soul you seek is lost with the demon, your friend is no more."</p>' + "<p>This terrible news strike you hard, and you tell Ms. Jones about Leanne and how she has become a demonic thrall and being held at the Church pending the arrival of an exorcist. Ms. Jones looks almost disgusted,</p>" +
						'<p>"I once encountered an exorcist, it was..unpleasant...There is nothing they can do for what was your friend, and very likely any exorcism will harm what remains of your friend."</p>' + "<p>You think it may be best to just free Leanne...that is the thrall...but keep her under control in some way.</p>");
					else {
						md.write("<p>You tell her the demon is bound into the relic and show her the item, she does not touch it and tells you,</p>" + "<p>\"The it is possible to save them, you will need some items, a 'Mirror of the Soul' and a powerful source of magic power, say the legendary 'Dragon Gem', that is bound to the place of power. I suggest you check the place using your magic.</p>" +
							'<p>When you have these all there, bring the thrall, and perform a ritual I will teach you, it will free their soul and return it to their body. This must be done at midnight"</p>' + "<p>She then teaches you a simple ritual, called the 'Ritual of Return' and then asks,</p>" + '<p>"' + perYou.getMaster() + ", please reward me now with your " + (perYou.isMaleSex() ? "cock" : "body") + '?"</p>');
						if (whereItem(35) == 279 && per.checkFlag(8)) {
							setPersonFlag("Abby", 7);
							setPersonFlag("Abby", 8, false)
						}
					}
				}
			} else {
				perLeanne.setFlag(8);
				md.write("<p>Ms. Jones stands and takes a seat on her desk, and her skirt rides up, exposing her green panties. She must not of noticed as she makes no effort to cover up and you are not about to correct her. She tells you,</p>" + '<p>"' + perYou.getPersonName() + ' why would moi know anything about zis. I cannot tell ze anthing about zis"</p>' + "<p>You get an odd feeling, like she is deliberately trying to distract you with her show of panties, but she will not answer anything more, just repeating how she cannot say anything.</p>")
			}
			startQuestions();
			if (isPlaceKnown("AnitasLair")) addLinkToPlace(md, clv > 0 ? "visit Anita's hiding place" : "sneak back into Anita's hiding place", 252);
			addLinkToPlace(md, "exit the office", 70);
			WritePlaceFooter(md);
			return true
		} else if (sType.substr(0, 5) == "jones") {
			if (sType == "jones5a" || sType == "jones5b") {
				md = WritePlaceHeader(false, !isExplicit() ? "" : !perYou.isMaleSex() ? "td-left-large" : "");
				if (isExplicit())
					if (perYou.isMaleSex()) this.showPersonRandomX("jones6", 3);
					else this.showPersonRandomX("jones9", 2);
				else this.showPerson("jones5.jpg")
			} else {
				md =
					WritePlaceHeader(false, sType == "jones3" ? "td-left-large" : "");
				this.showPerson(sType + ".jpg")
			}
			addPlaceTitle(md, "Ms. Jones Under a Charm Spell");
			var wt = perYou.isMaleSex() ? "Sorcier" : "Sorci\u00e8re";
			var fm = perYou.isMaleSex() ? "mon Ma\u00eetre" : "ma Ma\u00eetresse";
			if (sType === "jones2") {
				perLeanne = findPerson("Leanne");
				perLeanne.setFlag(8, false);
				md.write("<p>You can feel the mana entering your teachers body as you recite the spell, and yet, Ms. Jones reacts very little, at least her expression and voice do not. What she does do, however, is immediately open her blouse to expose her breasts and as she speaks to you, you notice her accent is much less noticeable than it was before.</p>" +
					'<p>"Oui ' + perYou.getMaster() + ", You 'ave no idea 'ow <i>grand</i> zis feels... how do you want me?\"</p>" + "<p>You are surprised at her immediate submission and ask what made her accept you as her " + perYou.getMaster() + " so fast. She looks at you with a smile as she answers,</p>" + '<p>"Of course I accept you as ' + fm + ", a " + wt + ' like you \'as to be." She seems to be incredibly enthusiastic about the prospect. "I \'ave been ze servant, toy, warrior, cock-ornament, pussy-slave to many over the decades"</p>' +
					'<p>You look at her quizzically as your brain begins to reboot, all you can think is "what?"</p>');
				startQuestionsOnly();
				addLinkToPlaceC(md, 'ask her to elaborate on "over the decades"', 145, "type=jones3")
			} else if (sType === "jones3") {
				md.write("<p>Ms. Jones looks in her late 30's so her talk of many masters over the decades is kind of confusing to you. You ask her to explain, and as she does, her accent is almost completely gone,</p>" + '<p>"Oui, a Sorci\u00e8re such as you first bound me to them four hundred years ago, and after using my Body, they performed a terrible ritual to let a demon take over my heart and mind. After years of debauchery, death and defilement, the demon did it\'s own ritual, with more blood and death than you can imagine."</p>' +
					"<p>It is likely the effect of the spell as it is steadily taking hold in her mind, but her voice is far more sensual then it seems appropriate for such a story. She, however, clearly does not seem to mind as she continues.</p>" + '<p>"A gate had formed, a passage to hell itself and the same one Kurndorf would use a long time later. I was freed, but my body was somehow bound to the gate, unable to travel far from it, and from then on, also unchanged by the passing years."</p>' + "<p>The spell seems to have finally taken a full hold over her mind and her voice grows almost orgasmic during the last words, after which she looks at you with blissful devotion. You see the familiar pink sheen in her eyes while her hands trail over her full breasts as if she is testing something and very satisfied with the results.</p>" +
					'<p>"Since then my link to the gate has made me attractive to many witches and warlocks and I have been bound to them time after time just as I am bound to you now."</p>' + "<p>It was a very thorough explanation and pretty much has left you stunned, staring at her and not sure if you should believe her. She is definitely under the power of the spell, though, and as you order her to tell you the truth, and she simply replies by squeezing her breasts together.</p>" + '<p>"I swear upon my heart and soul that I tell the truth."</p>' +
					"<p>As she says this you feel a surge of mana flow into you.</p>");
				AddMana(5);
				startQuestionsOnly();
				addLinkToPlaceC(md, "ask her what she will do now", 145, "type=jones4")
			} else if (sType === "jones4") {
				md.write("<p>These revelations have been rather confusing and you need some time for your mind to take all that in. Finally, you ask her what she will do now, and Ms. Jones gestures quite clearly, as she explains:</p>" + '<p>"The spell has fully taken hold, and I am now your slave for as long as you want. This is usually the moment where I am ordered by mon ' +
					wt + ' to show my great and long experience as a sexual plaything."</p>' + "<p>You blink a few times, then ask her if she really doesn't want something more than just being a sex toy for Sorci\u00e8re after Sorci\u00e8re, but she simply smiles while unbuttoning the rest of her top.</p>" + '<p>"One time I did, but one of these does not exclude the other. Zere is a joy in serving, and even more in sex, and I have had <i>so</i> much sex!"</p>' + "<p>Well, you find it hard to refuse such an offer...</p>");
				startQuestionsOnly();
				addLinkToPlaceC(md, "order her to prove her experience", 145, "type=jones4a")
			} else if (sType === "jones4a") {
				md.write("<p>Ms. Jones has apparently been eagerly waiting for you to do this ever since the moment you had placed her under your spell, and before you were even able to finish speaking, you find yourself pinned onto one of the classes tables by your teachers warm body.</p>" + '<p>"Je ferai tout pour vous, ' + fm + ' ." She breathes into your ear in a seductive tone, sensual enough to send shivers through your entire body as you feel her fingers tenderly caressing your skin, sliding under your clothes to remove them piece by piece.</p>' +
					'<p>"Hmmm... aah..." You try to say something, but her lips silence you with a deep, intoxicating kiss, the sheer skill of her tongue leaving you breathless. \u201cRester immobile et amusez-vous. Just lay still, and enjoy yourself, ' + perYou.getMaster() + '." She whispers to you with a playful wink, pushing your hands out of the way to the side of the table before she teasingly drives her fingernails along your bare arms and shoulders.</p>');
				startQuestionsOnly();
				addLinkToPlaceO(md, "let yourself fall back and allow her to take charge",
					145, "type=jones5a")
			} else if (sType === "jones5a") {
				if (perYou.isMaleSex()) md.write("<p>You let your head sink back with a soft sigh, barely noticing her casting off the already opened blazer and the rest of her underwear.</p>" + "<p>What you do notice, however, are her full breasts coming to rest on top of growing erection and her fingers caressing your stomach, sliding up to trace your collarbones and shoulders while she places a kiss on top of your navel.</p>" + "<p>You notice her lips further exploring your body, placing soft kisses all over your skin as she whispers sweetly in french, her voice even more lascivious then you ever heard her in class, and even though you do not understand everything she says, the sensual timbre is making your heart beat faster all the same.</p>" +
					"<p>Finally, you definitely notice her hand on your by now throbbing manhood, expertly driving her fingers along your veins while her body moves back down, her tongue licking some precum from the tip with a delightful hum before her lips finally close around it. It takes her only a few moments until you let out a loud growl of pleasure, her fingers, lips and tongue working in unison to stimulate your manhood with well practiced motions until your body rushes into a powerful climax, leaving you desperately holding on to the sides of the small table, gasping for air.</p>");
				else md.write("<p>You let your head sink back with a soft sigh, barely noticing her casting off the already opened blazer and the rest of her underwear.</p>" + "<p>What you do notice, however, is her leg pushing forward to part your tights and her fingers tracing your shoulders and collarbones, cupping your breasts and caressing your stomach.</p>" + "<p>You notice her lips exploring your body, placing soft kisses all over your skin as she whispers sweetly in french, her voice even more lascivious then you ever heard her in class, and even though you do not understand everything she says, the sensual timbre is making your heart beat faster all the same.</p>" +
					"<p>Finally, you definitely notice her fingers parting your folds, diving deep into your already soaked sex and carefully exploring your most sensitive parts. It takes her only a few moments until you scream in pleasure, her fingertips expertly finding your most receptive areas, stimulating them with well practiced motions until your body rushes into a powerful climax, leaving you desperately holding on to the sides of the small table, gasping for air.</p>");
				startQuestionsOnly();
				addLinkToPlaceO(md,
					"okay, you admit she is good...", 145, "type=jones5b")
			} else if (sType === "jones5b") {
				if (perYou.isMaleSex()) md.write("<p>\"And we 'ave only just begun, mon Ma\u00eetre.\" You see her lips closing in, and once again, find any form of potential protest muffled by another sensual kiss as your teacher drags you off the table onto the ground. Within the next hour, you are touched and kissed in places of which you didn't even know how receptive to these sensations they were, a woman with literally centuries of experience playing your body like a fiddle, making you even forget who is supposed to be in charge as she expertly carries you from one orgasm to the next and putts even your, ever since you picked up the book rather impressive, stamina to the test.</p>" +
					"<p>Finally, you both collapse on top of each other, both your bodies still trembling from her last climax while she pulls you into a last, deep kiss, tired, but very satisfied.</p>" + '<p>"Well?" She asks with an exhausted smile on her face, Her accent completely gone as she coos into your arms "Do you believe me now, my Master?"</p>' + "<p>You nod silently, wrapping your arms around your new pets wonderful body to hold her close. You have to admit: You are a believer.</p>");
				else md.write("<p>\"And we 'ave only just begun, ma ma\u00eetresse.\" You see her lips closing in, and once again, find any form of potential protest muffled by another sensual kiss as your teacher drags you off the table onto the ground. Within the next hour, you are touched and kissed in places of which you didn't even know how receptive to these sensations they were, a woman with literally centuries of experience playing your body like a fiddle, making you even forget who is supposed to be in charge as she expertly carries you from one orgasm to the next.</p>" +
					"<p>Finally, you both collapse on your backs, chests heaving slowly with every breather and your legs intertwined, dripping folds rubbing against each other as the last climax curses through  your bodies, leaving the two of you exhausted, but very satisfied.</p>" + '<p>"Well?" She asks with an tired smile on her face, Her accent completely gone as she crawls into your arms "Do you believe me now, my Mistress?"</p>' + "<p>You nod silently, wrapping your arms around your new pets wonderful body and have to admit: You are a believer.</p>");
				startQuestionsOnly();
				if (isPlaceKnown("AnitasLair")) addLinkToPlace(md, "visit Anita's hiding place", 252);
				addLinkToPlace(md, "exit the office", 70)
			}
			WritePlaceFooter(md);
			return true
		}
		return false
	};
	per.showPersonChat = function(bGeneral, md) {
		if (Place != 242 || !this.isHere() || sType !== "") return;
		if (!this.checkFlag(12)) addQuestionR(md, "Say hello to Ms. Jones", "\u201cAh, bonjour, " + (perYou.isBornMale() ? "Monsieur" : "Mademoiselle") + " " + perYou.getPersonName() + ".\u201d She looks up from her papers with an inviting smile.\u201d Iz zere somezing I can 'elp you wiz?\u201d",
			"MsJones", "setPersonFlag(\\'MsJones\\',12)");
		else {
			if (!this.checkFlag(13)) addQuestionR(md, "Ask about her Office", "\u201cThe artisan says it should be ready soon, but I enjoy it 'ere.\u201c</p>" + "<p>\u201cYou are more likely to meet ze students and have a conversation during work and I 'ope they will still occasionally visit moi office.\u201d", "MsJones", "setPersonFlag(\\'MsJones\\',13)");
			if (!this.checkFlag(14)) addQuestionR(md, "Ask her where you stand in her class", "\u201cYou are a better student zan your grades imply, " +
				perYou.getPersonName() + ",  but I am sure you know that you will need to focus if you wish to make it through the year.\u201d</p>" + "<p>She leans forward and invitingly presents her neckline to you.<p>" + "<p>\u201cI would be saddened to lose a smart student like you early. You 'ave potential many others do not, but you will 'ave to... 'ow do zey say it... grap it.\u201d", "MsJones", "setPersonFlag(\\'MsJones\\',14)");
			if (!this.checkFlag(15)) addQuestionR(md, "Ask if she knows anything about magic", "\u201cLa magie?\u201d She sits back and just happens to roll her shoulders back in a way that pushes her breasts forward. \u201cAh, Je suis d\u00e9sol\u00e9, I am sorry " +
				perYou.getPersonName() + " But I am not able to tell you anything about zese topics.\u201d", "MsJones", "setPersonFlag(\\'MsJones\\',15)")
		}
	};
	per.handleItem = function(no, cmd) {
		if (no == 14 && cmd == 2)
			if (Place == 242 && this.isHere())
				if (nMana < (perYou.checkFlag(17) ? 9 : 10)) {
					addComments("You do not have enough mana to cast the spell.");
					return "handled"
				} else {
					addComments("You collect the mana, speak the words, and you are absolutely certain you did everything right... and yet, the spell failed. Is she protected somehow... or did someone else already put a spell on her?</p>" +
						"<p>Ms Jones looks surprised for about a second, regards you curiously, and then smiles.</p>" + "<p>\u201c\u00c0 tes souhaits, " + perYou.getPersonName() + ". Don't catch a cold.\u201d");
					this.setFlag(16);
					this.setFlag(17);
					return "refresh"
				}
		else {
			if (Place == 145 && this.isHere()) {
				if (!this.isCharmed() && this.checkFlag(1)) CastCharmSpell("MsJones", 145, 1, "type=jones2");
				else if (!this.isCharmed() && !this.checkFlag(1)) addComments("You read the spell.... but it nothing happens, she must already be under the effects of a charm spell.");
				else return "";
				return "handled"
			}
		} else if (no == 32 && cmd == 2)
			if (Place == 145 && this.isHere() && !this.isCharmedBy() && !this.checkFlag(1)) {
				useSilverRingStart();
				addComments("<p>You clasp the ring with your fist. It glows and, within moments, it absorbs the mana powering the <i>charm</i> over Ms Jones.</p>" + "<p>She looks momentarily confused, and then smiles. You are surprised at how little she reacts.</p>" + "</td></tr></table>");
				this.setFlag(1);
				AddMana(5);
				return "refresh"
			}
		return ""
	};
	per.isPhoneable = function() {
		return checkPlaceFlag("Hotel",
			11) && Place == 269 && this.isCharmedBy("You")
	};
	per.callThem = function() {
		if (Place == 269) {
			gotoPlace(Place, "type=msjonespool");
			receiveCall("", "You call your teacher and slave Ms. Jones to invite her to join you at the pool for a swim, and she immediately answers that she will be there soon");
			WriteCommentsFooter(bChat, bChatLeft)
		}
	};
	per.addPersonPhoneCall = function() {
		if (!this.isCharmedBy()) return false;
		if (!this.checkFlag(3) && nTime % 288 > 239 && isCharmedBy("Vampyre", "You")) {
			if (makeCall(true, 40)) this.setFlag(3)
		} else if (this.checkFlag(5) &&
			!this.checkFlag(9) && (nTime - this.extra[0]) / 12 > 12 && getHour() < 10) {
			if (makeCall(true, 41)) {
				this.setFlag(9);
				this.extra[0] = nTime
			}
		} else if (this.checkFlag(9) && !this.checkFlag(10) && nTime - this.extra[0] > 4)
			if (makeCall(true, 42)) this.setFlag(10);
		return false
	};
	per.getPersonSMS = function(id) {
		switch (id) {
			case 40:
				return receiveSMS("frenchisfun", "The gate opened, please visit me at the school, tonight", "jonessms1.jpg");
			case 41:
				return receiveSMS("frenchisfun", "Ms Logan and I are getting ready for classes and we hope to see you there. (You still have some catching up to do, but If you are busy I will compile everything you need to know for later.)",
					"jonessms2.jpg") + receiveSMS("frenchisfun", "PS: Thank you so much again for charming her, my " + perYou.getMaster() + ", class breaks have been so much more enjoyable. &#94;_&#94; ");
			case 42:
				return receiveSMS("FascinatingAnatomy", "Both Ms. Jones and me are always ready for private tutoring, of course. You don't have to worry about your grades, but that does not mean you shouldn't strife to improve yourself!", "logansms1.jpg")
		}
		return ""
	}
}

function RepliesMsTitus(nR) {
	var bCharm = per.isCharmedBy() || per.isFreeSlave();
	var myName = per.getYourNameFor();
	bChatLeft = Place != 3 || !per.isFreeSlave();
	var ret = true;
	if (nR == 100) {
		per.setFlag(10);
		addComments('"Tess called in sick today, she will be staying home", you ');
		if (bCharm) {
			addComments('ask where that is and your slave tells you their address "2121 Rathdown Rd, Glenvale"');
			setPlaceKnown("AdamsHouse")
		} else addComments("consider asking for her address but you know there is no chance Ms. Titus will give you the address.")
	} else if (nR ==
		181) {
		per.other = 2;
		if (Math.random() < .5) addComments('"That book is from just a legend, try looking for tales about it in the fiction section. A web-search should find references to novels featuring it."');
		else addComments('"I believe that you are looking for the fiction section. Look it up by the author\'s name."')
	} else if (nR == 171) {
		setPlaceFlag("Library", 2);
		addComments('"Whatever you say, ' + myName + ". I'll lock the door so that only you can come and go.\"")
	} else if (nR == 172) {
		bChat = false;
		addComments("You take the scroll. It reads something about a possession spell.");
		if (!isRunes()) setQueryParams("type=learnpossession");
		else {
			Research("Spell", "UnstrHun");
			ret = false
		}
	} else if (nR == 173) {
		per.setFlag(6);
		per.other = 10;
		addComments('<p>Ms Titus explains, "I studied early settlements, ' + myName + ".  Did you know that this town has a lot of vague history? I wanted to find out more about what happened to the first settlers of Glenvale.  Do you know, " + myName + '?"</p><p>You remember reading something about early settlers in History class.</p>')
	} else if (nR == 174) {
		setPlaceFlag("Library",
			2, false);
		addComments('"Whatever you say, ' + myName + ". I'll re-open the library for general use.\"")
	} else if (nR == 200) {
		per.other = 4;
		if (!bCharm) addComments('<img src="UI/books/citadelbook.jpg" style="width:20%;float:right;margin-left:5px;margin-bottom:1em" alt="Citadel">An exciting book, "\'Citadel of Servitude\' by Aran Ashe", she answers with a glint in her eyes as she shows you the cover.</p><p>You have never heard of the book, it sounds like some sort of fantasy novel, and you more prefer the reality of magic and Kurndorf\'s book. You say something non-committal and she just smiles and returns to reading.');
		else addComments('<img src="UI/books/citadelbook.jpg" style="width:20%;float:right;margin-left:5px;margin-bottom:1em" alt="Citadel">An exciting book, "\'Citadel of Servitude\' by Aran Ashe, a lovely tale of bondage and slavery", she answers with a glint in her eyes as she shows you the cover.')
	} else if (nR == 1811) {
		per.other = 12;
		if (!isPlaceKnown("SacredClearing")) setPlaceKnown("SacredClearing");
		addComments('<p>"They were buried at the sacred clearing!" exclaims Ms Titus "Amazing, that is right beside the Gates Mansion."</p>')
	} else if (nR ==
		1101) {
		if (perDavy.getPathHellgate() == 1) perDavy.setPathHellgate(4);
		if (!bCharm) addComments('"Davy Robbins?," she replies, annoyed at the interruption. "Let me check our database registry. Oh yes, he came in to use the computer today."');
		else addComments('"Davy Robbins?," she replies. "Yes ' + myName + ', he was in earlier asking for help using the computers today."')
	} else if (nR == 1104) {
		if (perDavy.getPathHellgate() == 4) perDavy.setPathHellgate(5);
		movePerson("Monique", 53);
		if (!bCharm) addComments("<p>Ms. Titus replies, \"I don't know what Davy used it for " +
			perYou.getMaster() + '. Find Monique. She knows how to use the computer."</p>');
		else addComments("<p>Ms. Titus looks upset and begins to apologize.  \"I'm sorry, " + myName + " I don't know, and I don't know how to find out either.\"  She seems very upset with herself, then suddenly perks up.  \"I know " + myName + '! Perhaps you could convince Monique to help. She knows how to use computers much better than I."</p>')
	} else if (nR == 2E3) {
		setPlaceKnown("MsTitussHouse");
		addComments('<p>Ms. Titus answers, "Of course, ' +
			myName + ', it is 2628 Rathdown Rd. Please visit me anytime after the Library closes."</p>')
	}
	return ret
}

function initialiseTitus() {
	addPerson("Ms. Titus", 3);
	per.Replies = RepliesMsTitus;
	per.getPersonAddress = function() {
		return isPlaceKnown("MsTitussHouse") ? "2628 Rathdown Rd, Glenvale" : ""
	};
	per.isFreeSlave = function() {
		return this.checkFlag(8)
	};
	per.getYourNameFor = function() {
		if (this.isFreeSlave()) return perYou.getMaster();
		if (!this.isCharmedBy()) return perYou.getPersonName();
		return perYou.getMaster()
	};
	per.getPersonName = function(full) {
		if (full !== true && this.isFreeSlave()) return "Your slave, " + this.name;
		return this.name
	};
	per.isPersonInfo = function() {
		return true
	};
	per.getPersonInfo = function() {
		if (this.isFreeSlave()) return "<img src='Images/titus12.jpg' class='imgpopup' alt='Ms Titus'>" + "Ms. Titus has willing become your slave, she loves domination and submission. She has moved to a dark areas at the end of a row of book-shelves so she can be tied up as your slave.";
		else if (!this.isCharmedBy()) return "<img src='Images/titus8.jpg' class='imgpopup' alt='Ms Titus'>" + "Ms. Titus runs the main desk of the library, but you know little more about her, she is very business-like and tolerates no chit-chat." +
			"<br><br>" + "Your eyes are always drawn to the most obvious thing about her, her large cleavage, but you know Ms. Titus does not respond well to any sort of flirtation. Still you have daydreamed about her cleavage and what you would do if you got your hands on it.";
		else return "<img src='Images/titus2b.jpg' class='imgpopup' alt='Ms Titus'>" + "Ms. Titus, or Karen Titus as she revealed to you her full name during one of your sex-filled adventure with her, runs the main desk of the library, one time you thought she was calm and business-like. Now you know she is an experienced slut, eager for sex at anytime. She no longer hush you away or tells you that she doesn\u2019t have time for you. During sex you realized she's quite experienced in the ways of pleasing a man or a woman, " +
			(perYou.isMaleSex() ? "her blowjobs are one of the best you\u2019ve ever had. " : "she can lick your pussy better than anyone ever has. ") + 'She has sex toys below her desk for quiet times in the library. That\u2019s when she closes the place for "breakfast or dinner time" and only the staff can enter, so she has to take her toys to the bathroom. That is the room where she has her fun time for fifteen minutes if you\u2019re not there to give her a hand. ' + "<br><br>" + "Your eyes are always drawn to her large cleavage, you no longer have to daydream about getting your hands on them."
	};
	per.whereNow = function() {
		return isShopOpen(2, 1, true) ? this.place : 228
	};
	per.getPossessionFace = function() {
		return "recept5"
	};
	per.passTimeDay = function() {
		if (Place == 228 && isShopOpen(2, 1, true)) return capitalizeFirstLetter(this.getPersonName()) + " leaves you to head off to the library";
		return ""
	};
	per.passTimeNight = function() {
		this.setFlag(11, !this.checkFlag(11));
		if (Place == 228 && !isShopOpen(2, 1, true)) return capitalizeFirstLetter(this.getPersonName()) + " returns home from the library and resumes her duties as your slave";
		return ""
	};
	per.addPlaceImageLeft = function(lit) {
		if (Place == 228) {
			if (sType !== "") return "";
			var s;
			if (this.isHere()) s = this.showPerson("titus-home" + (this.isFreeSlave() ? "-free" : "") + (this.checkFlag(11) ? "2" : "1") + ".jpg", "", "", "", "", false, "string");
			else s = "<img draggable='false' style='float:left;position:relative;max-height:99%;vertical-align:top;padding:0;width:95%' src='Images/livingroom5.jpg' alt='livingroom5'>";
			if (checkPlaceFlag("RathdownRd", 4)) s += AddImage("Items/bowl.jpg", "20%", "left", "", "", undefined, "string",
				"none") + "<p>The ornamental bowl is sitting outside on the patio.</p>";
			return s
		}
		return ""
	};
	per.showPersonTextHere = function(md) {
		if (Place == 228 && sType === "") {
			if (this.isHere())
				if (this.isFreeSlave()) md.write("<p>Karen Titus is waiting for you, she has tied and gagged herself as she likes to do. She is wearing some skimpy lingerie that does not really contain her cleavage.</p>");
				else md.write("<p>Karen Titus is waiting for you, wearing some lovely lingerie that barely contains her cleavage.</p>");
			if (this.isHere() &&
				this.checkFlag(14) && !checkPlaceFlag("RathdownRd", 5)) {
				md.write('<p style="clear:both">');
				AddImage("UI/books/alchemybook.jpg", "20%", "left", "", "", undefined, md, "none");
				md.write('You see collection of books piled in an irregular stack. One attracts your attention "Carnal Alchemy".</p>')
			}
		}
	};
	per.showEvent = function() {
		var md;
		if (Place == 269 && sType == "tituspool") {
			WaitHereOnly(6);
			md = WritePlaceHeader();
			this.showPerson("titus-pool.jpg");
			addPlaceTitle(md, "Swimming with Ms. Titus");
			md.write("<p>Ms. Titus arrives, dressed is a one piece swimsuit, you suppose she needs something to contain her cleavage properly, or is that just you fantasising. She joins you on a lounge by the poolside, ready for anything as always.</p>");
			startQuestions();
			addLinkToPlaceC(md, "it is fairly private here...", Place, "type=tituspoolsex");
			addLinkToPlaceC(md, "say goodbye to Karen", Place);
			WritePlaceFooter(md);
			return true
		}
		if (Place == 269 && sType == "tituspoolsex") {
			md = WritePlaceHeader(false, "td-left-large");
			this.showPerson("titus-pool-sex.jpg");
			addPlaceTitle(md, "Being Discrete and Private with Ms. Titus");
			md.write("<p>You ask your large breasted librarian to play with you more privately, and she seductively removes most of her swimsuit and lies back waiting for you.</p>");
			startQuestions();
			addLinkToPlaceC(md, "later...say goodbye to Karen", Place);
			WritePlaceFooter(md);
			return true
		}
		if (Place == 228) {
			if (sType == "fuck") {
				md = WritePlaceHeader();
				if (perYou.isMaleSex()) {
					this.showPersonRorX("titus-home-sex-b" + (this.isFreeSlave() && !isExplicit() ? "-free" : "") + ".jpg");
					addPlaceTitle(md, "Karen Titus");
					md.write("<p>You fully enjoy the body of your librarian Karen Titus</p>")
				} else {
					this.showPerson("titus-home-sex-g" + (this.isFreeSlave() ? "-free" : "") + ".jpg");
					addPlaceTitle(md, "Karen Titus");
					md.write("<p>You fully enjoy the body of your librarian Karen Titus</p>")
				}
				startQuestions();
				addLinkToPlaceC(md, "talk more to Karen", 228);
				addLinkToPlace(md, "exit the house", 229);
				WritePlaceFooter(md);
				return true
			}
			if (sType == "slavecharm") {
				md = WritePlaceHeader(false, "td-left-med");
				this.setFlag(8, false);
				this.showPerson("titus-charm-free" + (this.checkFlag(11) ? "2" : "1") + ".jpg");
				addPlaceTitle(md, "Your Slave Ms. Titus Under a Charm Spell");
				md.write("<p>While it is a waste of mana, you decide it is best to be safe and charm Ms. Titus. You step over to the bed she has tied herself to and recite the spell. There is no need to talk to her about submission and slavery, she is already your slave!</p>" +
					'<p>She looks up at you and spreads her legs, "I do not know what that was ' + perYou.getMaster() + ' but I like it! Take me please!"</p>' + "<p>Again you enjoy your slave and her submission. Afterwards she changes her lingerie and unties herself. She has clearly been affected by the spell but you are unsure why she decided to change. You ask her but she does not really know why, just that she wanted to.</p>");
				startQuestions();
				addLinkToPlaceC(md, "talk more to your charmed slave", Place);
				WritePlaceFooter(md);
				return true
			}
			if (sType == "contemplate") {
				md = WritePlaceHeader();
				AddImage("Items/bowl.jpg");
				addPlaceTitle(md, "Meditating on the Patio");
				md.write("<p>You look at the bowl of water but meditation has never been a thing for you.</p>");
				startQuestions();
				addLinkToPlaceC(md, "that is enough", Place);
				WritePlaceFooter(md);
				return true
			} else if (Place == 228 && sType == "interrupted") {
				md = WritePlaceHeader();
				this.showPerson("titus-home" + (this.isFreeSlave() ? "-free" : "") + (this.checkFlag(11) ? "2" : "1") + "-interrupt.jpg");
				addPlaceTitle(md,
					"Trying to Meditatie");
				md.write("<p>You try to meditate but as you do is feeling lonely and tried to attract your attention back to her. It is impossible to meditate, you will have to try this another time when she is not around.</p>");
				startQuestions();
				addLinkToPlaceC(md, "another time then", Place);
				WritePlaceFooter(md);
				return true
			}
		} else if (Place == 62)
			if (sType == "slave1") {
				md = WritePlaceHeader();
				this.setFlag(8);
				this.setFlag(14);
				this.charmedTime = nTime;
				this.showPerson("titus11.jpg");
				addPlaceTitle(md, "Ms. Titus Submits");
				perYou.addCorruption(-1);
				md.write("<p>You tell Tess to wait here and start to leave, and you feel a hand on your shoulder and then a pair of large breasts pressed against your back. You hesitate, and Ms. Titus whispers in your ear,</p>" + '<p>"You took her as your own! I have always wanted to be dominated, I fantasise about it all the time. You could be the one who could be my ' + perYou.getMaster() + '".</p>' + "<p>She gestures towards a dark area between some book-shelves. You nod and lead the way and when you arrive you turn around to confront her, expecting she is making fun of you. Instead you see Ms. Titus has stripped her clothes down to a sheer black camisole and some panties. You are speechless for a moment and before you can speak she says,</p>" +
					'<p>"' + perYou.getMaster() + ' what can your slave do for you, or to you?"</p>' + "<p>You have fantasised about this yourself, when you would be able to claim her and her magnificent breasts. You are surprised and delighted that it seems it was so simple, she was just waiting to be dominated. No magic needed to encourage or force her!</p>");
				startQuestions();
				addLinkToPlaceC(md, '"Strip slave! I want to see your breasts"', 62, "type=slave2");
				WritePlaceFooter(md);
				return true
			} else {
				if (sType == "slave2") {
					md = WritePlaceHeader();
					setPersonFlagAfterTime("MsTitus", 1, true, 288);
					this.place = 3;
					this.showPerson("titus13.jpg");
					addPlaceTitle(md, "Ms. Titus's Breasts");
					md.write('<p>"Yes ' + perYou.getMaster() + ' my tits are yours to touch, to lick, to slap, to beat. I am your tit-slave, yours to command, to punish, to fuck, to humiliate, to do anything to!"</p>' + "<p>You realise she has really been fantasising about being a slave, and she may know more about being your slave than you know about being her " + perYou.getMaster() + ", but you are happy to learn!</p>" +
						"<p>She strips away her camisole leaving just her panties and you reach out and grab one of her breasts, there seems no reason to be gentle, this is not fore-play it is domination and submission play. " + "Her breast weighs heavily in your hand and Ms. Titus looks up at you adoringly as she lowers her panties ready for something more.</p>");
					md.write("<p>You oblige her, and take your unexpected slave! After Ms. Titus tells you,</p>" + '<p>"Call me what you want, Karen, slut, slave, they are all my name"</p>');
					startQuestions();
					addLinkToPlace(md, "return to talk more to Tess", 62, "type=continue");
					addLinkToPlace(md, "go to the reception area.", 3);
					WritePlaceFooter(md);
					return true
				}
			}
		else if (Place !== 3) return false;
		if (sType == "slavecharm") {
			md = WritePlaceHeader();
			this.setFlag(8, false);
			this.showPerson("titus-charm-freelib.jpg");
			addPlaceTitle(md, "Your Slave Ms. Titus Under a Charm Spell");
			md.write("<p>While it is a waste of mana, you decide it is best to be safe and charm Ms. Titus. You step over to the bookshelf she has tied herself to and recite the spell. There is no need to talk to her about submission and slavery, she is already your slave!</p>" +
				'<p>She looks up at you, "I do not know what that was ' + perYou.getMaster() + ' but I like it! Take me please!"</p>' + "<p>Again you enjoy your slave and after she returns to her desk in the reception area. You realise as you watch that she is going there as it is easier for her to masturbate and play with herself, the arousal of the magic is clearly affecting her.</p>");
			startQuestions();
			addLinkToPlaceC(md, "talk more to your charmed slave", 3);
			WritePlaceFooter(md);
			return true
		}
		var herNameT = this.getPersonName();
		if (sType == "bj") {
			if (perYou.isMaleSex()) {
				md = WritePlaceHeader(isExplicit() ? "" : "td-left-med");
				if (isExplicit()) this.showPersonRandomX("titus5b", this.isFreeSlave() ? 4 : 5, "50vw,height:max", "", "", "", this.isFreeSlave() ? 4 : 0);
				else this.showPerson("titus5b.jpg");
				addPlaceTitle(md, "Playing with Ms. Titus");
				md.write("<p>You tell " + herNameT + ' to use her mouth to pleasure you while she continues to play with herself. She expertly takes your length into her mouth while playing with her large breasts and pussy. You do not take long to release into her mouth, and as you do so she cries out her ecstasy, muffled by your manhood and your fluids. She swallows and lies back and says, "Thank you ' +
					perYou.getMaster() + '".</p>')
			} else {
				md = WritePlaceHeader(false, "td-left-med");
				this.showPerson(this.isFreeSlave() ? "titus5gf.jpg" : "titus5g.jpg");
				addPlaceTitle(md, "Playing with Ms. Titus");
				md.write("<p>You tell " + herNameT + ' to use her tongue to pleasure you as she continues to play with herself. To your delight and surprise she is an expert at pleasuring women and she makes you reach the peak of ecstasy quickly. At the same time she cries out her pleasure, muffled by your pussy, and after she lies back and says, "Thank you!".</p>')
			}
			startQuestions();
			addLinkToPlace(md, sType == "monique" ? "tell them that is enough for now" : "tell Ms. Titus she's had enough for now", 3);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "fuck") {
			if (perYou.isMaleSex()) {
				md = WritePlaceHeader(false, isExplicit() ? "td-left-med" : "");
				if (isExplicit()) this.showPersonX("titus4b.jpg");
				else this.showPersonX("titus4b.jpg", "height:max");
				addPlaceTitle(md, "Playing with Ms. Titus");
				md.write("<p>You happily agree to take her and you sink you manhood into her delightful pussy, ramming into her over and over. You feel her shudder in her release and that is the final straw and you pour your passion into her depths.</p>")
			} else {
				md =
					WritePlaceHeader(false, "td-left-med");
				this.showPersonRorX(this.isFreeSlave() ? "titus4gf.jpg" : "titus4g.jpg");
				addPlaceTitle(md, "Playing with Ms. Titus");
				md.write("<p>You agree and decide to use your strap-on to explore " + herNameT + "'s lovely ass. You find she is very accommodating and very experienced with this, be it by man or woman. She very much enjoys your strap-on, reaching her peak not long after you do.</p>")
			}
			startQuestions();
			addLinkToPlace(md, sType == "monique" ? "tell them that is enough for now" :
				"tell Ms. Titus she's had enough for now", 3);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "titsfuck") {
			md = WritePlaceHeader(false, isExplicit() || this.isFreeSlave() ? "" : "td-left-med");
			if (isExplicit()) this.showPersonRandomX("titus7", 3, "height:max,height:max,50vw,height:max", "left", "", "", this.isFreeSlave() ? 1 : 0);
			else this.showPerson(this.isFreeSlave() ? "titus7f.jpg" : "titus7.jpg");
			addPlaceTitle(md, "Playing with Ms. Titus");
			md.write("<p>" + herNameT + "'s large breasts are difficult to ignore, so you ask her to use her breasts to pleasure you. This seems to be something she is <i>very</i> familiar with and she uses her very large bossom to please you until you release all over her breasts and face.</p>");
			startQuestions();
			addLinkToPlace(md, sType == "monique" ? "tell them that is enough for now" : "tell Ms. Titus she's had enough for now", 3);
			WritePlaceFooter(md);
			return true
		}
		var perMonique = findPerson("Monique");
		if (sType == "monique") {
			var img;
			if (perYou.isMaleSex())
				if (isExplicit()) img = this.showPersonRandomX("titusmoniqueb", 3, "", "", "", "", undefined, false, "string");
				else img = this.showPerson("titusmoniqueb.jpg", "", "", "", "", false, "string");
			else img = this.showPerson("titusmoniqueg.jpg", "", "", "", "", false, "string");
			md =
				WritePlaceHeader(false, !perYou.isMaleSex() || img.indexOf("titusmoniquebb.jpg") == -1 && img.indexOf("titusmoniqueb.jpg") == -1 ? "td-left-large" : "");
			md.write(img);
			addPlaceTitle(md, "Playing with Monique and Ms. Titus");
			md.write("<p>You call " + perMonique.getPersonName() + " to join " + herNameT + " and yourself. They both eagerly do their best to pleasure you and themselves in an wonderful blur or mouths, breasts, asses and pussies.</p>");
			startQuestions();
			addLinkToPlace(md, sType == "monique" ? "tell them that is enough for now" :
				"tell Ms. Titus she's had enough for now", 3);
			WritePlaceFooter(md);
			return true
		}
		if (sType === "playwithherself") {
			md = WritePlaceHeader();
			this.showPersonRandomRorX("titus6", 2, "height:max", "", "", "", this.isFreeSlave() && !isExplicit() ? 2 : 0);
			addPlaceTitle(md, "Playing with Ms. Titus");
			md.write('<p>Obeying your command, Ms. Titus eagerly begins to strip. She plays with her large breasts and pussy, performing for you to arouse herself and you. She nears the peak of her pleasure and stops. She begs you, "Take me, ' +
				perYou.getMaster() + '!".</p>');
			startQuestions();
			if (perYou.isMaleSex()) {
				addLinkToPlace(md, "fuck her", 3, "type=fuck");
				addLinkToPlace(md, "fuck her breasts as she masturbates", 3, "type=titsfuck");
				addLinkToPlace(md, "fuck her mouth as she masturbates", 3, "type=bj")
			} else {
				addLinkToPlace(md, "lick you as she masturbates", 3, "type=bj");
				if (perYourBody.FindItem(45) > 0) {
					addTextForQuestions(md, "or maybe you would prefer to");
					addLinkToPlace(md, "fuck her with your strap-on", 3, "type=fuck")
				}
			}
			if (perMonique.place === 8 && perMonique.isCharmedBy()) addLinkToPlace(md,
				"call Monique to join you", 3, "type=monique");
			addLinkToPlace(md, sType == "monique" ? "tell them that is enough for now" : "tell Ms. Titus she's had enough for now", 3);
			WritePlaceFooter(md);
			return true
		}
		return false
	};
	per.showPersonChat = function(bGeneral, md) {
		if (Place == 228 && sType === "") {
			if (this.isHere()) addLinkToPlaceC(md, "enjoy the librarian", 228, "type=fuck");
			if (checkPlaceFlag("RathdownRd", 4)) {
				if (perYou.checkFlag(29)) addLinkToPlaceC(md, "meditate on the bowl", Place, this.isHere() ? "type=interrupted" : "type=contemplate")
			} else if (this.isHere()) addPopupLink(md,
				"check out the house", "Ms. Titus's Home", "<img src='Images/titus-home" + (this.isFreeSlave() ? "-free" : "") + (this.checkFlag(11) ? "2" : "1") + "-interrupt.jpg' class='imgpopup' alt='Distraction'>" + "You start to look around the house but as you do Ms. Titus distracts you as she does not want to be neglected. You give up looking around for now and resolve to try again another time.", false);
			else addPopupLink(md, "check out the house", "Ms. Titus's Home", "<img src='Images/Items/bowl.jpg' class='imgpopup' alt='Bowl'>" +
				"Ms. Titus is not much of a housekeeper, everywhere is a little untidy, and there are unwashed dishes in the kitchen. Aside from this there is little remarkable about her home, comfortable and mid-range would be the simple description.<br><br>" + "She has books scattered all over the place, all with a bondage/dominance theme, and a few items here and there, a ball-gag and similar items.<br><br>" + "Outside is a slightly overgrown yard with a patio and some outdoor furniture. One area looks to have been a Zen meditation type area, with a large ornamental bowl of water to help with meditation. It is well maintained and clear, she appears to use this area at times.",
				false, "setPlaceFlag('RathdownRd', 4);dispPlace();");
			if (this.isHere() && this.checkFlag(14) && !checkPlaceFlag("RathdownRd", 5)) addPopupLinkC(md, "read the book", "Carnal Alchemy", "<p><img src='UI/books/alchemybook.jpg' style='width:30%;float:right;margin-left:5px' alt='Book'>" + 'You pick up the book and your slave Karen comments, "Interesting book I have been reading, but too much alchemy and not enough carnality!"<br><br>' + "You read though the book with Ms. Titus pointing out some bits, carnal and obscene! It is a quick read and surprisingly there are some interesting things that seem to touch on passages you have read in the Book.<br><br>" +
				"You put the book down on the pile of mostly BDSM works and feel you have learned a little of the occult, and more of the carnality of Ms. Titus.", false, "setPlaceFlag('RathdownRd',5);perYou.addExperience(1);WaitHere(6)");
			if (this.isHere()) addSleepLink(md, "sleep with Ms. Titus", "Sleeping with Karen", (this.isFreeSlave() ? '<p style="position:absolute;left:50%;top:80%;cursor:pointer;font-size:1.1em;width:45%"><b>You order your slave to prepare herself for bed as you will spend the night here. Karen ties herself to the bed ready for you' :
				'<p style="position:absolute;left:10%;top:80%;cursor:pointer;font-size:1.1em;width:40%"><b>You ask Karen about spending the night and she welcomes you into her bed.') + "</b>", "titus-sleep" + (this.isFreeSlave() ? "-free" : "") + (this.checkFlag(11) ? "2" : "1") + ".jpg", true, "", "", "", "overflow-y:hidden")
		}
	};
	per.handleItem = function(no, cmd) {
		if (no == 14 && cmd == 2)
			if (Place == 3 && isShopOpen(2, 1, true)) {
				if (isSpellKnown("Shielded Charm") || checkPlaceFlag("Library", 2))
					if (this.isFreeSlave()) CastCharmSpell("MsTitus", 3, 1, "type=slavecharm",
						"", "", true);
					else CastCharmSpell("MsTitus", 208, 1, "type=reception");
				else addComments("Don't cast the spell here. It is too public.");
				return "handled"
			} else if (Place == 62 && this.place == 62) {
			if (this.isFreeSlave()) addComments("Why waste the mana, she is your slave just as much as if you cast the spell.");
			else CastCharmSpell("MsTitus", 208, 1, "");
			return "handled"
		} else if (Place == 228 && this.isHere()) {
			CastCharmSpell("MsTitus", 228, 1, "type=slavecharm", "", "", true);
			return "handled"
		}
		return ""
	};
	per.isPhoneable = function() {
		return checkPlaceFlag("Hotel",
			11) && Place == 269 && (this.isCharmedBy() || this.isFreeSlave())
	};
	per.callThem = function() {
		if (Place == 269)
			if (isShopOpen(2, 1, true)) WriteComments('You call Ms. Titus to invite her to join you at the pool for a swim, but she replies, "Damn, ' + perYou.getMaster() + ' I am tied up here, wish it was <b>really</b> tied up!". She apologies and promises to another time. ');
			else {
				gotoPlace(Place, "type=tituspool");
				receiveCall("", 'You call Ms. Titus to invite her to join you at the pool for a swim, and she answers enthusiasticaly, "Hell yeah!" and hangs up. You take that to mean she will be there soon.');
				WriteCommentsFooter(bChat, bChatLeft)
			}
	};
	per.addPersonPhoneCall = function() {
		if (!this.isCharmedBy() && !this.isFreeSlave()) return false;
		if (nTime - this.charmedTime > 20 && !this.checkFlag(3)) {
			if (makeCall(true, 1)) this.setFlag(3)
		} else if (nTime - this.charmedTime > 100 && !this.checkFlag(4)) {
			if (makeCall(true, 2)) this.setFlag(4)
		} else if (nTime - this.charmedTime > 200 && !this.checkFlag(5)) {
			if (makeCall(true, 3)) this.setFlag(5)
		} else if (nTime - this.charmedTime > 300 && !this.checkFlag(12))
			if (makeCall(true, 4)) this.setFlag(12);
		return false
	};
	per.getPersonSMS = function(id) {
		switch (id) {
			case 1:
				if (this.isFreeSlave()) return receiveSMS("hornyslave", "Take me like I was at the party", "titussms1-free.jpg") + replyToSMS("Looking good!");
				return receiveSMS("hornylibrarian", "Longing for you " + perYou.getMaster() + " &#128525;", "titussms1.jpg") + replyToSMS("Looking good!");
			case 2:
				return receiveSMS(this.isFreeSlave() ? "hornyslave" : "hornylibrarian", "Something special I can offer", "titussms2" + (this.isFreeSlave() ? "-free" : "") + ".jpg");
			case 3:
				return receiveSMS(this.isFreeSlave() ?
					"hornyslave" : "hornylibrarian", "Remember me?", "titussms3.jpg", "88%");
			case 4:
				return receiveSMS(this.isFreeSlave() ? "hornyslave" : "hornylibrarian", "Like my Halloween costume from last year?", "titussms4.jpg")
		}
		return ""
	}
}

function initialiseNina() {
	addPerson("Nina", 371);
	per.whereNow = function() {
		return isDay() ? this.place : 0
	};
	per.isPersonInfo = function() {
		return true
	};
	per.getPersonInfo = function() {
		if (!this.isCharmedBy()) return "<img src='Images/nina0.jpg' style='width:30%;float:left;margin: 0px 4px 4px 0px' alt='Nina'>" + "The receptionist of the TV station is the typical airhead blonde who you imagine has got her job because she sucks dicks well. She is even constantly chewing a damned chewing gum which not only makes your presumption of her more real but it\u2019s really annoying just to be near her. Not even mentioning that she is mostly on the phone chatting to whoever she pleases to ignoring visitors or customers like yourself.";
		else return "<img src='Images/nina9.jpg' style='width:30%;float:left;margin: 0px 4px 4px 0px' alt='Nina'>" + "Nina, the receptionist at the station sure has an irritating personality even after you tackled her brains and emotions a little. Now she doesn\u2019t hang on the phone so much as she used to do, instead she\u2019s trying to prove her worth to you  by throwing herself at your feet and nagging you by always asking questions or telling you ideas how she could serve. You amuse yourself  by putting her in risky situations like you ordered her to suck her pen in the sluttiest way she possibly can when a visitor comes by or to have slight orgasms while talking on the phone. You even had her jump around in the hall like a frog once, holding important documents in her mouth ( no one but you were there to see ). Nina enjoys being your empty headed puppet, but you are afraid she could not comprehend or carry out complex missions like spying for you or !!!!.<br><br>" +
			"And you only wanted get your revenge on her for being so rude to you back then! However, it looks she is so simple minded that she takes your punishments as compliments and  continues to be an annoying slut rather than understanding you and your wishes , so if you have some free time you should train Nina to be your personal whore!"
	};
	per.showEventPopup = function() {
		if (sType !== "") return false;
		if (Place == 371 && this.place == 371 && !this.checkFlag(2) && isDay()) {
			this.setFlag(2);
			showPopupWindow("Receptionist",
				"<img src='Images/nina0.jpg' class='imgpopup' alt='Nina'>" + "The receptionist of the TV station is the typical airhead blonde who you imagine has got her job because she sucks dicks well. She is even constantly chewing a damned chewing gum which not only makes your presumption of her more real but it\u2019s really annoying just to be near her. Not even mentioning that she is mostly on the phone chatting to whoever she pleases to ignoring visitors or customers like yourself.<br><br>" + "As you impatiently wait in one of the chairs in front of her desk you decide that you should teach this bimbo some manners! It is an open place for visitors though and people come and go" +
				(isSpellKnown("Charm") ? "so you should be careful with using your powers here!" : "."));
			return true
		}
		return false
	};
	per.showEvent = function() {
		var md;
		if (Place == 269 && sType == "ninapool") {
			WaitHereOnly(6);
			md = WritePlaceHeader();
			this.showPerson("nina-pool.jpg");
			addPlaceTitle(md, "Swimming with Nina");
			md.write("<p>Nina arrives and changes into her yellow bikini, or at least mostly into it. She flirts with you, making it clear she wants to do more than swim.</p>");
			startQuestions();
			addLinkToPlaceC(md, "it is fairly private here...",
				Place, "type=ninapoolsex");
			addLinkToPlaceC(md, "say goodbye to Nina", Place);
			WritePlaceFooter(md);
			return true
		}
		if (Place == 269 && sType == "ninapoolsex") {
			md = WritePlaceHeader();
			this.showPerson("nina-pool-sex.jpg");
			addPlaceTitle(md, "More Than Swimming With Nina");
			md.write("<p>You accept her advances, and she pulls off the rest of her bikini ready for you to take her!</p>");
			startQuestions();
			addLinkToPlaceC(md, "later...say goodbye to Nina", Place);
			WritePlaceFooter(md);
			return true
		}
		if (Place != 371) return false;
		if (isDay() &&
			nFromPlace == 359 && this.isCharmedBy() && isCharmedBy("Zoey") && !this.checkFlag(3) || sType == "ninazoey" || sType == "ninazoey2") {
			md = WritePlaceHeader(false, "td-left-large");
			if (!this.checkFlag(3)) {
				this.setFlag(3);
				setQueryParams("type=ninazoey")
			}
			this.showPerson("ninazoey1.jpg");
			addPlaceTitle(md, "Slaves Practising");
			if (sType == "ninazoey") md.write("<p>You see the reception area is empty, Nina is not at her desk. You assume she is on a break and go to check the small break room your Mom once took you to when visiting. Before you take a few steps you hear some voices coming from the room so you check it out. The room has some large plants and some tea and coffee machines. It also has a naked Nina and a naked Zoey! You hear them whispering and hear Nina say,</p>" +
				"<p>\"Don't worry, " + perYou.getHeShe() + " won't mind, it's like we are, you know, practising. So we are really good for " + perYou.getHimHer() + '"</p>' + '<p>Zoey notices you and smiles, but Nina is very intent on seducing her and does not see you. Interesting, you remember Madison saying something about how "Nina really likes Zoey". You would guess the arousal of the Charm spell is letting them try things they may not of before. Alright, time to take some control here, so you interrupt,</p>' + '<p>"Nina! Yes you may by all means practise with Zoey, but you must ask my permission!"</p>' +
				"<p>Nina looks startled and stammers an apology and asks if they can practise for you? You of course agree and you watch the two as they caress and play with each others bodies. Nina is clearly besotted with Zoey, but while it seems Zoey likes her, it seems Zoey is more interested in performing for your enjoyment.</p>" + "<p>After a time you tell them that they have had enough practise and it is time to put their training to good use, on you!</p>");
			else md.write("<p>You tell Zoey that it is time for another practise session with Nina. You both step out to the reception area, leaving a disappointed Madison behind.</p>" +
				'<p>You tell Nina "Practise makes perfect" and she immediately understands and heads for the break room, shedding her clothing.</p>' + "<p>In the break room you make sure they get plenty of practise in pleasuring each other, but mainly in pleasuring yourself.</p>");
			startQuestions();
			addLinkToPlace(md, "let them finish and return to the reception with Nina", Place);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "please") {
			md = WritePlaceHeader(false, "td-left-med");
			if (Math.random() < .5) this.showPerson("nina7.jpg");
			else this.showPerson("nina8.jpg");
			addPlaceTitle(md, "Nina Under a Spell");
			md.write('<p>"I think its time for another lesson Nina," you say, looking around to see if anyone else is close by. For the time being, the coast seem to be clear.</p>' + "<p>Nina quickly sheds her few pieces of clothing, an act she is getting rather good at doing quite quickly.</p>" + '<p>"Yes ' + perYou.getMaster() + '!" she says, an excited look passing through her eyes at the thought of pleasing you.  "Take me ' + "again.  Use me like the <i>slave</i> I am.  Please, " +
				perYou.getMaster() + '!" she begs.</p>' + '<p>"I would do <i>anything</i> for you, ' + perYou.getMaster() + '!" she stammers between moans of pleasure as she administers to your every need.</p>' + '<p>"You and your pleasure are all I live for now," she moans as she brings you to climax.</p>' + '<p>"As it should be, Nina, my little minx," you say, smiling as she almost orgasms from your praise.</p>');
			startQuestions();
			addLinkToPlace(md, "clean up and speak with your minx some more", 371);
			addLinkToPlace(md, "leave the station",
				359);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "charm1") {
			md = WritePlaceHeader();
			this.showPerson("nina2.jpg");
			addPlaceTitle(md, "Nina Under a Spell");
			md.write("<p>Preoccupied, she doesn't notice you casting the spell.  But as her eyes begin to glow her her words trail off, mid sentence.  Turning off the phone, she stares at you, suddenly speachless.</p>" + '<p>"You alright, Miss?" you ask, trying to look as if her sudden flirtatious advances were completely unnoticed.</p>' + '<p>"Miss? Please," she says as with more than a little attitude. "Please...  Call me Nina. All my...  my friends call me Nina," she finally manages to get out.</p>' +
				'<p>"Okay, Nina it is," you say, giving her a warm, inviting smile. "But you didn\'t answer my question, Nina.  Are you feeling alright?"</p>' + '<p>"Feeling?  Oh, yes," she says, obviously feeling very distracted.  "I feel fine.  Better than fine, actually. You... You know... I\'m not sure how to say this..."</p>' + '<p>You smile at her sudden attack of shyness.  "Come now, Nina.  Just spit it out." Never hurts to assert your influence here.</p>');
			if (!perYou.isBornMale()) md.write("<p>\"Well, it's a...  Has anybody ever told you that you're really cute?\" she asks, giving you flashbacks to what you wish your high school had been like.</p>");
			else md.write("<p>\"Well, it's...  It's just that...  I'm usually not...  Normally I prefer girls...  I mean I don't dislike boys, but you know...\"</p>");
			md.write("<p>You step up to her, close enough to smell her perfume, jasmine if you're not mistaken.  She almost shakes in response to your closeness.  \"Are you saying that you're attracted to me, Nina?\" you ask, keeping her gaze with an intense look in her eyes.</p>" + '<p>It has the desired effect, as she barely manages a whisper.  "Uhmm.  yea - Yes..."</p>' +
				'<p>"Well then," you say as you step nearer and, taking her head gently in your hands, you give her a deep, passionate kiss. Her body immediately responds to your touch as her tongue begins exploring your mouth. Moments later you pull away, leaving her gasping for more.</p>' + "<p>Stepping back from her, your eyes roam up and down her body, examining your newest acquisition.  She seems to respond to your inspection, straightening her posture a bit. " + '"Like what you see?" she asks.  "Want to see more?"</p>');
			startQuestions();
			addLinkToPlaceC(md, '"As a matter of fact I do. Take off your shirt for me."', Place, "type=charm2slave");
			if (perYou.checkFlag(26)) addLinkToPlaceC(md, '"Of course I do, you are very desirable."', Place, "type=charm2gf");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "charm2slave") {
			this.charmThem(4);
			md = WritePlaceHeader();
			this.showPerson("nina3s.jpg");
			addPlaceTitle(md, "Nina Being Enslaved By A Spell");
			md.write('<p>"Like this?" she says as she opens her shirt and pushes out her chest for impact.</p>' +
				'<p>"Just like that, Nina," you say, praising her and smiling as you ' + 'notice her visceral reaction, her face beginning to flush.  "Very good girl."</p>' + '<p>"Thank you," she says, her shyness beginning to reassert itself. "I... I\'m usually not this... this... forward with people."</p>' + '<p>"Really?" you ask as you step up and run your hands along her very well-toned stomach.  "Well then, Nina.  Why are you being so... ' + 'forward... with me then?"  Then you begin lightly kissing her neck from behind her.</p>' +
				'<p>"I... I..." she stammers, her body reacting of its own volition to the soft touch of your lips.</p>' + '<p>"There is just... <i>something</i> about me, isn\'t there Nina?" you ask, knowing full well she is now absolute putty in your hands.</p>' + '<p>"Ye... Yes..." she whispers.  "Something... about you. So powerful. No one has ever made me feel this way."</p>' + '<p>"Powerful. That\'s right Nina," you whisper in her ear.  "There is something ' + "about me.  Something you literally can't resist.  In fact,\" you say as you begin to step back away from her, leaving her breathless. " +
				'"I am so irresistible that you <i>have</i> to do whatever I say.  And I\'ll prove it."</p>');
			startQuestions();
			addLinkToPlaceC(md, '"Take off your bra for me, Nina."', Place, "type=charm3slave");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "charm2gf") {
			this.charmThem(2);
			md = WritePlaceHeader();
			this.showPerson("nina3g.jpg");
			addPlaceTitle(md, "Nina Being Seduced By A Spell");
			md.write('<p>"Like this?" she says as she opens her shirt and pushes out her chest for impact.</p>' + '<p>"Just like that, Nina," you say, praising her and smiling as you ' +
				'notice her visceral reaction, her face beginning to flush.  "Very good girl."</p>' + '<p>"Thank you," she says, her shyness beginning to reassert itself. ' + '"I... I\'m usually not this... this... forward with people."</p>' + '<p>"Really?" you ask as you step up and run your hands along her ' + 'very well-toned stomach.  "Well then, Nina.  Why are you being so... ' + 'forward... with me then?"  Then you begin lightly kissing her neck from behind her.</p>' + '<p>"I... I..." she stammers, her body reacting of its own volition to the soft touch of your lips.</p>' +
				'<p>"There is just... <i>something</i> about me, isn\'t there Nina?" ' + "you ask, knowing full well she is now absolute putty in your hands.</p>" + '<p>"Ye... Yes..." she whispers.  "Something... about you. So powerful. No one has ever made me feel this way."</p>' + '<p>"Powerful. That\'s right Nina," you whisper in her ear.  "There is something ' + "about me.  Something you literally can't resist.  In fact,\" you " + "say as you begin to step back away from her, leaving her breathless. " + '"I am so irresistible that you <i>have</i> to do whatever I say.  And I\'ll prove it."</p>');
			startQuestions();
			addLinkToPlaceC(md, '"Take off your bra for me, Nina."', Place, "type=charm3gf");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "charm3slave") {
			md = WritePlaceHeader();
			this.showPerson("nina4.jpg");
			addPlaceTitle(md, "Nina Under a Spell");
			md.write("<p>She smiles at you as she removes her shirt and begins to pull down her bra, " + "exposing herself for your viewing pleasure.</p>" + '<p>"You <i>like</i> this, don\'t you Nina." you say, making what would normally ' + "have been a question into more of a command - a command that slips straight into " +
				'her oh-so-malleable mind.  "You like displaying yourself for me, doing things ' + "for me that would wouldn't do for <i>anyone</i> else.\"</p>" + "<p>She simply moans as the command turns what little fear and apprehension she " + "was still feeling into pure pleasure as she realizes that she <i>does</i> like " + "showing herself off to you.</p>" + '<p>"That\'s what I thought," you say, smiling. "And why is that, Nina?  Why do ' + 'you like showing yourself off to me?" A confused look flashes across her face ' +
				"as she tries in vain to understand why she is suddenly feeling so aroused.</p>" + '<p>"Because you know it pleases me, Nina," you say, smiling at the look of relief ' + 'that crosses her face.  "You would do anything to please me.  Wouldn\'t you, Nina?"</p>' + '<p>"Yes.  Yes, of course I would," she says as your words are incorporated into her new worldview.</p>' + '<p>"Well then, that means that <i>my</i> happiness is more important that your own, ' + 'isn\'t it," you say directly to her subconscious.  "In fact, you would be willing to ' +
				"do anything if you knew it would make me happy.  Wouldn't you, Nina.\"</p>" + '<p>"Why don\'t you finish taking that bra off and show me that beautiful body of yours."</p>');
			startQuestions();
			addLinkToPlace(md, "wait for her to obey you", Place, "type=charm4slave");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "charm3gf") {
			md = WritePlaceHeader();
			this.showPerson("nina4.jpg");
			addPlaceTitle(md, "Nina Under a Spell");
			md.write("<p>She smiles at you as she removes her shirt and begins to pull down her bra, " + "exposing herself for your viewing pleasure.</p>" +
				'<p>"You <i>like</i> this, don\'t you Nina." you say, making what would normally ' + "have been a question into more of a command - a command that slips straight into " + 'her oh-so-malleable mind.  "You like displaying yourself for me, doing things ' + "for me that would wouldn't do for <i>anyone</i> else.\"</p>" + "<p>She simply moans as the command turns what little fear and apprehension she " + "was still feeling into pure pleasure as she realizes that she <i>does</i> like " + "showing herself off to you.</p>" +
				'<p>"That\'s what I thought," you say, smiling. "And why is that, Nina?  Why do ' + 'you like showing yourself off to me?" A confused look flashes across her face ' + "as she tries in vain to understand why she is suddenly feeling so aroused.</p>" + '<p>"Because you know it pleases me, Nina," you say, smiling at the look of relief ' + 'that crosses her face.  "You would do anything to please me.  Wouldn\'t you, Nina?"</p>' + '<p>"Yes.  Yes, of course I would," she says as your words are incorporated into her new worldview.</p>' +
				'<p>"Well then, that means that <i>my</i> happiness is more important that your own, ' + 'isn\'t it," you say directly to her subconscious.  "In fact, you would be willing to ' + "do anything if you knew it would make me happy.  Wouldn't you, Nina.\"</p>" + '<p>"Why don\'t you finish taking that bra off and show me that beautiful body of yours."</p>');
			startQuestions();
			addLinkToPlace(md, "wait for her to obey you", Place, "type=charm4gf");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "charm4slave") {
			md = WritePlaceHeader();
			this.showPerson("nina5.jpg");
			addPlaceTitle(md, "Nina Under a Spell");
			md.write('<p>"Anything for you..." she says, her voice quickly beginning to drip with sex.</p>' + "<p>You step near her again and begin to run your hands up and down her body, savoring " + 'the feel of her oh-so-supple skin.  "That\'s right, Nina...  anything.  Now kiss me."</p>' + "<p>In a flash she had her arms up and around you, her mouth firmly pressed up against " + "yours as her tongue explores your mouth.  Her body reacts to your every touch as her " +
				"moans begin to slip out between her kisses.</p>" + "<p>You enjoy the attention of your newest slave, and then slip away - realizing that you're " + "not quite done with this one.</p>" + '<p>"So Nina..." you begin.  "Yes?" she whispers demurely.  "What is the most important ' + 'thing in your life?"</p>' + '<p>"You are..." she says, her look of adoration beginning to win you over.</p>' + '<p>"And what would you do if you knew it would make me happy?" - - "Anything..." she says.</p>' + '<p>"And is there anything you would deny me, Nina?" you ask as you hold her possessively ' +
				'in your arms.  - - "No, nothing," she says.</p>');
			startQuestions();
			addLinkToPlaceC(md, '"And what does that make you, Nina?"', 371, "type=charm5slave");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "charm4gf") {
			md = WritePlaceHeader();
			this.showPerson("nina5.jpg");
			addPlaceTitle(md, "Nina Under a Spell");
			md.write('<p>"Anything for you..." she says, her voice quickly beginning to drip with sex.</p>' + "<p>You step near her again and begin to run your hands up and down her body, savoring " + 'the feel of her oh-so-supple skin.  "That\'s right, Nina...  anything.  Now kiss me."</p>' +
				"<p>In a flash she had her arms up and around you, her mouth firmly pressed up against " + "yours as her tongue explores your mouth.  Her body reacts to your every touch as her " + "moans begin to slip out between her kisses.</p>" + "<p>You enjoy the attention of your newest slave, and then slip away - realizing that you're " + "not quite done with this one.</p>" + '<p>"So Nina..." you begin.  "Yes?" she whispers demurely.  "What is the most important ' + 'thing in your life?"</p>' + '<p>"You are..." she says, her look of adoration beginning to win you over.</p>' +
				'<p>"And what would you do if you knew it would make me happy?" - - "Anything..." she says.</p>' + '<p>"And is there anything you would deny me, Nina?" you ask as you hold her possessively ' + 'in your arms.  - - "No, nothing," she says.</p>');
			startQuestions();
			addLinkToPlaceC(md, '"And what does that make you, Nina?"', 371, "type=charm5gf");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "charm5slave") {
			md = WritePlaceHeader();
			this.showPerson("nina6.jpg");
			var myName = perYou.getMaster();
			addPlaceTitle(md, "Nina Under a Spell");
			md.write('<p>A flash of inspiration crosses her face.  "That would make me your...  slave," she says, ' + "as she sits back on the desk completely displaying herself for you and drawing out the word " + '"slave" as if trying on a new dress and finding she just loves the way it feels.</p>' + "<p>You smile down at her as you press yourself against her, feeling your own desire for her ");
			if (perYou.isMaleSex()) md.write("growing");
			else md.write("dripping down your leg");
			md.write('.</p><p>"And what does that make me?" you ask, expecting the obvious.</p>' +
				'<p>"My ' + myName + '." she says with a certainty that tells you she is completely and totally <i>yours</i>.</p>' + "<p>Then, showing a surprising amount of initiative, she reaches out and ");
			if (perYou.isMaleSex()) md.write(' frees your member, guiding you into her inviting snatch.  "Oh yes, Master. Take me.  Use me.  Tell me how to please you."</p>');
			else md.write(' begins to pull your pants down, diving in and devouring you with a willingness that more than makes up for her lack of experience.  "Oh yes, Mistress.  Use me.  Teach me how to please you."</p>');
			startQuestions();
			addLinkToPlace(md, "let Nina get more presentable, then speak with her some more", 371);
			addLinkToPlace(md, "leave the station", 359);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "charm5gf") {
			md = WritePlaceHeader();
			this.showPerson("nina6.jpg");
			var myName = perYou.getMaster();
			addPlaceTitle(md, "Nina Under a Spell");
			md.write('<p>A flash of inspiration crosses her face.  "That would make me your...  slave," she says, ' + "as she sits back on the desk completely displaying herself for you and drawing out the word " +
				'"slave" as if trying on a new dress and finding she just loves the way it feels.</p>' + "<p>You smile down at her as you press yourself against her, feeling your own desire for her ");
			if (perYou.isMaleSex()) md.write("growing");
			else md.write("dripping down your leg");
			md.write('.</p><p>"And what does that make me?" you ask, expecting the obvious.</p>' + '<p>"My ' + myName + '." she says with a certainty that tells you she is completely and totally <i>yours</i>.</p>' + "<p>Then, showing a surprising amount of initiative, she reaches out and ");
			if (perYou.isMaleSex()) md.write(' frees your member, guiding you into her inviting snatch.  "Oh yes, Master. Take me.  Use me.  Tell me how to please you."</p>');
			else md.write(' begins to pull your pants down, diving in and devouring you with a willingness that more than makes up for her lack of experience.  "Oh yes, Mistress.  Use me.  Teach me how to please you."</p>');
			startQuestions();
			addLinkToPlace(md, "let Nina get more presentable, then speak with her some more", 371);
			addLinkToPlace(md, "leave the station",
				359);
			WritePlaceFooter(md);
			return true
		}
		return false
	};
	per.showPersonChat = function(bGeneral, md) {
		if (Place != 371) return;
		if (sType == "byesuitcase2") {
			var stage = getQueryParam("stage");
			if (stage === "") addLinkToPlace(md, "listen in on her", Place, "type=byesuitcase2&stage=stage1", "You know better by now than to try to get Nina's attention while she's on the phone, but maybe you can get some information out of her if you listen in, she's ignoring you anyway.</p><p>\u201cYes, she's even staying at night with her assistant, and they are the only ones who do so!\u201d</p><p>\u201cExactly, I just know the two are, like, totally having an affair! Bet that whole thing's just some excuse, so they can fuck all night without their spouses or kids or whatever knowing.\u201d</p><p>\u201cOh they are close, that little slavedriver has had the Manager around her finger for, like, weeks! And we suffer her whip now!\u201d</p><p>\u201cNo... not like this...\u201d Nina laughs. \u201cThough, that would explain, like, sooo much, you know?\u201d</p><p>\u201cNo... I'd totally like to spy on them, but I'd have to be able to pass through walls to get in at night... Bet I'd get quite the show, though.\u201d</p><p>There is a large pause from Nina, so it seems it's now the other persons turn to tell a story...</p><p>\u201cReally, with her? Ugh, isn't she, like... 50 or something and....\u201d</p><p>Another pause.</p><p>\u201cNo way! You have to tell me everything!\u201d</p><p>Well, the topic has shifted so you might as well leave now. It looks like you have to find other means to learn more about what the two are doing.");
			if (stage === "" || stage == "stage1") addLinkToPlace(md, "talk to her", Place, this.isCharmedBy() ? "type=byesuitcase2&stage=stage2" : "", !this.isCharmedBy("You") ? "The only confirmation that she even notices you, is her patented \u201cHow dare you try to make me do my job\u201d glare before she returns her attention to the phone." : "\u201cOh, I'll have to call you back!\u201d Nina perks up immediately when you approach her and whispers into the phone. \u201cYes, my " + (perYou.isBornMale() ? "Ma" : "Mi") + "... Boss is here, I'll call you later!\u201d</p><p>Nina quickly stops the call and gives you her undivided attention. \u201cI'm so sorry for the delay, " +
				perYou.getMaster() + ", can I, like...\u201d her voice takes a sultry tone, and she begins suggestively nibbling on her Pen. \u201c...do anything for you?\u201d");
			else if (stage == "stage2") addLinkToPlace(md, "ask her about the current events", Place, "type=byesuitcase2&stage=stage3", "\u201cUgh...A few days back we just had people talking about ghosts sightings, more people than usual, you know?\u201d Nina sighs.\u201d But now there was this, like, weird tremor roughly around the Broken arms Inn area and shortly afterwards, people have gone missing and they are, totally trying to fabricate some supernatural magic connection between the two and the manager has the entire newsteam investigate it.\u201d</p><p>\u201cAs if magic is real, you know?\u201d She seductively licks her lips for you.");
			else if (stage == "stage3") addLinkToPlace(md, "She doesn't believe in Magic?", Place, "type=byesuitcase2&stage=stage4", "\u201cNope, never seen anything magical in Glenvale, and believe me, " + perYou.getMaster() + ", I'm totally smart enough to, like, recognize magic when it's used.\u201d She rolls her shoulders back to push her cleavage forward as she speaks. \u201cI've seen all the Harry Potter movies, after all.\u201d");
			else if (stage == "stage4") addLinkToPlace(md, '"So there\'s a lot to do?"', Place, "type=byesuitcase2&stage=stage5",
				"\u201cNaaaah...\u201d No one's doing overtime hours except for the manager and her assistant, and...\u201d She leans in conspiratorial.\u201d ...If you ask me it's just, so they can get away from their families for a while to, like, you know...\u201d She whispers. \u201cTotally have sex!\u201d");
			else if (stage == "stage5") addLinkToPlace(md, "What makes her think that?", Place, "type=byesuitcase2&stage=stage6", "Have you seen the way the manager looks at Miss Halliway of late? She's, like, totally smitten, I can see that! I bet if you find a way to get inside the studio at night you'll find them all over each other!\u201d");
			else if (stage == "stage6") addLinkToPlace(md, "Tell Nina to have an eye on the two keep you informed", Place, "", "Nina may be a complete ditz, but at least when it comes to office gossip you are probably able to trust her instincts. So, you make sure to tell her to keep an Eye on Gabby and your mother, and inform you if she finds any prove for her suspicions, while you will start your own investigation as well.")
		}
		if (sType !== "" || !isDay()) return;
		if (this.isCharmedBy("You")) addLinkToPlace(md, "give Nina another lesson in how to please you",
			371, "type=please");
		else if (!this.checkFlag(1)) addQuestionR(md, "introduce yourself", "The receptionist glares at you for a moment, then goes back to her conversation.  Eavesdropping, you learn that her name is Nina, and confirming your first impression. She is chatting to someone about some party last night and who wore what and who liked who.", "Receptionist Nina", "setPersonFlag(\\'Nina\\', 1);")
	};
	per.handleItem = function(no, cmd) {
		if (no == 14 && cmd == 2)
			if (Place == 371 && this.isHere()) {
				if (!this.checkFlag(1)) addComments("You do not know her name, so the spell will not work.");
				if (!isSpellKnown("Shielded Charm")) addComments("The reception area of a Radio and Television station is much to public a place to cast this.");
				else CastCharmSpell("Nina", 371, 4, "type=charm1");
				return "handled"
			}
		return ""
	};
	per.isPhoneable = function() {
		return checkPlaceFlag("Hotel", 11) && Place == 269 && this.isCharmedBy()
	};
	per.callThem = function() {
		if (Place == 269)
			if (isDay()) WriteComments("You call Nina to invite her to join you at the pool for a swim, but she is real sorry that she has to work, and asks for a rain-check?");
			else {
				gotoPlace(Place, "type=ninapool");
				receiveCall("", 'You call Nina to invite her to join you at the pool for a swim, and she immediately answers, "Totally!!" and she hangs up. You gather this means she will be here soon.');
				WriteCommentsFooter(bChat, bChatLeft)
			}
	};
	per.addPersonPhoneCall = function() {
		if (this.isCharmedBy() && isNight() && !this.checkFlag(4))
			if (makeCall(true, 230)) this.setFlag(4);
		if (!this.checkFlag(5) && this.isCharmedBy() && checkPersonFlag("Mom", 34) && !per.checkFlag(32) && !isDay() && Math.floor(per.hoursCharmed() /
				24) == 2)
			if (makeCall(true, 231)) this.setFlag(5);
		if (checkPersonFlag("Gabby", 8) && !this.checkFlag(6) && isMurderPath())
			if (makeCall(true, 232)) {
				this.setFlag(6);
				setPlaceKnown("GabbysHouse")
			}
		return false
	};
	per.getPersonSMS = function(id) {
		if (id == 230) return receiveSMS("Nina", "Hi there, " + perYou.getMaster() + ", I just can't cook, it gets all over me..", "ninasms1.jpg");
		if (id == 231) return receiveSMS("Nina", "Heeeeeyyy!!  Ms Halliway is talking about some breakthrough tonight, thought you might want to hear this.", this.isCharmedBy("You") ?
			"ninasms2.jpg" : "", this.isCharmedBy("You") ? "80%" : "") + (this.isCharmedBy("You") ? receiveSMS("Nina", "Missing u, btw. :-*") : "");
		if (id == 232) return receiveSMS("Nina", perYou.getMaster() + "! Ms. Halliway and the Manager just left the studio with a huge suitcase. They wouldn't tell anyone why, but I've spied on them when they ordered a Taxi to 11 Amaranth Pl!", "ninasms3.jpg") + receiveSMS("Nina", "I bet they are gonna F-U-C-K. :D");
		return ""
	}
}

function initialiseNurseMegan() {
	addPerson("Nurse Megan", 275);
	per.isPersonInfo = function() {
		return true
	};
	per.getPersonInfo = function() {
		if (!this.isCharmedBy()) return "<img src='Images/" + this.getImg("megan1b.jpg") + "' class='imgpopup' alt='Nurse'>" + (this.checkFlag(2) ? "Nurse Megan, the dedicated ICU nurse" : "The dedicated ICU nurse, you do not know her name");
		else return "<img src='Images/" + this.getImg("megan5.jpg") + "' class='imgpopup' alt='Nurse'>" + "Slave Megan, the dedicated ICU Nurse and your loyal slave"
	};
	per.getPossessionFace = function() {
		return "megan-face"
	};
	per.showEvent = function() {
		var md;
		if (Place == 269 && this.isHere() && sType === "") {
			md = WritePlaceHeader();
			this.place = 275;
			var perKhan = findPerson("OfficerKhan");
			if (perKhan.place != 213 && !perKhan.isDead()) perKhan.moveThem(435);
			this.showPerson("megan-pool1.jpg");
			addPlaceTitle(md, "Hotel Pool");
			md.write("<p>Following Bambi's tip you walk into the pool and you see the two girls she talked about, a lovely pair of women wearing skimpy bikinis..</p>" + "<p>You can immediately see they are probably lovers, the way their attention is focused on each other and they way they gently touch each other at times. You hear a smattering of conversation and it is the exchange of intimacies you would hear from any two lovers.</p>" +
				"<p>They start kissing, oblivious to your presence.</p>");
			startQuestions();
			addLinkToPlace(md, "cough to attract their attention", 269, "type=meganpool2");
			addLinkToPlace(md, "go to the Hotel Bar", 124);
			WritePlaceFooter(md);
			return true
		}
		if (Place == 269 && sType === "meganpool2") {
			md = WritePlaceHeader();
			this.showPerson("megan-pool2.jpg");
			addPlaceTitle(md, "Hotel Pool");
			setPlaceKnown("HospitalICU");
			md.write("<p>One of the girls glances at you, and then resumes kissing her girlfriend. After a little you hear the one in the striped bikini say,</p>" +
				'<p>"I should leave, my shift in the ICU is due to start soon" they kiss and the other girl says "Don\'t let me catch you flirting at the gym again, at least with anyone other than me. Especially that Cheryl, such an athletic little minx, pity about her personality.."</p>' + '<p>They step out of the pool and start to towel each other dry in a sensual and intimate if not quite sexual way. After a while, the one who spoke leaves the pool area, and as she passes you she whispers "Enjoyed it?"</p>' + "<p>This just increases your desire for this woman, you will have to see if you can visit the ICU at the Glenvale Hospital.</p>");
			startQuestions();
			startQuestions();
			addLinkToPlace(md, "go to the Hotel Bar", 124);
			WritePlaceFooter(md);
			return true
		}
		if (Place != 275) return false;
		if (sType == "megandisplay") {
			md = WritePlaceHeader(false, "td-left-large");
			this.showPersonRorX("megan7.jpg");
			addPlaceTitle(md, "Megan Displayed for your Pleasure");
			md.write('<p>The young nurse poses on the bed, legs spread.  "I live to serve, ' + perYou.getMaster() + '," she says.  "Please, use me."</p>');
			startQuestions();
			addLinkToPlaceC(md, '"That\'s a good slave," you say.  "Now come over here."',
				Place, "type=megansex");
			addLinkToPlace(md, "return to the hospital reception", 214);
			WritePlaceFooter(md, "Script by Tilde");
			return true
		}
		if (sType == "megansex") {
			md = WritePlaceHeader(false, isExplicit() && perYou.isMaleSex() ? "" : "td-left-large");
			this.showPersonRorX(perYou.isMaleSex() ? "megan9b.jpg" : "megan9g.jpg");
			addPlaceTitle(md, "Megan Caring for You");
			if (perYou.isMaleSex()) md.write('<p>The young nurse pleasures you with her body and her mouth, she is eager to serve, but strangely inexperienced. Afterwards you ask and she explains, "' +
				perYou.getMaster() + ' I usually take women as my lovers".</p>');
			else {
				md.write("<p>The young nurse pleasures you expertly with her body and her mouth. So expertly you assume she regularly takes women as her lover. When you ask she tells you that she only seldom takes a man as her lover</p>");
				if (isExplicit(true) && whereItem(45) === 0) {
					PlaceI(45, 391);
					md.write("<p>Megan talks a little about her lover and the ways she has love them. She tells you that she had recently bought a toy, and insists that you must have it as a gift, and use it with her at sometime. She briefly steps out and returns with her gift for you.</p>")
				}
			}
			startQuestions();
			addLinkToPlace(md, "return to the hospital reception", 214);
			WritePlaceFooter(md, "Script by Tilde");
			return true
		}
		if (sType == "charmmegan1") {
			md = WritePlaceHeader();
			this.showPerson("megan2.jpg");
			addPlaceTitle(md, "Megan Falling for It");
			md.write("<p>Your spell fills the nurse's mind and she gives you a look that seems a little more friendly than is required of hospital staff.</p>" + "<p>Catching the look, you decide she's going to be easy to put under, so you might as well have fun with it.</p>" + '<p>"Say, what\'s your name, gorgeous?" you ask with a big lecherous leer.</p>' +
				'<p>"Wow, that\'s not a very good pick-up line," she says, laughing at you.  "Maybe you should tell me your name first."</p>' + '<p>"Well, my friends call me ' + perYou.getPersonName() + ", and my many lovers call me " + perYou.getMaster() + '. If you want to be my lover, I could just call you slave, but otherwise..."</p>' + '<p>"Megan," she says quickly.  "Are you just full of pick-up lines?"' + '<p>"I\'m a regular dispenser," you say, drawing another laugh.  You leer again, and say, "Of all sorts of things."');
			startQuestions();
			addLinkToPlaceC(md, '"Would you like me to show you what kind of things?"', Place, "type=charmmegan2");
			WritePlaceFooter(md, "Script by Tilde");
			return true
		}
		if (sType == "charmmegan2") {
			md = WritePlaceHeader();
			this.showPerson("megan3.jpg");
			addPlaceTitle(md, "Megan Falling for It");
			md.write("<p>Pretending to let an exasperated sigh, Megan says, \"Sure, I'll bite.  What kinds of things do you dispense?");
			if (perYou.isBornMale()) md.write("  I'll call security if you say sperm.");
			md.write('"</p><p>You lean forward, ');
			if (!perYou.isBornMale()) md.write(" giving her an enticing view of your cleavage, ");
			md.write('and with a rapacious smile purr, "Pleasure."</p>' + '<p>Megan hoots with laughter, though her gaze lingers on your body.  "And how, exactly, do you do that?"</p>' + '<p>"Let me see your breasts," you say.</p>' + '<p>"I can\'t believe I\'m doing this," she chuckles ruefully as she unbuttons her front and pulls down her bra to give you a good look.  "Now, could you explain-"</p>');
			startQuestions();
			addLinkToPlace(md,
				"Interrupt her again", Place, "type=charmmegan3");
			WritePlaceFooter(md, "Script by Tilde");
			return true
		}
		if (sType == "charmmegan3") {
			md = WritePlaceHeader();
			this.showPerson("megan4.jpg");
			addPlaceTitle(md, "Megan Falling for You");
			md.write('<p>"Wow, you are so absolutely sexy, Megan.  Do you know I can see in your eyes ' + 'how badly you want me?" you say, curious how hard you can push the spell and still keep her under your power.</p>' + "<p>Embarrassed, she doesn't look you in the eye.  The nurse's jacket is set aside, forgotten.</p>" +
				'<p>"So tell me, Megan, how did it feel when I called you sexy?"</p>' + '<p>She smiles again, in spite of her embarrassment.  "Okay, that was a little pleasurable."</p>' + '<p>"How about when I told you to show off and you obeyed?  Or when I told you ' + 'how you wanted me and you knew it was right?  Did that make you feel pleasure as well?"</p>' + "<p>She doesn't answer; she just stands there avoiding your gaze.</p>");
			startQuestions();
			addLinkToPlace(md, "Press the advantage", Place, "type=charmmegan4");
			WritePlaceFooter(md,
				"Script by Tilde");
			return true
		}
		if (sType == "charmmegan4") {
			md = WritePlaceHeader();
			this.showPerson("megan5.jpg");
			addPlaceTitle(md, "Megan Falling for You");
			md.write('<p>You step so close that she can feel your breath on her skin when you say, "Sit back, Megan." ' + "She sits back, and removes the bra without your even recommending it.  Still, her look is " + "uncertain and you're pleased that you've extended the enslavement process this long.  She " + "didn't look like she'd put up any kind of fight at all.</p>" +
				'<p>"You look a little nervous, Megan," you say, still leering.</p>' + "<p>\"It's just, I know you're no good for me,\" she tries to explain.  \"You've got lame " + "pick-up lines and you look at me like I'm some kind of toy.\"</p>" + '<p>"And even with all that, it makes you feel good when I tell you to sit back and ' + 'you obey," you finish for her.</p>' + '<p>"I...yeah.  Pretty much," she admits.  You take off your shirt and she freezes up, ' + "a mix of too frightened and too impassioned to move.</p>" + '<p>"Well, you\'ve got it all wrong," you say.  "Nothing I said was a lame pick-up ' +
				'line.  They were all dead-to-rights truth."</p>' + "<p>\"But...you really call your lovers 'slave' to their faces?\"</p>" + '<p>"Oh yes," you say.  "They love it."  You put a hand on your nipple and she watches, ' + 'entranced, as you poke at it, wiggle it, pinch it.  "You were also wrong about me being no good for you."</p>' + '<p>"Oh," she says, her attention too consumed to even question you.</p>' + "<p>Suddenly you lean close, your lips a hair's breadth from hers.</p>");
			startQuestions();
			addLinkToPlaceC(md,
				'"And why do I look at you like a toy?"', Place, "type=charmmegan5");
			WritePlaceFooter(md, "Script by Tilde");
			return true
		}
		if (sType == "charmmegan5") {
			md = WritePlaceHeader();
			this.showPerson("megan6.jpg");
			addPlaceTitle(md, "Megan Fallen Under");
			md.write("<p>She can't help herself; she leans forward and kisses you.  Her hands work up and down your body and your remaining clothes are quickly discarded.</p>" + '"' + perYou.getMaster() + '," she cries. "Oh, ' + perYou.getMaster() + ", " + perYou.getMaster() + '."  She sits back and grins at you.  "You look at me that way because I am a toy.  But I\'m your toy, and that makes all the difference in the world."</p>' +
				'"That\'s a good slave," you say.  "Now come over here."</p>');
			startQuestions();
			addLinkToPlace(md, "finish and return to the hospital reception", 214);
			WritePlaceFooter(md, "Script by Tilde");
			return true
		}
		return false
	};
	per.handleItem = function(no, cmd) {
		if (no == 14 && cmd == 2)
			if (Place == 275 && this.isHere()) {
				if (!isSpellKnown("Shielded Charm")) addComments("Don't cast the spell here. It is too public.");
				else if (!this.checkFlag(2)) addComments("You do not the nurses name, so the spell will not work.");
				else CastCharmSpell("NurseMegan",
					Place, 1, "type=charmmegan1");
				return "handled"
			}
		return ""
	}
}

function RepliesNurseSandra(nR) {
	var perNS = per;
	var bCharm = per.isCharmedBy();
	var myName = per.getYourNameFor();
	var perGhost = findPerson("Ghost");
	if (nR == 921) {
		if (perNS.other < 2) perNS.other = 2;
		if (!bCharm) addComments('<p>"We found you with a bullet lodged in your shoulder and brought you straight to the hospital. You have been here for a day and you need a lot more rest."</p>');
		else addComments('<p>"Oh, ' + myName + '," she says with tears in her eyes. "You were found with a bullet lodged in your shoulder and brought straight to the hospital."  She reaches out and touches you longingly.  "You have been here for a day and need more rest, and perhaps some... special attention," she says with a glint in her eye.</p>');
		addComments("<p>You ask after your <b>possessions</b> and she tells you that there was <b>nothing with you when you were brought here</b> but your family or the police may have them.</p>");
		if (!this.checkFlag(2)) addComments('<p>You ask the nurse what is her name, and she smiles, "Nurse Sandra, now take it easy for a while"</p>')
	} else if (nR == 922) {
		if (!perYou.checkInjury(7)) {
			perYou.setInjury(7);
			moveItem(4, 76);
			if (wherePerson("MrBeasley") !== 11) movePerson("MrBeasley", 11);
			perYou.setFlag(8)
		}
		if (!bCharm) addComments('<p>"The barmaid at the Broken Inn Hotel found you unconscious and brought you straight to the hospital. You have only been here for about an hour and appear otherwise uninjured."</p>');
		else addComments('<p>"Oh, ' + myName + '," she says with tears in her eyes. "Bambi found you lying unconscious and brought straight to the hospital."  She reaches out and touches you longingly.  "You have only been here for an hour and appear otherwise uninjured, but perhaps you need some... special attention," she says with a glint in her eye.</p>');
		addComments('<p>You see your clothes and possessions on a chair nearby, but the Book is missing! You ask where is it and she says "Bambi was helped by a teacher of yours, a Mr. Beasley, you should ask one of them"');
		if (!this.checkFlag(2)) addComments('<p>You ask the nurse what is her name, and she smiles, "Nurse Sandra, now take it easy for a while"</p>')
	} else if (nR == 93102) {
		var perS = findPerson("OfficerSmith");
		if (perS.other < 102) perS.other = 102;
		if (!bCharm) addComments('<p>"' + getOfficer() + ' Smith is in the intensive care unit. It looks like she may not pull through."</p>');
		else addComments('<p>"She is in the intensive care unit in critical condition, ' + myName + '," she says, quite concerned.  "So she is yours then?" she says hesitantly. "She calls for you in her sleep, ' +
			myName + '."</p>')
	} else if (nR == 100) {
		perGhost.setFlag(3);
		addComments("You tell Nurse Sandra about seeing the ghost in the old basement, and how it looked like her friend Keana.</p>");
		if (bCharm) {
			perGhost.setFlag(5);
			if (perGhost.checkFlag(4)) addComments("<p>Once again you ask Sandra about the ghost, and ask her about the ring.</p>" + "<p>\"Boss, I gave this ring to her, it's cheap but all I could afford at the time. When I found her body, I..took it to remember her by. I know I shouldn't of but her family would not of missed it, and it has no value.\"</p>" +
				"<p>You realise this is probably what the ghost was looking for!</p>");
			else addComments('<p>"Now Boss, there is no way Keana would be haunting the basement!"</p>' + "<p>You describe how she seemed to be searching for something, and the nurse looks thoughtful</p>" + '<p>"Really Boss, well maybe..." and she touches a ring on one of her fingers. "Boss, I gave this ring to her, it\'s cheap but all I could afford at the time. When I found her body, I..took it to remember her by. I know I shouldn\'t of but her family would not of missed it, and it has no value."</p>' +
				"<p>You realise this is probably what the ghost was looking for!</p>");
			addComments("<p>You will have to take Sandra to the basement when it is night time and see if she can help.</p>");
			if (!isSpellKnown("Unlife Enspelled")) addComments("<p>Then again, you wonder if you can do anything once you can get the ghost's attention, is a <b>standard charm spell</p> enough? You probably will only have <b>one</b> chance at this.</p>")
		} else {
			perGhost.setFlag(4);
			var mm = perYou.isBornMale() ? "Mister" : "Miss";
			addComments('<p>"Now look here ' +
				mm + ' I told you before she is a good woman and has no reason to haunt a place!"</p>' + "<p>You describe how she seemed to be searching for something, and the nurse looks thoughtful</p>" + '<p>"Really ' + mm + ', well maybe..." and she touches a ring on one of her fingers. She looks embarrassed and then refuses to talk about it more.</p>')
		}
	}
	return true
}

function initialiseNurseSandra() {
	addPerson("Nurse Sandra", 213);
	per.Replies = RepliesNurseSandra;
	per.getPersonName = function(full) {
		return full !== true && this.isCharmedBy() ? "Slave Sandra" : "Nurse Sandra"
	};
	per.getPossessionFace = function() {
		return "Setting/sandra-face"
	};
	per.showEventPopup = function() {
		if (Place == 214 && sType == "meetsandra") {
			var ele = isBritish() ? "lift" : "elevator";
			showPopupWindow("Passerby", "<img src='Images/Setting/sandra8.jpg' style='width:30%;float:right;margin-left:5px' alt='Nurse'>" + "As you look away from the picture, you almost bump into a " +
				(isBritish() ? "cute" : "buxom") + " red-haired woman. She tells you,<br><br>" + '"' + (perYou.isBornMale() ? "Mister" : "Miss") + ", Keana was a good friend, I only knew her briefly when I was a student nurse but I miss her. Now don't you listen to any stories you may hear, she was a good woman, and her death was an accident. There is no reason she would be haunting the basement!<br><br>I gotta go " + (perYou.isMaleSex() ? "Mister" : "Miss") + ', my shift is due to start soon, bye now!"<br><br>' + "She glances at the " + ele +
				", its doors are just starting to close, and runs over and almost jumps into the " + ele + ' before the doors close. You hear someone in the elevator say "Hi Sandra"');
			this.setFlag(2);
			return true
		}
		return false
	};
	per.showEvent = function() {
		if (sType === "") return false;
		var md;
		if (sType == "charmsandra1") {
			md = WritePlaceHeader();
			this.showPerson("Setting/sandra2.jpg");
			setPersonFlag("Ghost", 3, false);
			addPlaceTitle(md, "Nurse Sandra Under a Spell");
			md.write('<p>Sandra staggers from the spell. "What are you doing to me?" she asks in disbelief.</p>');
			startQuestions();
			addLinkToPlace(md, "wait for the spell to take effect", Place, "type=charmsandra2");
			addLinkToPlace(md, "exit the ward", 214);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "charmsandra2") {
			md = WritePlaceHeader();
			this.showPerson("Setting/sandra3.jpg");
			addPlaceTitle(md, "Nurse Sandra Under a Spell");
			md.write("<p>You tell Sandra that she is feeling very sexy, so sexy that she has to do whatever you want.</p>" + '<p>"No!" she replies, fighting the magic. She spins, unable to control the sensation burning in her loins. ' +
				"\"Oh god! I can't believe that I need it so much. My clothes... I can't stop myself.\"</p>");
			startQuestions();
			addLinkToPlace(md, "see what happens next", Place, "type=charmsandra3");
			addLinkToPlace(md, "exit the ward", 214);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "charmsandra3") {
			md = WritePlaceHeader();
			this.showPerson("Setting/sandra4.jpg");
			addPlaceTitle(md, "Nurse Sandra Under a Spell");
			md.write('<p>"So you want a piece of this, do you?" asks Sandra, hiking up her skirt to show you her slit. ' + '"You think that you can come in here and take whatever you want. I bet that you have never had what I can give."</p>' +
				"<p>The spell seems to have taken hold of the nurse. You take an uncertain step backward.</p>");
			startQuestions();
			addLinkToPlace(md, "take what Sandra has", Place, "type=charmsandra4");
			addLinkToPlace(md, "escape while you still can", 214);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "charmsandra4") {
			md = WritePlaceHeader();
			if (perYou.isMaleSex()) this.showPersonRorX("Setting/sandra7.jpg");
			else this.showPersonRorX("Setting/sandra6g.jpg");
			addPlaceTitle(md, "Nurse Sandra Under a Spell");
			md.write('<p>Sandra leans over the bed. "Alright, boss," she says. ' +
				'"Let\'s see what you can do."</p>' + "<p>You accept the nurse's offer and have one of the best times of your life.</p>");
			startQuestions();
			addLinkToPlaceC(md, "talk more to Sandra", 213);
			addLinkToPlace(md, "exit the ward", 214);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "sandracheckupsex") {
			md = WritePlaceHeader(false, perYou.isMaleSex() && isExplicit() ? "td-left-large" : "");
			if (perYou.isMaleSex()) this.showPersonRorX("Setting/sandra6b.jpg");
			else this.showPersonRorX("Setting/sandra6g.jpg");
			addPlaceTitle(md, "A Checkup by Nurse Sandra");
			md.write("<p>Sandra agrees. \"Alright, boss, let me 'check' everything you have\".</p>");
			startQuestions();
			addLinkToPlaceC(md, "talk more to Sandra", 213);
			addLinkToPlace(md, "exit the ward", 214);
			WritePlaceFooter(md);
			return true
		}
		return false
	};
	per.handleItem = function(no, cmd) {
		if (no == 14 && cmd == 2)
			if (Place == 213) {
				if (!this.checkFlag(2)) addComments("You do not know the nurses name, so the spell will not work!");
				else CastCharmSpell("NurseSandra", Place, 1, "type=charmsandra1");
				return "handled"
			}
		return ""
	}
}

function RepliesTrial(nR) {
	var perDA = findPerson("Diane");
	var npc = "Police Officer";
	if (nR == 3 || nR == 6) npc = "Judge Gabel";
	if (isMurderPath())
		if (nR == 3) {
			npc = getOfficer() + " Khan";
			if (getPersonCharm("OfficerKhan") > 0) npc = getOfficer() + " Mitchel";
			perDA.extra[1] = 6;
			addComments("<p><b>" + npc + "</b></p>");
			addComments('<p>"Very well," says the judge. "' + npc + ', please present the evidence."</p>')
		} else if (nR == 6) {
		perDA.extra[1] = 7;
		addComments("<p><b> Judge Gabel</b></p>");
		addComments('<p>"All right. Call for your witness."</p>')
	} else if (nR ==
		71) {
		addComments("<p><b>Calling a Witness</b></p>");
		addComments('<p>You call your mother to the stand."</p>');
		perDA.extra[1] = 15
	} else if (nR == 72) {
		perDA.extra[1] = 30;
		addComments("<p><b>Calling a Witness</b></p>");
		addComments('<p>You call Mr Beasley to the stand."</p>')
	} else if (nR == 151) {
		perDA.extra[1] = 20;
		addComments("<p><b>Your Mother</b></p>");
		addComments('<p>"Oh my goodness!" exclaims your mother. "You didn\'t cook dinner, your sister did. You must have murdered poor ' + perGates.getPersonNameShort() + '!"</p>')
	} else if (nR ==
		152) {
		perDA.extra[1] = 16;
		addComments("<p><b> Judge Gabel</b></p>");
		addComments('<p>The judge eyes your suspiciously. "If you were there and saw the murder then who did it?"</p>')
	} else if (nR == 161) {
		perDA.extra[1] = 20;
		addComments("<p><b> Judge Gabel</b></p>");
		addComments('<p>"Lies," says the judge. "Witnesses saw Mr Beasley at the school all day. You must be the murderer yourself."</p>')
	} else if (nR == 162) {
		perDA.extra[1] = 16;
		addComments("<p><b> Judge Gabel</b></p>");
		addComments('<p>"Nonsense," says the judge. "Please tell us now who murdered ' +
			perGates.getPersonName() + '."</p>')
	} else {
		if (nR == 35) {
			if (perDA.FindItem(36) != 1E3) {
				AddCash(100);
				perDA.extra[1] = 35
			}
			perDA.RemoveItem(36);
			addComments("<p><b> Judge Gabel</b></p>");
			addComments("You hand the judge your letter. A frown crosses his face as he quickly reads it.  Impressed by the evidence, he grants you " + sCurrency + "100 in compensation for the inconvenience and help in tracking down the criminal Davy Robbins.")
		}
	} else switch (nR) {
		case 3:
			perDA.extra[1] = 6;
			addComments("<p><b>Museum Guard Gina</b></p>");
			addComments('<p>"Very well," says the judge. "Gina, please give your testimony."</p>');
			break;
		case 6:
			perDA.extra[1] = 7;
			break;
		case 7:
			perDA.extra[1] = 10;
			break;
		case 10:
			perDA.extra[1] = 30;
			addComments("<p><b>" + getProsecutor() + " White</b></p>");
			addComments('<p>She looks at you, seemingly quite surprized.  "What?  I mean... but you confessed!?" she stammers.</p>');
			break;
		case 35:
			if (whereItem(8) != 1E3) {
				AddCash(100);
				perDA.extra[1] = 35
			}
			perDA.DropItem(8, 1E3);
			addComments("<p><b> Judge Gabel</b></p>");
			addComments("You hand the letter to the judge. He is impressed by the evidence and rewards you " +
				sCurrency + "100 for the inconvenience and help in tracking down the criminal Davy Robbins.");
			break
	}
	return true
}

function RepliesOfficerBatton(nR) {
	var bCharm = per.isCharmedBy();
	var myName = per.getYourNameFor();
	var perBatton = per;
	var perKhan = findPerson("OfficerKhan");
	if (nR == 5215) {
		if (this.other < 10) this.other = 10;
		if (this.place === 168) this.place = 1;
		movePerson("Sarah", 1);
		movePerson("AdeleRoss", 16);
		setPersonFlag("AdeleRoss", 1);
		perKhan.health = 0;
		perKhan.place = 1E3;
		bChat = false;
		addComments(this.addPersonFace());
		if (!bCharm) addComments('"You heard she was murdered?  From whom?  Wait, never mind," she says, nodding her head decisively. "I\'m going to get to the bottom of this myself."<br>');
		else addComments('"Murder?" She asks, then nods her head decisively.  "Yes ' +
			myName + '.  I will see what I can find out."<br>')
	}
	if (nR == 5216) {
		if (this.other < 10) this.other = 10;
		if (this.place === 168) this.place = 1;
		movePerson("Sarah", 1);
		movePerson("AdeleRoss", 16);
		setPersonFlag("AdeleRoss", 1);
		perKhan.health = 60;
		perKhan.place = 213;
		bChat = false;
		addComments(this.addPersonFace());
		if (!bCharm) addComments('"You heard she was shot and in hospital?  From whom?  Wait, never mind," she says, nodding her head decisively. "I\'m going to get to the bottom of this myself."<br>');
		else addComments('"Shot?" She asks, then nods her head decisively.  "Yes ' +
			myName + ', she is badly wounded and in hospital.  I will see what I can find out."<br>')
	} else if (nR == 5750) {
		addComments('"As you wish, ' + myName + '," she says, with an evil grin - immediately cuffing the ' + getProsecutor() + " and dragging her off to the jail cell.  You delight in listening to Ms. White's angry and confused protestations as they leave.");
		setPersonOther("Diane", 50);
		DAReturnItems();
		perYou.setArrested(0)
	} else if (nR == 9910)
		if (!bCharm) addComments('"I\'m not at liberty to discuss an ongoing investigation, especially with a civilian," she says, turning back to her work and ignoring you.  You doubt there is any way to get her to talk through <i>normal</i> means.');
		else {
			this.other = 11;
			var perA = findPerson("Anita");
			if (perA.other != 101 && perA.other < 900) {
				if (perKhan.isDead()) addComments('"Several witnesses claim that they saw Anita, the alleged murderer, run to the school," she says as she presses her ample breasts against your body.  Evidently her desire for your attention outweighs her concern for her deceased co-worker.</p><p>"She was last seen entering Ms Jones\'s office, but there was no trace of her there."');
				else addComments('"Several witnesses claim that they saw Anita, the alleged shooter, run to the school," she says as she presses her ample breasts against your body.  Evidently her desire for your attention outweighs her concern for her injured co-worker.</p><p>"She was last seen entering Ms Jones\'s office, but there was no trace of her there."');
				perA.other = 100;
				perA.place = 252;
				movePerson("MsJones", 145);
				setPlaceKnown("FrenchClassroom")
			} else if (perA.other >= 900) {
				if (perA.other === 900) perA.other = 901;
				addComments('<p>"Her body was found in the park, ' + myName + ", a bullet wound in her chest.  She was still clutching her gun with her so the " + getProsecutor() + ' has decided to rule her death a justifiable homicide and is not investigating further."</p>')
			}
		}
	else if (nR == 10201) {
		movePerson("AdeleRoss", 436);
		setPersonFlag("AdeleRoss", 2);
		addComments('"The Mayor insisted that we give extra protection to the Gates mansion after the recent string of burglaries, but if they are in your way, I will of course remove them immediately."</p>' +
			"<p>As you wish, " + myName + '.  I will call her back from the estate immediately," she says, picking up her radio and calling in the order,</p>');
		if (checkPersonFlag("MrBeasley", 3)) addComments('<p>"' + getOfficer() + ' Ross, please return to the station...What about your sister...Alright you may take the rest of today off duty".</p>');
		addComments('<p>She tells you, "It is done, ' + myName + '.  Would you like to play with me some more?"')
	} else if (nR == 10202) {
		setPersonFlag("AdeleRoss", 3);
		addComments('"Oh, you know her sister? ');
		if (checkPersonFlag("MrBeasley", 3)) addComments(getOfficer() + ' Ross asked to go home as her sister has gone missing". You explain how Amy is a friend of yours but had not heard she was doing anything. You will have to check with her big-sister when you have the time.');
		else addComments(' Is she one of your slaves too?"')
	} else if (nR == 9E3) {
		if (whereItem(31) === 0) PlaceI(31, 45);
		bChat = false;
		addComments(this.addPersonFace());
		if (bCharm) addComments('"I am so sorry I could not protect you, ' + myName + '," she whispers to you, tears welling up in her eyes from her shame. "Here take this whistle.  One blow and police will be there to protect you. Be careful ' +
			myName + ', your attacker is still out there."</p><p>Your slave then leaves to finish her other duties.');
		else addComments('"I understand your situation,' + myName + '," says ' + getPoliceChief() + ' Batten. "You do not want to get shot again and your attacker is still on the loose. Here, take this whistle in case you need police assistance.  One blow and we\'ll be there as fast as we can."</p><p>' + getPoliceChief() + " Batton then quickly leaves to continue the search.")
	} else if (nR == 1131) {
		setPlaceFlag("Museum",
			3);
		setPlaceFlag("Museum", 4);
		if (checkPersonFlag("MrsGranger", 1)) addComments('"Oh yes, ' + myName + '.  Mrs. Granger is still in the ICU, I believe." She says, trying to tempt you with her body.</p><p>"And the vase was locked in the safe for protection.  Oh my!" She says realizing she may have done something wrong.</p><p>"You didn\'t <i>want</i> the vase did you ' + myName + "?  I'm so sorry!\"</p>");
		else if (wherePerson("MrsGranger") == 261) addComments('"Oh yes, ' + myName + '.  Mrs. Granger is locked in the jail." She says, trying to tempt you with her body.</p><p>"And the vase was locked in the safe for protection.  Oh my!" She says realizing she may have done something wrong.</p><p>"You didn\'t <i>want</i> the vase did you ' +
			myName + "?  I'm so sorry!\"</p>");
		else addComments('"Oh yes, ' + myName + ', she says, trying to tempt you with her body. "The vase was locked in the safe for protection.  Oh my!" She says realizing she may have done something wrong.</p><p>"You didn\'t <i>want</i> the vase did you ' + myName + "?  I'm so sorry!\"</p>");
		var perS = findPerson("OfficerSmith");
		if (perS.isCharmedBy() && perS.other < 3) perS.other = 3
	} else if (nR == 2E3) {
		movePerson("Diane", 441);
		WaitHereOnly(6);
		addComments('<img src="Images/ambulance.png" style="float:left;width:20%;margin:0 10px 1em 0" alt="ambulance" title="ambulance">' +
			"As you wish, " + myName + '.  I will have her body taken to the morgue"')
	} else if (nR == 2001) {
		movePerson("OfficerSmith", 441);
		WaitHereOnly(6);
		addComments('<img src="Images/ambulance.png" style="float:left;width:20%;margin:0 10px 1em 0" alt="ambulance" title="ambulance">' + "As you wish, " + myName + '.  I will have her body taken to the morgue"')
	}
	return true
}

function initialiseOfficerBatton() {
	addPerson("Officer Batton", 168);
	per.Replies = RepliesOfficerBatton;
	per.getPossessionFace = function() {
		return "Setting/polb-face"
	};
	per.isPersonInfo = function() {
		return true
	};
	per.getPersonInfo = function() {
		if (this.isCharmedBy()) return "<img src='Images/Setting/polb0.jpg' style='width:25%;float:right;margin:0 0 0 5px' alt='Batton'>" + this.getPersonName() + " turned out to be a sex-crazy slut, that is after you charmed her of course, but it looks like you brought her inner hunger for sex. Her warm personality still remain though and immediately announced herself as your slave.</p><p>She offered that she would be glad to send all " +
			getOfficer() + "s away awhile in the police station away just so you two can have your fun together without worrying, but you stopped her, because you knew it\u2019s too risky and told her that eventually you will own this place soon enough." + "</p><p>She\u2019s now standing in attention, even saluting you in her (now yours) station. After that she sinks to her knees playing with her tits for you and begs for her " + perYou.getMaster() + " to fuck her.</p><p>You never thought it would be that easy to enslave the police chief, but here she is, waiting for you to command her.";
		else return "<img src='Images/Setting/polb0.jpg' style='width:25%;float:right' alt='Batton'>" + this.getPersonName() + ", the athletic and surprisingly helpful head of the Glenvale police force. Tall and well-built, especially her breasts..."
	};
	per.getPersonName = function(full) {
		if (full === true) return getPoliceChief() + " Kerry Batton";
		return getPoliceChief() + " Batton"
	};
	per.getPersonNameShort = function() {
		return "Kerry Batton"
	};
	per.showEventPopup = function() {
		if (Place != 168 || sType !== "") return false;
		if (getQueryParam("arrest") ==
			"true") return false;
		var perDA = findPerson("Diane");
		if (!this.checkFlag(1)) {
			this.setFlag(1);
			if (perDA.other === 0) {
				showPopupWindow(this.getPersonName(), "<img src='Images/Setting/polb0.jpg' class='imgpopup' alt='Batton'>" + getPoliceChief() + " Batton is the kind of woman who you don\u2019t want to mess with. She\u2019s the head of the police department in this town. That means she knows every legal and illegal activities that happens here. She could be a serious opposition if she learns about your powers  and you have read in a newspaper article that she was a " +
					(isBritish() ? "Specialist Firearms Operations" : "SWAT") + " member before accepting this job; so she would easily kick your butt in a fight. " + "However; you can\u2019t get your mind off her. Imagine if the " + getPoliceChief() + " in charge of this town would be yours to command. You could use all the manpower, weapons and vehicles of the police force against your battle with Kurndorf , Davy or anyone else who stands in your way. Committing crimes without punishments and partying all the time without having to worry about the law is just a bonus.<br><br>" +
					"As you watch her fit physique in that uniform standing in front of you and thinking about your options makes you horny. Suddenly her gaze meets with yours. She stands up from her chair and comes to you.<br><br>" + '"Hey there! Do you have something to tell me or report?"<br>' + "she asks warmly. You nervously hesitate to answer, but her friendly face and words relaxes you a bit.<br><br>" + '"If there\u2019s nothing you want to say or report that\u2019s fine. You can hang around if you want, but please don\u2019t disturb my partners and don\u2019t touch anything!"<br>' +
					"with a gentle smile she pats your shoulder and turns around going back to her office.<br><br>" + "Whoa. You never thought she\u2019s that kind." + (isSpellKnown("Charm") ? "You realize now; she could be easily persuaded to join your ranks." : ""));
				return true
			}
		}
		if (this.place == 168 && perDA.isCharmedBy() && this.isCharmedBy() && wherePerson("OfficerKhan") == 168 && isCharmedBy("OfficerKhan") && this.checkFlag(5) && !this.checkFlag(4)) {
			showPopupWindow("Police Staff Meeting", "<img src='Images/Setting/polb9.jpg' style='width:30%;float:right' alt='Batton'>" +
				getPoliceChief() + " approaches you, her second in command, " + getOfficer() + " Khan and " + getProsecutor() + " White accompany her, following slightly behind her.<br><br>" + '"' + perYou.getMaster() + '! I\u2019m so happy that you\u2019ve added Ms. White and Ms. Khan to your harem! I don\u2019t have to work secretly for you anymore.", Chief Batton runs and hugs you.<br><br>' + '"I can give you anything you want without having to worry that Ms Khan here would become suspicious of my actions.", she adds while you burst into laughter at her statement and happiness.<br><br>' +
				'"That\u2019s right! The police office is now yours to do with as you please! We will inform you with any new information or detail we get. You\u2019re the boss from here on out!", Ms Khan nodding heavily.<br><br>' + '"Don\u2019t forget about me! I\u2019m doing all your official business and paperwork in your name!", ' + getProsecutor() + " White tells while curtsying to you.<br><br>" + "After that you send them away to continue their work  you feel a sensation of power and dominance fills your whole body and mind as you watch your three slaves shaking their ass for you while they go back to their work.",
				"setPersonFlag('OfficerBatton',4);dispPlace()");
			return true
		}
		if (this.checkFlag(2) && !this.checkFlag(3) && this.isCharmedBy() && (perDA.isCharmedBy() || (perDA.other === 0 || perDA.other >= 900))) {
			showPopupWindow(this.getPersonName(), "<img src='Images/Setting/polb9.jpg' class='imgpopup' alt='Batton'>" + '"What else can you give me other than yourself? Enlighten me, my dear", you ask your slave and motion her to kneel before you while you two talk.<br><br>' + '"Anything, ' + perYou.getMaster() + "! If you need help in your quest I can promise you, my police " +
				getOfficer(false) + 's and our transportation are at your disposal. If you are in tricky situation and need help, or maybe when you want someone dead you can come to me anytime for protection.", ' + getPoliceChief() + " Batton eagerly lists the things to you. You stolidly fiddle with the handcuffs attached to her skirt.<br><br>" + '"Go on, continue, don\u2019t stop there!", you order her in an impassive tone. You just like it when your slaves see you are not impressed  and try their best to please you.<br><br>' +
				'"Well, if you need to trace something or someone down and you\u2019re in middle of your investigation you you should know that the our equipment; radios, tracking devices, computers, sensors and cameras are available to you 24/7\u2026", you can see she\u2019s desperately trying to win your attention. While she speaks, she unhooks the handcuffs and offers them to you to play with. You casually whirl it around your fingers.<br><br>' + '"You have free access to places which are forbidden to outsiders and you can have me issue out search warrants or close down streets or houses. However I would advise you ' +
				perYou.getMaster() + ", to charm other important figures of the town like my right-hand man " + getOfficer() + ' Khan, the mayor Ms Thomas and Kristin the bank manager. This would make things more  simple; to have them cooperate with the police easily and it would improve your influence over the people around here.", it looks like she\u2019s running out of ideas so you toss the handcuffs back and thank her for her help.<br><br>' + '"Hmm\u2026 thanks for the tip! I will see what I can do. I will be in touch.", with that you sit back to your chair comfortably.<br><br>' +
				"She makes a silent nod, understanding your orders and kneels back, assuming the position of a good slave.", "setPersonFlag('OfficerBatton',3)");
			return true
		}
		return false
	};
	per.showEvent = function() {
		if (Place != 168) return false;
		var md;
		if (sType == "kerrydianethreesome") {
			md = WritePlaceHeader(false, "td-left-med");
			this.showPersonRorX("Setting/polb8.jpg");
			addPlaceTitle(md, "Legal Procedures");
			md.write("<p>Kerry and Diane escort you to a small room that is set aside for officers to rest, it has a small bed and simple other furnishings.</p>" +
				"<p>They immediately remove their clothing and give you an enthusiastic and mutually orgasmic demonstration of some joint legal proceedures.</p>");
			startQuestions();
			addLinkToPlace(md, "return to the police reception", 168);
			addLinkToPlace(md, "exit the Police Station", 167);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "kerryfuck") {
			if (perYou.isMaleSex()) {
				md = WritePlaceHeader(false, isBritish() && !isExplicit() ? "" : "td-left-large");
				this.showPersonRorX("Setting/polb7b.jpg")
			} else {
				md = WritePlaceHeader(false, isExplicit() ?
					"" : "td-left-large");
				if (isBritish()) this.showPersonRandomRorX("UK/polb7g", isExplicit() ? 3 : 1);
				else this.showPersonRandomRorX("US/polb7g", 1)
			}
			addPlaceTitle(md, getPoliceChief() + " Kerry Batton");
			md.write('<p>"So you want a bust darling," says Kerry. "You have come to the right place. Here, have some of these."</p>');
			startQuestions();
			addLinkToPlace(md, "return to the police reception", 168);
			addLinkToPlace(md, "exit the Police Station", 167);
			WritePlaceFooter(md);
			return true
		}
		return false
	};
	per.showPersonChat = function(bGeneral,
		md) {
		if (Place == 45 && whereItem(31) === 0 && perYou.isShot()) addQuestionC(md, "ask " + getPoliceChief() + " Batton for some help", "OfficerBatton", 9E3)
	};
	per.getPersonSMS = function(id) {
		if (id == 210) return receiveSMS("KerryBatton", perYou.getMaster() + "! It\u2019s Kerry! Leave now! Sofia is on her way home!");
		return ""
	}
}

function RepliesOfficerKhan(nR) {
	var myName = per.getYourNameFor();
	if (nR == 521) {
		per.charmed = 2;
		if (!isPlaceKnown("PoliceStation")) setPlaceKnown("PoliceStation");
		per.place = 168;
		if (isDavyDefeated()) {
			var perS = findPerson("Sarah");
			if (perS.place === 0) {
				perS.moveThem(1);
				movePerson("AdeleRoss", 16);
				setPersonFlag("AdeleRoss", 1)
			}
		}
		Place = 167;
		addComments('"As you wish, ' + myName + ".  I'll take you there in my police car.\"")
	} else if (nR == 522) {
		bChat = false;
		per.charmed = 10;
		Place = 168;
		per.place = 999;
		addComments(per.addPersonFace() +
			'"Whatever you want, my ' + myName + '. I have some evidence I could use to justify the arrest to the authorities."')
	} else if (nR == 530) {
		per.other = 1;
		addComments('<p>"There has been a crime here and we are surveying the area for evidence."</p>')
	} else if (nR == 531) {
		per.other = 2;
		addComments("<p>\"I'm sorry, I'm not at liberty to discuss an ongoing investigation.  Now, where were you at...\"</p>")
	} else if (nR == 1610) {
		addComments('"The Mayor sent you?" she says, looking you up and down.  "Not likely.  Now, as I was about to say.  Where were you at..."</p>');
		per.other = 3
	} else if (nR == 5310) {
		if (!isPlaceKnown("SacredClearing")) setPlaceKnown("SacredClearing");
		per.other = 11;
		addComments('<p>"Alright," says the ' + getOfficer(false) + '. "I\'ll clear everyone out."</p>');
		addComments("<p>She begins barking orders, and one by one the other " + getOfficer(false) + "s leave.</p>")
	}
	return true
}

function initialiseOfficerKhan() {
	addPerson("Officer Khan", 65);
	per.Replies = RepliesOfficerKhan;
	per.isPersonInfo = function() {
		return this.charmed > 0
	};
	per.getPersonInfo = function() {
		if (isMurderPath()) return "<img src='Images/Setting/pol13b.jpg' style='width:25%;float:right;margin:0 0 0 5px' alt='Khan'>" + getOfficer() + ' Khan welcomes you with  a salutation. You changed her pesky and irritating personality into a helpful, obedient one. She no longer wants to be top of the "food chain", she seems way more interested in you. She obediently helped you out clearing the investigation in the Gates manor even though she ' +
			(isMurderPath(true) ? "believes" : "knows") + " you killed Sir Gates. But she would never betray her " + perYou.getMaster() + ".</p>" + "<p>After her salutation, she unbuttons her uniform just until you can have a clear look at her cleavage. The second in command officer is happy to see you!";
		else return "<img src='Images/Setting/pol13b.jpg' style='width:25%;float:right;margin:0 0 0 5px' alt='Khan'>" + getOfficer() + ' Khan welcomes you with  a salutation. You changed her pesky and irritating personality into a helpful, obedient one. She no longer wants to be top of the "food chain", she seems way more interested in you. She even settled with doctors in the hospital that you can roam around in the building and have access to every room there. The way to visit Mrs Granger anytime you want is longer an issue to you.</p>' +
			"<p>After her salutation, she unbuttons her uniform just until you can have a clear look at her cleavage. The second in command officer is happy to see you!"
	};
	per.getPersonName = function(full) {
		return full !== true && this.charmed > 0 ? "Slave Cheryl" : getOfficer() + " Khan"
	};
	per.getPossessionFace = function() {
		return "Setting/pol9"
	};
	per.passTimeDay = function() {
		if (this.place == 1E3 && (getDay(true) == "Wed" || getDay(true) == "Sat")) this.place = 435;
		return ""
	};
	per.passTimeNight = function() {
		if (this.place == 435) this.place = 1E3;
		return ""
	};
	per.showPersonTextHere = function(md) {
		if (Place == 435 && this.isHere()) md.write("<p>You see " + getOfficer() + " Khan working out on one of the exercise machines.</p>")
	};
	per.showEvent = function() {
		if (Place == 213 && this.health == 99 && isMurderPath()) {
			this.health = 100;
			this.place = 168;
			md = WritePlaceHeader();
			this.showPerson("Setting/pol12-leaving.jpg");
			addPlaceTitle(md, "Discharging " + getOfficer() + " Khan");
			md.write("<p>Cheryl Khan is standing next to her bed and looks like she starting to get dressed. Starting as she is wearing little more than her underwear that is. She sees you and cries out,</p>" +
				'<p>"' + perYou.getMaster() + '! you are here to see me off! The doctors cleared me and I am returning back to work on the police force!"</p>' + "<p>She is looking happy and reasonably healthy and you congratulate her on her recovery. She finishes dressing and you walk with her out of the ward. She asks you to come and see her at the police station whenever you can.</p>");
			startQuestions();
			addLinkToPlace(md, "leave the ward", 214);
			WritePlaceFooter(md);
			return true
		}
		if (Place != 435) return false;
		var md;
		if (sType ==
			"charmkhan1") {
			md = WritePlaceHeader();
			this.showPerson("Setting/pol17.jpg");
			addPlaceTitle(md, getOfficer() + " Khan Under a Spell");
			md.write("<p>You cast the charm spell on the " + getOfficer(false) + ". She is confused by the new sensations " + "pulsing through her body, making her think of thoughts that defy her normally rather conservative sensibilities.</p>" + "<p>She stops working on the exercise machine,</p>" + '<p>"You are acting very suspiciously", she says in a tone suddenly quite lacking authority. "I am in charge here, please move along"</p>' +
				"<p>You are not about to do that, so you remind her this is a public place, a gym, after all. You then comment on how hot she is looking, from her exercise that is. She replies, sounding distracted,</p>" + '<p>"Yes, very hot...maybe I can rearrange my outfit a little. Please move along, nothing to see here"</p>' + "<p>You take a step to the side and she immediately ignores you, seeming to assume you have left. She starts to remove part of the gym clothes, sensuously wiping the sweat from her exposed skin. Quickly she has exposed a lot more skin than she probably intended. The spell is clearly influencing her.</p>");
			startQuestions();
			addLinkToPlaceO(md, "wait for the spell to take effect", 435, "type=charmkhan2");
			WritePlaceFooter(md);
			return true
		} else if (sType == "charmkhan2") {
			md = WritePlaceHeader();
			this.showPerson("Setting/pol18.jpg");
			addPlaceTitle(md, getOfficer() + " Khan Under a Spell");
			md.write("<p>You step closer to her and you can see the arousal of the spell is hitting her hard. She has stripped more of her gym clothes, ignoring the curious glances of a couple of the other gym members who have noticed. You decide it is best to keep this a little more private and ask her,</p>" +
				"<p>" + getOfficer() + '", can you please help me, there is something suspicious, let\'s move along over there", you know it is a lame approach but she is distracted by the spell. Barely keeping her outfit on she follows you to a more private area. You notice the other gym members looking at you enviously, but who cares about them, ' + getOfficer() + " Khan is now yours!</p>" + "<p>In the more private location she looks around uncertain, and letting her outfit mostly fall away,</p>" + '<p>"There is nothing to see here, nothing that needs my attention here".</p>');
			startQuestions("You decide to forget the subtlety:");
			addLinkToPlaceC(md, '"Yes there is, ' + (perYou.isMaleSex() ? "my cock" : "my pussy") + '"', 435, "type=charmkhan3");
			WritePlaceFooter(md);
			return true
		} else if (sType == "charmkhan3") {
			md = WritePlaceHeader(false, "td-left-large");
			this.place = 168;
			this.showPerson("Setting/pol19.jpg");
			addPlaceTitle(md, getOfficer() + " Khan Under a Spell");
			md.write("<p>You spread your legs.</p>" + "<p>Arousal crashes over " + getOfficer() + " Khan, causing her first climax as she runs her hands all over your body, tugging at your clothes.");
			if (perYou.isMaleSex()) md.write("<p>When your cock springs into view she loses all pretense that this is some sort of police business.  She looks up at you with lust in her eyes." + "<p>I order you to fuck my mouth, " + perYou.getPersonName() + ". Fuck it, make me your slut, your whore, your <i>slave</i>. I'll do anything you want me to do, just fuck my mouth.\"</p>");
			else md.write('<p>"Oh, you are so beautiful" she confesses. "I order you to screw me, ' + perYou.getPersonName() + ". Screw me so hard that I have to scream. Take me, make me your slut, your whore, your <i>slave</i>. I'll do anything you want me to do. Anything! Take me " +
				perYou.getMaster() + '. Please!"</p>');
			md.write("<p>Sometime later, you try decide what to do with your new slave, but she speaks up a little breathlessly,</p>" + '<p>"' + perYou.getMaster() + ' I am due back for a shift at the police station, may I leave?"</p>' + "<p>You decide it is probably best for her to go there for now, if nothing else having a slave police " + getOfficer(false) + " can always be useful!</p>");
			startQuestions();
			addLinkToPlace(md, "leave the gym", 37);
			WritePlaceFooter(md);
			return true
		}
		return false
	};
	per.showEventPopup = function() {
		if (sType !== "") return false;
		if (Place == 37 && this.place == 435 && nFromPlace == 435) {
			WriteComments("As you leave you notice " + getOfficer() + " Khan packing her gear to leave as well");
			if (this.isCharmedBy()) this.moveThem(168);
			else this.moveThem(1E3);
			return false
		}
		if (Place == 435 && this.isHere() && !this.checkFlag(1)) {
			showPopupWindow("A Familiar Woman", "<img src='Images/Setting/pol16.jpg' style='width:34%;float:right;margin-left:5px' alt='Officer Khan'>" + "You notice a woman working out on one of the machines, she looks familiar but for a moment you cannot place her. As you admire her, you recognise her as Ms. Khan. She used to live next door to your house. Your mother talked to her a lot back in the day and sometimes Ms Khan even visited your house for dinner. " +
				"From these visits you learned that she did not want to be an " + getOfficer() + " first, she was more interested in becoming a soldier. However, her dominant nature and harsh attitude made her realize that by becoming a police " + getOfficer(false) + " she could exercise her power over the people quicker and easier. So, yeah, your first impressions of her were not so good...she\u2019s and uptight and arrogant bitch who\u2019s hunger for power could only be matched by her heavenly body and appearance and it looks like she hasn\u2019t changed a bit. " +
				"She worked her way through the ladder and is now the right hand woman to " + getPoliceChief() + " Police Chief Batton.<br><br>" + "She must be working out here to maintain her fitness for the police force, and is so focused on this she does not appear to have noticed you.", 'setPersonFlag("OfficerKhan",1);dispPlace()');
			return true
		}
		return false
	};
	per.isPlaceImageRight = function() {
		if (this.place == 435 && this.isHere()) {
			SetRightColumnSize("large");
			return true
		}
		return false
	};
	per.showPlaceImageRight = function(md) {
		if (this.place ==
			435) this.showPerson("Setting/pol16.jpg")
	};
	per.handleItem = function(no, cmd) {
		if (no == 14 && cmd == 2) {
			if (Place == 435 && this.place == 435) {
				var bShielded = isSpellKnown("Shielded Charm");
				if (!isSpellKnown("Shielded Charm")) addComments("Don't cast the spell here. It is too public.");
				else CastCharmSpell("OfficerKhan", 435, 1, "type=charmkhan1");
				return "handled"
			}
			if (Place == 278)
				if (!isMurderPath() && !this.isCharmedBy() && checkPersonFlag("MrsGranger", 3)) {
					CastCharmSpell("OfficerKhan", 126, 1);
					return "handled"
				}
		}
		return ""
	}
}

function RepliesOfficerSmith(nR) {
	var perOS = per;
	var perD = findPerson("Diane");
	var myName = perOS.getYourNameFor();
	if (nR == 9301) {
		perOS.other = 2;
		if (checkPersonFlag("MrsGranger", 4)) addComments('<p>"The museum was a mess, ' + myName + '. After you were arrested we spent two hours scanning the place, gathering evidence."</p>');
		else addComments('<p>"The museum was a mess, ' + myName + '. After the guard shot Mrs Granger we spent two hours scanning the place, gathering evidence."</p>')
	} else if (nR == 9302) {
		perOS.other = 3;
		addComments('<p>"Oh yes, ' + myName + ".  The vase was found and placed in the museum's safe to prevent further disturbance.\"</p>")
	} else if (nR == 93100) {
		bChat = false;
		if (perOS.other < 100) {
			perOS.moveThem(168);
			perOS.other = 100;
			perD.other = 900;
			perD.health = 0;
			DAReturnItems();
			if (perYourBody.FindItem(9) === 0) PlaceI(9, 168);
			Place = 260;
			perYou.setArrested(0);
			if (whereItem(4) == 999) moveItem(4, 76);
			if (wherePerson("MrBeasley") !== 11) {
				movePerson("MrBeasley", 11);
				moveDavyToHotel1()
			}
			if (!perYou.checkFlag(8)) perYou.setFlag(8)
		}
		addComments(perOS.addPersonFace());
		addComments("<p>" + getOfficer() + " Smith pulls her gun out. Moving like a professional, she exits the jail. - ");
		addComments("Gun shots echo from the police station, women scream, then a soft sound of crying is heard from the office.</p>")
	} else if (nR == 93101) {
		bChat = false;
		if (perOS.other < 101) {
			perOS.other = 101;
			Place = 214
		}
		WaitHereOnly(6);
		perOS.place = 213;
		perOS.health = 60;
		WriteCommentsHeader();
		addComments('<img src="Images/ambulance.png" style="float:left;width:20%;margin:0 10px 1em 0" alt="ambulance" title="ambulance">' +
			"<p>You call for an ambulance, which arrives within minutes.</p>" + "<p>Feeling responsible for your slave's condition you travel with her to the hospital.</p>")
	} else if (nR == 1E3) {
		perD.place = 261;
		addComments('<p>"Yes, I will tell her you have some vital information to confess", and Becky leaves. A little while later she returns with ' + getProsecutor() + " White who demands you quickly tell her your information.</p>")
	} else if (nR == 1001) {
		perD.place = 168;
		addComments("<p>Angrily " + getProsecutor() + " White turns her back on you and stomps out of the room.</p>")
	}
	return true
}

function initialiseOfficerSmith() {
	addPerson("Officer Smith", 261);
	per.Replies = RepliesOfficerSmith;
	per.getPersonName = function(full) {
		return full !== true && this.isCharmedBy() ? "Slave Becky" : getOfficer() + " Rebecca Smith"
	};
	per.getPossessionFace = function() {
		return "polg-face"
	};
	per.showEvent = function() {
		var md;
		if (Place == 213 && this.health == 99) {
			this.health = 100;
			this.place = 261;
			md = WritePlaceHeader();
			this.showPerson("polg7-leaving.jpg");
			addPlaceTitle(md, "Discharging " + getOfficer() + " Smith");
			md.write("<p>Becky Smith is standing next to her bed and looks like she starting to get dressed. Starting as she is wearing little more than her underwear that is. She sees you and cries out,</p>" +
				'<p>"' + perYou.getMaster() + '! you are here to see me off! The doctors cleared me and I am returning back to work on the police force!"</p>' + "<p>She is looking happy and reasonably healthy and you congratulate her on her recovery. She finishes dressing and you walk with her out of the ward. She asks you to come and see her at the police station whenever you can.</p>");
			startQuestions();
			addLinkToPlace(md, "leave the ward", 214);
			WritePlaceFooter(md);
			return true
		}
		if (Place != 261) return false;
		if (sType == "beckystrip") {
			md =
				WritePlaceHeader();
			this.showPerson("polg6.jpg");
			addPlaceTitle(md, getOfficer() + " Rebecca Smith");
			md.write("<p>Becky pretends to lock herself in the cell. " + "&quot;Oh take me " + perYou.getMaster() + ", &quot; she begs. &quot;Make me do those nasty, disgusting things. Make me your bitch.&quot;</p>");
			startQuestions();
			addLinkToPlaceC(md, "talk more with Becky", 261);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "charmbecky1") {
			md = WritePlaceHeader();
			this.showPerson("polg2.jpg");
			addPlaceTitle(md, getOfficer() + " Smith Under a Spell");
			md.write("<p>You cast a charm spell at the cop. She staggers as the magic takes effect.</p>" + "<p>Taking advantage of her weakness you order her to unlock the cell door. Unable to control her actions, she unlatches the lock.</p>" + '<p>"I don\'t know why I\'m doing this" she says. "Wait...I do know you...Do I?!"</p>' + '<p>She tries to reason what is going on. "You are ' + perYou.getPersonName() + '! From school!," ' + "she says, arousal coursing through her body. " + '""You know me...I\u2019m Becky. I went to the same school as you did!""</p>');
			startQuestions();
			addLinkToPlaceC(md, "order Becky to strip", Place, "type=charmbecky2");
			if (!perYou.isArrested()) addLinkToPlace(md, "exit the jail?", 168);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "charmbecky2") {
			md = WritePlaceHeader();
			this.showPerson("polg3.jpg");
			addPlaceTitle(md, getOfficer() + " Smith Under a Spell");
			md.write("<p>Becky begins to remove her clothes. She says, &quot;I suppose that, if you insist, " + "then I have to follow orders. A good " + getOfficer() + " always does " + "what she is told. Let me show you how we do a strip search in the police force.&quot;</p>" +
				"<p>She momentarily loses her speech as a wave of pleasure makes her body shudder.</p>");
			startQuestions();
			addLinkToPlace(md, "take Becky", Place, "type=charmbecky3");
			if (!perYou.isArrested()) addLinkToPlace(md, "exit the jail?", 168);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "charmbecky3") {
			md = WritePlaceHeader(false, perYou.isMaleSex() && !isExplicit() ? "" : "td-left-large");
			if (perYou.isMaleSex()) this.showPersonRorX("polg4b.jpg");
			else this.showPerson("polg4b.jpg");
			addPlaceTitle(md, getOfficer() + " Smith Under a Spell");
			md.write("<p>You enjoy the pleasures Becky's body has to offer. You learn about her fantasies of " + "being controlled by a dominant " + perYou.getManWoman() + " and you swear to her that you are the " + perYou.getMaster() + " she has been waiting for all her life.</p>" + "<p>Becky reacts excitedly by declaring her undying loyalty " + "as your devoted slave...  between barely-muffled moans of pleasure, of course.</p>" + "<p>Her fitness is superb and her body seems insatiable as her sexual energy reaches multiple climaxes.</p>" +
				"<p>Unable to control herself, Becky cries out a loud moan. From the police station " + "office you hear someone call out, &quot;Is everything alright in there Rebecca?&quot;</p>");
			startQuestions();
			addLinkToPlace(md, "talk more with Becky", 261);
			if (!perYou.isArrested()) addLinkToPlace(md, "exit the jail?", 168);
			WritePlaceFooter(md);
			return true
		}
		return false
	};
	per.showPersonChat = function(bGeneral, md) {
		if (Place != 168 || sType !== "") return;
		if (this.other == 100) addQuestionC(md, "call an ambulance for " + getOfficer() + " Smith",
			"OfficerSmith", 93101)
	};
	per.handleItem = function(no, cmd) {
		if (no == 32 && cmd == 1) {
			if (this.isHere() && this.isCharmedBy()) {
				examineSilverRingStart();
				addComments("<p>It seems to be reacting to Becky's presence... getting warmer the closer you get.</p>" + "</td></tr></table>");
				return "handled"
			}
		} else if (no == 14 && cmd == 2)
			if (Place == 261)
				if (wherePerson("Diane") != 261) {
					CastCharmSpell("OfficerSmith", Place, 1, "type=charmbecky1");
					return "handled"
				}
		return ""
	}
}

function RepliesPamela(nR) {
	var pCharm = per.isCharmedBy();
	var myName = per.getYourNameFor();
	if (nR == 13901) {
		per.setFlag(2);
		if (!pCharm) addComments('<p>"Well, ' + myName + ', as you can see," she says gesturing towards the stone wall next to her,</p><p>"I am the grounds keeper here.  I maintain the gardens along the walls and within the grounds of the church."  She smiles at you warmly.  "My my, but aren\'t you a curious one."</p>');
		else addComments('<p>"My duties were once to maintain the grounds along the walls and within the grounds of the church, ' +
			myName + ', but that was of course before you cured me of my disease and showed me my true purpose," she says, lust flaring in her eyes as she runs her hand along her bare breast.</p><p>"I used to pour all I had into maintaining the gardens within...  now I pour all that I have into pleasuring my one, true ' + myName + '."')
	} else if (nR == 15102)
		if (!pCharm) {
			addComments('<p>"Another way in?  Why?  Did Mother Superior stop your explorations?" she says with a glint of mirth.</p><p>"Forgive her if she is overprotective of our lovely church."  With that she goes back to her trimming, completely dismissing the matter.  You stand there for a moment dumbstruck - then you realize she never really answered your question.');
			per.setFlag(3)
		} else {
			addComments('<p>"Of course ' + myName + ', I owe you my life and will repay that debt any way that I can." She casts her eyes downward as she turns to lead you through a small gate hidden within the wall, opening it with an old skeleton key.');
			setPlaceKnown("ChurchSecretDoor");
			Place = 319
		}
	else if (nR == 18305) {
		var perS = findPerson("Desiree");
		perS.setQuestRelic(10);
		addComments("<p>\"I'm sorry, " + myName + ".  I wouldn't know anything about that.  You may need to ask one of the Nuns.  I do know that Mother Superior is very protective of <i>something</i>...  Perhaps that is what she's been hiding.\"</p>")
	} else if (nR ==
		18335) {
		var perD = findPerson("Desiree");
		perD.setQuestRelic(36);
		if (!pCharm) addComments("<p>\"That's kind of you to offer, but I'm sure she will recover on her own.  For now she has decided it best to take some time off and rest.\"</p>");
		else addComments('<p>"I knew you would be willing to help, ' + myName + '!" She says, absently running her hands over her body at the though of your <i>help</i>.  "She has told everyone that she is taking some time to recover.  Could you heal her as well?" She asks lustfuly. "It would mean so much to those of us here..."</p>');
		if (!checkPersonFlag("Daria", 4)) setPersonFlag("Daria", 4)
	} else if (nR == 100) {
		per.setFlag(17);
		addComments('<p>"You are in luck, he is due back tomorrow morning. Until then you can ' + (pCharm ? "spend the night with me" : "sleep on my couch") + " and I'll ask him in the morning to give you a lift.")
	} else if (nR == 101) {
		per.setFlag(17);
		per.setFlag(16);
		addComments("<p>\"Well there are regular deliveries made to the church and I also get the occasional package. I know the driver and can probably ask him to give you a lift back to town. He won't be here until tomorrow morning but you can " +
			(pCharm ? "spend the night with me" : "sleep on my couch") + " and I'll ask in the morning.\"")
	}
	return true
}

function initialisePamela() {
	addPerson("Pamela", 326, "Pamela");
	per.Replies = RepliesPamela;
	per.getPersonName = function(full) {
		if (full === true) return this.name;
		if (!this.checkFlag(1)) return "the Grounds Keeper";
		return this.isCharmedBy() ? "Slave Pamela" : "Pamela, Garden Caretaker"
	};
	per.isPersonInfo = function() {
		return true
	};
	per.getPersonInfo = function() {
		var s = "<img src='Images/People/Pamela/pamela0.jpg' style='width:40%;float:right;margin:0 0 0 5px' alt='Pamela'>";
		if (this.isCharmedBy()) return s + "Pamela is no fairy as it turned out. She doesn\u2019t even know anything about the magic world nor the necklace she was wearing! However, her soft and calm nature makes you feel at home when you visit her. She\u2019s always bringing some kind of gift to you whenever you go to her shed, let it be sweets, small toys or some fine wine. Actually, she told you about a monk who makes his own wine. It\u2019s a small business, mostly related to the church and it\u2019s fold, but it\u2019s quite tasty and cheap so Pamela always have some in her larder stored away just for you!<br><br>" +
			'She is greeting you into her place at the moment, the mentioned bottle of wine on the table, waiting for you to consume it or you could taste your slave\u2019s other, sweet "offerings"!';
		else return s + "Pamela, the red haired girl in front of you is the gardener of the church."
	};
	per.getPersonAddress = function() {
		return this.checkFlag(1) ? "Groundskeeper Cottage, Church grounds" : ""
	};
	per.passTimeDay = function() {
		if (this.checkFlag(17)) {
			this.setFlag(17, false);
			if (isAtLocation(317)) return "In the distance you hear a van, and realise you must of missed the delivery van Pamela talked about"
		}
		return ""
	};
	per.showEventPopup = function() {
		if (sType == "vanlift") {
			this.setFlag(17, false);
			showPopupWindow("An awkward lift", "<img src='Images/van.jpg' style='float:right;width:45%;margin-left:5px' alt='Van'><p>" + (this.isCharmedBy() ? "You spend the night in Pamela's arms" : "You spend the night on Pamela's couch") + " and share a simple but tasty breakfast. Pamela then tells you it is almost time and you step out and wait for a little while.</p> " + '<p>A white delivery van arrives and Pamela walks over and had a brief chat with the driver and the tells you it is ok and to get in the passenger seat. As you approach she quickly steps over and whispers to you, "Don\'t be offended, he is quite shy"<p>' +
				"<p>She was not kidding, during the ride the driver barely looks at you and says nothing. After what feels like a long drive you arrive at the TV Station, and he haltingly asks you to get out.<p>" + "<p>You do and he nervously gestures, a wave? Immediately he drives into some staff only service area.</p>");
			return true
		}
		if (Place == 320 && !this.checkFlag(4) && isDay() && nFromPlace != 326) {
			this.setFlag(4);
			showPopupWindow(this.checkFlag(1) ? "Pamela working" : "Groundskeeper", this.addPersonString("pamela-working1.jpg",
				"height:max%", "right") + "You see an old wagon or cart and " + (this.checkFlag(1) ? "Pamela is working on it" : "a young woman is working on it") + " probably to set it up as a sort of display piece. She is climbing over it and unintentionally gives you a clear view up her skirt. She notices your glance and starts and as she does appears to catch her top on a wooden railing, tearing her clothing.</p>" + "<p>She shakes her head and gives you an embarrassed wave and walks over to the small shed to change into some spare clothes.</p>");
			return true
		}
		return false
	};
	per.showEvent = function() {
		var md;
		if (Place == 269 && sType == "pamelapool") {
			WaitHereOnly(6);
			md = WritePlaceHeader();
			this.showPerson("pamela-pool.jpg");
			addPlaceTitle(md, "Swimming with Pamela");
			md.write("<p>Pamela arrives, dressed in a bikini, and you have a pleasant swim together.</p>");
			startQuestions();
			addLinkToPlaceC(md, "it is fairly private here...", Place, "type=pamelapoolsex");
			addLinkToPlaceC(md, "say goodbye to Pamela", Place);
			WritePlaceFooter(md);
			return true
		}
		if (Place == 269 && sType ==
			"pamelapoolsex") {
			md = WritePlaceHeader();
			this.showPerson("pamela-pool-sex.jpg");
			addPlaceTitle(md, "Being Discrete and Private with Pamela");
			md.write("<p>You ask Pamela to play with you more privately, and she seductively removes most of her swimsuit and lies back waiting for you.</p>");
			startQuestions();
			addLinkToPlaceC(md, "later...say goodbye to Pamela", Place);
			WritePlaceFooter(md);
			return true
		}
		if (Place != 326) return false;
		if (sType == "charmpamela1") {
			this.setFlag(3, false);
			md = WritePlaceHeader();
			this.showPerson("pamela2.jpg");
			addPlaceTitle(md, "Groundskeeper Pamela Under a Spell");
			md.write('<p>The Groundskeeper turns to you as a sly smile begins to cross her face.  "I\'m sorry, what did you just say?" she asks.');
			if (!this.checkFlag(1)) {
				this.setFlag(1);
				md.write(' "My name is Pamela, by the way. Its...  nice...  to meet you." She stammers.')
			}
			md.write('</p><p>"Me?  Just now?" you ask, pretending to not know what she was talking about.</p>' + '<p>"Yes..." she says, as you hear her gulp back the rising desire flowing through her. ' +
				'"Just...  now..." she finally gets out.</p>' + "<p>You pause for a moment, allowing the spell to strengthen its hold over her as you decide " + "what to say next.</p>");
			startQuestions();
			addLinkToPlaceC(md, '"Oh, I was just asking if you were feeling all right...  Your face seems a bit...<i>flushed</i>."', Place, "type=charmpamela2");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "charmpamela2") {
			md = WritePlaceHeader();
			this.showPerson("pamela3.jpg");
			addPlaceTitle(md, "Groundskeeper Pamela Under a Spell");
			md.write('<p>"You do seem to be getting rather <i>hot</i>," you say to her suggestively.  "Those clothes aren\'t ' +
				'too restrictive are they?"</p>' + '<p>"What, these?" she asks, lowering her shirt and fanning her breasts.  "No, ' + 'these clothes are usually rather cool.  They help me to keep from overheating while I work."</p>' + '<p>Then a flash of inspiration hits you.  "Wait.  You\'re the gardener right?" you ask, suddenly very concerned.</p>' + '<p>"Yes, why?" she says, the urges coursing through her causing her to become very confused.</p>' + '<p>"Its just that I had heard of an illness that has only recently been discovered," you say, lying through your ' +
				'teeth and enjoying the effect your presence is having on your new plaything.  "Its symptoms include an increase ' + 'in body temperature,  flushing of the skin, and the sudden onset on extreme sexual desire."</p>' + '<p>"You <i>are</i> feeling these things, <b>aren\'t</b> you, Pamela," you say, more of a statement than a question.</p>');
			startQuestions();
			addLinkToPlace(md, "wait for her to answer you", Place, "type=charmpamela3");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "charmpamela3") {
			md = WritePlaceHeader();
			this.showPerson("pamela4.jpg");
			addPlaceTitle(md, "Groundskeeper Pamela Under a Spell");
			md.write('<p>"Yes," she says, "Oh yes!"  She pushes her arms together, jutting out her delicious ' + 'chest for you to gaze at.  "An illness?  How could I have caught it? ' + 'Is there a cure? Can you help me?" she cries, quickly losing hope as the spell rages through her body.</p>' + '<p>You give her a moment, letting the feelings and doubts simmer within her mind.  "There ' + "<i>is</i> a cure... but I'm not sure you'll like it. Of course, if you don't let me help you, " +
				'the alternative could be even worse," you say, feigning concern as best ' + "you can given the effect her desire is having on your own.</p>" + '<p>"No, tell me!  Anything!" she cries through tightly sealed eyes and barely suppressed moans as a ' + "small reflection lets you know that her tears are starting to fall. " + "Whether tears of fear or of pure lust you're not sure.</p>" + '<p>"Well..." you pause for dramatic effect.  "There is only one cure.  You must have sex with someone. ' + 'And you must do so <i>very</i> quickly - otherwise it could be too late."</p>' +
				'<p>"But there is a catch," you say, sinking in your hooks.  "While it <i>will</i> cure the ' + "disease, it will also bind you to the person who cured you.  You will be their... well, for lack " + 'of a better term, <i>Slave</i>. Completely unable to resist their slightest command." ' + "You aren't sure if your attempt at feigning concern is working " + "anymore - but then again you're not sure if Pamela is in any condition to be able to tell the difference\teither.</p>");
			startQuestions();
			addLinkToPlaceC(md,
				'"Do you want me to help you, Pamela?"', Place, "type=charmpamela4");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "charmpamela4") {
			md = WritePlaceHeader();
			this.showPerson("pamela5.jpg");
			addPlaceTitle(md, "Groundskeeper Pamela Under a Spell");
			md.write("<p>She takes only a moment before she turns to you and, with pure lust in her eyes, begs you to take her.</p>" + '<p>"You are sure," you ask, keeping her at arm\'s length as the tries to pull you against her.  "You <i>want</i> ' + 'me to take you, knowing full well that you will become my slave?" ' +
				'- - "Yes," she says, trying to kiss you.</p>' + '<p>"You know that it will leave you completely unable to resist me?  Leave you as little more than a object that ' + 'I could use in <i>any</i> way that I want?" ' + '- - "Yes," she says, more in earnest as she begins pulling off your clothes.</p>' + '<p>"And you will submit yourself to me?  Willingly, knowing that it was <i>your</i> choice?  Your choice to ' + "become my plaything, my pet, my loyal slave.  Devoted to me and my <i>desire</i> above all other things in " +
				'your life?" you ask, no longer even attempting to hide the devilish smile from your face or your voice. ' + '- - "YES!" she cries out. "Cure me!  Claim me!  Take me!  I am yours!"</p>' + '<p>"Please...  ' + perYou.getMaster() + '," she pleads, submitting to slavery before you ' + 'even begin to "cure" her.  The act of which you find exceptionally pleasurable as she releases all the pent up ' + "sexual energy that she had been collecting during her service at the church.</p>" + '<p>"You are <i>mine</i> now," you say as she lies beneath you... ' +
				'to which she simply replies "Yes, ' + perYou.getMaster() + ', oh yes..."</p>');
			startQuestions();
			if (!isPlaceKnown("ChurchSecretDoor") && checkPlaceFlag("Church", 7)) addQuestionC(md, '"Show me how you get into the church, Slave."', "Pamela", 15102);
			addLinkToPlaceC(md, "talk to Pamela some more", 326);
			addLinkToPlace(md, "walk back around to the Church doors", 317);
			WritePlaceFooter(md);
			return true
		}
		return false
	};
	per.showPersonChat = function(bGeneral, md) {
		if (sType === "" && Place == 326 && this.isHere()) {
			var perSister = findPerson("Desiree");
			if (!this.checkFlag(1)) addPopupLinkC(md, "introduce yourself to the young lady", "Pamela, the groundskeeper", "<img src='Images/People/Pamela/pamela0.jpg' style='width:35%;float:right;margin:0 0 0 5px' alt='Pamela'>" + "You assume that red haired girl in front of you is the gardener of the church, because of the equipments around her place. She doesn\u2019t talk much and has a shy personality, but she\u2019s quite the looker! Her vixen red hair only enhances her compelling face. The green make up around her eyes and the clothes she sports reminds you of fairies from the old tales. Maybe she is one? Who knows? You\u2019ve seen witches, warlocks and demons, so God knows what kind of creatures are there in the big world. You can never be sure!<br><br>" +
				'"Nice to meet you, ' + perYou.getPersonName() + ', my name is Pamela," she says, brushing a little dirt off of her hands.<br><br>' + '"We don\'t get too many visitors out here. What brings you to our lovely little piece of heaven?"<br><br>' + "You do not say it, but you would think that Pamela is the most lovely thing you have seen here, and she is heaven in your eyes. Pickup lines aside, she seems genuinely friendly and sweet.<br><br>" + "You do notice her necklace, at first glance a simple piece of costume jewelery, but you see it is actually made of semi-precious stones",
				false, "setPersonFlag('Pamela', 1);dispPlace();");
			else if (this.checkFlag(1) && !this.checkFlag(2)) addQuestionC(md, '"And what do you do around here?"', "Pamela", 13901);
			else if (perSister.getQuestRelic() == 5) addQuestionC(md, '"Where is the Relic this church protects?"', "Pamela", 18305);
			if (perSister.getQuestRelic() == 35 && perSister.whereNow() === 332) addQuestionC(md, '"Tell me what happened, perhaps I can help."', "Pamela", 18335);
			if (this.checkFlag(1) && this.checkFlag(2) && !isPlaceKnown("ChurchSecretDoor") && checkPlaceFlag("Church",
					7))
				if (this.isCharmedBy()) addQuestionC(md, '"Show me how you get into the church, Slave."', "Pamela", 15102);
				else if (!this.checkFlag(3)) addQuestionC(md, '"Pamela, do you know of any other way to get into the church?"', "Pamela", 15102);
			if (this.isCharmedBy()) {
				addLinkToPlaceC(md, '"You aren\'t feeling any symptoms again, are you?"', 327, "type=curepamela");
				if (!this.checkFlag(17)) addSleepLink(md, "ask Pamela to spend the night", "", "<p style='position:absolute;top:3%;left:25%;width:65%;cursor:pointer;margin-top:-12px;font-size:x-large;color:black;text-shadow:-1px 0px white, 0px 1px white, 1px 0px white, 0px -1px white'><b>Sleeping over with Pamela</b></p>" +
					'<p style="position:absolute;left:20%;top:5%;cursor:pointer;font-size:1.1em;width:65%;color:black;text-shadow:-1px 0px white, 0px 1px white, 1px 0px white, 0px -1px white">You ask Pamela about spending the night, to help care for her.<br>' + "Pamela is a little embarrassed but agrees a little coyly. A little later as she is waiting for you to join her in bed you could no longer call her coy!", this.getImg("pamela-bed1.jpg"))
			}
			if (perYou.isStuck() && this.checkFlag(1))
				if (this.checkFlag(17)) addOptionLink(md,
					"kill time and then spend the night until the delivery van arrives", "sleepForNight(359,'','type=vanlift')");
				else if (this.checkFlag(16)) addQuestionC(md, '"Pamela, is that delivery van due again sometime?"', "Pamela", 100);
			else addQuestionC(md, '"Pamela, do you know a way to get back to town, I am out of money?"', "Pamela", 101)
		}
	};
	per.handleItem = function(no, cmd) {
		if (no == 14 && cmd == 2)
			if (Place == 326 && this.isHere()) {
				CastCharmSpell("Pamela", Place, 1, "type=charmpamela1");
				return "handled"
			}
		return ""
	};
	per.isPhoneable = function() {
		return checkPlaceFlag("Hotel",
			11) && Place == 269 && this.isCharmedBy()
	};
	per.callThem = function() {
		if (Place == 269) {
			gotoPlace(Place, "type=pamelapool");
			receiveCall("", "You call Pamela to invite her to join you at the pool for a swim, and she answers that she would love to and will call a taxi and be there shortly.");
			WriteCommentsFooter(bChat, bChatLeft)
		}
	};
	per.addPersonPhoneCall = function() {
		if (this.hoursCharmed() > 24 && !this.checkFlag(15))
			if (makeCall(true, 151)) this.setFlag(15);
		return false
	};
	per.getPersonSMS = function(id) {
		if (id == 151) return receiveSMS("Pamela",
			"I was just thinking of you, I may be feeling the symptoms again. Please visit me", "pamelasms1.jpg");
		return ""
	}
}

function visitSarah(md) {
	var perS = findPerson("Sarah");
	if (perS.other == 1E3) return;
	var perVamp = findPerson("Vampyre");
	if (isCharmedPath())
		if (perS.place == 192 && (perS.other == 114 || perS.other == 117 || perS.other == 120))
			if (md === undefined) gotoPlace(192, "type=laurenattending");
			else addLinkToPlaceC(md, "visit Sarah", 192, "type=laurenattending");
	else if (perVamp.isCharmedBy("Sarah") && !perS.checkFlag(8) && !perS.checkFlag(2) && perVamp.hoursCharmed("Sarah") > 36 && !isDay())
		if (md === undefined) gotoPlace(299);
		else addLinkToPlaceC(md,
			"visit Sarah", 299);
	else {
		if (perS.other > 109)
			if (md === undefined) gotoPlace(192);
			else addLinkToPlaceC(md, "visit Sarah", 192)
	} else if (perVamp.isCharmedBy("Sarah") && !perS.checkFlag(8) && !perS.checkFlag(2) && perVamp.hoursCharmed("Sarah") > 36 && !isDay())
		if (md === undefined) gotoPlace(299);
		else addLinkToPlaceC(md, "visit Sarah", 299);
	else if (md === undefined) gotoPlace(192);
	else addLinkToPlaceC(md, "visit Sarah", 192)
}

function RepliesSarahGates(nR) {
	var bCharm = per.isCharmedBy();
	var myName = per.getYourNameFor();
	var ret = true;
	if (nR == 100) {
		per.setFlag(5);
		if (nMoney < 100) {
			AddCash(50);
			addComments('"I can help out my ally, but only a certain amount, I may have more tomorrow"')
		} else addComments('"Sorry Uncle Ronny controls the finances, I have a fund I can use but only so much per day and today I have noting much left."')
	} else if (nR == 666) {
		addComments('"' + myName + ' I do not consort with demons, I have studied them a little but they are too difficult to deal with. While some can work out bargains with them it is always at a terrible cost."</p>' +
			'<p>She heitates, "There was a <i>woman</i> who once met with Uncle Ronnie". You can hear the comtempt in her voice. "She was a skilled demonologist, and was not yet a demon-slave. She knew much of them and wanted to trade with Uncle Ronnie. He refused, I am not sure why, he seemed embarrassed."</p>' + "<p>You ask more about this woman, and he answers,</p>" + "<p>\"She called herself Mistress Jade, apparently she is based out of a 'gentlemens club' in town. I have no idea where that place is, I did not know there was one here in Glenvale, try asking someone else where it is.\"</p>" +
			"<p>Strange, you have never hear of such a club in town either, it must be very private!</p>");
		perGates.setFlag(6)
	} else if (nR == 2901) {
		per.other = 2;
		addComments('"What! You couldn\'t have. Uncle Ronny can not be killed by any mere mortal."<br>')
	} else if (nR == 2902) {
		per.other = 5;
		addComments('"Another detective. Well go back to your ' + getPoliceChief() + ' or whoever he is and tell him that I want the murderer found and locked up."<br>')
	} else if (nR == 2905) {
		per.other = 10;
		addComments('"I hardly think so," she says defiantly.  "I am staying right here.  Tell your men to do their own duty. Leave me alone."<br>')
	} else if (nR ==
		2903) {
		per.other = 10;
		addComments('<p>"Because Uncle Ronny was a great warlock. Only another warlock, one of immense power, could defeat him and then only when he does not hold the blue crystal. You are only a stupid teenager."</p>')
	} else if (nR == 2904) {
		per.other = 3;
		addComments("You describe how you saw the people who killed him,</p>" + "<p>\"What! They couldn't have. Uncle Ronny can not be killed by any mere mortal. I heard a police " + getOfficer(false) + ' mention your name as a suspect, but you are just an ordinary mortal too."')
	} else if (nR ==
		2906) {
		per.other = 10;
		addComments('<p>"Because Uncle Ronny was a great warlock. Only another warlock, one of immense power, could defeat him and then only when he does not hold the blue crystal. Those people sound just like burglars, and you are only a stupid teenager."</p>')
	} else if (nR == 2801) {
		if (isConspiracyPath()) addComments('"Of course ' + myName + ' this is our agreement and alliance.  "');
		else addComments('"Of course ' + myName + ". I am so pleased to be able to serve you like this.  This was something my Uncle gave to me.  All you need do is translate this message.  Forgive me " +
			myName + ', I was never able to do so myself."');
		if (!isRunes()) Place = 212;
		else {
			Research("Spell", "TuoDuo");
			ret = false
		}
	} else if (nR == 2802) {
		if (isConspiracyPath()) addComments('"Of course, ' + myName + '"');
		else addComments('"Of course, ' + myName + '.  I only wish I could help more..."');
		if (!isRunes()) Place = 212;
		else {
			Research("Spell", "TuoDuo");
			ret = false
		}
	} else if (nR == 999) {
		if (!bCharm) {
			if (checkPersonFlag("AmyRoss", 1)) moveItem(4, 998);
			else moveItem(4, 76);
			addComments('"Are you the thief who stole my uncle\'s book?" asks Sarah. "I would never give it to you, even if I did have it."<br>')
		} else if (checkPersonFlag("AmyRoss",
				1)) {
			moveItem(4, 192);
			addComments('"Oh ' + myName + ", I am glad you're okay! The book was returned to me by the police, here it is!\"");
			return "refresh"
		} else {
			moveItem(4, 76);
			addComments('"Oh ' + myName + ", I am glad you're okay! But the book?  Miss White mentioned something about finding it but it wasn't with the other things they brought from the hospital.\"")
		}
		if (wherePerson("MrBeasley") !== 11) {
			movePerson("MrBeasley", 11);
			moveDavyToHotel1()
		}
	} else if (nR == 2910) {
		addComments('"Part of the reason I came to town, ' +
			myName + '.  There is... <i>something</i> out there.  Something I will have to take care of myself," she says ominously.');
		if (isConspiracyPath())
			if (perYourBody.FindItem(4) === 0) addComments('</p><p>"If you had only brought the book...  I\'m afraid without it I am doomed to failure."');
			else addComments(' A look of inevitable defeat crosses her face until she notices your backpack.</p><p>"You have the book here!?! Quickly, give it to me!  It\'s dark, and it could be here soon."');
		else if (perYourBody.FindItem(4) ===
			0) addComments('</p><p>"If only I had the book...  I\'m afraid without it I am doomed to failure."');
		else addComments(' A look of inevitable defeat crosses her face until she notices your backpack.</p><p>"What do you have there? The book!?! Quickly, give it to me!  It\'s almost dark, then it will be too late."');
		if (per.other == 10) per.other = 11;
		setPersonOther("Vampyre", 1)
	} else if (nR == 1301) {
		setPersonOther("Vampyre", 50);
		addComments('"Night is the time when the undead rise from the sacred clearing." She says, then continues quickly when she noticed your obvious disbelief.')
	} else if (nR ==
		1350) {
		setPersonOther("Vampyre", 51);
		addComments('"Thank you. Now we must prepare for the onslaught. Please wait here with me."<br>')
	} else if (nR == 1351) {
		if (isDay()) {
			setPersonOther("Vampyre", 51);
			addComments('"No it will come for me tonight. Now we must prepare for the onslaught. Please wait here with me."')
		} else {
			setPersonOther("Vampyre", 50.5);
			AddCash(25);
			addComments('"Well I think we are safe tonight but only tonight. Please return here tomorrow, do not forget!" She then hands you some money and tells you, "So you can get anything you need to help"')
		}
		PlaceI(5,
			141)
	} else if (nR == 11200) {
		setPersonFlag("Lauren", 1);
		PlaceI(40, 0);
		addComments('"Of course, ' + myName + ".  Sit back and relax while I call the maid to open the bottle.  I'm sure you'll find her... delicious.\"")
	} else if (nR == 901)
		if (isConspiracyPath()) {
			perYou.setQuestAftane(5);
			addComments('"Oh yes, ' + myName + '! My uncle keeps it in the safe. He has the key hidden somewhere I cannot find"</p>')
		} else if (bCharm) {
		perYou.setQuestAftane(5);
		addComments('"Oh yes, ' + myName + "! My uncle left a note for me in the event of his death.  It mentioned the Aftane, but I'm afraid I couldn't open the safe.  I'm sorry, " +
			myName + ', please forgive me." She grovels.</p>')
	} else {
		perYou.setQuestAftane(3);
		addComments('"The Aft..." She asks, quite surprised that you would know of such things.  "I... I have no idea what you\'re talking about.  And neither do you.  I suggest you never bring up such a thing again!" Something about that question seems to have reminded her of a subject she would rather not think about.</p>')
	} else if (nR == 905) {
		addComments('<p>"Oh yes, ' + myName + '!  Follow me."</p>');
		Place = 191
	} else if (nR == 5904)
		if (!bCharm) {
			addComments('<p>"A little... what?" She asks, her temper flaring for a moment.  "And why would I tell you about anything like that?"</p>');
			perDavy.setQuestBlueBottle(5)
		} else {
			addComments('<p>"A little blue bottle, ' + myName + '?" She asks, thinking for a moment.  "Oh yes!" She says, running off and quickly returning with something in her hand.  "Here you are, ' + myName + ', please take it.  Is there... anything <i>else</i> you would like?"</p>');
			perDavy.setQuestBlueBottle(9);
			PlaceI(33)
		}
	else if (nR == 3E3) {
		setPersonFlag("Ghost", 11);
		addComments("You ask Sarah about ghosts and what keeps them tied to a particular place, and if they can move from that place,</p>" +
			'<p>"Well ' + myName + ' are you having problems with a simple ghost, they are almost always harmless, unless you are in a Place of Power?"</p>' + "<p>You explain a little about Nurse Keana and wanting to free her from the hospital basement, but not anything more. Sarah immediately answers,</p>" + '<p>"It is trivially easy as long as you have a magical tie to them. Either an item of personal importance or a magical binding or a link of other sort. If you do, take them by the hand, and lead them where-ever you desire and keep them there until dawn. The following night they will be there again and will stay there. In some cases you may need to repeat, but mostly they will stay."')
	}
	return ret
}

function initialiseSarah() {
	addPerson("Sarah");
	per.Replies = RepliesSarahGates;
	per.getPersonName = function(full) {
		return full !== true && this.isCharmedBy() ? "Slave Sarah" : "Sarah Gates"
	};
	per.getPossessionFace = function() {
		if (this.isCharmedBy()) return "sarah9b";
		return "sarah9a"
	};
	per.isPersonInfo = function() {
		return this.isCharmedBy()
	};
	per.getPersonInfo = function() {
		return this.addPersonString("sarah6.jpg", "height:max%", "right") + "The richest gal in town is officially yours to command! Now the Gates family will not be standing in your way, " +
			perGates.getPersonName() + " is dead and Sarah is your plaything. Things couldn\u2019t have turned out better than this.<br><br>" + "Sarah is such a complex person, just by the brief, sex filled encounters with her makes you realise that she has two sides; a soft, charming one and a dominant, power hungry one. She even managed to enslave her maid, Lauren without mind control or any other magic spells. She briefly told you about some kind of blackmailing going on, but you don\u2019t remember. You were busy fucking her brains out!"
	};
	per.getPersonAddress = function() {
		return this.place !== 0 ? "Gate's Mansion" : ""
	};
	per.passTimeDay = function() {
		if (this.isCharmedBy() && isMurderPath() && !this.checkFlag(3)) this.setFlag(3);
		this.setFlag(5, false);
		return ""
	};
	per.showEventPopup = function() {
		if (sType !== "") return false;
		if (Place == 192 && !this.checkFlag(7) && isMurderPath()) {
			this.setFlag(7);
			showPopupWindow("Sarah Gates", "<img src='Images/sarah0.jpg' class='imgpopup' alt='Sarah'>" + "<p>You enter the Gates' Massion to see an elegant young lady, sitting on the floor. You recognise her from her face from the paper. It is Sarah Gates, the richest lady in Glenvale.</p>" +
				"<p>Her eyes are still watery, it is obvious she\u2019s still crying about the death of Sir Ronald. Here\u2019s a woman all to herself, without protection which is already strange. She doesn\u2019t have bodyguards around her or guards at all in the house. This makes her an easy and quick conquest to your charms, " + (isMurderPath(true) ? "but if she is playing tricks on you and thinks that you were the one who killed Sir Gates?" : "but if she is playing tricks on you and realized that you were the one who killed Sir Gates?") +
				"</p><p>You have to think carefully and plan everything around, there is a high chance that she is dangerous. However the wealth and influence she now possess over the town after the of her uncle makes her a key player to your road to full domination.</p>" + "<p>The elegant yet lovely Sarah is talking to you, asking questions about you and your relationship with her uncle. So you have to decide to tell her the truth or come up with something.</p>");
			return true
		}
		if (Place == 45) {
			if (perGates.other == 499) {
				showPopupWindow("A Delivery",
					"<img src='Images/zoey0b.jpg' class='imgpopup' alt='Delivery Girl'>" + "As you approach your front door, you see a cute delivery girl knocking on the door. You ask her what she wants and she turns,<br><br>" + '"Hello, are you ' + perYou.getPersonName() + '...", and she confirms your identity. She asks you to sign for a package and hands it to you,<br><br>' + "With her business done she leaves you, riding off on a small motor-scooter. Inside the house you check the package, it is the <b>Book!!!</b> There are also an envelope with a little money in bills and a simple note,<br><br>" +
					'"<i>Well ' + (perYou.isBornMale() ? "Mr" : "Miss") + ' Not Apprentice, he will not miss this for a time, learn what you can and we will talk more later. Take care as we are now allies and co-conspirators!</i>"<br><br>' + "You consider that you could return the book, or hand it in to the police, it would be safer....<b>no way</b>!! You will not give up the book!");
				perGates.other = 700;
				perYou.startQuest(1);
				movePerson("Kurndorf", 0);
				AddCash(50);
				moveItem(4);
				if (!isPlaceKnown("ShoppingCenter")) setPlaceKnown("ShoppingCenter");
				return true
			}
			if (this.checkFlag(4) && whereItem(60) == 1E3 && isDay()) {
				var sibling = "Sis";
				if (perYou.isBornMale()) sibling = "Bro";
				showPopupWindow("A Second Delivery", "<img src='Images/zoey0a.jpg' class='imgpopup' alt='Delivery Girl'>" + "As you approach your front door, you see the same delivery girl who brought you the book. She is just leaving and flashes you a smile as she hops onto her scooter and rides off before you can do anything.<br><br>Tracy greets you from the door,<br><br>" + '"Hey ' + sibling + ' you have a package", and she puts it down on the side table, "You must be earning more money than I thought to be ordering large packages like this. I must get you to buy me a chocolate-sunday sometime". She smiles and walks off to the kitchen to get a hot drink.<br><br>' +
					"You check the package, and yes it is a book on hypnosis, and there is also a little money in bills and a simple note,<br><br>" + '"<i>Have fun, and I thought you may need a little more cash to help as well."<br><br>');
				AddCash(20);
				moveItem(60);
				return true
			}
		}
		return false
	};
	per.showEvent = function() {
		if (Place != 192) return false;
		var md;
		if (sType == "laurenattending") {
			var idx = Math.floor((this.other - 114) / 3);
			this.other = this.other + .1;
			md = WritePlaceHeader(false, isExplicit() && idx != 1 ? "td-left-large" : "");
			if (isExplicit()) this.showPersonX("sarah13" +
				String.fromCharCode(idx + 97) + ".jpg");
			addPlaceTitle(md, "Lauren Attending Sarah", !isExplicit() ? "door1.jpg" : "");
			if (isExplicit()) md.write("<p>You lightly knock on Sarah's door, and she answers,</p>" + '<p>"Uhh, come in."</p>' + "<p>You open the door and see Sarah lying on a couch, naked, and her maid Lauren kneeling between her legs, licking Sarah's pussy nervously. Sarah looks at you,</p>" + '<p>"Uhh, just a little..umm..bit..my maid is attending to ahhh very urgent duty. Lauren won\'t take too long...ohhh that is very nice...ummm Lauren you are getting much, much better.<br><br>Faster, lick me...uhhh..come on I am close...ahhhh..make your Mistress cummmmm!!"</p>' +
				"<p>Sarah breaths heavily and tells Lauren she has done well, and then speaks to you,</p>" + '<p>"Well what can I do for you?"</p>');
			else md.write("<p>You lightly knock on Sarah's door, and she answers,</p>" + '<p>"Uhh, just a little..umm..bit..my maid is attending to ahhh very urgent duty"</p>' + "<p>You hear some soft noises and then Sarah continues speaking at a slightly lower volume, but easily heard,</p>" + "<p>\"Don't worry Lauren, they won't interrupt..ohhh that is very nice...ummm you are getting much, much better.<br><br>Faster, lick me...uhhh..come on I am close...ahhhh..make your Mistress cummmmm!!\"</p>" +
				"<p>You hear some heavy breathing and then Sarah calls out,</p>" + '<p>"You may enter"</p>');
			startQuestions();
			addLinkToPlaceC(md, "speak to Sarah", 192);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "sarahservice") {
			md = WritePlaceHeader();
			this.showPerson("sarah8.jpg", "height:max");
			addPlaceTitle(md, "Sarah Gates Serving You");
			md.write("<p>Sarah obeys your orders. She is so eager to do whatever you want.</p>");
			startQuestions();
			if (perYou.isMaleSex()) {
				addLinkToPlace(md, "you will fuck her", Place, "type=sarahfuck");
				if (isExplicit(true)) addLinkToPlace(md, "she will serve you with a blowjob", Place, "type=sarahbj")
			} else {
				if (isExplicit(true)) addLinkToPlace(md, "she will serve your pussy", Place, "type=sarahbj");
				if (perYourBody.FindItem(45) > 0) addLinkToPlace(md, "fuck her with your strap-on", Place, "type=sarahfuck")
			}
			addLinkToPlaceC(md, "talk to Sarah", 192);
			WritePlaceFooter(md);
			return true
		}
		var myName = this.getYourNameFor();
		var herName = this.getPersonName();
		if (sType == "sarahbj") {
			md = WritePlaceHeader();
			if (perYou.isMaleSex()) {
				this.showPersonRandomX("sarah11b",
					2, "height:max", "left");
				addPlaceTitle(md, "Sarah Gates Serving You");
				md.write("<p>You tell " + herName + ' to serve you by using her mouth to pleasure you. She is no expert and she takes your length into her mouth. She does her best and after a pleasurable time you release into her mouth. She swallows and smiles and says, "Thank you ' + myName + '".</p>')
			} else {
				this.showPersonRandomX("sarah11g", 2, "height:max", "left");
				addPlaceTitle(md, "Sarah Gates Serving You");
				md.write("<p>You tell " + herName + ' to serve you by using her tongue to pleasure you and for her to play with herself. To your delight she is somewhat experienced at pleasuring women and she make you reach the peak of ecstasy after a pleasant time. At the same time she cries out her pleasure, muffled by your pussy, and after she lies back and says, "Thank you!".</p>')
			}
			startQuestions();
			addLinkToPlaceC(md, "talk to Sarah", 192);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "sarahfuck") {
			md = WritePlaceHeader();
			if (perYou.isMaleSex()) {
				this.showPersonRandomRorX("sarah10b", 2, "height:max", "left");
				addPlaceTitle(md, "Sarah Gates Serving You");
				md.write("<p>You order her to serve you with her body, and you take her and you sink you manhood into her delightful pussy, ramming into her over and over. You feel her shudder in her release and that is the final straw and you pour your passion into her depths.</p>")
			} else {
				if (!isExplicit()) this.showPerson("sarah10g.jpg",
					"height:max", "left");
				else AddImageRandomX("GenericSex/sex-ff strapon ", 8);
				addPlaceTitle(md, "Sarah Gates Serving You");
				md.write("<p>You order her to serve you with her body and that you will use your strap-on to explore " + herName + "'s lovely ass. You find she is somewhat experienced with this, and she very much enjoys your strap-on, reaching her peak not long after you do.</p>")
			}
			startQuestions();
			addLinkToPlaceC(md, "talk to Sarah", 192);
			WritePlaceFooter(md);
			return true
		}
		return false
	};
	per.addPersonPhoneCall =
		function() {
			if (isConspiracyPath())
				if (Place != 45 && Place != 46 && Place != 154 && !this.checkFlag(3)) {
					if (makeCall(true, 90)) {
						this.setFlag(3);
						var perBeasley = findPerson("Mr Beasley");
						if (perBeasley.other < 2) perBeasley.other = 2
					}
				} else if (Place != 11 && perYou.checkFlag(12) && !this.checkFlag(4)) {
				if (makeCall(true, 91)) {
					this.setFlag(4);
					PlaceI(60, 1E3)
				}
			} else {
				if (Place == 161 && isSpellKnown("Wealth") && !this.checkFlag(6) && getPersonOther("Jessica") === 0)
					if (makeCall(false, "unknown", 'The call is intermittent with many drop-outs. All you can clearly make out is "...witch of the legend...hidden near...sent a SMS...cute..." and the call cuts out')) {
						addSMS(92);
						this.setFlag(6)
					}
			} else if (isMurderPath()) {
				if (Place != 192 && Place != 290 && Place != 16 && this.checkFlag(3) && !this.checkFlag(1))
					if (makeCall(true, 90)) this.setFlag(1)
			} else if (Place != 192 && Place != 290 && Place != 16 && this.other >= 110 && this.other < 1E3 && !this.checkFlag(3) && !isDay() && this.place == 192)
				if (makeCall(true, 90)) this.setFlag(3);
			return false
		};
	per.getPersonSMS = function(id) {
		switch (id) {
			case 90:
				if (isMurderPath()) return receiveSMS("Sarah", perYou.getMaster() + ", my Maid was just helping me to get ready for the day and she mentioned some of my Uncle's papers. One looks to discuss a spell you may be interested in. I can teach it to you if you would like?",
					"sarahsms1.jpg");
				if (isConspiracyPath()) return receiveSMS("noble ally", "I can see the Book in your hands, one power it can teach you, " + perYou.getPersonName() + ". It is all I know now, I hope to share what you can learn once you master the nature of mana and spells") + replyToSMS("Mana?") + receiveSMS("noble ally", "It is the power of magic. Without it, a warlock or witch is powerless. It can be found in certain items, but a true witch gains it every sunrise. Speak to the cute girl at the Antiques " + getShopStore(true) +
					" for some more help.", "Items/stone2.jpg", "30%") + replyToSMS("Who are you?") + receiveSMS("noble ally", "Not now, we will talk more later");
				return receiveSMS("Sarah", perYou.getPersonName() + ", it is rather hot here, I love an open fire. I will have to ask Lauren to join me. Imagine two hot women in front of the fire...", "sarahsms2.jpg");
			case 91:
				return receiveSMS("noble ally", "That man is such a slime, " + perYou.getPersonName() + ', sorry I was "watching" just then. There is a book on hypnosis here, I will have it sent over to your house, enjoy');
			case 92:
				return receiveSMS("noble ally", "A painting $%@$ time of the cults, $@$@$ the witch Jessica", "jessica0.jpg")
		}
		return ""
	}
}

function initialiseSeraphina() {
	addPerson("Seraphina", 0, "Seraphina");
	per.getPersonName = function() {
		return perJesse.getDemonPath() >= 30 ? "Thrall" : this.name
	};
	per.isPlaceImageRight = function() {
		return Place == 282 && this.checkFlag(1) && this.isHere()
	};
	per.showPlaceImageRight = function(md) {
		this.showPerson("thrall1-club1.jpg", undefined, undefined, undefined, undefined, undefined, md)
	};
	per.showEvent = function() {
		var md;
		if (Place != 282) return false;
		if (sType == "checksera") {
			this.setFlag(2);
			md = WritePlaceHeader();
			this.showPerson("thrall1-club1.jpg");
			addPlaceTitle(md, "Dancing Thrall");
			md.write("<p>You approach the dancer and you immediately recognise her as the thrall you saw with Legion, the blonde girl you had met earlier in the Wild Ranges. Her hair is different but it has either been dyed or it is some sort of demonic spell, you think they can alter their appearance.</p>" + "<p>You try to talk to her and find out why she is here. She looks at you,</p>" + '<p>"Little ' + perYou.getWitch() + ', you are not my Mistress, I was given to her so I...That no longer matters, my Mistress has given me a new contract."</p>' +
				'<p>Well, she is fully a demon thrall, clearly she remembers your encounter with her and Legion. You are unsure what to do otherwise with her for now. You know little of her, trying to "save" her seems impossible.</p>');
			startQuestions();
			addLinkToPlace(md, "leave her for now", Place);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "watchsera1") {
			md = WritePlaceHeader();
			this.showPerson("thrall1-club2.jpg");
			addPlaceTitle(md, "Sera Dancing");
			md.write("<p>You decide to watch Sera, the thrall, dance. For a moment you try to rationalise it is to find more out to help her. You give up, you really just want to watch her dance.</p>" +
				"<p>She is dancing remarkably well, but then again the thrall is a thing of passion, and as you watch she starts to strip, her breasts becoming exposed as she gyrates.</p>");
			startQuestions();
			addLinkToPlace(md, "continue watching", Place, "type=watchsera2");
			addLinkToPlace(md, "leave her for now", Place);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "watchsera2") {
			md = WritePlaceHeader();
			this.showPerson("thrall1-club3.jpg");
			addPlaceTitle(md, "Sera Dancing");
			md.write("<p>She continues dancing, erotic and skillfully until she is completely naked. She keeps the pretense of being chained up the entire time and and finally the dance finshed to some applause. She looks directly at you,</p>" +
				'<p>"Little ' + perYou.getWitch() + '....", she hesitates and a look of almost confusion passes over her face. It passes and she just smiles and turns away from you as she re-dresses.</p>');
			startQuestions();
			addLinkToPlace(md, "leave her for now", Place);
			WritePlaceFooter(md);
			return true
		}
		return false
	};
	per.showPersonTextHere = function(md) {
		if (sType !== "" || Place != 282 || !this.isHere()) return;
		if (!isShopOpen(-2, -2, true, true)) return;
		if (!this.checkFlag(2)) md.write("<p>To one side there is a girl dancing in a booth, wearing something made of leather and bound in chains, or at least pretending to be. She looks familiar but you cannot place her.</p>");
		else md.write("<p>To one side you see the thrall Sera dancing for her Mistress.</p>")
	};
	per.showPersonChat = function(bGeneral, md) {
		if (sType !== "" || Place != 282 || !this.isHere()) return;
		if (!isShopOpen(-2, -2, true, true)) return;
		if (!this.checkFlag(2)) addLinkToPlaceC(md, "check the familiar dancer", Place, "type=checksera");
		else addLinkToPlaceC(md, "watch Sera the thrall dance", Place, "type=watchsera1")
	};
	per.handleItem = function(no, cmd) {
		if (no == 14 && cmd == 2)
			if (Place == 282 && this.isHere()) {
				addComments("As you cast the spell you suddenly smell a hint of brimstone. The thrall looks at you and smiles, but otherwise nothing happens. The spell seems to have done nothing.");
				return "handled"
			}
		return ""
	}
}
var perGates;

function RepliesSirRonald(nR) {
	var myName = perYou.getPersonName();
	if (perGates.other > 0) myName = perYou.getSex();
	var ret = true;
	if (nR == 14) {
		perGates.setFlag(7);
		var nSlaves = 0;
		var p;
		for (var i = 0; i < arPeople.length - 3; i++) {
			p = arPeople[i];
			if (p.isCharmedBy()) nSlaves++
		}
		if (nSlaves > 0) addComments("You start to ask " + perGates.getPersonNameShort() + " about the Charm spell but hesitate, remembering it was forbidden, and you have crossed the line and actually used it.<p>" + "<p>" + perGates.getPersonNameShort() + ' says, "Oh that spell, the worst of the excesses of the warlock Kurdorf were owed to that foul spell. Fortunately it is a lost spell, though there are still some limited defences around for it. Now let us not talk about this distasteful subject"</p>' +
			"<p>You realise you can never talk about knowing the spell or using it with him!");
		else {
			addComments("You confess to " + perGates.getPersonNameShort() + " about learning the spell you found, the forbidden Charm spell,</p>" + "<p>" + perGates.getPersonNameShort() + ' shakes his head, "The worst of the excesses of the warlock Kurdorf were owed to that foul spell. I had hoped it was a lost spell but it seems there was a copy hidden away. my ' + myName + ' you must resits temptation, never, never cast it!"</p>' + "<p>You hope you can be a <b>good apprentice</b> and avoid using the spell, but only time will tell!</p>" +
				"<p><i>new path for the game but not implemented yet<i></p>");
			perGates.setFlag(8)
		}
	}
	if (nR == 30) {
		addComments('"Well then, nice to meet you ' + myName + '," he says as he regards you for a moment.  "Such a polite youngster. You just might be exactly what I have been looking for."<br>');
		perGates.other = 1
	} else if (nR == 31) {
		addComments('"Time is running out, dear ' + myName + ", and I must find an apprentice. Someone of integrity. Someone who wouldn't just abuse the gift for their own nefarious ends.  Do you think you could be that person?\"");
		perGates.other = 2
	} else if (nR == 32) {
		addComments('"Magic, my ' + myName + '!" he says, casting a mischievous smile your way.  "Are you interested in learning the ancient arts?"');
		perGates.other = 3
	} else if (nR == 33) {
		if (!isPlaceKnown("ShoppingCenter")) setPlaceKnown("ShoppingCenter");
		addComments('<p>"Wonderful!" exclaims the old man. "We can start your training immediately. You must learn the art of reading magic. Find a magical stone for me and I will teach you the magic scripts. These stones can look like an old weathered stone or a small piece of sculpture with a rune engraved on it."</p><p>He continues, "I can offer you some mundane assistance in your apprenticeship, you are welcome to ask when you need it"');
		perYou.startQuest(1);
		perGates.other = 9
	} else if (nR == 35) {
		PlaceI(27, 17);
		if (!isPlaceKnown("ShoppingCenter")) setPlaceKnown("ShoppingCenter");
		addComments("\"You're welcome, my " + myName + '. Please accept this letter of credit. It should help you in the future."<br>')
	} else if (nR == 37) {
		perGates.setFlag(2);
		addComments('"Simple financial aid, when you are short of money I can offer you some help.');
		if (nMoney < 20 && isItemNotHere(27, 17)) {
			addComments(" Please accept this letter of credit. It should help you in the future.");
			PlaceI(27, 17)
		}
		addComments('"')
	} else if (nR == 314) {
		if (perYourBody.FindItem(4) === 0) {
			perYourBody.PutItem(4);
			perYou.completeQuest(4);
			addComments('"Very well then my apprentice. Take this book and learn your first spell."');
			perGates.other = 15
		} else addComments('"Very well then, my apprentice.  Ready to try again?"');
		if (!isRunes()) Place = 212;
		else {
			Research("Spell", "TuoDuo");
			ret = false
		}
		ret = false
	} else if (nR == 499) {
		addComments('"My book? How dare you demand my property!');
		if (perGates.other > 0) addComments(" I guess I was wrong about you.  ");
		addComments(' I suggest that you leave here before I call the police."');
		perGates.other = 500
	} else if (nR == 500) {
		addComments('"Never! It is too dangerous for someone such as you.  There is no end to the evil that you could unleash!"');
		perGates.other = 501
	} else if (nR == 501) {
		addComments("You wrestle for the gun and CRACK! The gun fires.<br><br>You check your body to see if you are wounded. Blood is on your shirt but it isn't yours. " + perGates.getPersonNameShort() + " crumples to the floor, gasping for air. Blood drips from his lips as he quickly dies.");
		perGates.setFlag(1);
		perYou.startQuest(1);
		perYou.addCorruption(5);
		charmPerson("Anita", 1, "Davy");
		charmPerson("Mayor", 1, "Davy");
		PlaceI(4, 19);
		PlaceI(22, 19);
		if (!isPlaceKnown("ShoppingCenter")) setPlaceKnown("ShoppingCenter");
		Place = 19
	} else if (nR == 600) {
		bChat = false;
		addComments('"My dear ' + myName + ' there is something dangerous outside at night that seeks my family. I cannot allow anyone in or out of my home.</p><p>Do not worry I will make a spare room available for you for whenever you are here."</p>' + '<p>He makes a quick call you can only hear parts of it "the guest room...yes my dear..as soon as you can Lauren..."</p>' +
			"<p>When he hangs up he tells you sternly,</p>" + '<p>"My ' + myName + ' do not try to use magic on Lauren, I have protected her, it is a limited protection, and you could bypass it with persistence. If you do my niece and I will never forgive you and your apprenticeship will be over."</p>' + "<p>A moment later the maid enters the room and escorts you upstairs to a guest room.</p>");
		perGates.setFlag(3);
		Place = 290;
		setQueryParams("type=escort")
	} else if (nR == 666) {
		addComments('"My dear ' + myName + ' I do not consort with demons, and avoid the study of them, this was the province of the damned Kurndorf. I have studied some defences but the best is to refuse any offer and never deal with them."</p>' +
			'<p>He heitates, "There was a <i>woman</i> who once met with me". You can hear the comtempt in his voice. "She was a skilled demonologist, and was not yet a demon-slave. She knew much of them and wanted to but certain magics from me. I refused, she had some strange ideas about prices"</p>' + "<p>You ask more about this woman, and he answers,</p>" + '<p>"She called herself Mistress Jade" he shakes his head, and continues, "apparently she is based out of a \'gentlemens club\' in town. I have no idea where that place is, I doubt it is listed publically, try asking someone else where it is."</p>' +
			"<p>Strange, you have never hear of such a club in town, it must be very private!</p>");
		perGates.setFlag(6)
	} else if (nR == 700) {
		addComments("You tell " + perGates.getPersonNameShort() + " about seeing Leanne in the Mother Superiors room and your concern to rescue your friend. He looks thoughtful and replies,</p>" + '<p>"My dear ' + myName + ", I have not studied much the ways of demonology, it smacks too much of the ways of Kurndorf.</p>" + "<p>So I cannot directly help you, aside from telling you I believe it is possible I have read of people being freed from demons and their slavery, but I do not know the process.</p>" +
			"<p>You need to research the ways of demonology. The lovely owner of the Antiques " + getShopStore(true) + ' in town is very knowlegable on matters of the occult, she may have some suggestions."</p>' + "<p>You thank him for the information.</p>");
		setPersonFlag("Leanne", 7)
	} else if (nR == 800) {
		addComments(" I guess I was wrong about you. We have nothing more to discuss, please leave my house. ");
		perGates.other = 499
	} else if (nR == 999) {
		if (!isPlaceKnown("PoliceStation")) setPlaceKnown("PoliceStation");
		setPlaceKnown("TownHall");
		addComments('"Oh dear. This is very bad my ' + myName + '. You must go to the police immediately but be careful.  It sounds like those working against us may have learned magic."')
	} else if (nR == 901) {
		perYou.setQuestAftane(10);
		PlaceI(41, 17);
		addComments('"A very important artifact, my ' + myName + '. It is the best weapon and protection against the undead and evil spirits." He says, looking at you thoughtfully for a moment before setting it on his desk.  "I want you to take it for the dangers ahead."</p>')
	} else if (nR ==
		910) {
		addComments('"Keep it with you at all times." He says, "Eventually my greatest enemy will find a way to resurrect himself.  As my apprentice, you must have the talisman to stop him in my stead."');
		perYou.setQuestAftane(11)
	} else if (nR == 911) {
		addComments("<p>" + perGates.getPersonNameShort() + ' raises his eyebrow, "And how do you know this?"</p>');
		perYou.setQuestAftane(12)
	} else if (nR == 912) {
		addComments("<p>" + perGates.getPersonNameShort() + ' looks at you with an understanding gaze.  "Fear not, my ' + myName +
			'," He says, attempting to reassure you.  "Such a thing was innevitable.  At least I am still here to help.  What has he requested of you?"</p>');
		perYou.setQuestAftane(15)
	} else if (nR == 913) {
		addComments('<p>"Tricked you did she?" He asks suspiciously.  "She could do nothing from her prison underneath the hotel.  Unless you helped her that is," He says, raises his eyebrow.  "It matters little either way.  His return was innevitable.  What has he requested?"</p>');
		perYou.setQuestAftane(15)
	} else if (nR ==
		915) {
		addComments('<p>"Hmmm," He says rubbing his chin as he thinks for a moment.  "According to my research, he was not attempting to cast any major ritual at the time of his death.  It must be a ruse of some kind.  Did he attempt anything at the s\u00e9ance?"</p>');
		perYou.setQuestAftane(20)
	} else if (nR == 916) {
		addComments('<p>"Most odd," He says rubbing his chin as if deep in thought.  "Most unexpected.  Did he try anything during the s\u00e9ance then?"</p>');
		perYou.setQuestAftane(20)
	} else if (nR == 920) {
		addComments("<p>\"Good.  I'm most pleased you were able to find that key then.  Otherwise I'm afraid we would be in a most dire-some situation.\" " +
			perGates.getPersonNameShort() + ' says quite seriously.  "Kurndorf had many... <i>creatures</i> under his command.  Things could have been much worse."');
		perYou.setQuestAftane(25)
	} else if (nR == 925) {
		addComments('<p>"Good.  I was afraid that he might summon a minion of some sort upon failing to possess your body.  This seemed to have worked in our favor then."</p>');
		perYou.setQuestAftane(50)
	} else if (nR == 926) {
		addComments('<p>"Oh no...  I was afraid of this.  Did he summon a creature, a demon perhaps?"</p>');
		perYou.setQuestAftane(30)
	} else if (nR == 930) {
		addComments('<p>"I\'m afraid I will be of little use in fighting demons...  Normal objects are quite useless against them... perhaps if it was a blessed item...  A gun perhaps?  I wish I could say more."</p>');
		perYou.setQuestAftane(50)
	} else if (nR == 950) {
		addComments('<p>"Hmm..." I am not sure what he is planning, but it sounds nothing like any charm spell I am aware of." He says thoughtfuly.  "Perhaps I may have a trick for you though."</p>');
		perYou.setQuestAftane(51)
	} else if (nR ==
		951) {
		addComments('<p>"He spoke of a skull in his ritual as well as a <i>personal</i> item.  Perhaps, if you could find <i>his</i> skull, you may be able to use it against him!"</p>');
		perYou.setQuestAftane(60)
	} else if (nR == 3E3) {
		setPersonFlag("Ghost", 11);
		addComments("You ask " + perGates.getPersonNameShort() + " about ghosts and what keeps them tied to a particular place, and if they can move from that place,</p>" + '<p>"Well ' + myName + ' are you having problems with a simple ghost, they are almost always harmless, unless you are in a Place of Power?"</p>' +
			"<p>You explain a little about Nurse Keana and wanting to free her from the hospital basement, but not anything more. " + perGates.getPersonNameShort() + " sits back and thinks for a few minutes and answers,</p>" + '<p>"There are a number of ways, but exorcism is not what you seem to want. Just to move a ghost is simple, as long as you have a magical tie to them. Either an item of personal importance or a magical binding or a link of other sort. If you do, take them by the hand, and lead them where-ever you desire and keep them there until dawn. The following night they will be there again and will stay there. In some cases you may need to repeat, but mostly they will stay."')
	} else if (nR ==
		5904) {
		addComments('<p>"A little blue bottle, eh my ' + myName + '?" He asks, a curious expression on his face.  "And why would you need it?"</p>');
		perDavy.setQuestBlueBottle(5)
	} else if (nR == 5905) {
		addComments('<p>"Well then," He says with an almost prideful look on his face as he pulls the bottle out and sets it on his desk.  "By all means, do what you must.  Just be careful...  There <i>used</i> to be quite a lot of power within this little trinket..."</p>');
		perDavy.setQuestBlueBottle(9);
		PlaceI(33)
	}
	return ret
}

function initialiseGates() {
	perGates = addPerson("Sir Ronald");
	per.getPersonGender = function() {
		return "man"
	};
	per.Replies = RepliesSirRonald;
	per.isPersonInfo = function() {
		return isCharmedPath() && this.other > 8 && this.other != 499 && this.other != 500
	};
	per.getPersonInfo = function() {
		return "<img src='Images/gates6.jpg' style='width:40%;float:right;margin-left:5px' alt='Gates'>" + this.getPersonName() + ', your mentor and guide who helps you in your quest to get rid of the evil surrounding the area. He proves to be a powerful warlock who certainly has some magic spells in his pocket. He told you about his story in bits, because he is not the talkative type. He is part of a family that is decades old and been fighting demons for generations. He mentioned you about the other candidates for the apprenticeship. They all failed at some point and he felt he will never find the "true one". But when he first saw you he saw something in you, something otherwordly.<br><br>' +
			this.getPersonNameShort() + " is looking out at the two sided windows behind his desk at the moment, frequently sniffing into his pipe contemplating about you and your quest. What should you tell him?"
	};
	per.getPersonName = function() {
		return this.name + " Gates"
	};
	per.getPersonNameShort = function() {
		return this.name
	};
	per.showEventPopup = function() {
		if (sType == "limolift") {
			showPopupWindow("A Limo Ride", "<img src='Images/limo.jpg' style='float:right;width:45%;margin-left:5px' alt='Limo'>" + '<p>"No problems my ' + perYou.getSex() +
				' I can have my driver drop you off in town. Unfortunately they are not here at the moment, once they return I will immediately have them drive you into town. Meanwhile feel free to study or we can talk more of magic."</p><p>You spend the rest of the ' + (isDay() ? "day" : "night") + " at the Mansion, either chatting, reading or napping. After a time " + this.getPersonNameShort() + " tells you the limo is ready and walks with you to the from of the mansion.You are surpised how he comes with you, like he is keeping an eye on you. He personally opens the door of the limo for you, the driver is already in the limo but you can only make out a vgue figure through the tinted windows.</p>" +
				"<p>You enjoy a short drive in the limo and it pulls up you realise in front of your home. A voice says you may leave the limo now, again odd that they do not open the door for you or similar. You get out and close the door and the limo drives away</p>");
			return true
		}
		if (sType !== "") return false;
		if (Place == 17 && this.other == 16 && !this.checkFlag(4)) {
			this.setFlag(4);
			showPopupWindow("Clairvoyance and The Next Quest", "<img src='Images/gates7.jpg' class='imgpopup' style='float:left;margin-right:8px' alt='Gates'>" +
				getSpellDescription("Clairvoyance") + "</p>" + "<p>Now you know the spell " + this.getPersonNameShort() + ' congratulates you, "You are doing well my apprentice." and he hands the Book to you, "You will need this to continue your studies". With some pleasure you pick up the Book, finally!</p>' + "<p>" + this.getPersonNameShort() + ' interrupts your contemplation of the Book, "Now use your power to find me a special artifact. It is an <b>old key</b> that was stolen from me two years ago, I think by an employee who left my service at that time."</p>' +
				'<p>You ask about the person but he dismisses your query "No, no, nothing useful there, it is lost somewhere, that I can tell. Use your brains and your magic!"');
			return true
		}
		return false
	}
}

function RepliesSisterDesiree(nR) {
	var perSister = per;
	var myName = perSister.getYourNameFor();
	if (nR == 14110) {
		addComments('<p>Sister Desiree looks at you with an amazing intensity for a brief moment.  "May the Lord bless and keep you, child." She says, laying a hand on your shoulder.');
		if (perSister.other < 9) {
			AddMana(8);
			addComments("</p><p>You feel a small surge in power as she does and you gain 8 mana.");
			if (isMurderPath()) perYou.addCorruption(-5);
			else perYou.addCorruption(-3)
		}
		perSister.other = 10
	} else if (nR ==
		18309) {
		per.setQuestRelic(10);
		addComments('<p>"' + myName + "! How did you learn of that?  Yes, this church does protect a relic of my <i>prior faith</i>, but I did not think it would be of any use to you.  Oh please, " + myName + '," She begs.  "Show me the error of my ways."</p>')
	} else if (nR == 18310) {
		per.setQuestRelic(15);
		addComments('<p>"Oh ' + myName + '!" She says, attempting to speak between the spikes of pleasure she feels.  "I... I believe my old Mother Superior protects it...  She...  She must hide it somewhere."</p>')
	} else if (nR ==
		18315) {
		per.setQuestRelic(20);
		per.place = 1E3;
		Place = 319;
		addComments('<p>"Yes, ' + myName + '.  Of course.  I will not fail you!" She states, the power of her faith almost overwhelming.  Within moments she has donned enough of her habit to not arouse suspicion and has disappeared into the church.</p>');
		startTimedEvent("ReturnDesiree()", 288)
	} else if (nR == 18320) {
		per.setQuestRelic(23);
		addComments('<p>"Oh please forgive me, ' + myName + '.  I am not worthy of your attention.  Not worthy of your worship.  I have failed you!" She cries out in anguish, pulling at her hair as it to tear it out of her head.</p><p>"Please, forgive me!  Teach me more of your way so that I may once again be in your favor!" She cries.</p>')
	} else if (nR ==
		18323) {
		per.setQuestRelic(25);
		addComments('<p>She tries to speak between racks of pleasure.  "I followed her for some time, ' + myName + '.  And inquired as discretely as I could...  But she never revealed it to me and I could not find it on my own..." Further speech is interrupted by a powerful orgasm.</p>')
	} else if (nR == 18325) {
		per.setQuestRelic(28);
		addComments('<p>"All she would say is that she keeps it locked away in a safe place very close." She cries out again in pleasure.  "I searched the church, but I could not search her room.  She would never allow me in."</p>')
	} else if (nR ==
		18328) {
		per.setQuestRelic(30);
		addComments('<p>"Thank you for forgiving me, ' + myName + '.  Your message truly must be worshiped." She cries, her faith restored.  "Please, if there is any other way I may serve you..." She says, her eyes awash in devotion.</p>')
	} else if (nR == 18330) {
		per.setQuestRelic(33);
		addComments('<p>"Would her rosary work, ' + myName + '?" She asks, elated to be able to serve.  "She has worn it all the years that I have known her."</p>')
	} else if (nR == 18333) {
		per.setQuestRelic(35);
		per.place =
			1E3;
		Place = 319;
		addComments('<p>"Yes, ' + myName + '.  Of course.  I will not fail you this time!" She states, once again almost overwhelming you with the power of her conviction.  Within moments she has donned enough of her habit to not arouse suspicion and once again disappeared into the church.</p>');
		removeTimedEvent("ReturnDesiree()");
		startTimedEvent("ReturnDesiree()", 288)
	} else if (nR == 18335) {
		per.setQuestRelic(38);
		PlaceI(44, 332);
		addComments('<p>"Oh yes," She cries, bringing herself to orgasm as you watch.  "Here you are, my ' +
			myName + ', my Angel.  Have I pleased you?"</p>')
	} else if (nR == 18340) {
		per.setQuestRelic(41);
		addComments('<p>"Oooooh," She moans...  "It was simple... I gave her a bit of hemlock infused tea.  Did you know it grows in an overgrown <i>wild</i> area just outside of town?"</p>');
		if (!checkPlaceFlag("WildRanges", 2)) {
			setPlaceFlag("WildRanges", 2);
			PlaceI(58, 26)
		}
	} else if (nR == 1368) {
		perYourBody.DropAllItems("Desiree");
		addComments('<p>"Yes, Mother Superior.  I will hold on to these for you. Thank you."</p>' + "<p>You give Desiree what you were carrying.</p>")
	} else if (nR ==
		136) {
		per.setFlag(7);
		addComments('<p>"I don\'t see how you would know of such things," She says suspiciously.  "Nor do I see how that is any of your business."</p>')
	} else if (nR == 137) {
		perSister.DropAllItems("You");
		addComments("<p>You pickup the items you had given Sister Desiree when you were possessing the Mother Superior</p>")
	} else if (nR == 3E3) {
		if (Place == 384) bChatLeft = false;
		setPersonFlag("Ghost", 13);
		if (!perSister.isCharmedBy()) addComments("You ask Sister Desiree about ghosts and what keeps them tied to a particular place, and if they can move from that place,</p>" +
			'<p>"At one time I knew much on this, but now I have placed my faith in God and my service to the Church. I will not discuss such ungodly things now"');
		else addComments("You ask your disciple about ghosts and what keeps them tied to a particular place, and if they can move from that place.</p>" + "<p>Desiree asks you a series of insightful questions and gets the full details about Nurse Keana. She smiles,</p>" + '<p>"Please allow me a little time to investigate this ' + myName + '. With a little time and speaking carefully to some old contacts I am sure I can work out exactly what is needed. I will call you when I have discovered what is needed, it should be tomorrow!"')
	}
	return true
}

function ReturnDesiree() {
	findPerson("Desiree");
	if (per.place == 1E3 && (per.getQuestRelic() == 35 || per.getQuestRelic() == 20)) {
		per.place = 332;
		if (per.getQuestRelic() == 20) perJesse.setFlag(13);
		return true
	}
	return false
}

function initialiseSisterDesiree() {
	addPerson("Desiree", 332, "Desiree");
	per.Replies = RepliesSisterDesiree;
	per.getPersonName = function(full) {
		return this.isCharmedBy() && full !== true ? "Desiree, Disciple of Desire" : "Sister Desiree"
	};
	per.getQuestRelic = function() {
		return this.extra[0]
	};
	per.setQuestRelic = function(no) {
		this.extra[0] = no
	};
	per.isPersonInfo = function() {
		return this.isCharmedBy()
	};
	per.getPersonInfo = function() {
		if (checkPersonFlag("Daria", 12)) return "<img src='Images/" + this.getImg("sister0.jpg") + "' class='imgpopup' alt='Sister'>" +
			"Desiree, the young nun at the church, is a loyal member of the Cult of Flesh. A fanatic group seeing you as their " + (perYou.isBornMale() ? "God" : "Goddess") + ". She sees you as the most powerful being in existence and happily accepted her role in serving you.<br><br>" + "Not long after Mother Superior has been enslaved by you, she created this new religious group that dedicates themselves to you. The first one to join was Desiree. Now, as a priestess of The Faith of Flesh she spends all her time praying to you when you are not around the church. If you happen to be there, then she just blindly follows you, murmuring things you don\u2019t understand under her cloak.<br><br>" +
			'It is such a bizarre feeling. There is woman who believes that you are some kind of demigod. You cannot hush away the thought that maybe you\u2019ve gone a bit too far in this "mind control everyone you ever come across" plan of yours\u2026';
		return "<img src='Images/" + this.getImg("sister0.jpg") + "' class='imgpopup' alt='Sister'>" + "Sister Desiree is a loyal priestess to your will. She prays to you and for your health every hour as she says. It looks like the charm spell made her more religious, but her sole purpose now is to serve you, her god. Yes, somehow you managed to alter her personality and now she looks up to you as the most powerful being in the world. She referred you mostly as her " +
			perYou.getLord() + ", but more frequently as her God. You feel satisfied with yourself, you have a young girl who adores you as her divine " + perYou.getMaster() + ". Not many people can say that about themselves!<br><br>" + "Your faithful nun gave you explicit details about the church and talked about life in the monastery. She briefly mentioned her trainings and how the Mother Superior rules over the church with iron fist. She begged you to come to her anytime to tell her your problems or have a confession (even though she told you that you will never have anything to repent, because you are perfect)."
	};
	per.getPersonAddress = function() {
		return this.other > 4 ? "Lady of our Heavenly Father Church" : ""
	};
	per.showEventPopup = function() {
		if (Place == 94 || Place == 2)
			if (this.place == 1E3) {
				if (ReturnDesiree()) removeTimedEvent("ReturnDesiree()");
				return true
			}
		if (Place == 332 && !this.checkFlag(2)) {
			this.setFlag(2);
			showPopupWindow("The Good Sister", "<img src='Images/" + this.getImg("sister0.jpg") + "' class='imgpopup' alt='Sister'>" + "A blonde nun appears right in front of you from the cloisters. She must be one of the sisters due to her similar uniform to the Mother Superior. You didn\u2019t know these brides of Christ could look so good!<br><br>" +
				"This one must be a novice, because she is holding a bunch of books and a crucifix and is clearly surprised  to see visitors. You have caught her off guard and she stumbles over something in the courtyard. The sister doesn\u2019t mind your presence as ahe gets back up and goes on to murmur a prayer.");
			return true
		}
		return false
	};
	per.showEvent = function() {
		var md;
		if (Place == 332) {
			if (sType == "discipline") {
				var perMS = findPerson("Daria");
				perMS.setFlag(5);
				perMS.moveThem(384);
				this.moveThem(384);
				md = WritePlaceHeader(false,
					"td-none");
				addPlaceTitle(md, "Disciplining Desiree, the Disciple of Desire");
				md.write("<p>");
				this.showPerson("sister12a.jpg", "50%", "right");
				md.write("You focus on Daria's thoughts about Desiree and hope that your disciple can help you with the Mother Superior. You think about applying some discipline to her, and think about spanking, light caning, and other hands-on ways.</p>" + "<p>While you do this, Daria re-dresses, picks up some sort of pointer or baton, and walks out of the vestry. You hear her slightly confused thoughts,</p>" +
					'<p><i>"I must...speak to Desiree and chastise her for her reluctance to obey...my orders"</i></p>' + "<p>As she walks you focus on the <i>'obey'</i> part of that thought, and the importance of submission to authority. Before you realise it, Daria and you are in the courtyard, standing before Sister Desiree who is kneeling in praying. You hear Desiree whisper \"..." + perYou.name + '...", and as she does Daria, her Mother Superior sternly speaks,</p>' + '<p>"Sister Desiree, enough of this talk of a revelation and your private prayer out here. You have your duties, and it is time for me to apply some discipline..."</p>' +
					"<p>You try to interrupt and focus on <b>'her ass'</b> and Daria continues, \"your behind as nothing else is working. Bend over and raise the hem of your habit!\"</p>" + '<p>Sister Desiree looks a little surprised, "Mother Superior I know my duties, and those I owe to you" and she does exactly as ordered, leaning against a tree and exposing her ass. Daria and you can both see she is not wearing any underwear at all! Daria\'s only thought is <i>"uncomfortable, but convenient"</i></p>' + '<p><b>Smack</b>, "Pray for forgiveness Sister", <b>smack</b>, "Follow my orders, Sister". You try to focus on \'and lick my pussy\' but Daria ignores you, it would seem that was a leap too far.</p>' +
					'<p>Sister Desiree groans, "Ohh yes, Mother Superior", <b>smack</b>, "Please Mother Superior", <b>smack</b> "Ohhh, yes Mother Superior, yes, yes!"</p>' + '<p>As she very obviously orgasms you can see she was covertly rubbing herself to the smacks, and she finally calls out "Thank you Mother Superior!", and Daria stops, looking at her confused.</p>' + "<p>You can feel Daria's arousal, and how very, very much she enjoyed that, but she quickly starts to repress her feelings, and you try to focus on the pleasure of disciplining Sister Desiree and the other things Sister Desiree can do to her. " +
					'As you do the feelings from Daria and your hearing fades, but the last thing you hear is "follow me"...</p>');
				startQuestions("Your vision fades");
				addOptionLink(md, "...and the spell ends", "Dispossession()");
				WritePlaceFooter(md, "", this.NoItems === 0);
				return true
			}
			if (sType == "absolution") {
				md = WritePlaceHeader();
				this.showPerson("sister11.jpg");
				addPlaceTitle(md, "Absolution of Your Sins");
				md.write("<p>The young nun places a hand on your head and prays:</p>" + '<p>"Lord God, your humble servant asks that you absolve this young ' +
					perYou.getManWoman() + " of " + perYou.getHisHer() + ' sins.  We ask your understanding, for the flesh is weak, o Lord."  She stops a moment, and under a light breath of wind you think you hear her whisper, "The flesh is so weak." ' + 'She continues, "Free this ' + perYou.getManWoman() + ' from the bondages of past wrongdoing and in the fullness of time lift us all to your heavenly kingdom.  All this we ask in the name of our Lord, Jesus Christ.  Amen."</p>' + '<p>"Amen," you say, not wanting her to know you only did this to avoid being caught in your lie.</p>' +
					"<p>Strangely enough, you feel as if the weight of your sins has been lifted from you.  Why, you don't feel guilty about enslaving all those women at all anymore!</p>");
				if (isMurderPath() && perGates.other != 600) md.write("<p>Still, you cannot help but remember that horrible expression on " + perGates.getPersonName() + "'s face when the gun went off. You do not really think your sin can be washed away so easily.</p>");
				md.write("<p>You make a mental note to visit church - or at least this nun - more often in the future.</p>");
				startQuestions();
				if (this.other < 10) addQuestionC(md, '"Thank you, Sister"', "Desiree", 14110);
				addLinkToPlace(md, "speak with her further", 332);
				addLinkToPlace(md, "leave her be", 319);
				WritePlaceFooter(md);
				return true
			}
			if (sType == "recite") {
				md = WritePlaceHeader();
				if (this.getQuestRelic() == 35 && !checkPersonFlag("Daria", 4)) setPersonFlag("Daria", 4);
				if (Math.random() < .5) this.showPerson("sister8.jpg");
				else this.showPerson("sister10.jpg");
				addPlaceTitle(md, "Desiree, Disciple of Desire");
				md.write('<p>Your loving disciple lies back at the edge of the hedge maze. "I still feel the scripture written within me," she purrs, tempting you with her posture and sultry tones.  "But I must feel it in my flesh, my Angel, my ' +
					perYou.getMaster() + '."</p>' + "<p>You show her what you have learned of desire and pleasure");
				if (isCharmedBy("Bambi") > 0) md.write(", and teach her a few methods you learned from a professional back at the hotel");
				md.write(".  You leave her blissfully sated, feeling complete, ecstatic, heavenly.</p>");
				if (this.getQuestRelic() >= 35 && this.getQuestRelic() <= 40) md.write("<p>You notice that she has a rosary wrapped around her arm that she did not have before.  Could it be from the Mother Superior?</p>");
				startQuestions();
				if (this.getQuestRelic() >= 5)
					if (this.getQuestRelic() == 10) addQuestionC(md, '"Do you know where the relic is now?"', "Desiree", 18310);
					else if (this.getQuestRelic() == 15) addQuestionC(md, '"I want that relic.  Find it for me."', "Desiree", 18315);
				else if (this.getQuestRelic() == 23) addQuestionC(md, '"What happened.  Why couldn\'t you find it?"', "Desiree", 18323);
				else if (this.getQuestRelic() == 25) addQuestionC(md, '"Did she say anything?"', "Desiree", 18325);
				else if (this.getQuestRelic() == 28) addQuestionC(md, '"I\'ll find it myself."',
					"Desiree", 18328);
				else if (this.getQuestRelic() == 30) addQuestionC(md, '"Could you get me something of hers?  Something very important to her?"', "Desiree", 18330);
				else if (this.getQuestRelic() == 33) addQuestionC(md, '"Perfect! Find a way to get it for me."', "Desiree", 18333);
				else if (this.getQuestRelic() > 33 && this.getQuestRelic() < 38) addQuestionC(md, '"Is that it, wrapped around your arm?  The <i>personal</i> item I need?"', "Desiree", 18335);
				else if (this.getQuestRelic() > 33 && this.getQuestRelic() <= 40) addQuestionC(md,
					'"How did you get it?  The Rosary?"', "Desiree", 18340);
				if (checkPlaceFlag("Church", 5))
					if (this.getQuestRelic() == 28 || this.getQuestRelic() == 30) addQuestionC(md, '"She stopped me as well.  Can you get me a personal item of hers?"', "Desiree", 18330);
				addLinkToPlace(md, "resume speaking with your Disciple", 332);
				WritePlaceFooter(md);
				return true
			}
		}
		if (Place == 444)
			if (sType == "desiree1") {
				md = WritePlaceHeader();
				this.moveThem(443);
				this.showPerson("sisterh2.jpg");
				addPlaceTitle(md, "Sister or is it Maid Desiree");
				md.write('<p>You follow Desiree into an empty office and while she has information about Keana, at the moment all that is on your mind is "Wy is she dressed like that?", so you ask! She poses cutely, curtsies and answers,</p>' +
					'<p>"Don\'t you like it? I got a part-time job here as a cleaner so I could investigate, but this is the only uniform I had that was appropriate. The admin staff were amused but told me to wear something more appropriate in future."</p>' + "<p>You reassure your disciple that you like the outfit and ask her what she has found out about Keana.</p>" + "<p>\"I spoke to some staff here, especially the Nurse Sandra you mentioned. I spoke to my old friends, they were surprised to hear from me again, and I think I understand. Keana is just stuck in the basement, it is difficult for ghosts to cross boundaries like doorways on their own unless it is part of their 'route' when they wander and haunt. In this case I can free her and allow you to take her where-ever you want, like you have with me...\"</p>" +
					"<p>She goes on to explain a little more and that she will meet you in the basement tonight to release Keana. You thank her and are about to leave, you see her unbuttoning the top of her uniform and she asks,</p>" + '<p>"Is there anything else I can offer, something personal?"</p>');
				startQuestions();
				addLinkToPlaceC(md, '"Of course my disciple"', 444, "type=desiree2");
				addLinkToPlaceC(md, '"Not now"', 444);
				WritePlaceFooter(md);
				return true
			} else if (sType == "desiree2") {
			md = WritePlaceHeader();
			this.showPerson("sisterh3.jpg");
			addPlaceTitle(md, "Maid Desiree");
			md.write("<p>You accept Sister...Maid Desiree's offering!</p>" + "<p>Afterwards you redress and arrange to meet her tonight in the basement.</p>");
			startQuestions();
			addLinkToPlace(md, "leave the office", 444);
			AddRightColumnLarge(md);
			this.showPersonRandom("sisterh4", 2);
			WritePlaceFooter(md);
			return true
		}
		if (Place == 443) {
			var myName = this.getYourNameFor();
			if (!isDay() && this.isHere()) setQueryParams("type=freeghost1");
			if (sType == "freeghost1") {
				md = WritePlaceHeader();
				this.moveThem(332);
				this.showPerson("sisterh5.jpg");
				addPlaceTitle(md, "Sister Desiree and Keana");
				md.write("<p>You see Sister Desiree waiting for you outside the basement and you go in with her. She has a quick look around and then puts down a large bad she is carrying. There are a few electronic items, you recognise an expensive camera but the other bits are not familiar. She consults the gear and sets up the camera, and the starts to remove her clothing. You query why, not that you do not enjoy seeing her lovely body,</p>" +
					'<p>"' + myName + ' it is necessary, but also an offering for your pleasure. May I continue?"</p>' + "<p>You agree and after she is completely naked she puts on a bit of clothing, it looks like the 'dogcollar' of a catholic priest. You can see if you ask she will just tell you it is necessary, but you think it is more because she wants to!</p>" + "<p>You agree and after she is completely naked she puts on a bit of clothing, it looks like the 'dogcollar' of a catholic priest. You can see if you ask she will just tell you it is necessary, but you think it is more because she wants to!</p>" +
					"<p>When she is ready you feel a chill and one of the electronic devices beeps, and you see Keana is standing nearby draped in estoplasm.</p>");
				startQuestions("It is time..");
				addLinkToPlaceC(md, '"Desiree do it!"', 443, "type=freeghost2");
				AddRightColumnLarge(md);
				findPerson("Ghost").showPerson("ghostnurse3.jpg");
				WritePlaceFooter(md);
				return true
			}
			if (sType == "freeghost2") {
				md = WritePlaceHeader();
				this.showPerson("sisterh6.jpg");
				addPlaceTitle(md, "Sister Desiree and Keana");
				md.write("<p>Desiree recites something in Latin while looking directly at Keana. She then steps towards Keana as if to embrace her. Keana fades from sight but her ectoplasm swirls and wraps around Desiree almost like she is embracing Desiree back.</p>" +
					"<p>You see indentations form in Sister Desiree's breasts like some invisible hands are cupping her breasts, then a nipple moves as if is it pinched. Sister Desiree sighs and leans her head to one side as if her neck is being kissed. Hand marks form on her ass and back on her breasts as she moans,</p>" + '<p>"' + myName + ' we are ready, come and claim us, take her body as she takes mine, and she will be bound to you."</p>' + "<p>It is difficult to refuse a beautiful woman moaning with desire and telling you to take her, and why should you refuse, they are both yours already!</p>");
				startQuestions("There is nothing to consider");
				addLinkToPlaceO(md, "take them", 443, "type=freeghost3");
				WritePlaceFooter(md);
				return true
			}
			if (sType == "freeghost3") {
				md = WritePlaceHeader();
				setPersonFlag("Ghost", 15);
				this.showPersonRorX("sisterh7.jpg");
				addPlaceTitle(md, "Claim Desiree and Keana");
				md.write("<p>You embrace them, one woman of flesh and blood, warm and passionate, one woman of ectoplasm and the ether, cool but filled with desire. Passions both hot and cold, but equally full of eager desire and lust.</p>" +
					"<p>Afterwards and you separate, you see Desiree dressing and then she turns off the camera...umm you had completely forgotten the camera, it will have recorded everything! You ask Desiree for the recording and she promises to send you a copy as soon as she has it edited.</p>" + "<p>Sister Desiree tells you to take Keana by the hand and lead her where you want and she will follow you anywhere, just like Desiree promises to do as well, anytime!</p>");
				startQuestions();
				addLinkToPlaceO(md, "Sister Desiree leaves",
					443);
				WritePlaceFooter(md);
				return true
			}
		}
		return false
	};
	per.isPlaceImageRight = function() {
		return Place == 444 && this.place == 444 && this.checkFlag(3)
	};
	per.showPlaceImageRight = function(md) {
		if (this.place == 444) this.showPerson("sisterh1.jpg")
	};
	per.showPersonTextHere = function(md) {
		if (Place == 444 && this.isHere() && this.checkFlag(3) && sType === "") md.write("<p>You see down one corridor someone standing in an office doorway beckoning to you. It is Sister Desiree, dressed quite differently, is that a maid uniform?</p>")
	};
	per.showPersonChat = function(bGeneral, md) {
		if (Place == 444 && this.isHere() && this.checkFlag(3)) addLinkToPlaceO(md, "follow Desiree", 444, "type=desiree1")
	};
	per.handleItem = function(no, cmd) {
		if (no == 14 && cmd == 2)
			if (Place == 332 && this.isHere()) {
				CastCharmSpell("Desiree", 334, 1);
				return "handled"
			}
		return ""
	};
	per.addPersonPhoneCall = function() {
		if (this.place == 444 && getHour() > 11 && !this.checkFlag(3))
			if (makeCall(true, 150)) this.setFlag(3);
		return false
	};
	per.getPersonSMS = function(id) {
		if (id == 150) return receiveSMS("Your disciple", this.getYourNameFor() +
			" I am ready for you at the hospital. As an offering I give you the sight of me preparing for you in my cell", "sistersms1.jpg");
		return ""
	}
}

function initialiseSofia() {
	addPerson("Sofia");
	per.isPersonInfo = function() {
		return true
	};
	per.getPersonInfo = function() {
		var s = "<img src='Images/sofia_intro.jpg' style='width:25%;float:right;margin-left:5px' alt='Sofia'>";
		if (!this.isCharmedBy()) return s + "Sofia is the Gates family\u2019s chauffeur. The girl is a great example of latino beauty, though she doesn\u2019t speak english well and is very vigilant and cautious. As if she is hiding something\u2026 You can\u2019t really get anything useful out of her other than that she was fond of Sir Gates and is close with Sarah. Clearly there is more than employer-employee relationship here. She says she was away when Master Ronald was murdered, but now she devotes all her time to protect and be there for Sarah in these hard times." + "Sofia is hesitant to answer even the simplest questions and raves about something else usually. This doesn\u2019t stop you from wanting to enslave her. Not only she has a rocking body, but maybe you could her skills for your own needs. Come on\u2026who doesn\u2019t want a personal chauffeur who carries you around town like some kind of celebrity.";
		return s + 'Sofia was a keen servant to the Gates family. Her kind and shy persona only is only rivaled by her intense devotion to them. Now that you\u2019ve learned her past, you understand why she was so defensive and alarmed. Now that she is under your command, she showed a great deal of emotion; a passionate and sensitive nature. She explained that it\u2019s part of her latino blood and part . It\u2019s just who she is. Overall, she is a humble and timid girl, yet she can be immensely vocal for things she cares about; which is obviously you now. You know if someone would only just look at you nastily, she would be the first to jump in and protect you. You feel she could have been a close friend if the circumstances were different, but you were "forced" to charm her. Still, it isn\u2019t that bad. She is loyal, ambitious, very emphatic and one of your more exotic lover in bed. You decided to have Sofia work for your as your personal driver, which she eagerly accepted. It\u2019s not a bad life when a stunningly beautiful woman looks after you every day.'
	};
	per.getPersonAddress = function() {
		return this.checkFlag(1) ? "Gate's Mansion Garage" : ""
	};
	per.showEventPopup = function() {
		if (Place == 14 && !this.checkFlag(1)) {
			this.setFlag(1);
			showPopupWindow("Chauffeur", "<img src='Images/sofia_office_noncharmed.jpg' style='width:34%;float:right;margin-left:5px' alt='Chauffeur'>" + "A dark skinned lady is sitting on a desk.  It\u2019s easy to realize that she is the chauffeur of the family. She is wearing that kind of uniform after all! How come you have never seen this woman before? You have been in the Gates mansion several times, yet somehow you cannot recollect of seeing such a babe around. Strange indeed. Also worthy to note that her face suggest that she is hispanic, which is a rare ethnic around here. Why didn\u2019t Sir Ronald mention her to you raises even more questions.<br><br>" +
				"Though all your suspicions become subsidiary when you lay your eyes on her enormous breasts. It\u2019s obvious that they are so huge that they hardly fit in her dress properly! The shirt she is wearing doesn\u2019t really hold and it\u2019s not buttoned on the top. She is the definition of a busty woman! It doesn\u2019t end there, her whole body seems perfect for some groping! She is not extremely skinny nor too bulky. A perfect specimen for your taste!");
			return true
		}
		if (Place == 14 && this.isHere() &&
			sType == "charm") {
			if (!perYou.isQuestStarted(7))
				if (isMurderPath()) {
					perYou.startQuest(7);
					showPopupWindow("Chauffeur", "<p><img src='Images/sofia_ring.jpg' style='width:50%;float:right;margin-left:5px' alt='Failed!'>" + "Damn! The spell doesn\u2019t work on her! How can that be? She must have something protecting her against spells like this.</p>" + '<p>Sofia scolds you, "Very\u2026very bad ' + perYou.getPersonName() + '! Master Gates\u2026advirti\u00f3\u2026warned me against people like you! You won\u2019t succeed, I am protected\u2026el hijo de puta\u2026You don\u2019t try this again bastardo!", she is giving you the finger, revealing a silver ring. She must have gotten it from Sir Ronald!</p>' +
						"<p>You will never have a chance to charm Sofia while she is wearing that ring! You need to take it off from her. Maybe if you would know her personality better. You need to understand her in order to find a solution to this, but it is obvious that she is reluctant. You don\u2019t even know anything about this lady! Just suspicions! You have to find someone who at least knows something about her. Someone who knows everyone in town...</p>")
				} else showPopupWindow("Chauffeur", "<p><img src='Images/sofia_ring.jpg' style='width:35%;float:right;margin-left:5px' alt='Failed!'>" +
					"Against all your desires you decide to NOT charm Sofia, because out of your respect to your mentor you don\u2019t want to enslave his servants. She is probably protected by Sir Ronald and it\u2019s not a good idea to anger the elder warlock by messing around in his household. It\u2019s for the best to just leave Sofia alone, you can\u2019t really find a common language anyway.</p>");
			else addComments("<img src='Images/sofia_ring.jpg' style='width:50%;float:right;margin:0 5px 1em 0' alt='Failed!'>Remember the ring!");
			return true
		}
		if (Place == 14 && sType == "breakin") {
			this.addPersonPhoneCall();
			if (bNewSMS) newSMS()
		}
		if (Place == 95 && this.checkFlag(11) && !this.checkFlag(12) && isCharmedBy("Angela")) {
			var perAngela = findPerson("Angela");
			var myName = perAngela.getYourNameFor();
			this.setFlag(12);
			showPopupWindow("Angela Helping", "<img src='Images/People/Angela/angela14.jpg' class='imgpopup' alt='Failed!'>" + "<p>You close the office door and would be on your way out when you see Angela waiting for you. She comes to you, after the regular greeting " +
				(perAngela.getCharmedLevel() == 2 ? " by giving you an enthusiastic kiss" : ", which means she kisses your hand, like a subject does to her " + perYou.getLord()) + " and after that she starts to talk,</p>" + '<p>"' + myName + '! I\u2019ve heard your conversation with Miss Thomas. I\u2019m sorry, I couldn\u2019t help myself and the walls are too thin anyway.", she pleads and waits for your reaction. You don\u2019t mind that a bit, you know she just wants to please you. Sje continues,</p>' + '<p>"I know of a Sofia. She is a hispanic woman in her mind twenties. She was the personal driver to ' +
				perGates.getPersonNameShort() + ' Gates. Is she the one you are looking for?" she asks.</p>', "dispPlace(95)");
			return true
		}
		if (Place == 168 && sType == "waiting") {
			setPlaceKnown("PoliceInterrogationRoom");
			this.setFlag(24);
			this.moveThem(175);
			showPopupWindow("Anticipation", "<img src='Images/sofiadaydream.jpg' class='imgpopup' alt='Waiting'>" + "<p>You sit down into Kerry\u2019s chair while she is away, putting your feet on her desk and loudly whistling away. You turn on the " + getPoliceChief() + "\u2019s computer and play some online browser games to kill time.</p>" +
				"<p>What to do with Sofia once you put her in place? She could help you in some many ways\u2026, but the most obvious one is to continue her job, but as YOUR driver from now on. It would be convenient to have her drive you around and would spare a lot of your precious time. As you contemplate your plans and dreams on how to use your future slave, Kerry enters the station with Sofia in handcuffs. The police chief escorts her through the office and drops Sofia in the interrogation room. After that she to comes to you.</p>" +
				'<p>"It\u2019s done as you wished. The ring\u2019s off her finger! She is quite furious though. I thought she is a meek and easy to break type of person, but she knows how to fight for herself! I will guard you personally while you are in there with her! Be careful, that kitty can still bite!"</p>');
			return true
		}
		return false
	};
	per.showEvent = function() {
		var md;
		if (sType == "sofiapool") {
			WaitHereOnly(6);
			md = WritePlaceHeader();
			this.showPerson("sofia-pool.jpg");
			addPlaceTitle(md, "Swimming with Sofia");
			md.write("<p>You ask Bambi to get Sofia a spare bikini and she quickly finds one for Sofia, who changes into it, ready to serve you in any way you wish!</p>");
			startQuestions();
			addLinkToPlaceC(md, "she is willing to do more..", Place, "type=sofiapoolsex");
			addLinkToPlaceC(md, "say goodbye to Sofia", Place);
			WritePlaceFooter(md);
			return true
		}
		if (Place == 269 && sType == "sofiapoolsex") {
			md = WritePlaceHeader();
			this.showPerson("sofia-pool-sex.jpg");
			addPlaceTitle(md, "Being Discrete and Private with Sofia");
			md.write("<p>You ask Sofia for more with her privately, and she seductively removes most of her swimsuit and plays with her large breasts for your pleasure.</p>");
			startQuestions();
			addLinkToPlaceC(md, "later...say goodbye to Sofia", Place);
			WritePlaceFooter(md);
			return true
		}
		if (Place == 110 && sType == "asksofia1") {
			this.setFlag(11);
			md = WritePlaceHeader(false, "td-left-med");
			this.showPerson("mayor12.jpg");
			addPlaceTitle(md, "Assistance from the Mayor");
			md.write("<p>You ask Mayor Thomas about Sofia, the chauffeur at the Gates's Mansion, and she replies,</p>" + '<p>"Give me a moment ' + perYou.getMaster() + "! I'm looking through the database right now! We have information on everyone who lives in Glenvale!\"</p>" +
				'<p>Amused you ask her "Heh! You have anything interesting on me? and you smile to yourself, while Miss Thomas chuckles at your "original" joke and then replies,</p>' + '<p>"Oh yes! That you are the finest ' + (perYou.isBornMale() ? "lad" : "joker") + ' in the land and we should all appreciate that we know you. The greatest honor to us is when we can talk to you or you give us a task. Yep, it\u2019s written here!" she smiles. Her smile suddenly wanes away, panic draws on her face.</p>' + '<p>You ask, "What\u2019s wrong?" and she answers,</p>' +
				'<p>"' + perYou.getMaster() + '! I don\u2019t- I don\u2019t understand! There\u2019s no one named Sofia in here! I\u2019m so deeply sorry!" she still doesn\u2019t give up, looking around, typing furiously, trying every possibility.</p>' + '<p>You find it hard to understand why Sofia would not be there, "Wha- How can that be?"</p>' + '<p>Mayor Thomas finally answers, "That means that she is unregistered or goes by an another name. Do you know anything else about this woman?"</p>' + '<p>You tell her "Nope, I thought you would be the one who can enlighten me\u2026"</p>' +
				"<p>Mayor Thomas answers, \"I will rally all your slaves! We will find this 'Sofia' and will bring her to you. She will not get away, I promise. I will search every stone, every house if I need to. I will\u2026\" you stop Miss Thomas ranting with a single handwave. She silences in an instant and focuses on listening you.</p>" + '<p>"There\u2019s no need for that. I know where Sofia stays and I certainly don\u2019t need any unwanted attention. I don\u2019t want you marching through the whole town with a whole bunch of slaves for one woman. I will have her in an another way then." your solid voice-tone calms her down. Mayor Thomas fixes her wrinkled blouse and changes from a frightened woman into a stone-cold slave in a second.</p>' +
				'<p>"Mayor Thomas: I understand! Thank you for showing me the way, my ' + perYou.getMaster() + "! I am at your command!</p>" + '<p>"Don\u2019t worry! You\u2019ve done what you can. Now go back to your work.", you tell her.</p>');
			startQuestions();
			addLinkToPlace(md, "go to the reception", 95);
			WritePlaceFooter(md, "", false, true);
			return true
		}
		if (Place == 95 && sType == "asksofia2") {
			this.setFlag(13);
			md = WritePlaceHeader();
			this.showPerson("angela1c.jpg");
			addPlaceTitle(md, "Angela Explains");
			var perAngela = findPerson("Angela");
			var myName = perAngela.getYourNameFor();
			md.write("<p>You ask Angela about Sofia and she happily answers,</p>" + '<p>"We met at the hair saloon a while ago. I don\u2019t know when it was, but I haven\u2019t seen in her in a while. I only met her like, twice maybe."</p>' + '<p>You ask Angela, "Tell me everything you know about her!"</p>' + '<p>"Of course! I live to serve! Sofia seemed on edge, she was shy and nervous. She didn\u2019t talk much at first, but opened up as we waited for our hair to be done. She said she was grateful to the Gates for being so generous with her, giving her work and bed to sleep and that she is utterly loyal to them. She briefly mentioned her job to them; she drives them around wherever they need to go and service them in any way they want. The other staff members didn\u2019t like her, she was an outsider to them who quickly rose through their ranks, becoming Ronald\u2019s pet, as they liked to call her. She wanted to prove them wrong, that she is a hard working woman just like them, but her tryings fell on deaf ears."</p>' +
				'<p>That is interesting, you query her, "Very strange\u2026did she have an accent? Could she speak proper english?"</p>' + '<p>"To my knowledge, yes. She spoke fluently and without problem. Why do you ask, my ' + myName + "?</p>" + '<p>You answer, "Never mind. This girl is just becoming more interesting in every second. What else can you tell me? Something to help me catch her!"</p>' + '<p>Angela tells you "She said she still haven\u2019t got used to getting up very early in the morning. She has a daily routine which involves her leaving her office at 8:00 AM. She told me she goes around town and buys breakfast for Sir Gates, that usually includes groceries, freshly baked breads and such. She returns 10:00 AM with the food and prepares them for Ronald."</p>' +
				'<p>Great!You tell Angela "You can\u2019t imagine how much you helped me. Now I\u2019m going need some help on breaking into her house\u2026I need to know her secrets!"</p>' + '<p>Angela looks pleased, "I\u2019m sure someone at the police station would be more than eager to help you ' + perYou.getMaster() + '! You should talk to them."</p>' + '<p>You agree, "Great idea!"</p>' + '<p>Angela is overjoyed, "My pleasure ' + myName + "! It feels so good being yours, my clit\u2019s already wet just by this conversation! And I will be happy if Sofia will be added to your regiment of slaves. She seemed like such a nice, kind hearted, but troubled girl who needs your 'help'\".</p>" +
				"<p>With that you spank Angela on her bottom and let her return to her duty. She is already in awe that she pleased you.</p>");
			startQuestions();
			addLinkToPlaceC(md, "talk more to Angela", 95);
			WritePlaceFooter(md, "", false, true);
			return true
		}
		if (Place == 168) {
			if (sType == "asksofia3") {
				this.setFlag(14);
				md = WritePlaceHeader();
				this.showPerson("Setting/polbsofia1.jpg");
				addPlaceTitle(md, "Police Assistance");
				md.write('<p>You ask Kerry, "Babe! I need your help. I want to charm someone, but she is wearing a powerful ring that protects her from me. I need to learn more about her, so I\u2019m going to break into her house in the morning. I need your help on this."</p>' +
					'<p>Kerry Batton replies, "I understand ' + (perYou.isBornMale() ? "Sir" : "Ma'am") + '! Though there is no need for that! I can just send some officers and drag her to you. We will ensure that she is held tightly while you cast your spell on her. I will personally\u2026" Kerry doesn\u2019t finish her thoughts. You wave her down too and tell her,</p>' + '<p>"Jeez! Why are you all so harsh and brutish! I was asking for discretion, not public parade with everyone in town involved in it\u2026I swear you are the same as Miss Thomas sometimes." you roll your eyes to Kerry, who, for a moment, looked sheepishly lost in herself, but quickly shakes that feeling off and  says,</p>' +
					'<p>"Forgive me ' + perYou.getMaster() + '! I wanted the easiest way for you! I only live just so you can have a better life. I understand why don\u2019t want a big thing out of this. Command me what to do!", Kerry softly, like an angel, smiles.</p>' + '<p>You are content with her reply, "All right! As I have told you, I want to break into her place. I feel there\u2019s something dark going around her, that\u2019s why I want you to be on the lookout. If I find any evidence that might help bring her here without using force, then I want you to bring her in. And I mean only YOU. I don\u2019t want any other officers or people involved."</p>' +
					'<p>Kerry Batton nods her head, "Sounds like a plan, ' + perYou.getMaster() + '! Would it be better if I could give you more time by distracting her during her shopping?" she offers you a great advice. However you can\u2019t take any risks and answer,</p>' + '<p>"No, don\u2019t do that. I think she would recognise you, you are the police chief of the town after all! What you can do is follow her from a distance and drop me a text when she is heading home so I can know when to leave."</p>' + '<p>Kerry Batton nods, "It will be done as you wished! I\u2019m so lucky that you chose me to serve in this operation. I won\u2019t let you down!". Officer Kerry cheers and hugs you.</p>');
				startQuestions();
				addLinkToPlaceC(md, "Kerry has a last point", 168, "type=asksofia4");
				addLinkToPlaceC(md, "finish talking to Kerry", 168);
				WritePlaceFooter(md, "", false, true);
				return true
			}
			if (sType == "asksofia4") {
				md = WritePlaceHeader();
				this.showPerson("Setting/polbsofia1.jpg");
				addPlaceTitle(md, "Further Police Assistance");
				md.write('<p>Kerry explains, "' + perYou.getMaster() + ". Before you go, I advise you to be careful. I know you have many different spells you can use, but breaking into someone\u2019s house is dangerous. Just promise me you will be safe, my " +
					perYou.getMaster() + '."</p>' + '<p>You reply, "Don\u2019t worry about me, I will be fine. How do you know about my different types of spells?". Kerry answers,</p>' + '<p>"I have my ways\u2026I\u2019ve been asking around your other slaves and been reading a lot about magic lately. I\u2019ve read about a spell that could help you while you search the house. I don\u2019t know it\u2019s name or how to obtain it, but it\u2019s been described as a spell that let\u2019s it\u2019s user see things that are hidden to the normal eye\u2026"</p>' +
					'<p>She has a point, you answer, "Yes\u2026 It\u2019s a somewhat common spell. Thanks for mentioning it, it may prove useful to me during my exploration of Sofia\u2019s secrets."</p>' + '<p>Kerry seems enthusiastic, "I\u2019ve learned so much about this exciting new world already! Ever since I\u2019m your property I have this urge to study and open mind. Is this a side effect of your powers, ' + perYou.getMaster() + '?"</p>' + '<p>You tell her, "I can\u2019t really tell for sure. It affects every mind differently, my slave."</p>' +
					'<p>"Well, when you are finished with Sofia maybe we can talk about my findings privately?" the policewoman strokes your chest softly and puts on a mischievous smirk.</p>');
				startQuestions();
				addLinkToPlaceC(md, "finish talking to Kerry", 168);
				WritePlaceFooter(md);
				return true
			}
			if (this.checkFlag(15) && !this.checkFlag(24) && sType === "") {
				md = WritePlaceHeader();
				this.showPerson("Setting/polbsofia1.jpg");
				addPlaceTitle(md, "Next Stage of the Plan for Sofia");
				md.write('<p>You see Kerry Batton when you enter the Police Station, "Done! Thank you for your help in the investigation, officer!"</p>' +
					'<p>"It was my pleasure ' + perYou.getPersonName() + '! You know\u2026my job is to protect and serve!" Kerry salutes to you, she looks a bit exhausted. She must have arrived back to the station recently."</p>' + '<p>You tell her, "Let\u2019s get to the point, my dear slut! Sofia is illegally staying here, in Glenvale. I\u2019ve found fake passports and files that supports my theory. She was hiding in a secret room in her office during the investigation of Mr Gates\u2019s mysterious death. Her diary details her days here; how she came here and why."</p>' +
					'<p>Kerry Batton nods, "I knew something fishy was going around with that gal! What do you need me to do?"</p>' + '<p>You order her, "Arrest her, charge her with illegal tresspassing to our country. You\u2019ve got your evidence in her bedroom, you don\u2019t need a warrant or anything else."</p>' + '<p>Kerry stands, "I understand. I\u2019m leaving right now! Wait here ' + (perYou.isBornMale() ? "Sir" : "Madam") + '! It won\u2019t take long. I will put her into our interrogation room just next to my office, so she will be all alone. You can safely use your spell on her."</p>' +
					'<p>You remind her, "Don\u2019t forget to confiscate the ring she\u2019s wearing. That\u2019s the thing that gave me all the trouble at the first place!"</p>' + '<p>"Yes, ' + perYou.getMaster() + '!", Kerry answers with a salute, and storms out of the police station with one thing on her mind; bring Sofia to you.</p>');
				startQuestions();
				addLinkToPlaceC(md, "wait for them to return", 168, "type=waiting");
				WritePlaceFooter(md, "", false, true);
				return true
			}
		}
		if (Place == 175 && this.isHere()) {
			if (sType === "") {
				md = WritePlaceHeader();
				this.showPerson("sofiainterrogation.jpg");
				addPlaceTitle(md, "Sofia in the Interrogaton Room");
				if (!this.checkFlag(25)) {
					this.setFlag(25);
					md.write("<p>A raging and desperate looking Sofia stands next to the oval-desk used for questioning suspects. She is in her everydays clothes, looking even more elegant than usual. Her mad face is just an icing to the cake. You\u2019ve driven her into a corner and she has nothing to protect her from you now. You tell her,</p>" + '<p>"You gave me quite a headache, Sofia! With that ring of yours, but now I know the truth about you, I know who you are." Sofia cuts into your speech.</p>' +
						'<p>"Spare me with your monologue! I know what will happen to me, but please, I ask you of one favor! Don\u2019t hurt Sarah, I beg of you! She and Master Ronald helped me in my darkest days, I owe them my life."</p>' + "<p>You answer, \"Still loyal to the end I see! That\u2019s a rare and remarkable feat nowadays! Don\u2019t worry, I will 'protect' Sarah!" + (isMurderPath(true) ? '" You continue with a lie, "' : " ") + 'I\u2019ve killed her uncle after all and she must feel lonely. Yes, I did it! It was an accident, I didn\u2019t want that to happen, but I can\u2019t turn back time\u2026and the poor man\u2019s death was inevitable anyways. There are far more dangerous people out there than me." you ramble about Mr Beasley, Davy and Kurndorf to Sofia in a few short sentences. Sofia\u2019s shocked face turns to sorrow first and into anger later. She says,</p>' +
						'<p>"You killed Senor Gates?! Que condenar al infierno! But\u2026 I guess\u2026I can\u2019t do anything about it now either\u2026If there are far more evil men out there as you have said, and I heard of this Kurndorf before from Sarah, then I can only pray that Sarah only falls into your hands rather than theirs. At least I get to be with her again\u2026" Sofia turns silent. You give her time to process everything. Her sudden realisation of her hopeless situation sinks into her mind.</p>' + '<p>"There\u2019s no turning back, nowhere to go\u2026I\u2019m tired of running</p>' +
						"<p>" + perYou.getPersonName() + '\u2026 Will I feel anything? Am I going to be still me?" you see that Sofia finally given up all hope and accepted her fate. Her questions hit you, because you still don\u2019t understand how your powers work on others. You decide to tell her the truth,</p>' + '<p>"I don\u2019t know. I haven\u2019t figured it out yet. You will be completely happy in your service to me. Your only goal will be to do everything I tell you to do, but the spell affects each person differently. Your thoughts will change, but I believe it will be still you...just under my control."</p>' +
						'<p>"Let\u2019s get this over with\u2026I will still hate you for the rest of my life\u2026" Sofia growls at you as a final comeback. You know it\u2019s not going to be true.</p>')
				} else md.write("<p>A raging and desperate looking Sofia stands next to the oval-desk used for questioning suspects. She is in her everydays clothes, looking even more elegant than usual. Her mad face is just an icing to the cake. You\u2019ve driven her into a corner and she has nothing to protect her from you now.</p>");
				startQuestions();
				addLinkToPlaceC(md, "exit the interrogation room", 168);
				WritePlaceFooter(md);
				return true
			}
			if (sType === "charm1") {
				md = WritePlaceHeader();
				this.showPerson("sofia_charm1.jpg");
				addPlaceTitle(md, "Sofia Under a Charm Spell");
				md.write("<p>You cast your spell and wait what happens next. It doesn\u2019t take much time to see the difference in Sofia. She looks at you with wild eyes, like a predator to it\u2019s pray, ready to jump any second. Little moans here and there leaves her mouth. She is starting to feel the spell\u2019s effect. She pushes herself towards you, thus her boobs have a hard time staying in the bra.</p>");
				startQuestions();
				addLinkToPlace(md, "wait further in silence", 175, "type=charm2");
				WritePlaceFooter(md, "", false, true);
				return true
			}
			if (sType === "charm2") {
				md = WritePlaceHeader(false, "td-left-med");
				this.showPerson("sofia_charm2.jpg");
				addPlaceTitle(md, "Sofia Under a Charm Spell");
				md.write("<p>Sofia becomes aroused every passing minute. Gasping for air, she climbs the table and removes the jacket she was wearing.</p>" + '<p>"Hmm\u2026 All those silly thoughts fade away, mi amor\u2026 " Sofia can\u2019t hold herself any longer. Her nipples are visible, erect and fall out the bra. She doesn\u2019t care about that. She purrs like a hungry kitten. The position she takes reminds you of one\u2026</p>');
				startQuestions();
				addLinkToPlaceC(md, '"You are one hot slut, you know that?"', 175, "type=charm3");
				WritePlaceFooter(md, "", false, true);
				return true
			}
			if (sType === "charm3") {
				md = WritePlaceHeader(false, "td-left-med");
				this.showPerson("sofia_charm2.jpg");
				addPlaceTitle(md, "Sofia Under a Charm Spell");
				md.write('<p>"Soy un esclavo, mi amor\u2026I understand everything now. What\u2019s my life, my duty\u2026" Sofia speaks her mother language like she is reading some kind of poem. It\u2019s music to your ears. You take your time to listen what she is saying, but suddenly she tears her shirt off. Sofia pulls up her bra, finally, her breasts open to you. She holds them to you like some kind of an offering.</p>' +
					'<p>"Por favor\u2026use me\u2026 I can\u2019t hold it much longer\u2026" she begs.</p>');
				startQuestions();
				addLinkToPlaceC(md, perYou.isMaleSex() ? '"Swear your allegiance to me, slave. Suck my cock now!"' : '"Swear undying loyalty to me now, slave! Use your mouth!"', 175, "type=charm4");
				WritePlaceFooter(md, "", false, true);
				return true
			}
			if (sType === "charm4") {
				md = WritePlaceHeader(false, perYou.isMaleSex() ? isExplicit() ? "td-left-med" : "" : "td-left-large");
				if (perYou.isMaleSex()) this.showPersonRorX("sofia_charm_male1.jpg");
				else this.showPerson("sofia_charm_female1.jpg");
				addPlaceTitle(md, "Sofia Under a Charm Spell");
				if (perYou.isMaleSex()) md.write("<p>Sofia obeys your order without hesitation. She kneels down and starts to suck your cock. The joy this brings to you can\u2019t be described. You are definitely in heaven right now. She services your cock like it\u2019s some kind of an instrument and she plays the most beautiful song you ever heard during a blowjob. The sound her mouth makes just add to the effect.</p>" +
					'<p>"Yo, Sofia\u2026 me entrego \u2026 a .. ti\u2026 para siempre\u2026 Amo" she stops between each word to satisfy you with her lips. Though you did not ask her to swear loyalty to you in spanish, it actually sounds more sensual and passionate. Her loyal and caring personality just becomes even more submissive.</p>');
				else md.write("<p>Sofia obeys your order without hesitation. She kneels down and slowly caressing your clit with her mouth in the process. You lay on the chair and enjoy her service. Her commitment is inspiring. She twirls her tongue like a professional and uses her hands to help your vagina relax. As if that wasn\u2019t enough to convince you of her skills, her muffled voice can be heard when she takes short pauses.</p>" +
					'<p>"Yo, Sofia\u2026 me entrego \u2026 a .. ti\u2026 para siempre\u2026 Ama!" You pull her closer to you and kiss her. She swear her loyalty to you in spanish, which sounds even more sensual and passionate than english. You can feel your own juice from taste of her lips. You\u2019ve let this kitty grow into a tigress!</p>');
				startQuestions();
				addLinkToPlace(md, perYou.isMaleSex() ? "keep on enjoying the experience" : "let her finish pleasuring you!", 175, "type=charm5");
				WritePlaceFooter(md, "", false, true);
				return true
			}
			if (sType === "charm5") {
				md = WritePlaceHeader();
				if (perYou.isMaleSex()) this.showPersonRorX("sofia_charm_male2.jpg");
				else this.showPerson("sofia_charm_female2.jpg");
				addPlaceTitle(md, "Sofia Under a Charm Spell");
				if (perYou.isMaleSex()) md.write("<p>This is it then. This is literally an awesome blowjob you are receiving. You gently help Sofia by placing your hand on her head and push it to her limits. She chokes on your dick several times, but doesn\u2019t give up. Sofia would be on your dick all day if you wish, but all good things come to an end. You can\u2019t hold it anymore and let your glorious load land on her face. She playfully finish you off and smiles while she eats your spunk from her face. With that done, she looks up, waiting for your orders. She would go for a second round if you would not be depleted! You\u2019ve let this kitty grow into a tigress!</p>");
				else md.write("<p>After you break the kiss, Sofia continues her duty as your slave and finishes what she started. Loud moans and long silences follow. This is your victory show and you want to enjoy it as much as you can! The exotic Sofia shoves her face into your pussy and after a while of that, she goes to work on your erect nipples. She sucks on them and returns to sucking your pussy. That\u2019s her working routine for the rest of the intercouse. You loose track of time and when you are finally ready to cum, she cums with you. Sweet juices flow from each of your bodies, Sofia swallowing yours eagerly.</p>");
				startQuestions();
				addLinkToPlaceC(md, '"Heh! That was amazing! I\u2019m going to need this regularly!"', 175, "type=charmend");
				WritePlaceFooter(md, "", false, true);
				return true
			}
			if (sType === "charmend") {
				md = WritePlaceHeader();
				this.showPerson("sofia_charm_ending.jpg");
				addPlaceTitle(md, "Sofia Under a Charm Spell");
				this.moveThem(14);
				perYou.completeQuest(7);
				md.write('<p>"I\u2019m always ready, ' + perYou.getMaster() + "! My body is strong and my appetite is constant!\u201d she cleans herself off. Your freshly acquired slave squeezes her boobs for the final time for you to enjoy. She is the definition of a latin lover!</p>" +
					'<p>You ask her, "What to do with you now? How can I use you?"</p>' + '<p>Sofia replies, "What you have always wanted, ' + perYou.getMaster() + '. I can feel it, you want me to be your personal chauffeur. I would gladly take that role. I would be more than happy if I could accompany you on your journeys."</p>' + '<p>You are surprised at her words, "How did you know what I had planned for you?"</p>' + '<p>"I\u2019m Mexican, not stupid ' + perYou.getPersonName() + '. It was obvious since the first time you laid your eyes on me. You dreamed about me being in your service. I saw that.", she has a witty sense of humour and you like it so far. Her shy nature has opened up a bit, she\u2019s braver than before. You guess she would only speak to you in this manner, not anyone else.</p>' +
					'<p>You tell her, "Hey! No need to be so harsh! I can still punish you anytime remember?"</p>' + '<p>"Yes! I know, sorry I have to learn my place! I\u2019m adjusting! I will be waiting for you every morning at your house, my ' + perYou.getMaster() + '! If I\u2019m not there, then I\u2019m at my office, waiting for your further commands!"</p>' + '<p>Of course you answer "Sounds great, but risky. What if anyone notices a luxurious car in front of my house?"</p>' + '<p>Sofia says, "Si, ' + perYou.getPersonName() +
					'! It\u2019s a problem, but what about I park inside your house\u2019s garage and wait for you there? Your mother takes the family car away to her workplace I presume?"</p>' + '<p>You correct her, "No, we do not currently own a car, Mom walks to work. So that should work. Give me your number. I may have to call you for help sometimes. Here\u2019s the keys to my garage! Ohh and don\u2019t worry about those charges. Everything\u2019s arranged. You are no longer a suspect."</p>' + "<p>Sofia bursts out in joy, saying prayers to you in spanish and hugging you for a long time. You gave her a new life, a fresh start. After that you exchange numbers with her. The two of you chat about some small matters, but ultimately, you tell her to get back to work. With a hot farewell kiss, she leaves and goes back to her office. You now own a personal driver, all to yourself!</p>");
				startQuestions();
				addLinkToPlaceC(md, "leave the interrogation room", 168);
				WritePlaceFooter(md, "", false, true);
				return true
			}
		}
		if (sType == "sofialimosex") {
			md = WritePlaceHeader();
			this.showPerson("sofia-limosex.jpg");
			addPlaceTitle(md, "Sofia in the Backseat");
			md.write("<p>You ask Sofia to join you in the backseat of the limo. Dutifully she joins you, her expression clearly shows she knows what her duties will be.</p>");
			startQuestionsOnly();
			addLinkToPlace(md, '"Sofia, time to sit in my lap"', Place, "type=sofialimofuck");
			addLinkToPlace(md, '"Sofia, help me get comfortable"', Place, "type=sofialimobj");
			if (perYou.isMaleSex()) addLinkToPlace(md, '"Sofia, let me park something in your cleavage"', Place, "type=sofialimotitfuck");
			WritePlaceFooter(md, "", true, true);
			return true
		}
		if (sType == "sofialimofuck") {
			md = WritePlaceHeader(false, !isExplicit() && perYou.isMaleSex() ? "" : "td-left-large");
			if (perYou.isMaleSex()) this.showPersonRorX("sofia-limosex-fuckb.jpg");
			else this.showPerson("sofia-limosex-fuckg.jpg");
			addPlaceTitle(md, "Riding Sofia");
			md.write("<p>You tell Sofia it is time for her to sit on your lap, in a somewhat intimate way.</p>");
			startQuestionsOnly();
			addLinkToPlaceC(md, "continue on your way", Place);
			WritePlaceFooter(md, "", false, true);
			return true
		}
		if (sType == "sofialimobj") {
			md = WritePlaceHeader(false, perYou.isMaleSex() ? "td-left-large" : "");
			if (perYou.isMaleSex()) this.showPersonRorX("sofia-limosex-bjb.jpg");
			else this.showPersonRorX("sofia-limosex-bjg.jpg");
			addPlaceTitle(md, "Sofia's Comfort");
			md.write("<p>You ask Sofia to help you get comfortable, and she kneels down ready to make you feel a lot more relaxed.</p>");
			startQuestionsOnly();
			addLinkToPlaceC(md, "continue on your way", Place);
			WritePlaceFooter(md, "", false, true);
			return true
		}
		if (sType == "sofialimotitfuck") {
			md = WritePlaceHeader();
			this.showPersonRorX("sofia-limosex-titfuck.jpg");
			addPlaceTitle(md, "Parking in Sofia's Cleavage");
			md.write("<p>You discuss parking with Sofia, and she gestures towards a garage. You instead gesture at her large breasts and suggest parking your cock <i>there</i>!</p>");
			startQuestionsOnly();
			addLinkToPlaceC(md, "continue on your way", Place);
			WritePlaceFooter(md, "", false, true);
			return true
		}
		if (Place != 14) return false;
		if (sType == "sofiafuck") {
			md = WritePlaceHeader(false, "td-left-large");
			if (perYou.isMaleSex()) this.showPerson("sofia-officesex-fuckb.jpg");
			else this.showPerson("sofia-officesex-fuckg.jpg");
			addPlaceTitle(md, "Riding Sofia");
			md.write("<p>There is more than one way to go for a ride with Sofia, and some do not even need you to leave the office.</p>");
			startQuestions();
			addLinkToPlaceC(md, "talk more with Sofia", Place);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "sofiabj") {
			md = WritePlaceHeader(false, perYou.isMaleSex() ? "" : "td-left-large");
			if (perYou.isMaleSex()) this.showPersonRorX("sofia_charm_male1.jpg");
			else this.showPerson("sofia_charm_female1.jpg");
			addPlaceTitle(md, "Sofia's Lift");
			md.write("<p>You ask Sofia to give you a lift, she moves to get her keys and then sees you removing your clothing. She realises what you want her to lift and she steps over and kneels down ready to lift <i>you</i>.</p>");
			startQuestions();
			addLinkToPlaceC(md,
				"talk more with Sofia", Place);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "sofiatitfuck") {
			md = WritePlaceHeader();
			this.showPersonRorX("sofia-officesex-titfuck.jpg");
			addPlaceTitle(md, "Parking in Sofia's Cleavage");
			md.write("<p>You discuss parking with Sofia, and she gestures towards the garage. You instead gesture at her large breasts and suggest parking your cock <i>there</i>!</p>");
			startQuestions();
			addLinkToPlaceC(md, "talk more with Sofia", Place);
			WritePlaceFooter(md);
			return true
		}
		if (sType != "breakin") return false;
		if (getHour() > 9) {
			ClearComments();
			md = WritePlaceHeader(false, "td-left-med");
			this.showPerson("sofiafail.jpg");
			addPlaceTitle(md, "Too Late!");
			md.write("<p>You hear a car arriving and parking inside the garage. Damn! You are too late, Sofia is back! A few silent moment passes as you try think your way out of this, but suddenly you hear Sofia\u2019s hig-heeled shoes rapidly clacking and withing a second, she is standing in front of you.</p>" + '<p>"You?! Here?!! I should have known better\u2026you won\u2019t leave me alone won\u2019t you?" she huffs and puffs. Sofia angrily puts her hands on her waist and blocks the exit.</p>' +
				'<p>"Well! You will never get me, you bastard! I see no other choice, I have to move on!" with her sentence finished, Sofia shuts the door behind her and runs away. Before you could realise what\u2019s happening she already hopped in the car and you hear tires screeching and an engine running. She drives away! Sofia left and you are pretty sure you will never see her again. What a shame! She could have been a trustworthy servant\u2026</p>');
			this.moveThem(999);
			startQuestions();
			addLinkToPlace(md, "leave the garage",
				15);
			WritePlaceFooter(md);
			return true
		}
		if (this.checkFlag(18) && this.checkFlag(19) && this.checkFlag(22)) {
			md = WritePlaceHeader();
			this.setFlag(15);
			addPlaceTitle(md, "Complete!", "steeldoor.jpg");
			md.write("<p>Okay! You\u2019ve got enough evidence against Sofia. You organize everything back to it\u2019s place, as if you were never here and exit through the front door! Now it\u2019s the time to put the second part of your plan in motion!</p>");
			startQuestions();
			addLinkToPlace(md, "get out of here", 15);
			WritePlaceFooter(md);
			return true
		}
		var sArea = getQueryParam("area");
		if (sArea == "office") {
			md = WritePlaceHeader(false, "td-left-med");
			addPlaceTitle(md, "Sofia's Office", "sofiasoffice.jpg");
			md.write("<p>The room looks like a small work station with few basic furniture, a coffee table, chairs, some houseplants and one or two paintings. There is a door which leads to the upper floor of the place. That is where Sofia\u2019s bedroom is located. Other than that there\u2019s another wooden door that connects the office with garage, where the family\u2019s cars are stored.</p>");
			if (this.isCharmedBy()) md.write("<p>Sofia is not here in her office. She must be out doing some errands. The office is just as you have remembered; bright and colorful. There's nothing remotely interesting upstairs to you and you don't want to rummage Sofia's bedroom again.</p>");
			startQuestions();
			addLinkToPlace(md, "examine the coffee table", 14, "type=breakin&area=office", "<img src=\\'Images/Items/coffeetable.jpg\\' style=\\'width:50%;float:right;margin:0 0 1em 5px\\' alt=\\'Table\\'>Aside from a few books and magazines, there\u2019s nothing interesting on the coffee table. It looks pretty cool though, but that doesn\u2019t help you now.",
				"", "", undefined, undefined, true);
			addLinkToPlace(md, "check the wooden door", 14, "type=breakin&area=office", "<img src=\\'Images/woodendoor.jpg\\' style=\\'width:25%;float:right;margin:0 0 1em 5px\\' alt=\\'Door\\'>You are pretty sure there\u2019s nothing relevant at the other side of that door at the moment. You will run out of time if you mess around too much. You can explore the Garage later.", "", "", undefined, undefined, true);
			if (whereItem(61) === 0) addLinkToPlace(md, "look at the houseplants", 14, "type=breakin&area=office",
				"<img src=\\'Images/Items/houseplants.jpg\\' style=\\'width:50%;float:right;margin:0 0 1em 5px\\' alt=\\'Plants\\'>Small green plants occupy one of the shelf. It looks like Sofia has been taking good care of them. They give the room a warm feeling and nice colour. There is shiny object behind of them.", "", "setPersonFlag('Sofia',16)", undefined, undefined, true);
			else addLinkToPlace(md, "look at the houseplants", 14, "type=breakin&area=office", "<img src=\\'Images/Items/houseplants.jpg\\' style=\\'width:50%;float:right;margin:0 0 1em 5px\\' alt=\\'Plants\\'>Small green plants occupy one of the shelf. It looks Sofia has been taking good care of them. They give the room a warm feeling and nice colour.",
				"", "", undefined, undefined, true);
			if (!this.isCharmedBy()) {
				if (whereItem(61) === 0 && this.checkFlag(16)) addLinkToPlace(md, "inspect the shiny object", 14, "type=breakin&area=office", "<img src=\\'Images/Items/brasskeyontable.jpg\\' style=\\'width:50%;float:right;margin:0 0 1em 5px\\' alt=\\'Key\\'>What do we have here\u2026 some kind of key, hidden behind one of the plants.", "", "PlaceI(61,14)", undefined, undefined, true);
				addLinkToPlace(md, "go upstairs", 14, "type=breakin&area=upstairs")
			}
			WritePlaceFooter(md);
			return true
		}
		if (sArea ==
			"upstairs") {
			md = WritePlaceHeader(false, "td-left-med");
			AddImage("sofiasbedroom.jpg");
			if (this.checkFlag(17)) AddImage("Items/briefcase.jpg", "50%");
			addPlaceTitle(md, "Sofia's Bedroom");
			md.write("<p>This must be Sofia\u2019s bedroom. It has a great cozy feel to it and a relaxing vibe fills the air. It\u2019s small, but comfy and Sofia has a great taste in colour.</p>");
			startQuestions();
			addLinkToPlace(md, "look under the bed", 14, "type=breakin&area=upstairs", "<img src=\\'Images/Items/briefcase.jpg\\' style=\\'width:50%;float:right;margin:0 0 2em 5px\\' alt=\\'Briefcase\\'>After a few moments of rummaging through the boxes which are under Sofia\u2019s bed you find a briefcase. It\u2019s locked.",
				"", "setPersonFlag('Sofia',17)", undefined, undefined, true);
			addPopupLink(md, "inspect laptop", "Emails", "<img src='Images/sofiasemail.png' style='width:100%;margin:0 0 1em 0' alt='Email'>" + "There\u2019s a Laptop at the end of the nightstand, connected to a power dispenser. The computer is on, so you decide to dive into Sofia\u2019s letters. Upon a thorough search through her emails, you find a compromising letter sent to Sarah Gates from Sofia! It\u2019s only a few days old, so it must have been written after the death of Sir Gates.",
				true, "setPersonFlag('Sofia',19)");
			addLinkToPlace(md, "check out the wardrobe", 14, "type=breakin&area=upstairs", "<img src=\\'Images/wardrobe.jpg\\' style=\\'width:50%;float:right;margin:0 0 2em 5px\\' alt=\\'Wardrobe\\'>There are dresses, shoes, boxes all perfectly organized inside the wardrobe. There are also at least 2 or 3 copies of the same uniform Sofia is wearing as  the chauffeur dress. These must be the reserved ones. Hmm\u2026wait, there\u2019s something else that catches your eyes! There are small scratch marks behind one of the shelf. You can\u2019t see clearly what it is, but it must be something worth investigating!",
				"", "setPersonFlag('Sofia',20)", undefined, undefined, true);
			if (this.checkFlag(21)) addLinkToPlace(md, "enter secret area", 14, "type=breakin&area=secretroom");
			addLinkToPlace(md, "go downstairs", 14, "type=breakin&area=office");
			WritePlaceFooter(md);
			return true
		}
		if (sArea == "secretroom") {
			md = WritePlaceHeader(false, "td-left-med");
			addPlaceTitle(md, "Sofia's Bedroom", "sofiassecretroom.jpg");
			md.write("<p>The hidden room feels more like a great hideaway spot rather than an actual room. It\u2019s quite obvious that someone lived here for a while. There are food and books packed together in a corner and a hastily made bed has been used several times. You decide to scour trough the columns of book. Most of them are fictional novels, travel guides or spiritual essays, but one book catches your attention. It\u2019s Sofia\u2019s handwritten diary!</p>");
			startQuestions();
			addPopupLink(md, "read the diary", "Sofia's Diary", "<img src='Images/sofiasdiary.jpg' style='width:100%;margin:0 0 1em 0' alt='Diary'>" + "Sofia\u2019s diary details her experiences in a new country as an outsider. Her life seems to be a harsh one, all alone in an unkown world and now one of her closest friend is dead. You feel a bit emphatic towards her and understand her motives after you\u2019ve read into her diary.", true, "setPersonFlag('Sofia',22)");
			addLinkToPlace(md, "return to the bedroom",
				14, "type=breakin&area=upstairs");
			WritePlaceFooter(md);
			return true
		}
		return false
	};
	per.handleItem = function(no, cmd) {
		if (cmd != 2) return "";
		if (no == 14) {
			if (Place == 14 && this.isHere() && !this.isCharmedBy()) {
				ClearComments();
				dispPlace(Place, "type=charm");
				return "nofooterconverse"
			}
			if (Place == 175 && this.isHere()) {
				ClearComments();
				CastCharmSpell("Sofia", 175, 1, "type=charm1");
				return "nofooterconverse"
			}
		} else if (no == 11) {
			if (Place == 15)
				if (getHour() > 7 && getHour() < 10 && this.checkFlag(14) && !this.checkFlag(15) && this.whereNow() != 999) {
					this.setFlag(23,
						false);
					ClearComments();
					dispPlace(14, "type=breakin&area=office");
					return "nofooterconverse"
				} else {
					if (this.isCharmedBy()) addComments("Upon entering the Garage area through the main door after Sofia has been charmed and she is not currently there.</p><p>The Player can only stay at the office, the upstairs area is not interesting to them anymore.");
					else addComments("It is too dangerous, Sofia could return anytime");
					return "handled"
				}
		} else if (no == 61 && Place == 14 && this.checkFlag(17) && sType == "breakin" && getQueryParam("area") ==
			"upstairs") {
			addComments("<img src='Images/files.jpg' style='width:50%;float:right;margin:0 0 1em 5px' alt='Files'>The key fits the lock and the briefcase cracks open! There are dozens of files inside and among them there is a fake passport too. You read some of these and it turns out that Sofia had trouble with the law before! She crossed the country\u2019s border illegally and authorities were looking for her! The documents all date back about a year ago, that would explain why you or Mayor Thomas didn\u2019t know her! She is a newcomer to this country!");
			this.setFlag(18);
			return "handled"
		} else if (no == 15 && Place == 14 && !this.checkFlag(21) && sType == "breakin" && getQueryParam("area") == "upstairs") {
			addComments("<img src='Images/hiddendoor.jpg' style='width:25%;float:right;margin:0 0 1em 5px' alt='Door'>The whole wardrobe is rigged to a mechanism! The shelf reveals a small switch. As you push it, the wardrobe splits open with a loud squeak. It leads to a secret area.");
			this.setFlag(21);
			return "refresh"
		}
		return ""
	};
	per.showPersonChat = function(bGeneral, md) {
		if (Place ==
			14 && this.isHere() && sType === "") {
			var ss = perYou.isMaleSex() ? "se\u00f1or" : "se\u00f1orita";
			if (this.isCharmedBy())
				if (!this.checkFlag(9)) addQuestionR(md, '"I\u2019m a little bit worried..."', "You ask Sofia &quot;I\u2019m a little bit worried. Won\u2019t the people gossip about me if they see me in car like this?&quot;</p>" + "<p>Sofia answers, &quot;Don\u2019t, mi " + (perYou.isBornMale() ? "amo" : "Se\u00f1ora") + "! The windows are darkened, no one can see through them! And they will think that I still drive Sarah around and not you anyway. They don\u2019t care.&quot;</p>" +
					"<p>You then ask, &quot;What about you? The townsfolk hardly even know you, if only one of them start to question your actions and behaviour then it would cause a lot of pain to me.&quot;</p>" + "<p>Sofia answers &quot;You worry too much " + perYou.getPersonName() + "! You have more important matters to care about. These are things that I will take care of. You will never get into trouble while I\u2019m around. Just let me put my skills at your service and be your driver\u2026and sirvienta\u2026I mean your servant.&quot;",
					"Sofia", "setPersonFlag(\\'Sofia\\',9)");
				else if (!this.checkFlag(10)) addQuestionR(md, '"You speak our language very well. How come?"', "&quot;Sofia: Gracias, mi " + (perYou.isBornMale() ? "amo" : "Se\u00f1ora") + "! I had big dreams when I decided to come here. You see, back in my home country, M\u00e9xico, there was no chance I could live the life I wanted to be. The poverty grew while the opportunities became thinner each passing day. I knew I had to leave. So I started to self educate myself in many things, for example your language. My ambitious plan was to become a citizen here and go to university\u2026I yearned to become a lawyer.&quot;</p>" +
				"<p>You query, &quot;Lawyer, huh? That\u2019s a far stretch from where you are now.&quot;</p>" + "<p>Sofia answers &quot;I\u2026emm\u2026you are correct, as always\u2026in everything. Still, this chica ain\u2019t that stupid as she look and can still be an asset to you!&quot; Sofia playfully shows her body with her hands. She continues.</p>" + "<p>&quot;I don\u2019t care about my stupid dreams anymore. I want nothing else than to be of service to you and if that means all I will do for the rest of my life is drive you around then I will do it with the biggest smile on my face. I just wanted to point out that I have a brain that you can also use anytime!&quot; Sofia grins like a little devil.</p>" +
				"<p>You say &quot;I know\u2026I know. Maybe one day, if I\u2019m in a good mood, I will let you fulfill some of those old ambitions you had. I could always use a well educated girl like yourself you see\u2026&quot;</p>" + "<p>Sofia answers &quot;I hope so. I didn\u2019t come this far and become your slave to not fulfill my destiny! I\u2019m going to climb the ranks of your harem and become a head-slave to you!&quot; Sofia proudly presents her wish to you. You know she is half-joking, but you like the idea of having some kind of order in your harem.",
				"Sofia", "setPersonFlag(\\'Sofia\\',10)");
			else {
				addLinkToPlace(md, '"Sofia, time for a ride"', Place, "type=sofiafuck");
				addLinkToPlace(md, '"Sofia, give me a lift"', Place, "type=sofiabj");
				if (perYou.isMaleSex()) addLinkToPlace(md, '"Sofia, let me park something in your cleavage"', Place, "type=sofiatitfuck");
				addSleepLink(md, "take Sofia upstairs to bed for the night", "Bedding Sofia", '<p style="position:absolute;left:30%;bottom:2em;cursor:pointer;font-size:1.1em;width:65%">You take upstairs to her bedroom and tell her to strip and get ready for you. She gets ready to take you wherever you wish this night.',
					this.getImg("sofia-bed.jpg"))
			} else if (!this.checkFlag(2)) addQuestionR(md, "\"Ohhh\u2026.hi! The name's " + perYou.getPersonName() + '! I haven\u2019t seen you around before."', "&quot;\u00bfQui\u00e9n eres?! \u00bfQu\u00e9 haces aqu\u00ed?!&quot;, the woman barks at you in language you don&rsquo;t understand. It&rsquo;s spanish. She looks startled and it feels like you have caught her in a middle of something. Her expressions changes quickly and continues in broken english.</p>" + "She continues, &quot;Sorry " +
				ss + ". No hablo muy bien ingles\u2026I don&rsquo;t speak english good\u2026I\u2019m Sofia. How I help you?&quot;, she calms down a bit. Now she seems more terrified you of than being angry. She nervously tip-toes and gathers her thoughts.", "Chauffeur Sofia", "setPersonFlag(\\'Sofia\\',2)");
			else if (!this.checkFlag(3)) addQuestionR(md, '"Who are you?"', "&quot;I be driver to Master Gates. He be my el Jefe\u2026I work for him\u2026Coche\u2026Carro\u2026I mean car! You know!&quot;, Sofia gestures and acts like she is driving a car, even making weird sounds with her mouth. It\u2019s obvious you won\u2019t get a lot of information from her.",
				"Chauffeur Sofia", "setPersonFlag(\\'Sofia\\',3)" + (!isMurderPath() ? ";setPersonFlag(\\'Sofia\\',4);setPersonFlag(\\'Sofia\\',5)" : ""));
			else if (!this.checkFlag(4)) addQuestionR(md, '"I\u2019m sorry for your loss..."', "&quot;I&rsquo;m sorry for your loss. I didn\u2019t know Sir Ronald well, but he seemed like a nice person.&quot; you lie. Maybe you could get some emotion out of her with this topic.</p>" + "<p>She replies &quot;S\u00ed! Ronald fue un gran hombre! He was special\u2026and I was not here when he died\u2026es una pena\u2026I could not help him\u2026I be away far!&quot; The raven-haired woman\u2019s emotions look very real. She grasps the back of one of the chairs in her nervousness. It is clear that she is in a lot of pain..",
				"Chauffeur Sofia", "setPersonFlag(\\'Sofia\\',4)");
			else if (!this.checkFlag(5)) addQuestionR(md, '"What do you mean? You were with Sarah?"', "She replies, &quot;Please " + ss + "! I don\u2019t want to talk anymore\u2026about it! \u00bfEn qu\u00e9 puedo ayudarle? Can I help you in anything else?&quot;. Sofia takes deep breaths between each sentence, like she is checking each word a thousand times before saying them.</p>" + "<p>You decide to drop the subject. She is of no use to you in this form anyways. The language differences only make it harder to cooperate.",
				"Chauffeur Sofia", "setPersonFlag(\\'Sofia\\',5)");
			else if (this.checkFlag(5)) {
				if (!this.checkFlag(6)) addQuestionR(md, '"What do you think about Sarah?"', "She replies, &quot;I like her! " + (isMurderPath() ? "She is my boss now. " : "") + "La se\u00f1ora Sarah is a kind lady! She shows  gran simpat\u00eda\u2026to me!&quot; Sofia is filled joy and smiles dreamily to herself.", "Chauffeur Sofia", "setPersonFlag(\\'Sofia\\',6)");
				if (!this.checkFlag(7) && (isMurderPath() && checkPersonFlag("Lauren", 1)) || !isMurderPath() &&
					checkPersonFlag("Lauren", 10)) addQuestionR(md, '"What about her relationship with Lauren?"', "She replies, &quot;No\u2026no\u2026 " + ss + ".  That is not your business. Leave this alone por favor!&quot;, her overprotective nature turns her into like a mother who is defending her child. She won\u2019t discuss this matter with you further.", "Chauffeur Sofia", "setPersonFlag(\\'Sofia\\',7)");
				if (!this.checkFlag(8)) addQuestionR(md, '"Can you show me around the garage? Can I see the cars?"', "She replies, &quot;Absolutely not! Only se\u00f1ora Sarah or someone who\u2026she aprobar\u2026you see... only who she approves!&quot; Sofia\u2019s fierce loyalty to her employers is admirable, but her stubbornness are getting on your nerves!",
					"Chauffeur Sofia", "setPersonFlag(\\'Sofia\\', 8)")
			}
		}
		if (Place == 110 && wherePerson("Mayor") == 110 && !this.checkFlag(11) && perYou.isQuestStarted(7) && isCharmedBy("Mayor") && sType === "") addLinkToPlaceC(md, '"Do you know a woman named Sofia, my dear slave?"', 110, "type=asksofia1");
		if (Place == 95 && this.checkFlag(12) && !this.checkFlag(13)) addLinkToPlaceC(md, '"Yes! Where do you know her from?"', 95, "type=asksofia2");
		if (Place == 168 && this.checkFlag(13) && !this.checkFlag(14) && wherePerson("OfficerBatton") == 168) addLinkToPlaceC(md,
			"discuss your plans for Sofia", 168, "type=asksofia3");
		if (Place == 192)
			if (this.checkFlag(1)) {
				if (!this.checkFlag(26) && !isCharmedBy("Sarah") && !isMurderPath()) addQuestionR(md, '"What can you tell me about Sofia, the family chauffeur?"', "Sarah tells you, &quot;What a nosy little apprentice you are! She is just a simple woman who serves my uncle. You don\u2019t have to worry about her, she is harmless and doesn\u2019t speak our language.&quot;</p>" + "<p>You reply, &quot;She sure is memorable from the rest of us. I mean her dark skin and interesting looks\u2026&quot;</p>" +
					"<p>Sarah answers &quot;Drop it " + perYou.getPersonName() + "! Don\u2019t you ever think about charming her or my uncle and I will make sure that you will never see daylight again. Sofia\u2019s a friend and I will protect her from you if I have to.&quot;", "Sarah", "setPersonFlag(\\'Sofia\\',26)");
				if (isCharmedBy("Sarah") && !this.isCharmedBy() && !this.checkFlag(27)) addQuestionR(md, '"Sarah, can you help me bring Sofia under my control?"', "You ask &quot;Sarah, can you help me bring Sofia under my control? She is wearing a ring that protects her from my spells.&quot;</p>" +
					"<p>Sarah answers &quot;Please, believe me " + perYou.getMaster() + " I really want to help, but some part of me inside protests against charming my beloved friend. I can\u2019t really understand my feelings myself too, but I\u2019m afraid I am no use to you\u2026&quot;</p>" + "<p>You tell her, &quot;You are my slave\u2026I don\u2019t understand. You have to obey if I tell you something. What\u2019s wrong with you?!&quot;</p>" + "<p>Sarah pleads, &quot;I beg of you, " + perYou.getMaster() + " to forgive me! It looks like there\u2019s still a side of me left that you can\u2019t control\u2026 or at least parts of my old self remains. I will have to look into further, but it\u2019s just that I can\u2019t open my mouth and tell you anything when I think about Sofia\u2026&quot;</p>" +
					"<p> You tell her,  &quot;I\u2019m disappointed in you, Sarah. We will have to return to this matter one day soon. Rarely do my slaves reject my orders\u2026You are a strong person\u2026 &quot;</p>" + "<p>Sarah replies,  &quot;My uncle taught me a lot of things. This must be one of his tricks that I\u2019m not fully under your control. About Sofia\u2026I know what\u2019s coming is inevitable. She will join me soon, I know you will find a way, " + perYou.getMaster() + ". Again, forgive me for that I can\u2019t aid you more. &quot;",
					"Sarah", "setPersonFlag(\\'Sofia\\',27)")
			}
	};
	per.isPhoneable = function() {
		return perYou.isQuestComplete(7) && isOutside()
	};
	per.callThem = function() {
		WaitHereOnly(3);
		carRide("Sofia", "Sofia arrives shortly after your call. She\u2019s pretty precise and you didn\u2019t have to wait for her too long. She closes the door for you and after saluting to you, she occupies the driver\u2019s seat and turns her head. &quot;Where do you wish to go?&quot;", ". After you have chosen a selected designation and you arrive at said destination.</p><p>After opening the door for you and waits for you to ready yourself, Sofia hops back into the car and drives off to let you stay low profile.")
	};
	per.addPersonPhoneCall = function() {
		if (Place == 14 && !this.checkFlag(23) && sType == "breakin" && nTime % 288 > 113)
			if (makeCall(true, 210)) this.setFlag(23);
		return false
	}
}

function RepliesTessAdams(nR) {
	var perT = per;
	var myName = perT.getYourNameFor();
	var perJ = findPerson("JohnAdams");
	var ret = true;
	if (nR == 2100) {
		addComments('<p>"Oh darn. Yes, please, ' + myName + '. How silly of me, I seem to have dropped everything."</p>' + "<p>You help her to pick up the fallen items, while doing so you cannot help admiring the sweet and rather beautiful librarian.</p>" + "<p>While she finishes replacing the last of the items, you comment about how nervous Monique was and how she mentioned some stories Mrs. Adams had told. She smiles,<br>" +
			'"Monique and I are really interested in magic, and my husband likes to collect things that have some association with the old covens. I have read a number of books on witchcraft and the ways old sorcerers used to encode their works."</p>');
		perT.setFlag(1)
	} else if (nR == 2101) {
		addComments('"Magic! Oh I wish I did because then I could help people and save the poor wild animals in danger. The books talk about so many things, ways to walk through walls and rescue people, and darker things like necromancy and possession"');
		perT.setFlag(2)
	} else if (nR == 2105) {
		addComments("<p>You mention that you have an old work talking of magic, not mentioning the exact book. Since she had mentioned a knowledge of protecting the contents that she might help look something up.</p>" + '<p>"Of course, ' + myName + '. What do you want to know about?"</p>');
		if (!isRunes()) {
			bChatLeft = false;
			Place = 52
		} else {
			Research("Spell", "Serphoni");
			ret = false
		}
	} else if (nR == 6900) {
		addComments('"Oh, there is always a bit of a draft in this old building, isn\'t there? Sure, go ahead and close the door."</i> says Mrs Adams as she stands to get some books.</p><p>You close the door');
		if (Math.random() < .6) addComments(" and as you do you hear Mrs. Adams accidentally knock some books off her desk and she starts to pick them up. As people had said, she is a bit of a klutz.");
		else addComments(".");
		setPlaceFlag("Library", 1)
	} else if (nR == 2001) {
		addComments(perT.addPersonFace());
		addComments('"Whatever you say my love. I will search the files and report anything that I find.');
		perT.other = 5;
		perT.extra[0] = nTime
	} else if (nR == 2002) {
		bChat = false;
		addComments(perT.addPersonFace());
		if (perT.place ==
			230) {
			addComments('"As you wish ' + myName + '. I will leave right now."</p><p>She quickly dresses and you follow her out of the house.');
			Place = 229
		} else if (perT.place == 96) {
			addComments('"As you wish ' + myName + '. I will leave right now."</p><p>She quickly dresses and you follow her out to the Town Hall reception.');
			Place = 95
		} else {
			addComments('"As you wish ' + myName + '. I will leave right now."</p><p>She quickly dresses and you follow her out to the main area of the library.');
			Place = 3
		}
		if (!perT.checkFlag(8)) {
			perT.other =
				10;
			perT.extra[0] = 0
		} else perT.setFlag(6);
		perT.place = !perT.checkFlag(7) ? 45 : 46
	} else if (nR == 2003) {
		addComments(perT.addPersonFace());
		addComments('"As you wish ' + myName + '. I will only be a moment."');
		movePerson("MsTitus", 62);
		Place = 62
	} else if (nR == 2005) {
		addComments('"As you wish, my love."<br>');
		perT.other = 1
	} else if (nR == 2011) {
		addComments('"No, my darling. I don\'t know anything about items of magic but my...husband is a surveyor for the town council. He might know where there are sites of the old cults and where things have been found. He has a sort of hobby collecting some of the relics from the old days"');
		perT.other = 12
	} else if (nR == 2012) {
		bChat = false;
		addComments(perT.addPersonFace());
		addComments('"Yes ' + myName + '," she says with a twinkle in her eye. "As you command.". She gives you a kiss and leaves to see her husband.');
		Place = 46;
		perT.place = 124;
		perT.other = 13
	} else if (nR == 2013) {
		addComments('"Oh you will be so pleased, ' + myName + '. My...husband heard that something weird was handed in at the council office. He took it for me, so I rewarded him better than anyone else could have, it was to help you, you understand?", she looks at you imploringly. You smile and tell her she did well, he is still her husband...for now.</p>' +
			'<p>She looks relieved, "Should we go somewhere private for you to see it, the item that is?"');
		perT.other = 14;
		bChatLeft = false
	} else if (nR == 2014) {
		addComments('"Oh good ' + myName + '. Maybe you will let me make love to you there," she says, her voice dripping with desire as she takes you to a room in the hotel she must have already arranged');
		Place = 171
	} else if (nR == 2021) {
		addComments(perT.addPersonFace());
		addComments('Tess nods.  "Yes ' + myName + ". Hop in and I'll take you there immediately.\" she says.</p><p>Her hand quickly strays to your crotch once you enter the vehicle.</p>" +
			"<p>It is a short drive to her home, and she asks you to follow in a few minutes while she speaks with John. She sounds a little nervous with you meeting her husband so you agree and wait a little.");
		bChat = false;
		perT.other = 25;
		perT.place = 230;
		perJ.place = 230;
		setPlaceKnown("AdamsHouse");
		Place = 229
	} else if (nR == 10407) {
		bChatLeft = false;
		perJ.other = 8;
		perT.other = 27;
		addComments("<p>Tess nods excitedly and runs off to change. She returns in several minutes wearing a cheerleader outfit you recognize from your tryst at the hotel.</p>")
	} else if (nR ==
		10420) {
		bChat = false;
		if (Place == 230 && !perJ.isCharmedBy()) {
			perT.setFlag(13);
			addComments("You start to ask Tess to meet you back at you home, but she looks worried and looks at John and shakes her head. It seems you will have to deal with John first.");
			if (perT.other == 28) addComments("</p><p>She does briefly step out and changes into her cheerleader outfit as an apology, and a promise for later.");
			perT.other = 27
		} else {
			perT.place = 46;
			perT.setFlag(6);
			addComments(perT.addPersonFace());
			addComments('<p>Tess grins at you, her tongue running over her lips in anticipation.  "Yes ' +
				myName + ", I'll wear something special for you again,\" she says, grabbing a few things and leaving the house immediately.")
		}
	} else if (nR == 10421) {
		bChat = false;
		if (Place == 230 && !perJ.isCharmedBy()) {
			perT.setFlag(13);
			addComments("You start to ask Tess to meet you back at you home, but she looks worried and looks at John and shakes her head. It seems you will have to deal with John first.");
			if (perT.other == 28) addComments("</p><p>She does briefly step out and changes into her cheerleader outfit as an apology, and a promise for later.");
			perT.other = 27
		} else {
			addComments(perT.addPersonFace());
			if (perT.place == 230 && perT.other < 10) {
				addComments('<p>"Yes ' + myName + ', I will...but what about John..." she says. You tell her we will talk about him later, and she leaves grabbing a few things and exiting the office and you follow her out of the house.');
				Place = 229
			} else if (perT.place == 96) {
				addComments('<p>"Yes ' + myName + ', I will...but what about John..." she says. You tell her we will talk about him later, and she leaves grabbing a few things and exiting the office and you follow to the Town Hall reception.');
				Place = 95
			} else {
				addComments('<p>"Yes ' + myName + ", I'll look forward to speak to Karen and Monique again\" she says, grabbing a few things and leaving the house immediately.");
				perT.setFlag(8);
				if (Place == 170) Place = 46
			}
			perT.place = 0
		}
	} else if (nR == 10301) {
		PlaceI(32, 230);
		perJ.setFlag(1);
		addComments(perT.addPersonFace());
		addComments('"Of course, ' + myName + '.  I believe he may have kept an old silver ring in the safe.  It may be magical as he swore to me it seemed to glow when it was near the talking worm I showed you before."</p>')
	}
	return ret
}

function TessChangeClothes() {
	var perTess = findPerson("Tess");
	perTess.other = perTess.other == 27 ? 30 : 27
}

function initialiseTessAdams() {
	addPerson("Tess");
	per.Replies = RepliesTessAdams;
	per.getPersonName = function(full) {
		return full !== true && this.isCharmedBy() ? "Tess" : "Tess Adams"
	};
	per.getPersonAddress = function() {
		return isPlaceKnown("AdamsHouse") ? "2121 Rathdown Rd, Glenvale" : ""
	};
	per.whereNow = function() {
		if (this.place === 0) {
			if (isShopOpen(2, 1, true)) return this.isCharmedBy() ? 62 : 28;
			if (Place == 62) return 62;
			if (Place == 3 && this.isCharmedBy()) return 62;
			return this.checkFlag(6) ? 46 : 230
		}
		if (Place == 170 || Place == 171) return Place;
		return this.place
	};
	per.getPossessionFace = function() {
		return "tess-face"
	};
	per.passTimeNight = function() {
		if (this.place == 96) this.place = 230;
		return ""
	};
	per.isPlaceImageRight = function() {
		return Place == 2 && !this.checkFlag(9) && !perYou.isQuestComplete(1)
	};
	per.showPlaceImageRight = function(md) {
		if (Place == 2 && !this.checkFlag(9) && !perYou.isQuestComplete(1)) {
			this.showPerson("tess0.jpg");
			this.setFlag(9)
		}
	};
	per.showEventPopup = function() {
		if (sType !== "") return false;
		if (Place == 46 && this.isHere() && !isDay() && !this.checkFlag(4)) {
			this.setFlag(4);
			showPopupWindow("", '<img src="Images/tess20b.jpg" class="imgpopup" alt="Tess">' + "<p style='text-align:center;margin-top:-12px;font-size:x-large'><b>Tess's Nightie</b></p>" + "You are amazed as you see Tess has changed into a lovely green nightie. She is simply stunning and you look at her wordlessly. Tess smiles,<br><br>" + '"Well my love, I am ready for bed..?"', "", "background-color:white;color:black;");
			return true
		}
		return false
	};
	per.showEvent = function() {
		var md;
		if (Place == 269 && sType == "tesspool") {
			WaitHereOnly(6);
			md = WritePlaceHeader();
			if (this.checkFlag(12)) this.showPersonRandom("tess-pool", 7, "", "", "", "", 1);
			else this.showPerson("tess-poola.jpg");
			addPlaceTitle(md, "Swimming with Tess");
			if (this.checkFlag(12)) md.write("<p>Tess arrives and un-selfconsciously removes her bikini top before having a playful swim with you.</p>");
			else md.write("<p>Tess is weaning a lovely back bikini, and goes for a playful swim with you. After the swim she seems to be lost in thought.</p>");
			startQuestions();
			if (!this.checkFlag(11)) addQuestionR(md,
				"ask Tess about her thoughts", '\u201cI am sorry my love, it is just a silly thing. I love swimming at the beach but usually we...I go to the sort of beach where swim-wear is optional. I prefer swimming that way, but it would be rather naughty here..."', "Tess", "setPersonFlag(\\'Tess\\',11)");
			else if (!this.checkFlag(12)) {
				addLinkToPlaceC(md, "encourage her to be naughty", Place, "type=tesspooltopless", 'You tell here is it perfectly fine, the pool is generally quite enpty, and anyone who complained is a idiot, Tess is so beautiful after all, Tess smiles,</p>"Thank you" and she removes her top');
				addLinkToPlaceC(md, "tell her it is a bit public here", Place, "", "Tess agrees and a little while later gives you a kiss and leaves the pool")
			} else {
				addLinkToPlaceC(md, "it is fairly private here...", Place, "type=tesspoolsex");
				addLinkToPlaceC(md, "say goodbye to Tess", Place)
			}
			WritePlaceFooter(md);
			return true
		}
		if (Place == 269 && sType == "tesspooltopless") {
			md = WritePlaceHeader();
			this.showPerson("tess-pool-sex.jpg");
			addPlaceTitle(md, "Tess Topless...Bottomless too");
			md.write("<p>Tess does not stop at her top and removes her bikini bottom as well for you,</p>" +
				'<p>"My love..." and she kisses you. A while later she replaces the bottom of her bikini before giving you another kiss before she leaves.</p>');
			startQuestions();
			addLinkToPlaceC(md, "say goodbye to Tess", Place);
			WritePlaceFooter(md);
			return true
		}
		if (Place == 269 && sType == "tesspoolsex") {
			md = WritePlaceHeader();
			this.showPerson("tess-pool-sex.jpg");
			addPlaceTitle(md, "Private Time with Tess");
			md.write("<p>You ask your beautiful librarian to play with you more privately, and she seductively removes all of her swimsuit and embraces you and kisses you.</p>");
			startQuestions();
			addLinkToPlaceC(md, "later...say goodbye to Tess", Place);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "tesstanikathreesome" && (Place == 170 || Place == 46)) {
			md = WritePlaceHeader(false, perYou.isMaleSex() && isExplicit() ? "" : "td-left-large");
			var perT = findPerson("MrsTanika");
			var sTanika = perT.getPersonName();
			if (perYou.isMaleSex() && isExplicit()) this.showPersonRandomX("tess19", 4);
			else this.showPersonRandom("tesstanika", 2);
			addPlaceTitle(md, "Tess and " + sTanika + " Working Together");
			md.write("<p>You ask Tess and " +
				sTanika + ' to both pleasure yourself and each other. Tess looks a little uncertain, but responds "For you my love, anything".</p>' + "<p>The three of you play with each others bodies to many mutual climaxes. " + sTanika + " is not very experienced at this and confesses to only having sex with a single partner before. Tess is more reserved, more focused on you and your pleasure, her desires and thoughts only on you.</p>");
			startQuestions();
			addLinkToPlace(md, "return to your bedroom", 46);
			WritePlaceFooter(md);
			return true
		}
		if (Place == 170 && sType == "tessplaymore") {
			md = WritePlaceHeader(false, isExplicit() ? "td-left-med" : "");
			if (!isExplicit()) this.showPerson("tess-play.jpg");
			else if (perYou.isMaleSex()) AddImageX("GenericSex/sex-mf pussy h.gif");
			else AddImageArrayX(["GenericSex/sex-ff lick f.gif", "GenericSex/sex-ff lick g.gif"]);
			addPlaceTitle(md, "Playing with Tess's Body");
			md.write('<p>You ask Tess for something more, and she asks, "You mean you want to make love?"</p>' + '<p>She asks in such a cute and almost hesitant way there is no way you could say no, and you nod your head "yes". Tess embraces you and have a wonderful sexual encounter with her</p>' +
				'<p>After she says "I wish I had you only to myself!"</p>');
			startQuestions();
			addLinkToPlace(md, "return to your bedroom", 46);
			WritePlaceFooter(md);
			return true
		}
		if (Place == 194)
			if (sType === "carsex") {
				md = WritePlaceHeader();
				this.showPerson("tess13a.jpg");
				addPlaceTitle(md, "Mrs. Tess Adams");
				md.write("<p>\"I'm so glad that you want me " + perYou.getPersonName() + '," says Tess, tugging at her skirt.  Her breasts pop out of the too-tight top. "Take me right here in the street. I\'m yours, always, ' + perYou.getPersonName() +
					".</p>" + "<p>You hesitate. There are too many people around and you don't want to create suspicion yet.</p>");
				startQuestions();
				addLinkToPlaceC(md, '"then again we could be discrete"', Place, "type=carbj");
				addQuestionC(md, "regretfully tell Tess to take you to her husband", "Tess", 2021);
				WritePlaceFooter(md);
				return true
			} else if (sType == "carbj") {
			md = WritePlaceHeader(false, isExplicit() || !perYou.isMaleSex() ? "td-left-med" : "");
			var img;
			if (!isExplicit()) img = this.showPerson(perYou.isMaleSex() ? "tess13b.jpg" : "tess13g.jpg");
			else if (perYou.isMaleSex()) img = this.showPersonArrayX(["tess13ba.jpg", "tess13bb.gif"]);
			else img = this.showPersonX("tess13g.gif");
			addPlaceTitle(md, "Being Discrete with Tess");
			md.write("<p>You tell Tess that this too public, and she grins playfully and says,</p>" + '<p>"' + perYou.getPersonName() + ' I know how to be very discrete..."</p>');
			if (!perYou.isMaleSex()) md.write("<p>She asks you to sit in the passenger seat and closes the doors and she kisses you. She then quickly lowers your panties and starts to lick your pussy, to your surprise and delight. As she enthusiastically licks you, you notice her skirt has slid up and her rear is bobbing up too much. You warn her to be careful, a passerby might get an unexpected view!");
			else if (img.indexOf("tess13bb.gif") != -1) md.write("<p>She invites you into the back seat of the car while removing her clothes. Fortunately this is a large expensive car with plenty of space so with only a little bit of difficulty you are able to fuck the beautiful librarian  in the back..seat!");
			else md.write("<p>She asks you to sit in the drivers seat and kneels down with the car door blocking peoples view. She opens your trousers and takes out your cock and to your surprise and delight proceeds to give you a wonderful blowjob.");
			md.write("</p><p>After she looks around to check that no-one seemed to be watching and then gives you a kiss. You must admit you very much enjoyed her mischevious discretion!</p>");
			startQuestions();
			if (perYourBody.FindItem(4) > 0 && perYou.checkFlag(11) && perYou.canUseExperience()) addOptionLink(md, "ask Tess for help deciphering the passages in the book", "spendExperience()");
			addQuestionC(md, "tell Tess to take you to her husband", "Tess", 2021);
			WritePlaceFooter(md);
			return true
		} else if (sType === "tesscar") {
			md =
				WritePlaceHeader();
			this.showPerson("tess_driving.jpg");
			addPlaceTitle(md, "Mrs. Tess Adams");
			md.write("<p>Wearing another outstanding outfit, Mrs. Adams beckons you over to her car, though when you approach she does mention that it is not acually her car but her husbands that she is borrowing. With that explained she begins to tell you about some magic that she has found.</p>" + '<p>"Oh ' + perYou.getPersonName() + '!" she says between breaths. "Victoria could not help me but I told my...John about what you did to the golden worm. He is very keen to meet with you and told me that he has even more magic items."</p>');
			startQuestions();
			addLinkToPlaceC(md, "tell her that you are more interested in her", 194, "type=carsex");
			addQuestionC(md, "tell Tess to take you to her husband", "Tess", 2021);
			addLinkToPlace(md, "leave her and return to the shops", 194);
			WritePlaceFooter(md);
			return true
		}
		if (Place != 62) return false;
		if (sType == "all") {
			md = WritePlaceHeader();
			AddImageRandom("GenericSex/foursome", 2, "height:max");
			addPlaceTitle(md, "Full Meeting of the Library Staff");
			md.write("<p>You call for Monique and Ms. Titus to join Tess and yourself for a meeting, and Ms. Titus arrives first followed almost immediately by Monique.</p>" +
				'<p>Your loyal slave Monique stands waiting for your orders, but Ms. Titus has already decided, correctly, what this will be a meeting of, as she starts to remove her clothing. As she does she tells Monique, "Strip for ' + perYou.getMaster() + ' slut".</p>' + '<p>Monique looks annoyed at Ms. Titus, and you chastise her, "Monique is mine to order around and call a slut if I wish, not yours slave!". Ms. Titus smiles as she finishes removing her clothing and presents herself to you and replies, "Of course ' +
				perYou.getMaster() + '!".</p>' + '<p>You tell Monique to also remove her clothing, and she immediately obeys as your true and loyal slave. You look at Tess, who is looking uncertain, but she starts to remove her underwear as she tells you, "Whatever you want, my love".</p>' + "<p>After a little while you have your three beautiful librarians lined up, ready for a meeting ");
			if (perYou.isMaleSex()) md.write("with your cock");
			else md.write("of lips, hands and pussies");
			md.write(".</p><p>You take great pleasure from your beautiful librarians, as they do as well. Tess is very focused on you, her passions all centered on you. Monique also prefers to serve you when possible but she is quite fond of Tess and tries to help and please her when she can. Ms. Titus is a complete slut, eager to lick or suck anyone in any way at any time.</p>" +
				"<p>Some time later as the librarians are re-dressing you cannot but help thinking about how much you have come to enjoy visiting the library.</p>");
			startQuestions();
			addLinkToPlace(md, "talk more to Tess once the others leave", 62, "type=continue");
			addLinkToPlace(md, "go to the reception area.", 3);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "private") {
			var img = this.showPersonArray(["tess-office-1.jpg", "tess-office-2.jpg", "tess-office-3.jpg", "tess-office-4.jpg"], "", "", "", "", false, "string");
			md = WritePlaceHeader(false,
				img.indexOf("office-4") == -1 ? "" : "td-left-large");
			md.write(img);
			addPlaceTitle(md, "Full Meeting of the Library Staff");
			if (!checkPlaceFlag("Library", 1)) md.write("<p>You close the door to Tess's office and as you do Tess");
			else md.write("<p>Tess looks at you and she ");
			setPlaceFlag("Library", 1);
			md.write("removes the rest of her clothing");
			if (img.indexOf("office-4") == -1) md.write("and poses for your pleasure");
			else md.write(" and lies down on her desk");
			md.write(".</p><p>She is completely irresistable and there is no need to resist! You embrace the beautiful librarian and kiss her passionately.</p>" +
				"<p>Some time later, after more than just kissing, you separate from her as she looks up at you wordlessly, but with an expression full of passion.</p>");
			startQuestions();
			addLinkToPlace(md, "talk more to Tess", 62, "type=continue2");
			addLinkToPlace(md, "go to the reception area.", 3);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "tesstitus") {
			md = WritePlaceHeader(false, isExplicit() ? "" : "td-left-med");
			if (isExplicit()) this.showPersonX(perYou.isMaleSex() ? "titustessb.jpg" : "titustessg.jpg");
			else AddImage("GenericSex/threesome2.jpg");
			addPlaceTitle(md, "Ms. Titus Assists Tess");
			md.write('<p>You ask Tess to call Ms. Titus into her office so she can assist her. Tess looks a little uncertain, she can see what you want but she has previously state a preference to have you to herself. Despite this she responds "For you my love, anything".</p>' + "<p>The three of you play with each others bodies to many mutual climaxes. Your slave Ms. Titus is completely unreserved, eager and willing to use her mouth, her large breasts, any part of her body. Tess is more reserved, more focused on you and your pleasure, her desires and thoughts only on you.</p>");
			startQuestions();
			addLinkToPlace(md, "talk more to Tess", 62, "type=continue2");
			addLinkToPlace(md, "go to the library reception?", 3);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "tessmonique") {
			md = WritePlaceHeader();
			this.showPerson("tessmonique.jpg");
			addPlaceTitle(md, "Monique Assists Tess");
			md.write('<p>You ask Tess to call Monique into her office so she can assist her. Tess looks a little uncertain, she can see what you want but she has previously state a preference to have you to herself. Despite this she responds "For you my love, anything".</p>' +
				"<p>The three of you play with each others bodies to many mutual climaxes. Monique is anxious to please both yourself and her friend Tess, but Tess is more reserved, more focused on you and your pleasure, her desires and thoughts only on you.</p>");
			startQuestions();
			addLinkToPlace(md, "talk more to Tess", 62, "type=continue2");
			addLinkToPlace(md, "go to the library reception?", 3);
			WritePlaceFooter(md);
			return true
		}
		return false
	};
	per.showPersonTextHere = function(md) {
		if (Place == 2 && !this.checkFlag(9) && !perYou.isQuestComplete(1)) md.write("<p>As you approach the library you notice a beautiful woman leaving. You think she is one of the librarians, you may have seen her there before. You hear her call out<br>" +
			'"I\'ll be back soon once I change my top, silly pen breaking and ruining my nice coat..."<br>' + "She gets into a taxi waiting nearby and leaves. You wonder if she was the librarian Mrs. Adams, you have heard she is gorgeous and accident prone.</p>");
		if (this.whereNow() == 46 && (sType == "anitabj" || sType == "anitafuck" || sType == "tanikafuck" || sType == "tanikabj")) md.write("<p>During the act, you catch Tess watching you from the corner of your eye. Her eyes are locked on your crotch and following every single one of the other woman's motions jealously while she subconsciously sucks on her fingers, quickly pulling in her lower lip with a sheepish smile the moment she notices you watching her.</p>")
	};
	per.isPhoneable = function() {
		return checkPlaceFlag("Hotel", 11) && Place == 269 && this.isCharmedBy() && this.other >= 10
	};
	per.callThem = function() {
		if (Place == 269)
			if (!isDay()) WriteComments('You call Tess to invite her to join you at the pool for a swim, but she replies, "Sorry My Love, I love swimming, but can we do it in the daytime, it is so much nicer?". It is hard to refuse her request so you will ask her another time. ');
			else {
				gotoPlace(Place, "type=tesspool");
				receiveCall("", 'You call Tess to invite her to join you at the pool for a swim, and she answers enthusiasticaly, "Of course My Love, I will join you there"');
				WriteCommentsFooter(bChat, bChatLeft)
			}
	}
}

function RepliesTina(nR) {
	var perT = per;
	var myName = perT.getYourNameFor();
	if (nR == 100) {
		addComments("<img src='Images/ward.jpg' style='width:20%;float:right;margin:0 0 2em 5px' alt='Ward'>" + "You ask Tina about the symbol you saw on the sign at the access road, and draw a qick sketch</p><p>&quot;Oh yes, that is variously called a witch mark or a witch ward. A mark of power that can stop a true witch or warlock in their tracks. The fact you were repelled mean you are becoming one now&quot;");
		perT.setFlag(3)
	} else if (nR ==
		620) {
		addComments('"Oh ' + myName + ', something strange is happening to my family. As soon as I arrived home from college Mom grabbed me and locked me in here. She even took most of my clothing saying I would not be needing them."');
		perT.other = 1
	} else if (nR == 621) {
		addComments('"I can\'t find one. Every time I tried to leave Mom threw me back into here and raved about my little brother Davy wanting me. My mom took my cellphone so I could not call anyone, and I do not have any other computers."' + "<br><br>You wonder about making a call to someone for help, but it seems clear Davy has learned spells and there may be secrets to them here. There is no way you can explain about this stuff to someone like your mother, so it is best if you can work out something here and find your own way out.");
		perT.other = 2
	} else if (nR == 612) {
		perT.charmed = 4;
		addComments('"I\'ve never tried. I suppose if they had a spell cast onto them or they were magical I may be able to try."')
	} else if (nR == 613) {
		perT.other = 3;
		addComments('"He has been obsessing over the warlock Kurndorf as of late. He was reading up a lot on the legendary book of spells the warlock was supposed to have, but he seemed to give up on that for now. He was researching the warlock himself, his life and death. One time he mentioned something called <b>Hellgate</b> and also a witch named <b>Jessica</b>. I have seen him meeting with his teacher Mr. Beasley often at the library I think they were working on this stuff together."<br><br>' +
			'"All of this was aside from his usual obsession, our neighbour Kate Granger. Silly, he has no chance with her, she is athletic, smart and forthright, everything Davy is not!"<br><br>' + "Some of this last was from her annoyance at what is happening to her, Davy is certainly smart, but you agree he is no match for Kate, despite his claims of romantic conquest.")
	} else if (nR == 6410) {
		var perG = findPerson("MrsRobbins");
		addComments('"As you wish ' + myName + '," she says, and begins to concentrate.  Then her eyes seem to flash for just a moment and you can feel your own power grow, if only slightly.</p><p>"Oh ' +
			myName + "! I think that it worked!  I removed the spell from my Mother and passed the spell's energy to you (5 mana).\"");
		if (perG.isCharmedBy("Davy")) {
			perT.charmed = 4;
			AddMana(5);
			perG.unCharmThem();
			perG.setFlag(1, false)
		}
	} else if (nR == 8950) {
		if (isCharmedBy("Tracy", "Davy")) {
			AddMana(5);
			var perSis = findPerson("Tracy");
			perSis.unCharmThem();
			perSis.moveThem(1)
		}
		addComments('"Yes ' + myName + ', as you command," she says, immediately beginning to concentrate on your sister.  Moments later you feel the power being passed to you (5 mana).</p><p>As soon as the spell is lifted, Tracy gasps - her face a mixture of disgust and terror - and ' +
			(Place == 176 ? "then runs out of the house, holding her head." : "collapses on the couch holding her head."));
		if (Place != 176) {
			addComments("</p>You ask Tina to return to her home for now so you can talk with Tracy. Tina nods her head and quietly leaves your home.");
			this.place = 163
		}
	} else if (nR == 1650) {
		if (isCharmedBy("Mayor", "Davy")) {
			AddMana(5);
			charmPerson("Mayor", 0)
		}
		addComments('"Yes ' + myName + ', as you command," she says, immediately beginning to concentrate on the Mayor.  Moments later you feel the power being passed to you (5 mana).</p>');
		if (Place != 176) {
			addComments("</p>You ask Tina to return to her home for now so you can talk with the Mayor. Tina nods her head and quietly leaves the office.");
			this.place = 163
		}
	} else if (nR == 18150) {
		AddMana(5);
		var perE = findPerson("Ellie");
		perE.unCharmThem();
		perE.place = 420;
		if (Place != 176) addComments('"Yes ' + myName + ', as you command," she says, and begins to concentrate on Ellie. A moment later Ellie looks very upset and grabs her clothing and runs out of the room, dressed in sheer pale blue lingerie. You do not have time to attempt anything as she runs out. A thought passes your mind, about how fast she is for a near naked woman!. You feel a surge of mana as Tina transfers the mana from the spell to you (5 mana).');
		else addComments('"Yes ' + myName + ", as you command,\" she says, and she walks up to Davy's room. A moment later you see an upset Ellie run out of the room, dressed in sheer pale blue lingerie, clutching her clothes. She runs out of the house looking upset and confused, you do not have time to attempt anything as she runs out. A thought passes your mind, about how fast she is for a near naked woman!. A minute later Tina returns and you feel a surge of mana as she transfers the mana from the spell to you (5 mana).</p>")
	} else if (nR ==
		18151) {
		addComments("<p>You clasp the ring with your fist. It glows and, within moments, it absorbs the mana powering the <i>charm</i> over Ellie.</p>");
		if (isInvisible()) addComments('<p>She looks very confused and before you can do anything, mutters,</p><p>"I know I had to hurt someone, I do not remember who."</p>');
		else addComments('<p>She looks very confused and before you can do anything, she steps over to you and slaps you hard, and then looks horrified,</p><p>"I\'m sorry, I do not know what came over me, I know I had to hurt someone, I do not remember who."</p>');
		addComments("<p>Tears come to her eyes and she runs back toward the park entrance.</p></td></tr></table>");
		AddMana(5);
		var perE = findPerson("Ellie");
		perE.unCharmThem();
		perE.moveThem(420);
		if (Place != 176) addComments('"Yes ' + myName + ', as you command," she says, and begins to concentrate on Ellie. A moment later Ellie looks very upset and grabs her clothing and runs out of the room, dressed in sheer pale blue lingerie. You do not have time to attempt anything as she runs out. A thought passes your mind, about how fast she is for a near naked woman!. You feel a surge of mana as Tina transfers the mana from the spell to you (5 mana).');
		else addComments('"Yes ' + myName + ", as you command,\" she says, and she walks up to Davy's room. A moment later you see an upset Ellie run out of the room, dressed in sheer pale blue lingerie, clutching her clothes. She runs out of the house looking upset and confused, you do not have time to attempt anything as she runs out. A thought passes your mind, about how fast she is for a near naked woman!. A minute later Tina returns and you feel a surge of mana as she transfers the mana from the spell to you (5 mana).</p>")
	} else if (nR ==
		18152) {
		addComments("<p>You clasp the ring with your fist. It glows and, within moments, it absorbs the mana powering the <i>charm</i> over Ms Jones.</p>" + "<p>She looks momentarily confused, and then smiles. You are surprised at how little she reacts.</p>" + "</td></tr></table>");
		setPersonFlag("MsJones", 1);
		AddMana(5)
	}
	return true
}

function initialiseTina() {
	addPerson("Tina", 130, "Tina", "Normal");
	per.Replies = RepliesTina;
	per.isVampyre = function() {
		return this.dress == "Vampyre"
	};
	per.getPersonName = function(full) {
		return full === true ? "Tina Robbins" : this.name
	};
	per.getPersonAddress = function() {
		return this.checkFlag(1) ? "36 Yoolaroo Dr, Glenvale" : ""
	};
	per.isPersonInfo = function() {
		return this.charmed > 0
	};
	per.getPersonInfo = function() {
		var s;
		if (this.isVampyre()) s = "<img src='Images/People/Tina/Vampyre/tina6.jpg' style='width:35%;float:right;margin-left:5px' alt='Tina Vampyre'>" +
			"Tina was no match for your powers. She gave in quickly and without a fight. She has a spell that could be useful against your foes. She can break any mind control spell and can bring out anyone who\u2019s trapped in one. Now you understand why Davy was afraid of Tina. She could thwart his plans by setting free his minions from under his control.<br><br>" + "Tina knew that Davy was plotting something, but was unable to stop her mother from locking her away in the bedroom and guarding her ready for Davy to take her.";
		else s = "<img src='Images/People/Tina/Normal/tina6.jpg' style='width:35%;float:right;margin-left:5px' alt='Tina'>" + "Tina was no match for your powers. She gave in quickly and without a fight. She has a spell that could be useful against your foes. She can break any mind control spell and can bring out anyone who\u2019s trapped in one. Now you understand why Davy was afraid of Tina. She could thwart his plans by setting free his minions from under his control.<br><br>" + "Tina knew that Davy was plotting something, but was unable to stop her mother from locking her away in the bedroom and guarding her ready for Davy to take her.";
		if (isCharmedBy("MrsRobbins")) s += " Now, with both of them under your power, you can plot your next move against Davy. Sadly, the Robbins girls don\u2019t know much about Davy\u2019s powers, but they can help you in other ways. You just have to think of a plan!<br><br>" + "Tina is standing next to her mother, both of them waiting for your wishes. The once proud and wealthy family is on it\u2019s knees, serving only you!";
		return s
	};
	per.whereNow = function() {
		if (this.place == 163 && Place == 176) return Place;
		if (isPossess() &&
			this.place == -1) return perYou.place;
		return this.place
	};
	per.passTimeDay = function() {
		this.setFlag(5, false);
		if (this.place == -1) {
			this.place = 163;
			if (Place != 163) return "<p>Tina tells you she is feeling very tired, and has to return to her room until night falls once again.</p>"
		} else if (this.isVampyre() && this.place != 163) this.place = 163;
		return ""
	};
	per.addPlaceImageLeft = function(lit) {
		if (Place == 130 && this.isHere() && sType === "") {
			if (this.isCharmedBy()) return this.showPersonString("tina6.jpg");
			return this.showPersonString("tina1.jpg")
		} else if (Place ==
			163 && this.isHere() && sType === "") {
			if (isDay() || this.checkFlag(5)) return this.showPersonString("tina11day.jpg");
			if (this.isVampyre()) return this.showPersonString(Math.random() < .5 ? "tina11nighta.jpg" : "tina11nightb.jpg");
			return this.showPersonString("tina11night.jpg")
		}
		return ""
	};
	per.isPlaceImageRight = function() {
		if (Place == 43 && !this.checkFlag(4) && !isSpellKnown("Charm")) return true;
		if (this.place == -1 && (sType === "" || sType.indexOf("gabbyhousestudy") != -1 || sType == "visitellie")) {
			SetRightColumnSize("");
			return true
		}
		return false
	};
	per.showPlaceImageRight = function(md) {
		if (Place == 43 && !this.checkFlag(4) && !isSpellKnown("Charm")) {
			this.showPerson("tina-talk.jpg");
			this.setFlag(4);
			return
		}
		this.showPerson("tina-talk.jpg", undefined, undefined, undefined, undefined, undefined, md);
		if (sType == "gabbyhousestudy10" || sType.indexOf("gabbyhousestudy") == -1 && sType.indexOf("vamphelpgabby") == -1) {
			var b = false;
			var p;
			var plc;
			for (var i = 0; i < arPeople.length - 2; i++) {
				p = arPeople[i];
				if (p.uid == this.uid || p.isDead()) continue;
				plc = p.whereNow();
				if (p.isCharmedBy("You") &&
					(plc == -1 || plc == Place) && !p.isVampyre() && p.health > 0) {
					b = true;
					break
				}
			}
			md.write('<div style="clear:both;">');
			addOptionLink(md, "talk to Tina", "findPerson('Tina').chatTina()", b && this.isVampyre() ? "bloodblock" : "chatblock", "width:90%;max-width:90%;position:relative;top:-0.5em")
		}
		md.write("</div>")
	};
	per.fedUponEvent = function(perV) {
		var md = WritePlaceHeader(false, "", "black");
		this.dress = "Vampyre";
		this.showPerson("embrace1.jpg", "height:max");
		this.setFlag(5);
		this.place = 163;
		setPlaceKnown("TinasRoom");
		addPlaceTitle(md,
			"Vampyre Feeds on Tina", "", 0, false, "white");
		md.write("<p>Tina looks uncertainly, and you reassure her as the vampyre approaches with lust on her face. With no hesitation, she embraces Tina and sinks her fangs into Tina's neck.</p>" + '<p>Tina cries out, you are unsure if it is pain or lust, as the vampyre drinks her blood. You realise the vampyre is getting carried away, drinking more and more. You try to pull her away and she snarls "Witch blood" and sinks her teeth back into Tina\'s neck. Tina cries out in pain, not lust!.</p>' +
			"<p>Again you pull the vampyre away and order her to stop now! She looks furious and but for the spell binding her to you she would of clearly ripped you to bloody shreds!</p>");
		startQuestionsOnly(undefined, "white", md);
		addLinkToPlace(md, "check on Tina", Place, "type=embrace2");
		WritePlaceFooter(md, "", true, true);
		return true
	};
	per.enterChurch = function(plc, s) {
		this.place = 163;
		return '<p style="text-align:center"><b>Tina Stops</b></p><p>' + this.showPerson("tina-stopped.jpg", "20%", "right;margin-bottom:1em", "",
			"", false, undefined, "string") + s + ', Tina stops, and says,<br><br>"This place is holy, I cannot enter here anymore. I will wait for you at home"'
	};
	per.feedOnEvent = function(ps) {
		var md = WritePlaceHeader(false, "", "black");
		var perF = findPerson(ps);
		var herName = perF.getPersonName();
		if (perF.health < 100) {
			this.showPerson("tina-stopped.jpg");
			addPlaceTitle(md, "Tina and " + herName, "", 0, false, "white");
			if (perF.health <= 60) {
				md.write("<p>Tina looks at " + herName + " and tells you,</p>" + '<p>"They are injured and may not live through my feeding. I will not feed on them."</p>');
				startQuestionsOnly(undefined, "white", md)
			} else {
				md.write("<p>Tina looks at " + herName + " and looks at you,</p>" + '<p>"I will not feed on this one, they are already weakened and it would harm them for me to feed on them."</p>');
				startQuestionsOnly(undefined, "white", md)
			}
		} else {
			AddMana(5);
			this.health += 20;
			if (this.health > 100) this.health = 100;
			perF.health -= 20;
			this.showPerson("tinafeed.jpg");
			addPlaceTitle(md, "Tina Feedng on " + herName, "", 0, false, "white");
			md.write("<p>" + herName + " looks uncertainly, and you reassure them as Tina approaches with desire on her face. With no hesitation, she embraces " +
				herName + " and sinks her fangs into " + herName + "'s neck.</p>" + "<p>After a surprising short time, the Tina looks up at you, still holding " + herName + ". Her face is still full of lust, but different. She steps away from " + herName + " who looks strange, a mixture of ecstasy and complete exhaustion, and they immediately sit down.</p>" + '<p>Tina looks at you, "My thirst has receded, but my other lusts are rising. Please take me!"</p>');
			startQuestionsOnly(undefined, "white", md);
			addLinkToPlace(md, "satisfy her lust",
				Place, "type=tinavampfuck&with=" + perF.uid, "", "", "", "bloodblock")
		}
		addOptionLink(md, "enough of that", "setQueryParams('');DoReturn()", "bloodblock");
		WritePlaceFooter(md, "", true, true)
	};
	per.showEventPopup = function() {
		if (sType !== "") return false;
		if (Place == 163 && !isDay() && this.isVampyre() && !this.checkFlag(5) && !this.checkFlag(6)) {
			this.setFlag(6);
			showPopupWindow("Tina is awake!", "<img src='Images/People/Tina/Vampyre/tina7a.jpg' class='imgpopup' alt='Tina'>" + "You see a familiar woman who looks a little like Tina looking at you. Her eyes are pale and you see two vampiric fangs in her mouth. She says,</p>" +
				'<p>"' + this.getYourNameFor() + ', I am yours always, but I am unsure what happened."</p>' + "<p>She sounds like Tina, possibly this is the cloak the vampyre Lilith talked about, that Tina at least unconsciously feels different and so she is now projecting somehow this altered appearance.</p>" + "<p>You talk to her, both to assure yourself that she is Tina, and also to explain what happened as she seems to have little memory of her revival. She does not really understand what has happened, while she knows much of the occult this must not include much on vampiric lore. She tells you,</p>" +
				'<p>"' + this.getYourNameFor() + ', I will explore what has happened to me, but I am yours to command still."');
			return true
		}
		if (Place == 161 && this.place == -1 && perDavy.isHere()) {
			if (this.isVampyre() && !this.checkFlag(10)) {
				this.setFlag(8);
				this.setFlag(10);
				if (!perDavy.isMaleSex()) this.setFlag(9);
				showPopupWindow("Tina the Vampyre and Davy", "<img src='Images/People/Tina/tina-follower5.jpg' class='imgpopup' alt='TinaDavy'>" + "\u201cI can smell my brother...\u201d Tina rushes down the stairs into the cellar, and her eyes immediately focus on the bound " +
					perDavy.getSex() + ", a predatory smile on her face. </p>" + "<p>You catch up with her as she is already next to him, driving her fingertips over her brothers exposed " + (perDavy.isMaleSex() ? "chest" : "breasts") + ".</p>" + "<p>\u201cDon't be afraid, little brother, don't you recognize your big sister?\u201d Tina's veil fades briefly, exposing her original appearance and pale skin to the terrified Davy. \u201cYou smell so good... I want... I need to....\u201d</p>" + "<p>\u201cTina!\u201d</p>" + "<p>You call out to the girl seconds before her fangs reach Davy's neck, and she jerks away from her brother with a surprised gasp, briefly clutching her head and quickly backing away from " +
					perDavy.getHimHer() + ".</p>" + "<p>\u201cI... I'm sorry...\u201d She sinks her head in shame. \u201cLilith... the Vampire was right about witchblood. I'm used to your scent, but " + (perDavy.isMaleSex() ? "his" : "hers") + " is still so enticing, and seeing " + perDavy.getHimHer() + " helpless, like injured prey...\u201d She shakes her head. \u201cI will... have to learn to control these urges, thank you for stopping me from doing something I would have regretted.\u201d")
			} else if (!this.checkFlag(9) && !perDavy.isMaleSex()) {
				this.setFlag(9);
				showPopupWindow("Tina and Davy", "<img src='Images/davycellar-female-1a.jpg' class='imgpopup' alt='Davy'>" + "\u201cI don't understand... didn't you say my brother is here, " + perYou.getMaster() + "?\u201d Davy looks like he is about to die of shame as you explain to his sister what you did, and after a moment of awkward silence, Tina bursts into laughter.</p>" + "<p>\u201cYou... transformed him into a girl?\u201d She tries her best to contain herself, stiffing the laughter into a giggle.</p>" + "<p>\"I'm sorry. I should not laugh about my brothers predicament... but you should absolutely make him wear some skimpy outfit and parade him around school, so he finally knows what it's like to have some lecherous teenager's eyes on him all the time.\u201d")
			} else if (!this.checkFlag(8) &&
				!this.checkFlag(9)) {
				this.setFlag(8);
				showPopupWindow("Tina and Davy", "<img src='Images/davycellar-male-1.jpg' class='imgpopup' alt='Davy'>" + "\u201cYou got him...\u201d Tina looks genuinely relieved to see her brother tied up like this. \u201cI was always kind of worried that he might one day show up and try to take me away from you, " + perYou.getMaster() + ", and it's good to know that he won't be able to use his spell on me or Mom anymore.\u201d</p>" + "<p>Tina thanks you with a long, drawn out kiss on the lips right in front of her brother, and you can see the jealousy burn in his eyes as she breaks off and smiles to him knowingly.<p>" +
					"<p>\u201cI can feel some Mana in him.\u201d She adds, regarding her brother with a look of contempt. \u201cHe restores it every morning, and since you have proven to use it so much better, I would gladly transfer it to you.\u201d")
			}
			return true
		}
		return false
	};
	per.addFreeOptions = function(md) {
		if (this.charmed < 4) return;
		if (isPersonHere("Mayor") && isCharmedBy("Mayor", "Davy")) addQuestionC(md, "tell Tina to free Mayor Thomas from Davy's control", "Tina", 1650);
		if (isPersonHere("Tracy") && isCharmedBy("Tracy", "Davy"))
			if (Place ==
				45) addPopupLinkToPlace(md, "tell Tina to free your sister Tracy from Davy's control", Place, "", "Tina Frees Tracy", "<img src='Images/tracy1a-day.jpg' class='imgpopup' alt='Tracy'>" + '"Yes ' + perYou.getMaster() + ', as you command," she says, immediately beginning to concentrate on your sister.  Moments later you feel the power being passed to you (5 mana).</p><p>As soon as the spell is lifted, Tracy gasps - her face a mixture of disgust and terror - and collapses on the couch holding her head.' + "</p>You ask Tina to return to her home for now so you can talk with Tracy. Tina nods her head and quietly leaves your home.",
				'movePerson("Tina",163);AddMana(5);unCharmPerson("Tracy")', "", true);
			else addQuestionC(md, "tell Tina to free your sister Tracy from Davy's control", "Tina", 8950);
		if (isPersonHere("Ellie") && isCharmedBy("Ellie", "Davy"))
			if (Place == 176) addQuestionC(md, "tell Tina to free Ellie from Davy's control", "Tina", 18150);
			else if (Place == 93) addLinkToPlaceC(md, "tell Tina to free Ellie from Davy's control", 93, "type=ellie10b", "Tina concentrates");
		else if (Place == 421) addQuestionC(md, "tell Tina to free Ellie from Davy's control",
			"Tina", 18151);
		else if (Place == 430) addLinkToPlaceC(md, "tell Tina to free Ellie from Davy's control", 430, "type=elliefreed&by=Tina", "Tina concentrates");
		else {
			if (Place == 423) addLinkToPlaceC(md, "tell Tina to free Ellie from Davy's control", 423, "type=ellie22", "Tina concentrates")
		} else if (isPersonHere("MsJones") && !isCharmed("MsJones") && !checkPersonFlag("MsJones", 1) && checkPersonFlag("MsJones", 17)) addQuestionC(md, "tell Tina to free Ms. Jones", "Tina", 18152);
		else if (Place == 74 || Place == 75) addQuestionR(md, "tell Tina to free Amy and Catherine",
			"You ask Tina to free your friends and she concentrates but skakes her head in failure, maybe the spell affecting the girls is too recently cast and still washing through their bodies and minds.");
		else if (Place == 224) addQuestionR(md, "tell Tina to free John", 'You order Tina to free John and she concentrates but skakes her head in failure, "I am sorry, I cannot affect the spell on him"');
		else if (Place == 36 && (wherePerson("Kate") == 47 || wherePerson("Kate") == 421))
			if (checkPersonFlag("Kate", 31)) addLinkToPlaceC("ask Tina to free Kate from Davy's control",
				36, "type=freed&by=Tina&before=true");
			else addLinkToPlaceC("ask Tina to free Kate from Davy's control", 36, "type=freed&by=Tina&before=");
		else if (Place == 76 && !checkPersonFlag("AmyRoss", 1)) addLinkToPlaceC(md, "tell Tina to free Amy and Catherine", 76, "type=freed", "Tina concentrates and, within moments, she absorbs the mana powering the <i>charm</i> over Catherine and Amy.", "", "AddMana(10)");
		else if ((Place == 108 || Place == 139) && wherePerson("Kate") == Place && isCharmedBy("Kate", "Davy"))
			if (checkPersonFlag("Kate",
					31)) addLinkToPlaceC("ask Tina to free Kate from Davy's control", 139, "type=freed&by=Tina&before=true");
			else addLinkToPlaceC("ask Tina to free Kate from Davy's control", 139, "type=freed&by=Tina&before=");
		else if (Place == 145 && !isCharmed("MsJones") && !checkPersonFlag("MsJones", 1)) addQuestionR(md, "tell Tina to free Ms. Jones", "Tina concentrates and, within moments, she absorbs the mana powering the <i>charm</i> over Ms Jones.</p>" + "<p>Ms. Jones looks momentarily confused, and then smiles. You are surprised at how little she reacts.",
			"", "setPersonFlag(\\'MsJones\\',1);AddMana(5)");
		else if (Place == 184) {
			if (perDavy.other != 8 && perDavy.getQuestBlueBottle() != 20 && perDavy.getQuestBlueBottle() != 21) {
				AddMana(20);
				perDavy.other = 8;
				addComments("<p>You clasp the ring with your fist. It glows, far brighter than ever before, and you have to shield your eyes.  Across the room you hear Davy give a strangled grunt, as mana flows from him to you.");
				if (perDavy.checkFlag(5) && (!perDavy.checkFlag(6) && !perDavy.checkFlag(7)) || perDavy.checkFlag(8)) addQuestionR(md,
					"tell Tina to free Davy", 'Tina concentrates and she staggers, whispering "The power!", and after a tine she absorbs the mana powering the <i>charm</i> over Davy. Across the room you hear Davy give a strangled grunt, as mana flows from him to you through Tina.', "", "perDavy.other=8;AddMana(20)");
				else addLinkToPlaceC("tell Tina to free Davy", 267, "", 'Tina concentrates and she staggers, whispering "The power!", and after a tine she absorbs the mana powering the <i>charm</i> over Davy. Across the room you hear Davy give a strangled grunt, as mana flows from him to you through Tina.',
					"", "perDavy.other=8;AddMana(20)")
			} else WriteComments("You have already drained him of his power");
			return
		}
	};
	per.chatTina = function() {
		var md = WritePlaceHeader();
		this.showPerson("tina-talk.jpg");
		addPlaceTitle(md, "Chatting with Tina");
		md.write("<p>You stop for a moment to talk to Tina.</p>");
		startQuestionsOnly();
		var p;
		var plc;
		for (var i = 0; i < arPeople.length - 2; i++) {
			p = arPeople[i];
			if (p.uid == this.uid || p.isDead()) continue;
			plc = p.whereNow();
			if (p.isCharmedBy("You") && (plc == -1 || plc == Place) && !p.isVampyre() && p.health >
				0) {
				if (this.isVampyre()) addLinkToPlace(md, "feed on " + p.getPersonNameShort(), Place, "type=feedOn&by=" + this.uid + "&with=" + p.uid, "", "", "", "bloodblock");
				if (!p.isMaleSex()) addLinkToPlace(md, "pleasure " + p.getPersonNameShort(), Place, "type=" + (this.isVampyre() ? "tinapleasurevamp" : "tinapleasure") + "&with=" + p.uid, "", "", "", "chatblock")
			}
		}
		if (Place == 161 && perDavy.isHere()) {
			addLinkToPlaceC(md, "pleasure Davy", Place, "type=tinapleasuredavy");
			if (perDavy.checkFlag(13)) addQuestionR(md, "ask Tina to drain mana from Davy", "Tina mentions that Davy is able to restore his mana every morning, so it might be a nice bonus to defeating him that she gives that Mana to you once a day.</p>" +
				"<p>\u201cOf course, " + perYou.getMaster() + ", It's not like he actually needs it.\u201d</p>" + "<p>Tina focuses for a brief moment, and you feel a small amount of mana rushing into your body. It's not much, possibly due to the circumstances he is in, but still useful." + (!this.checkFlag(12) ? "<p>You consider that you could ask Tina to do this once Davy recovers, and to do this you will have to <b>talk to Tina</b> to request it.</p>" : ""), "", "setPersonFlag(\\'Tina\\',12);perDavy.setFlag(13,false);AddMana(5)");
			else addQuestionR(md, "ask Tina to drain mana from Davy", "Tina mentions that Davy is able to restore his mana every morning, so it might be a nice bonus to defeating him that she gives that Mana to you once a day.</p>" + "<p>Tina apologizes. \u201cI can't extract any more Mana from him, and he only restores his reserves in the morning.\u201d</p>")
		}
		this.addFreeOptions(md);
		if (checkPlaceFlag("Park", 6) && !this.checkFlag(3)) addQuestionC(md, "ask about the symbol on the sign you saw", "Tina", 100);
		if (!this.checkFlag(2)) addQuestionR(md,
			'ask "You mentioned the sign?"', "She replies, &quot;Ignore the old tales of the devil&rsquo;s mark, but witches do bear a mark on them somewhere. It will usually look like a small tattoo but only to someone with the sight, the vision of one who wields magic.&quot;</p><p>You ask if she has such a mark, she smiles &quot;You will see&quot;", "Tina", "setPersonFlag(\\'Tina\\',2)");
		if (checkPlaceFlag("Hotel", 11) && Place == 269) addLinkToPlace(md, "ask Tina is she would like to go for a swim", Place, "type=tinapool");
		addQuestionR(md, '"I need to do something else, please return home"', '"Of course ' + perYou.getMaster() + '"', "Tina", "movePerson(\\'Tina\\',163)", "");
		addLinkToPlace(md, "continue on", Place, sPlaceParams);
		WritePlaceFooter(md, "", true, true)
	};
	per.showEvent = function() {
		var md, w, p;
		if (sType == "feedOn" && getQueryParam("by") == this.uid) {
			this.feedOnEvent(getQueryParam("with"));
			return true
		}
		if (sType == "tinapleasure") {
			w = getQueryParam("with");
			p = findPerson(w);
			md = WritePlaceHeader(false, "td-left-med");
			this.showPerson("!tina-follower1.jpg");
			addPlaceTitle(md, "Tina's Service");
			md.write("<p>\u201cI will gladly do whatever my " + perYou.getMaster() + " desires of me.\u201d Tina looks at " + p.getPersonNameShort() + " for a few seconds, and you see her briefly pulling in her lower lip as she steps forward and takes off her clothes, obviously a little nervous.</p>" + "<p>You order " + p.getPersonNameShort() + " to play along and let Tina take the lead, watching as the girl undresses her partner and begins to drive her hands over the freshly exposed skin, guiding the woman to lie down on the ground and crawling on top of her.</p>" +
				"<p>" + p.getPersonNameShort() + " gasps softly under the girls touch, her eyes are focused on you even now as Tina Spreads her legs and kisses her thighs, and you see her shivering visibly as the girl's lips move closer to her folds.</p>" + "<p>You hear a long, sensuous moan the moment Tina's tongue reaches her partner's clit, and even considering the effect of the spell It is obvious the two put on a bit of a show for your enjoyment. " + p.getPersonNameShort() + " winds her body on the floor, twitching and gasping for air, moaning lewdly as she gets closer to her climax, and finally, Tina stops to look at you.</p>" +
				"<p>\u201cShe is well-prepared, " + perYou.getMaster() + ", do you want to join us?</p>");
			startQuestionsOnly();
			startAlternatives(md);
			addLinkToPlace(md, "join in", Place, "type=tinapleasurejoin&with=" + w);
			addLinkToPlace(md, "let Tina do the honours", Place, "type=tinapleasuretina&with=" + w);
			endAlternatives(md);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "tinapleasurejoin") {
			w = getQueryParam("with");
			p = findPerson(w);
			md = WritePlaceHeader();
			if (perYou.isMaleSex()) this.showPersonX("!tina-follower2m.jpg");
			else this.showPersonRorX("!tina-follower2f.jpg");
			addPlaceTitle(md, "Joining Tina's Service");
			md.write("<p>As much as you love to watch your magical little slut do her thing, you can't just stand on the sidelines and keep watching after that show.</p>" + "<p>Tina spreads " + p.getPersonNameShort() + "'s legs to present the woman's sex to you and moves out of the way as you close in, " + (perYou.isMaleSex() ? "unceremoniously open your pants and push" : "knee down before her and insert your fingers") + " into her waiting mound.</p>" + "<p>Her folds easily open for your " +
				(perYou.isMaleSex() ? "cock" : "fingers") + ", welcoming you inside and squeezing you tightly as you begin to thrust into her, every motion making her shiver lustfully while Tina keeps her pinned down, massaging her breasts and trading sloppy kisses.</p>" + "<p>It doesn't take long for the two of you to make " + p.getPersonNameShort() + " reach her peak, and you make sure she thanks Tina for her valiant efforts.</p>");
			if (!this.checkFlag(11)) {
				this.setFlag(11);
				md.write("<p>You consider that you could ask Tina to do this to others, and you will then <b>talk to Tina</b> to request it.</p>")
			}
			startQuestionsOnly();
			addLinkToPlace(md, "continue on your way", Place);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "tinapleasuretina") {
			w = getQueryParam("with");
			p = findPerson(w);
			md = WritePlaceHeader(false, "td-left-med");
			this.showPersonX("!tina-follower3.jpg");
			addPlaceTitle(md, "Watching Tina's Service");
			md.write("<p>You want to watch this show to the end and order Tina to go all the way to make " + p.getPersonNameShort() + " climax for your pleasure, and your magical little slut is all too happy to oblige.</p>" + "<p>Tina goes down on " +
				p.getPersonNameShort() + " with renewed vigor, inserting her fingers into the woman's well-prepared folds as her tongue keeps circling the little nub to make her partner scream out in pleasure and push her closer and closer to her peak with every motion.</p>" + "<p>The other woman's eyes are still on you as she climaxes, and you make sure she properly thanks Tina for her valiant efforts, making the girl blush happily.</p>");
			if (!this.checkFlag(11)) {
				this.setFlag(11);
				md.write("<p>You consider that you could ask Tina to do this to others, and you will then <b>talk to Tina</b> to request it.</p>")
			}
			startQuestionsOnly();
			addLinkToPlace(md, "continue on your way", Place);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "tinapleasurevamp") {
			w = getQueryParam("with");
			p = findPerson(w);
			md = WritePlaceHeader(false, "td-left-med");
			this.showPerson("!tina-follower1.jpg");
			addPlaceTitle(md, "Tina's Service");
			md.write("<p>\u201cI will gladly do whatever my " + perYou.getMaster() + " desires of me.\u201d You see a bit of Lilith in the way Tina approaches " + p.getPersonNameShort() + ". Her motions are slow and sensual, almost predatory in the way her eyes fixate on the woman, and she is probably even taking a little pleasure from the look of unease on the " +
				p.getPersonNameShort() + "'s face as she flashes her teeth.</p>" + "<p>You order " + p.getPersonNameShort() + " to play along and let Tina take the lead, watching as the dhampir undresses her partner and begins to drive her hands over the freshly exposed skin, guiding the woman to lie down on the ground and crawling on top of her.</p>" + "<p>" + p.getPersonNameShort() + " gasps in surprise as Tina's fangs dig into her inner thigh. You expect her to struggle, but the effect of the bite only seems to arouse her even more. Her eyes loose focus, and she is trembling visibly as she stretches her body out before Tina and offers herself to the halfblood's tender affections.</p>" +
				"<p>A long, sensuous moan echos into the room as Tina begins to tend to her partner's clit, and you are seriously not sure how much of the show the two put on is the result of the spell or the result of Tina's new powers. " + p.getPersonNameShort() + " winds her body on the floor, twitching and gasping for air, moaning lewdly as she gets closer to her climax until finally, Tina stops to look at you.</p>" + "<p>\u201cShe is well-prepared, " + perYou.getMaster() + ", do you want to join us?</p>");
			startQuestionsOnly();
			startAlternatives(md);
			addLinkToPlace(md, "join in", Place, "type=tinapleasurevampjoin&with=" + w);
			addLinkToPlace(md, "let Tina do the honours", Place, "type=tinapleasurevamptina&with=" + w);
			endAlternatives(md);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "tinapleasurevampjoin") {
			w = getQueryParam("with");
			p = findPerson(w);
			md = WritePlaceHeader();
			if (perYou.isMaleSex()) this.showPersonX("!tina-follower2m.jpg");
			else this.showPersonRorX("!tina-follower2f.jpg");
			addPlaceTitle(md, "Joining Tina's Service");
			md.write("<p>As weirdly sexy as it is to just watch the dhampire do her thing, you can't just stand on the sidelines and keep watching after that show.</p>" +
				"<p>Tina spreads " + p.getPersonNameShort() + "'s legs to present the woman's sex to you and moves out of the way as you close in, " + (perYou.isMaleSex() ? "unceremoniously open your pants and push" : "knee down before her and insert your fingers") + " into her waiting mound.</p>" + "<p>Her folds easily open for your " + (perYou.isMaleSex() ? "cock" : "fingers") + ", welcoming you inside and squeezing you tightly as you begin to thrust into her, every motion making her shiver lustfully while Tina keeps her pinned down, her teeth digging briefly into " +
				p.getPersonNameShort() + "'s shoulder, drawing blood and causing her to groan in a strange mix of pain and pleasure.</p>" + "<p>It doesn't take long for the two of you to drive " + p.getPersonNameShort() + " to a powerful climax, and you make sure she thanks Tina for her valiant efforts.</p>");
			if (!this.checkFlag(11)) {
				this.setFlag(11);
				md.write("<p>You consider that you could ask Tina to do this to others, and you will then <b>talk to Tina</b> to request it.</p>")
			}
			startQuestionsOnly();
			addLinkToPlace(md, "continue on your way",
				Place);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "tinapleasurevamptina") {
			w = getQueryParam("with");
			p = findPerson(w);
			md = WritePlaceHeader(false, "td-left-med");
			this.showPersonX("!tina-follower3.jpg");
			addPlaceTitle(md, "Watching Tina's Service");
			md.write("<p>You want to watch this show to the end, so you order Tina to go all the way to make " + p.getPersonNameShort() + " climax for your pleasure, and your sexy little dhampire is all too happy to oblige.</p>" + "<p>Tina goes down on " + p.getPersonNameShort() + " with renewed vigor, inserting her fingers into the woman's well-prepared folds as her tongue keeps circling the little nub, making " +
				p.getPersonNameShort() + " scream out lustfully and pushing her closer and closer to her peak with every motion.</p>" + "<p>As " + p.getPersonNameShort() + " finally climaxes, Tina's fangs dig into her skin one last time, making her groan in pain and pleasure as a plethora of different sensations washes over her, leaving her exhausted, but very much satisfied.</p>");
			if (!this.checkFlag(11)) {
				this.setFlag(11);
				md.write("<p>You consider that you could ask Tina to do this to others, and you will then <b>talk to Tina</b> to request it.</p>")
			}
			startQuestionsOnly();
			addLinkToPlace(md, "continue on your way", Place);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "tinapleasuredavy") {
			md = WritePlaceHeader();
			if (perDavy.isMaleSex()) this.showPersonX("!tina-follower4m.jpg");
			else this.showPersonX("!tina-follower4f.jpg");
			addPlaceTitle(md, "Tina Pleasures Davy");
			md.write("<p>\u201cYou are too kind to " + perDavy.getHimHer() + ", " + perYou.getMaster() + ". Tina looks at her " + (perDavy.isMaleSex() ? "brother" : "transformed brother") + " with contempt as she approaches " + perDavy.getHimHer() +
				", his prior actions definitely not forgotten.</p>" + "<p>\u201cBut maybe I should thank him, after all, it is only thanks to his greed and foolishness that I learned how amazing it is to be your slave.\u201d</p>" + "<p>Her words are clearly meant to rattle Davy, and judging from the look of utter defeat on " + perDavy.getHisHer() + " face as Tina begins to caress " + (perDavy.isMaleSex() ? "his cock" : "her folds") + ", they don't fail to hit their mark.</p>" + "<p>\u201cDon't look at me like that, little " + (perDavy.isMaleSex() ?
					"brother" : "sister") + ".\u201d Tina's lips move close to Davy's ear as her fingers begin to move. \u201cYou get what you always dreamed off when you spied on me in the shower: Your big sister rubbing your " + (perDavy.isMaleSex() ? "cock" : "pussy") + " and making you cum, while I get to have amazing sex with my " + perYou.getMaster() + ", over and over again.\u201d</p>" + "<p>Davy brings out a mean streak you usually don't get to see from Tina, and one she definitely has from her mother. The girl not only lays out in graphic detail how the two of you are having sex, she embellishes a good deal of it, too, making you wonder if you should take notes for later.</p>" +
				"<p>It may be more humiliating for Davy than anything Bambi comes up with, but the effect it has on him can't be denied.</p>" + "<p>" + (perDavy.isMaleSex() ? "He is rockhard" : "She is practically dripping") + " under Tina's touch, trying " + perDavy.getHisHer() + " best to not show " + perDavy.getHisHer() + " arousal and failing miserably under Tina's continued attention until " + perDavy.getHeShe() + " is no longer able to hold back and climaxes onto " + perDavy.getHisHer() + " sisters hand.</p>");
			if (!this.checkFlag(11)) {
				this.setFlag(11);
				md.write("<p>You consider that you could ask Tina to do this again, and then you will have to <b>talk to Tina</b> to request it.</p>")
			}
			startQuestionsOnly();
			addLinkToPlace(md, "continue on your way", Place);
			WritePlaceFooter(md);
			return true
		}
		if (Place == 269 && sType == "tinapool") {
			md = WritePlaceHeader();
			this.showPerson("tina-pool.jpg");
			addPlaceTitle(md, "Tina at the Pool");
			if (this.isVampyre())
				if (!this.checkFlag(7)) {
					md.write('<p>Tina nods a little hesitantly, "Yes ' + perYou.getMaster() + ', it is just some of the old legends of vampires and water...", and she rummages around in her large handbag. To your surpise she takes out a purple bikini and there and then she changes into it, not bothering to go into the changingroom. Well Tina has shown no modesty around you since you met her. Tentatively she steps into the water, and looks relieved, nothing unusual happens.</p>' +
						"<p>You have a pleasant time relaxing and playing with Tina, though she prefers to keep to the darker end of the pool where the lighting is subdued at this time of night</p>");
					this.setFlag(7)
				} else md.write('<p>Tina nods a little hesitantly, "Yes ' + perYou.getMaster() + "\", and she rummages around in her large handbag. To your surpise she takes out a purple bikini and there and then she changes into it, not bothering to go into the changingroom. Well Tina has shown no modesty around you since you met her. She still seems uncertain about the water but again nothing unusual happens, maybe as this would not class as 'running water'?</p>" +
					"<p>You have a pleasant time relaxing and playing with Tina, though she prefers to keep to the darker end of the pool where the lighting is subdued at this time of night</p>");
			else md.write('<p>Tina nods , "Yes ' + perYou.getMaster() + '", and she rummages around in her large handbag. To your surpise she takes out a black bikini and there and then she changes into it, not bothering to go into the changingroom. Well Tina has shown no modesty around you since you met her.</p>' + "<p>You have a pleasant time relaxing and playing with Tina, and after she takes some time under the shower cleaning off. She seems to really enjoy the shower!!</p>");
			startQuestions();
			addLinkToPlaceC(md, "continue on", Place);
			WritePlaceFooter(md);
			return true
		}
		if (sType == "tinavampfuck") {
			w = getQueryParam("with");
			md = WritePlaceHeader(false, perYou.isMaleSex() ? "" : "td-left-med", "black");
			if (perYou.isMaleSex()) this.showPerson("tina-sexba.jpg");
			else this.showPerson("tina-sexga.jpg");
			addPlaceTitle(md, "Tina 's  Lust", "", 0, false, "white");
			md.write("<p>The feeding seems to have a profound effect on the young dhampire, and whatever semblance of self-control she displayed seconds ago evaporates the moment you embrace her.</p>" +
				"<p>Tina's hands are shaking as she impatiently undresses you. She is eagerly inhaling your scent as her lips cover every inch of exposed skin with soft kisses until suddenly, her fangs dig into your soft flesh.</p>" + "<p>You feel a piercing rush of pain, gasping in surprise as Tina recoils from you in shock over what she did and just stares at you, eyes wide and lips trembling. Both of you seem unsure how to react for a moment while a pleasant, tingly sensation spreads from the bite all over your body, followed by a feeling of lightheaded euphoria and finally pure, undiluted desire.</p>" +
				"<p>The pain is forgotten the moment you pull her into a kiss, but the rush of Adrenalin remains. You are forceful and demanding, ignoring the strange, metallic taste in her mouth as you push her to the ground, " + (perYou.isMaleSex() ? "turn her body around and position yourself behind her" : "and move to lay on top of her") + ".</p>" + "<p>There is no struggle. Tina eagerly submits to your will and offers herself to you, breathing out rough, almost animalistic moans as you " + (perYou.isMaleSex() ? "take her from behind" :
					"push your fingers into her pussy") + " and begging you to go even harder, to slap her ass and pull her hair, to claim her body and show your dominance over her mind until you finally both reach your peak.</p>" + "<p>The climax is sobering. You feel your euphoria die down but still a little lightheaded, and from the looks of it, Tina will need a moment to recuperate from the act as well. <Girl Tina fed from> in the meantime still looks dazed from the feeding but has witnessed the whole act, and it looks like it left her desiring more from you, too.</p>");
			startQuestionsOnly(undefined, "white", md);
			addOptionLink(md, "enough of that", "setQueryParams('');DoReturn()", "bloodblock");
			WritePlaceFooter(md, "", true, true);
			return true
		}
		if (this.isHere()) {
			if (sType == "embrace2") {
				md = WritePlaceHeader(false, "", "black");
				this.showPerson("embrace2.jpg", "height:max");
				addPlaceTitle(md, "Hurt Tina", "", 0, false, "white");
				md.write("<p>Tina in unconscious and looking very pale. You carry her onto her bed and take out your phone to call an ambulance. As you do a cool hand touches your shoulder, you turn and see the vampyre Lilith,</p>" +
					'<p>"The blood of a witch is irresistable to a vampyre and I took too much. She will be dead in a few minutes."</p>' + "<p>It is strange, she looks almost sorry, if also still full of a mixture of rage and lust. She looks at Tina and back at you,</p>" + '<p>"If you value this one I can save her, the witch blood left in her, and that I have in me I can combine and restore some to her. She will be changed."</p>' + "<p>You ask what she means by changed. Lilith smiles, her usual cruel smile,</p>" + '<p>"She will become more like me, alive still but less of a mortal witchling, more a Darkling Witch, a Dhampir". You are unsure about these terms, except you have heard a Dhampir is some sort of half-blood vampire. You ask her to explain more. She looks steadily at you,</p>' +
					'<p>"There is no time, do you want her or will you give her to death?". Well there is little choice is there and you tell Lilith to proceed.</p>');
				startQuestionsOnly(undefined, "white", md);
				addLinkToPlace(md, "Lilith embraces Tina", Place, "type=embrace3");
				WritePlaceFooter(md, "", true, true);
				return true
			}
			if (sType == "embrace3") {
				md = WritePlaceHeader(false, "td-left-med", "black");
				this.showPerson("embrace3.jpg");
				addPlaceTitle(md, "Embracing Tina", "", 0, false, "white");
				md.write("<p>Lilith strips off her clothing and as she does you see a subtle shift about her, as if her features slightly change. Her expression is less that of a predator, softening just a little. She looks at you a smiles, less cruel and almost with amusement,</p>" +
					'<p>"Vampyres cloak their prey\'s minds and shape their perceptions so to help them drop their guard. Sometimes this is subtle, sometimes gross, sometimes deliberate, but mostly unconscious."</p>' + "<p>She embraces the pale and limp Tina and carefully sinks her fangs into Tina's neck. You can feel a surge of magic in the room, and then you hear Tina sharply draw in a breath and she starts to raggedly breathe. Lilith stops biting her, continuing her embrace but making it more and more sensual. She moves to nibbling and biting on Tina's nipples, looking at you as she does to gauge your reaction or is it your approval.</p>" +
					"<p>Tina moans in lust and pain, and leans down and bites Lilith on her shoulder. You see blood trickling down and then a flash of mana pour into you as Tina drains mana from Lilith and gives it to you. She pulls back and you can clealy see fangs in her mouth, and she looks at you imploringly. You know she wants, needs, you to join them, but you feel reluctant. The two vampiric lovers before you, the blood and the near death all make for a disturbing scene. Tina needs you here and it is your fault what has happened, you allowed Lilith to feed on her. You remove your clothing and lean over and kiss Tina, but as you do Lilith bites you on your thigh in her vampiric idea of foreplay.</p>" +
					"<p>A strange time of passion follows, a mixture of pain, blood and sex with two women, one an otherworldly immortal vampyre and one who may now be joining her in that state.</p>" + "<p>After, Tina lies on the bed, you are not sure if she is asleep or unconscious. Lilith assures you she will wake, but not until the following night, as she will. She looks still strange, less cruel but almost as if this meant something, but what you do not know. As you ponder asking her, she informs you she must rest and leaves the room.</p>");
				AddMana(10);
				movePerson("Vampyre", 247);
				startQuestionsOnly(undefined, "white", md);
				addLinkToPlace(md, "leave her for now", 176);
				WritePlaceFooter(md, "", true, true);
				return true
			}
		}
		if (Place == 141 && sType === "" && !checkPlaceFlag("SacredClearing", 2) && this.isVampyre() && this.isHere() && !isPersonHere("Vampyre")) {
			findPerson("Vampyre");
			if (per.isMonstersInSacredClearing()) {
				md = WritePlaceHeader(true, "", "black");
				showPopupWindow("Tina and the <i>Too Thin</i> Sacred Clearing", "<img src='Images/People/Tina/Vampyre/tina-attack1.jpg' class='imgpopup' alt='TimaVamp'>" +
					"You see movement in the darkness, and Tina moves to position herself between you and whatever it is. She seems to do this instinctively, and as she does the movement hesitates.<br><br>" + "With inhuman speed Tina moves, and there is an explosion of blood and gore and you see her standing covered in the blood of whatever that was. She looks at you confused, she does not know how or why she did that. The blood coating her fades away amd you feel a faint surge of mana while she redresses.<br><br>" + "She resumes her place at your side",
					"AddMana(5);dispPlace()", "left:5%;width:85%");
				setPlaceFlag("SacredClearing", 2);
				WritePlaceFooter(md, "", true, true);
				return true
			}
		}
		if (Place == 130 || Place == 163) {
			if (sType == "play") {
				md = WritePlaceHeader(false, "td-any");
				var myName = perYou.getMaster();
				if (this.isVampyre()) this.showPersonRandom("tina7", 2, "height:max");
				else this.showPerson("tina7.jpg", "height:max");
				addPlaceTitle(md, "Tina");
				md.write("<p>Tina slowly leans back against the bed as you order to to play with yourself. Squeezing her breast she smiles as her left hand quickly slides down to her pussy. Her fingers quickly begin stroking her clit as her breathing hastens from her open display of obedience and visual pleasure. The hand upon her breast begins pinching and tugging at her nipple.</p>" +
					"<p>Moaning, Tina thrusts her hips up toward you in an inviting way. Her hope that her display will incite you to fuck her. Continuing to rub her clit, she abandons her breasts and spreads the lips of her cunt apart to expose the damp flesh beneath. She shifts her attention away from her clit and quickly buries two fingers into her cunt. She gasps out, \u201cPlease " + perYou.getMaster() + ", fuck me! My pussy belongs to you!\u201d</p>" + "<p>Smiling at her words you continue to watch her furiously piston her fingers into her hole. Unconsciously her hips thrust upward as she works her hand into her wet hole. Her arousal reaching such a level that you can audibly hear her pussy from her arousal as the room is filled with her scent. She thrashes about as her orgasm hits, screaming loudly as her body is consumed by the very sensation washing over her.</p>" +
					"<p>She remains motionless for a few seconds afterward, basking in the wonderful afterglow of her orgasm. Lethargically she props herself up as the fingers buried in her cunt slip into her mouth. Noisily she sucks them clean, hoping to incite you to use her mouth as well. Once she has them cleaned.</p>");
				if (perYou.isMaleSex()) md.write("<p>\u201cI must clean up my fingers like I would clean my " + perYou.getMaster() + "'s cock after it has been inside me,\u201d she smiles sweetly.</p>");
				startQuestions();
				addLinkToPlaceC(md, "talk to Tina", Place);
				WritePlaceFooter(md);
				return true
			}
			if (sType == "submit") {
				md = WritePlaceHeader(false, "td-left-large");
				this.showPerson("tina8.jpg");
				addPlaceTitle(md, "Tina Robbins Under a Spell");
				md.write("<p>You order Tina to submit and she happily agrees, quickly removing your clothes and eyeing you anxiously.</p>" + '<p>"I am yours, ' + perYou.getMaster() + '. How may I serve..." she asks, her voice dripping with desire.</p>' + "<p>You take her in every way possible, Tina following your every command in a frenzy of sexual energy.</p>" +
					"<p>Eventually, and more than a little reluctantly, you pull yourself away from your magical little slut.</p>");
				startQuestions();
				addLinkToPlaceC(md, "talk to Tina", Place);
				WritePlaceFooter(md);
				return true
			}
		}
		if (Place == 130) {
			if (sType == "charmtina1") {
				md = WritePlaceHeader();
				this.showPerson("tina2.jpg");
				addPlaceTitle(md, "Tina Robbins Under a Spell");
				md.write('<p>You cast the charm spell on Tina Robbins. Surprise registers on her face as she learns what you have done to her. "Oh please no!" ' + "She exclaims. \"I didn't think that you could use magic too. You're not going to make me do things against my will, are you? Please don't.\"</p>" +
					"<p>As you wait for the spell to take effect you see that Tina's eyes are changing to a different colour. A pale green colour dilutes her pupils, seeking her soul.</p>" + '<p>Tina looks puzzled. "I should have known that you are another ' + perYou.getWitch() + " but you don't have the sign. Maybe because you are new to the craft. " + 'I have to let Davy know, he was trying to find out about all people of witch-blood in town." ' + 'She jumps up and walks to the door, raising her hand to knock loudly and calls out "Mom!"</p>');
				startQuestions();
				addLinkToPlaceC(md, "order Tina to get back on the bed?", Place, "type=charmtina2");
				WritePlaceFooter(md);
				return true
			}
			if (sType == "charmtina2") {
				md = WritePlaceHeader();
				this.showPerson("tina3.jpg");
				addPlaceTitle(md, "Tina Robbins Under a Spell");
				md.write('<p>You command the girl, "Stop! Do not tell your brother or mother, Tina. You are now my loyal and obedient slave, so you will serve and protect me from your brother".</p><p>You then hear from outside the bedroom Mrs. Robbins call out ');
				if (isCharmedBy("MrsRobbins", "Davy")) md.write('"Quiet Tina, My lovely Davy will be here for you soon enough!"</p>');
				else md.write('"Yes Tina?", and Tina replies, "It is alright Mom ' + perYou.getPersonName() + ' just told a bad joke.". Mrs. Robbins replies, "Alright dear, play nice!"</p>');
				md.write('<p>Tina turns to look at you and you continue, "Now, tell me what you are."</p>' + '<p>"I am your slave, ' + perYou.getMaster() + '.  I obey only you. My life is yours.  I obey you in all things.  Use me however and whenever you wish."</p>' +
					"<p>You are pleased with the spell's effects, but you wonder why Tina's eyes are turning green. You order her to tell you.</p>" + '<p>"My eyes are green because of my heritage, ' + perYou.getMaster() + '. All of my family are born with magic in their blood, though not all of us know how to use it."</p>' + '<p>"We have the power of mana that regenerates our lives every day. Once we use what we have we must wait for the next day. Some of my kin are very powerful, like Davy.  Compared to him, or you ' + perYou.getMaster() +
					', my powers are barely worth mentioning."</p>');
				startQuestions();
				if (!this.checkFlag(2)) addQuestionR(md, 'ask "You mentioned the sign?"', "She replies, &quot;Ignore the old tales of the devil&rsquo;s mark, but witches do bear a mark on them somewhere. It will usually look like a small tattoo but only to someone with the sight, the vision of one who wields magic.&quot;</p><p>You ask if she has such a mark, she smiles &quot;You will see&quot;", "Tina", "setPersonFlag(\\'Tina\\',2)");
				addLinkToPlaceC(md,
					"order Tina to give you what little mana she has?", Place, "type=charmtina3");
				WritePlaceFooter(md);
				return true
			}
			if (sType == "charmtina3") {
				md = WritePlaceHeader(false, "td-left-large");
				this.showPerson("tina4.jpg");
				if (this.charmed < 2) {
					this.charmed = 2;
					AddMana(8)
				}
				addPlaceTitle(md, "Tina Robbins Under a Spell");
				md.write('<p>"Yes ' + perYou.getMaster() + '," Tina says.  "My mana is yours. It is only a little, but it should help you to bring another person to serve you as much as I do.' + "<p>Do you wish to take me now my " +
					perYou.getMaster() + '?" she asks, inviting you to use her body in any way you might want.</p>' + "<p>Tina Robbins is an enticing figure. Your fingers stray to your ");
				if (perYou.isMaleSex()) md.write("crotch");
				else md.write("pussy");
				md.write(" as you watch her undress and display her body for you.  Something about a willing slave begging to be used begins to push you over the edge.</p>");
				startQuestions();
				addLinkToPlace(md, "take Tina Robbins like the slave she is?", Place, "type=charmtina4");
				WritePlaceFooter(md);
				return true
			}
			if (sType == "charmtina4") {
				md = WritePlaceHeader(false, "td-left-large");
				this.showPerson("tina5.jpg");
				addPlaceTitle(md, "Tina Robbins Under a Spell");
				md.write("<p>Your press your body into the inviting Tina and she responds with a long passionate kiss. Her hands are " + "everywhere, exploring your skin, stripping your clothes. A low growl issues from Tina's lips as you reach for one of " + "her breasts. Then, in a frenzy, she falls to her knees and spreads legs. You slide one finger into her pussy. She is more than ready.</p>");
				startQuestions();
				if (isCharmedBy("MrsRobbins", "You")) addPopupLinkToPlace(md, "enjoy yourself?", 163, "", "Not here...", "<img src='Images/People/Tina/Normal/tina10.jpg' class='imgpopup' alt='Tina'>" + "You reach out for your slave Tina, and she looks at you with an odd expression, a look of complete certainty,<br><br>" + '"Mom is free of Davy", and you nod in agreement and once again reach for her. She shakes her head,<br><br>' + '"Please, not here, let\'s go to my bedroom". You follow her to a nearby bedroom and when you get there she opens a side table and pours some red wine for you both and toasts you,<br><br>' +
					'"My ' + perYou.getMaster() + '! Take me as you desire"', 'setPlaceKnown("TinasRoom");movePerson("Tina",163)', "", true);
				else addLinkToPlace(md, "enjoy yourself?", 130);
				WritePlaceFooter(md);
				return true
			}
		}
		return false
	};
	per.showPersonChat = function(bGeneral, md) {
		if (!this.isHere() || sType !== "") return;
		if (this.isVampyre() && (isDay() || !this.checkFlag(6))) return;
		var perGeraldine = findPerson("MrsRobbins");
		if (Place == 130) {
			this.setFlag(1);
			if (this.other === 0) addQuestionC(md, '"Why are you in the bedroom"', "Tina", 620);
			else if (this.other ==
				1)
				if (!perGeraldine.isCharmedBy("Davy")) addQuestionR(md, "Don't worry, your mother is ok now", "You tell Tina that her mother is ok now, she is free of Davy&rsquo;s influence and she can leave the room. Tina seems uncertain and says that she will see later but she thanks you for whatever you did.", "Tina", "setPersonOther(\\'Tina\\',2);");
				else addQuestionC(md, '"Is there any way out?"', "Tina", 621);
			else if (this.other == 2) addQuestionC(md, '"What has been happening with Davy recently"', "Tina", 613);
			if (this.charmed >
				3 && perGeraldine.isCharmedBy("Davy")) addQuestionC(md, '"Tina, I want you to try and remove the spell cast on your mother."', "Tina", 6410);
			if (perGeraldine.isCharmedBy("Davy") && !perYou.isBornMale())
				if (isDay()) addLinkToPlace(md, "wait", "", "", "You wait for a time with Tina and night starts to fall. Once you think you heard Mrs. Robbins softly talking, you would guess on the phone but otherwise nothing happens.", "", "WaitforForDayNight();bChat=false;");
				else addPopupLinkToPlace(md, "wait", 992, "", "Tired...", '<p style="position:absolute;left:35%;top:1em;cursor:pointer;font-size:1.1em;width:62%"><b>The evening drags on and Tina lies down on the bed besides you. You know going to sleep is a bad idea but you cannot stop yourself, and you doze off...</b>',
					"", "top:10vh;left:5%;width:85%;height:80vh;padding:0;background-color:white;color:black;text-shadow:-1px 0px white, 0px 1px white, 1px 0px white, 0px -1px white;background-image:url(Images/People/Tina/Normal/" + (this.isCharmedBy() ? "tina9" : "robbinsbadenda") + ".jpg);background-size:100%;background-repeat:no-repeat;background-position:left bottom", true)
		}
		if (Place == 130 || Place == 163) {
			if (this.charmed == 2) addQuestionC(md, '"Can you take the mana from other people as well?"', "Tina", 612);
			if (this.charmed > 0) {
				addLinkToPlaceC(md,
					'"Play with yourself for me, Tina."', Place, "type=play");
				addLinkToPlaceC(md, '"You are mine to use whenever, and <i>however</i> I want... always remember that, Tina."', Place, "type=submit")
			}
			if (checkPlaceFlag("Park", 6) && !this.checkFlag(3)) addQuestionC(md, "ask about the symbol on the sign you saw", "Tina", 100)
		}
		if (this.isCharmedBy()) {
			if (this.place == 163) {
				addQuestionR(md, 'Tina, "Please come with me"', '"Of course ' + perYou.getMaster() + '"', "Tina", "bChatLeft=" + !this.isVampyre() + ";movePerson(\\'Tina\\',-1)");
				if (checkPersonFlag("Gabby",
						15) && !isCharmedBy("Gabby") && wherePerson("Gabby") == 415) addQuestionR(md, "ask Tina to help you break into Gabby's home", "Tina's knowledge of arcane symbols and her ability to absorb magic might be handy in disabling the wards or any trap you might find, this makes her your first and probably best choice for breaking in, and Tina is eager to be of use to you.</p>" + "<p>The two of you agree to meet at Gabby's house when you are ready to stage your break-in.", "Tina", "movePerson(\\'Tina\\',-1)")
			} else if (this.place !=
				-1) this.addFreeOptions(md);
			if (!this.checkFlag(11)) {
				var p;
				var plc;
				for (var i = 0; i < arPeople.length - 2; i++) {
					p = arPeople[i];
					if (p.uid == this.uid || p.isDead()) continue;
					plc = p.whereNow();
					if (p.isCharmedBy("You") && (plc == -1 || plc == Place) && !p.isVampyre() && p.health > 0)
						if (!p.isMaleSex()) addLinkToPlace(md, "ask Tina to pleasure " + p.getPersonNameShort(), Place, "type=" + (this.isVampyre() ? "tinapleasurevamp" : "tinapleasure") + "&with=" + p.uid, "", "", "", "chatblock")
				}
				if (Place == 161 && perDavy.isHere()) {
					addLinkToPlaceC(md, "pleasure Davy",
						Place, "type=tinapleasuredavy");
					if (perDavy.checkFlag(13)) addQuestionR(md, "ask Tina to drain mana from Davy", "Tina mentions that Davy is able to restore his mana every morning, so it might be a nice bonus to defeating him that she gives that Mana to you once a day.</p>" + "<p>\u201cOf course, " + perYou.getMaster() + ", It's not like he actually needs it.\u201d</p>" + "<p>Tina focuses for a brief moment, and you feel a small amount of mana rushing into your body. It's not much, possibly due to the circumstances he is in, but still useful." +
						(!this.checkFlag(12) ? "<p>You consider that you could ask Tina to do this once Davy recovers, and to do this you will have to <b>talk to Tina</b> to request it.</p>" : ""), "", "setPersonFlag(\\'Tina\\',12);perDavy.setFlag(13);AddMana(5)");
					else addQuestionR(md, "ask Tina to drain mana from Davy", "Tina mentions that Davy is able to restore his mana every morning, so it might be a nice bonus to defeating him that she gives that Mana to you once a day.</p>" + "<p>Tina apologizes. \u201cI can't extract any more Mana from him, and he only restores his reserves in the morning.\u201d</p>")
				}
			}
		}
		if (Place ==
			130 || Place == 163)
			if (!isDay() && this.isCharmedBy() && perGeraldine.isCharmedBy("You")) addSleepLink(md, "go to bed for the night with Tina", "Going to Bed with Tina", '<p style="position:absolute;left:35%;top:1em;cursor:pointer;font-size:1.1em;width:62%">You tell your beautiful slave that you will sleep here tonight. She lies down awaiting you.', this.getImg("tina9.jpg"), true)
	};
	per.showPersonTextHere = function(md) {
		if (Place == 130 && this.isHere()) {
			var perGeraldine = findPerson("MrsRobbins");
			if (perGeraldine.isCharmedBy("Davy") &&
				!perYou.isBornMale()) md.write("<p>Mrs. Robbins has thrown you into her bedroom and locked the door. You check the window to find it barred. There is no way out and Davy is sure to come home soon to subject you to his power.</p>");
			if (this.other === 0) {
				md.write("<p>Another girl is in the room with you, dressed only in her underwear. After some tense minutes she introduces herself as Tina, Davy's sister. You have met her before at a party but clearly she has no memory of you. ");
				if (perGeraldine.isCharmedBy("Davy")) {
					md.write("Like you Tina is trapped, waiting for Davy to arrive home.</p>");
					if (!checkPlaceFlag("RobbinsHouse", 9) && !perYou.isBornMale()) {
						showPopupWindow("Mrs Robbins", "<img src='Images/robbins1m.jpg' style='width:30%;float:right;margin-left:5px' alt='Blocked'>" + 'Mrs. Robbins screams, "Another girl for my lovely son! In you go to my bedroom you bitch and don\'t come out until Davy has cast his pretty spell."' + "<br><br>She slams and locks the door to the bedroom");
						setPlaceFlag("RobbinsHouse", 9)
					}
				}
				md.write('<p>She looks at you uncertainly, "You are not <i>with</i> Davy, I could feel it"')
			} else if (this.charmed >
				0) {
				md.write('<p>Tina Robbins is anxious to do your bidding. She begins rubbing herself in excitement.</p><p>"Command me, ' + perYou.getMaster() + "! I live to serve and obey you in all things!");
				if (perGeraldine.isCharmedBy("Davy"))
					if (!checkPlaceFlag("RobbinsHouse", 9) && !perYou.isBornMale()) {
						setPlaceFlag("RobbinsHouse", 9);
						showPopupWindow("Mrs Robbins", "<img src='Images/robbins1m.jpg' style='width:30%;float:right' alt='Blocked'>" + "Mrs. Robbins throws you back into the bedroom. \"I told you to get into the bedroom you bitch!  Davy hasn't come home to claim you yet and you're not leaving till he does!" +
							"<br><br>She slams and locks the door to the bedroom")
					}
			} else if (perGeraldine.isCharmedBy("Davy")) {
				md.write("<p>Tina Robbins is still sitting on the bed, apparently having accepted her fate. ");
				if (perYou.isBornMale()) md.write(" Now both of you are trapped, waiting for Davy to enslave you.");
				if (!perYou.isBornMale())
					if (!checkPlaceFlag("RobbinsHouse", 9)) {
						setPlaceFlag("RobbinsHouse", 9);
						showPopupWindow("Mrs Robbins", "<img src='Images/robbins1m.jpg' style='width:30%;float:right' alt='Blocked'>" + "Mrs. Robbins throws you back into the bedroom. \"I told you to get into the bedroom you bitch!  Davy hasn't come home to claim you yet and you're not leaving till he does!" +
							"<br><br>She slams and locks the door to the bedroom")
					}
			} else if (this.other >= 2) md.write("<p>Tina Robbins is still sitting on the bed, avoiding her mother. She will get over it but for now she is essentially hiding out here. ");
			else md.write("<p>Tina Robbins is still sitting on the bed, apparently having accepted her fate. ");
			md.write("</p>")
		} else if (Place == 43 && !this.checkFlag(4) && !isSpellKnown("Charm")) md.write("<p>As you step out of the alley you notice an attractive young woman in the distance, you think it is Tina, Davy Robbins older sister. but you are not sure, you have only met her once.</p>" +
			'<p>She is getting into a car, she must be getting a ride from a friend. Interesting, does this mean she lives near here, or is it her friend that does? She calls out to someone "...back soon..." and gets into the car and they drive off.</p>');
		else if (Place == 163 && this.isHere())
			if (this.checkFlag(5) && !this.checkFlag(6)) md.write("<p>Tina is still recovering in her bed.</p>");
			else if (isDay())
			if (this.isVampyre()) md.write("<p>Tina is sleeping in her bed, lightly bound to ensure she remembers when she wakes up that she is yours, and not just a predator.</p>");
			else md.write("<p>Tina waits for you, naked and beautifully lit by the sunlight streaming through the window.</p>");
		else if (this.isVampyre()) md.write("<p>Tina is waiting for you, drinking some wine, possibly tring to satisfy her thirst for something else.</p>");
		else md.write("<p>Tina is dressed in some lovely white lingerie, ready to strip at a moments notice.</p>")
	};
	per.handleItem = function(no, cmd) {
		if (no == 14 && cmd == 2)
			if (Place == 130 && this.isHere()) {
				CastCharmSpell("Tina", 130, 1, "type=charmtina1");
				return "handled"
			}
		return ""
	}
}

function RepliesTracy(nR) {
	var sibling = "Sis";
	if (perYou.isBornMale()) sibling = "Bro";
	if (nR == 1408) {
		setBeasleyServant(9);
		addComments('"So my brat sibling needs help. About time that you asked. Maybe we should go to the library. There is sure to be information there."')
	} else if (nR == 1412) {
		if (!isPlaceKnown("WildRanges")) setPlaceKnown("WildRanges");
		setBeasleyServant(32);
		addComments('"Mr. Beasley? Mana? Well, yes, I heard something about stones in the wild ranges but you must not think of Mr. Beasley as a bad man. He did nothing to me, he was just there when I spoke with Davy last."')
	} else if (nR ==
		8901) {
		per.other = 2;
		addComments("You mention to her about the meeting with Davy at school and ask if she as seen him around.</p>" + '<p>"No, no ' + sibling + '" she says. "Why do you ask? You know Mom dislikes him after that stuff with Kate."</p>' + '<p>"Hey Sis," you reply. "I am looking for him and I thought I heard you say his name when looking at your phone?"</p>' + '<p>"No..a friend was just being daffy, you know stupid! But...well, last I saw he was in the shopping mall, and he...  I don\'t want to talk about it." She says and changes the topic, asking you about how your friend Amy is.');
		if (perYou.isBornMale()) addComments('</p><p>After a bit she comments "What\'s with boys your age anyway?" but does not explain.')
	} else if (nR == 8902) {
		per.other = 3;
		if (wherePerson("Mom") === 0) movePerson("Mom", 154);
		addComments('"Not much. Mom said she wants to talk to you, though. You ought to find her, she was in her room last I saw."')
	} else if (nR == 8906) {
		Place = 45;
		per.place = 176;
		bChat = false;
		addComments(per.addPersonFace() + '"Oh, Davy wants me! I\'m on my way," she says exuberantly and rushes out of the house.')
	}
	return true
}

function TracyMorningAfterDavyEventDone() {
	movePerson("Tracy", 1);
	setPersonFlag("Tracy", 9);
	if (Place == 45) dispPlace()
}

function initialiseTracy() {
	addPerson("Tracy");
	per.charmThem(1, "Davy");
	per.Replies = RepliesTracy;
	per.getPersonAddress = function() {
		return "16 Kollam St, Glenvale"
	};
	per.getPersonName = function(full) {
		if (full === true) return this.name;
		return this.isCharmedBy("You") > 0 ? "Liberated Tracy" : "Tracy, your sister"
	};
	per.getYourNameFor = function() {
		return perYou.isBornMale() ? "Bro" : "Sis"
	};
	per.getPossessionFace = function() {
		return "tracy9"
	};
	per.whereNow = function() {
		if (this.place === 1) {
			if (this.other > 3 && this.other < 8 && this.isCharmed() &&
				!this.isCharmedBy()) return 156;
			else if (isDay()) return 45;
			if (perJesse.whereNow() == 6) return 45;
			if (getQueryParam("event") == "tracysnack") return 45;
			return 374
		}
		return this.place
	};
	per.passTimeDay = function() {
		this.setFlag(1, false);
		return ""
	};
	per.addPlaceImageLeft = function(lit) {
		if (getQueryParam("event") === "tracysnack") return this.showPersonRandom("tracy6", 2, "", "", "", "", 0, true, "string");
		return ""
	};
	per.showEventSleep = function(wt, plc, s, param) {
		if ((Place == 46 || Place == 170) && this.isCharmedBy("Davy") && !perYou.checkFlag(18) &&
			wt > 24 && !this.checkFlag(6) && this.place !== 0 && isSpellKnown("Charm")) {
			passTime(true);
			passTime(true);
			dispPlace(46, "type=tracyevent1&plc=" + Place);
			return true
		}
		return false
	};
	per.showEventPopup = function() {
		var sibling;
		if (Place == 45) {
			sibling = "Sis";
			if (perYou.isBornMale()) sibling = "Bro";
			if (this.other === 0 && perYou.getExperience() > 3 && perGates.other != 499 && sType === "") {
				this.other = 1;
				this.place = 1;
				setPersonFlagAfterTime("Tracy", 3, true, Math.floor(Math.random() * 24) + 24);
				showPopupWindow("Your Sister Tracy is Home", "<img src='Images/tracy0.jpg' class='imgpopup' alt='Tracy'>" +
					"When you walk in your front door, you see your older sister Tracy is back home. She must have just been changing and decided to get some ice cream from the kitchen, she loves ice cream. She is wearing very little as is her habit, she has little modesty and she is a bit of a tease at times. She brightly says,<br><br>" + '"Hi there little ' + sibling + ", want some? ice cream that is.\", yes she's a bit of a tease and yes you do want some.<br><br>" + "Tracy is your older sister by two years, and she always wants to be 'on top' and you have often argued with her. Despite this you get on well with her, she is helpful, funny and energetic.<br><br>" +
					"She works a couple of part-time jobs and studies part-time towards a business degree at college. Recently she has not been going to her jobs or studying, you think she has started a new relationship and is spending a lot of time with them, but she is keeping it secret from Mom and you." + (perYou.health < 100 && !this.checkFlag(7) ? "</p><p>You follow Tracy into the kitchen, and she notices your slight limp, she asks what happened and you tell her about the drain but do not mention Davy. She looks at you concerned,</p>" +
						'<p>"Alright young ' + perYou.getManWoman() + " get into the bathroom and I'll check it out. Take off your shoes and pants and wash the area before I check it out, I'll follow in a few minutes.\"</p>" + "<p>Tracy took a first aid course a few years ago and she has assumed the role of the family nurse ever since. Well, there is nothing you can do about it, Tracy will not take no for an answer and you should get your ankle checked, so you head into the bathroom..." : ""), perYou.health < 100 && !this.checkFlag(7) ?
					"gotoPlace(45,'type=firstaid1')" : "dispPlace()");
				return true
			} else if (this.isHere() && this.other !== 0 && perYou.health < 100 && !this.checkFlag(7) && sType === "") {
				showPopupWindow("Tracy your Older Sister", "<img src='Images/tracy1b-" + (isDay() ? "day" : "night") + ".jpg' class='imgpopup' alt='Tracy'>" + "When you walk in your front door, you see Tracy is sitting in the kitchen, and she notices your slight limp, she asks what happened and you tell her about the drain but do not mention Davy. She looks at you concerned,</p>" +
					'<p>"Alright young ' + perYou.getManWoman() + " get into the bathroom and I'll check it out. Take off your shoes and pants and wash the area before I check it out, I'll follow in a few minutes.\"</p>" + "<p>Tracy took a first aid course a few years ago and she has assumed the role of the family nurse ever since. Well, there is nothing you can do about it, Tracy will not take no for an answer and you should get your ankle checked, so you head into the bathroom...", "gotoPlace(45,'type=firstaid1')");
				return true
			} else if (this.isHere() &&
				perYou.isShot() && !this.checkFlag(8)) {
				this.setFlag(8);
				showPopupWindow("Tracy Looks Worried", "<img src='Images/tracyshot" + (this.isCharmedBy("You") ? "2" : "1") + "-" + (isDay() ? "day" : "night") + ".jpg' class='imgpopup' alt='Tracy'>" + "You see Tracy looking upset as you approach, but as she sees you she suddenly looks much happier. She leaps to her feet and hugs you,</p>" + '<p>"Silly Little ' + sibling + ", don't get me all worried like that. Mom and I were called to the hospital and you were lying there unconscious...We thought the worst until they told us you were fine and would recover quickly. I wanted to stay, so did Mom but they told us to return home and wait until they called. Then you came home all on your own!!\"</p>" +
					'<p>She hugs you again, "Be careful my dear ' + (perYou.isBornMale() ? "brother" : "sister") + '" She steps back and mentions that she was given your possessions and that she put them in your room. She then says,</p>' + '<p>"You should go see Mom", and yes you should.');
				return true
			} else if (sType == "firstaid1") {
				setQueryParams("");
				this.setFlag(7);
				perYou.health += 5;
				showPopupWindow("Tracy's First Aid", "<img src='Images/tracy-bath1.jpg' class='imgpopup' alt='Tracy'>" + "In the bathroom you remove your shoes and pants and start to wash your ankle in the bathtub. It is still quite painful, and you internally curse Davy. You hear Tracy behind you and you turn around and sit on the edge of the bath. Surprised you see Tracy is naked wrapped in a towel. For a moment she looks thoughtful but then smiles and tells you,</p>" +
					'<p>"No inappropriate ideas Little ' + sibling + ", I just needed to have a bath, so I'll check you out and then you can get out of here!\". That is more like Tracy, no modesty and a big tease!</p>" + "<p>She kneels, keeping her towel covering all the interesting bits, but it does not stop you trying to peek at times as she examines your ankle...", "gotoPlace(45, 'type=firstaid2')");
				return true
			} else if (sType == "firstaid2") {
				setQueryParams("");
				showPopupWindow("Tracy's First Aid", "<img src='Images/tracy-bath2.jpg' class='imgpopup' alt='Tracy'>" +
					"Tracy announces that there is no problems with your ankle, and suggests some simple painkillers until it gets better. Still, your ankle feels a little better, sore but better. You thank her, and Tracy smiles,</p>" + '<p>"Ok time to get out of here Little ' + sibling + ', but you know I saw you looking, or trying to look. Since you thanked me you can inappropriately check me out too". With that she pulls away her towel so it covers her front, exposing her lovely ass. She grabs one of your shoes and throws it at you laughing,</p>' +
					'<p>"Now get out of here!"</p>', "dispPlace(45)");
				return true
			} else if (sType == "snack1") {
				setQueryParams("");
				showPopupWindow("A Snack with Tracy", "<img src='Images/tracy1d.jpg' class='imgpopup' alt='Tracy'>" + "Tracy meets you after her quick shower and has slipped on some simple clothes. She starts to make some kind of ice cream treat, she loves ice cream.<br><br>" + "She seems a lot happier now, either the memories are fading or that shower was very refreshing. She jokes around a bit with you and then tries to balance a spoon on her nose, successfully.<br><br>" +
					"As she does you notice her pants are starting to slip down and you can see she is not wearing any panties. She notices your glance and lightly says,<br><br>" + '"You know when that Davy was...talking...to me once he said that he really wanted his older sister, you know...wanted to fuck her...Do you think all siblings fantasise about their older sisters?"<br><br>' + "You notice her pants slip a little more...", "gotoPlace(45, 'type=snack2')");
				return true
			} else if (sType == "snack2") {
				setQueryParams("");
				showPopupWindow("Whoops!",
					"<img src='Images/tracy1e.jpg' class='imgpopup' alt='Tracy'>" + "Tracy pants slip down completely to her ankles when she turns to eat some ice cream. She looks back at you,<br><br>" + '"I am sure they do, like big sisters sometimes day-dream about their younger siblings"<br><br>' + "She quickly pulls up her pants and completely changes the topic and makes a joke about something different as she passes you some ice cream.<br><br>" + "You realise the moment has passed, and that it seems her experience being charmed has slightly affected her, but is it for the better?",
					"dispPlace('','')");
				return true
			}
			var bTracyHere = this.whereNow() == 45 || this.whereNow() == 156;
			if (wherePerson("Mom") == 154 || !bTracyHere) return false;
			var perTess = findPerson("Tess");
			var perTanika = findPerson("MrsTanika");
			var perAnita = findPerson("Anita");
			if (perTess.place == 45 && !perTess.checkFlag(7)) {
				showPopupWindow("", '<img src="Images/' + perTess.getImg("tess21.jpg") + '" style="float:right;width:35%;margin-left:5px" alt="Tess">' + "<p style='text-align:center;margin-top:-12px;font-size:x-large'><b>Tess with Tracy</b></p>" +
					"As you enter the " + (nFromPlace == 44 ? "front door of your home" : "living room") + ", you hear some voices in conversation, your mother is talking to someone,</p>" + '<p>"What do you see in my Little ' + (perYou.isBornMale() ? "Bro" : "Sis") + '?" you hear Tracy ask.</p>' + '<p>"I love ' + perYou.getHimHer() + ' it was love at first sight!" and you recognise the voice as Mrs. Adams, that is Tess.</p>' + "<p>Tracy continues, \"While not that it matters, what about your husband? It's not like you need " + perYou.getPersonName() +
					'?", Tracy is teasing Tess, so you step in and say "Tracy please go easy on Tess!"</p>' + "<p>Tess sees you and almost leaps to her feet in her happiness, and immediately trips over. You smile and help your beautiful klutz to her feet as Tracy watches. Tess glances at her and to make a point embraces you and kisses you passionately.</p>" + "<p>Tracy tells Tess, \"Well I'll speak to Mom and I'm sure she will agree eventually, welcome here, visit any time you like\", from her expression she seems to genuinely likes Tess.</p>" +
					'<p>Tess smiles at your mother and then looking you she says, "I will wait for you in your <i>bedroom</i>" and she leaves you with your mother. Tracy looks at you and just says,<br><br>' + '"You are one lucky ' + perYou.getSex() + '"', "setPersonFlag('Tess',7);movePerson('Tess',46)");
				return true
			}
			if (perTanika.place == 45 && !perTanika.checkFlag(2) && !isDay()) {
				var clvT = perTanika.getCharmedLevel();
				var s = '<img src="Images/' + perTanika.getImg("tanika12f.jpg") + '" style="float:right;width:40%;margin-left:5px" alt="Tanika">' +
					'When you enter the living room Tracy greets you, "You are in trouble little ' + (perYou.isBornMale() ? "Bro" : "Sis") + ", one of your teachers is here! It is Mrs. Ice Queen, she's just in the toliet\". She used a nickname she used for Mrs. Tanika back when she attended your school.</p>" + "<p>A moment later Mrs. Tanika returns smiling,</p>" + '<p>"' + perYou.getPersonName() + '! I have been having a chat with my ex-student Tracy..."</p>' + '<p>and Tracy almost interrupts, "and Mrs. Tanika tells me that you promised that she could temporarily sleep here on our couch, something about an argument with her husband and how you offered. Really, you should have asked Mom first!" she looks over at Mrs. Tanika. You remember in the past your mother had some arguments with Mrs. Tanika, some dispute when Mom was doing some volunteer work at the school. You would not be surprised it was just that they both have...forceful personalities. Mrs. Tanika smiles at you,</p>';
				if (clvT == 2) s += '"Well, ' + perYou.getPersonName() + " is a good student, except for " + perYou.getHisHer() + " grades, and I am sure I can tutor " + perYou.getHimHer() + " to repay, there are some " + (perYou.isMaleSex() ? " particularly 'hard' problems" : "'oral' quizzes") + ' I can help with"</p>';
				else s += '"' + (!perYou.isBornMale() ? "Mistre..Miss" : "Master...Mister") + " " + perYou.getPersonName() + " is my best student and I am sure I can tutor " + perYou.getHimHer() + ' however they want of me"</p>';
				s += 'Tracy chuckles and mentions something about talking to Mom but was sure it will be ok, and she goes into the kitchen to get some ice cream, asking if you want some too, but you are too distracted. Mrs Tanika leans over an whispers "I packed some lingerie, let me model them for you" and she heads over to your room.';
				showPopupWindow("Mrs Tanika with Tracy", s, "setPersonFlag('MrsTanika',2);movePerson('MrsTanika',46)", "color:black;background-color:white");
				return true
			}
			if (perAnita.place == 45 && !perAnita.checkFlag(9)) {
				var perAnita = findPerson("Anita");
				showPopupWindow("Anita with Tracy", '<img src="Images/' + perAnita.getImg("anita9c.jpg") + '" class="imgpopup" alt="Anita">' + "As you enter the " + (nFromPlace == 44 ? "front door of your home" : "living room") + ", you hear Tracy talking,</p>" + '<p>"What is you relationship with my Little ' +
					(perYou.isBornMale() ? "Bro" : "Sis") + '?"</p>' + '<p>You quickly decide that you must get involved and call out to Tracy, "Tracy, let me explain!", as you frantically try to work out how to explain Anita. Anita of course just makes it worse,</p>' + '<p>"Commander, I am here as you ordered!", Tracy exclaims or is it laughs, "Commander, ordered?"</p>' + '<p>You look pointedly at Anita, "Anita, very funny. Tracy, Anita is a bit of a nut about military things and gets carried away. We are just working together on a history project at school about...militia organisations in the 20th century. she is going to overnight sometimes, her home is under going major renovations?"</p>' +
					"<p>Tracy comments \"I'm sure you will be working together on an <b>organ</b>isation. Well Commander Little " + (perYou.isBornMale() ? "Bro" : "Sis") + ', what are your orders?" and she laughs as she waves and goes into her room.</p>', "setPersonFlag('Anita',9);movePerson('Anita',46)", "background-color:white;color:black;text-shadow:-1px 0px white, 0px 1px white, 1px 0px white, 0px -1px white;");
				return true
			}
			return false
		}
		if (Place == 46 && sType == "tracyevent1") {
			this.setFlag(6);
			showPopupWindow("Woken up...", "<img src='Images/tracyevent1.jpg' class='imgpopup' alt='Tracy'>" +
				"<p>Strange noises wake you up in the middle of the night, and as your eyes begin to adjust to the darkness, you are barely able to make out a feminine looking silhouette in your room.</p>" + '<p>"Hello?" You drowsily call out, but the figure remains silent and unmoving, which is suspicious enough to jolt you awake and almost hammer your fist onto the switch of the nightlight.', "dispPlace(46,'type=tracyevent2&plc=" + getQueryParam("plc") + "')");
			setQueryParams("");
			return true
		}
		return false
	};
	per.showEvent =
		function() {
			var md;
			var sibling;
			if (Place == 269 && sType == "tracypool") {
				WaitHereOnly(6);
				md = WritePlaceHeader();
				this.showPerson(this.isCharmedBy("You") ? "tracy-poolc.jpg" : "tracy-poolu.jpg");
				addPlaceTitle(md, "Swimming with Tracy");
				md.write("<p>Tracy arrives and changes into her swimsuit, but suggest you sit in the hot-tub area than the main pool.</p>" + "<p>You have a fun time relaxing in the hottub with your sister Tracy.</p>");
				startQuestions();
				if (this.isCharmedBy("You") && this.getCharmedLevel() == 2) addLinkToPlaceC(md,
					"it is fairly private here...", Place, "type=tracypoolsex");
				addLinkToPlaceC(md, "say goodbye to Tracy", Place);
				WritePlaceFooter(md);
				return true
			}
			if (Place == 269 && (sType == "tracypoolsex" || sType == "tracypoolsexcharm")) {
				md = WritePlaceHeader();
				this.showPerson("tracy-poolc-sex.jpg");
				if (sType == "tracypoolsexcharm") {
					addPlaceTitle(md, "More Than Swimming With Your Lover Tracy");
					md.write("<p>You take Tracy into your arms and whisper that it is private here, and she understands your suggestion. She removes the rest of her bikini and you make love with your sister for the first time, a delicious taboo combined with some exhibitionism here in the hottub!</p>")
				} else {
					addPlaceTitle(md,
						"More Than Swimming With Tracy");
					md.write("<p>You mention to Tracy that it is quite private here, and she grins as she understands your suggestion. She removes the rest of her bikini ready to have a private 'chat' as you have at home!</p>")
				}
				startQuestions();
				addLinkToPlaceC(md, "later...say goodbye to Tracy", Place);
				WritePlaceFooter(md);
				return true
			}
			if (Place == 46 && sType == "tracyevent2") {
				md = WritePlaceHeader();
				sibling = "Sis";
				if (perYou.isBornMale()) sibling = "Bro";
				this.showPerson("tracyevent2.jpg");
				addPlaceTitle(md,
					"Sleepover?");
				var plc = getQueryParam("plc");
				md.write("<p>Tracy is standing close to your cabinets and looks at you like a deer caught in headlights, awkwardly fiddling with her hands before finally speaking up.</p>" + '<p>"Hey little ' + sibling + ', I\'m sorry I woke you up." She stretches herself and presents her body to you invitingly and gives you a sweet smile over the shoulder.. "I\'ve really been having problems sleeping of late, and was wondering if you would mind if I crawl into your bed."</p>' +
					'<p>"It always helped when we were kids."</p>' + "<p>You are... surprised by her request, to say at least. The two of you have not shared a bed for a long time for obvious reasons, and while Tracy has pretty much enjoyed teasing you from the first day she realized " + (perYou.isBornMale() ? "boys found her attractive" : "you are into girls") + ", there are lines she would usually not cross.</p>" + (plc == "170" ? "You look to the side and see Tess stir a little, but it does seem like she's a heavy sleeper and not bothered by the conversation, and it's not like she would protest your decision anyway." :
						"") + "</p>");
				startQuestions();
				addOptionLinkC(md, "deny her request", "WaitforForDayNight('<p>You tell Tracy you are sorry, but this is not something you are comfortable with, and while she pulls a pouty lip, and for a moment seems to desperately try to find another reason to stay, she finally accepts your decision and leaves your room.</p>" + "<p>The whole encounter was... weird. There was something unsettling about the way Tracy acted, and after she left you decide to lock your door just to be sure, and feel it&rsquo;s a good idea to keep doing so the following nights.')");
				addPopupLinkC(md, "invite her in", "Tracy joins you", '<img src="Images/tracy11a.jpg" style="position:absolute;width:100%;bottom:0" alt="Tracy">' + '<p style="position:absolute;left:2%;top:2em;cursor:pointer;font-size:1.1em;width:66%">\u201cThank you little ' + sibling + "!\u201d Tracy happily crawls into your bed and presses a soft kiss to your cheek before her warm body nestles against yours and her arms tenderly pull you into a hug.<br><br>" + "You wrap the two of you in your blanket, pull her closer and turn of the light, but it takes you a while to get back to sleep like this. Your sisters warm breath brushing against your neck is almost as distracting as the feel of her soft, bare skin against yours, but after a while, you finally drift off to sleep.",
					true, "WaitforForDayNight();gotoPlace(45,'type=tracyevent3');", false, undefined, "background-color:white;color:black;top:10%;left:5%;width:85%;height:80vh;padding:0");
				WritePlaceFooter(md);
				return true
			}
			if (Place == 45 && sType == "tracyevent3") {
				md = WritePlaceHeader();
				sibling = "Sis";
				if (perYou.isBornMale()) sibling = "Bro";
				this.showPersonRorX("tracyevent3.jpg");
				addPlaceTitle(md, "Something seems to be Missing");
				AddImage("Player/" + sAvatarFolder + "/charmedbydavy-enslaved.jpg", "30%");
				md.write("<p>The first thing you notice when you wake up is that Tracy is gone, but she has always been an early riser, so nothing is really out of the ordinary... until you realize that the book missing as well.</p>" +
					"<p>Panic begins to spread in your gut as you look around your room and find nothing. Tracy must have taken it while you slept... but why would she do that?</p>" + "<p>You don't bother dressing before you leave the room and quickly head towards the Kitchen in hopes of confronting your sister, and are instead greeted by Davy, who is standing in front of the kitchen table with the book spread out on it and your mother kneeing before him, enthusiastically sucking his cock.</p>" + "<p>Good morning, " + perYou.getPersonName() +
					"!\u201d He greets you with a cocky smile and your mother gags as he forces her head down to the base of his shaft.\u201cYou have a lovely family.\u201d</p>" + "<p>You know you need to act fast, run, cast the charm, maybe charge him, but Tracy is suddenly behind you and holds you in place. You manage to shake her off quickly, but it is already too late...</p>" + "<p>Uh...Oh...</p>" + "<p>\u201cDai Chu, " + perYou.getPersonName() + "!\u201d You have no chance to react and immediately feel a wave of warmth rushing though your body the moment he finished the phrase. Your " +
					(perYou.isMaleSex() ? "manhood hardens" : "folds are getting wet") + " as your body is flooded with new sensations, making it harder to think every passing second.</p>" + "<p>\u201cDavy you... fucking...\u201d You vision blurs and reality changes before your eyes, Davy suddenly doesn't seem to be that bad a person actually, in fact, he is quite handsome, why did you never...NO!</p>" + "<p>You try to force that thought out of your mind, it is not real, not yours, you know the spell is messing with your head!</p>" +
					"<p>\u201cI have to thank you, " + perYou.getPersonName() + ".\u201d Davy speaks again, and his voice suddenly bears a deep, sensual timbre sending shivers down your spine. \u201cGetting the book from the old man would have been much harder than this, so, " + (perYou.isBornMale() ? "while I usually prefer to take women, I will honor your effort by making an exception to properly reward you." : "once the spell has turned you into my little slaveslut, I will properly reward you.") + " Undress!\u201d</p>" + "<p>There is a force behind the command ushered, and while you do not want to take of your clothes, your hands betray you and tear off what little you are wearing.</p>" +
					"<p>\u201cI will not be your slave...\u201d The words were supposed to come out strong, defiant, and certainly not like the desperate whimper you actually managed to muster. Also, why would you want to be defiant? Davy has such commanding presence and wonderful voice... He is the perfect master and you don't really remember anymore to ever not have been attracted to him.</p>" + "<p>\u201cBut you are already, aren't you, lil " + sibling + "?\u201d Tracy coos happily from behind and Davy confirms it. \u201cYou are already a slave, " +
					perYou.getPersonName() + ".\u201d The words reecho within your head and every attempt to block them out is failing. \u201cYou are my slave. You will do whatever I want, " + (perYou.isMaleSex() ? "and only fuck whenever I want" : "and I will fuck you whenever I want") + ".\u201d</p>" + "<p>The words hammer into your mind and the sensation of it almost makes you climax. You feel your mind starting to spin, and as your vision clears, you finally notice the faint pink glow in your mothers and sisters eyes, a symbol of their bound with the most wonderful man you have ever known.</p>" +
					"<p>\u201cMaster...\u201d You say happily, and as he beckons you closer, you eagerly follow up and knee next to your mother and sister in front of his perfect cock, ready to embrace a new, happy life of servitude.\t</p>");
				startQuestionsOnly();
				addRestartLink(md);
				WritePlaceFooter(md);
				return true
			} else if (sType == "listendavy1") {
				md = WritePlaceHeader();
				this.showPerson("tracy12.jpg");
				addPlaceTitle(md, "Spying on Tracy");
				this.setFlag(9);
				this.place = 1;
				md.write("<p>It sounds like Tracy is on the phone, and while you usually wouldn't spy on your sister like that, her behavior of late has been very strange and you have to know what is going on.</p>" +
					"<p>\u201cNo, " + perYou.getHeShe() + " caught me when I tried to take it,\u201d You hear her say. \u201cAnd now " + perYou.getHeShe() + "'s locking the door...\u201d</p>" + "<p>Is she talking about last night? You open the door a little just as she turns around, you notice with a light blush that she has opened her Jacket.</p>");
				startQuestions();
				addLinkToPlace(md, "keep listening", 122, "type=listendavy2");
				WritePlaceFooter(md);
				return true
			} else if (sType == "listendavy2") {
				sibling = "sister";
				if (perYou.isBornMale()) sibling =
					"brother";
				md = WritePlaceHeader();
				this.showPerson("tracy13.jpg");
				addPlaceTitle(md, "Spying on Tracy");
				md.write("<p>\u201cI'm so sorry I have disappointed you, I'll try harder and...\u201d There is a small pause, and Tracy suddenly shouts.</p>" + "<p>\u201cNO!\u201d</p>" + "<p>You pull back a little, hoping she did not see you, but she continues to speak.</p>" + "<p>\u201cI mean, you don't need to send " + (isMurderPath() ? "that woman" : "someone") + " after " + perYou.getHimHer() + "...\u201d</p>" + "<p>Another pause follows, and your heart begins to pound faster.</p>" +
					"<p>\u201cOf course not, but " + perYou.getHeShe() + "'s my little " + sibling + "! Just give me a few days and I...\u201d</p>" + "<p>Another pause, and Tracy breathes out in relief and lets herself fall back on the bed.</p>");
				startQuestions();
				addLinkToPlace(md, "keep listening", 122, "type=listendavy3");
				WritePlaceFooter(md);
				return true
			} else if (sType == "listendavy3") {
				md = WritePlaceHeader(false, "td-left-large");
				this.showPerson("tracy14.jpg");
				addPlaceTitle(md, "Spying on Tracy");
				md.write("<p>\u201cThank you! I promise there will be no need to hurt " +
					perYou.getHimHer() + "! And once you have the book you can speak with " + perYou.getHimHer() + " and " + perYou.getHeShe() + "'ll finally see you as the wonderful person you are, we could even have a threesome!\u201d</p>" + "<p>Tracy seems to relax a little, and you can hear her breath growing more heavy as she listens to the person on the phone, her voice playful and teasing as she speaks.</p>" + "<p>\u201cYes, I am touching myself... always thinking of all the dirty things we did the day you said those words to me...\u201d She pushes her panties to the side and... this might be a good time to stop looking...</p>");
				startQuestions();
				startAlternatives(md);
				addLinkToPlace(md, "keep listening, and looking", 122, "type=listendavy4look");
				addLinkToPlace(md, "don't look, but keep listening", 122, "type=listendavy4nolook");
				endAlternatives(md);
				WritePlaceFooter(md);
				return true
			} else if (sType == "listendavy4look" || sType == "listendavy4nolook") {
				md = WritePlaceHeader(false, "td-left-large");
				if (sType == "listendavy4look") this.showPerson("tracy15.jpg");
				else addPlaceImage(md, "bedroom8.jpg");
				addPlaceTitle(md, sType == "listendavy4look" ? "Spying on Tracy" :
					"Listening to Tracy");
				if (sType == "listendavy4look") md.write("<p>You really shouldn't be doing that. Sure, Tracy has never someone who is ashamed of her sexuality, quite the opposite, really, but there have always been boundaries between the two of you, and watching her touch herself like this just feels... wrong... and exciting...</p>" + "<p>And kind of hot.</p>" + "<p>Your heart beats faster as she begins to slowly caress her folds and run two fingers over her clit, and you listen to her as she describes every motion she makes in a playfully sensual voice.</p>" +
					"<p>Tracy pulls in her lower lip to stifle a moan, stretching her body out on the bed while she slowly picks up the pace.</p>" + "<p>By the time she is close to reaching her peak, you have almost forgotten why you were here in the first place. She no longer tries to muffle her voice now, moaning freely into the phone while her petals begin to twitch visibly and a short climax rushes through her body.</p>" + "<p>\u201cYes, that was great...\u201d There is a brief pause where she catches her breath before she speaks on. \u201cOf course! Talk to you soon!\u201d She smacks her lips for a kiss. \u201cI love you, Davy!\u201d</p>" +
					"<p>Davy...</p>" + "<p>A cold shiver runs through you as you hear the name and your mind is pulled back into reality.</p>" + "<p>Right, Tracy's mind is under the Dai Chu, you can't afford to forget that, and now you know that Davy Robbins must be the one who did it... and that thought alone makes you...</p>");
				else md.write("<p>Your sister touching her... private parts while under someone else's control is really not something you want to see, and you quickly pull back from the door and focus on her voice alone.</p>" +
					"<p>Tracy begins to describe what she is doing, but, to your luck, is cut short by the person on the other end of the line, and clearly disappointed.</p>" + "<p>\u201cOh... you are with her...\u201d She sighs briefly, but it doesn't seem to be a permanent blow to her mood. \u201cOf course! Talk to you soon!\u201d She smacks her lips for a kiss. \u201cI love you, Davy!\u201d</p>" + "<p>Davy...</p>" + "<p>A cold shiver runs through you as you hear the name and quickly return to the kitchen.</p>" + "<p>You had suspected it, but now it's clear... Davy Robbins has taken over the mind of your sister.... and that thought alone makes you...</p>");
				startQuestions();
				startAlternatives(md);
				addLinkToPlace(md, "...angry! You have to protect your family", 122, "type=listendavy5angry");
				addLinkToPlace(md, "...jealous! Tracy is yours", 122, "type=listendavy5jealous");
				endAlternatives(md);
				WritePlaceFooter(md);
				return true
			} else if (sType == "listendavy5angry" || sType == "listendavy5jealous") {
				md = WritePlaceHeader();
				this.showPerson("tracy16.jpg");
				addPlaceTitle(md, "Finished Spying on Tracy");
				if (sType == "listendavy5angry") md.write("<p>If there was ever any doubt that Davy is dangerous, it's gone now. He openly moved against you via your family, and you have to fight back if you don't want mom and yourself to fall under his control like Tracy.</p>" +
					"<p>Of course, the question is: how? Davy has a head-start, he likely has put other women in Town under his control, and he seems to know the ways of magic better than you do.</p>" + "<p>You need to increase your power, learn new spells and find a way to free Tracy. You know there are people who could help you, with the right persuasion.</p>" + "<p>The Dai Chu is a way to even the odds, maybe you had your reservations using it, maybe not, but it looks like you will need it if you want to fight back.</p>" +
					"<p>At least it seems like Tracy has given you a few days time to organize. Better make use of them.</p>");
				else md.write("<p>So, Davy knows you have the book and wants to take it from you...</p>" + "<p>You don't know what his ultimate plan is, but now that you have finally begun to learn magic and gather power, you are not going to let him take that away from you, and if someone is going to charm your sister, it will be you.</p>" + "<p>Of course, to do so, you have to find a way to remove Davy's spell from her first.</p>" +
					"<p>Tracy has bought you a few days before Davy's next move, and you need to use those to bring more people under your control and increase your power and influence in the city.</p>" + "<p>The Dai Chu can make you the most powerful person in the entire city, and you will not let Davy get in your way and steal what is yours, including Tracy.</p>");
				startQuestions();
				addLinkToPlace(md, "return to the kitchen", 45);
				WritePlaceFooter(md);
				return true
			}
			if (Place == 45 && sType == "breakfast") {
				md = WritePlaceHeader();
				setQueryParams("");
				passTime(false, true);
				var perMom = findPerson("Mom");
				perMom.setFlag(16);
				var perTess = findPerson("Tess");
				this.setFlag(1);
				var img;
				if (perMom.place != 154) img = "sister";
				else if (this.place != 1) img = "mom";
				else img = Math.random() < .5 ? perTess.place == 46 ? Math.random() < .6 ? "sister" : "tess" : "sister" : perTess.place == 46 ? Math.random() < .6 ? "mom" : "tess" : "mom";
				if (img == "mom") img = perMom.getArousal() > 0 ? "mom-breakfast2.jpg" : "mom-breakfast1.jpg";
				else if (img == "tess") img = Math.random() < .5 ? "tess-breakfast1.jpg" : "tess-breakfast2.jpg";
				else img =
					this.isCharmedBy("You") ? "tracy-breakfast1.jpg" : "tracy-breakfast2.jpg";
				AddImage(img);
				var w = perMom.place != 154 ? "Tracy" : this.place != 1 ? "Mom" : "Mom and Tracy";
				if (perTess.place == 46 && perMom.place == 154 && this.place == 1) w = "Tess, " + w;
				else if (perTess.place == 46) w += " and Tess";
				addPlaceTitle(md, "Breakfast with your family");
				md.write("<p>Before you head out for the day you decide to have a quick breakfast with " + w + " ");
				switch (img) {
					case "mom-breakfast1.jpg":
						md.write("and you see Mom is wearing a floral pattern dress. During breakfast she spills something on it and mutters how she will have to change.</p>");
						break;
					case "mommom-breakfast2.jpg":
						md.write("and you see Mom has not yet dressed before breakfast, and is just wearing some underwear. When you comment she just smiles, and sits down to eat.</p>");
						break;
					case "tracy-breakfast1.jpg":
						md.write("and your sister dressed rather cutely in her rather skimpy nightie.</p>");
						break;
					case "tracy-breakfast2.jpg":
						md.write("and when the food is ready you have to go get your sister as she is still in the bathroom. She does not respond to a knock on the door so you open it, and she is doing her hair, completely naked!</p>");
						break;
					case "tess-breakfast1.jpg":
					case "tess-breakfast2.jpg":
						md.write("and when you go to get Tess you see she has just had a shower and thrown something on for breakfast. Your only thought is 'Wow'</p>");
						break
				}
				md.write("<p>After breakfast you say your goodbyes to " + w + " for the day.</p>");
				startQuestions();
				addLinkToPlace(md, "tidy up after breakfast", 45, "");
				addLinkToPlace(md, "leave your house", 44);
				WritePlaceFooter(md);
				return true
			}
			if (sType === "" && Place == 45 && nFromPlace == 374 && !isDay() && this.isCharmedBy() &&
				Math.random() < .15) setQueryParams("event=tracysnack");
			if (Place == 45 || Place == 269 || Place == 374) {
				sibling = "Sis";
				if (perYou.isBornMale()) sibling = "Bro";
				if (sType == "tracycharmhome1") {
					md = WritePlaceHeader();
					this.showPersonDN("tracy2.jpg", "height:max");
					addPlaceTitle(md, "Tracy Under a Charm Spell");
					md.write("<p>You cast the spell on your sister. Immediately Tracy falls under the influence of desire. Against her basic " + "instinct she begins to have strong, erotic feelings towards you and very quickly starts becoming visibly aroused.</p>" +
						"<p>&quot;" + perYou.getPersonName() + "&quot; Tracy exclaims. &quot;I can't believe it but I'm getting " + "that feeling again, but this time it's not for Davy. It's for you. This isn't right! You are my little ");
					if (perYou.isBornMale()) md.write("brother");
					else md.write("sister and I'm not a lesbian");
					md.write(". I have to stop!&quot;</p>");
					startQuestionsOnly();
					addLinkToPlaceC(md, "tell your sister not to worry", Place, "type=tracycharmhome2");
					WritePlaceFooter(md);
					return true
				}
				if (sType == "tracycharmhome2") {
					md =
						WritePlaceHeader();
					this.showPersonDN("tracy3.jpg");
					addPlaceTitle(md, "Tracy Under a Desire Spell");
					md.write("<p>&quot;I have to <i>not</i> worry?&quot; asks Tracy, confused by the emotions and lust overwhelming her mind. " + "&quot;I shouldn't worry about anything, should I? Especially when " + "I feel so hot, so horny. You feel the same for me, don't you " + perYou.getPersonName() + "? Please say that you love me.&quot;</p>");
					startQuestionsOnly();
					addLinkToPlace(md, "reassure Tracy that you love her as her " +
						(perYou.isBornMale() ? "brother" : "sister"), Place, "type=tracycharmhome3");
					addLinkToPlace(md, "<b>tell</b> Tracy that you love her as a " + perYou.getManWoman(), Place, "type=tracycharmhome3incest");
					WritePlaceFooter(md);
					return true
				}
				if (sType == "tracycharmhome3" || sType == "tracycharmhome3incest") {
					md = WritePlaceHeader();
					sibling = perYou.isBornMale() ? "brother" : "sister";
					if (sType === "tracycharmhome3" && perYou.checkFlag(26)) {
						this.showPersonDN("tracy4a.jpg");
						addPlaceTitle(md, "Tracy Under a Desire Spell");
						setPersonFlag("Mom",
							25);
						md.write("<p>Your heart beats faster as you watch her strip. " + "Tenderly, you reach for her shoulders, intending to give " + "her the most meaningful hug of your lives but you " + "remember she is your sister and back away.</p>" + "<p>&quot;No, Tracy!&quot; you order. &quot;We are not " + "going to... Do not desire me! I mean, you don't want me like that " + "anymore and everything is alright. Play with yourself and enjoy it&quot;</p>" + "<p>&quot;Whatever you say,&quot; replies your sister, " + "absorbing the new orders like water into a sponge. " +
							"&quot;I have such a considerate " + sibling + ".&quot; " + "Tracy no longer craves you and contentedly strokes herself.</p><p>A close call.</p>");
						startQuestionsOnly()
					} else {
						this.showPersonDN("tracy4b.jpg");
						addPlaceTitle(md, "Tracy Under a Desire Spell");
						this.charmThem(2);
						if (sType === "tracycharmhome3") md.write("<p>You try to tell Tracy to calm down and not desire you, but you can see your words have no effect on her, your ability to control the spell and her are limited. You have no choice, you have to instead take her as your lover.</p>");
						md.write("<p>Your heart beats faster as you watch her strip. Tenderly, you reach for her shoulders, intending to give " + "her the most meaningful hug of your lives fully aware she is your sister but you no longer care.</p>" + "<p>&quot;Tracy, I love you&quot; you tell her and then you kiss her, no " + sibling + "ly kiss, but one as her lover!</p>" + "<p>&quot;Nothing matters aside from our love as a " + perYou.getManWoman() + " and a woman&quot;</p>" + "<p>&quot;I love you too&quot; replies your sister, absorbing the new orders like water into a sponge. " +
							"&quot;I do not care that you are my " + sibling + ", I love you.&quot;</p>");
						startQuestionsOnly();
						addLinkToPlace(md, "take her to her bedroom", 122, "type=charm")
					}
					addLinkToPlace(md, "go to your bedroom", 46);
					addLinkToPlace(md, "exit the house", 44);
					WritePlaceFooter(md);
					return true
				}
				if (sType == "tracycharmpool1") {
					md = WritePlaceHeader();
					this.showPerson("tracy2-pool.jpg", "height:max");
					addPlaceTitle(md, "Tracy Under a Charm Spell At The Pool");
					md.write("<p>As you watch your sister Tracy sitting there in the hottub, you decide it is time, and you cast the charm spell. Immediately Tracy falls under the influence of desire. Against her basic " +
						"instinct she begins to have strong, erotic feelings towards you and very quickly starts becoming visibly aroused. She stands up in the hottub pulling at her bikini top amlost removing it.</p>" + '<p>"' + perYou.getPersonName() + "\" Tracy exclaims. \"I can't believe it but I'm getting that feeling again, but this time it's not for Davy. It's for you. This isn't right! You are my little " + (perYou.isBornMale() ? "brother" : "sister and I'm not a lesbian") + '. I have to stop!"</p>' + "<p>Despite her words she removes her bikini top, sort of holding it in front of her but it also looks like she is pinching herself. As usual she is smiling.</p>");
					startQuestionsOnly();
					addLinkToPlaceC(md, "tell your sister not to worry", Place, "type=tracycharmpool2");
					WritePlaceFooter(md);
					return true
				}
				if (sType == "tracycharmpool2") {
					md = WritePlaceHeader();
					this.showPerson("tracy3-pool.jpg");
					addPlaceTitle(md, "Tracy Under a Charm Spell At The Pool");
					md.write('<p>"I have to <i>not</i> worry?" asks Tracy, confused by the emotions and lust overwhelming her mind.</p>' + "<p>\"I shouldn't worry about anything, should I? Especially when I feel so hot, so horny. You feel the same for me, don't you " +
						perYou.getPersonName() + '? Please say that you love me."</p>' + "<p>She is standing here, her pert breasts exposted and trim figure clear in her small bikini, or what remains of it. She is your sister, your beloved sister, but...</p>");
					startQuestionsOnly();
					addLinkToPlaceC(md, "reassure Tracy that you love her as her " + (perYou.isBornMale() ? "brother" : "sister"), Place, "type=tracycharmpool3");
					addLinkToPlaceC(md, "<b>tell</b> Tracy that you love her as a " + perYou.getManWoman(), Place, "type=tracycharmpool3incest");
					WritePlaceFooter(md);
					return true
				}
				if (sType == "tracycharmpool3" || sType == "tracycharmpool3incest") {
					md = WritePlaceHeader();
					sibling = perYou.isBornMale() ? "brother" : "sister";
					if (sType === "tracycharmpool3" && perYou.checkFlag(26)) {
						this.showPerson("tracy4a-pool.jpg");
						addPlaceTitle(md, "Your Sister Tracy Under a Desire Spell At The Pool");
						setPersonFlag("Mom", 25);
						md.write("<p>Your heart beats faster as you watch her strip further. Tenderly, you reach for her shoulders, intending to give " + "her the most meaningful hug of your lives but you remember she is your sister and back away.</p>" +
							'<p>"No, Tracy!" you tell her. "We are not going to... Do not desire me! I mean, you don\'t want me like that ' + 'anymore and everything is alright. Play with yourself and enjoy it"</p>' + '<p>"Whatever you say" replies your sister, absorbing the new orders like water into a sponge. ' + "&quot;I have such a considerate " + sibling + ".&quot; " + "Tracy no longer craves you and contentedly strokes herself.</p>" + "<p>A close call. It would be best is she returns home, away from you for now. Even if she is your sistter this has got you a little wound up and it is best she is not around to make it worse.</p>");
						startQuestionsOnly()
					} else {
						this.showPerson("tracy4b-pool.jpg");
						addPlaceTitle(md, "Tracy Under a Desire Spell At The Pool");
						this.charmThem(2);
						if (sType === "tracycharmhome3") md.write("<p>You try to tell Tracy to calm down and not desire you, but you can see your words have no effect on her, your ability to control the spell and her are limited. You have no choice, you have to instead take her as your lover.</p>");
						md.write("<p>Your heart beats faster as you watch her strip. Tenderly, you reach for her shoulders, intending to give " +
							"her the most meaningful hug of your lives fully aware she is your sister but you no longer care.</p>" + '<p>"Tracy, I love you" you tell her and then you kiss her, no ' + sibling + "ly kiss, but one as her lover!</p>" + '<p>"Nothing matters aside from our love as a ' + perYou.getManWoman() + ' and a woman"</p>' + '<p>"I love you too" replies your sister, absorbing the new orders like water into a sponge. ' + '"I do not care that you are my ' + sibling + ', I love you."</p>');
						startQuestionsOnly();
						addLinkToPlace(md, "make love to your sister here",
							Place, "type=tracypoolsex");
						addLinkToPlace(md, "go home with Tracy, to her bedroom", 122, "type=charm")
					}
					addLinkToPlace(md, "say goodbye to Tracy for now", 269);
					WritePlaceFooter(md);
					return true
				}
				if (sType == "recharm1") {
					clv = this.getCharmedLevel();
					if (clv != 1) this.charmThem(1);
					else this.charmThem(2);
					md = WritePlaceHeader();
					if (Place == 269) this.showPerson("tracy2-pool.jpg");
					else this.showPersonDN("tracy2.jpg");
					addPlaceTitle(md, "Tracy Under A Charm Spell - Again");
					md.write("<p>Once again you cast the spell on your sister. Immediately Tracy falls under the influence of desire. Against her basic " +
						"instinct she begins to have strong, erotic feelings towards you and very quickly starts becoming visibly aroused.</p>" + "<p>&quot;" + perYou.getPersonName() + "&quot; Tracy exclaims. &quot;I can't believe it but I'm getting " + "that feeling again, it's for you. This isn't right! You are my little ");
					if (perYou.isBornMale()) md.write("brother");
					else md.write("sister and I'm not a lesbian");
					md.write(". I have to stop!&quot;</p>");
					startQuestionsOnly();
					if (clv != 1) addLinkToPlace(md, "reassure Tracy that you love her as her " +
						(perYou.isBornMale() ? "brother" : "sister"), Place, "type=recharm2");
					if (clv != 2) addLinkToPlace(md, "<b>tell</b> Tracy that you love her as a " + perYou.getManWoman(), Place, "type=recharm2");
					WritePlaceFooter(md);
					return true
				}
				if (sType == "recharm2") {
					clv = this.getCharmedLevel();
					md = WritePlaceHeader();
					if (Place == 269) this.showPerson("tracy4a-pool.jpg");
					else this.showPersonDN("tracy4a.jpg");
					addPlaceTitle(md, "Tracy Under A Charm Spell - Again");
					sibling = perYou.isBornMale() ? "brother" : "sister";
					switch (this.getCharmedLevel()) {
						case 1:
							md.write("<p>Your heart beats faster as you watch her strip. " +
								"Tenderly, you reach for her shoulders, intending to give " + "her the most meaningful hug of your lives but you " + "remember she is your sister and back away.</p>" + "<p>&quot;No, Tracy!&quot; you order. &quot;We are not " + "going to... Do not desire me! I mean, you don't want me like that " + "anymore and everything is alright. Play with yourself and enjoy it&quot;</p>" + "<p>&quot;Whatever you say,&quot; replies your sister, " + "absorbing the new orders like water into a sponge. " + "&quot;I have such a considerate " +
								sibling + ".&quot; " + "Tracy no longer craves you and contentedly strokes herself.</p><p>A close call.</p>");
							break;
						case 2:
							md.write("<p>Your heart beats faster as you watch her strip. Tenderly, you reach for her shoulders, intending to give " + "her the most meaningful hug of your lives fully aware she is your sister but you no longer care.</p>" + "<p>&quot;Tracy, I love you&quot; you tell her and then you kiss her, no " + sibling + "ly kiss, but one as her lover!</p>" + "<p>&quot;Nothing matters aside from our love as a " +
								perYou.getManWoman() + " and a woman&quot;</p>" + "<p>&quot;I love you too&quot; replies your sister, absorbing the new orders like water into a sponge. " + "&quot;I do not care that you are my " + sibling + ", I love you.&quot;</p>");
							break
					}
					startQuestionsOnly();
					if (Place == 269) addLinkToPlaceC(md, "go home with Tracy", 45);
					else addLinkToPlaceC(md, "talk more to her", Place);
					WritePlaceFooter(md);
					return true
				}
			}
			return false
		};
	per.showPersonChat = function(bGeneral, md) {
		if (Place == 45 && this.checkFlag(6) && !this.checkFlag(9) &&
			this.place == 122) addLinkToPlaceC(md, "listen in on your sister's conversation", 122, "type=listendavy1");
		if (this.place != 1) return;
		if (this.other > 3 && this.other < 8 && this.isCharmed() && !this.isCharmedBy() && Place == 45) {
			addLinkToPlace(md, "go to the laundry", 156, "", "", "", "Leave45()");
			return
		}
		if ((Place == 45 || Place == 374) && this.isHere() && sType === "") {
			if (this.other == 1) addQuestionC(md, '"Hey Tracy, do you know where Davy is?"', "Tracy", 8901);
			else if (this.other == 2) addQuestionC(md, '"Is anything is going on, Tracy?"', "Tracy",
				8902);
			if (this.isCharmedBy("Davy") && getPersonCharm("Tina") >= 4)
				if (per.place != -1) addQuestionC(md, '"Hey Tracy, Davy said he wanted you to meet him at his house."', "Tracy", 8906);
			if (getBeasleyServant() == 8) addQuestionC(md, '"Can you help me find the meaning of <i>Dai Chu</i>?"', "Tracy", 1408);
			else if (getBeasleyServant() == 31) addQuestionC(md, '"Did Mr. Beasley say anything about mana when you spoke with him?"', "Tracy", 1431);
			if (this.isCharmedBy("You") && this.getCharmedLevel() == 2) addLinkToPlaceC(md, "'talk' to Tracy in her bedroom",
				122, "", "", "", "Leave45()");
			if (checkPersonFlag("Gabby", 16))
				if (!this.checkFlag(11))
					if (!isMurderPath()) addQuestionR(md, '"Did you know that Mom and Gabby were together?"', "\u201cShe never told me, but I had my suspicions. They make a cute couple though, do they? Mom really deserves to be with someone after the debacle with Dad...\u201d</p>" + "<p>\u201cOh, I wonder which one of them is on top. That seems like a point of contention with their personalities.\u201d", "Tracy", "setPersonFlag(\\'Tracy\\',11)");
					else addQuestionR(md, '"What do you think about Gabby being here?"', "\"She's been a lot more easy to get along with of late, and Mom deserves to have someone to be with after the debacle with Dad.\u201d</p>" + "<p>\u201cBut it's curious how Gabby occasionally slips and calls her Mistress, I have always pegged her as more of a dominant type.\u201d", "Tracy", "setPersonFlag(\\'Tracy\\',11)")
		}
	};
	per.showPersonTextHere = function(md) {
		if (Place == 176 && this.isHere()) md.write("<p>Tracy asks where Davy is. She evidently couldn't find him anywhere in the house.</p>");
		if (Place == 45 && this.place == 122 && this.checkFlag(6) && !this.checkFlag(9)) md.write("<p>You hear Tracy's voice from her bedroom, it sounds like she is talking to someone.</p>");
		if (this.place != 1) return;
		var clvT = this.getCharmedLevel();
		var sibling = "Sis";
		if (perYou.isBornMale()) sibling = "Bro";
		var perMadison = findPerson("Madison");
		if (this.isHere() && Place == 154) md.write("<p>Tracy is singing in the laundry.</p>");
		else if (this.whereNow() == Place && (Place == 45 || Place == 374))
			if (clvT > 0 && this.isCharmedBy("You"))
				if (getQueryParam("event") ===
					"tracysnack") md.write('<p>Tracy follows you into the kitchen to get some ice cream from the fridge, and asks you "Hey ' + sibling + ' want some?". The way she poses herself you know she does not mean ice cream.</p>');
				else if (clvT == 2) md.write("<p>Your sister and lover is happy to see you. No longer inhibited, she walks around the house without clothes.</p>");
		else md.write('<p>Your sister is pleased to see you. No longer inhibited, she walks around the house without clothes.<br><br>"Hi ' + perYou.getPersonName() +
			". You would not believe how much fun I have been having since you told me how to enjoy myself. Here's to you my beautiful sibling.\"<br><br>You smile at your sister and wonder whether you should take her like the rest of your harem. You choose not to do it yet. There are more important things to attend to.</p>");
		else if (getBeasleyServant() == 31) md.write("<p>You know that Tracy spoke to Mr. Beasley but you don't care. You have to get the book back and find out about magic.</p>");
		else if (!this.isCharmedBy("Davy"))
			if (!this.checkFlag(2)) {
				this.setFlag(2);
				setPersonFlag("Mom", 25);
				showPopupWindow("Tracy Freed", "<img src='Images/" + this.getImg(isDay() ? "tracy1c.jpg" : "tracy1a-night.jpg") + "' class='imgpopup' alt='Tracy'>" + 'Tracy greets you. "Oh thank god you are here," she says. "I can\'t believe what I have been through. I have such terrible memories of serving that loathsome boy Davy Robbins. He did all sorts of disgusting things to me."<br><br>' + "You study your sister. The spell seems to have been completely lifted from her.<br><br>" + 'Tracy continues "Look, I feel dirty, let me get a quick shower, when I get out let me make you a treat to thank you again." and she leaves to go to the bathroom.<br><br>' +
					"a little time passes....", "gotoPlace(45, 'type=snack1')")
			} else md.write("<p>Tracy greets you, she is happy to see you, she is grateful for you freeing her, but she will not talk any more about her experiences with Davy Robbins.</p>");
		else {
			if (this.other > 0 && this.other < 4) md.write("<p>Your sister Tracy's busy here. She's the older sibling by two years, which has led to some disputes in the past. Still, she keeps herself on the big-sister high ground.</p>")
		} else if (Place == 45 && this.whereNow() == 374) md.write("<p>You can see Tracy is in the living room watching TV.</p>");
		if (Place == 45 || this.isHere()) {
			if (perJesse.getDemonPath() == 60 && perJesse.place != 6) md.write('<p>"Hey ' + sibling + '," She says in your general direction.  "Mom wanted to see you about something."</p>');
			if (perMadison.checkFlag(1) && nFromPlace != 46 && !perMadison.checkFlag(2) && !perMadison.checkFlag(3)) {
				md.write('<p>"Hey ' + sibling + '," she calls, "You had a delivery, some prize from a contest, the delivery-girl put it in your room"</p>');
				perMadison.setFlag(2)
			}
			if (perMadison.checkFlag(1) && nFromPlace != 46 && !perMadison.checkFlag(2) &&
				!perMadison.checkFlag(3)) perMadison.setFlag(3);
			if (wherePerson("Miku") == 408 && !this.checkFlag(10)) {
				md.write('<p>"Hey ' + sibling + ", a cute girl from our school showed up and said you'll want to meet her. She's been pretty insistent, so mom let her stay in the attic guestroom and wait for you.\"</p>");
				this.setFlag(10)
			}
		}
	};
	per.handleItem = function(no, cmd) {
		if (no == 14 && cmd == 2) {
			if ((Place == 45 || Place == 374) && this.isHere()) {
				if (!this.isCharmedBy("Davy")) CastCharmSpell("Tracy", Place, 1, "type=tracycharmhome1", "", "type=recharm1");
				else addComments("You attempt to cast the spell, but if fails to take effect... Evidently your sister is already under the effects of a charm spell...  Someone <i>else's</i> spell.");
				return "handled"
			}
			if (Place == 156) {
				addComments("You attempt to cast the spell, but if fails to take effect... Evidently Tracy is already under the effects of a charm spell...  Someone <i>else's</i> spell.");
				return "handled"
			}
			if (sType == "tracypool") {
				if (!this.isCharmedBy("Davy")) CastCharmSpell("Tracy", Place, 1, "type=tracycharmpool1",
					"", "type=recharm1");
				else addComments("You attempt to cast the spell, but if fails to take effect... Evidently your sister is already under the effects of a charm spell...  Someone <i>else's</i> spell.");
				return "handled"
			}
		}
		return ""
	};
	per.isPhoneable = function() {
		return checkPlaceFlag("Hotel", 11) && Place == 269
	};
	per.callThem = function() {
		if (Place == 269)
			if (isCharmedBy("Davy")) WriteComments("You call Tracy to invite her to join you at the pool for a swim, but she says she is busy, maybe another time.");
			else {
				gotoPlace(Place,
					"type=tracypool");
				receiveCall("", 'You call Tracy to invite her to join you at the pool for a swim, and she immediately answers, "Sure, Little ' + this.getYourNameFor() + ', love to, see you in a bit!"');
				WriteCommentsFooter(bChat, bChatLeft)
			}
	};
	per.addPersonPhoneCall = function() {
		if (this.place == 1 && this.checkFlag(3)) {
			if (makeCall(true, 20)) this.setFlag(3, false)
		} else if (this.place == 1 && this.checkFlag(5))
			if (makeCall(true, 21)) this.setFlag(5, false);
		return false
	};
	per.getPersonSMS = function(id) {
		if (id == 20) return receiveSMS("Tracy",
			"Hey Lea, just about to shower, hope nobody is peeking. How was your last date?", "tracysms1-day.jpg") + receiveSMS("Tracy", "Naughty little " + this.getYourNameFor() + " I sent this to the wrong number, lol, have fun");
		if (id == 21) return receiveSMS("Tracy", "Hey little " + this.getYourNameFor() + " I heard you visited the Church recently. Like this old Halloween costume of mine?", "tracysms3.jpg");
		return ""
	}
}

function initialiseVampyre() {
	addPerson("Vampyre");
	per.getPersonName = function(full) {
		return "the vampyre"
	};
	per.isVampyre = function() {
		return true
	};
	per.extra = [0, 0];
	per.health = -1;
	per.getRespect = function() {
		return this.extra[1]
	};
	per.setRespect = function(no) {
		this.extra[1] = no
	};
	per.whereNow = function() {
		if (this.isCharmedBy("Sarah")) return !isDay() ? 192 : 0;
		if (isPossess() && this.place == -1) return perYou.place;
		return Place == 450 ? 38 : this.place
	};
	per.isMonstersInSacredClearing = function() {
		if (sType == "monster" || this.other >= 60 &&
			!isDay()) return true;
		return false
	};
	per.isPlaceImageRight = function() {
		if (Place != 372 && Place != 450 && sType === "" && this.isHere()) {
			SetRightColumnSize("");
			return true
		}
		return false
	};
	per.showPlaceImageRight = function(md) {
		this.showPerson("vamp5a.jpg", undefined, undefined, undefined, undefined, undefined, md);
		if (isPossess() || sPlaceParams !== "" || this.isCharmedBy("Sarah")) return;
		var p;
		var plc;
		var b = false;
		for (var i = 0; i < arPeople.length - 2; i++) {
			p = arPeople[i];
			if (p.uid == this.uid) continue;
			if (p.isDead() || p.isVampyre()) continue;
			plc = p.whereNow();
			if (p.isCharmedBy("You") && plc == Place && p.health > 0 && !p.isVampyre()) {
				if (!b) md.write('<div style="clear:both;">');
				addLinkToPlace(md, "feed on " + p.getPersonNameShort(), Place, "type=feedOn&by=" + this.uid + "&with=" + p.uid, "", "", "", "bloodblock", "width:90%;max-width:90%;position:relative;top:-0.5em;" + (b ? "margin-top:10px" : ""));
				b = true
			}
		}
		if (!b) {
			md.write('<div style="clear:both;">');
			addOptionLink(md, "talk to her", "gotoPlace(" + Place + ",'type=chatvampyre')", "chatblock", "width:90%;max-width:90%;position:relative;top:-0.5em")
		}
		md.write("</div>")
	};
	per.passTimeNight = function() {
		if (this.other == 51 || this.other == 60) this.other = 59;
		if (this.other == 50.5) this.other = 51;
		if (this.place == 247) {
			if (Place > 316 && Place < 339 || Place > 381 && Place < 386 || Place == 406) {
				this.place = 325;
				return ""
			}
			this.place = -1;
			if (Place != 247) return "<p>The vampyre rejoins you as night falls.</p>"
		}
		return ""
	};
	per.passTimeDay = function() {
		setPlaceFlag("SacredClearing", 2, false);
		if (this.place == -1) {
			this.place = 247;
			if (Place != 247) return "<p>The vampyre leaves you and returns to the crypt until night falls</p>"
		} else if (this.place ==
			325) this.place = 247;
		return ""
	};
	per.isPersonInfo = function() {
		return this.isCharmedBy()
	};
	per.getPersonInfo = function() {
		var s = "<img src='Images/vamp1b.jpg' style='width:30%;float:right;margin-left:5px' alt='Vampyre'>" + "She is a menacing predator that exudes sexuality as much as she is dangerous.<br><br>";
		if (this.sCharmedBy == "Sarah") return s + "She is bound body and soul to Sarah, to Sarah' discomfort.";
		else return s + "She is bound body and soul to you. At night she follows you at all times, except into holy places. In the daytime rests in the crypt."
	};
	per.enterChurch = function(plc, s) {
		var s;
		if (plc == 319) {
			this.moveThem(Place == 325 ? 325 : 247);
			s = this.showPerson("vamp10a.jpg", "20%", "left;margin-bottom:1em;margin-right:5px", "", "", undefined, "string", "none") + s + " the vampyre lets out an unearthly scream of pain and horror. In a blur of inhuman spped she leap and run over the cloisters and gets out of the church in a matter of seconds.";
			if (!this.checkFlag(8)) {
				s += "<br><br>You have heard the legends of vampires being repulsed by a holy cross, so it seems at least partly this is true.";
				this.setFlag(8)
			}
			return s
		}
		this.place = 325;
		s = '<p style="text-align:center"><b>Vampyre Stops</b></p><p>' + this.showPerson("vamp5b.jpg", "20%", "right;margin-bottom:1em", "", "", undefined, "string", "none") + s + ', the vampyre stops, and says,<br><br>"This place reeks of the holy, I can..will not enter. I will wait for you in the graveyard"';
		if (!this.checkFlag(8)) {
			this.setFlag(8);
			return s + "<br><br>You think it best to not to push and try to force her to follow you. After all, you have heard the legends of vampires being repulsed by a holy cross, so it seems at least partly this is true."
		}
		return s
	};
	per.feedOnEvent = function(ps) {
		var q = getQueryParam("ask");
		var md;
		var perF = findPerson(ps);
		var herName = perF.getPersonName();
		if (q == "create") {
			md = WritePlaceHeader(false, "", "black");
			this.setFlag(4);
			this.showPerson("vamp1b.jpg");
			addPlaceTitle(md, "Vampyre Questioning", "", 0, false, "white");
			md.write("<p>You ask about what she means by you creating new vampyres, and she looks at you, her expression an unreadble mask of cruelty,</p>" + '<p>"There are always ways for a ' + (perYou.isBornMale() ? "sorcerer" : "witch") + ' to do many things. you have enslaved the living and the dead. Demons have ways with the living and there are ways to transmigrate and borrow bodies.<br><br>Seek others of your kind if you do not understand, I am a predator, not a witch."</p>');
			startQuestionsOnly(undefined, "white", md)
		} else if (q == "heal") {
			md = WritePlaceHeader(false, "", "black");
			this.showPersonRandom("vamp8", 2, "height:max");
			addPlaceTitle(md, "The 'Gift of Life'", "", 0, false, "white");
			md.write("<p>The vampyre looks at " + herName + ' with some distaste and tells you, "I would never do this except for your request"</p>' + "<p>After expressing her distaste, the vampyre embraces " + herName + " and sinks her fangs into " + herName + "'s neck.</p>" + "<p>After a moment " + herName + "breathes deeply and looks up. The vampyre steps away and turns her back on " +
				herName + ". You look and " + herName + " looks completely healed, no sign of injury, tiredness or anything.</p>");
			this.health += 100 - perF.health;
			perF.health = 100;
			switch (perF.uid) {
				case "mrsgranger":
					if (wherePerson("OfficerKhan") == 278 && !isMurderPath()) {
						movePerson("OfficerKhan", 168);
						perF.place = 261;
						md.write("<p>The police guard looks confused but after a while and a checkup by the nurse she escorts " + herName + " off to jail.</p>")
					} else {
						md.write("<p>You tell " + herName + " to return home and you will see them there later. After they dress and leave after a longing glance at you, and a fearful glance at the vampyre.</p>");
						perF.place = 177
					}
					break;
				case "officerkhan":
					md.write("<p>You tell " + herName + " to return to the police station and you will see them there later. After they dress and leave after a longing glance at you, and a fearful glance at the vampyre.</p>");
					perF.place = 168;
					break;
				case "officersmith":
					md.write("<p>You tell " + herName + " to return to the police station and you will see them there later. After they dress and leave after a longing glance at you, and a fearful glance at the vampyre.</p>");
					perF.place = 261;
					perF.other =
						103;
					break
			}
			startQuestionsOnly(undefined, "white", md)
		} else if (perF.health < 100) {
			md = WritePlaceHeader(false, "", "black");
			this.showPerson("vamp8c.jpg");
			addPlaceTitle(md, "Vampyre and " + herName, "", 0, false, "white");
			if (perF.health <= 60) {
				if (!this.checkFlag(5)) {
					md.write("<p>The vampyre looks at " + herName + " and looks at you,</p>" + '<p>"Your thrall is badly injured and would not live through my feeding. It in unlikely they would rise after even if I was permitted to do that.<br><br>' + 'Did you value this thrall? If so I could give them the Gift of Life. Instead of taking I can give my own lifes blood to heal them. I need to have enough to feed them so I need to be satiated enough."</p>' +
						"<p>She looks at you with a cruel smile, you know what she means by being satiated.</p>");
					this.setFlag(5)
				}
				if (perF.health + -1 * (this.health + 1) >= 100) md.write("<p>The vampyre looks at " + herName + " and looks at you, waiting but saying nothing.</p>");
				else md.write("<p>The vampyre looks at " + herName + ', "I have not had enough"</p>');
				startQuestionsOnly(undefined, "white", md);
				if (perF.health + -1 * (this.health + 1) >= 100) addLinkToPlace(md, "ask the Vampyre to use the 'Gift of Life'", Place, "type=feedOnby=vampyre&ask=heal&with=" +
					perF.uid, "", "", "", "bloodblock")
			} else {
				if (!this.checkFlag(3)) {
					md.write("<p>The vampyre looks at " + herName + " and looks at you,</p>" + '<p>"I will not feed on this one again, I cannot choose to take their life and create a new vampyre thrall. You control my heart and body, only you can do this now."</p>' + "<p>You are not sure if you would even want that, after all it seems that " + herName + " would die. Then again, your vampyre slave is desirable and has as much free will and determination as " + herName + ". Trouble is, how would to do it, even if you wanted?</p>");
					this.setFlag(3)
				} else md.write("<p>The vampyre looks at " + herName + " and looks at you,</p>" + '<p>"I will not feed on this one again, Once again I cannot do this."</p>');
				startQuestionsOnly(undefined, "white", md);
				if (!this.checkFlag(4)) addLinkToPlace(md, "ask the Vampyre what she means by you creating vampyres", Place, "type=feedOn&by=vampyre&ask=create&with=" + perF.uid, "", "", "", "bloodblock")
			}
		} else {
			this.health -= 20;
			perF.health -= 20;
			if (this.health < -100) {
				md = WritePlaceHeader(false, "", "black");
				this.showPersonRandom("vamp10",
					3);
				addPlaceTitle(md, "Vampyre Feeding", "", 0, false, "white");
				md.write("<p>Once again the vampyre feeds, but this time as she finished she screams in ecstasy and drops " + herName + " to the ground unmoving, possibly dead. The vampyre looks at you triumphantly,</p>" + '<p>"Feeding is my unlife, the power of my soul. I am now sated and empowered. Now your petty spell can now longer control me, but it has some influence. Join me now in the darkness as a fellow vampyre and lover"</p>' + '<p>You start to tell her No! and she laughs, "You do not control me, and you have no choice now!"</p>' +
					"<p>With inhuman speed she puts her arms around you and sinks her fangs into your neck...</p>" + "<p>...sometime later, you revive as a vampyre and lover of your once slave. Nothing can stop the two of you using the Book, your magic and her savagery. Glenvale is yours to enslave, to feed on and satisfy all your lusts, or at least all <b>her</b> lusts, but they are yours now too.</p>");
				startQuestionsOnly(undefined, "white", md);
				addRestartLink(md);
				WritePlaceFooter(md, "", true, true);
				return
			} else {
				if (perF.fedUponEvent(this)) return;
				md = WritePlaceHeader(false, "", "black");
				this.showPersonRandom("vamp8", 2, "height:max");
				addPlaceTitle(md, "Vampyre Feedng on " + herName, "", 0, false, "white");
				md.write("<p>" + herName + " looks uncertainly, and you reassure them as the vampyre approaches with lust on her face. With no hesitation, she embraces " + herName + " and sinks her fangs into " + herName + "'s neck.</p>" + "<p>After a surprising short time, the vampyre looks up at you, still holding " + herName + ". Her face is still full of lust, but different. She steps away from " +
					herName + " who looks strange, a mixture of ecstasy and complete exhaustion, and they immediately sit down.</p>" + '<p>The vampyre looks at you, "My bloodlust has receded, but my other lusts are rising. Normally I would seduce my prey, but power is so much more arousing. Take me!"</p>');
				startQuestionsOnly(undefined, "white", md);
				addLinkToPlace(md, "satisfy her lust", Place, "type=vampfuck&with=" + perF.uid, "", "", "", "bloodblock")
			}
		}
		addOptionLink(md, "enough of that", "setQueryParams('');DoReturn()", "bloodblock");
		WritePlaceFooter(md, "", true, true)
	};
	per.showPersonTextHere = function(md) {
		if (Place != 372 && sType === "" && this.isHere() && isOutside()) addBackgroundImage("Images/vampbg.png", "80% 0%");
		if (Place == 192) {
			var perSarah = findPerson("Sarah");
			if (this.other == 50)
				if (perSarah.isCharmed()) {
					var myName = perSarah.getYourNameFor();
					md.write('<p>"' + myName + '..." She says, concern in her voice.  "You know that Magic is real ' + myName + ', but I am afraid vampires are as well."</p></p>When you do not rebuke her for her insolence she continues her story.  "Part of my families responsibility was to keep the <i>creature</i> within its crypt.  But to do so we must use the book.  If we do not..." A shiver visibly runs down her back. "I can not bear to think of it."</p>')
				} else {
					md.write('<p>"What?" She asks quickly.  "Magic is real, but vampires are just myths?"</p></p>"It is quite simple.  I must have the book by then or I am doomed, and potentially the town along with me."</p><p>"Please," She begs, "There is barely enough time to prepare as it is');
					if (isMurderPath()) md.write(" and the vampyre will know that Uncle Ronny is not here");
					md.write('. We are all in great danger!"')
				}
			else if (this.other == 51) {
				md.write("<p>The color suddenly fades from Sarah Gates' face as she watches the sun set below the horizon - taking her confidence and resolve along with. The howl of a wolf is heard from a distance.</p>" + "<p>This is a very scary experience, but you have promised to protect Sarah. Then again you could leave and wait at home and check back later.</p>");
				if (perSarah.FindItem(4) === 0) md.write("<p>Once again Sarah asks you for the Book.</p>")
			}
			if (this.isCharmedBy("Sarah") && !isDay()) {
				md.write("<p>The vampyre is looking at Sarah and completely ignoring you.</p>");
				return
			}
		}
		if (Place == 197 || Place == 198 || !this.isHere() || Place == 435) return;
		if (Place == 53)
			if (!this.checkFlag(2)) {
				this.setFlag(2);
				md.write('<p>You also notice the vampyre <b>does not reflect</b> in the mirrors as well, confirming the old legends. She notices you looking at the mirrors and smiles at you, a cruel smile, and says,<br>"The mirrors of the soul"<br>You ask her to explain and she smiles again, but says nothing.</p>')
			} else md.write("<p>The vampyre looks at you smiling, no reflection of her is visible in any of the mirrors.</p>");
		else if (Place == 325)
			if (this.place == 325) {
				this.place = -1;
				md.write("<p>You see the vampyre step out from behind a large tombstone, and silently she joins you.</p>")
			}
		if (isOutside() && this.place == -1 && isDay()) {
			this.place = 247;
			WriteComments("<p>The vampyre leaves you and returns to the crypt until night falls</p>")
		}
		if (Place == 26 && this.place == 247 && !isDay()) this.place = -1;
		if (isPossess() || sPlaceParams !== "") return;
		var s = "";
		var bLook = false;
		var p;
		var plc;
		for (var i = 0; i < arPeople.length - 2; i++) {
			p = arPeople[i];
			if (p.uid ==
				this.uid) continue;
			if (p.isDead() || p.isVampyre()) continue;
			plc = p.whereNow();
			if (plc == Place && p.place != -1) {
				if (bLook) s += ", " + p.getPersonNameShort();
				else {
					s += "<p>The vampyre looks intensely at " + p.getPersonNameShort();
					if (p.uid == "miku") s += ". Miku returns the vampyre gaze unflinching, never taking her eyes off her"
				}
				bLook = true
			}
		}
		if (bLook) md.write(s + ".</p>")
	};
	per.showEvent = function() {
		var md;
		if (sType == "chatvampyre") {
			md = WritePlaceHeader();
			this.showPerson("vamp5b.jpg");
			addPlaceTitle(md, "Chatting with the Vampyre");
			md.write("<p>You stop for a moment to talk to the vampyre.</p>");
			startQuestionsOnly();
			addQuestionR(md, '"I need to do something else, please leave me for now"', '"Of course ' + perYou.getMaster() + '"', "Vampyre", "movePerson(\\'Vampyre\\',247)", "");
			if (checkPlaceFlag("Hotel", 11) && Place == 269) addLinkToPlace(md, "ask if she would like to go for a swim", Place, "", 'She looks at you as if you are out of your mind, and then says "Not in water, and it would require a lot of people to fill this with blood". She turn her back on you dismissively');
			addLinkToPlace(md, "continue on", Place);
			WritePlaceFooter(md, "", true, true);
			return true
		}
		if (sType == "vampfuck") {
			var w = getQueryParam("with");
			var perWith = findPerson(w);
			md = WritePlaceHeader(false, isExplicit() && perYou.isMaleSex() ? "td-left-med" : "", "black");
			if (perYou.isMaleSex()) this.showPersonRorX("vamp9b.jpg");
			else this.showPersonRorX("vamp9g.jpg");
			addPlaceTitle(md, "Lust of the Vampyre", "", 0, false, "white");
			md.write("<p>Still dazed from the feeding, " + perWith.getPersonNameShort() + " watches in morbid fascination as Lilith pushes you to sit on the ground and straddles you, wasting no time to remove your top and pressing her lips against yours in a wild, hungry kiss.</p>" +
				"<p>Her skin touches yours, flawless, wonderfully silken to the touch, and yet strangely cold. She has no heartbeat or breath but feels very much alive, her mere presence intoxicating to you as her tongue passionately mingles with your own. You quickly feel yourself getting swept away by the moment until she suddenly pushes your shoulders roughly to the ground and her lips come to rest on your neck. You realize her fangs are briefly scraping over your skin, forcing a weirdly pleasant shiver to rush through your entire body, and a strange part of you is almost disappointed as she recoils with a frustrated hiss.</p>" +
				"<p>\u201cYou did not actually expect that to work?\u201d You ask, with maybe a little more worry in your voice than you had intended, and she gives you a wide predatory grin as she pulls off your pants. \u201cNo, not today, " + perYou.getMaster() + ".\u201d</p>" + "<p>Before you are able to speak further, her teeth briefly dig into your inner thigh. She doesn't draw blood, but there is a brief rush of pain followed by a wave of intense euphoria washing through your entire body as " + (perYou.isMaleSex() ?
					"her long fingers reach for your rockhard cock and guide it into her pussy." : "her sharp fingernails carefully slide over your folds and legs before she presses her own pussy forcefully against yours.") + "</p>" + "<p>Suffice to say, she does not feel cold everywhere. The two of you engage in a rough, passionate act of animistic sexuality, almost more of a sexual struggle who will be on top in the end, while " + perWith.getPersonNameShort() + " begins to slowly pleasure herself, her eyes still drowsy as she stares at the surreal scenario before her.</p>");
			startQuestionsOnly(undefined, "white", md);
			addOptionLink(md, "enough of that", "setQueryParams('');DoReturn()", "bloodblock");
			WritePlaceFooter(md, "", true, true);
			return true
		}
		if (sType == "feedOn" && getQueryParam("by") == this.uid) {
			this.feedOnEvent(getQueryParam("with"));
			return true
		}
		if (Place == 141 && this.isMonstersInSacredClearing() && sType === "" && !checkPlaceFlag("SacredClearing", 2)) {
			var bGuarded = isConspiracyPath() && this.isCharmedBy("Sarah") || this.isCharmedBy("You") && this.isHere();
			if (bGuarded) {
				if (this.isCharmedBy("Sarah")) {
					md =
						WritePlaceHeader(true, "", "black");
					if (this.checkFlag(9)) showPopupWindow("<i>Too Thin</i> Sacred Clearing", "<img src='Images/vamp11a.jpg' style='position:absolute;width:100%;bottom:0;right:0' alt='Vampyre'>" + '<p style="position:absolute;left:5%;top:10%;cursor:pointer;font-size:1.1em;width:55%">' + "You see movement in the darkness, and there is a blur of red as the vampyre appears from the darkness. There is an explosion of blood and gore and you see the vampyre covered in blood, she looks at you and laughs and disappears into the darkness.<br><br>" +
						"Nothing whatsoever is left of who or what she attacked.", "dispPlace()", "left:5%;width:85%");
					else showPopupWindow("<i>Too Thin</i> Sacred Clearing", "<img src='Images/vamp11a.jpg' style='position:absolute;width:100%;bottom:0;right:0;margin-left:5px' alt='Vampyre'>" + '<p style="position:absolute;left:5%;top:10%;cursor:pointer;font-size:1.1em;width:55%">' + "The Sacred Clearing feels different to you, oppressive and chill. You think you can hear something moving in the darkness, and a figure rapidly approaches, a thing of decayed flesh and bones, an animated corpse of some horrible nightmare.<br><br>" +
						"It reaches for you with inhuman speed but as it does another figure appears, their arm stretches out and grabs the thing by the back of it's neck and it halts unable to move. It flails around trying to claw at it's captor, but the other figure continues to restrain it with easy. You hear the figure speak to you with contempt in <i>her</i> voice,.<br><br>" + '"My Mistress has commanded that I am to protect you from the wanderers. Why I do not understand, a weakling that needs protection from these deserves death". You recognise the voice, it is the vampyre and you see her more clearly, looking terrible and beautiful and with a complete look of disgust on her face..<br><br>' +
						'"My Mistress also told me to tell you, the walls of the veil and the gate are thin here in this place and they can cross into this land during the nighttime hours.".<br><br>' + "With that said she makes a casual gesture and you hear a sickening crack as the creature she is restraining is flung to one side, it's neck snapped. She then pounces on the body and there is a loud sound of wet tearing and a splattering of something. You step back, and a little while later the vampyre moves towards you, covered in blood, looking more a monster than the thing that tried to attack you. Almost with glee in her voice she says,.<br><br>" +
						'"I will feed on you, and kill you and rend your flesh. My Mistress will forget or give an order that is badly worded. Your pitiful life will be gone in a moment". She laughs and retreats into the darkness, but you know she is still there.....<br><br>', 'setPersonFlag("Vampyre",9);dispPlace()', "left:5%;width:85%")
				} else if (this.place == -1) {
					md = WritePlaceHeader(true, "", "black");
					if (this.checkFlag(9)) showPopupWindow("<i>Too Thin</i> Sacred Clearing", "<img src='Images/vamp11a.jpg' style='position:absolute;width:100%;bottom:0;right:0;margin-left:5px' alt='Vampyre'>" +
						'<p style="position:absolute;left:5%;top:10%;cursor:pointer;font-size:1.1em;width:55%">' + "You see movement in the darkness, and the vampyre moves to position herself between you and whatever it is. The movement stops as if to retreat.<br><br>" + "With inhuman speed the vampyre moves, and there is an explosion of blood and gore and you see her standing covered in the blood of whatever that was. She looks at you with a cruel smile, and the blood coating her fades away and she redresses.<br><br>" + "She resumes her place at your side,<br><br>smiling but there is no mirth in that expression",
						"dispPlace()", "left:5%;width:85%");
					else showPopupWindow("<i>Too Thin</i> Sacred Clearing", "<img src='Images/vamp11a.jpg' style='position:absolute;width:100%;bottom:0;right:0;margin-left:5px' alt='Vampyre'>" + '<p style="position:absolute;left:5%;top:10%;cursor:pointer;font-size:1.1em;width:55%">' + "You see movement in the darkness, and the vampyre moves to position herself between you and whatever it is. The movement stops as if to retreat.<br><br>" + 'The vampyre tells you, "A thing from beyond the veil, charged with the power of this place. It would kill you in an instant"<br><br>' +
						"With inhuman speed the vampyre moves, and there is an explosion of blood and gore and you see her standing covered in the blood of whatever that was. She looks at you with a cruel smile, and the blood coating her fades away and she redresses.<br><br>" + 'She resumes her place at your side, smiling as she says,<br><br>"Your life is in my hands"', 'setPersonFlag("Vampyre",9);dispPlace()', "left:5%;width:85%")
				} else return false;
				setPlaceFlag("SacredClearing", 2);
				WritePlaceFooter(md, "", true, true);
				return true
			}
			return false
		}
		if (Place ==
			192 && sType == "freedvampyre") {
			md = WritePlaceHeader();
			perYou.health = 0;
			this.showPerson("vamp3c.jpg");
			addPlaceTitle(md, "Vampyre Freed");
			md.write("<p>The vampyre screams as you free her, and she leaps on you with inhuman speed. All goes dark...</p>" + "<p>...briefly you awaken to see the vampyre and Sarah embracing as they are standing over Bambi's body. There are fang marks on Sarah's neck and blood is flowing into her mouth from the vampyre.</p>" + "<p>They notice you are awake, and there is a blur as the vampyre attacks, killing you in an instant...</p>" +
				"<p>That would seem to be it, darkness falls over your eyes and over Glenvale as a plague of vampyres descend. You were just too slow in binding the vampyre.</p>");
			startQuestions();
			addRestartLink(md);
			WritePlaceFooter(md);
			return true
		}
		if (Place == 247 && sType == "bound") {
			md = WritePlaceHeader(false, "", "black");
			this.showPerson("vamp1b.jpg", "height:max");
			this.moveThem(-1);
			this.charmThem(4);
			this.other = 100;
			setPersonOther("Sarah", 116);
			addPlaceTitle(md, "Vampyre Bound", "", 0, false, "white");
			md.write("<p>You start to recite the spell Sarah taught you, and the vampyre screams and collapses onto the floor crying out in pain or ecstasy and you finish the spell.</p>" +
				"<p>The Vampyre stands with inhuman grace, and she partially removes her clothing, leaving a hood in place to cover most of her face. She has a beautiful, if pale body, and black hair, but her hair had odd qualities, and can appear reddish at times.</p>" + "<p>She stands and looks intensely at you, and speaks, her voice sensual but with a dangerous quality,<br>" + '<p>"' + perYou.getMaster() + ", that was the spell of Necromancy the charm of 'Bind the Dead', or 'Unlife Enspelled'. It has made me your thrall, in body and heart. I will do anything you command, my mind is my own but I still must obey and love you.\"</p>" +
				'<p>You ask her what her name is, and she replies, "That I will never tell you, no spell will compel me to reveal that ultimate truth. You may call me Lilith for the woman from legend."</p>' + '<p>You ask the vampyre where she came from, and she replies, "' + perYou.getMaster() + ', I am yours to command, let us return to the witch-girl before, I will kill them, and you can make them a loyal thrall. <b>You</b> may command me to do anything, except answer questions."</p>' + '<p>She continues, "I am yours, I will follow you to the grave, but in the daytime I must rest here."</p>' +
				'<p>She looks at you closely, "' + perYou.getMaster() + ', the ways are opening, the <i>thin</i> places will be very dangerous, and those of power, do not venture there without me, then again, I will never leave your side..."</p>');
			startQuestions();
			addLinkToPlace(md, "examine the coffin", 248);
			addLinkToPlace(md, "exit the crypt?", 26);
			WritePlaceFooter(md, "", false, true);
			return true
		}
		if (Place == 247 && this.other == 60 && sType === "") {
			md = WritePlaceHeader(false, "td-left-large", "black");
			if (perYourBody.FindItem(46) !== 0 ||
				perYourBody.FindItem(44) !== 0) {
				this.showPerson("vamp4a.jpg");
				addPlaceTitle(md, "Vampyre At Bay", "", 0, false, "white");
				md.write("<p>As you enter the crypt a black shadow leaps at you, the female vampyre. Again she recoils at the last moment, unable to quite approach you. She desperately struggles to approach and kill you!</p>");
				startQuestions();
				addLinkToPlaceC(md, "flee the crypt?", 26, "", "", "", "setPersonOther('Vampyre', 1000);");
				WritePlaceFooter(md);
				return true
			} else {
				this.showPerson("vamp2.jpg");
				addPlaceTitle(md,
					"Vampyre Attacks", "", 0, false, "white");
				md.write("<p>You enter the dark crypt and a black shadow leaps at you, a female with bared fangs, the vampyre! She pounces on your throat!</p>" + "<p>Your life drains away, you did not have any <b>defenses</b> against the vampyre, you were an easy prey for the vampyre.</p>" + '<p style="text-align:center"><b>This is the end, there is nothing left for you, you can only try again.</p>');
				startQuestions();
				addRestartLink(md)
			}
			WritePlaceFooter(md);
			return true
		}
		if (Place ==
			192 && this.other == 59) {
			passTimeNight();
			md = WritePlaceHeader(false, "", "black");
			ClearComments();
			if (nFromPlace != 192) {
				this.showPerson("vamp3a.jpg");
				addPlaceTitle(md, "Vampyres", "", 0, false, "white");
				md.write("<p>You return to Sarah, and you see she is looking rather different, and a woman you have never seen is embracing her. Before you can do anything, they both pounce on you, biting your throat and draining your life away.</p>" + "<p>As are about to close your eyes for the last time you cannot help but regret leaving Sarah on her own...</p>" +
					'<p style="text-align:center"><b>This is the end, there is nothing left for you, you can only try again.</p>')
			} else {
				this.showPerson("vamp10a.jpg");
				addPlaceTitle(md, "Prepared Vampyre", "", 0, false, "white");
				md.write("<p>You notice night has fallen, and you think about where is the vampyre, and you see a blur of movement. Sarah cries out as she crumples to the ground. For a moment you see the vampyre looking at you, the personification of power and fury.</p>" + "<p>You are confident of your defences and spells to protect you, but before you can utter a word of a spell she rushes you. Any defences you have she ignores, she must of prepared herself and is it now night when she is trongest. You collapse as she strikes and the last thing you see is he fangs as she goes to sink her teeth into your neck. If only you had sought her out when she was weaker...</p>" +
					'<p style="text-align:center"><b>This is the end, there is nothing left for you, you can only try again.</p>')
			}
			startQuestions();
			addOptionLink(md, "Restart Game", "DoRestart()");
			WritePlaceFooter(md);
			return true
		}
		return false
	};
	per.showEventPopup = function() {
		if (Place == 450 && nFromPlace == 38 && this.place == -1) addComments('<p style="margin-top: 0em; margin-bottom: 0.5em;font-size:large;cursor: pointer;"><b>Vampyre</b></p>\u201cThis place... I will not be able to get past its threshold.\u201d Lilith seems annoyed.</p><p>\u201cI shall wait outside, do not take too long, ' +
			perYou.getMaster() + '"');
		if (Place != 161) return false;
		if (this.isHere() && wherePerson("Jessica") == 161 && sType === "") {
			if (!this.checkFlag(7)) {
				var perJessica = findPerson("Jessica");
				var bWitchSlave = perJessica.getRivalry() == -1;
				showPopupWindow("Vampyre and Jessica", this.showPersonString("vamp5c.jpg", "height:80vh", "right") + "The vampyre looks at Jessica, helplessly bound and you see a smile form on her lips, and she stalks towards the helpless witch. As she does you see her lips develop a green colouration and her hood falls away revealing her beautiful face.<br><br>" +
					(!bWitchSlave ? "If you do not stop her you can say goodbye to any sort of good relationship with Jessica and you might as well keep her as your personal witch slave!" : "Well Jessica is your slave so there seems little harm, but the vampyre is acting oddly.") + "<br><br>" + "You only have a moment to react, what do you do?<br>" + addOptionLink("string", "allow the vampyre to feed on Jessica", isMurderPath() ? "setPersonFlag('Vampyre',7);gotoPlace(161,'type=nostopvamp')" : "setPersonFlag('Vampyre',7);per.feedOnEvent('Jessica')",
						"bloodblock") + addOptionLink("string", "ask the vampyre to stop", "setPersonFlag('Vampyre',7);gotoPlace(161,'type=stopvamp')", "bloodblock") + addOptionLink("string", 'stand between them, "No"', "setPersonFlag('Vampyre',7);gotoPlace(161,'type=stopvamp')", "bloodblock"), "", "", true, true, true);
				return true
			}
		} else if (sType === "stopvamp") {
			showPopupWindow("Vampyre Obeys", this.showPerson("vamp5b.jpg", "40%", "right", "", "", undefined, "string") + "The vampyre stops, her complexion returns to normal, her lips blood-red as always.<br><br>" +
				'"Yes, ' + perYou.getMaster() + ', but a witch! Their blood is like a drug, the ultimate pleasure, aside from being in your service of course."<br><br>' + 'You mention how her lips changed colour and she smiles, "I could taste the last witch I drained, their blood glows green to those with the sight. I can still taste her dying ecstasy as I drank the last of her...", she makes a guttural sound of pleasure."');
			return true
		} else if (sType === "nostopvamp") {
			showPopupWindow("Vampyre Feeds", this.showPerson("vamp5b.jpg",
				"40%", "right", "", "", undefined, "string") + "The vampyre stops, her complexion returns to normal, her lips blood-red as always.<br><br>" + '"Yes, ' + perYou.getMaster() + ', but a witch! Their blood is like a drug, the ultimate pleasure, aside from being in your service of course."<br><br>' + 'You mention how her lips changed colour and she smiles, "I could taste the last witch I drained, their blood glows green to those with the sight. I can still taste her dying ecstasy as I drank the last of her...", she makes a guttural sound of pleasure."');
			return true
		}
		return false
	};
	per.showPersonChat = function(bGeneral, md) {
		if (Place == 192 && perYou.health !== 0 && sType === "") {
			var perS = findPerson("Sarah");
			if ((perS.other == 10 || perS.other > 114 || perS.other > 50 && perS.other < 100) && this.other === 0 && isDemonFreed()) addQuestionC(md, '"Why do you keep looking out the window?"', "Sarah", 2910);
			if (this.other == 1) addQuestionC(md, '"What is out there?"', "Sarah", 1301);
			else if (this.other == 50) {
				startAlternatives(md);
				addQuestionC(md, "\"Don't worry, I'll help you stop the vampyre, Sarah.\"",
					"Sarah", 1350);
				addQuestionC(md, '"Do we have any time?"', "Sarah", 1351);
				endAlternatives(md)
			} else if (this.other == 51) {
				var msg = isConspiracyPath() ? "protect Sarah" : "wait for darkness";
				if (perS.FindItem(4) > 0)
					if (perYourBody.FindItem(46) === 0 && perYourBody.FindItem(44) === 0 && !this.checkFlag(11)) addLinkToPlaceO(md, msg, 198);
					else addLinkToPlaceO(md, msg, 197);
				else addLinkToPlaceO(md, msg, 198)
			} else if (this.other >= 60 && !isConspiracyPath())
				if (!isDay()) addLinkToPlaceO(md, "wait for daytime", "", "", "", "", "WaitforForDayNight()");
				else if (this.isCharmedBy("Sarah") && !perS.checkFlag(2) && this.hoursCharmed("Sarah") > 36) addOptionLink(md, "wait for darkness", "WaitforForDayNight('',299,'wait=true')");
			else addOptionLink(md, "wait for darkness", "WaitforForDayNight()");
			if ((this.other == 100 || this.other == 60) && !isSpellKnown("Unlife Enspelled"))
				if (perYourBody.FindItem(4) > 0) addLinkToPlaceO(md, "try to learn the spell", 297, "", "I see no reason not to, here let me help you look it up", "Sarah");
				else addQuestionR(md, "try to learn the spell", "<p>You don&rsquo;t have the spellbook. You need the spellbook to make any progress in your research.</p>",
					"", "", "", "", "optionblock");
			if (this.isCharmedBy("Sarah") && perS.checkFlag(2) && perYourBody.FindItem(32) > 0) addLinkToPlaceC(md, '"I can deal with the Vampyre"', 299)
		}
		if (this.isCharmedBy("Sarah") || !this.isHere()) return;
		if (Place == 450) {
			var perLeanne = findPerson("Leanne");
			var bThrall = perLeanne.isCharmedBy("Demon");
			if (perLeanne.place == 450 && bThrall && !isDemonGone()) addLinkToPlaceC(md, 'tell the vampyre "Bring the thrall"', 53, "type=vampabduct")
		}
		if (Place == 453 && sType.indexOf("gabbyhousestudy") != -1 && sType != "gabbyhousestudy10" &&
			sType != "gabbyhousestudy1") addLinkToPlaceC(md, "order Lilith to help you", 452, "type=vamphelpgabby");
		if (!checkPersonFlag("Miku", 28) && checkPersonFlag("Miku", 26) && this.isHere()) addQuestionR(md, "ask Lilith what she meant by \u201cmalkblood\u201d", "\u201cYour...\u201d She spits the next word out in distaste. \u201c...familiar's blood bears the stench of the Malkin.\u201d</p>" + "<p>\u201cThey are dangerous hunters, devious, cunning, able to steal the souls of their kills.\u201d She lovers her eyes. \u201cBut of course, the one you keep is but a pale shadow of what its ancestor must have been like, and her fickle nature will be more of a liability to you in the long run.\u201d",
			"Vampyre", "bChatLeft=false;setPersonFlag(\\'Miku\\',28)")
	};
	per.handleItem = function(no, cmd) {
		if (no == 32) {
			var eNow = this.whereNow();
			if (cmd == 1) {
				if (Place == 192 && eNow === 192 && this.isCharmedBy("Sarah") || Place == 299 && eNow === 192 && this.isCharmedBy("Sarah")) {
					examineSilverRingStart();
					addComments("<p>It seems to be reacting to the Vampyre's presence... getting warmer the closer you get.</p>" + "</td></tr></table>");
					return "handled"
				}
			} else if (cmd == 2)
				if (Place == 192 && this.isCharmedBy("Sarah")) {
					dispPlace(192, "type=freedvampyre");
					return "nofooter"
				} else if (Place == 299 && this.isCharmedBy("Sarah"))
				if (sType == "bound") {
					this.unCharmThem();
					AddMana(5);
					dispPlace(299, "type=boundfree");
					return "nofooter"
				} else {
					dispPlace(299, "type=free2");
					return "nofooter"
				}
		} else if (no == 10 && cmd == 2)
			if (Place == 192 && this.whereNow() == 192 && this.isCharmedBy()) {
				addComments("<p>The Vampyre is already bound to " + findPerson("Vampyre").sCharmedBy + ".</p>");
				return "handled"
			} else if (Place == 247 && this.other == 60 && !this.isCharmedBy("You")) {
			CastUnlifeEnspelledSpell(247, "type=bound");
			return "nofooter"
		} else if (Place == 299)
			if (!this.isCharmed()) {
				CastUnlifeEnspelledSpell(299, "type=yours");
				return "nofooter"
			} else if (this.isCharmed()) {
			addComments("<p>The Vampyre is already bound to " + findPerson("Vampyre").sCharmedBy + ".</p>");
			return "handled"
		}
		return ""
	}
}

function RepliesVictoria(nR) {
	var bCharm = per.isCharmedBy();
	var myName = per.getYourNameFor();
	var perVictoria = per;
	var perBeasley = findPerson("Mr Beasley");
	if (nR == 1) {
		addComments('<p>"Let me see it ' + myName + '.  Hmm..very nice and quite old but I do not recognise it at all."</p>');
		setPersonFlag("Pamela", 10)
	} else if (nR == 2) {
		addComments("<p>\"Ah! It is one of those items, my 'father' was looking for one for a long time, but he never told me why, aside from it being a perfect defence. Against what and how I do not really know.</p><p>Interestingly the owner of the New Age Shop visited recently and asked about such an item, and offered <i>anything</i> I wanted if I could locate one of these items for her</p>");
		setPersonFlag("Pamela", 10);
		setPersonFlag("Pamela", 11)
	} else if (nR == 192) {
		if (isConspiracyPath()) {
			addComments('<p>"Magic Stones?, I just had a young woman sell me something that may be what you are asking about". You ask about the woman, but all Victoria can remember is that she was a waitress or maid. She gets out an odd little stone and shows it to you,</p>' + '<p>"I have heard of things like these, they are found around the place, possibly relics of the early days of Glenvale. Still they have no value and I do not consider them antiques. I have seen them for sale in one of the other shops, some people liked them as a novelty item. Here you may have it for ' +
				sCurrency + '10"</p>');
			if (nMoney < 10)
				if (nMoney <= 0) addComments('<p>You regretfully tell her you have no money and she smiles, and gives the stone to you, "As I said it has no real value to me, so you may have it. Come back sometime if you work out some interesting things about it."</p>');
				else addComments('<p>You regretfully tell her you do not have enough money and she smiles, and gives the stone to you, "As I said it has no real value to me, so you may have it. Come back sometime if you work out some interesting things about it."</p>');
			else {
				AddCash(-10);
				addComments('<p>You hand her the money and she smiles, and gives the stone to you, "Come back sometime if you work out some interesting things about it."</p>')
			}
			perYourBody.PutItem(5);
			if (perBeasley.other < 3) {
				perBeasley.other = 3;
				perYou.completeQuest(1);
				setPlaceKnown("WildRanges");
				setPlaceKnown("Park");
				PlaceI(5, 26);
				addComments('<p>As you turn to leave Victoria calls after you, "The young woman did mention that she found this in the <b>Wild Ranges</b>, you know that place north of the Glenvale Park."</p>')
			}
		} else addComments('<p>"Magic Stones?", she asks, and you describe the stones as ' +
			(isMurderPath() ? "Mr. Beasley" : perGates.getPersonNameShort()) + " told you. Victoria replies,</p>" + '<p>"I have heard of things like that, they are found around the place, possibly relics of the early days of Glenvale. Still they have no value and I do not consider them an antique. I think I once saw them for sale in one of the other shops, some people liked them as a novelty item. Sorry ' + myName + ' I do not have any here"</p>');
		perVictoria.setFlag(4)
	}
	if (nR == 200) {
		addComments('<p>"Let me see it ' + myName +
			".  Quite an interesting ring, it has quite an ancient design, but hard to date, in the style of the mythical 'Ring of Arae', the ring of the furies of curses that is said to invoke and lift curses or other enchantments.\"</p>");
		perVictoria.setFlag(33)
	} else if (nR == 700) {
		addComments("You ask Victoria if she knows about any items or books that may talk about how to free someone from being enslaved by a demon,</p>" + '<p>"Yes, ' + myName + ", I once heard a ballad, a fairy story, that told of a man stolen by a demon and how his sister went to great lengths to save him. In the end she had to use a powerful relic, a piece of a dragon, that allowed her to perform a ritual at a fairy mound. The ballad does not end well, the demon had to be present and while the man was saved, the demon required the sister to surrender and she was taken away. So the brother was won and the sister lost.</p>" +
			'<p>I would guess the part of dragon spoke of is the legendary "Dragon\'s Eye Gem" but I do not know where this may be, if it ever existed."');
		setPersonFlag("Leanne", 10)
	} else if (nR == 701) {
		addComments("You ask Victoria if she knows about an artifact called 'The Mirror of Souls',</p>" + '<p>"Yes, ' + myName + ', it is supposed to be a mirror that shows a persons true nature. I once heard my <i>father</i> mention it watches over a dragon in a hidden place here in Glenvale."</p>');
		perVictoria.setFlag(9)
	} else if (nR ==
		1851) {
		perVictoria.setFlag(1);
		if (!bCharm) addComments('<p>"Catholic Relic? Around here?" She says evasively. "Well, the convent just outside of town has been around for some time, but I don\'t know of any specific artifact, no."</p>');
		else addComments('<p>"A Catholic Relic, ' + myName + "?  I remember my past master mentioning something about an ancient relic but that was before I moved here.  I'm sorry, " + myName + '.  I wish I could tell you more."</p>')
	} else if (nR == 1852) {
		perVictoria.setFlag(1);
		perVictoria.setFlag(2);
		if (!bCharm) addComments('<p>"What\'s this?" She asks, inspecting the relic.  "Very interesting." She says, immediately pulling out a large book and leafing through it.  "Said to have power of demons if properly prepared.  Fascinating. Where did you find this?" She asks, eyeing you suspiciously.</p>');
		else {
			addComments('<p>"Give me a moment, ' + myName + '." She says, immediately opening a large tome.  "According to this the relic has <i>power over demons</i>, but it does not say any more than this.  Not being magical myself I am afraid I will be of little more help.  I am sorry, ' +
				myName + '. Perhaps you should seek the council of someone more... magically inclined.  Perhaps the psychic in town," She suggests.  "If, that is, she is actually a psychic."</p>');
			if (!isPlaceKnown("NewAgeStore")) setPlaceKnown("NewAgeStore")
		}
	} else if (nR == 14501) {
		perVictoria.setFlag(3);
		if (!bCharm) addComments('<p>"I\'m sorry?" She asks.  "Do you think I carry such fantastical items?  Now, if you are interested in an antique chair I <i>may</i> be able to help you." She says.  You get the <b>distinct</b> impression that she is lying to you.</p>');
		else {
			if (perYou.getQuestAftane() === 0) perYou.setQuestAftane(1);
			addComments('<p>"Give me a moment, ' + myName + '." She says looking through some of her notes. "My father made some mention of such an Artifact, but once he discovered it was guarded by the Gates Family, ');
			if (perYourBody.FindItem(41) > 0) addComments('" She says, suddenly stopping as her eyes settle on the aftane around your neck.  "And it would seem you have already found it, ' + myName + '."');
			else addComments(' he stopped trying to get it.  Perhaps you should try there."</p>')
		}
	} else if (nR ==
		800) {
		addComments('"Correct, ' + perYou.getMaster() + ', ever since my enslavement to you I have always wanted to ask you this question\u2026but I was too afraid, I did not want to disturb you with my needs."');
		perVictoria.setFlag(10)
	} else if (nR == 801) {
		addComments('"I am a submissive girl by nature. And I felt something very powerful in you\u2026some kind of essence that is drawing me to you and I cannot and do not want to resist it. This unexplainable force that we have talked about."');
		perVictoria.setFlag(11)
	} else if (nR ==
		802) {
		addComments('"I will be always ready to help you. I am going to send you infos from my phone, alert you if anything mentionable happens, check on the other slaves while you are gone, take care of your legal documents and administrate anything you need\u2026"');
		perVictoria.setFlag(12)
	} else if (nR == 803) {
		addComments('"More than that ' + perYou.getPersonName() + '. I would like to take care of your emotional needs. If you ever feel the need to come by to talk to me, just do it. I am all ears and open to you anytime. Consider me your steady supporter who\u2019s there for you any way possible."');
		perVictoria.setFlag(13)
	} else if (nR == 804) {
		addComments('"Of course! I am here if you need me ' + perYou.getMaster() + '!"');
		perVictoria.setFlag(14)
	} else if (nR == 2718) {
		addComments("<p><b>Buying the Papers</b></p>");
		if (perYourBody.NoItems == perYourBody.MaxItems) addComments("<p>You don't have enough room to carry any more items.  Make room and try again.</p>");
		else if (nMoney > 50 && perYourBody.FindItem(26) === 0 || bCharm) {
			if (bCharm) addComments("You ask to but the papers, but Victoria refuses and gives them to you as a gift.");
			else {
				addComments("You put the papers into your bag and pay " + sCurrency + "50.");
				AddCash(-50)
			}
			perVictoria.setFlag(36);
			perYourBody.PutItem(26);
			perKurndorf.setQuestSeance(19)
		} else if (nMoney < 50) addComments("You do not have enough money. The papers cost " + sCurrency + "50.")
	}
	return true
}

function initialiseVictoria() {
	addPerson("Victoria", 348);
	per.Replies = RepliesVictoria;
	per.getPersonName = function(full) {
		if (full === true) return this.name;
		return this.isCharmedBy() ? "Slave Victoria" : "Victoria, " + (isBritish() ? "Shop Assistant" : "Store Clerk")
	};
	per.isPersonInfo = function() {
		return true
	};
	per.getPersonInfo = function() {
		var s = "<p><img src='Images/" + (this.isCharmedBy() ? "victoria2" : "victoria0") + ".jpg' style='width:37%;float:right;margin-left:5px' alt='Victoria'>";
		if (this.isCharmedBy()) {
			var clv = this.getCharmedLevel();
			if (clv == 2) return s + "Victoria, your loyal and trusted servant bows her head whenever you meet her. She\u2019s been most helpful both emotionally and socially.<br><br>Still, it takes her time to adjust to you, she often asks you about how your day went or any special needs you want. She\u2019s still in the cognition part of your relationship with her. Victoria works hard to explore what you like and what you don\u2019t, but sometimes she does things without any instructions or order from you and these moments and actions shows that in time she will know what to do just by looking at her " +
				perYou.getMaster() + ".<br><br>So she\u2019s on the right path to fully know you!";
			return s + "Victoria told you her story when you enslaved her. Now you understand why she looked at you so passionately before her ultimate surrender to you. She said she felt a strong a presence in you, and warned you that a dominant spirit like yours needs to be trained and well preserved. She offered her services for you without any price.<br><br>Just by a few visits to her shop you realized that Victoria is not only beautiful, but quite bright for her age. She learned a great deal about wizardry, magic and the power of control because her father used her as a spy against his enemies. She showed you around the shop while you two talked about the items on the shelves and the knowledge she has about them. You can always ask her about occultism and magic and she will help you out. Victoria is standing behind her desk, quietly waiting for your commands. She is more submissive than your other slaves and you know she would kill for you if it would bring the slightest smile on your face.<br><br>You just have to ask\u201d!"
		} else return s +
			"Victoria, the lovely owner of the Antiques & Artifacts " + getShopStore(true)
	};
	per.getPersonAddress = function() {
		return this.isCharmedBy() ? "above the Antiques " + getShopStore(true) + ", Glenvale Shopping Center" : ""
	};
	per.showPersonChat = function(bGeneral, md) {
		if (!this.isHere() || !this.checkFlag(8) || sType !== "") return;
		var clv = this.getCharmedLevel();
		if (!this.checkFlag(33) && perYourBody.FindItem(32) > 0) addQuestionC(md, "ask about the silver ring", "Victoria", 200);
		if (perYou.isQuestStarted(1) && this.checkFlag(8) && !this.checkFlag(4)) addQuestionC(md,
			"ask if she has any magic stones", "Victoria", 192);
		if (this.checkFlag(34) && !this.checkFlag(35) && perKurndorf.getQuestSeance() > 17) addQuestionR(md, "ask Victoria about the papers Janet sold", "She replies, &quot;Oh, I am sorry " + this.getYourNameFor() + ' I do not really deal in old books that much. I sold them onto a specialist dealer and shipped them out to their shop in France"</p><p>Well that seems to be it, they are gone, you will have to find another source of the information.', "Victoria", "setPersonFlag(\\'Victoria\\',35);setPersonFlag(\\'Victoria\\',36)");
		if (this.checkFlag(34) && !this.checkFlag(35))
			if (perKurndorf.getQuestSeance() == 17)
				if (clv > 0) addPopupLinkC(md, "ask Victoria about the papers Janet sold", "Old Papers", "<img src='Images/antiquepapers.jpg' style='height:80vh;float:right;margin-left:5px' alt='Papers'>" + "You ask Victoria about the papers Janet sold and she shows you a small display case with some books and papers,</p>" + '<p>"Here they are, I was going to sell them on to a specialist dealer in books but you are lucky, they are still here. Did you want them?"</p>' +
					"<p>She opens the case and you check through them. Little is of interest, but there is a document discussing s\u00e9ances and it looks exactly like the information you are seeking. You place the document in your bag.</p>" + '<p>Victoria closes the case, "Is there anything else you want ' + perYou.getMaster() + ', including me?"', false, "setPersonFlag('Victoria',35);setPersonFlag('Victoria',36);perYourBody.PutItem(26);perKurndorf.setQuestSeance(19);dispPlace();");
				else addPopupLinkC(md, "ask Victoria about the papers Janet sold",
					"Old Papers", "<img src='Images/antiquepapers.jpg' style='height:80vh;float:right;margin-left:5px' alt='Papers'>" + "You ask Victoria about the papers Janet sold and she shows you a small display case with some books and papers,</p>" + '<p>"Here they are, I am probably going to sell them on to a specialist dealer in books but you are lucky, they are still here. Are you interested in purchasing them? For a quick sale they are ' + sCurrency + '50?"', false, "setPersonFlag('Victoria',35);dispPlace();");
		if (clv >
			0) addLinkToPlaceO(md, "examine Victoria's merchandise again", Place, "type=victoriasex");
		if (clv == 2)
			if (!this.checkFlag(10)) addQuestionC(md, '"So, now you\u2019re my personal assistant, right?"', "Victoria", 800);
			else if (!this.checkFlag(11)) addQuestionC(md, '"So...you have wanted to be my right hand woman from the beginning, why?"', "Victoria", 801);
		else if (!this.checkFlag(12)) addQuestionC(md, '"OK, now what? What happens now?"', "Victoria", 802);
		else if (!this.checkFlag(13)) addQuestionC(md, '"Like a real secretary I guess..."',
			"Victoria", 803);
		else if (!this.checkFlag(14)) addQuestionC(md, '"Alright, I expect full discretion and availableness all the time."', "Victoria", 804)
	};
	per.passTimeDay = function() {
		this.setFlag(6, Place != 348);
		this.setFlag(7, false);
		return ""
	};
	per.showEvent = function() {
		var md;
		if (Place == 269 && sType == "victoriapool") {
			WaitHereOnly(6);
			md = WritePlaceHeader();
			this.showPerson("victoria-pool.jpg");
			addPlaceTitle(md, "Swimming with Victoria");
			md.write("<p>Victoria arrives, dressed in a lovely yellow bikini, and she sits on a lounge to have a chat with you before going for a swim.</p>");
			startQuestions();
			addLinkToPlaceC(md, "it is fairly private here...", Place, "type=victoriapoolsex");
			addLinkToPlaceC(md, "say goodbye to Victoria", Place);
			WritePlaceFooter(md);
			return true
		}
		if (Place == 269 && sType == "victoriapoolsex") {
			md = WritePlaceHeader(false, "td-left-large");
			this.showPerson("victoria-pool-sex.jpg");
			addPlaceTitle(md, "Being Discrete and Private with Victoria");
			md.write("<p>You ask Victoria to play with you more privately, and she seductively removes most of her swimsuit and lies back waiting for you.</p>");
			startQuestions();
			addLinkToPlaceC(md, "later...say goodbye to Victoria", Place);
			WritePlaceFooter(md);
			return true
		}
		if (this.isHere() && sType == "victoriasex") {
			md = WritePlaceHeader();
			if (perYou.isMaleSex())
				if (isExplicit()) this.showPersonRandomX("victoria7b", 2);
				else this.showPerson("victoria7b.jpg");
			else this.showPersonRorX("victoria7g.jpg");
			var myName = this.getYourNameFor();
			addPlaceTitle(md, "Playing with Slave Victoria");
			md.write('<p>"You wish to use me again, ' + myName + '?" she asks.  "What would you like\tthis time?"</p>' +
				'<p>"Surprise me, Victoria, my pet.  Show me another trick you picked up somewhere along the way."</p>' + "<p>The closest thing to a gleeful look crosses her face as her desire flushes to the surface. " + '"It shall be as you desire, ' + myName + '," she says, stripping what little ' + "clothing she was wearing off and quickly disrobing you as well.</p>" + "<p>A little more than an hour later you find yourself once again exhausted and Victoria still willing and able for more.</p>" + '<p>"Amazing as ever, pet," you say, and her face once again flushes at your praise.  "Thank you, ' +
				myName + '," is all she says, as usual with little to no emotion.</p>');
			startQuestions();
			addLinkToPlace(md, "speak with Victoria of other matters", 348);
			addLinkToPlace(md, "leave the " + getShopStore(), 194);
			WritePlaceFooter(md);
			return true
		}
		return false
	};
	per.isPhoneable = function() {
		return checkPlaceFlag("Hotel", 11) && Place == 269 && this.isCharmedBy()
	};
	per.callThem = function() {
		if (Place == 269)
			if (isShopOpen(0)) WriteComments('You call Vctoria to invite her to join you at the pool for a swim, but she replies, "Sorry, ' +
				this.getYourNameFor() + ', the Antiques Store is open now, can we do this another time?". You agree and will have to call her another time.');
			else {
				gotoPlace(Place, "type=victoriapool");
				receiveCall("", "You call Victoria to invite her to join you at the pool for a swim, and she happily agrees.");
				WriteCommentsFooter(bChat, bChatLeft)
			}
	};
	per.addPersonPhoneCall = function() {
		if (this.getCharmedLevel() != 2) return false;
		var hr = getHour();
		var no;
		if (nTime - this.charmedTime > 72 && hr < 9 && !this.checkFlag(6))
			if (!this.checkFlag(5)) {
				if (makeCall(true,
						50)) {
					this.setFlag(5);
					this.setFlag(6)
				}
			} else {
				var ar = [];
				for (var i = 51; i < 55; i++)
					if (!this.checkFlag(15 + i - 51)) ar.push(i);
				if (ar.length > 0) {
					no = ar[Math.floor(Math.random() * ar.length)];
					if (makeCall(true, no)) {
						this.setFlag(6);
						this.setFlag(15 + no - 51)
					}
				}
			}
		else if (hr > 19 && this.checkFlag(5) && !this.checkFlag(7) && (!this.checkFlag(25) || !this.checkFlag(26)) && Place != 348)
			if (this.checkFlag(25)) {
				if (makeCall(true, 56)) {
					this.setFlag(7);
					this.setFlag(26)
				}
			} else if (this.checkFlag(26)) {
			if (makeCall(true, 55)) {
				this.setFlag(7);
				this.setFlag(25)
			}
		} else {
			no =
				Math.floor(Math.random() * 2);
			if (makeCall(true, 55 + no)) {
				this.setFlag(7);
				this.setFlag(25 + no)
			}
		}
		return false
	};
	per.getPersonSMS = function(id) {
		switch (id) {
			case 50:
				return receiveSMS("Victoria", "Good morning, " + perYou.getMaster() + "! I hope you had a wonderful dream! I got your number from the telephone book! I hope you don\u2019t mind! I am changing my apartment to be more of an office. You can come through the shop, it\u2019s on the first floor! The door is always open for you!", "victoriasmsfirstmessage.jpg",
					"88%");
			case 51:
				return receiveSMS("Victoria", "I hope I am not disturbing your morning routine, my " + perYou.getMaster() + "! I just wanted to check in if you need anything! My body is longing for you, but I certainly understand that you are busy!", "victoriasmslongingbody.jpg");
			case 52:
				return receiveSMS("Victoria", "It's me again " + perYou.getMaster() + "! I just had a beautiful dream with you in it! In it you were the king of a realm and thousands and thousands of women were laying at your feet, ready for your command! It was wonderful! I wish you " +
					perYou.getMaster() + " a happy and productive day!", "victoriasmsijusthadadream.jpg", "88%");
			case 53:
				return receiveSMS("Victoria", "Good morning, my " + perYou.getMaster() + "! I know this is usually the time that you wake up and I wanted to remind you how happy I am being your slave! I am ready to do my everyday routine, but if you wish anything I shall be happy to be of service!", "victoriasmshappyworkingforyou.jpg");
			case 54:
				return receiveSMS("Victoria", "It is a wonderful morning " + perYou.getMaster() + "! I\u2019ve been a good secretary and I made you breakfast. That\u2019s what secretaries do, right Master? It\u2019s bread and butter with lemon juice ( I made it myself). Yummy! If you are hungry, come and visit me!:))",
					"victoriasmsmorningbreakfast.jpg");
			case 55:
				return receiveSMS("Victoria", "I hope all is well with you " + perYou.getPersonName() + "! I wish you a great goodnight sleep! And I am sending you a picture of me to help you sleep, my " + perYou.getMaster() + "!:)", "victoriasmsgreatgoodnightsleep.jpg");
			case 56:
				return receiveSMS("Victoria", "It\u2019s been a long day, but I wanted to know if everything is alright, " + perYou.getMaster() + "! I am going to sleep, but here\u2019s me only in my night dress! I know you like it you naughty, naughty " +
					perYou.getMaster() + "! :PP", "victoriasmseveningdress.jpg")
		}
		return ""
	}
}
var perYou;
var perYourBody;
var nMana;
var sGender;

function spendExperience(type) {
	Leave();
	var md = WritePlaceHeader(false, "", "black");
	if (type === undefined) {
		addPlaceImage(md, "UI/books/bookpage1.jpg");
		addPlaceTitle(md, "Secrets of the Book", "", 0, false, "white");
		if (Place == 17) md.write("<p>" + perGates.getPersonNameShort() + " helps you to look up the passages in the book, pointing out some details of the ciphers used and discussing the meanings of some of the parts. He seem completely familiar with these parts of the book, he must have already mastered these areas, but he does not give you the exact translation but helps you to learn for yourself.</p>");
		else if (Place ==
			192) md.write("<p>Sarah helps you to look up the passages in the book, she is very knowlegable of the occult and magic. Once or twice she asks Lauren for the correct translation of a word and Lauren answers quietly but with no hesitation. Sarah lightly flirts with you as you study the pages, you are not sure if she means it as such or she wants to distract you.</p>");
		else md.write("<p>Tess helps you to look up the passages in the book, she is completely familiar with the ciphers used and makes decoding easy. She has little knowledge of magic in a practical way, just in theory, so she cannot help with a detailed understanding on the passages.</p>");
		md.write("<p>The passages are complex and will take a while to study in detail, so you decide to focus on one in particular for now, but you only have a vague idea of the details so far,</p>");
		if (perYou.checkFlag(12) && !perYou.checkFlag(25) && perYou.checkFlag(24)) md.write("<p>You do remember Mr. Beasley offer to teach you a hypnotic technique, you think you could instead ask him to teach you and leave the Book for now.</p>");
		if (!perYou.checkFlag(18)) md.write("<p>Interesting, you would have thought there would be something to help protect yourself from magic. Maybe it can be found elsewhere.</p>");
		startQuestionsOnly("The passages seem to be about", "", md);
		var nShown = 0;
		if (isSpellKnown("Charm") && !perYou.checkFlag(26) && nShown < 3) {
			nShown++;
			addOptionLink(md, "manipulative charms", "spendExperience(8)", "bloodblock")
		}
		if (isMurderPath()) {
			if (isSpellKnown("Charm") && !perYou.checkFlag(19) && nShown < 3) {
				nShown++;
				addOptionLink(md, "masculine cantrips", "spendExperience(3)", "bloodblock")
			}
			if (isSpellKnown("MirDaru") && !perYou.checkFlag(23) && nShown < 3) {
				nShown++;
				addOptionLink(md, "medium powers", "spendExperience(7)", "bloodblock")
			}
			if (isSpellKnown("Teleport") &&
				!perYou.checkFlag(21) && nShown < 3) {
				nShown++;
				addOptionLink(md, "precision transitions", "spendExperience(5)", "bloodblock")
			}
			if (!perYou.checkFlag(17) && nShown < 3) {
				nShown++;
				addOptionLink(md, "conserving magic", "spendExperience(1)", "bloodblock")
			}
			if (!perYou.checkFlag(20) && nShown < 3) {
				nShown++;
				addOptionLink(md, "harnessing mana", "spendExperience(4)", "bloodblock")
			}
		} else {
			if (!perYou.checkFlag(17) && nShown < 3) {
				nShown++;
				addOptionLink(md, "conserving magic", "spendExperience(1)", "bloodblock")
			}
			if (isSpellKnown("Teleport") && !perYou.checkFlag(21) &&
				nShown < 3) {
				nShown++;
				addOptionLink(md, "precision transitions", "spendExperience(5)", "bloodblock")
			}
			if (isSpellKnown("Charm") && !perYou.checkFlag(19) && nShown < 3) {
				nShown++;
				addOptionLink(md, "masculine cantrips", "spendExperience(3)", "bloodblock")
			}
			if (!perYou.checkFlag(20) && nShown < 3) {
				nShown++;
				addOptionLink(md, "harnessing mana", "spendExperience(4)", "bloodblock")
			}
			if (isSpellKnown("MirDaru") && !perYou.checkFlag(23) && nShown < 3) {
				nShown++;
				addOptionLink(md, "medium powers", "spendExperience(7)", "bloodblock")
			}
		}
		if (isSpellKnown("Wealth") &&
			!perYou.checkFlag(22) && nShown < 3) {
			nShown++;
			addOptionLink(md, "golden gestures", "spendExperience(6)", "bloodblock")
		}
		if (isSpellKnown("Invisibility") && !perYou.checkFlag(28) && nShown < 3) {
			nShown++;
			addOptionLink(md, "the unseen", "spendExperience(9)", "bloodblock")
		}
		addLinkToPlaceC(md, "forget it for now", "", sPlaceParams)
	} else {
		addPlaceImage(md, "UI/books/bookpage2.jpg");
		addPlaceTitle(md, "Secrets of the Book Revealed", "", 0, false, "white");
		perYou.extra[11] += 9;
		passTime(false, true);
		passTime(false, true);
		passTime(false,
			true);
		passTime(false, true);
		if (type == 1) {
			perYou.setFlag(17);
			md.write("<p>After some study the passage is clearer, you can see how to make a hand gesture and focus your thoughts and cast spells for a little less cost in mana.</p>" + "<p>Expensive spells will cost 1 or 2 points less now.</p>")
		} else if (type == 3) {
			perYou.setFlag(19);
			md.write('<p>After some study the passage is clearer, you can see now see how to slightly change your pronunciation of "Dai Chu" so it also affects men.</p>')
		} else if (type == 4) {
			perYou.setFlag(20);
			md.write("<p>After some study the passage is clearer, you learn a simple ritual when using a magic stone that harnesses a little more mana from the stone.</p>")
		} else if (type == 5) {
			perYou.setFlag(21);
			md.write("<p>After some study the passage is clearer, you understand how to control the teleport spell better and can use it to travel to more places.</p>" + "<p>Additionally you can now bring others with you when you teleport but they have to be completely willing for the spell to work.</p>" + '<p><img style="float:right;width:10%" src="UI/themes/theme1/symbol1.png" alt="Hexagram" title="Hexagram">You also now know how the carve a hexagram into a living tree to create a new place to teleport to. The mana cost of this is 1 point.</p>')
		} else if (type ==
			6) {
			perYou.setFlag(22);
			md.write("<p>After some study the passage is clearer, you understand how to better control the Wealth spell to give more money.</p>")
		} else if (type == 7) {
			perYou.setFlag(23);
			md.write("<p>After some study the passage is clearer, you now know how to better control the spell 'Unlife Enspelled' to affect even more types of undead, including ghosts and other spirits.</p>" + "<p>It is interesting to see here that ghosts are less strongly tied to their identity and this spell can affect ghosts without knowing their names, but it will only have a transitory effect.</p>")
		} else if (type ==
			8) {
			perYou.setFlag(26);
			md.write("<p>After some study you learn how to finer control the charm process and you can now influence the person in much finer detail, better guiding them to your desires.</p>" + "<p>You should be able to choose different ways that the charm spell will affect people but this will vary depending on the person.</p>")
		} else if (type == 9) {
			perYou.setFlag(28);
			md.write("<p>After some study you learn how stay invisible for longer. Now only dawn or dusk will end the spell.</p>")
		}
		startQuestionsOnly();
		addLinkToPlaceC(md, "that is all for now", "", sPlaceParams);
		updateRightBar()
	}
	WritePlaceFooter(md)
}

function isArrestPossible() {
	if (!isCharmedBy("Gina")) return true;
	if (isMurderPath()) {
		if (isCharmedBy("OfficerKhan") && isCharmedBy("OfficerBatton")) return false;
		return true
	} else return false
}

function GenderToggle() {
	if (sGender == "man") sGender = "woman";
	else if (sGender == "woman") sGender = "futa";
	else sGender = "man";
	alert("You are now a " + sGender);
	ChangePersonLst(document)
}

function initialiseYou() {
	perYou = addPerson("You");
	perYou.Items = new MakeArray(20, 0);
	perYou.MaxItems = 20;
	perYou.extra = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];
	perYou.getPersonGender = function() {
		if (isPossess()) {
			if (findPerson(sPossess) === null) return "woman";
			return per.getPersonGender()
		}
		return sGender
	};
	perYou.getPersonName = function(full) {
		if (isPossess()) return GetPersonName(sPossess, full);
		return this.name
	};
	perYou.getCorruption = function() {
		return this.extra[13]
	};
	perYou.addCorruption = function(no) {
		this.extra[13] += no;
		if (this.extra[13] <
			0) this.extra[13] = 0
	};
	perYou.isStuck = function() {
		if (nMoney < 10 && (isAtLocation(16) && !isPlaceKnown("Tunnel") && !isPlaceKnown("WalkingTrail") || isAtLocation(317) && !isPlaceKnown("ChurchTunnel"))) {
			if (nMana > 0 && isSpellKnown("Teleport")) return false;
			return true
		}
		return false
	};
	perYou.getCashOnHand = function() {
		return nMoney > 0 ? nMoney : 0
	};
	perYou.getBankBalance = function() {
		return this.extra[12]
	};
	perYou.setBankBalance = function(no) {
		this.extra[12] = no
	};
	perYou.isShot = function() {
		return this.checkInjury(1)
	};
	perYou.setInjury = function(no) {
		this.extra[2] =
			setBitFlag(this.extra[2], no)
	};
	perYou.checkInjury = function(no) {
		return checkBitFlag(this.extra[2], no)
	};
	perYou.setArrested = function(no) {
		this.extra[4] = no;
		if (no > 0) this.setFlag(36)
	};
	perYou.getArrested = function() {
		return this.extra[4]
	};
	perYou.isArrested = function() {
		return this.extra[4] > 0
	};
	perYou.startQuest = function(no) {
		this.extra[5] = setBitFlag(this.extra[5], no)
	};
	perYou.isQuestStarted = function(no) {
		return checkBitFlag(this.extra[5], no)
	};
	perYou.completeQuest = function(no) {
		this.extra[6] = setBitFlag(this.extra[6],
			no)
	};
	perYou.isQuestComplete = function(no) {
		return checkBitFlag(this.extra[6], no)
	};
	perYou.getHolyWaterUses = function() {
		return this.extra[8]
	};
	perYou.setHolyWaterUses = function(no) {
		this.extra[8] = no
	};
	perYou.getExperience = function() {
		return this.other
	};
	perYou.addExperience = function(no) {
		this.other += no
	};
	perYou.canUseExperience = function(bNoMax) {
		if (this.other - this.extra[11] < 9) return false;
		if (bNoMax === true) return true;
		return this.extra[11] / 9 < 11
	};
	perYou.getQuestAftane = function() {
		return this.extra[9]
	};
	perYou.setQuestAftane =
		function(no) {
			this.extra[9] = no
		};
	perYou.getQuestRustyKey = function() {
		return this.extra[10]
	};
	perYou.setQuestRustyKey = function(no) {
		this.extra[10] = no
	};
	perYou.moveThem = function(np) {
		dispPlace(np)
	};
	perYou.showEventPopup = function() {
		if (sType == "dream7") {
			this.setFlag(40);
			showPopupWindow("Dreaming", "<img src='Images/Dreams/dream7.jpg' style='width:45%;float:right;margin-left:5px' alt='Dream'>" + "You remember having erotic and confused dreams during the night. Once you remember clearly seemed to have a group of ghosts walking through a field. All were quite naked under their ectoplasmic veils.<br><br>" +
				"This was probably just a dream from reading odd carnal books." + (sComment !== "" ? "</p><p>" + sComment : ""));
			return true
		}
		if (sType == "dream2") {
			this.setFlag(41);
			showPopupWindow("Dreams in the Dark", "<img src='Images/Dreams/dream2.jpg' class='imgpopup' alt='Dream'>" + "You start to hear a noise, a low chanting and as you try to hear it a figure starts to form. A goat-like, vaguely female form, fecund and grotesque. While <b>she</b> has no hands she still gestures to you</p>" + '<p>The chanting rises "Ia, ia, Shub-Niggurath!" and suddenly you wake up, covered in sweat and feeling profoundly aroused...Just a dream from some old horror story...you hope.' +
				(sComment !== "" ? "</p><p>" + sComment : ""));
			return true
		}
		if (sType == "dream5") {
			this.setFlag(42);
			showPopupWindow("Strange Dream", "<img src='Images/Dreams/dream5.jpg' class='imgpopup' alt='Dream'>" + "After you wake you vaguely remember a dream of entwined flesh, tentacular flesh and a beautiful woman. All this stuff about the Book and legends must be getting to you..." + (sComment !== "" ? "</p><p>" + sComment : ""));
			return true
		}
		if (sType == "dreamkate") {
			this.setFlag(43);
			showPopupWindow("Girl of Your Dreams", "<img src='Images/katedream1.jpg' class='imgpopup' alt='Dream'>" +
				"After you wake you remember once again dreaming of Kate, this time she was a cheerleader, not that she has ever been one.</p><p>She is certainly agile enough, but she prefers her books and martial arts more...agile...she certainly was in the dream...just in a different way..." + (sComment !== "" ? "</p><p>" + sComment : ""));
			return true
		}
		if (sType == "dreamdemoncome") {
			this.setFlag(45);
			showPopupWindow("Girl of Your Dreams", "<img src='Images/Dreams/dreamdemoncome.jpg' class='imgpopup' alt='Dream'>" + "Your dreams are heavily erotic, filled with the sensation of a woman's body hotly entwined with yours. At the end you see her clearly. the demonic woman you saw in a clairvoyant vision. Huskily she says,</p>" +
				'<p>"Come to me, to the <i>thin clearing</i> in darkness and <b>teleport</b> while thinking of my name, <b>Elian</b>"' + (sComment !== "" ? "</p><p>" + sComment : ""));
			return true
		}
		if (sType == "dreamking") {
			this.setFlag(46);
			showPopupWindow("The King Does Not Live", "<img src='Images/Dreams/dream1.jpg' class='imgpopup' alt='Dream'>" + "Your dreams are heavily disturbed, filled with barely seen horrors and whispered voices that you can never quite hear.</p>" + "<p>At the end you see a figure reciting from a book, you cannot hear his words but the book looks disturbing familiar. You know his name, he is the King in Yellow and you almost call out his name, but suddenly you wake up in sheer terror.</p>" +
				'<p>While the book was just fiction, you remember from it "death comes to those who speak the King in Yellow\'s name". Yes, it is just fiction, but you have no intention of saying that name, despite how clearly you remember it, <i>Hastur</i>...' + (sComment !== "" ? "</p><p>" + sComment : ""));
			return true
		}
		if (sType == "dreamkinglater") {
			showPopupWindow("The King in Dreams", "<img src='Images/Dreams/dream" + (Math.random() < .5 ? "3" : "4") + ".jpg' class='imgpopup' alt='Dream'>" + "Your dreams are again heavily disturbed, filled with barely seen horrors and whispered voices that you can never quite hear but you are sure what name they are calling <i>Hastur</i>.</p>" +
				"<p>At the end you see his figure appear from the darkness, wreathed in a sickly light, tentacular forms writhing around. You can feel him searching for you but suddenly you wake up in sheer terror." + (sComment !== "" ? "</p><p>" + sComment : ""));
			return true
		}
		if (Place == 161 && sType == "useplans") {
			perYourBody.RemoveItem(23);
			setPlaceFlag("Hotel", 10);
			showPopupWindow("Hotel Cellar", "<img src='Images/door2.jpg' style='width:45%;float:right;margin-left:5px' alt='Hotel Cellar'>" + "The plans describe a small cellar door behind a corridor leading from the bar. You go through the door." +
				"<br><br>" + "The hotel plans get caught in the door and are torn in half.  Ruined.");
			return true
		}
		if (Place == 269 && !checkPlaceFlag("Hotel", 11) && !isPersonHere()) {
			setPlaceFlag("Hotel", 11);
			showPopupWindow("New View", "<img src='Images/pool0.jpg' class='imgpopup' alt='Pool'>" + "The pool is almost empty when you arrive, you see a cute woman leaving the pool and with a glance and smile she is gone.</p> " + "<p>It crosses your mind that you should <b>call</b> someone to join you for a dip, it is just a matter of who is free at the moment.");
			return true
		}
		if (Place == 46) {
			if (sType == "endgame1notnow") {
				this.setFlag(38);
				movePerson("Didi", 269);
				showPopupWindow("It is Time?", addImageString("Endings/endgame1-more.jpg", "height:80vh", "right") + "Not now, it is not yet time to end your exploration or at least take a break from it. Who know what secrets of magic or other people there are to meet and influence....well charm and add to your harem if you want to be accurate!<br><br> " + "Perhaps later you can decide to relax, you suppose you can have a chat with " +
					(wherePerson("Tess") == 46 ? "Tess" : "Tracy") + " about it, but say on a weekend. Sunday is supposed to be a day of rest, so then on <b>Sunday night</b> you can reconsider");
				return true
			}
			if (!this.checkFlag(38) || sType == "endgame1start")
				if (getDay() != "Sunday" && isMainStoryComplete() || sType == "endgame1start") {
					var totc = 0;
					var totcan = 0;
					var p;
					for (var i = 0, ie = arPeople.length - 13; i < ie; i++) {
						p = arPeople[i];
						if (!isMurderPath() && (p.name == "Sofia" || p.name == "Sarah")) continue;
						if (p.isCharmedBy("You")) totc++;
						totcan++
					}
					showPopupWindow("It is Time?",
						addImageString("Endings/endgame1-start.jpg", "height:80vh", "right") + "You sit down for a bit and think about how things are " + (isPersonHere("Tess") ? "and you look into the adoring eyes of Tess" : "and you consider the new women in your life") + ", you have to think that things are good!<br><br>" + "You have dealt with Davy, Kurdorf and the Demon, and the town is more or less yours. The police and town hall are under your influence and you have done " + (totc == totcan ? "all that you can think to do" : "enough, though there is probably more that could be done") +
						".<br><br>" + 'You wonder then if you should just relax and enjoy yourself now you have control over the "Sacred Book of Control" and the people of the town' + (isCharmedBy("Mom") || isCharmedBy("Tracy") ? " and your family" : "") + ". Then again you could continue, looking for new opportunities, sources of magic and people, or just visiting those you are involved with.<br><br>" + addLinkToPlace("string", "It is time to enjoy what you have", 46, "type=endgame1harem", "", "", "perYou.setFlag(38)", undefined, "margin-left:5%;margin-right:50%;width:45%") +
						(perYou.checkFlag(38) ? addOptionLink("string", "There must be more to do, or at least re-do...", "setQueryParams();dispPlace()", undefined, "margin-left:5%;margin-right:50%;width:45%") : addLinkToPlace("string", "There must be more to do, or at least re-do...", 46, "type=endgame1notnow", "", "", "", undefined, "margin-left:5%;margin-right:50%;width:45%")), "", "", true, true, true);
					return true
				}
		}
		if (sType == "playagame") {
			perYourBody.setFlag(15);
			showPopupWindow("Games", "<img src='UI/phonegame.jpg' style='width:40%;float:right;margin-left:5px' alt='Games'>" +
				"Your phone has some simple games installed, very simple as your phone is fairly basic.<br><br>" + "When you play a game an Autosave will be immediately done and you will take 1 hour to play the game (no matter how long you actually play for)", "usePhone('games')");
			return true
		}
		return false
	};
	perYou.showEventSleep = function(wt, plc, s, param) {
		if (param) return false;
		if (!this.checkFlag(45) && checkPersonFlag("Glenvale", 67) && getPersonOther("Vampyre") >= 60 && isSpellKnown("Teleport")) {
			WaitforForDayNight(s, plc, "type=dreamdemoncome");
			return true
		}
		if (this.checkFlag(40)) return false;
		if (!this.checkFlag(44) && checkPlaceFlag("RathdownRd", 5)) {
			WaitforForDayNight(s, plc, "type=dream7");
			return true
		}
		if (checkPersonFlag("Catherine", 13) && !perYou.checkFlag(46)) {
			WaitforForDayNight(s, plc, "type=dreamking");
			return true
		}
		if (!this.checkFlag(41) && nMana > 0 && Math.random() < .1) {
			WaitforForDayNight(s, plc, "type=dream2");
			return true
		}
		if (!this.checkFlag(42) && Math.random() < .1) {
			WaitforForDayNight(s, plc, "type=dream5");
			return true
		}
		if (!this.checkFlag(43) && Math.random() <
			.8) {
			WaitforForDayNight(s, plc, "type=dreamkate");
			return true
		}
		if (this.checkFlag(46) && Math.random() < .1) {
			WaitforForDayNight(s, plc, "type=dreamkinglater");
			return true
		}
		return false
	};
	perYou.showEvent = function() {
		var md;
		if (Place == 161 && this.whereNow() == 124 && isDavyDefeated() && perDavy.place != 184 && this.checkFlag(9) && !checkPersonFlag("Anita", 6)) {
			setPersonFlag("Anita", 6);
			md = WritePlaceHeader(false, "td-left-med");
			perDavy.showPerson("davycellar.jpg");
			addPlaceTitle(md, "Davy in the Cellar");
			if (!checkPlaceFlag("Hotel",
					9)) {
				setPlaceFlag("Hotel", 9);
				md.write("<p>You descend the stairs into the cellar and you see Bambi has arranged a quick refit so it is more a dungeon of some sort of BDSM fantasy. You are always surprised at the skill and depravity of Bambi.</p>")
			} else md.write("<p>The cellar or more accurately now the hotel dungeon is mostly dark, but with spot lighting on selected areas and people.</p>");
			md.write("<p>You see Davy securely bound and gagged against one wall of the cellar. Standing in front of him are Bambi and Anita dressed in revealing leather outfits, a fantasy of dominatrix pleasures. Bambi you have no doubt has such an outfit, but Anita? Then you realised, of course Bambi has loaned Anita something from her collection.</p>" +
				'<p>Bambi greets you "' + perYou.getLord() + ' your servant Anita is somewhat lacking in skills to properly restrain and punish your slave here. I will train her with all my skill to become the best possible guardian of your slave."</p>' + '<p>Anita asks you "Are you sure ' + (perYou.isBornMale() ? "Sir" : "Ma'am") + ' that this is what you want? Surely it would be simpler to beat him and then...", you stop her,</p>' + '<p>"No soldier! I want him here and controlled, not tortured. In all matters of guarding your prisoner you will obey Bambi, she is your superior for this duty." Anita salutes you and address Bambi,</p>' +
				'<p>"Ma\'am I am your to command!", you notice a mischievous glint in Bambi\'s eye and you caution her "Bambi, for this duty, remember that"</p>' + '<p>"Of course ' + perYou.getLord() + '", but you know how "imaginative" she is so you will have to check on things here occasionally.</p>');
			startQuestions();
			addLinkToPlace(md, "check the rest of the cellar dungeon", 161);
			addLinkToPlace(md, "go back up to the hotel bar", 124);
			WritePlaceFooter(md);
			return true
		}
		if (Place != 46) return false;
		if (sType == "endgame1harem") {
			hideSidebars();
			var ar = [];
			if (isCharmedBy("MrsGranger")) {
				if (isExplicit(true)) ar.push("Explicit/Endings/endgame1-harem1.gif");
				if (isCharmedBy("MsJones")) ar.push("endgame1-harem4.jpg");
				if (checkPersonFlag("Catherine", 5)) ar.push("endgame1-harem5.jpg");
				if (isCharmedBy("Sofia")) ar.push("endgame1-harem9.jpg");
				if (isCharmedBy("Alison")) ar.push("endgame1-harem13.jpg")
			}
			if (checkPersonFlag("Catherine", 5)) {
				if (isCharmedBy("Mayor")) ar.push("endgame1-harem7.jpg");
				if (isCharmedBy("Sarah")) ar.push("endgame1-harem11.jpg");
				if (isCharmedBy("MsJones") &&
					isCharmedBy("Louise")) ar.push("endgame1-harem15.jpg")
			}
			if (isCharmedBy("Gina") && isCharmedBy("MsTitus")) ar.push("endgame1-harem2.jpg");
			if (isCharmedBy("Hannah") && isCharmedBy("Camryn")) ar.push("endgame1-harem3.jpg");
			if (isCharmedBy("Diane") && isCharmedBy("MrBeasley") && per.checkFlag(12)) ar.push("endgame1-harem6.jpg");
			if (isCharmedBy("MrsRobbins") && isCharmedBy("NurseMegan")) ar.push("endgame1-harem8.jpg");
			if (isCharmedBy("Mom") && isCharmedBy("Tracy")) ar.push("endgame1-harem10.jpg");
			if (isCharmedBy("Victoria")) ar.push("endgame1-harem12.jpg");
			if (isCharmedBy("MsJones") && isCharmedBy("MissLogan") && isCharmedBy("MrsTanika")) ar.push("endgame1-harem14.jpg");
			if (isCharmedBy("Tess") && isCharmedBy("Monique")) ar.push("tessmonique.jpg");
			ar.push("endgame1-harem16.jpg");
			ar.push("endgame1-harem17.jpg");
			if (isMurderPath() && isCharmedBy("Sarah")) ar.push("endgame1-harem18.jpg");
			else if (!isMurderPath()) ar.push("endgame1-harem18.jpg");
			if (isCharmedBy("Mayor") && isCharmedBy("Lauren")) ar.push("endgame1-harem19.jpg");
			findPerson("Jessica");
			if ((per.isRival() || per.getRivalry() >
					2) && isCharmedBy("Desiree")) ar.push("endgame1-harem20.jpg");
			var img = ar[Math.floor(Math.random() * ar.length)];
			var no;
			if (img == "tessmonique.jpg") no = 21;
			else no = parseInt(img.split("Explicit/Endings/").join("").split("endgame1-harem").join("").split(".jpg").join("").split(".gif").join(""), 10);
			var td = "";
			if (no == 1 || no == 3 || no == 7 || no == 10 || no == 11 || no == 14 || no == 15) td = "td-left-med";
			md = WritePlaceHeader(false, td);
			if (no == 21) AddImage(img);
			else if (img.indexOf("Explicit/Endings/") != -1) AddImage(img);
			else AddImage("Endings/" +
				img);
			addPlaceTitle(md, "Enjoying Life With Those You Know");
			md.write("<p>You have a comfortable situation, you have substantial influence, or control if you prefer, over the town. You have defeated Davy, the ghost of Kurndorf and an actual Demon! You have learned quite a lot of magic and know how to source magic and money.</p>" + "<p>You have a number of people who call you either their lover or " + perYou.getMaster());
			if (isCharmedBy("Tracy") || isCharmedBy("Mom", "You")) md.write(" including your own family. ");
			md.write("They are willing to do anything for you. All your dreams of sexual desire can be satisfied in any number of combinations.</p>" + "<p><i>In particular...</i></p>");
			switch (no) {
				case 1:
					md.write("<p>Mrs. Granger is no matter how you think of her, a bit of a slut, and more so since you charmed her. You still think of her as <b>Mrs.</b> Granger not just Marie as you like to consider her your MILF slut and she goes along with this completely.</p>" + "<p>At times she brings home friends, or work colleagues to share with you, either as a new slave or just for a night of passion with them.</p>");
					break;
				case 2:
					md.write("<p>The librarian Karen Titus is a complete submissive, a slave for you who will do anything you ask of her, anything at all. She is enthusiastic about playing with others of your harem, often with the security guard Gina and without your asking as well.</p>" + "<p>Both are lovely large breasted slaves for your harem with no complexities or jealousies. They will do anything you want, at anytime and with anyone!</p>");
					break;
				case 3:
					md.write("<p>The sisters Hannah and Camryn make wonderful girfriends or slaves as you prefer, beautiful and buxom. Small jealousies and rivalries do crop up, they are sisters after all, but the charm spell helps to keep these minor and controllable, like the women themselves. Still it adds a spice to life, along with some delightful sister/sister threesomes.</p>");
					break;
				case 4:
					md.write("<p>Mrs. Granger is no matter how you think of her, a bit of a slut, and more so since you charmed her. You still think of her as <b>Mrs.</b> Granger not just Marie as you like to consider her your MILF slut and she goes along with this completely.</p>" + "<p>Ms. Jones, your teacher, your slave, your immortal slut, once a demon's plaything and now yours. She is completely dedicated to you and very, very experienced in <b>everything</b> and willing to do <b>anything or anyone.</p>" +
						"<p>While bringing the two of them together is an obvious paring, the mortal and the immortal slut, there are times you are unconfortable with them. They bring you incredible pleasure but the contrasts of them and their dedication is odd to you, one utterly dedicated and unquestioning, one naturally passionate and caring, so you only enjoy them together on special occasions.</p>");
					break;
				case 5:
					md.write("<p>Mrs. Granger is no matter how you think of her, a bit of a slut, and more so since you charmed her. You till think of her as <b>Mrs.</b> Granger not just Marie as you like to consider her your MILF slut and she goes along with this completely.</p>" +
						"<p>Catherine on the other hand you have always considered promiscuous, a woman who loves sex and happily indulges in it where safe and enjoyable. What the difference between her and Ms. Granger in this matter is more terminology, and practise. Catherine actively seeks partners for fun, but Mrs. Granger will do the same with any partner but is more happy to be sought after!</p>" + "<p>It is obvious to get the two women together and they love every time you request it, and you know they meet regularly without you, once met there is no way they would stay apart! This is fine by you, let them has as much fun as they like as long as they are hot and available for you any time you want!</p>");
					break;
				case 6:
					md.write("<p>At one time you became suspicious that Diane White and Mt. Bealey may have some sort of association or relationship, some of the matters around the Book and the investigations were a little suspicious to you.</p>" + "<p>You got your two slaves together to investigate this, but the bimbo that Beasley is now just assumed it was time for a threesome, not that she was wrong of course. Diane denied any association with Mr. Beasley, but you are still unsure given his talents of hypnosis.</p>" +
						"<p>Still having two big breated sluts together was fun but just in case you keep them from meeting without you present, and then just for a repeat threesome.</p>");
					break;
				case 7:
					md.write("<p>Catherine, Catherine, Catherine...your promiscuous friend and ally. You know she has fucked a lot of people, good for her, but you did not realise she had played with Mayor Thomas. Sure a casual thing for them both and you have no plans to change this relationship, it is just strange how small a town Glenvale can be at times!</p>");
					break;
				case 8:
					md.write("<p>Some time later you learned that Geraldine, or Mrs. Robbins as you also think of your MILF slave, knows the nurse Megan quite well. They are friends who meet occasionally, not very close but enough to have lunch or go out for drinks at times.</p>" + "<p>Since you charmed them you have made sure they have gotten closer, at least sexually with you and them present. You do not think this has lead to anything more when you are not around, sometime you may have to encourage things there.</p>");
					break;
				case 9:
					md.write("<p>Mrs. Granger is no matter how you think of her, a bit of a slut, and more so since you charmed her. You still think of her as <b>Mrs.</b> Granger not just Marie as you like to consider her your MILF slut and she goes along with this completely.</p>" + "<p>Sofia the chauffuer is your to control, no matter how reluctantly she is yours. You were surprised one day when you saw her talking with Mrs. Granger at the shopping center. It seems she was allowed to hire out the limosine when it was not otherwise used. You have no difficulties with this now, and it seems Mrs. Granger likes to ride in style at times.</p>" +
						"<p>Well, this has opened up pleasant encounters with the two of them, generally with Mrs. Granger in charge, or a least as much as you allow...</p>");
					break;
				case 10:
					md.write("<p>Things have changed a lot at home, Mom and Tracy are now much closer since you charmed them. While they have not changed, mostly, except they are now your lovers. To your surprise and delight they have embraced being your lovers without reservation or jealousy of each other. While you have at times fantasised about a mother-daughter threesome, the idea of one with your own mother and sister had not previously crossed your mind!</p>");
					break;
				case 11:
					md.write("<p>Since the heiress to the Gats fortune is your slave, you have had opened up a world of wealth and upper-class parties. Sarah is loyal slave and you have encouraged her to experience these things both with yourself and other of your slaves. Catherine is one you like to indulge, she willingly came to you and embraced her place with you and your harem.</p>" + "<p>Sometimes Sarah can bring friends of hers to keep you entertained, and sometimes Catherine will pickup someone for you all to enjoy. Sometimes these people will become a new slave, and other times just a toy for the night.</p>");
					break;
				case 12:
					md.write("<p>Victoria, owner of the Antiques Store, she is your perfect aid and assistant. You were surprised one day to visit and you found her with the security guard from the bank. You were even more surprised to see they were bound and gagged and clearly enjoying themselves.</p>" + "<p>The guard is named Nella and you learned that they are close friends who both enjoy bondage. It is a surprise that this interest of Victoria had not come up before, but you were happy to indulge her interest as often as she wished, along with your new slave, her friend Nella</p>");
					break;
				case 13:
					md.write("<p>Mrs. Granger is no matter how you think of her, a bit of a slut, and more so since you charmed her. You still think of her as <b>Mrs.</b> Granger not just Marie as you like to consider her your MILF slut and she goes along with this completely.</p>" + "<p>Alison has retained some of her independence from her defensive spell and still likes to be in charge of things when you are with her. It is of no concern to you, she is somehat insatiable so she requires little more than sex, sex and more sex. Certainly the spell helped with this but a lot is just her nature.</p>" +
						"<p>These two woman are both insatiable sluts, who completely accept this as part of their natore, with a little help from the spells. OF course this means the times you have had with them have been intense fuck-fests, little else could be discussed!</p>");
					break;
				case 14:
					md.write("<p>Ms. Jones, your teacher, your slave, your immortal slut, once a demon's plaything and now yours. She is completely dedicated to you and very, very experienced in <b>everything</b> and willing to do <b>anything or anyone. Especially with her fellow teachers and since you have also charmed the once cold Mrs. Tanika and the friendly Miss. Logan school-life has been a lot more fun!</p>");
					break;
				case 15:
					md.write("<p>Ms. Jones, your teacher, your slave, your immortal slut, once a demon's plaything and now yours. She is completely dedicated to you and very, very experienced in <b>everything</b> and willing to do <b>anything or anyone.</p>" + "<p></p>");
					break;
				case 16:
					md.write("<p>Once Jesse recovered you found out that she had a particular affinity with the demon thralls. They know she is not the demon but still obey her in all ways as if she is still the demon.</p>" + "<p>This creates an intersting dynamic, once you were able to make Jesse your slave as well!</p>");
					break;
				case 17:
					md.write("<p>Once Jesse recovered you found out that she had a particular affinity with the demon thralls. They know she is not the demon but still obey her in all ways as if she is still the demon.</p>" + "<p>This creates an intersting dynamic, once you were able to make Jesse your slave as well!</p>");
					break;
				case 18:
					md.write("<p>Sarah is now your loyal slave, the beautiful heiress of the Gates fortune. Her main Lauren is also your slave, but Sarah is very possessive of her and has asked to have exclusive access to her. You have of course refused, Lauren is a lovely maid and can serve your needs as well as Sarah's.</p>" +
						"<p>You try to stop Sarah's possessiveness but eventually you give up, when you are not there they cancontinue their games, but when you are around they will both serve you!</p>");
					break;
				case 19:
					md.write("<p>The maid Lauren spends most of her time serving her Mistress Sarah in an odd relationship. You try to give her a break at times, personally serving you elsewhere, or loaning her to another of your slaves.</p>" + "<p>You have loaned her a number of times to Mayor Thomas as they seem to get on well, they both know their place as your slaves and lovers and they are grateful for being allowed to spend time together.</p>");
					break;
				case 20:
					md.write("<p>One odd encouter you had was meeting the Witch Jessica talking to Sister Desiree but realise they have a lot in common. Sister Desiree is fascinated by the paranormal, the occult and Jessica <b>is</b> the occult personified here in Glenvale. Jessica on the other hand has an other time respect for the church and a romatic, or is it erotic, interest in Nuns.</p>" + "<p>You are quite happy for them to have a friendship, well maybe a little closer than that, but make it clear to Jessica that Sister Desiree is yours foremost. Jessica agrees completely and never crosses that line in respect for you saving her from imprisonment.</p>");
					break;
				case 21:
					md.write("<p>Tess is such a beautiful and nice woman, one of your first...magically enhanced girlfriends. You are touched with how devoted and loving she is, and you like to daydream about how you may of been able to make her your even without the spell...a dream but not really likely.</p>" + "<p>Monique on the other hand is utterly devoted to you, focussed on your needs and desires. A nervous but complex woman, interested in the occult, but also frightened of it. A person who loves cars and friends with Hannah, but who does not own a car.</p>" +
						"<p>Even with these differences these two were friends before the spells, and now you can have them become a lot closer. Tess would always prefer to just be alone with you, but is willing to go along with other activities for your pleasure. Monique has not reservations, and you suspect this may of been so before the spell, but you will never know that now.</p>");
					break
			}
			md.write("<p>...</p>" + "<p>Still your existing lovers, or slaves if you will, are not all there is for you to play with...</p>");
			startQuestions();
			if (checkPersonFlag("MissLogan", 1)) addLinkToPlace(md, "there was some good new...you think", 46, "type=endgame1logan");
			else if (isDemonGone() || wherePerson("Kate") == 9999) addLinkToPlace(md, "but not everything went well...", 46, "type=" + (isDemonGone() ? "endgame1demonloose" : "endgame1kategone"));
			else addLinkToPlace(md, "why not indulge with others?", 46, "type=endgame1other");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "endgame1logan") {
			hideSidebars();
			md = WritePlaceHeader();
			AddImage("Endings/endgame1-loganpregnant.jpg");
			addPlaceTitle(md, "A Lesson in Reproduction");
			md.write("<p>A few weeks later, after quite a few lessons in reproduction Miss Logan joyfully informed you that you had a top grade in reproduction, and that she is pregnant with your child!</p>" + "<p>You suppose this was inevitable with her obsession and that using birth control something that did not cross your mind, not with so many willing, if mind-controlled, women. Unless you plan to populate Glenvale with your children you must take care in future. There is also the possibility of less pleasant things like disease.</p>" +
				"<p>Despite this Miss Logan talks to you about earning bonus grades, and mentions her fellow teachers, friends at school, your mother and sister. She clearly wants you to impregnate every woman you possibly can");
			if (isSpellKnown("Transform")) md.write(", and with the Transform spell, some of the men you know as well");
			md.write(".</p><p>In the end you have to play along with her obsession, but of course there is little stopping you from actually doing as she wants. Such are the temptations and corruptions of these forbidden spells, after all at least two families here in Glenvale are descended from Kurndorf!</p>");
			if (isCharmedBy("OfficerSmith")) md.write("<p>Coincidentally, some time later Becky Smith also became pregnant by you. An accident but Miss Logan was overjoyed by her plan coming together and you breeding others as well. Becky was less ecstatic but in the end quite happy, and changing her hair style and colour to reflect the change in her life.</p>");
			if (isDemonGone() || wherePerson("Kate") == 9999) md.write("<p>Unfortunately there were some less pleasant things...</p>");
			else md.write("<p>There are also more pleasant things to play with...or in Miss Logan's obsession, impregnate...</p>");
			startQuestions();
			if (isDemonGone() || wherePerson("Kate") == 9999) addLinkToPlace(md, "but not everything went well...", 46, "type=" + (isDemonGone() ? "endgame1demonloose" : "endgame1kategone"));
			else addLinkToPlace(md, "why not indulge with others?", 46, "type=endgame1other");
			if (isCharmedBy("OfficerSmith")) {
				AddRightColumn(md);
				AddImage("Endings/endgame1-polg.jpg")
			}
			WritePlaceFooter(md);
			return true
		}
		if (sType == "endgame1demonloose") {
			hideSidebars();
			md = WritePlaceHeader();
			AddImage("Endings/endgame1-legion.jpg");
			addPlaceTitle(md,
				"A Demon Loose on the World");
			md.write("<p>The demon Legion escaped from Glenvale, taking with it your friend Leanne's soul...</p>" + "<p>For a while you hear little, some odd rumours of weird events but these <i>could</i> be just the normal tall tales and internet rubbish. Then you received a message on your phone. Jesse...no Legion standing naked with an ominous figure behind her. The message read,</p>" + "<p><i><b>We are Legion, each of us shall take a body, a corpse, a beast, forms fair and foul. Death and corruption shall be in our wake, thanks to you</b></i></p>" +
				"<p>She is right, but what can you do now, it is far, far too late...</p>");
			if (wherePerson("Kate") == 9999) md.write("<p>That was not all, and for you not the worst...</p>");
			else md.write("<p>You have to put this out of your mind, and turn it to more pleasant things.</p>");
			startQuestions();
			if (wherePerson("Kate") == 9999) addLinkToPlace(md, "then there was Kate...", 46, "type=endgame1kategone");
			else addLinkToPlace(md, "why not indulge with others?", 46, "type=endgame1other");
			WritePlaceFooter(md);
			return true
		}
		if (sType ==
			"endgame1kategone") {
			hideSidebars();
			md = WritePlaceHeader();
			AddImage("Endings/endgame1-kate.jpg");
			addPlaceTitle(md, "Kate Left You");
			md.write("<p>Kate fled from Glenvale, you could not convince or force her to stay. This is your greatest regret, while you have all the others Kate was your first infatuation or even love but you have lost her.</p>" + "<p>At times you wonder where she is, how she is living now and earning a living. She is in hiding, you have failed to locate her, so she has probably changed her name and maybe her appearance, but most likely she is just far away in a large city.</p>" +
				"<p>You have tried your magic and once got a vision of her, dressed as an exotic dancer, it is her new job, or just some sort of party? The vision was brief and all too little, nothing telling you where she might be now!</p>" + "<p>You have to put her out of your mind, and turn it to more pleasant things.</p>");
			startQuestions();
			addLinkToPlace(md, "why not indulge with others?", 46, "type=endgame1other");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "endgame1other") {
			hideSidebars();
			var ar = [];
			ar.push("endgame1-other1.jpg");
			ar.push("endgame1-other2.jpg");
			ar.push("endgame1-other3.jpg");
			ar.push("endgame1-other4.jpg");
			if (perYou.isMaleSex() && isExplicit(true)) ar.push("Explicit/Endings/endgame1-other5.gif");
			ar.push("endgame1-other6.jpg");
			ar.push("endgame1-other7.jpg");
			ar.push("endgame1-other8.jpg");
			var img = ar[Math.floor(Math.random() * ar.length)];
			var no = parseInt(img.split("Explicit/").join("").split("endgame1-other").join("").split(".jpg").join("").split(".gif").join(""), 10);
			var td = "";
			if (no == 3 || no == 4 || no == 5 || no == 7) td = "td-left-med";
			md = WritePlaceHeader(false, td);
			if (img.indexOf("Explicit/Endings/") != -1) AddImage(img);
			else AddImage("Endings/" + img);
			addPlaceTitle(md, "Enjoying Life More");
			md.write("<p>While the idea of enslaving <b>everyone</b> has an appeal there also seems to be a danger there. The history of Kurndorf and others show that sort of excess will lead to your downfall.</p>" + "<p>So you take care with your indulgences, acquiring new 'girlfriends' rarely, but that does not stop you from the occasional charm spell and then freeing them afterwards. They will usually assume a one-off night of passion or bad judgement as the case maybe.</p>" +
				"<p><i>In particular...</i></p>");
			switch (no) {
				case 1:
					md.write("<p>This woman you met at the Police Station, an aspiring member of the " + getProsecutor() + "s office. She is one you kept, the more control over the legal authorities the better..</p>" + "<p>One stange thing though, she reminds you of Diane White in some way, her attitude is similar. It is like she would like to <b>be Diane</b> at sometime. You obliged her, and made her a slave just like Diane!</p>");
					break;
				case 2:
					md.write("<p>The Park is a good place for a brief encounter, you have to regularly visit to replenish your mana and you can often find groupl of friends or family picnicking. These three were a fond member, you think two of them were sisters but you did not really question them much, this was just an encounter with three beautiful women in a lovely natural setting.</p>");
					break;
				case 3:
					md.write("<p>Diversity is a wonderful thing, and while you did not seek out such a mixed group, when the opportunity presented itself you had to take it, and them!</p>");
					break;
				case 4:
					md.write("<p>The campers you have met in the Wild Ranges were some of the first you recruited once you had decided to relax. A lovely group of ladies, though somehow the phrase 'Jack's House' comes to mind when you think of them...</p>");
					break;
				case 5:
					md.write("<p>These two lovelies you played with a number of times, you have kept it somewhat anonomyous, you are uncertain of their relationship with each other. You think they may be related, possibly even mother and daughter and it is that thought that keeps you coming back to them.</p>");
					break;
				case 6:
					md.write("<p>The church is an interesting place to visit but given encounters with demons and other spirits you feel uncomfortable there. Still occasionally you can visit and give a parishioner a revelation about their new " + (perYou.isBornMale() ? "Lord" : "Lady") + " and " + perYou.getMaster() + "</p>");
					break;
				case 7:
					md.write("<p>These three you met at the pool, a set of sisters and triplets. There was no way you were going to pass them by, expensive in mana, but three beutiful sister-slaves was irresistable!</p>");
					break;
				case 8:
					md.write("<p>The woman you have seen fashing herself in the general store is one you have played with reguarly. She delights in public nudity and you have had her indulge in a little more than that at times.</p>" + "<p>One stange thing though, for no reason you can quite pin down, she reminds you a lot of Leanne, a slightly older version, not her mother, but like another version...</p>");
					break
			}
			md.write("<p>...</p>" + "<p>These pleasures are a diversion, you always have your core group...well you might as well call it what it is...your harem of beautiful slaves.</p>");
			startQuestions();
			addLinkToPlace(md, "and finally", 46, "type=endgame1final");
			WritePlaceFooter(md);
			return true
		}
		if (sType == "endgame1final") {
			hideSidebars();
			md = WritePlaceHeader();
			var img = perYou.isBornMale() ? "endgame1-final-male" : perYou.getPersonGender() == "woman" ? "endgame1-final-female" : isExplicit(true) ? Math.random() < .5 ? "Explicit/Endings/endgame1-final-futa1" : "Explicit/Endings/endgame1-final-futa2" : "endgame1-final-futa1";
			if (img.indexOf("Explicit/Endings/") != -1) AddImage(img + ".jpg");
			else AddImage("Endings/" +
				img + ".jpg");
			addPlaceTitle(md, "The End of This Road!");
			md.write("<p>You have control of the Sacred Book of Control, you now have a harem of beautiful women");
			if (isCharmedBy("Tracy") || isCharmedBy("Mom")) md.write(", including your own family,");
			md.write(" and life is good. You have as much power as you desire, and your harem to satisfy your carnal desires.</p>" + "<p>As long as you can avoid the temptation for more and more power you are assured your place of dominance and control. You know the path Kurndorf took and you just have to avoid those excesses and straying into the areas of magic that corrupted him. Demons are much too powerful as are most supernatural beings, it would be best to keep yourself to mortals only");
			if (isCharmedBy("Vampyre") || isCharmedBy("Tina") && per.isVampyre() || isCharmedBy("Ghost")) {
				var s = isCharmedBy("Vampyre") ? "the vampyre" : isCharmedBy("Tina") && per.isVampyre() ? "Tina" : "Keana";
				md.write("...then again there is " + s + " so you have already crossed that line..")
			}
			md.write(".</p>" + "<p>Well, that is it, your adventure is essentially complete, while there might of been more you could do, you have done all that is needed for your protection and power!</p>");
			startQuestions();
			addOptionLink(md, "Thank you for playing",
				"DoNewGame()");
			WritePlaceFooter(md);
			return true
		}
		return false
	};
	perYou.showPersonChat = function(bGeneral, md) {
		if (sType !== "") return;
		if (this.checkFlag(38) && !isDay() && getDay() == "Sunday")
			if (wherePerson("Tess") == 170) addLinkToPlaceC(md, "talk about relaxing from your exploration", 46, "type=endgame1start");
			else if (Place == 122) addLinkToPlaceC(md, "talk about relaxing from your exploration", 46, "type=endgame1start")
	};
	perYou.handleItem = function(no, cmd) {
		if (no == 15 && cmd == 2) {
			if (this.checkFlag(29))
				if (sType == "contemplate")
					if (CastClairvoyanceSpell(undefined,
							2)) {
						dispPlace(Place, "type=hydromancy");
						return "nofooter"
					}
		} else if (no == 18 && cmd == 2 && Place == 53)
			if (perYou.getPersonGender() == "woman") {
				if (!CastTransform(1)) return "handled";
				sGender = "futa";
				addComments('<img src="Images/Player/' + sAvatarFolder + '/xf-futa.jpg" style="width:35%;float:left;margin-right:6px;margin-top:1em;margin-bottom:2em" alt="futa">' + "<br><b>Transformation</b></p><p>You cast the spell as you look at yourself in the mirrors, and you feel an incredible surge of lust wash over you. For a moment you thought you heard laughter, but it is lost in the strange feelings swelling in your body.</p>" +
					"<p>Your groin swells and you remove your lower clothing, revealing that you now have a large cock grown to replace your clit.</p>" + "<p>You feel it start to stir and stiffen but you try to take your mind off it....");
				return "handled"
			} else if (perYou.getPersonGender() == "futa") {
			if (!CastTransform(1)) return "handled";
			sGender = "woman";
			addComments('<img src="Images/Player/' + sAvatarFolder + '/xf-female.jpg" style="width:35%;float:left;margin-right:6px;margin-top:1em;margin-bottom:2em" alt="futa">' + "<br><b>Transformation</b></p><p>You cast the spell as you look at yourself in the mirrors, and you feel an incredible surge of lust wash over you. For a moment you thought you heard laughter, but it is lost in the strange feelings swelling in your body.</p>" +
				"<p>Your groin changes and you remove your lower clothing, to reveal you no longer have a cock, you are a woman only once again.</p>");
			return "handled"
		} else if (perYou.checkFlag(13)) {
			addComments("You have already transformed yourself, it cannot be reversed.");
			return "handled"
		} else {
			if (!CastTransform(1)) return "handled";
			perYou.setFlag(13);
			if (perYou.getPersonGender() == "woman") addComments('<img src="Images/GenericSex/be c.gif" style="width:30%;float:left;margin-right:6px;margin-top:1em;margin-bottom:2em" alt="BE">' +
				"<br><b>Transformation</b></p><p>You cast the spell as you look at yourself in the mirrors, and you feel an incredible surge of lust wash over you. For a moment you thought you heard laughter, but it is lost in the strange feelings swelling in your chest.</p>" + "<p>Your breasts swell, growing larger and larger. After a few seconds they settle down to a <b>much</b> larger size.</p>");
			else addComments('<img src="Images/GenericSex/cockex a.gif" style="width:30%;float:left;margin-right:6px;margin-top:1em;margin-bottom:2em" alt="Cock+">' +
				"<br><b>Transformation</b></p><p>You cast the spell as you look at yourself in the mirrors, and you feel an incredible surge of lust wash over you. For a moment you thought you heard laughter, but it is lost in the strange feelings swelling in your body.</p>" + "<p>Your groin changes your cock swells, not in erection, but getting larger and larger. After a few seconds it stops growing, but the lust you felt then makes in grow a different way, hardening until fully erect, and <b>much</b> larger than previously.</p>");
			return "handled"
		}
		return ""
	};
	perYourBody = perYou;
	perYou.startQuest(4);
	nMana = 0;
	nMoney = 20
}

function initialiseZoey() {
	addPerson("Zoey", 0, "Zoey");
	per.whereNow = function() {
		if (Place == 414 || Place == 412 && sType == "zoey" || sType == "callzoey") return Place;
		return this.place
	};
	per.showEvent = function() {
		var md;
		if (Place == 414 && sType == "transformbreasts") {
			CastTransform(1);
			this.setFlag(1);
			md = WritePlaceHeader(true, "", "black");
			showPopupWindow("Transformation", '<img src="Images/GenericSex/be c.gif" style="width:50%;float:left;margin-right:6px;margin-top:1em;margin-bottom:2em" alt="BE">' + '<p>You cast the spell and Zoey cries out, "What the hell is happening?" and pulls apart her top. You see her breasts swelling, growing larger and larger, her modest sized breasts growing to quite large.</p>' +
				"<p>As she groans you thought you heard some laughing but maybe it was Nina. Zoey gasps as her breasts stop growing, and she remarks,<p>" + '<p>"Well, if this is permanent, I am going to need a new wardrobe.", and she rips her top off and continues, "How about giving them a spin!". You happily give them that and more.</p>');
			setQueryParams("");
			WritePlaceFooter(md, "", true, true);
			return true
		}
		if (sType == "callzoey") {
			md = WritePlaceHeader();
			this.showPerson(perYou.isMaleSex() ? "zoey-call-b.jpg" : "zoey-call-g.jpg");
			addPlaceTitle(md, "Dial-up Delivery Girl Zoey");
			md.write("<p>Zoey arrives and she glances around and then gestures towards an out of the way place" + (perYou.isMaleSex() ? ", a small grassy area" : "") + ".</p>" + "<p>She removes her clothing, despite being in a public area and then she starts to do the same for you. Her intention is clear and you let her deliver her service to you, a skilled if very public " + (perYou.isMaleSex() ? "blowjob" : "pussy-lick") + ".</p>");
			startQuestions();
			addLinkToPlace(md, "let Zoey continue on her way",
				Place);
			AddRightColumnMed(md);
			this.showPerson("zoey0c.jpg");
			WritePlaceFooter(md);
			return true
		}
		return false
	};
	per.handleItem = function(no, cmd) {
		if (cmd == 1 && (no == 52 || no == 64)) {
			var s = getSoulBoundCrystal(no);
			if (s != "")
				if (this.isHere() && !this.checkFlag(1) && perKurndorf.getQuestRitual() >= 200) {
					if (!this.isCharmedBy()) examineItem(no, "The " + s + " trembles weakly, you suspect you need a magical link to Zoey before it will work.");
					else if (Place != 414 || sType != "visitzoey") examineItem(no, "The " + s + " trembles slightly, maybe it would react better in another location with Zoey.");
					else examineItem(no, "The " + s + " vibrates softly the closer you get to Zoey.");
					return "handled"
				}
		} else if (no == 14 && cmd == 2) {
			if (Place == 412) {
				if (sType == "zoey" && !isCharmedBy("Zoey")) CastCharmSpell("Zoey", 414, 4, "type=charm1");
				else addComments("You read a spell.... but it fizzles.");
				return "handled"
			}
		} else if (no == 18 && cmd == 2)
			if (Place == 414 && (sType == "visitzoey" || sType === "")) {
				if (this.checkFlag(1)) {
					addComments("You have already transformed Zoey!");
					return "handled"
				}
				if (!this.isCharmedBy()) {
					addComments("The spell washes over her but nothing happens, you seem to need a magical link to her");
					return "handled"
				}
				if (!CastTransform(1, true)) return "handled";
				ClearComments();
				dispPlace(Place, "type=transformbreasts");
				return "nofooter"
			}
		return ""
	};
	per.isPhoneable = function() {
		return this.isCharmedBy() && !this.isHere()
	};
	per.callThem = function() {
		if (!isDay()) WriteComments("You call Zoey but there is no answer, you would guess she is at home and the number you have for her is probably her work number.");
		else if (!isOutside()) WriteComments("You call Zoey but there is no answer, you should try again somewhere else. Your phone is not the best and you are getting a poor signal here inside.");
		else {
			gotoPlace(Place, "type=callzoey");
			receiveCall("", "You call Zoey and she immediately answers, and promises to be there in 15 minutes and deliver you something really <b>hot</b>");
			WriteCommentsFooter(bChat, bChatLeft)
		}
	}
}

function ShowPlace1(stype) {
	var md = WritePlaceHeader(stype !== "", stype !== "" ? "" : "td-none");
	switch (stype) {
		case "":
			addPlaceTitle(md, "The Start of an Adventure", "", 0, true);
			md.write("<p>You begin your adventure as a senior-year student from Glenvale Secondary, a school famous for its high academic achievers and its teachers' poor sense of humour. " + "Every year at least one student graduates to go on to Harvard, Edinburgh or Oxford university. Expectations for staff and students are high and those who falter soon retire from the pressures of the county's finest educational institution.</p>" +
				"<p>You cringe a little as you walk down the school's main hallway. Your grades are borderline and several teachers are beginning to ask questions about your ability to make it through your final year.</p>" + '<p>"Hi ' + perYou.getPersonName() + '!"</p><p>Glancing up, your thoughts are interrupted and you see your good friend Amy. She is dressed in the optional school uniform, optional meaning that only a few of the more serious students, like Amy, choose to wear it. You and Amy exchange a few words, but you are clearly distracted and Amy does not want to be late for her part-time job at the Gym. She brightly waves goodbye and you part.</p>' +
				"<p>In your last class, Mr. Beasley, your history teacher, talked about the darker era of Glenvale: a time when the cult of Carl Kurndorf enticed, or as many rumors tell <i>enthralled</i>, many of the young townsfolk into performing unmentionable acts. The cult spread like wildfire among the community until regional officials stepped in. The police arrested Kurndorf but, due to " + "the lack of evidence and the uncommon generosity of Magistrate Anthony Melin, Kurndorf was released.</p>" + "<p>Chaos and calamity spread through the town amidst rumors of magic and debauchery. There were even rumors that Kurndorf possessed a book that enabled him to turn even his most critical foes to his side. Though few people nowadays believe in magic, you do. Stories from your family abound with tales of magic and the occult. The scattered descriptions of the book have led you to believe it could be the <i>Sacred Book of Control</i>.</p>" +
				"<p>Mr Beasley has several times mentioned an extra-credit assignment on the Kurndorf happenings and especially on details of the <i>'Sacred Book of Control'</i>. <b>You've decided to check the History Classroom for some information</b>, given the selection of books about local history that can be found there.</p>");
			if (nFromPlace != 1) {
				showPopupWindow("", '<img src="UI/logo.png" style="width:90%;margin:auto"><br>' + "This is an adults only game and please do not go any further if you are under 18 years old.<br><br>" +
					"This game's mission is to find a mysterious book of magic and learn the spells within " + "to improve your relations with the locals, your friends and relatives, or just to simply gain power over them.<br><br>" + "If you find any mistakes or have ideas of your own then join the <a href='http://hypnopics-collective.net/index.php' target='_top'>Hypnopics Collective Forums</a> and join the discussion.<br><br>" + "<b>Some notes on game play</b><br>" + '<img src="data:image/gif;base64,R0lGODlhKAAoAOMKAKioqKmpqaqqqqurq6ysrLm5ubq6uru7u/39/f7+/v///////////////////////yH+EUNyZWF0ZWQgd2l0aCBHSU1QACH5BAEKAA8ALAAAAAAoACgAAAT+8Jkgqr046xzMO8JAbWR5BYMABqjpkuJothbLXuJrpqFc8zzdbOMTlooYpDFZQY2czaVrEGNRpcdaIKFQJG5R7OnU7fqUwmBvUFaI1OosJUCAvgXttcBZ3/tJMnEVeRlBaGE/eylUXF5XOTljOyGIbGWGFYs6KXMYKXlxnYKeI5ylFI0Jik0UPDQlIl5ts7RlXK87AbUKCF5cvbW4LrJdjcTGyAovQALJbQnGxbaU1LCITm1QYaOFpZSdeGVRrdTC3ThqhJlq5jiZJwBB6gMAPswbQa6R4V0/3u9ScuiCpmAONzEy1B1CWCEVIjE4fPhSlghiE0w1LOyz6AkgRw4jfs6E/JgRkI4WCy22QgGApIl431yCTFGgnUwRBSSk5NjhQQQAOw==" width="30"/> - these indicate that a bar can be expanded for more details.<br>' +
					'<img src="UI/themes/theme0/collapse.png" width="30"/> - these indicate the bar can be minimised.<br>' + '<img src="UI/apps.png" width="30"/> - Check your phone\'s apps for settings and your alarm clock. Check the themes to vary the game\'s appearance.<br>' + '<img src="UI/addressbook.png" width="30"/> - In your phone this lists all the people you know, and can allow you to give them a phone call if the icon is blue.<br>' + '<img src="UI/walk.png" width="30"/> - these buttons move you to another place.<br>' +
					'<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAATwAAAE8CAMAAABq2/00AAAABGdBTUEAALGPC/xhBQAAAwBQTFRFAAAAAgICAwMDBAQEBQUFBgYGBwcHCAgICQkJCgoKCwsLDAwMDQ0NDg4ODw8PEBAQEREREhISExMTFBQUFRUVFhYWFxcXGBgYGRkZGhoaGxsbHBwcHR0dHh4eHx8fICAgISEhIiIiIyMjJCQkJSUlJiYmJycnKCgoKSkpKioqKysrLCwsLS0tLi4uLy8vMDAwMTExMjIyNDQ0NTU1NjY2Nzc3ODg4OTk5Ojo6Ozs7PDw8PT09Pj4+Pz8/QEBAQUFBQkJCQ0NDRERERUVFRkZGR0dHSEhISUlJSkpKS0tLTExMTU1NTk5OT09PUFBQUVFRUlJSU1NTVFRUVVVVVlZWWFhYWVlZWlpaW1tbXFxcXV1dXl5eX19fYGBgYWFhYmJiY2NjZGRkZWVlZmZmZ2dnaGhoaWlpampqa2trbGxsbW1tbm5ub29vcHBwcXFxcnJyc3NzdHR0dXV1dnZ2d3d3eHh4eXl5enp6e3t7fHx8fX19fn5+f39/gICAgYGBgoKCg4ODhISEhYWFhoaGh4eHiIiIiYmJioqKi4uLjIyMjY2Njo6Oj4+PkJCQkZGRkpKSk5OTlJSUlZWVlpaWl5eXmJiYmZmZmpqam5ubnJycnZ2dnp6en5+foKCgoaGhoqKio6OjpKSkpaWlpqamp6enqKioqampqqqqq6urrKysra2trq6ur6+vsLCwsbGxsrKys7OztLS0tbW1tra2t7e3uLi4ubm5u7u7vLy8vb29vr6+v7+/wMDAwcHBwsLCw8PDxMTExcXFxsbGx8fHyMjIycnJysrKy8vLzMzMzc3Nzs7Oz8/P0NDQ0dHR0tLS09PT1NTU1dXV1tbW19fX2NjY2dnZ2tra29vb3Nzc3d3d3t7e39/f4ODg4eHh4uLi4+Pj5OTk5eXl5ubm5+fn6Ojo6enp6urq6+vr7Ozs7e3t7u7u7+/v8PDw8fHx8vLy8/Pz9PT09fX19vb29/f3+Pj4+fn5+vr6+/v7/Pz8/f39/v7+////AAAAAAAAAAAAAAAAluOFBgAAAQB0Uk5T////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AFP3ByUAAAAJcEhZcwAADsEAAA7BAbiRa+0AAAAZdEVYdFNvZnR3YXJlAHBhaW50Lm5ldCA0LjAuMTXdYP5PAAAYR0lEQVR4Xu2deYAVxZnAawZQB5BLcbgcBC9EGBCIK7qYeG1WN8PhwSqSlVVxUUlAZTl0iGfUVTa4ImhURA2CUVcXRE0kJvEGBBEQBLmHYZiLGeZ6r6v6j9nvq/4ec7033e91V79uqF8MMK+r66vvN1Xd1edj9ZqU0fJcoOW5QMtzgZbnAi3PBVqeC7Q8F2h5LtDyXKDluUDLc4GW5wItzwVangu0PBdoeS7Q8lyg5blAy3OBlucCLc8FWp4LtDwXaHku0PJcoOW5QMtzQTrkjWLeM4rq9hWf5U3sRMmqoNNEiuIXfsqL9bgO51xx/aS7Z8x0zqxG0EcS/HnGXbdcf9XZJ1HdORTLF/yTl4u5dbrojqXfVwtTAKYp/3ICFD0KfSSxfjYFFzWblt4xorPP+nySl58DaZ10/oMbi6IxFbHk3SNMLrhp1hV/99DAE/E3REGV44u8bOwRHSd8VEXZKkMc+dPELIiVW19/J8VWiR/yclgm63nnHoHdQy3QA8XeX51m6VOPD/JgB9t2zLd1psENylEZ8PvhonbD2Hagz4ddr3J5UyGP4e/UGdgpPNrGJQZjAJG3hmb6sedQLa8DYyeML6XcfEOUjG+XwTKpDcpQLA92sl0WHVHe45rDRcWCbuoPO9TKg7nd6WsM9cO1OTB8+Ze9YINB7VCE0urhkOKszzk3/O95ZpSLz88Ee6NU7jdUyoMxO2yT8ulJIoTx3fAMlpGh0J5CeeCu7y7ue6+LAccd2/swlhlKeXkZrPfHsPGhXHwH5PGPezKWR+1RgDp5cCy7SsD0jnLxHWHATnfFCSp3GsqqZqzNvAjlkT6iTzKWQS3yHlXy8lnGpYfT1uticHEY9vhTqU2eo0oeYz03pG/IxoBDtfU91A1cdfKejao/i2KLENH56s4RKJLH2NAKPMcbAMqHKOt6aurNY+3e8+xEsUv4220zVHUR+ttbGLukCi9UUPvTy5ELVXU9JdXms7Z/wLN3gZDH+esZina4SuQxNqKYmp5+uCgarqjrKZL3WECGLADb3odCJG8iO2E3tTwAwPZjR1s1sxUV8hgbZQZgjkfguYmRarqeGnn/xYOxs4gxJzTy8ljWX4LlzlzdXsmZKQXyGOtXGJQ5HrG/r5Kup0TeWJ7+cwJN4OPCI+8+anNgEPeGR95z1ObAIBaER94qanNgEKtCIm8q6/QjtTkwiJ0dVRzeei9vFDttD7U5MIg9PVTce+G9vBzWt4DaHBxgrqLgpikV8gYcpCYHBlF4Xljk5RZRmwODODhEy0sVUZSbJnl5uTnJwNjgQ9TmwCCKBjNG7XNGrpNj4Vbl5bGUCGLPA3mp0LrCxPIm0vpt+w656MpfjBk9phmjAfpnU0bfU05tDgy8bNpYat1RErZ/zJi8Ky8ackYbyr+VKU4iefIZsY79bnx82TcFxSXllVVHnFJ1pCZYZwUQUe04AShYebi06MCGZY//a//20h85aUHcBbLTtR3x9KdFeP2Q42WAZAjYyTwAG0SNc4i8yYoXffrkcHwsIcFZ/HjysPT5938v7/7HE3PW4xNUqz1WWwMFtx4xSBZYjfMtsweikHyS05iW8nIZyxz0u4IIh5B49QRUJHk9IoCjNok24W9fdhUccXgFJFrwm8GZoI/8NKL5R/jMSdeFRWBN1qSRFD7bBfSRogaafTIK9hJ37cX+quU1gou9U2Df0Xzi0lQedLv+S2vxKQYtrzHgo2bpGS2GbpMfYel1W6PCgAFPa2kkMBQ534bHDGTKotFPsLnLml0RmIvVQUOIyplZTe01+gE2d09WB+dKf+AQvOrxpvYa/s1Yh7eieluXGJi8RN46qbG9o/9krP0ivZNtBXnEYCzo2Mhe7F85rO3jNVRMkwgh6h5u22CP/gE7kjk1emJsB0xDauY0nGgheYyNqIC9MZXRJADncOXDjj4WY8mDufE33NDy7IChKcSanNjAlX9NZO2WanEOEcZr7ehATcpjbOxhLc8hMFm+hroe/pnDuqzTOwuncBFd19Wyh38wNk1P8BwD+1XjnqPyGOu1MZmzhRpzY29pT8q7LwojmT7XOCB6H8nLYZ1+BHV6h5EE4sdOOFNm0PFG1+EJe00S1I3GrsdyWeZyPWSThS/PhMMMxli3Qi0vSYR54BToeiBvoJ7jJQvsIq6z5F2j5SWLEGKRJW9yMNxhK+SECVoG007rD/wbPoE5PBGQ+agQG7oyvJ/nHmxfMJB+0BR6s9zhTQuxD+CjYMiDBhVdAOoYm2O1KyAII3po2+dvzX90zvTbb77+5snTHnjkxVWfbyuNSocBaSq0IjpWynsgMPJEzYHVz8248uzeHWTDGujY8+yfz3hhdVF1cOSJfNmyB9I7FHBgwv9Mvn/F3Cu6yBYl4tSr5n5QKO/AwYFDIzldLJNNSnPPwxM6onzd7EutGwlj4FkLgj6xyL78/nVH5PhN81HR17I5+WmWZ/LDL17e0OXIWEtoOczqL19cIW8JSWu7d8i25Kf3N1i6/Dr5QnyENCWGyrGu498uS/OwPSgbkp+mNghhCF7w5ADZCID82EGl2YCnCzneuokbQKrRV2pkKx5IjzzY8PPShfKWVYDMOIPWGbyonKt/ZXoihGxDfnp+c4LveKiHbEBy5iysFXs8uEtOqdOCbEGahm3F4v4yfCrqEGvl/ovT9aq5WM/zFXmLuTC+HieDp6oOsSq4fg1ek0mDQBndZ3ny8tPuadaX9pCGVJF1dJi+F/Y9/k8ZZHCf5QnTqH1XfiGQW3WIrGfI+3XC/x2HDO33sBWHvel2FrKmDjMrj/2eB9s6IdZdKcNS8u6RtV2zHjd8FMYfZFwf5Qkuoit6y6iUuRfI+s74EI7zKIw/yLC+yiudKWNS2l4h65xbemzLM8uuliEpZ++QtY719+tyZEyf5MHhmFEkJ3eUsLdgxeOL/TzcwIh+yYMN+rbhGI+y9Rqs+sLtPs73MKBvPY9vH4LhKFfvwcqHbj825fGNcmZMmaoAqx++mcKpB8P5IQ+PZrfLF0xQnmrAAEN2+HXXEkbzQx4czRb9FGNRlqrAEFcU+3SohsH8kVco39FCOaoDg4wpPrZ6nqj4Z4xEGaoEw+RVUli1YCjV8nB7V/cIBqL81IKBnooYPmz3MJJyeXBAuwy/8JiyUw1EynrHj8myH/JMg2843T930l6f744ReZxH5DkoSk09GOzqSPjlYQa8+l6MQpn5AYabVY3nv6xWKALDKN/mrcCbACkvp8iGNUCfOgXW6LbSMBRfUpUtUyzvAN4SQFk5QjaqJbTUEVB88AHV36srW6VWnrgHY1BStsgGSbK6Zffu2y+nV3Y364IHQoXswcL3G/QGMVXIJqnc5gm+GW9UpJzskM0BOl82ZdHqDdv3FpUd3L19/epFk38qX+eHUEk7oGSHrYofvpbtUSqv/F8cZywbw9pf/OineP8d7GnkNgvn2EJU/u3BkdZy55VdWxbyYcufxwiUUKvIprAek78og50k+IJug/d+HoUf+nBSEre2QLGTloRbnijES2WUT2vIhrDuD/9giZJ3jcX+gx8B/OuH/G5WQVqrNaBU3xJqhhpkS1TJAwXGw44zZSxnXgWtmRBR/gR+R7yTOrHUk4bKPa5siCJ5+OLDgrOhfsqmFbAVWTdsdjCpFcZ3o7OwOK3ZClDovEMqzw9gM1TJw7H2P07TZP3eqnZwRAAj2qxeJjsfrdsKUOh5HO+qwFYolLcH78CjVBIi2zB6F27VHMjDPck2eXLQScXDChz05lSRjVAmz3zRWYqMTSt2PieDzcHBu+VaVENCoMgrCm/BkG1QJc+sHuQsw67zjCTuM8F78YzHTnZW9eDakPY8/oGzBLu/HjHk3MQZcuJSu7i7s8o/CmnPi9xunx/GfyOCOhzLw6Kc1yzGVamWRECJKRFazXuwAcrk7Tn6wqqEYPjHUryf+De4MtWTCMb678c5Nq3iLRhflTzjBdvkMPq0mhQnstX/gatTTQmAAi9B7eGTF2nxZtzmYPCrS/AhnlTghy7HCqiu+MDyayMO5o8pgdFVyfuqk4N+kb0XSqbW84TYeRrUQHUlAHbl63FmrQJl8qC9c+0yg+UnLXGxPRL8JdsrmrB8Qdi2ebiducJBYqOrUk8MOlSl7clCWH4NzqtVAHWrkWeKWrtRC5FP3+FiRMGUhW/tCbVQffFhrJuqq5DK5HHxuX1a7NGIm9v/wV4EH/Sn+uIDy7+h8l4DVSuSZzxhkxYs7u36W6r4PruuB4vnhWxvy3nVVfZdYrbrpIQxA+qhGuMDs6HqcMkT5s6zbJPqs9X1hlzwLb1s45y5N2RTFb4aKqbmxwUWT3V/5zoXUTzOoDrjAov/oub6LdSspueJ+fY5/c39aIJ9xsf2gRaGbNjifQLU+vgwNrDGg8mrENX224eZYZM31rY/zEn1oLYRONfDe7Co1rgwdkO4tnkiMtRW3koP5OEXs71jK29YuLZ5fF9nu4xO3m0angyn7Sfbheqs5ltPVckTXzT5upeWMHYZnk6n4q4QF9uFar+OinqLKnnmClt5k51canSCuNUu1IkfUVFvUSZvOdRLjY8HLH3co45n8odsY71LRb0FKlYj71XbhN6mku7BF9lRvfGApcuopLdAxWq2ec/bDaUum6ioa/jGDnbBFlNRb1ElD08jU9PjwljvbVTSNWJLtl2weVTUW1TJE9Pt8um3i4q6Z7vNJU6Yj1NJb1Em7w67fAbglR9v2HO2XbBfKzk+UyZvkl0+gw9QUdeIggF2waaES559z9tHRV0j9pxpF2x6uOTZnFSBbd5OKuoa8cPpdsHuD5e8R+3y6enZ3pZv6W4XbCEV9RZl8vCd/a3g5TxPbGhvFyxc8zzxGtRLbY8HLF1BRV0j3raNFa4jDPOPtgk9TCVdw22u3cLS96iot0DFSuTx90+0G0q3CevxKNeIW+xCheysCl/T7KvDm8PYKK8ehzUutAvVwbPtaxNUyRNFjb+9OQ6wx9jh0fxhq+1J6+xiKuotyuRFBtllxN716I7NN6EuqjUujF2kZJqnTp643lbevVEPLgAJwW+1lXdTuOSZ4t7WM4KUzq1yfwMO56Kyj+2vaVbIep65ECqm5scFFn/i/qZDzo1V9oFeCJk8vtY+pwl1rpMSog62DzaBstaF7KK3fGaPmh8fxnpscb3LEHy9zYEtxDlnT8h6nqgeZ5sUm+HBDsNudwFxxit6/kydPCe3SfXYBSVpjdQQ2/HJZaoxLrB4gUfXOJsDVSvaYfA1NllhWg9FXcqLznYQZaMad8rkgZOozTUtTKvrV+5u6OafwYGMXZTeityplGf+3D4vlleW+pASBi/B931TbfGB5WM9OpJpAdStRh609ykHiZ24JPWexwWfh82n2uIDy58JXc8DNnW1SQwz67I+9dTEGvvXozF2yrYwPjIa+Se71DD4pQeSeco7BugQxu5/sAuAEUZHFI1apfK4zQ04AEaf5uSVIC0AeUcm4epUUwKgwNtYWAkYXpU8s/Bcu9ykvelG8vLAXfQuXJnqSQRj5x+SxVWA8ZX1PJkeZZEIjL8wkvyRBq/5Ha5KtSQCSkyPykGuAmyAKnlCfGKfHubX/qkITNmcJ4hfJFT9GH6hK9WRECjyd0VjFoDa1fU8YQx1liCbUcWdv5QGX7hQOQ1XoxoSAkV+UkdrKQCboKzncfF7ZxnC4Dro/Kwy/FIK5fbOSdWLw/pGHy5KfuIgRalv8Brn8owvzsNVaO3EQJmRJercKZWHvOQkSWmv1/wyOM7F18bRqi0ADSIKZUqeli9wpHVbAQq9rrDjKZdXjl9fS7m0gmzGNZvRXuLtO27rYMyux2Nmh5VeUKFoRyuR7VAoz+krQ2U72k/eiAestGpLYCdrbJgkXz3osMpXW+vJrpENUSnvoLOuR/o6//rbGlqzJUJUf3OX9cpfWqdVoNiQMuHVwx7xkE1RKC/Kl+AroimfVpFNYd0nroShBoMXkoZBStVAhxTi8LsTnL9uFavLWqZwzAKyLSp7njhyi8NsY/pYj5uWf1uJWz/8T2KK8g1v3EDv+XVe2ZRqhXsLQLZGoTzD5D90cZxwTB/rNuK2R/64trCopKTkUOHaNx/99+HU55KpqeuPKne1gGyPyp4HM9oHMQblZI9sEdGpZ79eR99rjlAZe7DwEymcrEkK2SSF8pDiCyEGJeUI2aiW0FJHQPF/LFX9la2yVYrl8fc6J5m6hWwbQj8nAazUeZXcWqpENk6xPEM8h1EoLz/AcC+rOxUVA8OolgfzM3yhmX/2MNi4WpzthF8eTDi2JftlLK6AWIN2KhaH+CEP3y37of11Ls+ASD2+9OP7vX2Rxw1R+1sMRNmpBQPNi6j+/h8EI6mXZxpGVL6QnPJTCYa5tw7cHRs9DxHmYQcv5vUADHK3P9+T6Z88LorHYCzKURUY4toSH3odgsF8kQeboIJhGIyyVAMGuOyQ6ilKDIzmU88TfBNeTFNpD6sftkWezfcDDOeHPESIHWr7HlZ+4U5/xCEYzz95xsEbMR7l6jVY9S8PefNyL0dgQL/k4cgtvENGpHS9RNZ7VxFMiyicemRIv+QB0ZopMiRl7B2y1rtroXcfmz0P4Wbdf3fFmJSzV2CVpy6o8297h2BQP+XhrWF/ktf7vdQn6xv416hPU5QYMqyP8uRlsF0TZFjK3D2ytkl75UU3P5FxfR22OOc78qx1PYeSd4es6ZTnq+G34tP8LoaM7GfPQ4QZXYF3AAEkIHWsai563/DhFFRzZGj/5Zm85qkcGZscpIqso+8ztUpvq0iEDO63PNxtiOimX+K9na70yfU73LrZwC0p1e0jMrzv8uS2j9e9cr4Mn6o+a+Wh79Th1eF02JPx0yAPEWbNK/JgNyV91oojlvo8t2uMbEG65OHh2u8HyyYk6Y/WueCVIuh0VJ3/yDakSZ60x8tfu1g2AiAzdlBp9rNXD+NoPT7lWZkL01j3q3NkOwDykxgqxwZO3xiR95Gmz116ex4BCve+MS5bNkVCnppDS4Hu49/c7+MJgETItqRfHhfG7pdvp52vBRmzoM8kQyYv3sN9O1vcGrI56ZeHGz9RV7Fp4S/64aPbiTj53AmLNh+WjwsFwF0g5IE+3HJJh9GCL/8we/zIPrJdjTl95E2zln9dAIMVXxwHJdO5sSNkwx4IQEOaIvZ/9cn/LX/pmcfm/nb+y8tWrl67H3UFjYDKwyMQqzPC/7Gn4TEELQoOJC94WM7wP2kNN3PWguAQseQF67eKjcGOBn+jupjAwMkrtuQFr2FhYJeUlx+snhcWvpXydM9Lif+V8vK1u1TAl+4EbocRBsCYYV0DnBGAg+ywwUUZvhKHsTuDN4cKPnxrLynvWj1sk0aIZZlsIsi7QMtLFs75bYzhqbIhVVpeknCzKlfKy2i7SstLEiFWtWV59ThwJ0foM41DePR2PNmNfa9PKR580+caJ5TmsE4oD+zNC+AZn0AjnoYDM5I3aH8QTzYGmL2DWAZemKqvz83InK/lJcX8NizHkgddL2eflucU2D3sP8O6Nop/5DE2pzYA1/JCghGZw9jUmLx62HX83b/nF0IO53/tIgctyYOBe4ln3/p5rCMKLond0GD9NRW/3Z3rU1O2GNwUt2XAwYUk5pBlLomm4abokMEFj7ySGet4MXlgL3ulninbAR1vZY+j7o7KA3t9v9TybODis74N7hrkwXwl+xvY7GmBieDc5OuzWWyDBzRoBHtn/dnPRy5DBhyEGX8+q7G7RvLQXq8Veo+bCM75ip5N3DWWVz+KsS5zy6isphlGeX7HTJZLriSN5WHfa3PdPkPgTau6BxIwXPHWcb5vXBvGRpEpiyby4EfGzlxSpU+NNgJdcHHk9f6MZTTpdy3k1edC5xu5tlafHW0Ael3dWnxaJCefJMVoLk92vlMmb3H+LQHHOjBqv7/9VLBCfhoR5yPofKzdzR+UwuDFeR9yXG0BIVeZM3Q5/EfZhze2BSON97Ix4sjDU1Sgb+B/flEYMbmB9wPjPcLHC4308UjRZ7MGnJABI5bMNCWuvPr6TiyDZWYNvfmlbystbcfPKMZxJv9fsfHFCRe0+ir6RJ9PBXuSNn2vuPbf7rxv5qyZxw8z7p543c/OgJmJJH6vQxLJq6/Pn5pnPcp+PJNYHJJYHpHf5B3ZxxPyMkWr2MrTJEbLc4GW5wItzwVangu0PBdoeS7Q8lyg5blAy3OBlucCLc8FWp4LtDwXaHku0PJcoOW5QMtzgZbnAi3PBVqeC7Q8F2h5LtDyXKDluUDLc4GW5wItzwVaXsrU1/8/kJ1Yka/ScfEAAAAASUVORK5CYII=" width="30"/> - click this icon on images showing it to take a photo and set as your wallpaper image in your phone.<br>' +
					'<img src="UI/themes/theme0/bookred.png" width="30"/> - if the book turns red or blinks try examining at it.<br>' + '<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABAAgMAAADXB5lNAAAACVBMVEUAAAD+/v7///89+DgTAAAAAXRSTlMAQObYZgAAAVZJREFUeNptU7sVwyAMlClcMAIjeArPwxSMQJ3KhV8eaMqgk4RJXlSY8xn9zhIRvd5kpmhnrvpu6GBuShjiYUooCnIUeTcU5agWgvmi9O1yS6RBw+Rys0gx98uiZomwCTwlSicghoEncYtKXBKQ7GS2L4MoG5udAUG1Iq1Pgjb3YEA6bsnxLuElKVKjVIN2h2O/KZbdBBmeNVwUSpLSho1kdyj4Mi7s1QC6Hn0dDd2aUONe7o7kwDU8CmTpTmRIFU17hP9LJDxBxKGx00Y0EMWJYN6nE9uS3G5o8oWYJa3P/0T4JeIvcSDcQmQV60mrM+Jpi1fnWp1yjWbpaO5oNJtD+3ul2X7ymXMi+mR/a/pFdCeyVcNOzGqKvjtaR9tCzQVSsA7MulnPrvEzdDw3y8bS5mOxS10fa6i3P4RKePl6RP/ZvkD+s8lXjOAicvp6Q1rIqWsq+AM8u0pummQWSgAAAABJRU5ErkJggg==" width="30"/> - you wake at 6am, but you can change this in your phone in Apps and the alarm clock.<br>');
				nFromPlace = 1
			}
			startQuestions("You move on to the");
			addLinkToPlace(md, "History Classroom", 1, "type=intro2", "", "", "", "moveblock");
			AddRightColumnLarge(md);
			findPerson("AmyRoss").showPerson("amyhall.jpg");
			break;
		case "intro2":
			addPlaceTitle(md, "Who was that?", "", 0, true);
			perDavy.showPerson("davy0.jpg", "20%", "right");
			md.write("<p><b>Bump,</b> lost in your own thoughts, you walk into another student, causing them to stumble forward a step, you apologise.</p>" + '<p>"Watch it, <b>asshole!</b>" they yell at you.</p>' +
				"<p>Recognising the voice, you glance up to see Davy Robbins looking at your with his patent-pending arrogant sneer. Not eliciting a response, he rolls his eyes and scoffs at you, then walks away with an equally arrogant swagger, shoving against your shoulder as he passes by you.</p>" + "<p>Earlier you overheard him bragging to some other students about his so-called 'conquest' of Kate Granger, <b>as if!</b> You recall a recent party you had gone to where you heard Kate mention some movie starring Bruce Lee and were able to strike up a conversation with her. After a few minutes of trading favorite scenes from old kung fu movies, you noticed you were being watched from the corner of the room by Davy. His older sister, Tina, seemed to have noticed him shadowing Kate as well and confronted him. While you couldn't hear what she said, Davy left the party in an indignant huff. Kate had meanwhile started speaking to some other friends and you lost the opportunity to get to know her better.</p>" +
				"<p style='margin-bottom:0px'>You feel something brush up against your leg, and spot an old piece of parchment resting against your shoe. Picking it up you find that you have found a document that had gone missing recently from the History Classroom. It is a personal letter from the blacksmith's wife Mrs. Stears to the regional minister describing the chaos in the area during the apex of the Kurndorf cult:</p>");
			AddImage("stears_letter.png", "45%", "center");
			md.write("<p style='margin-top:-1em'>After the letter was received by the church, district officials were notified and within a month Carl Kurndorf " +
				"was killed by a lone gunman. There is no mention of who the gunman was or what happened to him. Many of the townfolk," + "including Mrs. Stears, were directed to the district asylum.</p>" + "<p>You try to catch-up with Davy but lose him outside the school, not far from your home. You are not sure what you wanted - accusing him of theft or asking where he got the letter; you decide that you must learn more about these strange events surrounding this mysterious figure known as Kurndorf. You also want to learn more about what he has to do with the Sacred Book of Control..</p>" +
				"<p>Everything you have learned so far has only caused your curiosity to grow more and more.</p>");
			startQuestions("Some places to start your investigation are");
			addOptionLink(md, "back at School", "Place=9;showRightBar(-2);setTimeout('gotoPlace(9)')", "moveblock");
			addOptionLink(md, "at the Glenvale Library", "Place=2;showRightBar(-2);setTimeout('gotoPlace(2)')", "moveblock");
			md.write("<br>");
			break
	}
	WritePlaceFooter(md, "", true, true, true);
	setTimeout("hideRightBar()", 10)
}

function ShowPlace2() {
	var md = WritePlaceHeader();
	var perTitus = findPerson("MsTitus");
	var perMonique = findPerson("Monique");
	var perTess = findPerson("Tess");
	setPlaceBreakIn("Library", false);
	if (perYou.getExperience() > 7 && !isPlaceKnown("TownHall")) setPlaceKnown("TownHall");
	if (!isPlaceKnown("NewAgeStore") && checkPlaceFlag("ShoppingCenter", 7)) setPlaceKnown("NewAgeStore");
	if (perJesse.getDemonPath() >= 20 && perJesse.getDemonPath() < 30) perJesse.setDemonPath(perJesse.getDemonPath() + 5);
	else if (perJesse.getDemonPath() >=
		50 && perJesse.getDemonPath() < 60) perJesse.setDemonPath(perJesse.getDemonPath() + 5);
	addPlaceTitle(md, "Glenvale Library", "library1.jpg", perYou.isQuestStarted(4) && !perYou.isQuestComplete(4) ? 100 : 50);
	if ((perTitus.isCharmedBy() || perTitus.isFreeSlave()) && perMonique.isCharmedBy() && perTess.isCharmedBy()) md.write("<p>You are outside of the library and, for the first time in your life you realise how lovely the old building is in spring.</p>" + "<p>Especially considering the fact that this beautiful place is yours. Ever since you charmed the staff of it, you consider the Library to your property. You are the owner of it; you decide what to do with it, you control who enters and what happens inside. You don't even have to be there in person to run the place, your slaves will do the job for you. They always inform you of anything before they would do something so you are always up to date with the latest news.</p>");
	else md.write("<p>You are outside of the library and, for the first time in your life you realise how lovely the old building is in spring." + "<p>Someone once told you that they closed the building down for more than twenty years until finances were raised in 1969 to renovate the interior.</p><p>");
	if (checkPlaceFlag("Library", 2)) md.write("<p>The Library has a sign noting that is it temporarily closed to the public</p>");
	else if (!isShopOpen(2, 1, true)) md.write("<p>The Library has a sign noting that is closed, hours of business 7am to 8pm.</p>");
	startQuestions();
	if (isShopOpen(2, 1, true)) addLinkToPlace(md, "enter the Library", 3);
	if (isPlaceKnown("TownHall")) addLinkToPlace(md, "walk to the Town Hall", 94);
	if (isPlaceKnown("Museum")) addLinkToPlace(md, "walk to the Museum", 238);
	addLinkToPlace(md, "walk to the School", 9);
	WritePlaceFooter(md)
}

function ShowPlace3(stype) {
	var md = WritePlaceHeader(true);
	md.write('<table class="table-main"><tr>');
	var perTitus = findPerson("MsTitus");
	var sName = perTitus.getPersonName();
	if (!isShopOpen(2, 1, true))
		if (!isPlaceBreakIn("Library")) {
			if (!(perTitus.isCharmedBy() || perTitus.isFreeSlave())) return gotoPlaceDelayed(2, "", '<img src="UI/closed.png" style="float:left;width:15%;margin-right:5px">The Library closes and Ms. Titus asks you to leave.')
		} else {
			md.write('<td style="vertical-align:top" class="td-left">');
			addPlaceTitle(md,
				"Library Reception", "librarydesknight.jpg");
			md.write("<p>Entering the library you see the fiction section to your right and the reference desk ahead. Otherwise the library is empty.</p>");
			addLinkToPlace(md, "go to the reference area", 8);
			addTextForQuestions(md, "<b>The doors of the Library are locked</b>", "center");
			WritePlaceFooter(md);
			return
		}
	var perMq = findPerson("Monique");
	var perSister = findPerson("Tracy");
	var perTess = findPerson("Tess");
	var perKate = findPerson("Kate");
	if (wherePerson("OfficerBatton") ==
		1) movePerson("OfficerBatton", 168);
	var b2Cols = perSister.place == 3 || perTitus.isFreeSlave();
	if (b2Cols) md.write('<td class="td-left-small">');
	else md.write('<td style="vertical-align:top" class="td-left">');
	if (perTitus.isFreeSlave()) addPlaceImage(md, "librarydesknight.jpg");
	else if (perTitus.isCharmedBy()) perTitus.showPersonRandom("titus2", 3);
	else perTitus.showPerson("titus1a.jpg", "height:max");
	addPlaceTitle(md, "Library Reception");
	md.write("<p>Entering the library you see the fiction section to your right and the reference desk ahead. To your left are some study areas often used by students, and some assorted things like a photocopier for public use.</p>");
	if (perTess.place === 0 && perYou.isQuestComplete(1) && !perTess.checkFlag(1)) md.write("<p>All is quiet when you hear a loud crash from one of the offices.</p>");
	if (!perTitus.isCharmedBy())
		if (perTitus.isFreeSlave()) {
			md.write("<p>Your librarian slave has bound herself to some book-shelves, more as a token of submission than of actual restraint.</p>");
			if (perMq.charmed > 2 && perYou.isBornMale() && isItemNotHere(16, 46)) md.write('<p>"I heard that you are looking for something magical, ' + perYou.getMaster() + '," says your slave Ms. Titus, handing over a roll of parchment before resuming her prefered place bond to the bookcases. "Is this scroll of any interest to you, or am I and my tits?" ')
		} else md.write("<p>The receptionist is reading a book and doesn't even look up as you approach the reception desk.</p>");
	else {
		md.write("<p?You go to the main desk where she is seated and ask her casually</p>" + '<p>"What\u2019s up, my slut?"</p>' + '<p>"' + perYou.getMaster() + ", you've returned! Please, play with my tits, I\u2019ve prepared them for you!\", Ms Titus rushingly gets them out of her black, silk shirt.");
		if (perMq.charmed > 2 && perYou.isBornMale() && isItemNotHere(16, 46)) md.write('<br><br>"I heard that you are looking for something magical, ' + perYou.getMaster() + '," says Ms. Titus, handing over a roll of parchment. "Is this scroll of any interest to you?" ')
	}
	if (perSister.place ===
		3) md.write("<p><b>Tracy</b> sees you and beckons you over to the end of an aisle.</p>");
	if (perKate.place === 3) md.write('<p><b>Kate</b> wants to study. "Let\'s go to the study area," she suggests. "I\'m having difficulty with a problem that I\'m sure you can help me with."</p>');
	if (stype == "flee") {
		showPopupWindow("Mrs. Adams Flees", "<img src='Images/tess1d.jpg' class='imgpopup' alt='Tess'>" + 'You step out of Mrs. Adams office leaving her to deal with the effects of the charm spell and you hear her softly say something like "John..."<br><br>' +
			"As you return to the main area of the library you hear someone running in high-heels, but for a moment Ms. Titus's cleavage distracts you.<br><br>" + 'You tear your eyes away and see Mrs. Adams run through the front door of the library. You run after her, and hear Ms. Titus<br><br>"No running in the library!".<br><br>At the door you see Mrs. Adams getting into an expensive car, slamming the door and driving away quickly to the north, towards the business and civic area of town.<br><br>' + 'You ask Ms. Titus where she ran off to and she answers, "Shhh!...but probably to meet her husband at his office in the Town Hall"');
		setPlaceKnown("TownHall");
		movePerson("Tess", 96)
	} else if (perTitus.checkFlag(1) && !perTitus.checkFlag(2)) showPopupWindow(sName, "<img src='Images/" + (perTitus.isFreeSlave() ? "titus12" : "titus9") + ".jpg' style='width:40%;float:right;margin: 0px 0px 0px 5px' alt='Titus'>" + '"Tell me,what\u2019s the deal with those huge jugs of yours?", you ask Karen Titus.<br><br>' + '"Ohh, you mean these, ' + perYou.getMaster() + '?", she plays with them for your entertainment. They\u2019re always out of her shirts if you are there.<br><br>' +
		'"It\u2019s genetics. My mother has a little bit bigger pair than mine\u2019s and my sister also has a lovely big pair too! Are they bothering you? I can make them smaller if you want, just tell the word an I will go to a doctor.", she says gesturing you to come closer and touch them.<br><br>' + '"What?! No! They\u2019re one lovely pair! Don\u2019t change them! And what\u2019s with the submissivness? I feel I could have made you my slave without having to charm you. It\u2019s like you really wanted to give in, in a sluttiest way possible!", you ask, but you\u2019re mesmerized by those breasts of her. You cannot take your eyes of them.<br><br>' +
		'"You are correct, my dear! I have always been interested in a BDSM relationship. I had a partner for a year who made me do things like binding my hands, tying me to a pole while he fucked me and do slave poses in front of him. He even punished me if I behaved naughty. Those were my best moments of my life up until I met you, my ' + perYou.getMaster() + '!", she says excitedly.<br><br>' + "You play with the idea of taking her right here and right now, but you\u2019ve got some important things to do so you order her to continue her work. However you feel you two will have a wonderful relationship. Her experience and your enthusiasm will surely click together perfectly.",
		"setPersonFlag('MsTitus',2)");
	else if (isPlaceKnown("JohnAdamsOffice") && !(perTitus.isCharmedBy() || perTitus.isFreeSlave()) && !perTitus.checkFlag(9) && perTess.place === 0 && perYou.isQuestComplete(1) && perTess.hoursCharmed() < 3) showPopupWindow("Ms. Titus Watches", "<img src='Images/titus1b.jpg' class='imgpopup' alt='Titus'>" + "As you are walking towards Tess's office you notice the librarian Ms. Titus looking at you oddly. Her dress, which is shorter than you had noticed before, has ridden up exposing her panties. If this were someone other than the business-like Ms. Titus you would have thought that you had interrupted her masturbating or something like that!<br><br>" +
		'You consider talking to her, and take a step towards her, not quite sure what to ask her. She shakes her head and puts a finger to her lips in an exaggerated "Shhhh" gesture, or more likely "Go away I do not want to talk to you".', "setPersonFlag('MsTitus',9)");
	startQuestions();
	if (perTitus.other === 0) addPopupLinkC(md, "say hello to the receptionist", "Ms. Titus", "<img src='Images/titus8.jpg' style='width:35%;float:right;margin-left:5px' alt='Library'>" + "You approach the main desk of the library, usually it is staffed by the woman in front of you. Her name is Ms.Titus but you know little more about her, she is very business-like and tolerates no chit-chat. You notice that she is always reading a book in her freetime. It looks like she has a lot of that, because not many people visit the library anymore." +
		"<br><br>" + "Your eyes are drawn to the most obvious thing about her, her large cleavage, but drag your eyes away, as you know Ms. Titus does not respond well to any sort of flirtation. Still you have daydreamed about her cleavage and what you would do if you got your hands on it." + "<br><br>You say hello to her, and as usual she only responds with." + '<br><br>"Shh!"', false, "setPersonOther('MsTitus',1);dispPlace();");
	else if (perTitus.other === 1) addQuestionC(md, "ask where you could find the Kurndorf book",
		"MsTitus", 181);
	else if (perTitus.other === 2) addQuestionCO(md, "lookup novels featuring the Kurndorf book", "Misc", 182);
	else if (perTitus.other == 3 && perYou.isQuestComplete(1)) addQuestionC(md, '"What book are you reading?"', "MsTitus", 200);
	else if (perTitus.other === 11) addQuestionCO(md, "tell " + sName + " about the early settlers", "MsTitus", 1811);
	if (perTitus.isCharmedBy() || perTitus.isFreeSlave()) {
		if (!checkPlaceFlag("Library", 2)) addQuestionC(md, "ask " + sName + " to close the library", "MsTitus", 171);
		else addQuestionC(md,
			"ask " + sName + " to open the library", "MsTitus", 174);
		addLinkToPlaceC(md, "tell " + sName + " to play with herself", 3, "type=playwithherself");
		if (perMq.charmed > 2 && perYou.isBornMale() && !isSpellKnown("Possession")) addQuestionCO(md, "take the scroll from " + sName + "", "MsTitus", 172);
		if (perTitus.checkFlag(7) && !perTitus.checkFlag(6)) addQuestionCO(md, "ask " + sName + " what she was working on before", "MsTitus", 173);
		if (isPlaceKnown("RathdownRd") && !isPlaceKnown("MsTitussHouse")) addQuestionC(md, "ask " + sName + " where she lives",
			"MsTitus", 2E3)
	}
	if (perDavy.getPathHellgate() === 1) addQuestionC(md, "ask " + sName + " if Davy Robbins has been in today", "MsTitus", 1101);
	else if (perDavy.getPathHellgate() == 4) addQuestionC(md, "ask " + sName + " what Davy Robbins found on the computer", "MsTitus", 1104);
	addLinkToPlace(md, "go to the reference area", 8);
	if (perTess.place === 0 && perYou.isQuestComplete(1)) addLinkToPlace(md, !perTess.checkFlag(1) ? "go to the office where the crash occured" : "go to Mrs Adams' office", perTess.isCharmedBy() ? 62 : 28);
	if (perTess.place ===
		230 && perTess.isCharmedBy() && perTess.other < 25 && !perTitus.checkFlag(10)) addQuestionC(md, "ask where Tess is today?", "MsTitus", 100);
	if (perSister.place === 3) addLinkToPlaceC(md, "approach Tracy", 147);
	if (perKate.place === 3) addLinkToPlaceC(md, "go to the study area with Kate", 6);
	addLinkToPlace(md, "exit the library?", 2);
	if (b2Cols)
		if (perTitus.isFreeSlave()) {
			AddPeopleColumnLarge(md);
			perTitus.showPersonRandom("titus10", 2)
		} else if (perSister.place == 3) {
		AddPeopleColumnMed(md);
		perSister.showPerson("tracy9.jpg", "100%",
			"", "", "Tracy")
	}
	WritePlaceFooter(md)
}

function LeaveKate4(plc) {
	var perKate = findPerson("Kate");
	if (perKate.place !== Place && Place != 4) return dispPlace(plc);
	perKate.other = 999;
	perKate.place = 1E3;
	perKate.charmThem(4, "Davy");
	perKate.setFlag(4);
	if (!perYou.isBornMale()) PlaceI(3, plc);
	else if (!checkPlaceFlag("Park", 3)) {
		setPlaceFlag("Park", 3);
		PlaceI(5, 26)
	}
	var s;
	if (plc != 63) s = "<p>As you leave, you see Kate ride off";
	else s = "<p>You just leave Kate, and you see she rides off when you ignore her";
	if (!perYou.isBornMale()) s += ". You notice a piece of paper slips out of her bag, an envelope addressed to her from the school, it has her home address on it.</p>";
	else s += ".</p>";
	s += "<p>As you leave you notice a kite stuck in a tree, some kid must have lost it recently.</p>";
	gotoPlace(plc, "", s)
}

function ShowPlace4(stype) {
	var perKate = findPerson("Kate");
	var md = WritePlaceHeader(false, perKate.other == 3 ? "td-left-med" : "");
	if (perKate.other == 4) {
		perKate.showPerson("kate1d.jpg");
		addPlaceTitle(md, "Kate Granger Leaving");
		md.write('<p>"Yes," replies Kate. "That sounds like a great idea. I\'ll meet you there, don\'t take too long!"</p>' + '<p>She suddenly cries out "Oww" and her hand grabs at her skirt giving you a glimpse of her panties. She smiles, a little embarrassed and says, "Sorry, just some insect, it\'s gone now" and she gets on her bike and rides off.</p>' + "<p>Your immediate thought was that you would have happily kissed the bite better, but you were not foolish enough to say it, even in jest. You remember how Kate has treated inappropriate flirting and has been known to slap or even hit those who will not take no for an answer.</p>");
		if (perKate.place == 63) md.write("<p>As you follow her you notice a kite stuck in a tree, some kid must have lost it recently.</p>");
		startQuestions();
		if (perKate.place == 63) addLinkToPlace(md, "walk after Kate to the park pathway?", 63);
		else addLinkToPlace(md, "walk after Kate to the park entrance?", 47);
		perKate.place = 3
	} else {
		if (perKate.other < 1) perKate.showPerson("kate1a.jpg");
		else if (perKate.other == 1) perKate.showPerson("kate1b.jpg");
		else if (perKate.other == 3) perKate.showPerson("kate1c.jpg");
		addPlaceTitle(md,
			"Kate Granger");
		if (!perKate.checkFlag(25)) showPopupWindow("Kate Granger", "<img src='Images/kate0.jpg' class='imgpopup' alt='Kate'>" + "The one and only Kate Granger is standing right in front of you. The cutest and prettiest girl you know! She\u2019s the source of many school gossips, because she is the type of girl who is unreachable and untouchable by the normal guys. Rumours say that she still hasn\u2019t dated anyone in school, but Davy says otherwise. He brags about Kate being his girl, but you would never believe him. She is just too good for him! You never asked Kate about this as she looses her temper at the smallest things and you don\u2019t want to ruin your friendship with her.<br><br>" +
			"Her golden locks and green eyes are just simply amazing. Her petite curves and beautifully shaped, round tits are just enough to make you horny for her in an instant, not to mention that sly look she gives you. You know she\u2019s out of your league, but you have to try! You gotta have her somehow!", "setPersonFlag('Kate',25)");
		md.write("<p>Everyone says that Kate is the school nerd. She joined Glenvale High two years ago and, for a while, every guy tried to hit on her. " + "Some rumors got around that she was available, and that jerk <b>Davy Robbins</b> claimed to have to have gotten " +
			"into her " + (isBritish() ? "knickers" : "pants") + ". That was before you knew her better and you cannot see how that could be true. Davy has always seemed to be a bit of a timid letch to you, then again he always got on well with Mr Beasley at school, as they say 'like is drawn to like'.</p>" + "<p>Despite the rumours and what others think, she is okay if you speak to her the right way, a little aggressive, more likely to slap than yell. You have become friends with her, though you would like it to be more.</p>" +
			"<p>Kate almost collides with you as you greet her. She is in a hurry and doesn't have time to waste on idle chit chat. " + "You wonder whether you should see her another time, when she is not in as much of a rush.</p>");
		if (perKate.other < 1) md.write('<p>"Hello ' + perYou.getPersonName() + '." She says and tries to get back on her bike. ' + "You prevent her from escaping and she humphs her annoyance.</p>");
		startQuestions();
		if (perKate.other < 3) startAlternatives(md);
		if (perKate.other === 0) addQuestionC(md, "ask Kate what's up",
			"Kate", 540);
		if (perKate.other < 1) addQuestionC(md, "ask her why she's hurrying", "Kate", 5401);
		else if (perKate.other === 1) addQuestionC(md, "tell Kate that you got an A+ in mathematics", "Kate", 541);
		if (perKate.other < 3) {
			addQuestionC(md, "insult her and ask her if she is Davy's bitch", "Kate", 5402);
			endAlternatives(md)
		} else if (perKate.other === 3) addOptionLinkC(md, "ask Kate to meet at you at the library", "setPersonOther('Kate', 4);dispPlace()");
		if (perKate.place == 63) addOptionLink(md, "go to the park pathway?", "LeaveKate4(63)");
		else addOptionLink(md, "go to the park bridge?", "LeaveKate4(216)")
	}
	WritePlaceFooter(md)
}

function ShowPlace5() {
	var md = WritePlaceHeader();
	if (checkPlaceFlag("DervishRd", 2)) addPlaceImage(md, "house2.jpg", "90%", "", "Kristin's House");
	if (checkPlaceFlag("DervishRd", 3)) addPlaceImage(md, "house8.jpg", "90%", "", "Bartel House");
	else if (!checkPlaceFlag("DervishRd", 2)) addPlaceImage(md, "street1.jpg");
	addPlaceTitle(md, "Dervish Road");
	md.write("<p>A more expensive part of town, the houses are larger and well tended ");
	if (isDay()) md.write("but there are very few children around playing.</p>");
	else md.write("and there are very few people around at this time of night.</p>");
	if (checkPlaceFlag("DervishRd", 2)) md.write("<p>You can see 10 Dervish Rd, Kristin's house.<br>It's rather gothic, a strange looking and probably old house. You get a slightly odd feeling about the house.<br>");
	if (checkPlaceFlag("DervishRd", 2)) md.write("<p>You can see 12 Dervish Rd, the Bartel's house.<br>The house is quite luxurious, you would guess Ellie is not the owner of the house.<br>");
	startQuestions();
	if (checkPlaceFlag("DervishRd", 2)) addLinkToPlace(md, "enter Kristin's Residence", 430);
	if (checkPlaceFlag("DervishRd",
			3)) addLinkToPlace(md, "enter the Bartel's Residence", 420);
	if (isPlaceKnown("Alley")) addLinkToPlace(md, "walk to Yoolaroo Drive", 43);
	if (isPlaceKnown("CheriseRd")) addLinkToPlace(md, "walk to Cherise Rd", 37);
	addLinkToPlace(md, "walk to the shops", 194);
	WritePlaceFooter(md)
}

function LeaveKate6() {
	var perKate = findPerson("Kate");
	perKate.other = 999;
	perKate.place = 1E3;
	perKate.charmThem(4, "Davy");
	perKate.setFlag(4);
	if (!checkPlaceFlag("Park", 3)) {
		setPlaceFlag("Park", 3);
		PlaceI(5, 26)
	}
	setPlaceKnown("GrangerHouse");
	setPlaceKnown("Alley");
	gotoPlace(3, "", "<p>You just leave Kate, and she storms off when you ignore her. You notice in her rush a piece of paper slips out of her bag, an envelope addressed to her from the school, it has her home address on it.</p>")
}

function ShowPlace6() {
	var md = WritePlaceHeader();
	var perKate = findPerson("Kate");
	perKate.showPerson("kate3a.jpg");
	addPlaceTitle(md, "Study Area");
	md.write('<p>"I\'m so glad that you can help," says Kate. "I have a terrible puzzle that\'s so impossible that I\'ll be here forever if I have to do it alone."</p>' + "<p>You look at the desk and see the puzzle. It looks bloody difficult.</p>" + '<p>Kate sees you hesitate. "You will help me, won\'t you? I... I need a friend."</p>');
	startQuestions();
	addLinkToPlaceO(md,
		"try the puzzle", 12);
	addOptionLink(md, "go to the library reception?", "LeaveKate6()");
	WritePlaceFooter(md)
}

function ShowPlace8(stype) {
	var act = getQueryParam("act");
	var md = WritePlaceHeader(false, act == "fuck" ? "td-left-med" : "");
	var perMonique = findPerson("Monique");
	var myName = perMonique.getYourNameFor();
	var perAbby = findPerson("Abby");
	var bOpen = isShopOpen(2, 1, true) || act !== "";
	var s;
	var i;
	if (bOpen && perMonique.place === 8)
		if (perMonique.isCharmedBy())
			if (act === "bj") perMonique.showPersonRandomRorX("monique10b", isExplicit() ? 2 : 1);
			else if (act == "lick") perMonique.showPersonRandomRorX("monique10g", 2);
	else if (act === "fuck") perMonique.showPersonRandomRorX("monique11b",
		2);
	else if (act == "strap") perMonique.showPerson("monique11gc.jpg");
	else perMonique.showPerson("monique7.jpg");
	else perMonique.showPerson("monique1.jpg");
	else addPlaceImage(md, "referencedesk.jpg", "", "", "Reference Desk");
	if (act == "endcharm") {
		addPlaceTitle(md, "Slave Monique");
		md.write('<p>"Please command me, ' + perYou.getMaster() + '.  I live to serve, and I serve only you."' + "Monique says in a honeyed voice, her fingers lightly pinching her nipples and every pore of her being dripping sex.</p>" + "<p>You have added a servant to your harem. Monique is eager to do whatever you want, and to please you in any and every way she can. All you have to do is command her and she is yours.</p>")
	} else if (act ===
		"bj") {
		addPlaceTitle(md, "Reference Area");
		md.write("<p>Sometimes, words are not needed. Monique stands in front of you at the ready, and as you open your pants and gesture to the ground before you, your ever faithful slave immediately understands and crouches down.</p>" + "<p>Monique's tongue begins to slide eagerly over your manhood, covering you in her saliva and using her hand to get you erect, and doing a good job at it. You place one hand on your hip and drive the other through her hair, watching her as her lips wrap over the tip and begin to slide back and forth, enjoying your slaves administration.</p>" +
			"<p>\u201cYou practiced, did you?\u201d You ask her, and the response is a muffled grunt of confirmation before she takes you in all the way to the base as if to show of the results of it. You definitely approve.</p>" + "<p>It doesn't take her long to bring you close to the edge and when the moment comes, you take a hold of her hair to keep her in place and shoot your load into her mouth.</p>" + "<p>Monique waits patiently, swallowing every drop as ordered and eagerly cleaning when might be left with her tongue after you let go of her.</p>")
	} else if (act ==
		"lick") {
		addPlaceTitle(md, "Reference Area");
		if (Math.random() < .4) md.write("<p>You grab Monique's hair and pull the woman into a kiss as a greeting before simply sitting down on her chair and ordering her to knee in front of you.</p>" + "<p>Monique is taken aback by your directness at first, nervously fidgeting with her fingers before quickly following up on your order and helping to undress you.</p>" + "<p>You smile as you wait for her to finish and lazily lean back, one of your legs now resting on her desk to present your sex to her. \u201cYou know what to do, my pet.\u201d</p>" +
			'<p>\u201cY...yes Mistress.\u201d Monique clearly isn\'t used to such a treatment, and it does take her a moment to "find her flow" so to say, but with a few subtle pointers from you, she begins to lure the first subtle moans from your lips.</p>' + "<p>You praise her advances and she seems to grow more confident, her tongue now flicking over your clit before she sucks it inside with her lips and decides to use her fingers to help out.</p>" + "<p>Soon, her efforts bear fruit, you feel your body tremble a little as your climax begins to build up and firmly take a hold of Monique's hair and press her closer against your twitching fold as you finally reach your peak. Once again praising your eager pets success.</p>");
		else md.write("<p>It doesn't take much for Monique to understand what it is you wish her to do as you sit in front of her with your legs spread. Leaning back she quickly gets on her knees in front of you to service your pussy. Her fingers slowly stroke along its length as she looks up at you happily. Servicing you seems to bring her a great amount of joy. Absently her fingers begin to trace letters along your clit, resulting in a faint gasp as she focuses her attention on arousing you. It isn't long before her lips force themselves between your labia and begin kissing the confines beneath. Such an attentive servant!</p>" +
			"<p>Her tongue slides from her mouth to poke at your opening, tracing the tip along the outer edges as she inhales deeply of your scent. Your fingers reach out and grasp hold of her hair as she teases you so. But without a little teasing then how can one be truly pleased?</p>" + "<p>Monique shifts position and knees at your side, sucking your clit into her mouth. Holding it trapped between her lips as her tongue dances wildly over the tiny nub. Her right arm snakes up under your leg as her thumb begins stroking along the length of your cunt, pausing only to focus on pushing against your hole before continuing to tease your dampened flesh. Devoted onto her task of pleasing you, the woman focuses upon the sounds that you make as a gauge of how well her manipulation of your body is succeeding. She definitely picked this up from somewhere...</p>" +
			"<p>Ever attentive to your body, her thumb ends teasing you and is quickly replaced by two fingers. Each thrust inward is followed with her fingers curling to rub against the ridges just as your cunt's opening. All while her warm breath flows out against your body. Underneath such relentless assault it doesn't take long for your body to succumb to orgasm. Your hips thrusting up as you cry out in pleasure. Monique isn't quite done with you yet, however. As she continued her sucking, licking, and fingering throughout your orgasm, quickly sending you into another.</p>" +
			"<p>Finally stopping your cunt is provided with only a moment's break before the feeling of her lips again returns to it. This time a much more tender succession of kisses all along your exposed sex.</p>")
	} else if (act === "fuck") {
		addPlaceTitle(md, "Reference Area");
		md.write("<p>Monique has a rather spacious desk, and you feel like it would be a shame to not make full use of it.</p>" + "<p>You order her to clear a small section and undress before you simply push her to lay down on it.</p>" + "<p>Your faithful slave quickly realizes what you intent to do and eagerly spreads her legs, using one of her pens to play with her clit while you open your pants and free your shaft.</p>" +
			"<p>You have the woman lick it thoroughly, holding her hair until it stands fully at attention and you are ready to take her, eagerly pushing into her already wet sex and satisfy your desires.</p>")
	} else if (act == "strap") {
		addPlaceTitle(md, "Reference Area");
		md.write("<p>Monique has a rather spacious desk, and you feel like it would be a shame to not make full use of it.</p>" + "<p>You order her to clear a small section and undress before you simply push her to lay down on it.</p>" + "<p>Monique seems unsure what exactly you are planning at first, until you get the strap-on and a tube of lube from your sports bag and show both with a grin, causing your pet to blush heavily.</p>" +
			"<p>Taking your time to prepare, you run the freshly lubed dildo over your pets mound, spreading her folds and teasing her clit while you slowly stir the mana inside her to raise her arousal and suddenly push into her rear.</p>" + "<p>There is a sharp yelp of surprise from her, but thanks to your preparation, the huge rubber shaft enters her rear painlessly, and soon, she seems to quite enjoy the unexpected flood sensations. Her moans slowly growing louder as you push into her, driving your pet to a surprisingly quick orgasm.</p>")
	} else {
		addPlaceTitle(md,
			"Reference Area");
		md.write("<p>Glenvale Library is supposed to hold one of the biggest collections of books in the county, and you can well believe it just looking through the reference area.</p>");
		if (perYou.getExperience() < 1) md.write("<p>The difficulty of finding the tome you seek begins to sink in. " + "Who knows, maybe someone else already has possession of the magic and will be willing to turn it against you if you find them. As you enter the reference section, you consider these problems but are determined to try anyway.</p>");
		if (!bOpen || perMonique.place !== 8) md.write("<p>The reference area is deserted. You look along the bookshelves for a clue to the mystery of magic. There does not appear to be any material on the matter here.</p>");
		else {
			if (perDavy.getPathHellgate() === 5 && perMonique.charmed === 0) perDavy.setPathHellgate(10);
			if (perMonique.other < 1) md.write("<p>An attractive girl is sitting at one of the computer terminals. She's familiar to you; one of the staff. As you approach she startles and, too quickly, spins around to face you. Nervously you approach the girl.</p>");
			else if (perMonique.charmed > 0) md.write("<p>Monique, ever your faithful slave, stands at attention - ready to serve you in any way you desire.</p>");
			else md.write("<p>Monique, the database administrator, spins around to face you.</p>")
		}
	}
	startQuestions();
	if (bOpen && perMonique.place === 8) {
		if (perMonique.other === 0) {
			s = "<p><img src='Images/monique2.jpg' style='width:30%;float:right;margin-left:5px' alt='Monique'>" + "You approach the nervous looking staff member, you have seen her a number of times before but you do not think you have spoken to her before. You introduce yourself and she looks calmer, her nervousness has passed. She replies,</p>";
			if (!perMonique.isCharmedBy()) s += '"Hello, my name is Monique," says the girl. "How may I help you?"';
			else s += '"Hello ' + perYou.getMaster() + ', how may I be of service?"';
			s += "<p>You apologise if you startled her, and she smiles,</p>" + '<p>"Sorry I was just reading a little on this town\'s history and Tess had recently told me some creepy stories about magic and I was a little...umm...on edge. She likes to tease me about things I am a little afraid of, things I am interested in but..well..anxious about."</p>' +
				"<p>She seems like a nice lady, but her always anxious and nervous behaviour can be irritating after a while, but her vast knowledge and interest in the history of the town makes her a pivotal person in your journey, you know that for sure.";
			addPopupLinkC(md, "introduce yourself to the girl", "Reference Area Staff", s, false, "setPersonOther('Monique',1);dispPlace();")
		} else if (perMonique.other == 1) addQuestionC(md, "ask where you could find the Kurndorf book", "Monique", 61);
		if (!isPlaceKnown("GrangerHouse"))
			if (getPersonOther("Kate") ===
				999) addQuestionC(md, '"Could you help me find someone\'s address?"', "Monique", 999);
			else if (getPersonOther("Kate") == 998) addQuestionC(md, '"Kate Granger. We have a project to finish and I lost her address."', "Monique", 998);
		if (perMonique.charmed === 0)
			if (perMonique.other == 3) addQuestionC(md, "ask Monique what information " + perGates.getPersonNameShort() + " wanted", "Monique", 67);
			else if (perMonique.other == 4) addQuestionC(md, "ask Monique if she can look for anything else on Kurdoff", "Monique", 66);
		if (getBeasleyServant() >=
			10 && !isPlaceKnown("Alley")) addQuestionC(md, "ask if she knows about a bull and building", "Monique", 1410);
		if (perMonique.charmed > 0) {
			if (act === "" || act == "endcharm") {
				if (perYou.isMaleSex()) addQuestionCO(md, "order Monique to take you in her mouth, and take every drop", "Monique", 51);
				if (perYou.getSex() == "girl") addQuestionCO(md, "order Monique to use her soft lips to kiss and lick you", "Monique", 51);
				if (perYou.isMaleSex()) addQuestionCO(md, "take Monique", "Monique", 55);
				else if (perYourBody.FindItem(45) > 0) addQuestionCO(md,
					"take Monique with your strap-on", "Monique", 55)
			}
			if (perMonique.charmed < 3) addQuestionCO(md, "tell Monique to help you find more magic", "Monique", 52);
			if (checkPersonFlag("Pamela", 8) && !checkPersonFlag("Pamela", 9) && perYourBody.FindItem(46) > 0) addQuestionC(md, "ask Monique about Pamela's bracelet", "Monique", 80);
			if (whereItem(35) == 279 && !isSpellKnown("Shielded Charm"))
				if (wherePerson("Hannah") == 279) addPopupLinkC(md, '"Do you know about the dragon gem"', "Monique and the Gem", "<p><img src='Images/monique3a.jpg' style='width:35%;float:right;margin-left:5px' alt='Monique'>" +
					"You tell Monique about the dragon gem and the strange writing you found, and explain that you are nether able to move it, nor decipher any of the Symbols.</p>" + "<p>Monique asks where you left it, and as you mention Hannah's mechanics workshop, her eyes lighten up.</p>" + "\u201cI know the place, in fact, I live right above it!\u201d She smiles. \u201cMe and Hannah have been roommates for a while, and I actually meant to invite you anyway and show you... something.\u201d She suddenly looks around nervously again.</p>" +
					"\u201cI'll meet you there, I'm sure you'll like it, bye!\u201d", true, "movePerson('Monique', 279);dispPlace();");
				else addPopupLinkC(md, '"Do you know about the dragon gem"', "Monique and the Gem", "<p><img src='Images/monique3a.jpg' style='width:35%;float:right;margin-left:5px' alt='Monique'>" + "You tell Monique about the dragon gem and the strange writing you found, and explain that you are nether able to move it, nor decipher any of the Symbols.</p>" + "<p>Monique asks where you left it, and as you mention Hannah's mechanics workshop, her eyes lighten up.</p>" +
					"\u201cI know the place, but it is not open now and Hannah won't open it especially for you. When it is open come back and ask me then, I can help you!\u201d", true);
			else if (perMonique.checkFlag(19) && isCharmedBy("Hannah") && wherePerson("Hannah") == 279) addPopupLinkC(md, '"let\'s visit Hannah"', "Visiting Hannah", "<p><img src='Images/monique3a.jpg' style='width:35%;float:right;margin-left:5px' alt='Monique'>" + "You tell Monique that is would be nice to visit Hannah at the Mechanic's Workshop again, and you see her smile,</p>" +
				"<p>\"I'd love to visit my friend Hannah, I'll change and meet you there for a ride!\"</p>", true, "movePerson('Monique', 279);dispPlace();")
		}
		if (perMonique.other >= 10)
			if (checkPersonFlag("Catherine", 5) && !checkPersonFlag("Catherine", 13)) addPopupLinkC(md, "ask Monique if she has found anything else", "Researching", "<p><img src='UI/books/kingbook.jpg' style='width:20%;float:right;margin-left:5px;margin-bottom:1em' alt='King Book'>" + "You check with Monique if she has found anything else useful or magical, and she slides over a book to you,<br><br>" +
				'"I recently found this book, it is originally a fictional story of macarbe events and madness, this is an odd edition. It must be a very early edition and it is quite unlike any others I can find on record!"</p>' + '<p>She pauses, "Sorry I could not fully read it...it was just too spooky, I could not take it and I have been having nightmares about what I did read", she shudders. You know she is nervous about the occult but this book has really creeped her out.</p>' + '<p>Well it is just a work of fiction and not very long, so you sit down with her and read it....She was not kidding, it is one disturbing work of eldritch horror and madness centered around an otherworldy being, the King in Yellow living on a far dead world, spreading corruption and death at mere speaking of his name "Hastur". You put the book away, resolving to not read it <i>ever</i> again.',
				true, "setPersonFlag('Catherine',13);if(!per.checkFlag(12))perYou.addExperience(1);dispPlace();");
		for (i = 3; i < 6; i++)
			if (perMonique.checkFlag(i)) {
				addQuestionC(md, "ask Monique if she can help you with a riddle", "Monique", 21);
				break
			}
		if (perMonique.checkFlag(2)) {
			if (perMonique.checkFlag(3))
				if (perMonique.checkFlag(33)) addQuestionC(md, "\"How would you rearrange the letters in the words 'new door' to make one word?\"", "Monique", 73);
				else if (perMonique.checkFlag(34)) addQuestionC(md, "\"If it's information you seek, come and see me. If it's pairs of letters you need, I have consecutively three. Who am I?\"",
				"Monique", 73);
			else addQuestionC(md, '"A natural state, I\'m sought by all. Go without me, and you shall fall. You do me when you spend, and use me when you eat to no end. What am I?"', "Monique", 73);
			if (perMonique.checkFlag(4))
				if (perDavy.checkFlag(33)) addQuestionC(md, '"What is at the beginning of eternity, the end of time, the beginning of every end, and the end of every place?"', "Monique", 74);
				else if (perDavy.checkFlag(34)) addQuestionC(md, '"I\'d do anything for love ..."', "Monique", 74);
			else if (perDavy.checkFlag(35)) addQuestionC(md,
				'"Enter ..."', "Monique", 74);
			if (perMonique.checkFlag(5))
				if (checkPlaceFlag("Crypt", 3)) addQuestionC(md, '"One is vain by nature, <b>teomds</b> by necessity."', "Monique", 75);
				else if (checkPlaceFlag("Crypt", 4)) addQuestionC(md, '"A maker of tablets, often said to be free <b>amnos</b>."', "Monique", 75);
			else if (checkPlaceFlag("Crypt", 5)) addQuestionC(md, '"A guard against the dead and often the living, <b>aiglcr</b>."', "Monique", 75)
		}
		if (perDavy.getPathHellgate() == 10) addQuestionCO(md, "tell Monique to look up Davy Robbins' recent activity",
			"Monique", 1110);
		if (!isPlaceKnown("WildRanges") && (getPersonOther("MrBeasley") == 2 || perGates.other == 9)) addQuestionC(md, "ask about magic stones", "Monique", 192);
		if (perYou.checkFlag(12) && !perMonique.checkFlag(17)) addQuestionC(md, "ask about books on Hypnosis", "Monique", 200)
	}
	if (perAbby.getQuestDragonGem() === 1)
		if (bOpen && perMonique.place === 8) addQuestionC(md, "ask Monique to look up magic gems", "Monique", 251);
		else addQuestionCO(md, "look for references about magic gems", "LibraryResearch", 251);
	if (perKurndorf.getQuestSeance() ===
		16 || perKurndorf.getQuestSeance() === 17)
		if (bOpen && perMonique.place === 8) addQuestionC(md, "ask Monique to research s\u00e9ances", "Monique", 2717);
		else addQuestionCO(md, "look for any reference about s\u00e9ances", "LibraryResearch", 2717);
	addLinkToPlace(md, "go to the library reception?", 3);
	WritePlaceFooter(md)
}

function ShowPlace9() {
	var md = WritePlaceHeader();
	setPlaceBreakIn("HistoryClassroom", false);
	addPlaceImage(md, "school1.jpg");
	if (wherePerson("Kurndorf") == 4) movePerson("Kurndorf", 5);
	addPlaceTitle(md, "Glenvale Secondary School");
	md.write("<p>Glenvale Secondary School, famous for its high academic achievers and its teachers' poor sense of humour, is the pride of the county.<br><p>");
	if (perYou.getExperience() === 0) {
		md.write("Every year at least one student graduates to go on to Harvard, Edinburgh or Oxford university. Expectations for staff and students are high and those who falter soon retire from the pressures of the county's finest educational institution.<p>");
		md.write("As you see the grand entrance you are reminded of these facts and cringe. Your grades are borderline and several teachers are beginning to ask questions about your ability to make it through your final year. If you can find that cursed book and write a thesis on the Kurndorf happenings you are sure to push some of those grades up.<p>")
	}
	if (!isShopOpen(2)) md.write("<p>The school is closed, open generally from 8am to 8pm Monday to Friday.</p>");
	else if (wherePerson("Kurndorf") == 4 && perDavy.other ==
		1 && !perKurndorf.checkFlag(21)) {
		md.write("<p>For a fleeting moment you thought you saw the <b>ghost</b> at the school entrance looking in. The aparition fades as it moves away to the south, maybe?</p>");
		perKurndorf.setFlag(21)
	}
	if (perDavy.other === 2 && perDavy.place === 9) {
		md.write("<p>Farther along the foot path you see Davy Robbins. He recognizes you, almost says something, then runs behind some trees.");
		if (perGates.other == 600) md.write(" You feel nervous, wondering if his woman and accomplice is nearby.");
		md.write("</p>");
		startTimedEvent("perDavy.other = 3;perDavy.place = 1000;", 1)
	}
	startQuestions();
	if (isShopOpen(2)) addLinkToPlace(md, "enter the School", 70);
	if (perDavy.other === 2 && perDavy.place === 9) addLinkToPlace(md, "follow Davy", 144, "type=follow");
	else if (isPlaceKnown("SchoolField")) addLinkToPlace(md, "walk to the school sports fields", 144);
	if (isPlaceKnown("Park")) addLinkToPlace(md, "walk to the Park", 47);
	addLinkToPlace(md, "walk to the Library", 2);
	addLinkToPlace(md, "walk to Kollam Street", 44);
	if (perDavy.other ===
		2 && perDavy.place === 9) {
		AddPeopleColumnMed();
		perDavy.showPersonFace("100%")
	}
	WritePlaceFooter(md)
}

function ShowPlace10() {
	var md = WritePlaceHeader();
	var perMonique = findPerson("Monique");
	var myName = perMonique.getYourNameFor();
	var perAbby = findPerson("Abby");
	var bMoniqueHere = isShopOpen(2) && perMonique.place == 10;
	addPlaceImage(md, "classroom1.jpg", "", "", "History Classroom");
	if (bMoniqueHere) perMonique.showPersonFace();
	addPlaceTitle(md, "History Classroom");
	if (perYou.getExperience() < 1) md.write("<p>The classroom is deserted; everyone has gone home for the day. You look around for something to help your quest. Some papers are scattered on the teacher's desk and books are in the bookcase.<br><br>  You hear some footsteps outside in the corridor and you tense. It would not do you any good to be found snooping around school without a teacher present. After what seems like minutes the footsteps pass by, then fade out.</p>");
	else md.write("<p>The classroom is deserted; everyone has gone home for the day.</p>");
	if (bMoniqueHere) md.write("<p>You are startled by a noise at the front of the room. Somebody lifts their head over the teacher's desk. You are relieved when you realize that it's just Monique.</p>");
	else if (isDay()) {
		md.write("<p>As you sneak back to the classroom, you hear some voices in the room next door. Putting your ear to the wall you hear them speaking about strange happenings in Glenvale.");
		if (perYourBody.FindItem(4) > 0) md.write("  You are not sure whether they're talking about what you have done. <br><br>You realize that if the townsfolk find out that you have the book, then you will be in grave danger. It is becoming urgent that you find more magic or rid yourself of the book as quickly as possible.<br><br>The voices fade away, leaving you with an uneasy feeling.<br><br>");
		md.write("</p>")
	}
	if (whereItem(1) == Place) md.write("<p>The topmost paper has Mr Beasley's name printed in bold.</p>");
	if (!checkPlaceFlag("HistoryClassroom", 8)) {
		setPlaceFlag("HistoryClassroom", 8);
		md.write("<p>You return the Stears letter you found, probably stolen by Davy Robbins.</p>")
	}
	startQuestions();
	addLinkToPlaceO(md, "examine the books in the bookcase", 27, "", "", "passTime(true,2)");
	if (checkPlaceFlag("HistoryClassroom", 8)) addLinkToPlaceO(md, "re-read the letter from Mrs. Stears", 27, "type=stears");
	if (checkPlaceFlag("HistoryClassroom", 5)) addLinkToPlaceO(md, "re-read 'The Settlement of Glenvale'", 27, "type=settlement");
	if (checkPlaceFlag("Crypt", 2)) addLinkToPlaceO(md, "re-read 'The Death of Kurndorf'", 27, "type=crypt");
	if (perAbby.getQuestDragonGem() > 0) addLinkToPlaceO(md, "re-read 'The Gem of the Dragon'", 27, "type=gem");
	if (checkPlaceFlag("HistoryClassroom", 6)) addLinkToPlaceO(md, "re-read 'Greek Mythology'", 27, "type=greek");
	if (checkPlaceFlag("HistoryClassroom", 9)) addLinkToPlaceO(md, "re-read 'Rituals under the Broken Inn'",
		27, "type=rituals");
	if (checkPlaceFlag("HistoryClassroom", 10)) addLinkToPlaceO(md, "re-read 'Following the Water'", 27, "type=bookhydromancy");
	if (checkPlaceFlag("HistoryClassroom", 11)) addLinkToPlaceO(md, "re-read 'Pharmakopoeia'", 27, "type=bookpharma");
	if (checkPlaceFlag("HistoryClassroom", 12)) addLinkToPlaceO(md, "re-read 'Witches of Pennsylvania'", 27, "type=bookwitches");
	addLinkToPlace(md, "exit the room?", 70);
	WritePlaceFooter(md)
}

function ShowPlace11() {
	if (!isShopOpen(2)) return dispPlace(77);
	var bCharmed = perBeasley.isCharmedBy();
	var perLeanne = findPerson("Leanne");
	var bBookHere = whereItem(4) === 76 && (getBeasleyServant() === 50 || perYou.checkFlag(8));
	if (bBookHere)
		if (!perBeasley.checkFlag(3) || isCharmedBy("Catherine", "MrBeasley")) return dispPlace(74);
	if (perBeasley.place !== 11) return dispPlace(77);
	var md = WritePlaceHeader(false, sType.indexOf("gabbyaskboundbeasley") != -1 && perBeasley.checkFlag(13) ? "td-left-med" : "");
	var nm = perBeasley.getPersonName();
	var ynm = perBeasley.getYourNameFor();
	if (sType.indexOf("gabbyaskboundbeasley") != -1 && perBeasley.checkFlag(13)) perBeasley.showPerson("beasley8-bondage.jpg");
	else if (bCharmed) perBeasley.showPerson("beasley7" + perBeasley.getGenderSuffix() + ".jpg");
	else perBeasley.showPerson("beasley1.jpg");
	var bGabbyTold = checkPersonFlag("Gabby", 1) && !isArrestPossible();
	addPlaceTitle(md, nm + "'s Office");
	if (bCharmed) {
		if (perBeasley.checkFlag(10)) md.write('<p>Miss Beasley giggles, "Oh ' + ynm + '," she says, admiring you in the way a teacher should not. "It\'s way wrong to use that suff on your teacher. If you you keep being bad you will have to punish your teacher...I mean like I will have to do you...punish you."');
		else if (perBeasley.checkFlag(11)) md.write('<p>Your slut, Miss Beasley stands as you enter the classroom, slightly panting, she was probably masturbating while she was on her own. "Oh ' + ynm + '," she says, looking lustfully at you in the way a teacher should not. "It is wrong for you leave your teacher without doing your assignment. I told you to fuck me!"');
		else if (perBeasley.checkFlag(12)) md.write('<p>"Oh ' + perYou.getMaster() + '," she says, looking at you submissively. "What do you want your teacher to do, or do to your teacher?"');
		else md.write('<p>"Oh ' + ynm + '," ' + perBeasley.getHeShe() + ' says, admiring you in the way a teacher should not. "It is wrong for you to use magic on your teacher. If you insist on misbehaving I will have to give you a suitable punishment."');
		if (whereItem(4) == 76) md.write('<p>"Oh yes," ' + perBeasley.getHeShe() + " says, lust in " + perBeasley.getHisHer() + ' eyes. "' + getProsecutor() + ' White had something of yours.  I took the liberty of retrieving it for you...  for safe keeping of course."</p>');
		else if (perYou.getExperience() >=
			14 && !isSpellKnown("Possession") && !perYou.isBornMale() && perBeasley.other == 3) md.write('<p>"I see you still have the book. I know a spell that you might want to learn"</p>');
		if (perYou.checkFlag(12) && !perYou.checkFlag(25))
			if (bGabbyTold && !perBeasley.checkFlag(9)) md.write("<p>You consider what Gabby told you about hypnosis and consider asking " + nm + " about it.</p>");
			else {
				md.write("<p>You consider the hypnotic technique " + nm + " talked about, but ");
				if (!perYou.checkFlag(24)) md.write("you do not know the basics of hypnosis.</p>");
				else if (!perYou.canUseExperience(true)) md.write("you are not confident you can learn it, you think you need more practise with magic first.</p>")
			}
	} else {
		md.write("<p>" + nm + " looks tired from the day's work. As you enter, " + perBeasley.getHeShe() + " groans with despair of seeing another student, then recognises you.</p><p>");
		if (perYou.checkFlag(12) && !perYou.checkFlag(25))
			if (bGabbyTold && !perBeasley.checkFlag(9)) md.write("You consider what Gabby told you about hypnosis and consider asking Mr Beasley about it.</p><p>");
		if (getBeasleyServant() >= 50) md.write("So you are back " + ynm + ". I lost the book earlier. Have you seen it?");
		else if (perYou.isBornMale())
			if (perYou.getExperience() < 4) md.write('"Oh hello ' + ynm + " I suppose that you are here to ask for an extension of your assignment. You know, I am rather tied up at the moment and have better things to do than to grant foolish young man like you extensions all the time.");
			else md.write('"Well hello again ' + ynm + '," ' + nm + ' sighs.  "What do you want now?');
		else if (perYou.getExperience() <
			14) md.write('"' + ynm + ". So good to see you. If it's about an assignment extension then please take as long as you like. I can even give you personal tutoring if you like...");
		else {
			md.write('<p>"So you have returned, ' + ynm + ". ");
			if (!perBeasley.checkFlag(5)) md.write("  I know what you are up to and you can not cast your spells on me. I have shielded myself against magic. ");
			if (perYou.getExperience() >= 14 && !isSpellKnown("Possession") && !perYou.isBornMale() && perBeasley.other == 3) md.write("I see you still have the book. I know a spell that you might want to learn,")
		}
		md.write('" ' +
			perBeasley.getHeShe() + " says, casting " + perBeasley.getHisHer() + " eyes over you.");
		if (perYourBody.FindItem(1)) md.write(" " + perBeasley.getHisHer() + " eyes focus on the paper in your pocket and " + perBeasley.getHeShe() + ' grins, "Make sure to return the paper when you have finished studying it, you will find it enlightening"</p>');
		else md.write("</p>")
	}
	startQuestions();
	if (bCharmed) {
		if (perBeasley.getCharmedLevel() == 2 && perBeasley.getPersonGender() == "man") addLinkToPlaceO(md, "order " + nm + " to kiss you", 11, "type=service");
		else if (perBeasley.getPersonGender() == "woman") addLinkToPlaceO(md, "fuck " + nm, 11, "type=service");
		if (perDavy.other == 6) addQuestionC(md, "ask " + nm + " where Davy has gone", "MrBeasley", 5501);
		if (perYou.checkFlag(12)) {
			if (perYou.canUseExperience(true) && perYou.checkFlag(24) && !perYou.checkFlag(25)) addQuestionC(md, "ask " + nm + " to teach you the hypnotic technique", "MrBeasley", 5503)
		} else if (perBeasley.checkFlag(3)) addQuestionC(md, "ask " + nm + " about Amy and Catherine before", "MrBeasley", 5504);
		if (bBookHere) addQuestionC(md,
			"ask " + nm + " for the Book", "MrBeasley", 5600)
	}
	if (perYou.checkFlag(12) && !perYou.checkFlag(25) && !perBeasley.checkFlag(3))
		if (bGabbyTold && !perBeasley.checkFlag(9)) addQuestionC(md, "ask " + nm + " about Hypnosis", "MrBeasley", 5505);
	if (getPersonOther("Diane") == 9) addQuestionC(md, "ask " + nm + " if " + perBeasley.getHeShe() + " has the book", "MrBeasley", 579);
	if (perYou.FindItem(4) > 0 && (perBeasley.other === 0 || !isMurderPath() && !perBeasley.checkFlag(7) && !perBeasley.checkFlag(8))) {
		if (!isMurderPath()) startAlternatives(md);
		addQuestionC(md,
			"tell " + nm + " that you have the book", "MrBeasley", 190);
		if (!isMurderPath()) {
			addQuestionC(md, "then again, it might be best to keep it secret from " + perBeasley.getHimHer(), "MrBeasley", 189);
			endAlternatives(md)
		}
	} else if (perYou.FindItem(4) > 0 && (!isMurderPath() || perBeasley.other === 1) && !perBeasley.checkFlag(6) && perBeasley.checkFlag(7)) {
		startAlternatives(md);
		addLinkToPlaceO(md, "give " + nm + " the book", 71);
		addQuestionCO(md, "no way, keep the book", "MrBeasley", 187);
		endAlternatives(md)
	} else {
		if (perBeasley.other ===
			1) addQuestionC(md, "ask " + nm + " what does mana do", "MrBeasley", 191);
		else if (perBeasley.other === 2 || perGates.other === 9) addQuestionC(md, perBeasley.other === 2 ? "ask where you can find mana" : "ask where to find magic stones", "MrBeasley", 192);
		if (perYou.getExperience() >= 14 && !isSpellKnown("Possession") && !perYou.isBornMale())
			if (!bCharmed)
				if (perBeasley.other === 3) addQuestionC(md, "ask " + perBeasley.getHimHer() + " about the spell", "MrBeasley", 193);
				else if (perBeasley.other === 4) addQuestionC(md, 'ask how much "compensation" ' +
			perBeasley.getHeShe() + "'s talking about", "MrBeasley", 194);
		else {
			if (perBeasley.other === 5) addQuestionCO(md, "pay " + perBeasley.getHimHer() + " " + sCurrency + "100 to learn the spell", "MrBeasley", 195)
		} else if (perBeasley.other < 6) addQuestionCO(md, "tell " + nm + " to teach you that spell " + perBeasley.getHeShe() + " mentioned", "MrBeasley", 1931);
		if ((perBeasley.other === 6 || perBeasley.other === 7) && !perYou.isBornMale()) addQuestionCO(md, "try and research the spell again", "MrBeasley", 196);
		if (whereItem(4) == 76 && bCharmed) addQuestionC(md,
			"demand that " + perBeasley.getHeShe() + " give you the book.", "MrBeasley", 5502);
		if ((perGates.other === 16 || perGates.other === 17) && !perBeasley.checkFlag(2)) addQuestionC(md, 'ask about an "old key"', "MrBeasley", 1E3);
		if (perLeanne.place == 382 && !perLeanne.checkFlag(11)) addQuestionC(md, "ask about saving a person from demons", "MrBeasley", 700)
	}
	addLinkToPlace(md, "exit the room?", 70);
	WritePlaceFooter(md)
}

function StudyPuzzle(doc, bTrue) {
	var perKate = findPerson("Kate");
	if (bTrue === undefined) bTrue = perKate.checkFlag(33) && doc.Puzzle.answer.selectedIndex * 25 / 50 == 3.5 || perKate.checkFlag(34) && doc.Puzzle.answer.value == 29 || perKate.checkFlag(35) && doc.Puzzle.answer.value == 24;
	if (bTrue) perKate.other = 5;
	else perKate.other = 4;
	dispPlace(13)
}

function ShowPlace12() {
	var md = WritePlaceHeader(true);
	addPlaceTitle(md, "Mathematical Puzzle", "", 0, true);
	var perKate = findPerson("Kate");
	if (!perKate.checkFlag(33) && !perKate.checkFlag(34) && !perKate.checkFlag(35)) perKate.setFlag(Math.floor(Math.random() * 3) + 33);
	md.write('<div style="text-align:left;">' + '<table class="table-main"><tr>' + '<td colspan="2"><p>This puzzle looks quite easy for a mathematical genius like yourself. Kate looks to you with ' + "hopeful expection. If only you could solve this problem she might like you a whole lot more but be careful. You only get one shot.</p>" +
		"</td></tr><tr>" + '<td style="width:40%">');
	if (!isPuzzles()) {
		md.write('<img src="Images/math1.jpg" width="95%" style="float:left;margin:0px 5px" alt="Math"/>' + '</td><td style="vertical-align:top">' + "<p>You study Kate's math problem and you can see the answer to it</p>");
		startQuestions();
		addOptionLink(md, "answer the problem", "StudyPuzzle(document,true)");
		addOptionLink(md, "be distracted by Kate and answer the problem", "StudyPuzzle(document,false)")
	} else if (perKate.checkFlag(33)) md.write('<img src="Images/math1.jpg" width="95%" style="float:left;margin:0px 5px" alt="Math"/>' +
		'</td><td style="vertical-align:top">' + '<div style="text-align:center;">Insert the missing number: ' + '<table style="background-image:url(' + getThemeFolder() + 'background.jpg);padding:0px;border-collapse:collapse;border-spacing:0;border-width:0;margin-right:auto;margin-left:auto">' + '<tr><td style="text-align:center;width:30px"><p style="text-align:center;">6</p></td><td style="text-align:center;width:30px"><p style="text-align:center;">17</p></td><td style="text-align:center;width:30px"><p style="text-align:center;">37</p></td></tr>' +
		'<tr><td style="text-align:center;width:30px"><p style="text-align:center;">10</p></td><td style="text-align:center;width:30px"><p style="text-align:center;">10</p></td><td style="text-align:center;width:30px"><p style="text-align:center;">25</p></td></tr>' + '<tr><td style="text-align:center;width:30px"><p style="text-align:center;">12</p></td><td style="text-align:center;width:30px"><p style="text-align:center;">32</p></td><td style="text-align:center;width:30px"><p style="text-align:center;">?</p></td></tr>' +
		"</table></div>" + '<form method="POST" name="Puzzle">' + '<p style="text-align:center;">Answer: ' + '<select name="answer" size="1"> <option selected value="8">8</option><option value="12">12</option><option value="13">13</option><option value="16">16</option><option value="44">44</option><option value="52">52</option><option value="64">64</option><option value="70">70</option><option value="75">75</option><option value="90">90</option></select>');
	else if (perKate.checkFlag(34)) {
		AddImage("math2.jpg");
		md.write('</td><td style="vertical-align:top">' +
			'<div style="text-align:center;">Insert the missing number <span style="font-size:x-small">(puzzle by Stephen Froggatt)</span>: ' + '<form method="POST" name="Puzzle">' + '<p style="text-align:center;">Answer: ' + '<select name="answer" size="1">' + '<option selected value=7">7</option>' + '<option value="12">12</option>' + '<option value="13">13</option>' + '<option value="16">16</option>' + '<option value="29">29</option>' + '<option value="52">52</option>' + '<option value="64">64</option>' + '<option value="70">70</option>' +
			'<option value="75">75</option>' + '<option value="90">90</option>' + "</select>")
	} else {
		AddImage("math3.jpg");
		md.write('</td><td style="vertical-align:top">' + '<div style="text-align:center;">Insert the missing number <span style="font-size:x-small">(puzzle by Stephen Froggatt)</span>: ' + '<form method="POST" name="Puzzle">' + '<p style="text-align:center;">Answer: ' + '<select name="answer" size="1">' + '<option selected value="8">8</option>' + '<option value="12">12</option>' + '<option value="13">13</option>' +
			'<option value="24">24</option>' + '<option value="44">44</option>' + '<option value="56">56</option>' + '<option value="64">64</option>' + '<option value="79">79</option>' + '<option value="75">75</option>' + '<option value="90">90</option>' + "</select>")
	}
	if (isPuzzles()) {
		md.write(' <input type="button" name="button" value="Go" onClick="StudyPuzzle(document)"></p></form>');
		startQuestions("If it is too hard then:")
	}
	addOptionLink(md, "go to the library reception?", "LeaveKate6()");
	WritePlaceFooter(md)
}

function ExitStudyPuzzle() {
	if (whereItem(3) == 13) moveItem(3, 3);
	gotoPlace(3)
}

function ExitStudyPuzzleWrong() {
	gotoPlace(3);
	WriteComments("<p>Kate storms out of the study area and you follow behind her embarassed. As you decide what to do next the librarian at the reception desk calls out to you.</p>" + '<p>"Excuse me, your friend dropped this, will you please give it to her or put it in the bin"</p>' + "<p>You see it is some papers, just some notes, nothing she needs and also an envelope, nothing inside it. It was addressed to Kate at her home, you now know her address.</p>")
}

function ShowPlace13(stype) {
	var md = WritePlaceHeader(false, "td-center");
	var perKate = findPerson("Kate");
	if (perKate.other == 4) {
		perKate.place = 1E3;
		perKate.charmThem(4, "Davy");
		perKate.other = 999;
		setPlaceKnown("GrangerHouse");
		setPlaceKnown("Alley");
		perKate.setFlag(4);
		perKate.showPerson("kate3b.jpg");
		addPlaceTitle(md, "Wrong Answer");
		md.write("<p>Kate glares.</p>" + '<p>"You liar!" she exclaims. "How dare you lie to me about your mathematics exam. I should have known better than to trust an imbecile like you. Ha! If ever I see your face again then it will be one too many times!"</p>' +
			"<p>Speechless about being discovered, you try to back away. You are so embarrassed you can not answer her accusations.</p>");
		startQuestions();
		addOptionLink(md, "go to the library reception?", "ExitStudyPuzzleWrong()")
	} else if (stype === "") {
		perKate.place = 1;
		addPlaceTitle(md, "Right Answer", "", 0, true);
		md.write('<p>Kate beams a smile. "Oh!" she exclaims. "How did you ever solve it so quickly? I have been working on this problem since Tuesday. You must be a genius."</p>' + "<p>You brag about your finesse in mathematics and how you could solve as many problems as anyone could dish out.</p>" +
			"<p>Seeing Kate respond so favourably you start to wonder whether the rumours about her are really true. Maybe she is as horny as Davy Robbins has claimed." + "You feel your " + (perYou.isMaleSex() ? "dick" : "nipples") + " stiffen in arousal as she leans towards you, and you find it difficult to avoid staring at her cleavage. You begin to wonder what it would be like to have the school nerd for your own.</p>" + '<p>"Maybe we could spend some more time together?" she suggests, handing you a slip of paper.</p><p>' +
			'<p>You look at the paper. It has Kate\'s address on it. "Thanks!" you reply, almost too keenly. "I\'m actually doing some research into the old book that Mr Beasley talked about today. Can you help me by finding out what magic is around town?"</p>' + '<p>"Sure, ' + perYou.getPersonName() + ". I'll look around the library and let you know what I find.\"</p>" + '<p>You reply, "Much appreciated."</p>' + "<p>Your eyes are drawn back towards Kate's cleavage, and you think she might have noticed, you are tempted to look more openly and be damned for doing! Then again her rear is very round and tempting...</p>");
		startQuestions();
		addLinkToPlaceO(md, "look at her cleavage", 13, "type=cleavage");
		addLinkToPlaceO(md, "'accidentally' touch her ass", 13, "type=ass");
		addOptionLink(md, "go to the library reception?", "ExitStudyPuzzle()");
		AddRightColumnLarge(md);
		perKate.showPerson("kate3c.jpg")
	} else if (stype == "cleavage") {
		perKate.setFlag(5);
		addPlaceTitle(md, "Damn!", "", 0, true);
		md.write("<p>You know Kate saw you looking at her breasts, so you decide you might as well be shouted at or slapped for the works. You look at her large breasts with great appreciation, making no effort to hide it, fully expecting to pay for it in pain, either verbal or physical.</p>" +
			'<p>Kate stands up, and just says "I..I should leave now, I need to get some things back at home"</p>' + "<p>You are surprised, she does not look angry! As you look she straghtens her top and accidentally does so in a way that further accentuates her breasts. It has to be an accident, doesn't it?</p>" + "<p>As you puzzle this over, Kate leaves giving you a little wave goodbye and says 'See you soon?'</p><p>");
		startQuestions();
		addOptionLink(md, "go to the library reception?", "ExitStudyPuzzle()");
		AddRightColumnLarge(md);
		perKate.showPerson("kate3d.jpg")
	} else if (stype == "ass") {
		perKate.setFlag(5);
		addPlaceTitle(md, "Oops!", "", 0, true);
		md.write("<p>You know Kate saw you looking at her breasts, so you look away and walk with her back towards the main area of the library. As she steps ahead, you reach out and 'accidentally' put your hand on her rear. You immediately expect to be slapped but it was worth it!</p>" + '<p>Kate looks around at you and just says "I..I should leave now, I need to get some things back at home"</p>' +
			"<p>She looks a little annoyed but to your surprise she does not look angry! As you look she almost poses to accentuate her figure and her lovely rear-end. It has to be an accident, doesn't it?</p>" + "<p>As you puzzle this over, Kate leaves and says 'See you soon?'</p><p>");
		startQuestions();
		addOptionLink(md, "go to the library reception?", "ExitStudyPuzzle()");
		AddRightColumnLarge(md);
		perKate.showPerson("kate3e.jpg")
	}
	WritePlaceFooter(md)
}

function ShowPlace14(stype) {
	var md = WritePlaceHeader();
	var perSofia = findPerson("Sofia");
	if (perSofia.isCharmedBy()) perSofia.showPerson("sofia_office_charmed.jpg");
	else perSofia.showPerson("sofia_office_noncharmed.jpg");
	addPlaceTitle(md, "Gates's Mansion Garage Office");
	md.write("<p>The room looks like a small work station with few basic furniture, a coffee table, chairs, some houseplants and one or two paintings. There is a door which leads to the upper floor of the place. That is where the chauffeur's bedroom is located. Other than that there\u2019s another wood-door that connects the office with garage, where the family\u2019s cars are stored.</p>");
	if (perSofia.isCharmedBy()) md.write("<p>Sofia is standing between the coffee table and the chairs, already lifting up her dress, playing with her panty. She felt your arrival.</p>");
	else if (perSofia.checkFlag(3)) md.write("<p>Sofia is standing between the coffee table and the chairs, watching you suspiciously, ready to jump at you if you try anything stupid.</p>");
	else md.write("<p>The chauffeur is standing between the coffee table and the chairs, watching you suspiciously, ready to jump at you if you try anything stupid.</p>");
	startQuestions();
	addLinkToPlace(md, "leave the office", 15);
	WritePlaceFooter(md)
}

function ShowPlace15(stype) {
	var md = WritePlaceHeader();
	addPlaceTitle(md, "Gates's Mansion Garage", "mansiongarage.jpg");
	md.write("<p>This house must have been built much later than the mansion. It looks stylish, simple and modern. The three huge doors give away this building\u2019s purpose; it\u2019s a garage. Interestingly, it has an office area and one upper floor which is for living you presume. This must mean that a servant or one of the help lives here.</p>");
	var perSarah = findPerson("Sarah");
	var bSarahMet =
		perSarah.checkFlag(7);
	var perSofia = findPerson("Sofia");
	startQuestions();
	if (perSofia.whereNow() == 999) addPopupLinkC(md, "go to the entrance door", "Garage Office", "<p><img src='Images/steeldoor.jpg' style='width:40%;float:right;margin-left:5px' alt='Garage Door'>" + "There is a reinforced steel door which prevents you from entering an office area. The office is empty, Sofia is gone.", false);
	else if (bSarahMet && perSofia.whereNow() === 0) addPopupLinkC(md, "go to the entrance door", "Garage Office", "<p><img src='Images/steeldoor.jpg' style='width:30%;float:right;margin-left:5px' alt='Garage Door'>" +
		"The steel door is unlocked from the inside and it\u2019s slightly open, leaving an opportunity to you to check around. Someone is in the office!.", false, 'movePerson("Sofia", 14);gotoPlace(14)');
	else if (!bSarahMet) addPopupLinkC(md, "go to the entrance door", "Garage Office", "<p><img src='Images/steeldoor.jpg' style='width:40%;float:right;margin-left:5px' alt='Garage Door'>" + "There is a reinforced steel door which prevents you from entering an office area. As you look through one of the windows you feel like you are not missing out on anything interesting.</p><p>The place looks empty and no one\u2019s here.",
		false);
	else if (getHour() > 7 && getHour() < 10) addPopupLinkC(md, "go to the entrance door", "Garage Office", "<p><img src='Images/steeldoor.jpg' style='width:40%;float:right;margin-left:5px' alt='Garage Door'>" + "This reinforced steel door is impossible to break. You have to get in there in an another way.", false);
	else addLinkToPlace(md, "enter the garage office", 14);
	addLinkToPlace(md, "return to the mansion entrance", 16);
	WritePlaceFooter(md)
}

function EnterMansion() {
	if (isPossess("cast")) CancelPossession();
	var plcAR = wherePerson("AdeleRoss");
	var perS = findPerson("Sarah");
	if (!isMurderPath())
		if (plcAR === 16) dispPlace(186);
		else if (perGates.other >= 499 && perGates.other <= 700) WriteComments("The front door is locked and there is no answer to the door bell. You would guess you are not welcome back.");
	else if (!isDay()) {
		WriteComments("The front door is locked and there is no answer to the door bell. You would guess they are not accepting visitors at night.");
		perGates.setFlag(5)
	} else if (perS.place == 192 && perS.other >= 100 || perGates.checkFlag(3)) dispPlace(18);
	else gotoPlace(17);
	else if (perS.place > 0)
		if (plcAR === 16) dispPlace(186);
		else if (!isDay()) WriteComments("The front door is locked and there is no answer to the door bell. You would guess they are not accepting visitors at night.");
	else visitSarah();
	else if (perYou.getExperience() > 6 && getPersonCharm("OfficerKhan") < 2) gotoPlace(65);
	else gotoPlace(19)
}

function LeaveMansionStudy() {
	var perS = findPerson("Sarah");
	if (perS.place == 192 && perS.other >= 100) {
		if (perS.other == 100) perS.other = 101;
		gotoPlace(18)
	} else if (perGates.other >= 499 && !isMurderPath()) {
		if (perGates.other > 499) movePerson("Kurndorf", 16);
		gotoPlace(16, "", "As you leave you hear a loud clacking as multiple locks as secured on the front door. It seems you are not welcome back")
	} else gotoPlace(16, "", !isDay() ? "As you leave you hear a loud clacking as multiple locks as secured on the front door. Seems that further visits are not welcome tonight" :
		"")
}

function ShowPlace16() {
	var md = WritePlaceHeader();
	var plcAR = wherePerson("AdeleRoss");
	addPlaceImage(md, "mansion.jpg");
	if (wherePerson("Kurndorf") == 16) {
		md.write('<img src="Images/ghost2.png" style="float:left;position:absolute; width:30%;width:10vw; top:10; left:0;margin:0px 5px;border-style:none" alt="Ghost">');
		addBackgroundImage("Images/ghost2.png", "", nTheme === 0)
	}
	addPlaceTitle(md, perGates.getPersonName() + "' House", "", isPlaceKnown("Tunnel") ? 25 : 100);
	md.write("<p>The house is one of the oldest and most prestigious buildings of the town. " + "Built originally as the country estate of a powerful noble family, it has weathered many years of use. It has passed from family to family over the centuries, some of the gentiles who have lived here include: Lord Geoff Halliway, Lord Percy Halliway, Lady Elizabeth Ross and Lord Beasley before bankruptcy caused the last noble family to sell the house. " +
		"A wealthy industrialist had the house moved brick by brick to the outskirts of Glendale in the late 19th century, including the family graves. The industrialist in turn went bust in the Great Depression, and several wealthy families have owned it since then.</p>" + "<p>There is a set of garages inside a courtyard next to the mansion proper.</p>");
	if (wherePerson("Kurndorf") == 16) md.write("<p>You see a ghostly figure standing a distance away from the mansion, possibly a man, but it is so indistinct and barely visible.. The figure beckons to you and moves to lead you somewhere into the trees at one side of the mansion. As you do not immediately follow the figure waits, very slowly gesturing for you to follow.</p>");
	else if (!isMurderPath() && perGates.other < 11) md.write("<p>" + perGates.getPersonName() + " occupies the estate now and has done so for the last twenty-five years. A rather elusive man, he is not often seen visiting the town, preferring to send one of his servants to perform the menial task. Someone once said that " + perGates.getPersonNameShort() + " was a cranky old bugger with no friends or relatives, and that is why the house lights always go out soon after dusk.</p>");
	else if (isMurderPath() && perYou.getExperience() >
		6 && plcAR == 16) md.write("<p>There is a lot of bustle around the perimeter of the house as a police investigation is underway. Nervously you look for a way to slip away unseen./p>");
	startQuestions();
	addOptionLink(md, "enter " + perGates.getPersonNameShort() + "'s House", "EnterMansion()");
	addLinkToPlace(md, "visit the Garage area", 15);
	if (wherePerson("Kurndorf") == 16) addLinkToPlaceO(md, "follow the ghost", 141);
	else if (isPlaceKnown("SacredClearing")) addLinkToPlace(md, "go to the sacred clearing", 141);
	WritePlaceFooter(md)
}

function ShowPlace17() {
	if (isMurderPath()) return EnterMansion();
	var md = WritePlaceHeader();
	var perSarah = findPerson("Sarah");
	var bMetLauren = perSarah.place == 192 && perSarah.other >= 101;
	var perLauren = findPerson("Lauren");
	var perLeanne = findPerson("Leanne");
	var bLocked = !isDay() && (bMetLauren || perSarah.other == 1E3);
	if (perSarah.place == 17 && perSarah.other == 1) {
		perSarah.place = 192;
		perSarah.setFlag(7);
		perSarah.showPerson("sarah1b.jpg");
		addPlaceTitle(md, "Hallway to meet " + perGates.getPersonName());
		md.write("<p>You are walking through the mansion to meet " +
			perGates.getPersonName() + " and a young woman steps in front of you and challenges you,</p>" + '<p>"What are you doing in my Mansion? Get out before I call the police!"</p>' + "<p>You explain who you are and that you are here to see " + perGates.getPersonName() + ', and ask "What do you mean <i>your</i> Mansion, this is ' + perGates.getPersonNameShort() + "'s home!\" She looks startled,</p>" + '<p>"My apologies ' + (perYou.isMaleSex() ? "Sir" : "Miss") + " Apprentice, I am Sarah Gates, " + perGates.getPersonNameShort() + "'s neice. Uncle Ronny has told me <i>all</i> about you. Why don't you follow me to see him!</p>");
		startQuestionsOnly();
		addLinkToPlaceO(md, "follow her", 17, "", "On your way to see " + perGates.getPersonName() + ", the girl says you may call her Sarah, and that she is here visiting her uncle for a few days. She softly giggles and says how boring she <i>thought</i> it was going to be.", "Sarah", "bChatLeft=false;")
	} else {
		if (perSarah.place == 192 && perSarah.other < 100) perSarah.other = 100;
		perGates.showPerson("gates2.jpg");
		addPlaceTitle(md, perGates.getPersonName());
		if (perGates.other === 0) {
			md.write("<p>An elderly gentleman is sitting behind a large desk made from oak. The whole room is stuffed with things from the past. Paintings and pictures from 19th century decorate the walls and a great Chandelier hangs from the ceiling. The dark blue  color of the walls and the smell of old wood sets the mood of the place. It is certainly a very old room!</p>" +
				"<p>The old man must be " + perGates.getPersonNameShort() + " himself! He\u2019s kind of a legend around here, becoming part of the mythos involving the witches and warlocks of the past. Some say he is a warlock himself who\u2019s here to guard something very important. On a more earthly plane, some people claim that " + perGates.getPersonNameShort() + " served in army intelligence while others believe that he worked for S-Biomed, the elusive FBI branch dedicated to preempting chemical warfare. Nobody knows how he earned his knighthood and, if " +
				perGates.getPersonNameShort() + " has anything to do with it, they will never find out.</p>" + "<p>The moustached man looks at with you with wise eyes. You can feel his commanding presence even though he looks to be in his 70\u2019s. He has a wooden pipe in his hands, toying with it while glancing at you. After a while he stops, puts the pipe in his mouth, and lights it. Finally he gestures for you to approach. You know he can be an influential ally\u2026 or a powerful enemy if you anger him.</p>" + '<p>"Welcome," he says with a silvery voice. "I don\'t get to receive guests very often, and even less often do I receive uninvited guests. I assume that you are here to sell me something. Well, as I told the last salesman, I have all that I need right here."</p>' +
				"<p>Something catches your eye; beside " + perGates.getPersonNameShort() + "'s desk is a book. Could it be the one?</p>");
			perYou.completeQuest(4)
		} else if (perGates.other < 3) md.write("<p>" + perGates.getPersonNameShort() + " smiles warmly toward you. The old man has taken a liking to your good manners.");
		else if (perGates.other == 3) md.write("<p>The old man waits for you reply. Are you brave enough to accept his challenge?");
		else if (perGates.other == 5) md.write("<p>" + perGates.getPersonNameShort() + " is very annoyed at your disturbance.");
		else if (perGates.other >= 9 && perGates.other <= 13) md.write("<p>The old man is waiting for you, his apprentice, to return with a <b>magic stone</b> to prove your worth and begin your training." + '<p>"Well then, my ' + perYou.getSex() + '," he says jovially.  "Have you found a stone yet?"</p>');
		else if (perGates.other == 14) md.write("<p>" + perGates.getPersonNameShort() + " gives you a warm smile.</p>" + '<p>&nbsp;"Ahh a young person with integrity," he says, "Thank you ' + perYou.getPersonName() + '. Now it is time for you to learn your first spell."</p>' +
			'<p>"Are you ready?"<p>');
		else if (perGates.other == 15) md.write('<p>"Go ahead," says ' + perGates.getPersonNameShort() + '. "Try to learn the spell"<p>');
		else if (perGates.other == 16) md.write("<p>" + perGates.getPersonNameShort() + ' nods his head. "You are doing well my apprentice."</p><p>"Now use your power to find me a special artifact. It is an <b>old key</b> that was stolen from me two years ago."</p>');
		else if (perGates.other == 17) md.write("<p>" + perGates.getPersonNameShort() + ' nods his head in greeting. "You are doing well, my apprentice. Have you found the key that was stolen from me?."</p>');
		else if (perGates.other > 18 && perGates.other < 21) {
			md.write('<p>The old man is very concerned. "My dear ' + perYou.getSex() + '," he says. "I have put you in grave danger. My enemy has broken into my vault, and even killed my guard in an attempt to steal the book.  Luckily I had already given it to you. I fear that my enemy will come after both of us."</p>');
			if (perYourBody.FindItem(39) === 0) md.write("<p>You are very confused by the statements and want to know more.<p>" + "<p>" + perGates.getPersonNameShort() + ' dismisses your questions to order you, "Find the old key. It is our only hope."</p>');
			else md.write('<p>"Do you have the key? Give it to me now!" says ' + perGates.getPersonNameShort() + ".<p>")
		} else if (perGates.other >= 500 && !isMurderPath()) {
			md.write("<p>" + perGates.getPersonNameShort() + " is taken aback by your rudeness and seems very intent on <i>not</i> allowing you to leave with the book.  He glares at you in an attempt to be menacing.  You're not sure if you should be laughing at him, or afraid of what he might do next.");
			if (perGates.other == 501) md.write("<p>Unexpectedly, " + perGates.getPersonNameShort() +
				' stands up with a gun in his hand and aims it at your stomach. "I will <b>not</b> give you the book, and I suggest that you leave <b>immediately</b>!!" he declares defiantly.')
		} else {
			if (perGates.other < 499) md.write("<p>" + perGates.getPersonNameShort() + ' greets his apprentice, "I hope that you are learning the magic arts." He gives you a wink. ');
			else md.write("<p>" + perGates.getPersonNameShort() + " looks at you disappointed, waiting for you to leave his house. ");
			if (perGates.other < 23) md.write('"Whatever you do, never lose that book."<p>');
			if (perYou.getQuestAftane() == 25) md.write("<p>This is a most interesting and dangerous development.  Did anything else happen at the summoning of Kurndorf's spirit?\"</p>");
			else if (perYou.getQuestAftane() >= 50 && perKurndorf.getQuestRitual() < 200) md.write("<p>" + perGates.getPersonNameShort() + ' looks at you, all humor gone from his face.  "As long as Kurndorf remains free in this realm he is a great threat to everyone in the city.  And beyond."</p>' + '<p>"You must go to him, offer to help him - but be warned," He says, waving a finger at you as if to stab you in the chest, "Kurndorf is a master manipulator.  He will lie, cheat, and steal to get his way."</p>' +
				'<p>"Trust <i>nothing</i> he says.  He will try to mislead you.  You <i>must</i> find a way to trick him and turn his plan against him." He says leaning back in his chair in exhaustion.  You find yourself realizing for the fist time how truly <i>old</i> ' + perGates.getPersonNameShort() + " must be...  It is no wonder he was searching for your help.  He seems all but powerless to do much himself.</p>");
			if (perYou.getQuestAftane() == 60 && perKurndorf.getQuestRitual() < 200)
				if (!perKurndorf.checkFlag(1)) md.write('<p>"You must find the skull from Kurndorf\'s own crypt," He says.  "You may be able to use it against him.  If only my own collection were complete," he rails, "I\'m afraid I do not have any history book that might give us a clue to its location."</p>');
				else md.write('<p>"You have it, don\'t you.  I can <i>feel</i> it on you." He says, motioning towards your backpack.  "Keep it close, and let us hope that Kurndorf is not paying close enough attention to recognize his own... face."</p>');
			if (perSarah.place == 192) md.write("<p>Sarah Gates is standing to one side of the room watching with interest. She seems to be trying to attract your attention.</p>")
		}
		startQuestions();
		if (perGates.other == 500) addQuestionC(md, '"I <i>must</i> have the book!"', "SirRonald",
			500);
		else if (perGates.other == 501) addQuestionCO(md, "wrestle for the gun", "SirRonald", 501);
		if (perGates.other > 5 && perGates.other < 499 && !perGates.checkFlag(2)) addQuestionC(md, '"What sort of mundane assistance can you offer?"', "SirRonald", 37);
		if (perGates.other > 5 && perGates.other < 499 && nMoney < 20 && isItemNotHere(27, 17) && perGates.checkFlag(2)) addQuestionC(md, '"Thanks again, ' + perGates.getPersonNameShort() + ', can I ask for some more assistance."', "SirRonald", 35);
		if (perDavy.getQuestBlueBottle() == 4) addQuestionC(md,
			'"' + perGates.getPersonNameShort() + '...  Did you recently, uh...  acquire  a little blue bottle?"', "SirRonald", 5904);
		else if (perDavy.getQuestBlueBottle() == 5) addQuestionC(md, '"I think that it was the source of Davy\'s power... I may be able to stop him with it."', "SirRonald", 5905);
		if (perGates.other < 5) {
			startAlternatives(md);
			addQuestionC(md, '"I <i>demand</i> you give me the book!"', "SirRonald", 499)
		}
		if (perGates.other === 0) addQuestionC(md, "introduce yourself", "SirRonald", 30);
		else if (perGates.other == 1) addQuestionC(md,
			'"What do you mean, looking for someone?"', "SirRonald", 31);
		else if (perGates.other == 2) addQuestionC(md, '"What <i>gift</i> are you talking about?"', "SirRonald", 32);
		else if (perGates.other == 3) {
			addQuestionC(md, '"' + perGates.getPersonNameShort() + ', I accept your apprenticeship"', "SirRonald", 33);
			addQuestionC(md, '"' + perGates.getPersonNameShort() + ', I refuse your apprenticeship"', "SirRonald", 800)
		}
		if (perGates.other < 5) endAlternatives(md);
		if (perYou.isStuck()) addOptionLink(md, '"' + perGates.getPersonNameShort() + ', I am not sure how to get back to town?"',
			"WaitforForDayNight('', 194,'type=limolift')");
		if (perGates.other == 14 || perGates.other == 15) addQuestionCO(md, "try and learn the spell", "SirRonald", 314);
		else if (whereItem(4) == 999) addQuestionC(md, '"' + perGates.getPersonNameShort() + ', I have lost the book!"', "SirRonald", 999);
		if (isSpellKnown("Charm") && !perGates.checkFlag(7)) addQuestionC(md, "ask " + perGates.getPersonNameShort() + " about the Charm spell", "SirRonald", 14);
		if (perYourBody.FindItem(39) > 0) addOptionLink(md, "give " + perGates.getPersonNameShort() + " the old rusty key",
			"HandleItem(39,3,false)");
		if (perYou.getQuestAftane() == 1) addQuestionC(md, '"What is in the safe?"', "SirRonald", 901);
		else if (perYou.getQuestAftane() == 10) addQuestionC(md, '"What am I supposed to do with the talisman?"', "SirRonald", 910);
		if (perKurndorf.getQuestGhost() >= 50)
			if (perYou.getQuestAftane() == 11) addQuestionC(md, '"You know that enemy of yours?  I think he\'s back."', "SirRonald", 911);
			else if (perYou.getQuestAftane() == 12) {
			startAlternatives(md);
			addQuestionC(md, '"I... I was greedy.  I summoned him with a seance. I\'m so sorry!"',
				"SirRonald", 912);
			addQuestionC(md, '"That witch <i>tricked</i> me!  She summoned him and he tried to kill me!"', "SirRonald", 913);
			endAlternatives(md)
		} else if (perYou.getQuestAftane() == 15) {
			startAlternatives(md);
			addQuestionC(md, '"He offered to teach me the spell he was about to cast before he was killed...  A mass charm spell."', "SirRonald", 915);
			addQuestionC(md, '"He offered me nothing.  I left him there to rot in his own prison."', "SirRonald", 916);
			endAlternatives(md)
		} else if (perYou.getQuestAftane() == 20) addQuestionC(md,
			'"Yes.  He would have taken over my body were it not for the Aftane."', "SirRonald", 920);
		else if (perYou.getQuestAftane() == 25) {
			startAlternatives(md);
			addQuestionC(md, 'Lie - "No."', "SirRonald", 925);
			addQuestionC(md, 'Truth - "Well...  on the subject of creatures..."', "SirRonald", 926);
			endAlternatives(md)
		} else if (perYou.getQuestAftane() == 30) addQuestionC(md, '"Yes he did.  I tried to stop it, but it possessed a young girl and got away.  How can I stop it?"', "SirRonald", 930);
		else if (perYou.getQuestAftane() ==
			50 && perKurndorf.getQuestGhost() >= 100 && perKurndorf.getQuestRitual() < 200) addQuestionC(md, "tell him about the ritual Kurndorf described", "SirRonald", 950);
		else if (perYou.getQuestAftane() == 51 && perKurndorf.getQuestGhost() >= 100 && perKurndorf.getQuestRitual() < 200) addQuestionC(md, '"What trick? Please tell me."', "SirRonald", 951);
		if (perYourBody.FindItem(4) > 0 && perYou.checkFlag(11) && perYou.canUseExperience()) addOptionLink(md, "ask " + perGates.getPersonNameShort() + " for help deciphering the passages in the book",
			"spendExperience()");
		if (isDemonFreed() && !perGates.checkFlag(6)) addQuestionC(md, "ask " + perGates.getPersonNameShort() + " about demons", "SirRonald", 666);
		if (perSarah.place == 192 && perSarah.other > 101 && !perGates.checkFlag(3) && (perLauren.checkFlag(8) || perGates.checkFlag(5))) addQuestionC(md, '"' + perGates.getPersonNameShort() + ' why is the Mansion locked at night?"', "SirRonald", 600);
		if (perLeanne.place == 382 && !perLeanne.checkFlag(7)) addQuestionC(md, "ask " + perGates.getPersonNameShort() + " about saving Leanne", "SirRonald",
			700)
	}
	if (perSarah.place == 192 && perSarah.other >= 101) {
		if (!perGates.checkFlag(3) && !perLauren.checkFlag(8) && bLocked) {
			addLinkToPlace(md, "go to the entry hall", 18, "area=locked");
			addLinkToPlace(md, "exit the house", 18, "area=locked")
		} else addLinkToPlace(md, "go to the entry hall", 18, "area=entry");
		if (!bLocked) addLinkToPlace(md, "exit the house", 16)
	} else if (perGates.other > 499) addOptionLink(md, "back down and exit the house", "LeaveMansionStudy()");
	else addOptionLink(md, "exit the house", "LeaveMansionStudy()");
	if (perSarah.place ==
		192 && perSarah.other >= 100) {
		AddPeopleColumn();
		if (Math.random() < .5) perSarah.showPerson("sarah9b.jpg", "", "", "sarah1c.jpg");
		else perSarah.showPerson("sarah9b.jpg", "", "", "sarah1d.jpg")
	}
	WritePlaceFooter(md)
}

function ShowPlace18(stype) {
	var md = WritePlaceHeader();
	var perSarah = findPerson("Sarah");
	var perLauren = findPerson("Lauren");
	var myLord = perLauren.getYourNameFor();
	var perVamp = findPerson("Vampyre");
	var marea = getQueryParam("area");
	if (getQueryParam("charm") == "yes") CharmLauren(md);
	else if (marea == "upstairs") {
		addPlaceTitle(md, "Upstairs Hallway", "hallway1.jpg");
		md.write("<p>A hallway mostly leading to bedrooms, but the layout is quite old-fashioned with some common rooms like a shared bathroom.</p>");
		if (perSarah.place ==
			192 && perSarah.other == 101) md.write("<p>You notice a door is ajar and you hear the noise of running water.</p>");
		if (perSarah.place == 192 && (perSarah.other == 114 || perSarah.other == 117 || perSarah.other == 120)) md.write("<p>You do not see Lauren in the hallway. she must already be in Sarah's room.</p>");
		startQuestions();
		visitSarah(md);
		if (perLauren.flags[0] > 1 && isMurderPath() || !isMurderPath() && perGates.checkFlag(3)) addLinkToPlace(md, "go to the guest room", 290);
		if (perSarah.place == 192 && perSarah.other == 101) {
			addLinkToPlaceO(md,
				"check the room", 296, "stage=sarahlauren1");
			addLinkToPlace(md, "go downstairs", 18, "area=entry", "As you leave you hear a voice &quot;It appears this will be a boring visit&quot;", "", "LeaveNoBath()");
			if (isDay() || !perLauren.checkFlag(8)) addLinkToPlace(md, "exit " + perGates.getPersonNameShort() + "'s House", 16, "", "As you leave you hear a voice &quot;It appears this will be a boring visit&quot;", "", "LeaveNoBath()")
		} else {
			addLinkToPlace(md, "go downstairs", 18, "area=entry");
			if (isDay() || !perLauren.checkFlag(8)) addLinkToPlace(md,
				"exit " + perGates.getPersonNameShort() + "'s House", 16)
		}
	} else if (marea == "landing") {
		var idx = 5;
		if (perLauren.checkFlag(5)) idx++;
		if (perLauren.checkFlag(6)) idx++;
		perLauren.showPersonDN("lauren1c.jpg");
		addPlaceTitle(md, "Landing on the Stairs");
		md.write("<p>You follow the maid Lauren upstairs, and you meet her readjusting her clothing after stumbling. She nervously asks you,</p>" + '<p>"' + myLord + ' I am in a hurry, as I said, I am summomed to Lady Sarah".</p>' + "<p>She blushes again, and looks at you as she takes a step up the next set of stairs,<br>");
		startQuestions();
		switch (idx) {
			case 5:
				addQuestionR(md, "tell me about yourself", "<p>She hesitates, &quot;I am sure " + myLord + " I do not have the time, and surely you are more interested in Lady Sarah?&quot;. You follow her up the stairs, telling her that you also find her fascinating", "Lauren", "setPersonFlag(\\'Lauren\\'," + idx + ");setQueryParams(\\'area=upstairs\\');");
				break;
			case 6:
				addQuestionR(md, "why do you do these unusual services for Sarah", "<p>She blushes, &quot;I have no choice " + myLord + ", Lady Sarah has convinced me it is in my best interest to do what she desires&quot; You try to ask her more but she insists she <i>must</i> visit Sarah, and you follow her upstairs",
					"Lauren", "setPersonFlag(\\'Lauren\\'," + idx + ");setQueryParams(\\'area=upstairs\\')");
				break;
			case 7:
				addQuestionR(md, "tell her she is pretty", "<p>She hesitates, &quot;My Lady Sarah would not like to hear you say that " + myLord + ", but then again she has never been a person of <i>singular</i> tastes&quot; She smiles and continues walking upstairs", "Lauren", "setPersonFlag(\\'Lauren\\'," + idx + ");setQueryParams(\\'area=upstairs\\')");
				break
		}
		addLinkToPlaceO(md, "let her go upstairs", 18, "area=upstairs");
		addLinkToPlace(md,
			"go downstairs", 18, "area=entry", "", "", "setPersonOther('Sarah', getPersonOther('Sarah')+0.1);");
		addLinkToPlaceC(md, "visit " + perGates.getPersonName(), 17, "", "", "", "setPersonOther('Sarah', getPersonOther('Sarah')+0.1);")
	} else if (marea == "locked") {
		addPlaceTitle(md, "Locked Front Door", "door4.jpg");
		perLauren.setFlag(8);
		md.write("<p>You attempt to open the front door to leave and you find it is securely locked and dead-bolted. As you consider what to do, a person interrupts you, ");
		if (perSarah.other == 1E3) md.write(" a maid dressed rather scantily,");
		else md.write(" it is Lauren, Sarah's maid, dressed a bit differently,");
		md.write('</p><p>"' + myLord + ' I am sorry to tell you the mansion is strictly locked at night, and the doors will not be unlocked until sunrise.".</p>' + "<p>She notices your glances at her skimpy dress, and she blushes," + "<p>\"Sorry, My Lady insists I wear a ummm 'night uniform'\"</p>" + "<p>With some embarrassment she leaves, heading upstairs.</p>");
		startQuestions();
		addLinkToPlaceC(md, "visit " + perGates.getPersonName(), 17);
		addLinkToPlace(md,
			"go upstairs", 18, "area=upstairs");
		AddRightColumnMed();
		perLauren.showPersonDN("lauren1b.jpg");
		WritePlaceFooter(md);
		return
	} else if (perSarah.place == 192 && perSarah.other == 101) {
		perLauren.showPersonDN("lauren1b.jpg");
		addPlaceTitle(md, "Stopped in the Entry Hall");
		md.write('"Please, ' + myLord + '! I am Lauren, my Mistress has sent me to inform you of her arrival, but she is tired and need a special bath treatment and wishes to be alone! I am here to make sure you wait in your proper place for her! She told me to tell you that you are not to <i>go upstairs</i> to the third door on the right", she says in a slight english accent.</p>' +
			"You approach the huge and long stairs that would lead you to the second and third floor of the mansion. A girl walks down from the stairs in a stunning maid uniform. The uniform is the typical one which was worn by servants a hundred years ago with the only exception being this woman\u2019s skirt which is far more revealing and shorter than usual. You can even see that she\u2019s not wearing any panties! Well, she must be working here so you wait at the lowest steps of the stairs.</p>" + "Clearly, she is the lady\u2019s maid if the Gates family has more servants (which you are certain they do!) and that means she is responsible for her Lady\u2019s well being. A role which she fills with relentless loyalty and determination.</p>");
		startQuestions();
		addLinkToPlace(md, "follow her upstairs", 18, "area=upstairs");
		if (isDay() || !perLauren.checkFlag(8)) addLinkToPlace(md, "exit " + perGates.getPersonNameShort() + "'s House", 16, "", "As you leave you hear the maid softly speak &quot;Thank you, but My Lady will be disappointed.&quot;", "", "LeaveNoBath()")
	} else if (perSarah.place == 192 && perSarah.other == 109) {
		perLauren.showPersonDN("lauren1b.jpg");
		perSarah.other = 110;
		addPlaceTitle(md, "Met in the Entry Hall");
		md.write("<p>As you enter the entry way you are met by Sarah's maid Lauren again, she looks quite embarrassed.</p>" +
			'<p>"My Lady has asked me to tell you that her private room is upstairs, to the left of the <i>bathroom</i>".</p>' + "<p>She blushes as she mentions the bathroom, and she continues,<br>" + '<p>"My Lady extends an invitation to visit when you are free."</p>' + "<p>With her message delivered she walks upstairs, once again you notice her lack of panties.</p>");
		startQuestions();
		addLinkToPlace(md, "go upstairs", 18, "area=upstairs");
		addLinkToPlaceC(md, "visit " + perGates.getPersonName(), 17);
		if (isDay() || !perLauren.checkFlag(8)) addLinkToPlace(md,
			"exit " + perGates.getPersonNameShort() + "'s House", 16)
	} else if (perSarah.place == 192 && (perSarah.other == 114 || perSarah.other == 117 || perSarah.other == 120)) {
		perLauren.showPersonDN("lauren1b.jpg");
		addPlaceTitle(md, "Met in the Entry Hall");
		md.write("<p>As you enter the entry way see Sarah's maid Lauren she is just about to walk upstairs, she looks <b>very</b> embarrassed. You call out to her to say hello, and she almost jumps in surprise. She looks at you blushing,</p>" + '<p>"Sorry, My Lady has called me to her private room to...assist her with something".</p>' +
			"<p>She continues walking upstairs, and she hesitates,<br>" + '<p>"Please do not visit for a while."</p>' + "<p>She almost runs upstairs, once again you notice her lack of panties as she stumbles on the first landing of the stairs...</p>");
		startQuestions();
		addLinkToPlace(md, "follow her upstairs", 18, "area=landing");
		addLinkToPlaceC(md, "visit " + perGates.getPersonName(), 17);
		if (isDay() || !perLauren.checkFlag(8)) addLinkToPlace(md, "exit " + perGates.getPersonNameShort() + "'s House", 16)
	} else if (perSarah.place == 192 &&
		perSarah.other == 50 && isConspiracyPath()) {
		perLauren.showPersonDN("lauren1c.jpg");
		addPlaceTitle(md, "Lauren Meets you in the Entry Hall");
		md.write("<p>You step through the wall but it feels very strange, different than the previous times you have used the Pass spell. It was difficult to move and it felt almost like you had to push through <i>something</i>.</p>" + "<p>You find you are standing in the entry way for the Mansion, a grand room to show-off the mansion. As you look around cautiously you hear some footsteps approaching, startled you look for the source, but you see it is the maid Lauren approaching. She is now dressed in a stylised and skimpy maid uniform. She looks at you and gestures towards the grand staircase,</p>");
		if (perYou.FindItem(40) > 0) {
			perYou.completeQuest(6);
			md.write('<p>"Good evening ' + myLord + '! Do you have the gift for My Lady?", you show her the bottle of wine. Lauren nods, "My Mis..Lady asks we be quiet and join her in her room upstairs", she says in a slight english accent.</p>' + "<p>She leads the way upstairs, but after climbing only a few steps she stops and bends over to pick something up off the stairs. As she does you are in a perfect position to see up her very short skirt, and to see she is <i>not</i> wearing any panties. She stands back up and glances back at you, furiously blushing, and then continues upstairs without saying a word.</p>");
			startQuestions();
			addLinkToPlace(md, "follow her upstairs", 192)
		} else {
			md.write('<p>"Good evening ' + myLord + '! Do you have the gift for My Lady?". Oops! you have forgotten the wine. Lauren shakes her head, "Please return another time when you have the gift"</p>' + "<p>She shows you to the front door and opens it, after disabling a complex security system. She politely waits for you to leave, but also making it clear that you have to leave.</p>");
			startQuestions();
			addLinkToPlace(md, "exit " + perGates.getPersonNameShort() +
				"'s House", 16)
		}
	} else if (marea == "appear") {
		perLauren.showPersonDN("lauren1c.jpg");
		addPlaceTitle(md, "Lauren Meets you in the Entry Hall");
		md.write("<p>You step through the wall but it feels very strange, different than the previous times you have used the Pass spell. It was difficult to move and it felt almost like you had to push through <i>something</i>.</p>" + "<p>You find you are standing in the entry way for the Mansion, a grand room to show-off the mansion. As you look around cautiously you hear some footsteps approaching, startled you look for the source, but you see it is the maid Lauren approaching. She is now dressed in a stylised and skimpy maid uniform. She looks at you and gestures towards the grand staircase,</p>" +
			'<p>"Good evening ' + myLord + '! Please follow me", she says in a slight english accent.</p>' + "<p>She leads the way upstairs, but this time she does not bend over.</p>");
		if (perVamp.isCharmedBy("Sarah") && !perSarah.checkFlag(2) && perVamp.hoursCharmed("Sarah") > 36) md.write('<p>At the top of the stairs Lauren hesitates and you hear her mutter "blood bitch", you are quite sure who she means and you ask her if everything is alright,</p>' + '<p>"No ' + myLord + ' the foul monster is determined to be the only person in my Lady\'s life, not..not that it is my place to complain...but death is not how I wish to leave this time of servitude", she shakes her head, "Please, My Lady is waiting for you"</p>');
		startQuestions();
		if (perVamp.isCharmedBy("Sarah") && !perSarah.checkFlag(2) && perVamp.hoursCharmed("Sarah") > 36) addLinkToPlace(md, "follow her upstairs", 299);
		else addLinkToPlace(md, "follow her upstairs", 192)
	} else if (marea === "" || marea === "entry") {
		if (perSarah.place == 192 && marea === "")
			if (perSarah.other > 102 && perSarah.other < 115) perSarah.other = Math.floor(perSarah.other + 1);
			else if (perSarah.other > 115 && perSarah.other < 122) perSarah.other = Math.floor(perSarah.other + 1);
		addPlaceTitle(md, "Entry Hall", "mansionentry.jpg");
		md.write("<p>The entry way for the Mansion, a grand room to show-off the mansion. From here you can go upstairs or to " + perGates.getPersonNameShort() + "'s study.</p>");
		startQuestions();
		if (!isMurderPath() && !isConspiracyPath()) addLinkToPlaceC(md, "visit " + perGates.getPersonName(), 17);
		addLinkToPlace(md, "go upstairs", 18, "area=upstairs", "", "", "", "moveblock");
		if (isDay() || !perLauren.checkFlag(8)) addLinkToPlace(md, "exit " + perGates.getPersonNameShort() + "'s House", 16)
	}
	WritePlaceFooter(md)
}

function ShowPlace19() {
	var md = WritePlaceHeader();
	if (wherePerson("Kurndorf") == 141) {
		movePerson("Kurndorf", 0);
		updatePath();
		perGates.setFlag(1);
		perYou.startQuest(1);
		perGates.other = 600;
		charmPerson("Anita", 1, "Davy");
		charmPerson("Mayor", 1, "Davy");
		PlaceI(4, 19);
		PlaceI(22, 19);
		if (!isPlaceKnown("ShoppingCenter")) setPlaceKnown("ShoppingCenter");
		addPlaceTitle(md, "Through the Looking Glass...Door", "gates5.jpg");
		md.write("<p>It was a strange feeling walking <i>through</i> the door, but you are now back inside the mansion. Hopefully you can convince " +
			perGates.getPersonNameShort() + " to let you study the book, or maybe apologise to him.</p>" + "<p>You hear voices, one of them sounds like Davy Robbins, the other you do not recognise,</p>" + '<p>"..did you find it?"</p>' + '<p>"No Sir, he refused to tell me so I dealt with him"</p>' + '<p>"What..I mean..<i>he</i> wanted that..but I did not tell you to...Look let\'s get out of here, I do not know if the spell will work again, I think it is distorted, or just I learned it wrong, we could only go here or back, not anywhere."</p>' +
			"<p>He calls out a strange word and you see them both fade from view and just vanish! You wonder what the woman meant by 'dealt with' and walk over to where they were. You immediately stumble and fall, and you land on the dead body of " + perGates.getPersonName() + " shot through the heart!</p>" + "<p>Your shirt is covered in his blood as you scramble back to your feet, and you realise there is no-one who is going to believe you walked through a closed door to witness the killers vanish into thin air!!</p>" +
			"<p>A murder scene is not the place to be and you are frightened of someone entering the room and blaming you, but you are still obsessed with the book. You look around where you saw it before, and notice a drawer nearby, you open it and inside you see the Book!!</p>")
	} else {
		addPlaceTitle(md, "Dead " + perGates.getPersonName() + "'s House", perYourBody.FindItem(4) === 0 ? "gates4.jpg" : "gates3.jpg");
		if (getPersonCharm("OfficerKhan") < 2) md.write("<p>" + perGates.getPersonName() + " lies dead on the floor. A bullet hole in his chest oozes out blood.");
		md.write("<p>A murder scene is not the place to be and you are frightened of someone entering the room.</p>")
	}
	startQuestions();
	addLinkToPlace(md, "exit the house", 16);
	WritePlaceFooter(md)
}

function LeaveMoniqueMin() {
	dispPlace(3, "");
	WriteComments("You leave the reference area and Monique to deal with the spell.<br/>She will be affected by the spell but you have chosen to not try to reinforce or guide her so the effect will be minimal.")
}

function ShowPlace20() {
	var bHome = sType !== "";
	var perMonique = findPerson("Monique");
	var md = WritePlaceHeader();
	if (perMonique.checkFlag(17)) perMonique.setFlag(17, false);
	perMonique.showPerson(bHome ? "moniquehome2.jpg" : "monique9.jpg");
	addPlaceTitle(md, "Monique Under A Spell");
	md.write("<p>As the spell takes hold of Monique she struggles to keep her identity. " + "She sways " + (bHome ? "in place" : "in her chair") + ", trying to prevent the telepathic control, " + "but the spell is overwhelming and her movements gradually slow.</p>" +
		"<p>&quot;Can you hear me?&quot; you ask, cautious of the spell's effect.</p>" + "<p>&quot;Yes,&quot; she replies, her voice a flat, distant tone. She has stopped moving to listen to you.</p>");
	startQuestions();
	addLinkToPlaceO(md, "increase Monique's arousal", 21, sType !== "" ? "type=" + sType : "");
	if (!bHome) addOptionLink(md, "go to to the reference area?", "LeaveMoniqueMin()");
	WritePlaceFooter(md)
}

function ShowPlace21() {
	var bHome = sType !== "";
	var md = WritePlaceHeader();
	var perMonique = findPerson("Monique");
	if (bHome) perMonique.showPerson("moniquehome3.jpg");
	else perMonique.showPerson("monique3a.jpg", "", "", "monique3b.jpg");
	addPlaceTitle(md, "Monique Under A Spell");
	md.write("<p>You tell the entranced girl, &quot;You are feeling very sexually aroused, Monique. You are feeling so sexy " + "that you want to take your clothes off and screw me,&quot;</p>" + "<p>Monique fights your orders. &quot;No,&quot; she claims. &quot; I... I shouldn't... I don't...&quot; But " +
		"even as she speaks her body betrays her and her legs begin to part.</p>" + "<p>Urgently you prompt her on, &quot;You are feeling sexy Monique. You want to please me.&quot;</p>" + "<p>Her movements become sensual despite her willpower.</p>");
	startQuestions();
	addLinkToPlaceO(md, "order Monique to relax", 22, sType !== "" ? "type=" + sType : "");
	WritePlaceFooter(md)
}

function ShowPlace22() {
	var bHome = sType !== "";
	var md = WritePlaceHeader();
	var perMonique = findPerson("Monique");
	perMonique.showPerson(bHome ? "moniquehome4.jpg" : "monique4.jpg");
	addPlaceTitle(md, "Monique Under A Spell");
	md.write("<p>Monique's tension vanishes on your order, freeing her increased desire. A whimper escapes her lips, then a soft moan.</p>" + '<p>"Oh ' + perYou.getPersonName() + ",\" Monique whispers. \"I can't believe this is happening to me. I've never felt so horny for a ");
	if (perYou.isMaleSex()) md.write('man before."</p>');
	else md.write("woman. Does this mean that I'm a lesbian?\"</p>");
	md.write("<p>As Monique " + (bHome ? "removes the top of her dress" : "unbuttons her top") + ' her will resurfaces in denial. "No!" she says. "This is can\'t be right. You have done something to me. You must have!"</p>');
	startQuestions();
	addLinkToPlaceO(md, "increase Monique's arousal", 23, sType !== "" ? "type=" + sType : "");
	WritePlaceFooter(md)
}

function ShowPlace23() {
	var bHome = sType !== "";
	var md = WritePlaceHeader();
	var perMonique = findPerson("Monique");
	perMonique.showPerson(bHome ? "moniquehome5.jpg" : "monique5.jpg");
	addPlaceTitle(md, "Monique Under A Spell");
	md.write("<p>You increase Monique's arousal to a new level.</p><p>\"You can't do this to me \"" + perYou.getPersonName() + '" the librarian says, but her passion is already destroying her last inhibitions.');
	if (!bHome) md.write(" The girl is so caught up in desire that she no longer cares if people see her or that her job is on the line.");
	md.write("</p>");
	startQuestions();
	addLinkToPlace(md, "order her to remove the rest of her clothes?", 24, sType !== "" ? "type=" + sType : "");
	WritePlaceFooter(md)
}

function ShowPlace24() {
	var bHome = sType !== "";
	var md = WritePlaceHeader(false, bHome ? "td-left-med" : "");
	var perMonique = findPerson("Monique");
	perMonique.showPerson(bHome ? "moniquehome6.jpg" : "monique6.jpg");
	addPlaceTitle(md, "Monique Under A Spell");
	md.write('<p>"Remove your panties," you command the girl.</p>' + "<p>Monique obeys, all resistance gone from her mind. A servant to your orders, she pulls the thin cloth down until it drops to her feet, then waits expectantly for your next command.</p>");
	startQuestions();
	addLinkToPlaceO(md, "order Monique to become your perfect slave - To obey you without question or hesitation, to live only to serve you, with your pleasure as her only ambition?", bHome ? 283 : 8, bHome ? "type=endcharm" : "act=endcharm");
	WritePlaceFooter(md)
}

function ShowPlace25() {
	var md = WritePlaceHeader();
	var perGlenvale = findPerson("Glenvale");
	addPlaceTitle(md, "Shady Pathway", perGlenvale.checkFlag(34) ? "campsite2.jpg" : "campsite1.jpg");
	if (perGlenvale.checkFlag(34) && perGlenvale.place != 25) md.write("<p>The small campsite in the Wild Ranges. You see the tent and gear of the campers you previously met, but they do not appear to be here.</p>");
	else md.write("<p>The small campsite in the Wild Ranges.</p>");
	startQuestions();
	addLinkToPlace(md, "explore the rest of the wild ranges",
		26);
	addLinkToPlace(md, "walk to the main park pathway", 63);
	WritePlaceFooter(md)
}

function ShowPlace26() {
	var md = WritePlaceHeader();
	if (getPersonOther("MissLogan") == 5) setPersonOther("MissLogan", 6);
	if (perYou.getQuestRustyKey() == 5) perYou.setQuestRustyKey(7);
	var perMG = findPerson("Mrs Granger");
	var perKate = findPerson("Kate");
	if (perKate.other >= 12 && perKate.other < 15) {
		perKate.other = perKate.other + 1;
		if (perKate.other == 15 && perKate.place != 9999) perKate.place = 1
	}
	if (!isBeasleyServant() && wherePerson("Kurndorf") === 0 && perYou.getExperience() > 3 && nMana > 1 && !isSpellKnown("Charm")) movePerson("Kurndorf", 1);
	if (wherePerson("OfficerBatton") == 1) movePerson("OfficerBatton", 168);
	if (perMG.place == 34) perMG.showPerson(perMG.getCharmedLevel() == 1 ? "!grangerstones1c.jpg" : "!grangerstones1b.jpg");
	else addPlaceImage(md, "stones.jpg", "95%");
	if (wherePerson("Kurndorf") == 1) {
		md.write('<img src="Images/ghost2.png" style="position:absolute; width:50%;width:15vw; top:0px; left:0;margin:0px 5px;border-style:none" alt="Ghost">');
		addBackgroundImage("Images/ghost2.png", "", nTheme === 0)
	}
	md.write("<br>");
	addPlaceTitle(md, "Wild Ranges");
	md.write("<p>The stones of the wild ranges are the oldest landmark of the country. Nobody knows how the stones were placed, when the event occurred or who placed the remarkable structure. Some townsfolk claim that the stones were magically transported to this field by witches while most townsfolk refuse to even talk about the evil.</p>");
	if (isPlaceKnown("Tunnel")) addPlaceImage(md, "tunnel.jpg", "15%");
	md.write("<p>A long walk brings you to this point. As your skin prickles with an uneasy chill the stones loom above, threatening to expose your secret needs.</p>");
	if (wherePerson("Kurndorf") == 1) {
		if (perGates.other == 600) md.write("<p>A ghostly visage suddenly appears and looks at you briefly, it is the same figure you saw at the mansion!  It seems somewhat distracted not even seeming to notice you and then moves off away from the stones.</p>");
		else md.write("<p>A ghostly visage suddenly appears and looks at you briefly, sending a cold chill down your spine and raising goosebumps on your skin.  It seems somewhat distracted for a moment and then moves off away from the stones.</p>");
		movePerson("Kurndorf", 2)
	}
	if (perMG.place == 34) md.write("<p>You see Mrs Granger searching through the ranges, just as you commanded. She looks like she is packing up to return home, but she is aware of your gaze, so she poses seductively for you.</p>");
	if (isPlaceKnown("Tunnel")) md.write("<p>You see a tunnel behind one of the stones.</p>");
	startQuestions();
	if (perMG.place == 34) addLinkToPlaceO(md, "approach Mrs Granger", 34);
	if (isPlaceKnown("Crypt")) addLinkToPlaceO(md, "enter the crypt", 247);
	addLinkToPlaceO(md,
		"search the stones", 86);
	if (isPlaceKnown("Campsite")) addLinkToPlace(md, "visit the campsite", 25);
	if (isPlaceKnown("Tunnel")) addLinkToPlace(md, "go in the tunnel", 178);
	addLinkToPlace(md, "walk to the pathway", 63);
	WritePlaceFooter(md)
}

function ShowPlace27(stype) {
	var md = WritePlaceHeader();
	var perTitus = findPerson("MsTitus");
	var perAbby = findPerson("Abby");
	var perVamp = findPerson("Vampyre");
	var perMonique = findPerson("Monique");
	var nBook = 0;
	if (stype == "settlement") nBook = 1;
	else if (stype == "hidden") nBook = 2;
	else if (stype == "crypt") nBook = 3;
	else if (stype == "gem") nBook = 4;
	else if (stype == "greek") nBook = 5;
	else if (stype == "stears") nBook = 7;
	else if (stype == "rituals") nBook = 8;
	else if (stype == "bookhydromancy") nBook = 9;
	else if (stype == "bookpharma") nBook = 10;
	else if (stype ==
		"bookwitches") nBook = 11;
	else if (!checkPlaceFlag("HistoryClassroom", 10) && !perYou.checkFlag(29) && isSpellKnown("Clairvoyance") && perMonique.charmed >= 4) nBook = 9;
	else if ((perKurndorf.getQuestCrypt() === 17 || perYou.getQuestAftane() === 60) && (!isPlaceKnown("Crypt") && !checkPlaceFlag("Crypt", 2))) nBook = 3;
	else if (perAbby.getQuestDragonGem() === 0 && Math.random() < .6 && perYou.getExperience() > 0) nBook = 4;
	else if (perTitus.other == 10 || !checkPlaceFlag("HistoryClassroom", 5)) nBook = 1;
	else if (!checkPlaceFlag("HistoryClassroom", 11) &&
		perVamp.other >= 50) nBook = 10;
	else if (!checkPlaceFlag("HistoryClassroom", 6) && (perYou.FindItem(32) > 0 || perVamp.other >= 50)) nBook = 5;
	else if (!checkPlaceFlag("HistoryClassroom", 12) && checkPersonFlag("Jessica", 5)) nBook = 11;
	else if (isDemonFreed() && !checkPlaceFlag("HistoryClassroom", 7)) nBook = 6;
	else if (!checkPlaceFlag("HistoryClassroom", 9) && (isPlaceKnown("HotelCellar") || !checkPlaceFlag("Hotel", 8) && perDavy.other >= 6)) nBook = 8;
	switch (nBook) {
		case 0:
			addPlaceTitle(md, "History Books in the Bookcase", "books.jpg");
			md.write("<p>There are a number of books about history, but you can find nothing useful at the moment, ");
			switch (Math.floor(Math.random() * 6)) {
				case 0:
					md.write('you see the book "The Witch Cults of Glenvale" but you have read it before.');
					break;
				case 1:
					md.write('you briefly look at a work "Fairy Magic" but it is little more than a collection of old tales of the faerie folk like the ballad of "Tam Lane" or that of "True Thomas".');
					break;
				case 2:
					md.write("aside from works you have previously studied.");
					break;
				case 3:
					md.write('you see a fictional novel accidentally on the shelf, "The Queen of Air and Fire" but it is a science-fiction story of aliens using psionics to assume the role of faerie folk.');
					break;
				case 4:
					md.write("some works on early Chinese settlers in the Glenvale area.");
					break;
				case 5:
					md.write("you see a book you have read a few times on ghost sightings in Glenvale.");
					break
			}
			md.write("</p><p>You should try again another time when you have a better idea what to look for or books have been returned.</p>");
			break;
		case 1:
			addPlaceTitle(md, 'History Book "The Settlement of Glenvale"', "books.jpg");
			setPlaceFlag("HistoryClassroom", 5);
			md.write('<p>There are a number of books about history, one of which is titled, "The Settlement of Glenvale"</p>' +
				"<p>You sit down and read the story.</p>" + "<p><em>Glenvale was conquered in the same year that General Mitchell " + "defeated the " + (isBritish() ? "Scots" : "Spanish") + ". After the land was declared English soil, " + "settlers arrived carrying their meager goods and tools to level " + "and farm the fields. Times were tough for the settlers, who fought " + "raids against the " + (isBritish() ? "Scots" : "Spanish") + ", then later against a satanic cult. The " + "first settlers survived these harsh conditions until the year " +
				"1795, when something destroyed the settlement overnight.</p>" + "<p>The town remained vacant for thirty-two years before new settlers arrived. Whatever happened to those original townsfolk is a mystery.</em></p>");
			if (perTitus.other == 10) {
				perTitus.other = 11;
				setPlaceFlag("HistoryClassroom", 1)
			}
			if (checkPlaceFlag("HistoryClassroom", 3)) md.write("<p>The two formerly hidden pages still cling to each other, evidently unwilling to part company.");
			else if (checkPlaceFlag("HistoryClassroom", 2)) md.write("<p><b>You notice two pages of the book have stuck together from the damp.</b></p>");
			else if (checkPlaceFlag("HistoryClassroom", 1)) {
				md.write("<p><b>For the first time you notice that two pages of the book seemed to be stuck together.</b></p>");
				setPlaceFlag("HistoryClassroom", 2);
				PlaceI(6, 27);
				md.write("<p>A rock falls from the top shelf. The stone looks kind of strange.</p>")
			}
			break;
		case 2:
			addPlaceTitle(md, 'History Book "The Settlement of Glenvale" Extra Pages', "books.jpg");
			setPlaceFlag("HistoryClassroom", 3);
			if (!isPlaceKnown("SacredClearing")) setPlaceKnown("SacredClearing");
			if (!isPlaceKnown("Tunnel")) setPlaceKnown("Tunnel");
			md.write('<p>There are a number of books about history, one of which is titled, "The Settlement of Glenvale"</p>' + "<p>By peeling apart the moldy pages you read,</p>" + "<p><i>Later a mansion was built over the site of the earlier " + "settlers and a the old cellar tunnel was sealed.  Small stones " + "were then placed to remember those ages. Some time later, the " + 'third mayor of Glenvale named the site the "Sacred Clearing", ' + "unwittingly sanctifying a space already steeped in power and mystery.</i></p>");
			break;
		case 3:
			addPlaceTitle(md, 'History Book "The Death of Kurndorf"', "books.jpg");
			if (!checkPlaceFlag("Crypt", 2)) setPlaceFlag("Crypt", 2);
			if (perKurndorf.getQuestCrypt() == 17) perKurndorf.setQuestCrypt(18);
			md.write('<p>There are a number of books about history, one of which is titled, "The Death of Kurndorf"</p>' + "<p>You sit down and read the story.</p>" + "<p><em>Kurndorf stood no more. Women, corrupted by his spirit, " + "wailed at his passing - while others, now free of his spell, wept " + "and railed at the heavens for forgiveness of the acts comitted " +
				"while under his sway. And yet more looked around, suspicious that the " + "monster might rise again to possess another. The sermon was brief, " + "the clergy unwilling to give the devil within the coffin his last rites.</p>" + "<p>Upon the crypt the priests laid a tablet of strange " + "scripture and then prayed over the crypt to seal the tomb. As the " + "voices died and the prayer came to an end, the tablet shook in fierce anger.</em></p>" + "<p><em>It was deemed that no one should ever decipher that scripture " +
				"nor move the tablet that imprisons Kurndorf's spirit in the most " + "magical and wild of places, so far removed from what was left of their colony.</em></p>");
			break;
		case 4:
			addPlaceTitle(md, 'History Book "The Gem of the Dragon."', "books.jpg");
			if (perAbby.getQuestDragonGem() === 0) {
				perAbby.setQuestDragonGem(1);
				perYou.startQuest(3)
			}
			md.write('<p>There are a number of books about history, one of which is titled, "The Gem of the Dragon"</p>' + "<p>You sit down and read the story, it is a long story of a hero Duncan fighting against " +
				"an evil cult spreading darnkess and foul corruption. One section attracts your interest,</p>" + "<p><em>Learning of the evil, Duncan broke into that secret, cursed place and " + "yanked the gem from the dragon's eye. We gaped in horror as the " + "glow of the gem brightened in his hand. Wraiths appeared in the hateful mirrors but Duncan did not waver even though we " + "could smell the stench of his burning flesh. He carried it out to " + "the road, each step an agony, until he reached a vase. The searing " +
				"gem stuck to his flesh as if it did not want to slide into that " + "prison. With a cry to break the hardest soul, Duncan pushed the " + "gem into the vase, taking strips of skin with it. He turned to " + "us, looked down at his hands, then collapsed.</em></p>" + "<p><em>We have never forgotten that long day and we pray that " + "nobody ever rediscovers the evil possible with the power of the gem. A sense of dread fills our " + "hearts when we think about why there was only one gem there and what foulness has laid claim to it.</em></p>");
			break;
		case 5:
			addPlaceTitle(md, 'History Book "Greek Mythology"', "booksgreek.jpg");
			setPlaceFlag("HistoryClassroom", 6);
			perVamp.setFlag(10);
			md.write('<p>There are a number of books about history and mythology, one of which is titled, "Greek Mythology"</p>' + "<p>You sit down and read some of the legends, and you notice some previous student has marked parts of the text.</p>" + "<p><em>The Furies were from the <b>underworld</b> and the female spirits of justice and vengence, servants of Hades and Persephone.</p>" +
				"<p>They had many types depending on the crime being punished...</em> reading on one part leaps out <em>...the Arae were the bringers of curses and <b>magical bindings</b>.</p>" + "<p>The furies take the form of a harpy, a winged woman, usually ugly and shrill. Shrines and items dedicated to protect from them or appease them usually bear an image of a harpy.</em></p>" + '<p>The text referring to items has an arrow pointing to it in pen and the text <i>"where, where?"</i></p>' + "<p>Another part that is marked talks about the <b>Empusae spirits and servants of Hecate</b>, Goddess of Witches, Necromancy, Ghosts, and of crossroads and other passages. The Empusae are female spirits who stalk travellers and drink their blood and eat their flesh.</p>" +
				"<p>They have may things in common with the traditional vampire myths, protections include the sacred wood of the hawthorn tree and branches of holly and herbs like garlic.</p>" + '<p>You see the word "vampire" heavily underlined.</p>');
			break;
		case 6:
			setPlaceFlag("HistoryClassroom", 7);
			addPlaceTitle(md, "History Books in the Bookcase, Some Missing", "books.jpg");
			md.write("<p>There are a number of books about history, but you can find nothing useful at the moment, you should try again another time when you have a better idea what to look for.</p>" +
				'<p>As you start to turn away you notice a gap in a shelf, a missing book. You look at a simple catalogue of the books in the bookcase, and you think it is the book "The Demons of Glenvale" but it is difficult to be sure. The catalogue is incomplete and there are books present here not in the catalogue.</p>');
			break;
		case 7:
			AddImage("stears_letter.png");
			addPlaceTitle(md, "Letter from Mrs Stears");
			md.write("<p>It is a personal letter from the blacksmith's wife Mrs. Stears to the regional minister describing the chaos in the area during the apex of the Kurndorf cult</p>" +
				"<p>After the letter was received by the church, district officials were notified and within a month Carl Kurndorf " + "was killed by a lone gunman. There is no mention of who the gunman was or what happened to him. Many of the townfolk," + "including Mrs. Stears, were directed to the district asylum.</p>");
			break;
		case 8:
			setPlaceFlag("HistoryClassroom", 9);
			setPlaceFlag("Hotel", 8);
			addPlaceTitle(md, "Rituals under the Broken Inn", "books.jpg");
			md.write("<p>You come across a short document from an eye-witness to a ritual during the time of the Kurndorf cults.</p>" +
				"<p>It describes a blasphemous ritual intending to summon a demon held underneath the Broken Inn, either in a cave or maybe a basement of some sort. The ritual was unsuccessful but the eye-witness seems certain they have been successful in the past.</p>");
			break;
		case 9:
			setPlaceFlag("HistoryClassroom", 10);
			perYou.setFlag(29);
			addPlaceTitle(md, '"Following the Water"', "UI/books/hydromancybook.jpg");
			md.write("<p>This book is about scrying using reflections in water or hydromancy, an art long practised thoughout history. Hydromancy can give visions of the past, present or future.</p>" +
				"<p>It talks about how you need to develop your natural <b>clairvoyant</b> abilities and while meditating on a reflective pool or large bowl of water you should concentrate and gather your <b>mana</b>. You will then get visions of other places and even other times. It mentions also that the nature of the visions are often random but relate to the mental state of the diviner and the location they attempt the ritual at. It also mentions how hydromancy is less of a strain than other forms of clairvoyance.</p>");
			break;
		case 10:
			setPlaceFlag("HistoryClassroom", 11);
			addPlaceTitle(md, '"Pharmakopoeia"', "UI/books/herbbook.jpg");
			md.write("<p>This book is about herb lore, most of it is about traditional curatives, treatments for illnesses and other domestic use of herbs. A significant part also discusses the use of herbs in wutch-craft, or other occult practises. There is a dry comment that this is to help identify the practitioners not as a guide for use, but that is unlikely given the details it goes into.</p>" +
				"<p>One part that attracts your interest is where it discusses vampires, and how the only certain way to lay one to rest is to put a stake of hawthorn wood through the heart of the fiend. It does dryly mention this is best done when they are sleeping in their grave.</p>");
			break;
		case 11:
			setPlaceFlag("HistoryClassroom", 12);
			addPlaceTitle(md, '"Witches of Pennsylvania"', "UI/books/witchbook.jpg");
			md.write("<p><i>Since William Penn presided over the state's only official witch trial in 1684, witchcraft and folk magic have been a part of the history of the Keystone State. English and German settlers brought their beliefs in magic with them from the Old World--sometimes with dangerous consequences.</i></p?>" +
				"<p>This book goes in detail into the history of witches in the US state of Pennsylvania. An interesting historic piece but as you are not in Pennsylvania and more interested in the practise of witchcraft then the history.</p>");
			break
	}
	if (perYou.isQuestStarted(1) && perYourBody.FindItem(5) === 0 && nMana < 15 && whereItem(5) === 0)
		if (isPlaceKnown("Museum") && !checkPlaceFlag("Museum", 2)) {
			setPlaceFlag("Museum", 2);
			PlaceI(5, 27);
			md.write("<p>You notice that a stone is embedded into a bookend.</p>")
		} else if (checkPlaceFlag("Hotel",
			4) && !checkPlaceFlag("Hotel", 5)) {
		PlaceI(5, 27);
		setPlaceFlag("Hotel", 5);
		md.write("<p>A rock falls from the top shelf. The stone looks kind of strange.</p>")
	}
	startQuestions();
	if (nBook == 1)
		if (checkPlaceFlag("HistoryClassroom", 1) || checkPlaceFlag("HistoryClassroom", 2) || checkPlaceFlag("HistoryClassroom", 3)) addLinkToPlaceO(md, "read the extra pages", 27, "type=hidden");
	addLinkToPlaceO(md, "search the rest of the classroom", 10);
	addLinkToPlace(md, "exit the room?", 70);
	WritePlaceFooter(md)
}

function ShowPlace28() {
	var perTess = findPerson("Tess");
	if (perTess.isCharmedBy()) return dispPlace(62);
	var md = WritePlaceHeader(false, !perTess.checkFlag(1) ? "td-left-med" : "");
	perTess.showPerson(perTess.checkFlag(1) ? checkPlaceFlag("Library", 1) ? "tess1b.jpg" : "tess1.jpg" : "tess1c.jpg");
	addPlaceTitle(md, "Tess Adams");
	if (!perTess.checkFlag(1)) md.write("<p>The crash comes from the far end of the library. You wander over to the office and open the door to see what has caused the noise.</p>");
	if (!perTess.checkFlag(1)) md.write("<p>A pile of discs, along with the rack that held them, have toppled off the desk and onto the floor.</p>");
	md.write("<p>Mrs. Tess Adams turns to you. Everyone knows that Mrs. Adams got her job at the library because her husband has a high position in the local council. She is often seen flitting about the otherwise silent library pushing a trolley of books or resorting the shelves into alphabetical order.</p>" + "<p>Ever since the young couple settled into Glendale Mrs. Adams has been the talk of the town. Her outgoing, sweet nature is only surpassed by her awkwardness. It is impossible for anyone who goes to the library to avoid meeting (or bumping into) the charming young lady.</p>");
	if (checkPlaceFlag("Library", 1)) md.write("<p>The door is closed behind you making the office very private.</p>");
	startQuestions();
	if (!perTess.checkFlag(1)) addQuestionC(md, '"Can I help you with anything, Mrs. Adams?"', "Tess", 2100);
	else if (!perTess.checkFlag(2)) addQuestionC(md, '"Mrs. Adams, do you know any magic?"', "Tess", 2101);
	else if (perTess.checkFlag(2) && !perTess.checkFlag(10)) addQuestionC(md, '"Mrs. Adams, could you help me look something up?"', "Tess", 2105);
	if (perYourBody.FindItem(4) > 0 && perYou.checkFlag(11) &&
		perYou.canUseExperience()) addOptionLink(md, "ask Tess for help deciphering the passages in the book", "spendExperience()");
	if (!checkPlaceFlag("Library", 1)) {
		addQuestionCO(md, "close the door to Mrs. Adams' office", "Tess", 6900);
		addLinkToPlace(md, "go to the reception area.", 3)
	} else addLinkToPlaceO(md, "open the door and go to the reception area.", 3, "", "", "", "setPlaceFlag('Library',1,false);");
	WritePlaceFooter(md)
}

function ShowPlace29() {
	var md = WritePlaceHeader();
	var perTess = findPerson("Tess");
	perTess.showPerson("tess1a.jpg", "height:max");
	addPlaceTitle(md, "Tess Adams Under a Spell");
	md.write('<p>As you look at Mrs. Adams, you let the words come, speaking them with a clear succinct purpose, "Dai Chu Tess Adams"</p>' + "<p>You can feel the drain of the mana fleeing your body, rushing out as it takes form under the " + "conditions of your spell, then flashing into the body of the woman before you. The confusion comes first, playing " +
		"across her features as the spell takes hold in her mind, its tendrils snaking about. Nothing in its path remains " + "untouched, her body suddenly finding itself seized with a growing wave of desire. Her ego, her ambitions, all fall to " + "dust against the spell you have cast, as a sense of exhibitionism " + "instills itself in the fertile soil of her mind, then begins to grow with a sudden speed and urgency.</p>" + "<p>As the disks and papers lie forgotten on the floor, she looks " + "your way, eyes steadily growing hotter and hotter as a growing passion, a lust, appears in them. Her lips part as " +
		"her tongue snakes across them, an almost hungry twitch as " + "she shifts slightly in her chair. Still her eyes conveyed a nervous sense of confusion, hands working against each " + "other as they attempt to fight the urge to run themselves all over her body.</p>" + '<p>"Oh ' + perYou.getPersonName() + '...". Her voice is a throaty moan as she shifts in her chair, ' + "legs pressed tightly together, her body almost squirming, " + "&quot;I suddenly feel so... so alive! It must be the warmth in here... I... I think I should really go and see " +
		"my husband about this... feeling... Do you... do you mind if I go?&quot;</p>");
	startQuestions();
	addLinkToPlaceC(md, "order Tess to stay", 30);
	addLinkToPlaceO(md, "do not reply and go to the reception area.", 3, "type=flee");
	WritePlaceFooter(md, "Script by EH")
}

function ShowPlace30() {
	var md = WritePlaceHeader();
	var perTess = findPerson("Tess");
	perTess.showPerson("tess2.jpg");
	addPlaceTitle(md, "Tess Adams Under a Spell");
	md.write("<p>You order her rather firmly to stay, and even though she seems slightly distressed at it, she remains where " + "she is, her eyes closing as she fights to suppress a low moan of arousal from escaping her throat, still " + "blissfully ignorant of your control over her.</p>" + "<p>Slowly, almost as if rising unbidden, her hand moves to her blouse, slim fingers trailing up against the " +
		"buttons, idly fingering at one or another until they make " + "their way to her throat. She lightly pulls at the collar " + "of her blouse, cheeks flushing slightly as she feels the " + "rising need to show off her body to you, a heat flashing " + "through her skin, urging her to seek a minor bit of " + "relief. Then, reluctantly at first, she slips the first " + "button undone, exposing the first flash of the soft plain " + "of flesh hidden beneath the soft texture of the blouse, " + "followed swiftly by a second, then a third, each coming " +
		"undone faster than the one before it, steadily revealing " + "the teasing view of the valley of her breasts all the way down to just below their lower slopes.</p>" + "<p>A low, sultry tone escapes from her mouth as her eyes " + "begin to smolder with a hungry passion, &quot;You know... " + "a lot of men look at me when I walk by... You know what " + "they're looking at don't you? They want to see these " + "tits, my big, wonderful titties. You look like you want " + "to see them too. You do don't you? I don't mind... I want " +
		"you to see them... I want you to see ALL of me...</p>");
	startQuestions();
	addLinkToPlaceC(md, "tell Tess to show you more.", 31);
	WritePlaceFooter(md, "Script by EH")
}

function ShowPlace31() {
	var md = WritePlaceHeader();
	var perTess = findPerson("Tess");
	perTess.showPerson("tess3.jpg");
	addPlaceTitle(md, "Tess Adams Under a Spell");
	md.write("<p>&quot;Mmm... so you DO want to see more!&quot; " + "A tremor of excitement rises in her voice, a pitch of hungry " + "desire: &quot;I have sooo much more to show you too...All " + "you have to do is say please darling...&quot;</p>" + "<p>Her breasts fall from the white confines of the " + "blouse, standing firm and ripe upon her chest. More and " +
		"more she feels the thrilling rush of this exhibition " + "rushing through her body, a moan of need escaping her " + "lips as her hand snakes down, seeking out the junction " + "between her legs with a hungry rush. As the spell's hold " + "grows over her mind, she begins to feel the thoughts of her husband " + "and all others in her life fading away, replaced by a " + "burning hunger for the one before her, for you. Her mind fills with the desire " + "to submit, to be owned, to serve.</p>" + "<p>Her will has been consumed by the fury of the spell, and she belongs " +
		"to the magic, and more importantly, she belongs to the " + "one who wielded the magic: You.</p>" + "<p>As she lets out hoarse, empassioned gasps of need, she " + "manages to get out, &quot;Please... all you need to say " + "is please " + perYou.getPersonName() + "... I need you to say it... Please, please say please...&quot;</p>");
	startQuestions();
	addLinkToPlaceC(md, "order Tess to finish herself off.", 32);
	WritePlaceFooter(md, "Script by EH")
}

function ShowPlace32() {
	var md = WritePlaceHeader();
	var perTess = findPerson("Tess");
	perTess.showPerson("tess4.jpg");
	addPlaceTitle(md, "Tess Adams Under a Spell");
	md.write("<p>Tess eagerly obeys your order, pumping her fingers " + "faster and faster into herself, two digits pushing past " + "the displaced panties, plundering deep into her body. " + "Her thumb presses against the budding nub of her clit, " + "almost mashing it with her eager movements. Suddenly a " + "low moan escapes her lips as her body is suddenly seized " +
		"by a massive force, taking her and throwing her over the " + "edge as she's consumed by the explosive force of an orgasm.</p>" + '<p>"Oh ' + perYou.getMaster() + '..." Her lips part as she smiles, a dreamy sigh escaping her lips as she rides the blissful wake of her climax, now completely enslaved by the spell. ' + '"That was wonderful... Do... do you think we could do it again sometime?"</p>');
	startQuestions();
	if (perTess.place == 96 || perTess.place == 230) {
		addQuestionC(md, '"Tess, let\'s meet back at the library"',
			"Tess", 10421);
		addQuestionCO(md, "order Tess to come to your house and wear something sexy", "Tess", 2002)
	} else {
		addLinkToPlaceC(md, "talk to Tess Adams", 62, "type=continue");
		addLinkToPlace(md, "go to the library reception", 3)
	}
	WritePlaceFooter(md, "Script by EH")
}

function ShowPlace33() {
	var md = WritePlaceHeader();
	var perMG = findPerson("MrsGranger");
	perMG.other = 1;
	if (perMG.extra[1] < 10) perMG.extra[1] = 15;
	AddCash(20);
	perMG.showPerson("granger2.jpg");
	addPlaceTitle(md, "Mrs. Granger Under A Spell");
	md.write("<p>You use the power of the words coupled with your mana to cast the charm spell upon her.</p>" + '<p>"Oh dear..." she says softly, shaking her head a bit in confusion as if to clear it, ' + '"I\'ve been so busy enjoying talking to you that I forgot just how much you mean to m- Kate...."</p>' +
		"<p>Her hands dig into her purse as she nervously lets her gaze dart to you, then away with a rising blush until she pulls out a crisp bill, " + '"Here, if you are looking for Kate then take this ' + sCurrency + '20.  It might help you find her..."</p>' + "<p>As she says this her gaze darts towards you once more and she shifts her stance a bit, taking on a subtle sultriness." + '"You know... a lot of ' + perYou.getSex() + "s find older women attractive... I'll bet you think I'm attractive... Don't you, " + perYou.getPersonName() +
		'?"</p>');
	startQuestions();
	addLinkToPlaceC(md, "ask Mrs. Granger to remove her clothes", 54);
	addOptionLink(md, "leave the house and Mrs. Granger as she gets used to the spell?", "LeaveMinMrsGranger(false)");
	WritePlaceFooter(md, "Script by EH")
}

function ShowPlace34(type) {
	var md = WritePlaceHeader();
	var perMG = findPerson("MrsGranger");
	var herName = perMG.getPersonName();
	var clv = perMG.getCharmedLevel();
	var sDH = clv == 1 ? "Dear" : "Hon";
	perMG.place = 177;
	perMG.other = 2.2;
	if (type == "bj")
		if (isExplicit()) perMG.showPersonX(perYou.isMaleSex() ? "!grangerstones3b.jpg" : "!grangerstones3g.jpg");
		else perMG.showPerson("!grangerstones3.jpg");
	else if (type == "reward") perMG.showPerson("!grangerstones2a.jpg");
	else if (type == "mind") perMG.showPerson("!grangerstones2b.jpg");
	else perMG.showPerson(clv ==
		1 ? "!grangerstones1b.jpg" : "!grangerstones1a.jpg");
	addPlaceTitle(md, herName + " Studying the Wild Ranges");
	if (type == "bj") {
		if (perYou.isMaleSex()) md.write("<p>You agree and she eagerly unzips your trousers and you quickly realise she is very, very skilled at this. You try to enjoy her skills but she is so very skilled and eager that you quickly fill her mouth with your cum. She swallows with no reservations and some pleasure.</p>");
		else md.write("<p>You agree and she eagerly unzips your pants and pulls them down and pushes your panties aside and you quickly realise she is not inexperiences at this. You are surprised by her skills and she is very eager. Her tongue and fingers quickly make you orgasm and she happily licks up all your juices</p>");
		md.write('<p>"Thanks ' + sDH + ', I should get back and run that analysis, if that is ok with you?"</p>');
		startQuestions()
	} else if (type == "reward") {
		md.write("<p>You tell Mrs. Granger that you are pleased with her study here and that she deserves a reward. She looks eagerly at you, and you tell her to pleasure herself for both of your enjoyment.</p>" + "<p>She looks a little surprised, clearly expecting a more personal touch from you. Still, she eagerly touches herself and brings herself to a fast, intense orgasm.</p>" +
			'<p>"Thanks Hon, you must be feeling hot, why don&apos;t you let me take care of that?"</p>' + "<p>She licks her lips while kneeling in front of you.</p>");
		startQuestions();
		addLinkToPlaceO(md, "let her pleasure you", 34, "type=bj")
	} else if (type == "mind") {
		md.write("<p>You ask what she is suggesting, but the way she is standing and touching herself it seems clear at least partly what she wants,</p>" + '"I know you and Kate and I do not get involved in her relationships...it is just dear that...you do find me attractive and as long as we never tell anyone else, and <i>never</i> tell Kate. We can..play here."</p>');
		startQuestions();
		addLinkToPlaceC(md, '"I won\'t tell Kate"', 34, "type=bj")
	} else {
		md.write("<p>You approach Mrs. Granger and you see she had just been starting to pack away some of her archaeology equipment when you arrived. ");
		if (clv == 1) md.write("She stands to greet you and you see she is dresses quite..simply. She happily says,");
		else md.write("As she sees you she stands and poses for you seductively. She eagerly says,");
		md.write('</p><p>"' + sDH + ", it&apos;s wonderful to see you, I was just about finished here, maybe we can go back to my place and I can " +
			(clv == 1 ? "help you" : "make you real happy") + '."</p>' + "<p>You ask about her findings and if she has found anything more about this place that has been the center of magic for the area. She looks a bit disappointed when you ignore her offer,</p>" + '<p>"This is an interesting site ' + sDH + ', but I need to do some computer analysis of the resistivity scans, it won&apos;t take long but I need access to the University computers from my home."</p>');
		if (clv == 1) md.write("<p>Mrs. Granger looks around from side to side in a theatrical way,</p>" +
			'<p>"It is very private here, and there is no chance Kate might interrupt us, no matter what we do?"</p>');
		else md.write("<p>Maybe you can gruntle your slightly disgruntled servant, or you can just meet her back at her home later.</p>");
		startQuestions();
		if (clv == 1) addLinkToPlaceC(md, '"What did you have on your mind?"', 34, "type=mind");
		else addLinkToPlaceO(md, "reward Mrs. Granger", 34, "type=reward")
	}
	addLinkToPlaceO(md, "let her return home?", 26);
	WritePlaceFooter(md)
}

function AlbumQuestions(md, alb, page) {
	md.write("<br></div>");
	var last = alb == 1 ? 16 : 4;
	if (page != last) addLinkToPlace(md, "next page", 35, "type=album" + alb + "&page=" + (page + 1), "", "", "", "hailblock' style='width:200px; margin-top:14px;");
	if (page != 1) addLinkToPlace(md, "previous page", 35, "type=album" + alb + "&page=" + (page - 1), "", "", "", "hailblock' style='width:200px; margin-top:14px;");
	addLinkToPlace(md, "close the album", 35, "", "", "", "", "optionblock' style='width:200px;margin-left:5px;margin-right:auto;border-left-width:0;margin-top:14px;");
	md.write('</td><td style="vertical-align:top; width:50%; padding:0; position:relative;">')
}

function ShowPlace35(stype) {
	var perKate = findPerson("Kate");
	var page, dn, md;
	if (stype !== "album1" && stype !== "album2") md = WritePlaceHeader();
	else md = WritePlaceHeader(true, "", "#F8F8FF", "", "UI/photoalbum.jpg");
	if (stype === "") {
		addPlaceTitle(md, "Kate's Bedroom", "bedroom5.jpg");
		if (perKate.checkFlag(18))
			if (isInvisible()) md.write("<p>You are waiting in Kate's room, quiet and invisible.</p>");
			else if (perYou.checkFlag(16)) md.write("<p>You are quietly hiding in the wardrobe in Kate's room.</p>");
		else if (perKate.checkFlag(9))
			if (perKate.checkFlag(21)) md.write("<p>You are in Kate's room, and you have finished making room in her wardrobe.</p>");
			else if (perKate.checkFlag(20)) md.write("<p>You are in Kate's room, there is still not enough room in her wardrobe to hide.</p>");
		else if (perKate.checkFlag(19)) md.write("<p>You are in Kate's room, you have quickly rearranged some stuff, but there is not enough room in the wardrobe to hide.</p>");
		else md.write("<p>You are in Kate's room, possibly you could make some space in her wardrobe to hide?</p>");
		else md.write("<p>You are in Kate's room, but there is no way she will not see you when she returns, how can you make sure she does not notice you?</p>");
		else md.write("<p>You wait for Kate but, as time goes by, you realise that she isn't coming home.</p>");
		startQuestions()
	} else if (stype == "clobbered" || stype == "clobberedvisible") {
		nMoney = nMoney > 0 ? 0 : nMoney;
		AddCash(0);
		perKate.place = 9999;
		perKate.setFlag(4);
		if (perDavy.getPathHellgate() === 0) perDavy.setPathHellgate(1);
		showPopupWindow("", "::THUD:: Did someone get the license number of that TRUCK!?!", "");
		addPlaceTitle(md, "Kate's Empty Bedroom", "bedroom5.jpg");
		if (stype == "clobberedvisible") md.write("<p>You black out for a bit, and wake some time later, your head is throbbing and you are fairly sure that there is a very large <i>bump</i> on the back of your head for a while.</p>" +
			"<p>Kate saw you as she return to her room,  <i>Man she can hit hard!</i> You think to yourself.</p>" + "<p>A few moments later you realize Kate did more than just hit you...  it would seem she liberated your cash from your pocket before she left.</p>" + "<p>You see a note sitting on a side table</p>" + '<p>"<i>You ' + (perYou.isMaleSex() ? "bastard" : "bitch") + ', you are scum, I hope to never see you again. I getting the hell out of the town, I will sort things our with Mama</i>"');
		else md.write("<p>You black out for a bit, and wake some time later, your head is throbbing and you are fairly sure that there is a very large <i>bump</i> on the back of your head for a while.</p>" +
			"<p>Kate must have noticed as you started to cast the spell.  <i>Man she can hit hard!</i> You think to yourself.</p>" + "<p>A few moments later you realize Kate did more than just hit you...  it would seem she liberated your cash from your pocket before she left.</p>" + "<p>You see a note sitting on a side table</p>" + '<p>"<i>You ' + (perYou.isMaleSex() ? "bastard" : "bitch") + ' I almost trusted you! The you had to do whatever that is, something like Davy. You are scum, I hope to never see you again. I getting the hell out of the town, I will sort things our with Mama</i>"');
		startQuestions()
	} else if (stype == "album1") {
		page = parseInt(getQueryParam("page"), 10);
		dn = page % 5 !== 0 ? "day" : "night";
		md.write('<div style="text-align:left;margin: 20px 20px 20px 30px;width:95%;color:black">' + '<br><img src="UI/' + dn + '.png" style="position:absolute;left:3%;top:5%" width="42" height="42" alt="' + dn + '">' + '<table class="table-main">' + '<tr><td style="vertical-align:top; width:50%; padding:0; position:relative;">');
		switch (page) {
			case 1:
				addPlaceTitle(md, "Our Trip to Paradise", "", 0, true);
				md.write('<div style="height:55%;height:55vh"><p>The album has photos for a holiday Kate took with some friends last year. There are some hand-written notes for each picture, you do not think Kate wrote them, it appears she went with a couple of friends from her old home town and school.</p>' +
					"<p><b>Day 1 - arrival</b><br>" + "<i>Our rooms in paradise, Kate is as conservative as ever, cute but conservative.</i>" + "</p><p>You did not realise is that Kate was a brunette then as you look at the first picture. There are a few pictures on each page but you focus on the more interesting ones.</p>");
				AlbumQuestions(md, 1, page);
				perKate.showPerson("katepicsday1-1.jpg", "height:85vh", "right");
				break;
			case 2:
				addPlaceTitle(md, "Day 1 - A quick swim", "", 0, true);
				md.write('<div style="height:55%;height:55vh"><p><i>We go for a quick swim, Kate you know it is a clothing optional beach!</i>' +
					"<br>another hand continues<br>" + "<i>Yeah loosen up Miss Bookworm!</i></p>");
				AlbumQuestions(md, 1, page);
				perKate.showPerson("katepicsday1-2.jpg", "height:85vh", "right");
				break;
			case 3:
				addPlaceTitle(md, "Day 1 - Lunch at the Pool", "", 0, true);
				md.write('<div style="height:55%;height:55vh"><p><i>Great food and some cute guys and girls!</i>' + "</p>");
				AlbumQuestions(md, 1, page);
				perKate.showPerson("katepicsday1-3.jpg", "height:85vh", "right");
				break;
			case 4:
				addPlaceTitle(md, "Day 1 - Tour of the Island", "", 0, true);
				md.write('<div style="height:55%;height:55vh"><p><i>We splurged out for a sports car experience and a tour of the island. Hot, fast times for all!</i>' +
					"</p>");
				AlbumQuestions(md, 1, page);
				perKate.showPerson("katepicsday1-4.jpg", "height:85vh", "right");
				break;
			case 5:
				addPlaceTitle(md, "Day 1 - Evening", "", 0, true);
				md.write('<div style="height:55%;height:55vh"><p><i>When we got back from the bar, Kate was waiting for us, all concerned about us drinking or doing other things! Miss Proper lectured us but we will get her to go with us tomorrow!</i>' + "</p>");
				AlbumQuestions(md, 1, page);
				perKate.showPerson("katepicsday1-5.jpg", "height:85vh", "right");
				break;
			case 6:
				addPlaceTitle(md,
					"Day 2 - Playful Kate", "", 0, true);
				md.write('<div style="height:55%;height:55vh"><p><i>Kate is a lot more playful today, she flashed us her panties on the way to breakfast!</i>' + "</p>");
				AlbumQuestions(md, 1, page);
				perKate.showPerson("katepicsday2-1.jpg", "height:85vh", "right");
				break;
			case 7:
				addPlaceTitle(md, "Day 2 - Swimming Race", "", 0, true);
				md.write('<div style="height:55%;height:55vh"><p><i>We all decided to have a swimming race. Kate is always a sucker for a bet!. Still she gave us a nice pose before the race</i>' +
					"</p>");
				AlbumQuestions(md, 1, page);
				perKate.showPerson("katepicsday2-2.jpg", "height:85vh", "right");
				break;
			case 8:
				addPlaceTitle(md, "Day 2 - Penalty", "", 0, true);
				md.write('<div style="height:55%;height:55vh"><p><i>Kate lost the race and her first penalty was this racy bikini for lunchtime. Don\'t deny it Kate, you loved it!</i>' + "</p>");
				AlbumQuestions(md, 1, page);
				perKate.showPersonRandom("katepicsday2-3", 2, "height:85vh", "right");
				break;
			case 9:
				addPlaceTitle(md, "Day 2 - Playing", "", 0, true);
				md.write('<div style="height:55%;height:55vh"><p><i>We all relaxed this afternoon together, Kate paid up the final penalty, no swimsuit at all! Yay!!!</i>' +
					"<br>another hand continues<br>" + "<i>We did the same too, but I haven't worn a swimsuit since we arrived!</i></p>");
				AlbumQuestions(md, 1, page);
				perKate.showPersonRandom("katepicsday2-4", 2, "80%", "right");
				break;
			case 10:
				addPlaceTitle(md, "Day 2 - Fancy Dress Party", "", 0, true);
				md.write('<div style="height:55%;height:55vh"><p><i>We all went to a fancy dress party tonight, and posed for some sexy pictures!</i>' + "</p>");
				AlbumQuestions(md, 1, page);
				perKate.showPerson("katepicsday2-5.jpg", "height:85vh", "right");
				break;
			case 11:
				addPlaceTitle(md, "Day 2 - Night", "", 0, true);
				md.write('<div style="height:55%;height:55vh"><p><i>Spoil sport Kate left once the party got more interesting, and keys changed hands and people got serious! Late night she was waiting for us and demanded we tell her everything that happened and we did!</i>' + "</p>");
				AlbumQuestions(md, 1, page);
				perKate.showPerson("katepicsday2-6.jpg", "height:85vh", "right");
				break;
			case 12:
				addPlaceTitle(md, "Day 3 - Hot breakfast", "", 0, true);
				md.write("<div style=\"height:55%;height:55vh\"><p><i>Finally talked Kate into loossening up more, she decided to go 'no panties' today!</i>" +
					"</p>");
				AlbumQuestions(md, 1, page);
				perKate.showPerson("katepicsday3-1.jpg", "height:85vh", "right");
				break;
			case 13:
				addPlaceTitle(md, "Day 3 - Swimming", "", 0, true);
				md.write('<div style="height:55%;height:55vh"><p><i>Kate you minx, stripping off without being asked!</i>' + "</p>");
				AlbumQuestions(md, 1, page);
				perKate.showPerson("katepicsday3-2.jpg", "height:85vh", "right");
				break;
			case 14:
				addPlaceTitle(md, "Day 3 - Relaxed Lunch", "", 0, true);
				md.write('<div style="height:55%;height:55vh"><p><i>Kate has really loosened up, this is her during lunch!</i>' +
					"</p>");
				AlbumQuestions(md, 1, page);
				perKate.showPerson("katepicsday3-3.jpg", "80%", "right");
				break;
			case 15:
				addPlaceTitle(md, "Day 3 - Party", "", 0, true);
				md.write('<div style="height:55%;height:55vh"><p><i>Another party tonight, Kate in her sexy costume, popping out of her top!</i>' + "</p>");
				AlbumQuestions(md, 1, page);
				perKate.showPerson("katepicsday3-4.jpg", "height:85vh", "right");
				break;
			case 16:
				addPlaceTitle(md, "Day 3 - After Party", "", 0, true);
				md.write('<div style="height:55%;height:55vh"><p><i>Kate when we got back, lets keep this PG so no telling what she was doing with her fingers and some fruit!</i></p>' +
					"<p>That appears to be all there is, the album end there clearly part-way through the trip. There must be another album!</p>");
				AlbumQuestions(md, 1, page);
				perKate.showPerson("katepicsday3-5.jpg", "height:85vh", "right");
				perKate.setFlag(8);
				break
		}
		md.write("</td></tr></table></div></div>");
		md.write('<div id="commentdiv" class="comment_content_trans' + (gameState.bCommentLL ? "_ll" : "") + '" onclick="ClearComments();"></div>');
		writePageFooter(md);
		return
	} else if (stype == "album2") {
		page = parseInt(getQueryParam("page"),
			10);
		dn = page % 5 !== 0 ? "day" : "night";
		md.write('<div style="text-align:left;margin: 20px 20px 20px 30px;width:95%;color:black">' + '<br><img src="UI/' + dn + '.png" style="position:absolute;left:3%;top:5%" width="42" height="42" alt="' + dn + '">' + '<table class="table-main">' + '<tr><td style="vertical-align:top; width:50%; padding:0; position:relative;">');
		switch (page) {
			case 1:
				addPlaceTitle(md, "Our Trip to Paradise<br>Kate's Eyes Only, no Mothers!", "", 0, true);
				md.write('<div style="height:55%;height:55vh"><p><p>This is the continuation of the holiday trip from the other album clearly intended for private viewing only.</p>' +
					"<p><b>Day 4 - Getting ready</b><br>" + "<i>Kate is really getting into the trip, a quick picture I took of her preparing herself for the day!</i></p>");
				AlbumQuestions(md, 2, page);
				perKate.showPerson("katepicsday4-1.jpg", "80%", "right");
				break;
			case 2:
				addPlaceTitle(md, "Day 4 - Swimming", "", 0, true);
				md.write('<div style="height:55%;height:55vh"><p><i>No swimsuits today! All the better to hook-up with some cute guy or girl!</i>' + "<br>another hand continues<br>" + "<i>Which we did!! We all did!!</i></p>");
				AlbumQuestions(md,
					2, page);
				perKate.showPerson("katepicsday4-2.jpg", "80%", "right");
				break;
			case 3:
				addPlaceTitle(md, "Day 4 - What is 2some plus 1some", "", 0, true);
				if (perYou.isMaleSex()) md.write('<div style="height:55%;height:55vh"><p><i>They held the camera for us, who could refuse us cuties.</i></p>');
				else md.write('<div style="height:55%;height:55vh"><p><i>A passerby was happy to take some photos of us having fun</i></p>');
				AlbumQuestions(md, 2, page);
				if (isExplicit()) perKate.showPersonRandomX(perYou.isMaleSex() ? "katepicsday4-3b" :
					"katepicsday4-3g", perYou.isMaleSex() ? 4 : 2, "80%", "right");
				else perKate.showPerson(perYou.isMaleSex() ? "katepicsday4-3b.jpg" : "katepicsday4-3g.jpg", "80%", "right");
				break;
			case 4:
				addPlaceTitle(md, "Day 4 - Mistress Kate", "", 0, true);
				md.write('<div style="height:55%;height:55vh"><p><i>End of the trip, packing to leave and Kate snapped. You had enough of us teasing, penalties and other games. Here she is punishing us</i>' + "<br>another hand continues<br>" + "<i>Please Mistress, punish me anytime!</i></p>" + "<p>That would seem to be the end of the albums and the trip, unfortunately!</p>");
				AlbumQuestions(md, 2, page);
				perKate.showPersonRorX("katepicsday4-4.jpg", "height:85vh", "right");
				break
		}
		md.write("</td></tr></table></div></div>");
		md.write('<div id="commentdiv" class="comment_content_trans' + (gameState.bCommentLL ? "_ll" : "") + '" onclick="ClearComments();"></div>');
		writePageFooter(md);
		return
	}
	addOptionLink(md, "wait for Kate?", "bChat = false;WaitHere();WriteComments('You wait for a bit');");
	if (perKate.checkFlag(7)) addLinkToPlace(md, "look at the photo album", 35, "type=album1&page=1");
	if (perKate.checkFlag(9)) addLinkToPlace(md,
		"look at the second photo album", 35, "type=album2&page=1");
	if (perKate.checkFlag(18) && perKate.checkFlag(9) && !isInvisible() && !perYou.checkFlag(16))
		if (perKate.checkFlag(21)) addOptionLink(md, "hide in the wardrobe", "perYou.setFlag(16);dispPlace();");
		else if (perKate.checkFlag(20)) addOptionLink(md, "try to make more room in the wardrobe", "setPersonFlag('Kate',21);dispPlace();");
	else if (perKate.checkFlag(19)) addOptionLink(md, "try to make more room in the wardrobe", "setPersonFlag('Kate',20);dispPlace();");
	else addOptionLink(md,
		"try to make room in the wardrobe", "setPersonFlag('Kate',19);dispPlace();");
	if (wherePerson("MrsGranger") === 177) addLinkToPlace(md, "look for Mrs Granger", 177);
	addLinkToPlace(md, "exit the house?", 43);
	WritePlaceFooter(md)
}

function ShowPlace36(stype) {
	var md;
	var perKate = findPerson("Kate");
	if (stype === "") {
		if (perDavy.other == 7) perDavy.other = 6;
		md = WritePlaceHeader();
		perKate.showPerson("kate4a.jpg");
		addPlaceTitle(md, "Kate Granger");
		if (perKate.place == 47) md.write("<p>Kate is walking through the park in a heavy trenchcoat.");
		else md.write("<p>Kate is walking along the edge of the pond in a heavy trenchcoat.");
		md.write(" She looks anxious and a little scared.</p>" + '<p>"Hello ' + perYou.getPersonName() + ",\" she says nervously. \"Thank god I ran into you. You weren't at your house and nobody knew where you'd gone. I'm so frightened " +
			perYou.getPersonName() + '."</p>' + "<p>\"People are acting strangely; something strange is happening in town. I don't know what it is but Mr. Beasley said something about magic. I think that we should call the police, don't you?\"</p>" + "<p>What do you want to do about the nervous Kate?</p>");
		startQuestions();
		if (perKate.other == 10) addQuestionCO(md, "ask Kate if she knows anything about Davy", "Kate", 5410);
		else if (perKate.other == 11) addQuestionCO(md, "tell her to go home to hide from danger", "Kate", 5411);
		addLinkToPlace(md,
			"return to the park and forget it", 47)
	} else if (stype == "freed") {
		if (perDavy.other == 7) perDavy.other = 6;
		md = WritePlaceHeader();
		perKate.showPerson("kate4b.jpg");
		addPlaceTitle(md, "Kate Freed from Davy's Control!");
		AddMana(5);
		perKate.place = 1E3;
		var bFreedBefore = getQueryParam("before") === "true";
		FreeKate();
		if (getQueryParam("by") === "Tina") md.write("<p>Tina concentrates and she absorbs the mana powering the <i>charm</i> over Kate and transfers it to you.</p>");
		else md.write("<p>You clasp the ring with your fist. It glows and, within moments, it absorbs the mana powering the <i>charm</i> over Kate.</p>");
		md.write('<p>"Oh my god!" Kate cries as you free her from Davy\'s control.  "The things he made me do!  I can\'t believe this, its not possible!" She says, and starts to run away.</p>');
		startQuestions();
		if (bFreedBefore) {
			addLinkToPlaceC(md, "&quot;Wait!! I can protect you from Davy!&quot;", 36, "type=waitprotect");
			addLinkToPlaceC(md, "&quot;Wait!! I love you!&quot;", 36, "type=waitlove")
		}
		addLinkToPlace(md, "try to follow Kate", 47, "", "", "", "charmPerson('Kate', 4, 'Davy')")
	} else if (stype == "waitprotect") {
		md =
			WritePlaceHeader();
		perKate.showPerson("kate4c.jpg");
		addPlaceTitle(md, "Kate Hesitates");
		perKate.setFlag(13);
		md.write('<p>You call out to Kate, "Wait, don\'t go I love you and want to help you!"</p>' + "<p>She hesitates and looks at you with a smile,  \"I..don't know how to answer that, I am so angry at that <b>bastard</b> I just want to pound his face ");
		if (isKateTrusting()) {
			md.write("but I do like you too, and maybe I was starting to fall... It is just Davy has messed with me and my emotions I do not know what to do.</p>");
			startQuestions();
			if (perYourBody.FindItem(43) !== 0) addLinkToPlaceC(md, "&quot;I can give you this necklace&quot;", 36, "type=waitprotectnecklace");
			addLinkToPlaceC(md, "&quot;I can protect you by casting Charm on you&quot;", 36, "type=waitprotectcharm")
		} else {
			perKate.setFlag(12);
			md.write("but I do not trust you. You seem to have some of the same abilities as Davy does and I do not know what you can or have done with them. Maybe I was starting to fall for you, but this has messed us around and I doubt I can ever trust someone with those powers ever again.</p>" +
				"<p>You try to reassure her of your feelings and that you will never used your magic on her but she is too angry and confused. She looks at you and resumes walking out, intent on her revenge against Davy.</p>");
			startQuestions()
		}
		addLinkToPlace(md, "try to follow Kate", 47, "", "", "", "charmPerson('Kate', 4, 'Davy')")
	} else if (stype == "waitprotectcharm") {
		md = WritePlaceHeader();
		perKate.showPerson("kate4e.jpg");
		addPlaceTitle(md, "Kate Refuses");
		perKate.setFlag(12);
		md.write("<p>You tell her you know something of how Davy did what he did to her and can protect her by using the same spell on her, but just to protect her, doing nothing more. She replies suspiciously,</p>" +
			'<p>"I see, but I could never let anyone have that sort of power over me ever again. No one, not you, Davy, anyone!!"</p>' + "<p>You see you have lost any trust she had in you, she turns her back on you and leaves, certainly going to punish Davy.</p>");
		startQuestions();
		addLinkToPlace(md, "try to follow Kate", 47, "", "", "", "charmPerson('Kate', 4, 'Davy')")
	} else if (stype == "waitprotectnecklace") {
		md = WritePlaceHeader();
		perYourBody.DropItem(43, "Kate");
		perKate.setFlag(15);
		perKate.place = 124;
		perKate.showPerson("kate17i.jpg");
		addPlaceTitle(md, "Give Kate the Necklace");
		md.write("<p>You show Kate the heirloom necklace you are wearing and without explaining how you got it, you describe how it protects from magic spells being cast on you. You remove it and offer it to her. She looks surprised, them smiles,</p>" + "<p>\"I do not know how to thank you! I will properly 'thank' you later, once I have beaten Davy and heard him beg to apologise to me!\"</p>" + '<p>I am not sure where he is at the moment, he has been very cautious, he said how afraid of you he was, but also mentioned his mentor protecting him. If I find him before you I will call you. Do not dare attack him without me, I must punish him myself!"</p>' +
			"<p>She quickly kisses you on your lips, and then runs to hunt down Davy.</p>");
		startQuestions();
		addLinkToPlace(md, "try to follow Kate", 47)
	} else if (stype == "waitlove") {
		md = WritePlaceHeader();
		if (isKateTrusting()) perKate.showPerson("kate4d.jpg");
		else perKate.showPerson("kate4e.jpg");
		addPlaceTitle(md, "Kate Hesitates");
		md.write('<p>You call out to Kate, "Wait, don\'t go I love you and want to help you!"</p>' + "<p>She hesitates and looks at you with a smile,  \"I..don't know how to answer that, I am so angry at that <b>bastard</b> I just want to pound his face ");
		if (isKateTrusting()) {
			md.write("but I do like you too, and maybe I was starting to fall... It is just Davy has messed with me and my emotions I do not know what to do.</p>" + "<p>You once again try to reassure her of your feelings and she looks at you,</p>");
			startQuestions();
			addLinkToPlaceC(md, "&quot;I love you, everything I have been doing is to help you!&quot;", 36, "type=waitloveyou");
			addLinkToPlaceC(md, "&quot;I love you, I will defeat Davy!&quot;", 36, "type=waitlovewait")
		} else {
			perKate.setFlag(12);
			md.write("but I do not trust you. You seem to have some of the same abilities as Davy does and I do not know what you can or have done with them. Maybe I was starting to fall for you, but this has messed us around and I doubt I can ever trust someone with those powers ever again.</p>" +
				"<p>You try to reassure her of your feelings and that you will never used your magic on her but she is too angry and confused. She looks at you and resumes walking out, intent on her revenge against Davy.</p>");
			startQuestions()
		}
		addLinkToPlace(md, "let her go and return to the park", 47, "", "", "", "charmPerson('Kate', 4, 'Davy')")
	} else if (stype == "waitlovewait") {
		md = WritePlaceHeader();
		perKate.showPerson("kate4e.jpg");
		addPlaceTitle(md, "Kate Leaves");
		md.write('<p>You tell Kate, "I do love you and I am working to defeat Davy and rob him of his powers. Just wait here and I will call for you when he is beaten."</p>' +
			'<p>Kate smiles and replies, "Thank you, but the only person who is going to beat Davy is me!" and she walks away.');
		startQuestions();
		addLinkToPlace(md, "let her go and return to the park", 47, "", "", "", "charmPerson('Kate', 4, 'Davy')")
	} else if (stype == "waitloveyou") {
		md = WritePlaceHeader();
		perKate.showPerson("kate4d.jpg");
		addPlaceTitle(md, "Kate");
		md.write('<p>You tell Kate, "Everything I have been doing is to help you, I love you!"</p>' + '<p>She looks at you smiling and replies, "I might love you as well, but...I should go..."</p>');
		startQuestions();
		addLinkToPlace(md, "kiss her", 36, "type=waitlovekiss");
		addLinkToPlace(md, "let her go and return to the park", 47, "", "", "", "charmPerson('Kate', 4, 'Davy')")
	} else if (stype == "waitlovekiss") {
		md = WritePlaceHeader(false, perYou.isMaleSex() ? "" : "td-left-med");
		perKate.showPerson(perYou.isMaleSex() ? "kate4f.jpg" : "kate17gg.jpg");
		addPlaceTitle(md, "A Kiss");
		md.write("<p>You take the uncertain Kate in your arms and you kiss her. She hesitates for a moment and then returns your kiss.</p>" + "<p>After a time you part and Kate looks calmer, the anger gone from her face, and she says,</p>" +
			'<p>"After everything with Davy this is so confusing, but I do want to thank you properly"</p>' + "<p>You look at her, she is unusually nervous, she is usually very clear minded, if impulsive.</p>");
		startQuestions();
		addLinkToPlace(md, "embrace her", 36, "type=waitloveembrace");
		addLinkToPlace(md, "let her go and return to the park", 47, "", "", "", "charmPerson('Kate', 4, 'Davy')")
	} else if (stype == "waitloveembrace") {
		md = WritePlaceHeader(false, isExplicit() ? "td-left-med" : "");
		perKate.setFlag(14);
		perKate.place = 124;
		if (isExplicit()) perKate.showPersonRandomX(perYou.isMaleSex() ? "kate4g" : "kate17hg", 2);
		else perKate.showPersonRandom("kate4g", 2);
		addPlaceTitle(md, "Passionate Embrace");
		md.write("<p>You take Kate into your arms and passionately kiss her, and you both start to strip each others clothing. You touch her large breasts and she sighs in passion, but when you touch her lower down, she shys away, and says,</p>" + '<p>"For now just let me please you...another time for...you know.."</p>');
		if (perYou.isMaleSex()) md.write("<p>Kate kneels and gives you a practised blowjob, clearly not her first time by a long way. You quickly cum, splattering her face and tits.</p>");
		else md.write("<p>Kate has you lie back and she leans in and starts licking your pussy. She is remarkably skilled and you quickly orgasm hard on her face.</p>");
		md.write("<p>Kate looks at you and smiles and she quickly re-dresses. Once dressed she tells you,</p>" + '<p>"I will be back soon, once I have beaten Davy for what he did to me!"</p>' + "<p>Before you can complain or warn her she leaves.</p>");
		startQuestions();
		addLinkToPlace(md, "let her go and return to the park", 47, "", "", "", "charmPerson('Kate', 4, 'Davy')")
	}
	WritePlaceFooter(md)
}

function ShowPlace37() {
	var md = WritePlaceHeader();
	addPlaceImage(md, "gymoutside.jpg");
	addPlaceImage(md, "house11.jpg", "90%");
	if (isPlaceKnown("AuntsHouse")) addPlaceImage(md, "house12.jpg", "90%");
	addPlaceTitle(md, "Cherise Road");
	md.write("<p>A well maintained part of town, everything seems a bit above the ordinary, wealthier than elsewhere.</p></p>The only gym in Glenvale operates at the intersection with Kollam St. Most of the locals approve of it but there was some initial resistance when it was first opened. The locals thought it would increase traffic or disturb the neighbourhood, but nothing of the sort happened.");
	if (!isShopOpen(4, 2, true)) md.write(" The Gym is closed at the moment, it is open from 6am to 10pm");
	md.write("</p><p>You can see 5 Cherise Rd, the Ross's house where your friend Amy lives with her older sister Catherine.<br>The house is quite expensive and you have been here a few times before.</p>");
	startQuestions();
	if (isShopOpen(4, 2, true)) addLinkToPlace(md, "visit the gym", 435);
	if (checkPersonFlag("Catherine", 1)) addLinkToPlace(md, "visit the Ross house", 436);
	else addLinkToPlace(md, "visit the Ross house",
		37, "", "You should just see Amy or Catherine at school, you have not been invited to visit");
	if (isPlaceKnown("AuntsHouse")) addLinkToPlace(md, "visit your Aunt and Kylie", 433);
	if (isPlaceKnown("DervishRd")) addLinkToPlace(md, "walk to Dervish Rd", 5);
	addLinkToPlace(md, "walk to Kollam Street", 44);
	WritePlaceFooter(md)
}

function ShowPlace38() {
	var md = WritePlaceHeader();
	var perLeanne = findPerson("Leanne");
	addPlaceImage(md, "house10.jpg", "90%");
	addPlaceImage(md, "house9.jpg", "90%");
	addPlaceTitle(md, "Amaranth Place");
	md.write("<p>An average suburban part of town, the area is tidy and the houses well looked after. ");
	if (isDay()) md.write("You see some children playing in one of the houses front yards.</p>");
	else md.write("There is little going on here at this time of night.</p>");
	md.write("<p>You can see 3 Amaranth Pl, the home of your friend Leanne.<br>The house is pleasant but you have seldom been there.");
	if (perLeanne.whereNow() == 450 || perLeanne.whereNow() == 9999)
		if (perLeanne.isCharmedBy("Demon") && !perLeanne.checkFlag(13)) md.write(" You see that the front door of Leanne's house is partly open.");
		else if (perLeanne.whereNow() == 450) md.write(" It looks like Leanne is home.");
	if (isPlaceKnown("GabbysHouse")) md.write("<p>11 Amaranth Pl is the home of Gabrielle Halliway, your mothers Assistant. She usually doesn't receive visitors and you have only ever seen it from afar.</p>");
	md.write("</p>");
	startQuestions();
	if (perLeanne.whereNow() == 450 || perLeanne.whereNow() == 9999) addLinkToPlace(md, perLeanne.isCharmedBy("Demon") && !perLeanne.checkFlag(13) ? "check Leanne's house" : "visit Leanne's house", 450);
	else if (perLeanne.isCharmedBy("Demon")) addLinkToPlace(md, "visit Leanne's house", 38, "", "There is no answer at the door");
	else if (isShopOpen(2, 1, true)) addLinkToPlace(md, "visit Leanne's house", 38, "", "There is no answer at the door, she is probably at the General " + getShopStore(true));
	else addLinkToPlace(md, "visit Leanne's house",
		38, "", "You should probably visit another time, she has been a bit depressed recently and has preferred to be left alone when she is feeling that way.");
	if (isPlaceKnown("GabbysHouse"))
		if (isMurderPath() && wherePerson("Gabby") == 453 && !isCharmedBy("Gabby")) addLinkToPlace(md, "approach Gabby's house", 452, "type=gabbyhouseapproach");
		else if (!isMurderPath() && checkPersonFlag("Gabby", 13)) addLinkToPlace(md, "visit Gabby's house", 38, "", "No one seems to be home!");
	else addLinkToPlace(md, "visit Gabby's house", 452);
	addLinkToPlace(md, "walk to Rathdown Road", 229);
	WritePlaceFooter(md)
}

function PuzzleParty(doc) {
	var perMG = findPerson("MrsGranger");
	if (perMG.checkFlag(33))
		if (doc.Puzzle.answer.value * 40 / 5 == 56) gotoPlace(40, "type=right");
		else gotoPlace(40, "type=wrong");
	else if (doc.Puzzle.answer.value == 3) gotoPlace(40, "type=right");
	else gotoPlace(40, "type=wrong")
}

function ShowPlace39() {
	var md = WritePlaceHeader(true);
	var perMG = findPerson("MrsGranger");
	if (perMG.extra[1] > 6) return dispPlace(177);
	addPlaceTitle(md, perMG.checkFlag(33) ? "Party Puzzle" : "Panty Puzzle", "", 0, true);
	if (perMG.checkFlag(33)) md.write('<table class="table-main" style="vertical-align:top"><tr><td>' + "I want to invite a family to a party.<br><br>" + "The family has 1 grandfather, 1 grandmother, 2 fathers, 2 mothers, 4 children, 3 grandchildren, " + "1 brother, 2 sisters, 2 sons, 2 daughters, 1 father-in-law, 1 " +
		"mother-in-law, and 1 daughter-in-law.<br><br>A total of 23 " + "people, you might think, but that's not correct. Oh, how " + "many people are there?" + '<form method="POST" name="Puzzle">' + '<p style="text-align:center">Answer: <select name="answer" size="1">' + '<option selected value="1">1</option>' + '<option value="2">2</option>' + '<option value="3">3</option>' + '<option value="4">4</option>' + '<option value="5">5</option>' + '<option value="6">6</option>' + '<option value="7">7</option>' + '<option value="8">8</option>' +
		'<option value="9">9</option>' + '<option value="10">10</option>' + '<option value="11">11</option>' + '<option value="12">12</option>' + '<option value="13">13</option>' + '<option value="14">14</option>' + '<option value="15">15</option>' + '<option value="16">16</option>' + '<option value="17">17</option>' + '<option value="18">18</option>' + '<option value="19">19</option>' + '<option value="20">20</option>' + '<option value="21">21</option>' + '<option value="22">22</option>' + '<option value="23">23</option>' + "</select> ");
	else md.write('<table class="table-main" style="vertical-align:top"><tr><td>' + "I am curious about getting dressed for work. I do like my short skirts and my job can be quite messy. So I <i>have</i> to wear panties to work and I usually take a spare pair in case of problems on a dig.<br><br>" + "My drawer contains 10 pairs of white panties and 10 pairs of pink panties and I usually get dressed when it is still a bit dark. I take one pair at a time and check their colour after I take them out of the drawer. How many pairs do I need to take out to be guaranteed I have two pairs the same colour?" +
		'<form method="POST" name="Puzzle">' + '<p style="text-align:center">Answer: <select name="answer" size="1">' + '<option selected value="1">1</option>' + '<option value="2">2</option>' + '<option value="3">3</option>' + '<option value="4">4</option>' + '<option value="5">5</option>' + '<option value="6">6</option>' + '<option value="7">7</option>' + '<option value="8">8</option>' + '<option value="9">9</option>' + '<option value="10">10</option>' + '<option value="11">11</option>' + '<option value="12">12</option>' + '<option value="13">13</option>' +
		'<option value="14">14</option>' + '<option value="15">15</option>' + '<option value="16">16</option>' + '<option value="17">17</option>' + '<option value="18">18</option>' + '<option value="19">19</option>' + '<option value="20">20</option>' + "</select> ");
	md.write('<input type="button" name="button" value="Go" onClick="PuzzleParty(document)"></p></form>');
	AddRightColumnMed(md);
	perMG.showPerson("granger4a.jpg", "height:max");
	WritePlaceFooter(md)
}

function ShowPlace40(stype) {
	var md = WritePlaceHeader(true);
	var perMG = findPerson("MrsGranger");
	if (stype == "right") {
		addPlaceTitle(md, "Right Answer", "", 0, true);
		AddCash(5);
		perMG.extra[1] = 10;
		if (perMG.checkFlag(33)) {
			md.write('<table class="table-main"><tr><td style="width:70%">' + "<p>Mrs. Granger is overjoyed with the help that you gave her. <p>&quot;How did you figure it out?&quot; she asks. &quot;The party " + "will consist of 2 little girls and a boy, their father and mother, and their father's father and mother. Now I " +
				"can have a party with my family. Here, let me give you " + sCurrency + "5 for your help.&quot;</p>" + "<p>You thank the lady for the money and slip the cash " + "into your wallet. It might not be much but you never know when it will come in handy.</p>" + "<p>&quot;It's such a pleasure to have you visit " + perYou.getPersonName() + ",&quot; Mrs. Granger says, smiling in gratitude.</p>" + '<p>She moves to sit down, but seems to have another idea, "One last question, what sort of hostess do you think I will make at the party?"</p>');
			startQuestions("You answer");
			addLinkToPlaceC(md, '"An elegant hostess"', 177, "", "She smiles at your compliment and sits down to talk more with you", "Mrs. Granger");
			addLinkToPlaceC(md, '"A beautiful hostess"', 177, "", "She smiles at your compliment and sits down to talk more with you", "Mrs. Granger");
			addLinkToPlaceC(md, '"A sexy hostess"', 177, "", "She blushes, &quot;You should not let Kate hear you say that, Hon&quot; and leans in and gives you a kiss on your cheek. You notice she slipped an extra " + sCurrency +
				"5 in your pocket as she did.", "Mrs. Granger", "setPersonFlag('MrsGranger',2);AddCash(5);")
		} else {
			md.write('<table class="table-main"><tr><td style="width:70%">' + "<p>Mrs. Granger is overjoyed with the help that you gave her. <p>&quot;That makes sense, " + "at the worst case I take out a white pair then a pink pair. The next pair will match one of the previous picks&quot; she says." + '"Here, let me give you ' + sCurrency + "5 as a reward.&quot;</p>" + "<p>You thank the lady for the money and slip the cash into your wallet. It might not be much but you never know when it will come in handy.</p>" +
				"<p>&quot;It's such a pleasure to have you visit " + perYou.getPersonName() + ',&quot; Mrs. Granger says, "Fortunately I do not <i>have</i> to work today".</p>' + '<p>She moves to sit down, and a wicked smile forms on her face, "One last question, what colour am I wearing today?"</p>');
			startQuestions("You answer");
			addLinkToPlaceC(md, '"White"', 177, "", "She smiles &quot;Not today&quot; and sits down to talk more with you", "Mrs. Granger");
			addLinkToPlaceC(md, '"Pink"', 177, "", "She smiles &quot;Not today&quot; and sits down to talk more with you",
				"Mrs. Granger");
			addLinkToPlaceC(md, '"You are not wearing any"', 177, "", "She smiles and leans over and whispers in your ear, &quot;As if I would do that&quot; but does not correct your answer. She gives you a kiss on your cheek and returns to where she was sitting. You notice she slipped an extra " + sCurrency + "5 in your pocket as she did.", "Mrs. Granger", "setPersonFlag('MrsGranger', 2);AddCash(5);")
		}
		addLinkToPlace(md, "decline to answer and talk to Mrs. Granger some more", 177)
	} else {
		perMG.extra[1] = 9;
		addPlaceTitle(md,
			"Wrong Answer", "", 0, true);
		md.write('<table class="table-main"><tr><td style="width:70%">' + "Mrs. Granger is disappointed..<p>&quot;Kate told me how clever you are!&quot; she sighs. &quot;Well maybe you are clever " + "compared to the other youth of today but you are of no help to me.&quot;</p>" + "<p>Embarrassed about your mistake, you mumble apologies. It is a shame that you got the wrong answer. After a " + "moment of discomfort Mrs. Granger smiles her forgiveness.</p>");
		startQuestions();
		addLinkToPlace(md,
			"talk to her some more", 177)
	}
	AddRightColumnMed(md);
	perMG.showPerson("granger4b.jpg");
	WritePlaceFooter(md)
}

function ShowPlace41(stype) {
	var md;
	if (stype == "look") {
		md = WritePlaceHeader();
		var id = getQueryParam("id");
		AddImage("Items/Magazines/" + (isExplicit(true) ? "magazine-hard" : "magazine-soft") + id + ".jpg");
		addPlaceTitle(md, "Your Porn Collection");
		if (id === "0") md.write("<p>Your collection of magazines some soft with no explicit content and others harcore. A fair number are incestuous, not as if you are into that!</p>" + "<p>The again this magazine is somewhat of a rarity, at times you are undecided if this is the sort of thing you like of not.</p>");
		else md.write("<p>Your collection of magazines some soft with no explicit content and others harcore. A fair number are incestuous, not as if you are into that!</p>" + "<p>You do find that you tend to buy magazines with people in them who look familiar in some way. Sometimes you wonder, or is it fantasise, that they are actually the people you know using a secret identity to appear in porn.</p>");
		var nid = parseInt(id, 10) + 1;
		if (!isExplicit(true) && nid > 10) nid = 1;
		else if (perYou.isBornMale()) {
			if (nid > 22) nid =
				0
		} else if (nid > 23) nid = 0;
		startQuestions();
		if (id === "0") {
			addLinkToPlace(md, "Yes, I do", 41, "type=look&id=0", "", "", "perJesse.setFlag(6)", perJesse.checkFlag(6) ? "chatblock" : "optionblock");
			addLinkToPlace(md, "No, I do not", 41, "type=look&id=0", "", "", "perJesse.setFlag(6,false)", perJesse.checkFlag(6) ? "optionblock" : "chatblock")
		}
		addLinkToPlace(md, "look at another", 41, "type=look&id=" + nid);
		addLinkToPlace(md, "rearrange so the softcore ones are on top", 41, "type=look&id=1", "You put the softcore ones on top so you will only see <b>non-explicit</b> images for now",
			"", "setExplicit(false)", isExplicit(true) ? "optionblock" : "chatblock");
		addLinkToPlace(md, "rearrange so the hardcore ones are on top", 41, "type=look&id=1", "You put the hardcore ones on top so you will only see <b>explicit</b> images for now", "", "setExplicit(true)", isExplicit(true) ? "chatblock" : "optionblock");
		addLinkToPlace(md, "put them back in the chest", 41);
		WritePlaceFooter(md, "", true, true);
		return
	}
	md = WritePlaceHeader(false, "td-none");
	addPlaceTitle(md, "Stored Items");
	AddImage("Items/chest.png", "20%", "right");
	md.write("<p>Your storage chest, an old item that was handed down through your family for at least 200 years. Unfortunately it was once valued as 'common and of little value' so it is an antique but not worth anything.</p><p>You store assorted things in it, odd books, old toys and the such.</p>" + '<table width="100%"><tr><td colspan=4><b>The chest contains:</b></td></tr>');
	var iCol = 1;
	for (i = 0; i <= T.length; i++) {
		if (i == T.length) {
			if (iCol == 1) md.write("<tr>");
			md.write('<td style="width:20%;max-width:20vw"><b>Your Porn Magazines</b><br>' +
				'<a href="javascript:dispPlace(41,\'type=look&id=1\')"><img style="float:right;margin-right:10%;max-width:80%;max-height: 80" src="Images/Items/Magazines/' + (isExplicit(true) ? "magazine-hard1.jpg" : "magazine-soft1.jpg") + '" height="100" alt="Porn"/>Look</a>' + "</td>")
		} else {
			if (T[i].place != Place) continue;
			if (iCol == 1) md.write("<tr>");
			md.write('<td style="width:20%;max-width:20vw"><b>' + getItemName(T[i].item) + "</b><br>" + createMenu(T[i].item, 1, 4) + "</td>")
		}
		iCol++;
		if (iCol > 4) {
			md.write("</tr>");
			iCol = 1
		}
	}
	if (iCol > 1 &&
		iCol < 4) {
		for (i = 0; i < 4; i++) md.write('<td  style="width:20%;max-width:20vw">&nbsp;</td>');
		md.write("</tr>")
	}
	md.write("</table><br>");
	startQuestions();
	addLinkToPlace(md, "close the chest", 46);
	WritePlaceFooter(md, "", true, true)
}

function ShowPlace42() {
	var md = WritePlaceHeader();
	addPlaceImage(md, isPlaceKnown("HiddenRoom") ? "alley2.jpg" : "alley1.jpg", "80%");
	if (wherePerson("Kurndorf") == 6) {
		md.write('<img src="Images/ghost2.png" style="border-style:none;margin:0px 5px;float:left;position:absolute;width:50%;width:15vw; top:0px; left:0" alt="Ghost">');
		addBackgroundImage("Images/ghost2.png", "", nTheme === 0)
	}
	if (!isPlaceKnown("Alley")) setPlaceKnown("Alley");
	addPlaceTitle(md, "Alley");
	md.write("<p>Behind some of the residential properties is an ancient alley. In the past it was a busy thoroughfare but today it is rarely used except for when the townsfolk must take the shortcut by foot.</p>" +
		"<p>A concrete pathway leads from Yoolaroo Drive to Kollam Street.<br>");
	if (wherePerson("Kurndorf") == 6) md.write("<p>You see the ghostly man again.  He is standing in front of a picture of a bull painted on the wall.  Its almost as if he is waiting for you...</p>");
	if (checkPlaceFlag("Alley", 2)) {
		md.write("<p>A grate guards a deep gutter drain. ");
		if (perYou.getQuestRustyKey() < 999) md.write(" You can see a dull rusty metallic object partially buried underneath some debris.");
		md.write("</p>")
	}
	if (isPlaceKnown("HiddenRoom")) md.write("<p>You can see a faint outline of the door to the hidden room.</p>");
	if (checkPlaceFlag("Alley", 6) && isSpellKnown("Clairvoyance")) md.write("<p>As you move through the alley, a small stone falls out of the east wall.  A small, very <i>familiar</i> looking stone.</p>");
	startQuestions();
	if (checkPlaceFlag("Alley", 6) && isSpellKnown("Clairvoyance")) addQuestionCO(md, "pick up the stone", "Misc", 376);
	if (isPlaceKnown("HiddenRoom")) addLinkToPlace(md, "enter the Hidden Room", 53);
	if (wherePerson("Kurndorf") == 6) addQuestionCO(md, "watch the Ghost", "Misc", 13206);
	addLinkToPlace(md, "walk to Kollam Street",
		44);
	addLinkToPlace(md, "walk to Yoolaroo Drive", 43);
	WritePlaceFooter(md)
}

function ShowPlace43() {
	var md;
	if (sType == "gate") {
		md = WritePlaceHeader();
		addPlaceTitle(md, "Access Road Gate", "accessroad-fence.jpg");
		md.write("<p>The access road is fenced off and locked to prevent unauthorised access. The fence is nothing very sturdy and you could easily climb over it.</p>" + "<p>There is an odd symbol on one of the signs, it feels...almost scary...</p>");
		startQuestions();
		if (!checkPlaceFlag("Park", 6)) addPopupLinkToPlace(md, "climb the fence", 43, "type=gate", "A Strange Feeling", "<img src='Images/ward.jpg' style='width:20%;float:right;margin:0 0 2em 5px' alt='Ward'>As you touch the fence you feel an odd tingling and then an intense fear come over you. Nothing you can quite pin down, just a sense of dread.</p><p>You back away and your eyes are drawn to the symbol on the sign on the gate. You do not know how, but you know it is that symbol somehow doing it.</p><p>You have to consider another way in.",
			"setPlaceFlag('Park',6)");
		if (checkPlaceFlag("Park", 5)) addLinkToPlace(md, "unlock the gate and walk down the road", 480);
		addLinkToPlace(md, "return to Yoolaroo Drive", 43);
		WritePlaceFooter(md);
		return
	}
	md = WritePlaceHeader(false, "td-none");
	addPlaceTitle(md, "Yoolaroo Drive");
	md.write('<p style="margin-bottom:-1px">A quiet suburban street. Looking around, ');
	if (isDay()) md.write("you see parents and their children bustling about the neighborhood. The sound of a lawn mower can be heard in the distance as well as someone calling out to his family.");
	else md.write("you see no-one around the neighborhood, everyone must be inside their homes with their families.");
	md.write("</p>");
	if (isPlaceKnown("GrangerHouse")) {
		var perMG = findPerson("Mrs Granger");
		var clv = perMG.getCharmedLevel();
		if (clv > 0 && perMG.dress != perMG.getNextDress()) {
			perMG.dress = perMG.getNextDress();
			perMG.setFlag(6, false)
		}
		var perKate = findPerson("Kate");
		md.write('<p style="clear:both">');
		addPlaceImage(md, "house3.jpg", "20%");
		md.write("You can see the Granger's house.<br><br>");
		if (!isDay())
			if (perMG.place ===
				177 || perKate.place == 1 || perKate.place == 139.5) md.write("Lights are on in the house so someone is home.</p>");
			else md.write("There are no lights on in the house.</p>");
		else if (clv === 0)
			if (isDay()) md.write("Mrs. Granger is standing at the doorway. She waves to you and, for a moment, you see the housewife as she could be instead of the mother of your friend. You wave back and receive a smile from Mrs. Granger. You cannot see Kate at the house or along the street.</p>");
			else md.write("The front door is open to let in the breeze, with a light security door in place.</p>")
	}
	if (isPlaceKnown("RobbinsHouse")) {
		md.write('<p style="clear:both">');
		addPlaceImage(md, "house1.jpg", "20%");
		md.write("You can see the Robbins house. <br><br>Looking around the street, you cannot see Davy or any other members of the family.</p>");
		if (perDavy.checkFlag(9) || isSpellKnown("Teleport")) md.write('<p><img style="float:left;height:1.5em" src="' + getThemeFolder() + (isPlaceAttuned(Place) ? "symbol2" : "symbol1") + '.png" alt="Hexagram" title="Hexagram"> You see a symbol carved into a tree in the front yard.</p>')
	} else if (!isPlaceKnown("GrangerHouse")) {
		md.write('<p style="clear:both">');
		addPlaceImage(md, "house3.jpg", "20%");
		md.write("</p>")
	}
	startQuestions(undefined, "clear");
	if (isPlaceKnown("GrangerHouse")) addLinkToPlace(md, "enter the Granger's residence", 177);
	if (isPlaceKnown("RobbinsHouse")) addLinkToPlace(md, "enter the Robbins residence", 176);
	if (checkPlaceFlag("Park", 4)) addLinkToPlace(md, "check the construction access road", 43, "type=gate");
	if (isPlaceKnown("DervishRd")) addLinkToPlace(md, "walk to Dervish Rd", 5);
	addLinkToPlace(md, "walk to the alley", 42);
	WritePlaceFooter(md)
}

function ShowPlace44() {
	var md = WritePlaceHeader();
	var bSofia = getHour() > 5 && getHour() < 8 && perYou.isQuestComplete(7);
	addPlaceImage(md, "house4.jpg");
	if (wherePerson("Kurndorf") == 5) {
		md.write('<img src="Images/ghost2.png" style="float:left;position:absolute;width:30%;width:10vw; top:10; left:0;margin:0px 5px;border-style:none" alt="Ghost">');
		addBackgroundImage("Images/ghost2.png", "", nTheme === 0)
	}
	if (isPlaceKnown("KellyHouse")) addPlaceImage(md, "house7.jpg");
	addPlaceTitle(md, "Kollam Street", "", 25);
	md.write("<p>Your neighborhood. You have lived on Kollam Street ever since your parents moved into number 26. The first years of life were tough. When you were nine years old your father left your mother for another woman. Then, thanks to the friendliness of the folks on Kollam Street, your family pulled through.</p>");
	if (wherePerson("Kurndorf") == 5) {
		md.write("<p>You see the ghostly man again. He notices you watching him and then moves on into the alley...</p>");
		if (!isPlaceKnown("Alley")) setPlaceKnown("Alley");
		movePerson("Kurndorf", 6)
	}
	if (isPlaceKnown("KellyHouse")) md.write("<p>You can see 22 Kollam Street, the Kellys' house.<br>All is peaceful from the outside; you can hear a little dog barking from behind the fence but no one is in sight.</p>");
	if (bSofia) md.write('<p>A glorious, beautiful white car is parked at your house\u2019s ramp. It once belonged to Sir Ronald, now it\u2019s yours. With an expensive car comes a good chaueffuer. Sofia is standing next to the vehicle, waiting for your arrival. "Good morning , mi ' +
		(perYou.isBornMale() ? "amo" : "Se\u00f1ora") + "! Your car\u2019s prepared and I\u2019m ready to take you anywhere you want!\u201d</p>");
	startQuestions();
	addLinkToPlace(md, "enter your house", 45);
	if (bSofia) addOptionLink(md, "enter Sofia\u2019s car", "carRide('Sofia','Sofia patiently waits for you to enter the car. She closes the door for you and after saluting to you, she occupies the driver\u2019s seat and turns her head. &quot;Where do you wish to go?&quot;','. After you have chosen a selected designation and you arrive at said destination.</p><p>After opening the door for you and waits for you to ready yourself, Sofia hops back into the car and drives off to let you stay low profile.')");
	if (isPlaceKnown("KellyHouse")) addLinkToPlace(md, "enter the Kelly's Residence", 112);
	if (isPlaceKnown("Alley")) addLinkToPlace(md, "walk to the alley", 42);
	if (isPlaceKnown("ShoppingCenter")) addLinkToPlace(md, "walk to the " + getShopStore() + "s", 194);
	addLinkToPlace(md, "walk to Cherise Rd", 37);
	addLinkToPlace(md, "walk to the School", 9);
	if (bSofia) {
		AddPeopleColumn(md);
		findPerson("Sofia").showPerson("sofia_waiting.jpg")
	}
	WritePlaceFooter(md)
}

function Leave45() {
	if (perYou.getQuestRustyKey() == 7 && isDay()) {
		setPersonFlag("Madison", 1);
		perYou.setQuestRustyKey(10)
	}
}

function ShowPlace45(stype) {
	var md = WritePlaceHeader();
	var perMadison = findPerson("Madison");
	var perMom = findPerson("Mom");
	var perTracy = findPerson("Tracy");
	var clvT = perTracy.getCharmedLevel();
	var plcTracy = perTracy.whereNow();
	var perTess = findPerson("Tess");
	var sibling = "Sis";
	if (perYou.isBornMale()) sibling = "Bro";
	if (perYou.getQuestRustyKey() == 8 && whereItem(38) == 289) moveItem(38, 45);
	else if (perYou.getQuestRustyKey() == 900 && perYou.getExperience() > 12) PlaceI(38, 45);
	if (perTracy.checkFlag(6) && !perTracy.checkFlag(9) &&
		perTracy.place == 1) {
		perTracy.place = 122;
		startTimedEvent("TracyMorningAfterDavyEventDone()", 3)
	}
	if (getQueryParam("event") == "")
		if (perTracy.place == 1)
			if (plcTracy != 45) {
				addPlaceImage(md, "kitchen1.jpg", "", "", "Kitchen");
				md.write("<br>")
			} else if (perTracy.isCharmedBy("You") > 0) perTracy.showPersonRandomDN("tracy5", isDay() ? 1 : 2);
	else perTracy.showPersonRandomDN("tracy1", 2);
	else addPlaceImage(md, "kitchen1.jpg", "", "", "Kitchen");
	var loanCompany = 0;
	if (nMoney < 25 && Math.random() < .1) loanCompany = 1;
	if (perYou.getExperience() >
		5 && perMom.other === 0) perMom.moveThem(154);
	addPlaceTitle(md, "26 Kollam Street Kitchen");
	md.write("<p>At home. Coming into your house always means passing through the kitchen.</p><p>");
	if (whereItem(31) === 0 && perYou.isShot()) md.write("<p>" + getPoliceChief() + " Kerry Batton, from the local police station, greets you as you enter. She is concerned as she tells you that Anita is still looking for you.</p>");
	if (perMom.place == 154)
		if (perMom.checkFlag(1)) md.write("<p>You hear a soft voice and some noise coming from your mother's bedroom.</p>");
		else md.write("<p>You hear a noise coming from your mother's bedroom. She must be home.</p>");
	else if (perMom.place > 0) md.write("<p>Your mother is out of the house and her bedroom is locked.</p>");
	if (isDay() && perYou.getQuestRustyKey() == 1) md.write("<p>The home telephone is ringing.</p>");
	if (isShopOpen(0) && (getPersonOther("Mayor") === 3 && wherePerson("Mayor") === 0 || loanCompany === 1) || getBeasleyServant() === 7 || getBeasleyServant() === 11) md.write("<p>The home phone has a light indicating there is a voice message.</p>");
	if (isDay() && perYou.getQuestRustyKey() == 7) md.write("<p>You hear the sound of a delivery van, then a knock on the door</p>");
	else if (perYou.getQuestRustyKey() == 900 && whereItem(38) == 45) md.write("<p>One of the fridge magnets has fallen off and broken on the floor.  The decoration is ruined, but the magnet seems fine.</p>");
	startQuestions();
	if (getHour() > 5 && getHour() < 8 && !perTracy.checkFlag(1) && (perMom.place == 154 || perTracy.place == 1 || perTess.place == 46)) addLinkToPlace(md, "have breakfast", 45, "type=breakfast");
	if (getBeasleyServant() == 7) addLinkToPlace(md, "listen to the message", 146);
	else if (getBeasleyServant() == 11) addLinkToPlace(md, "listen to the message", 149);
	else if (isDay() && loanCompany == 1) addLinkToPlace(md, "listen to the message", 236);
	else if (isDay() && perYou.getQuestRustyKey() == 1) addLinkToPlace(md, "answer the home telephone", 287);
	if (isDay() && perYou.getQuestRustyKey() == 7) addLinkToPlace(md, "answer the door", 288);
	addLinkToPlace(md, "go to your bedroom", 46, "", "", "", "Leave45()");
	if (perMom.place == 154 || perMom.other >
		0) addLinkToPlace(md, "go to Mom's bedroom", 154, "", "", "", "Leave45()");
	addLinkToPlace(md, "look in the attic", 408);
	if (perJesse.whereNow() !== 6) addLinkToPlace(md, "go to the living room", 374, "", "", "", "Leave45()");
	if (perYou.getQuestRustyKey() == 7 && isDay()) addLinkToPlace(md, "leave your house", 288, "type=met");
	else addLinkToPlace(md, "leave your house", 44);
	if (whereItem(31) === 0 && perYou.isShot()) {
		AddPeopleColumnMed(md);
		AddImage("Setting/polb1.jpg")
	}
	WritePlaceFooter(md)
}

function ShowPlace46() {
	var perMadison = findPerson("Madison");
	var perDebra = findPerson("DebraKelly");
	if (perDebra.checkFlag(3) && !perDebra.checkFlag(4)) perDebra.setFlag(4);
	if (perYou.isShot() && !perYou.checkFlag(3)) {
		var itemlist = Object.getOwnPropertyNames(oBaseItems);
		for (var idx = 0; idx < itemlist.length; idx++) {
			var itm = parseInt(itemlist[idx], 10);
			if (itm == 4) continue;
			if (whereItem(itm) == 999) moveItem(itm)
		}
		perYou.setFlag(3)
	}
	var perTanika = findPerson("MrsTanika");
	var clvT = perTanika.getCharmedLevel();
	var nmT = perTanika.getPersonName();
	var nmTs = perTanika.getPersonNameShort();
	var perTess = findPerson("Tess");
	var perAnita = findPerson("Anita");
	var totpeople = perTess.isHere() ? 1 : 0;
	if (perTanika.isHere()) totpeople++;
	if (perAnita.isHere()) totpeople++;
	var nmA = perAnita.getPersonName();
	var posA = perAnita.getCharmedLevel() == 3 ? "slut" : "subordinate";
	var td = totpeople > 1 ? "td-left-med" : "td-left";
	if (perAnita.isHere() && totpeople < 3 && !(perTess.isHere() && perTess.other != 27) || totpeople < 3 && perTess.isHere() && perTanika.isHere() && perTess.other != 27) td = "td-left";
	var md =
		WritePlaceHeader(false, td);
	if (nMoney < 20 && !perYou.isQuestComplete(4)) {
		var csh = 20 - nMoney + 5;
		WriteComments("You sit down on your bed for a moment and you see a little bit of money that had fallen down the side of the bed. You pick up the " + sCurrency + csh + " and pocket it");
		AddCash(csh)
	}
	if (totpeople > 1) {
		var img = "bedroom-";
		if (perTess.isHere()) img += "tess" + (!isDay() ? "3" : perTess.other == 27 ? "1" : "2");
		if (perTanika.isHere()) img += (perTess.isHere() ? "+" : "") + "tanika";
		if (perAnita.isHere()) img += "+anita";
		AddImage(img + ".jpg")
	} else if (perTess.isHere()) {
		if (!isDay()) perTess.showPerson("tess20a.jpg");
		else if (perTess.other == 27) perTess.showPerson("tess14b.jpg");
		else perTess.showPerson("tess7.jpg");
		perTess.setFlag(5)
	} else if (perTanika.isHere()) perTanika.showPerson(clvT < 3 ? "tanika12c.jpg" : "tanika12a.jpg");
	else if (perAnita.isHere()) perAnita.showPerson("anita11.jpg");
	else md.write('<img style="margin: 5px 36px 5px 5px;width:95%;border-style:solid;border-size:2" src="Images/bedroom7.jpg" alt="Your Bedroom">');
	var cnt = 0;
	for (var i = 0; i < T.length; i++)
		if (T[i].place == 41) cnt++;
	md.write('<table style="width:95%"><tr><td style="width:25%"><a href="javascript:gotoPlace(41)"><img src="Images/Items/chest.png" width=95%></a></td><td>At the end of your bed is the old storage chest you use to store assorted items and it ');
	if (cnt === 0) md.write("just contains assorted books and papers and your porn collection.");
	else md.write("contains " + cnt + " item" + (cnt > 1 ? "s" : "") + ".");
	md.write('You can <a href="javascript:gotoPlace(41)">open it</a> to check ' + (cnt > 0 ? "them." : "the porn.") + "</td></tr></table>");
	if (!perMadison.checkFlag(4) && (perMadison.checkFlag(2) || perMadison.checkFlag(3) || perMadison.checkFlag(5))) {
		if (perMadison.checkFlag(2)) md.write("<p>You see what must be the prize Tracy mentioned, from that MC 550 radio quiz. You see a stereo sitting on a shelf of your bookcase, but you notice that one of the speakers is damaged.");
		else if (perMadison.checkFlag(3)) md.write("<p>You see a stereo sitting on a shelf of your bookcase, and there is a note congratulating you on winning the Radio MC 550 quiz. Unfortunately you notice that one of the speakers is damaged.");
		else md.write("<p>You see your prize stereo sitting on a shelf of your bookcase and you are reminded of the damage the delivery-girl Madison did.");
		md.write(" You feel a little annoyed with the delivery-girl and must go and complain sometime <b>in person</b> at the radio station to her.</p>");
		perMadison.setFlag(4);
		perYou.setFlag(2);
		if (whereItem(38) == 289) moveItem(38)
	} else if (perYou.checkFlag(2)) md.write("<p>You see the damaged stereo sitting on a shelf of your bookcase.</p>");
	addPlaceTitle(md, "Your Bedroom");
	if (totpeople === 0) md.write("<p>At last you can get away from everyone for enough time to think things through.</p>");
	else if (totpeople == 2 && perTess.isHere() && perTanika.isHere()) md.write("<p>Your bedroom is filled with sweet aroma and perfume as you enter. Tess and Mrs Tanika are lying on your bed, having a talk in their underwear. Both of them spin up as they recognize that their " +
		perYou.getMaster() + " has arrived home. Like a joint operation they work together on luring you to bed and to join them in their welcoming arms. You give in to their charms and lie between them.</p>");
	else if (totpeople == 2 && perTess.isHere() && perAnita.isHere()) md.write("<p>Your " + posA + " Anita opens your bedroom door for you. After stepping in, she closes it and joins Tess in properly welcoming home their " + perYou.getMaster() + " on the bed. Anita\u2019s posture is like soldier\u2019s, rigid with a wooden face, she is ready to receive her orders from her commander. Tess\u2019s behaviour is more friendly, gentle. She is opening her arms, trying to charm you into the bed to join them.</p>");
	else if (totpeople == 2 && perTanika.isHere() && perAnita.isHere()) md.write("<p>Anita is standing guard at your bedroom door. Your " + posA + " Anita opens it for you and waits for you to enter. She joins your other live-in servant, Mrs Tanika in welcoming home their " + perYou.getMaster() + ". Anita\u2019s attitude and personality must be contagious because they both salute you by waving their hands to their heads, like real soldiers do. This must be something Anita taught to Mrs Tanika. They sit down onto the bed, noiselessly awaiting their next instructions from their commander.</p>");
	else if (totpeople == 3) md.write("<p>Your " + posA + " Anita closes the door behind you. Your other two servants are on the bed, happily waiting. They all stand up to welcome you home, an event they\u2019ve been looking for all day. Anita\u2019s silent, coldish attitude never lets you forget that she is a guard after all. Mrs Tanika\u2019s role shifted from your math teacher to your house maid, she is responsible for keeping your room and house clean. Tess, your elegant lover is the cheeriest of them all, bringing joy and kindness to the stiff atmosphere. All three of them try their very best on seducing you to bed to join them.</p>");
	else {
		md.write("<p>At last you can get away from everyone for enough time to think things through. Well, almost everyone. ");
		if (perTess.isHere()) md.write("Mrs. Tess Adams is here just as you commanded. Her warm body, not to mention the look on her face, invites you to bed.</p>" + '<p>"Oh ' + perYou.getMaster() + '," she purrs as you fondle her breasts. "I love you so much. I want to call my husband to tell him that our marriage is off."</p>');
		else if (perTanika.isHere())
			if (clvT == 2) md.write(nmT + ", once your teacher now your ever loving girlfriend naps on your bed nakedly as you enter your room. Now you know why she was so strict to her pupils. She was afraid that she would take a liking to one of them and vice versa and could not focus on her duties. So she shove off any of the students approach and she deliberately tried to distance herself from you. She told you that she always liked your personality and had an affection towards you, but she stopped herself from doing anything stupid. Now you can be together without anything to worry about!.</p>");
			else md.write(nmT + ", once your math teacher, she is now your slave, utterly submissive to you, thinking only how to please you. You ordered her to come to your house to live with you. She\u2019s more of a live-in maid now than a teacher she once was,  always tidying, cleaning after you. She\u2019s the one who you give your chores to do the every day, involving taking out the garbage, dusting and overall making your room fresh and clean. You introduced her to the family as a one night girlfriend, but after a few days they asked if she is more than that and you told them that. Tracy and Mom don\u2019t seem to mind a helpful hand around the house.</p>" +
				"<p>Mrs. Tanika is standing next to your bed when you arrive in your room. She must have heard you came and readied herself for you. You motion her  to sit on your bed with a lazy handwave.</p>");
		else md.write(nmA + " is here just as you commanded.</p>")
	}
	startQuestions();
	if (perTess.isHere())
		if (isDay()) addLinkToPlaceC(md, '"I like your outfit, Tess."', 170, "type=enter");
		else addLinkToPlaceC(md, '"I like your nightie, Tess."', 170, "type=enter");
	if (perTanika.isHere())
		if (clvT == 2) addLinkToPlaceC(md, "talk to Susan Tanika",
			Place, "type=tanikaxxx");
		else if (clvT == 3) addLinkToPlace(md, "play with your toy, Mrs. Tanika", Place, "type=tanikaxxx");
	else addLinkToPlaceC(md, "talk to your slave Mrs. Tanika", Place, "type=tanikaxxx");
	if (perAnita.isHere()) addLinkToPlaceC(md, "talk to your " + posA + " Anita", Place, "type=anitaprivate");
	if (!perYou.checkFlag(37) && !perYou.checkFlag(15)) addPopupLink(md, "kill some time", "Stupid Computers", "<img src='UI/phonegame.jpg' style='width:40%;float:right;margin-left:5px' alt='Games'>" + "You look around for something to do, but you have read all the books here, and your desktop computer is, well basic, and not working right. Few games work on it, and those are very old.<br><br>" +
		"You might as well play the basic games on your phone or find something else to do!", false, "perYou.setFlag(37);dispPlace();");
	if (isDay()) addLinkToPlace(md, "wait for darkness", "", "", "You kill time until the sun sets", "", "WaitforForDayNight()");
	if (totpeople === 0) addSleepLink(md, "go to bed for the night", "Goodnight", '<p style="position:absolute;left:50%;top:10%;cursor:pointer;font-size:1.1em;width:50%;color:white">You retire to bed for the night.</p>', "Player/" + sAvatarFolder + "/bed.jpg", false, 46);
	addLinkToPlace(md,
		"go to the kitchen", 45);
	addLinkToPlace(md, "leave your house", 44);
	WritePlaceFooter(md)
}

function ShowPlace47(stype) {
	var md = WritePlaceHeader();
	var perKate = findPerson("Kate");
	addPlaceImage(md, "park1.jpg", "90%", "", "Park");
	if (wherePerson("Kurndorf") == 3) {
		md.write('<img src="Images/ghost2.png" style="float:left;position:absolute;width:50%;width:15vw; top:0px; left:0;margin:0px 5px;border-style:none" alt="Ghost">');
		addBackgroundImage("Images/ghost2.png", "", nTheme === 0)
	}
	addPlaceTitle(md, "Glenvale Park Entrance");
	if (stype === "") {
		md.write("<p>Glenvale park is the pride of the town. Mayor Thomas has proclaimed that the gardens are the best in the region and that everyone should take care not to litter. Any help in maintaining the park is graciously rewarded. ");
		if (isDay()) md.write("There are people browsing through the walkways and sitting on the park benches.</p>");
		else md.write("The park is a safe and peaceful place at night, with the occasional couple meeting for a romantic rendezvous.</p>");
		if (wherePerson("Kurndorf") == 3) {
			md.write("<p>You see the ghostly man again. He notices you watching him and then moves on...</p>");
			movePerson("Kurndorf", 4)
		}
		if (perKate.place == 47) md.write("<p>You see Kate walking down one of the park trails. She seems very distracted, constantly looking over her shoulder and yet not seeming to notice your approach.</p>");
		else if (perKate.place == 421) md.write("<p>You see Kate walking on the path leading to the duck pond. She seems very distracted, constantly looking over her shoulder and yet not seeming to notice your approach.</p>");
		else if (perKate.whereNow() == 216) md.write("<p>You see in the distance one of your friends, Kate riding her bike on the bridge.</p>");
		if (isPlaceKnown("DuckPond")) md.write("<p>You see the path leading to the duck pond.</p>")
	} else if (stype == "clobbered") {
		nMoney = nMoney > 0 ? 0 : nMoney;
		AddCash(0);
		perKate.place =
			9999;
		perKate.setFlag(4);
		if (perDavy.getPathHellgate() === 0) perDavy.setPathHellgate(1);
		showPopupWindow("", "::THUD:: Did someone get the license number of that TRUCK!?!", "");
		md.write("<p>You black out for a bit, and wake some time later, not quite sure where you are or how you got here. Your head is throbbing and you are fairly sure that there is a very large <i>bump</i> on the back of your head for a while.</p>" + "<p>Kate must have noticed as you started to cast the spell.  <i>Man she can hit hard!</i> You think to yourself.</p>" +
			"<p>A few moments later you realize Kate did more than just hit you...  it would seem she liberated your cash from your pocket before she left.</p>" + "<p>You see a note stuck into one of your pockets</p>" + '<p>"<i>You ' + (perYou.isMaleSex() ? "bastard" : "bitch") + ' I almost trusted you! The you had to do whatever that is, something like Davy. You are scum, I hope to never see you again. I getting the hell out of the town, I will sort things our with Mama</i>"')
	}
	startQuestions();
	if (perKate.place == 47) addLinkToPlaceC(md,
		"talk to Kate", 36);
	if (isPlaceKnown("DuckPond")) addLinkToPlace(md, "visit the pond", 421);
	addLinkToPlace(md, "walk to the park bridge", 216);
	if (getPersonOther("Anita") === 12 && !perYou.isShot()) addLinkToPlace(md, "walk to the park pathway", 142);
	else addLinkToPlace(md, "walk to the park pathway", 63);
	addLinkToPlace(md, "walk to the school", 9);
	WritePlaceFooter(md)
}

function ShowPlace48() {
	var md = WritePlaceHeader();
	var perMG = findPerson("MrsGranger");
	var clv = perMG.getCharmedLevel();
	if (clv == 3) perMG.showPerson("granger5b.jpg");
	else {
		perMG.charmThem(4);
		perMG.showPerson("granger5a.jpg")
	}
	addPlaceTitle(md, "Mrs. Granger Under A Spell");
	md.write("<p>The magic courses through her, pulsing within her body, causing the heat to grow, " + "stronger and stronger. Your order starts to shape her thoughts more towards " + "accepting of more such commands, and linking this to the growing desire she feels. " +
		"She can't help but let her gaze fasten upon you, her lips suddenly dry, " + "beckoning her to give them a slow, nervous lick across their expanse.</p>" + "<p>  She draws a deep, staggering breath, teeth lightly biting into her lower " + "lip, before releasing it in a slow, needy moan, her\tvoice trembling with hunger.</p>" + "<p>She hesitantly removes more of her clothing as you ordered, and you see she is not wearing " + "any underwear at all, no bra, no panties. She places her hands to cover herself, but it " +
		"more seems to you she is drawing your attention to her full breasts and delightful pussy.</p>");
	startQuestions();
	if (clv != 3) addQuestionR(md, "tell her she is a slut", "You tell Mrs Granger that she is a bit of a slut for not wearing underwear. Your words beat into her consciousness and she sighs,<br/><i>&quot;I just like to do it sometimes, it is an exciting naughtyness to be so exposed when talking to people or almost showing myself at times.&quot;</i><br/>She pauses and her fingers lightly touch her pussy sliding up and down as your words sink in<br/><i>&quot;I suppose I am a bit of a slut..&quot;</i>",
		"Mrs Granger", "charmPerson(\\'MrsGranger\\',3);");
	addLinkToPlaceC(md, "tell Mrs. Granger she needs more", 49);
	WritePlaceFooter(md, "Script by EH")
}

function ShowPlace49() {
	var md = WritePlaceHeader();
	var perMG = findPerson("MrsGranger");
	var clv = perMG.getCharmedLevel();
	perMG.showPersonRorX((isExplicit() ? "!" : "") + "granger19a.jpg");
	addPlaceTitle(md, "Mrs. Granger Under A Spell");
	md.write("<p>&quot;Mmm... yes... yes, I think I do...&quot; she half-moans as she looks at you, " + "eyes pulsing with both the gleam of magic and an exploding passion. She quickly bends down and gets something out of her handbag " + "&quot;Can you do me a favor? I think I need your help in a <i>very</i> special way...&quot;</p> " +
		"<p>A thrilling pounding races through your heart, a rush of adrenaline at the thought of how close you are to taking her.</p>" + "<p>As you watch she rubs the dildo she picked up over her pussy and ass, but not inserting it, just playing to arouse her and you.</p>");
	startQuestions();
	if (clv == 3) addLinkToPlaceC(md, "tell her to cum for you like the slut she is", 50, "type=cum");
	else addLinkToPlaceC(md, "order her to play with herself", 50);
	WritePlaceFooter(md)
}

function ShowPlace50(stype) {
	var md = WritePlaceHeader(false, stype == "cum" ? "td-left-med" : "");
	var perMG = findPerson("MrsGranger");
	if (stype == "cum") perMG.showPersonRorX((isExplicit() ? "!" : "") + "granger19b.jpg");
	else perMG.showPersonRorX((isExplicit() ? "!" : "") + "granger19a.jpg");
	addPlaceTitle(md, "Mrs. Granger Under A Spell");
	if (stype !== "cum") {
		md.write("<p>&quot;That.... That's not right,&quot; she frowns as " + "she shakes her head a bit, &quot;I mean... I don't want to " + "give you the wrong idea honey... you... you just can't go " +
			"around telling people to do those sort of things...&quot; " + "Even as she speaks, her hands have already followed your instruction as she rubs her pussy and slides the dildo into her ass.</p>" + "<p>In a small, almost nonexistent voice she whimpers, &quot;Can you...?&quot;</p>" + '<p>You firmly reply "Yes I can, you desire to submit to another, to do anything I say"</p>' + '<p>She moans and shudders in orgasm, and unsteadily cries "Yes...I do"</p>');
		startQuestions();
		addLinkToPlaceC(md, "order her to obey you always",
			51)
	} else {
		md.write('<p>"Mmm... yes... yes... no... no... I am not... what about Kate...", ' + " her eyes closing with passion but still pulsing with the gleam of magic</p>" + '<p>You tell her "Of course you are, only a slut would not wear underwear when her daughters friend visits and then strip and use a dildo in her ass"</p> ' + '<p>You hear her moan and her fingers rapidly rub her pussy and clit while she thrusts the dildo into her ass. As her orgasm approaches you see a hint of resistance as she whispers raggedly "but Kate..."</p>' +
			'<p>You look her in the eyes, "Kate and my relationship have nothing to do with the fact you are a wanton slut who craves sex and who\'s greatest joy in life is to orgasm"</p>' + "<p>She cries out something incoherent as she has a intense orgasm.</p>");
		startQuestions();
		addLinkToPlaceC(md, "promise her all the sex she desires", 51)
	}
	WritePlaceFooter(md)
}

function ShowPlace51(stype) {
	var md = WritePlaceHeader();
	var perMG = findPerson("MrsGranger");
	var clv = perMG.getCharmedLevel();
	perMG.showPerson("granger20.jpg");
	var yt = clv == 3 ? "lover" : perYou.getMaster();
	addPlaceTitle(md, "Mrs. Granger Under A Spell");
	md.write("<p>In the afterglow of her orgasm, the battle becomes too much for her impassioned mind. " + "Her resistance melts away as she feels the enchanting warmth sweep across her body, " + "filling her with a contented relaxation. Her will is utterly consumed and replaced " +
		"with a heated energy, she stops trying to resist, and instead " + "gives in to the pleasure. She stands and proudly displays her body and especially her ass for you.</p>" + "<p>&quot;Mmmm... you're right... I...  belong to you...&quot; " + "she says, her body quivering. &quot;I really shouldn't worry about being so shy... " + "especially around you... Any... friend of Kate's is welcome to be a " + yt + " of mine... " + "After all... sharing is good... right?&quot;</p>");
	startQuestions();
	if (clv == 3) addLinkToPlaceC(md,
		"ask her to have sex", 60);
	else addLinkToPlaceC(md, "tell her to fuck you?", 60);
	WritePlaceFooter(md, "Script by EH (tweaked for path)")
}

function ShowPlace52() {
	var md = WritePlaceHeader(true);
	var perTess = findPerson("Tess");
	md.write('<table style="width:100%"><tr><td style="width:70%" style="vertical-align:top"><div style="text-align:center">' + '<p style="font-size:x-large"><b>Tess Adams Research</b></p>' + "<p>I want to look up the word(s):</p>");
	md.write('<form method="POST" name="FormChar">');
	md.write('<p><input type="text" size="20" name="research"><input type="button" name="button" value="please" onClick="ResearchOLD(\'T\', document.FormChar.research.value)"></p>');
	md.write("</form><p>");
	addLinkToPlace(md, "Never mind...", 28);
	AddRightColumnLarge(md);
	if (isCharmedBy("Tess")) perTess.showPerson("tess5a.jpg");
	else perTess.showPerson("tess5.jpg");
	WritePlaceFooter(md)
}

function ShowPlace53(stype) {
	var md = WritePlaceHeader(false, stype == "look" ? "" : "td-left-med");
	var perMonique = findPerson("Monique");
	var perAbby = findPerson("Abby");
	var perLeanne = findPerson("Leanne");
	var perVamp = findPerson("Vampyre");
	if (stype == "look") {
		addPlaceTitle(md, "Looking in the Mirror", "mirror.jpg");
		md.write("<p>You look in the mirrors and for a moment you do not even see your own reflection, but you realise it is just a matter of angles. You see your own reflection");
		var cor = perYou.getCorruption();
		if (cor < 5) md.write(" and it is clear and bright despite the dark colouring of the mirrors");
		else if (cor < 10) md.write(" and it is little odd, slightly distorted, the mirrors must have an imperfect surface");
		else if (cor < 20) md.write(" and it is distorted with an odd sort of faint double image, almost like there is someone standing behind you");
		else md.write(" and it is distorted with an odd double image, it looks almost like the ghostly image you have seen of Kurndorf");
		md.write(".</p><p>For no reason you understand a number suddenly comes to mind, " +
			cor + ", but just as quickly it fades and you can barely remember it.</p>" + "<p>You also get an impression of energy in yourself and a number of " + perYou.getExperience() + " and a building feeling and another number " + (perYou.other - perYou.extra[11]) + ". You have no idea what this means, maybe something related to your magical abilities?</p>" + "<p>You look away a little bit creeped out. As you do you swear you saw the statue twist and look at you, but you quickly look and it is fixed in the same place as always, still <b>not reflecting</b> in the mirrors.</p>");
		startQuestions();
		addLinkToPlace(md, "look away", 53)
	} else if (stype == "movegem") {
		addPlaceTitle(md, "Moving the Dragon Gem", "hiddenroom1b.jpg");
		moveItem(35, -53);
		md.write("<p>You realise that since Abby can carry the Dragon Gem then you can move it from the Mechanics Workshop. You have seen how the gem is shaped to fit into a socket and that the dragon statue in the hidden room in the alley has eye sockets around the right size to fit the gem. You ask Abby if she will come with you to move the gem and see if it fits in the statue. She says happily,</p>" +
			'<p>"Of course, but there is only one gem, so the Dragon will not awaken! By the way, did you hear about Sally Bartel..."</p>' + "<p>She continues on gossiping about townsfolk and an affair she heard rumours about. It is hard to really focus on what Abby says as she talks about everything, and jumps from person to news story to jokes all the time.</p>" + "<p>You leave with Abby following, naked as always, and quickly walk to the Mechanics Workshop where Abby casually picks up the gem, again not noticing the extreme heat of the gem, treating it as any other stone. Hannah watches curiously, but you do not have time to satisfy her curiosity, and you leave with Abby and walk to the alley.</p>" +
			"<p>You enter the hidden room with Abby and she approaches the statue with a little hesitation, she is visibly frightened. She reaches out with the gem towards the nearest eye-socket. She is acting like she is reaching out to a lion, expecting it to bite her hand off or something. With an audible click the gem seats securely into the eye-socket and Abby leaps backward.</p>" + "<p>The gem sits there, softly glowing, and for a moment you thought you saw something in one of the mirrors, but when you look more closely, nothing is there. Abby asks if she can leave now, still very frightened. You allow her to leave and you see her walk out of the room, completely naked as always. Just before she leaves she says,</p>" +
			'<p>"The claws of the Dragon are meant to hold something, but it will not be me. I heard they can rip your soul out of your body!"</p>' + "<p>After she leaves you can feel the room has changed, power infuses the room...</p>");
		startQuestions()
	} else if (stype == "checkstatue") {
		addPlaceTitle(md, "Checking the Dragon Statue", "hiddenroom1a.jpg");
		setPlaceFlag("Alley", 8);
		md.write("<p>You tell Abby about the Dragon statue in the Hidden Room and how she has talked about the legendary dragon, and that the statue seems to be an asian style dragon. You ask Abby if she will come with you to examine the statue and see if she can work out anything more about the statue. She says happily,</p>" +
			'<p>"Of course, but you know that gem at the Mechanics looks like a dragons eye? By the way, did you hear that Tess Adams is having an affair..."</p>' + "<p>She continues on gossiping about townsfolk and an affair too close for comfort. It is hard to really focus on what Abby says as she talks about everything, and jumps from person to news story to jokes all the time.</p>" + "<p>You leave with Abby following, naked as always, and quickly walk to the Hidden Room. Immediately she looks rather afraid,</p>" +
			'<p>"The Dragon...the eyes of the Dragon are empty, they have been plucked out to make it sleep. But it is horrible, a thing to devour your soul!"</p>' + "<p>She is rather afraid and you decide to let her leave, and she almost runs out of the Hidden Room. After she leaves you can clearly see the eyes of the statue are sockets intended to put something into.</p>");
		startQuestions()
	} else if (stype == "teleportthrall" || stype == "vampabduct") {
		if (stype !== "vampabduct") {
			AddMana(-1);
			setPersonOther("Daria", nTime,
				1)
		}
		if (isDemonGone()) {
			perLeanne.moveThem(450);
			addPlaceImage(md, "hiddenroom1b.jpg");
			perLeanne.showPerson("leanne6e.jpg");
			addPlaceTitle(md, "Freeing the Thrall");
			md.write("<p>You tell the thrall that you are going to free her from the church, they you will take her away from here,</p>" + '<p>"Yes, I will reward you to our pleasure.", she tells you seductively.</p>' + "<p>You cast the spell and you teleport with the thrall into the Hidden Room. As you appear she looks around curiously, and then with suspicion at the statue. You tell her,</p>" +
				'<p>"Leave here, your former Mistress is gone, she has abandoned you. You promised to reward me, go somewhere, I will find you, until then do nothing, you must reward me first!". She looks at you and replies,</p>' + '<p>"Of course, this thrall knows the demon has left, this thrall is of no use any more. What is a thrall with no Mistress?", and she leaves the Hidden Room.</p>')
		} else if (perYourBody.FindItem(48) === 0) {
			perLeanne.moveThem(450);
			addPlaceImage(md, "hiddenroom1b.jpg");
			perLeanne.showPerson("leanne6e.jpg");
			addPlaceTitle(md, "Attempting the Ritual of Return");
			md.write("<p>You tell the thrall that you are going to free her from the church, they you will take her away from here,</p>" + '<p>"Yes, I will reward you to our pleasure.", she tells you seductively.</p>' + "<p>You cast the spell and you teleport with the thrall into the Hidden Room. As you appear she looks around curiously, and then with suspicion at the statue. You quickly start to prepare for the ritual, but you realise you do not have the relic with the demon bound into it. The thrall laughs,</p>" +
				'<p>"Foolish ' + perYou.getWitch() + '!", and she runs out of the door into the alleyway. You try to follow but she is very fast and quick gets out of your sight.</p>' + "<p>Well, you have messed up, where would the thrall go, back to the graveyard, or somewhere else?</p>")
		} else {
			perYourBody.DropItem(48, -53);
			perLeanne.moveThem(53);
			perLeanne.unCharmThem();
			addPlaceImage(md, "hiddenroom1d.jpg");
			perLeanne.showPerson("leanne6e.jpg");
			if (stype == "vampabduct") {
				addPlaceTitle(md, "The Vampyre and The Ritual of Return");
				md.write("<p>You tell the vampyre to grab the thrall and in a blur of inhuman speed the vampyre has embraced the thrall from behind, holding her securely, and somewhat sensually. The thrall looks perplexed,,</p>" + '<p>"This is not necessary, this body is yours, or that of your undead slave, though it is unlikely she will feed on this body". The vampyre looks a little disgusted,</p>' + '<p>"This body is tainted, I will not feed on her. Do you want this thing slain ' + perYou.getMaster() + '?"</p>' + "<p>You tell here to bring the thrall with you, and you leave Leanne's house and quickly cross the town to the Hidden Room. The thrall makes no effort to struggle initially, but as you get near to the alley she starts to try to break free, pointlessly. The vampyre has her securely held with overwhelming strength. Fortunately it is night time and few people around to notice your odd little group.</p>" +
					"<p>In the Hidden Room you tell the vampyre to keep the thrall held but unharmed. You quickly start to prepare for the ritual, and you hang the relic on claws of the statue, the only place it will easily fit. The thrall starts to speak, but the relic glows as you also start to recite the words Ms. Jones taught you. As you do the thrall seems to freeze, and you see an eerie image form in one of the mirrors. A ghostly figure that is only visible in the mirror, an indistinct female figure, it has to be Leanne!</p>" +
					"<p>You call out the last of the words and the thrall lets out a muffled cry, and slumps in the vampyre's arms and vomits. After a short vomit she looks up,</p>" + '<p>"' + perYou.getPersonName() + ' I am free, you saved me, thank you, thank you!"</p>' + "<p>You tell the vampyre to release Leanne and then ask Leanne how she is feeling and what she remembers,")
			} else {
				addPlaceTitle(md, "The Ritual of Return");
				md.write("<p>You tell the thrall that you are going to free her from the church, they you will take her away from here,</p>" +
					'<p>"Yes, I will reward you to our pleasure.", she tells you seductively as she throws on something simple.</p>' + "<p>You cast the spell and you teleport with the thrall into the Hidden Room. As you appear she looks around curiously, and then with suspicion at the statue.</p>" + "<p>You quickly start to prepare for the ritual, and you hang the relic on claws of the statue, the only place it will easily fit. The thrall starts to speak, but the relic glows as you also start to recite the words Ms. Jones taught you. As you do the thrall seems to freeze, and you see an eerie image form in one of the mirrors. A ghostly figure that is only visible in the mirror, an indistinct female figure, it has to be Leanne!</p>" +
					"<p>You call out the last of the words and the thrall lets out a muffled cry, and slumps to the ground and vomits. After a short vomit she looks up,</p>" + '<p>"' + perYou.getPersonName() + ' I am free, you saved me, thank you, thank you!"</p>' + "<p>You ask how she is feeling and what she remembers,")
			}
			if (perLeanne.hadSexYourself()) md.write(" especially how you had had sex with her when she was the thrall,");
			md.write('<p>"I remember everything...it is like I was asleep but when I woke up I could remember this very vivid dream, but I know it was real, just not what I was doing...');
			if (perLeanne.hadSexYourself()) md.write('I remember what you did with <i>her</i> very clearly."</p>' + "<p>She looks at you very embarrassed, and continues,</p>" + '<p>"We will never speak of it."</p>');
			else md.write('"</p>');
			md.write("<p>You tell Leanne it would be best if she return home and clean up and that you will visit her later.");
			if (perLeanne.hadSexYourself()) md.write(" She blushes and agrees.</p>");
			else md.write(" She agrees readily.</p>");
			perYou.completeQuest(5)
		}
	} else {
		setPlaceKnown("HiddenRoom");
		var img = whereItem(35) == -53 ? whereItem(48) == -53 ? "hiddenroom1c.jpg" : "hiddenroom1b.jpg" : "hiddenroom1a.jpg";
		addPlaceImage(md, img, "", "", "Hidden Room");
		if (perMonique.isHere()) perMonique.showPersonFace();
		addPlaceTitle(md, "Hidden Room");
		md.write("<p>You enter a strange room with an unusual asian style dragon sculpture perched upon a pedestal. ");
		if (whereItem(35) == -53) md.write("One of the eyes of the statue is filled with the dragon gem, the other is empty.");
		else md.write("You notice the eyes of the statue are empty sockets.");
		md.write(" Lining the walls are large tinted mirrors that reflect the room darkly. ");
		if (checkPersonFlag("Victoria", 9) || perVamp.checkFlag(2)) md.write("You now know these are called the 'Mirrors of the Soul'. ");
		md.write("To your great discomfort you see the sculpture <b>does not reflect</b> in any of the mirrors.</p>");
		if (!checkPlaceFlag("Alley", 8)) md.write("<p>You have a feeling there is something in the room, odd reflections in the mirrors and shifting shadows. Whatever it is you can never quite see it.</p>");
		else md.write("<p>There are still odd reflections and shifting shadows, but you can now see they are all centered on the statue in some way.</p>");
		if (!isSpellKnown("Charm")) md.write("As you examine the room you see a note scribbled onto the frame of one of the mirrors.</p>");
		if (perMonique.isHere()) md.write("<p>Monique greets you. \"I can't find any magic " + perYou.getMaster() + '. Please forgive me."');
		startQuestions();
		addLinkToPlace(md, "look in the mirrors", 53, "type=look");
		if (!isSpellKnown("Charm"))
			if (isRunes()) addOptionLink(md,
				"examine the note", "Research('Spell', 'DaiChu');");
			else md.write('<p style="text-align:center">What are the strange words in the note?<br>' + '<form method="POST" name="FormChar" style="text-align:center"><input type="text" size="20" name="research"> <input type="button" name="button" value="enter" onClick=ResearchOLD("H",document.FormChar.research.value)></form></p>');
		if (perMonique.isHere()) addQuestionCO(md, "tell Monique to look up the library files for Davy", "Monique", 1105)
	}
	if (whereItem(48) == -53) addOptionLink(md,
		"remove the relic", "perYourBody.PutItem(48);gotoPlace(53)");
	if (perLeanne.isHere()) addOptionLink(md, "say goodbye to Leanne for now", "movePerson('Leanne',450);gotoPlace(53)");
	addLinkToPlace(md, "exit the room?", 42);
	if (stype == "movegem" || stype == "vampabduct" || stype == "checkstatue") {
		AddPeopleColumnMed(md);
		if (stype == "vampabduct") perVamp.showPerson("vamp1b.jpg");
		else perAbby.showPerson("abby11a.jpg")
	}
	WritePlaceFooter(md)
}

function ShowPlace54() {
	var md = WritePlaceHeader();
	var perMG = findPerson("MrsGranger");
	perMG.showPerson("granger3.jpg");
	addPlaceTitle(md, "Mrs. Granger Under A Spell");
	md.write("<p>&quot;Take off my clothes?!&quot; her voice comes as a shocked gasp, an almost incredulity as she momentarily " + "bats off the touch of the magic, &quot;Just what kind of woman do you think I am?&quot;</p>" + "<p>Her body feels a sudden flush as the magic presses its assault once more upon her, a heat slowly building within " +
		"her, &quot;W-well... it... it is a bit warm here... All-right... I'll... lower my top... But nothing else!&quot;</p>");
	startQuestions();
	addLinkToPlace(md, "wait for the spell to take more effect", 55);
	if (perYou.checkFlag(26)) addLinkToPlaceC(md, "tell her to strip more", 48);
	WritePlaceFooter(md, "Script by EH")
}

function ShowPlace55() {
	var md = WritePlaceHeader();
	var perMG = findPerson("MrsGranger");
	perMG.charmThem(2);
	perMG.showPerson("recharm1-day.jpg");
	addPlaceTitle(md, "Mrs. Granger Under A Spell");
	md.write("<p>The magic courses through her, pulsing within her " + "body, causing the heat to grow, stronger and stronger. " + "She can't help but let her gaze fasten upon you, her " + "lips suddenly dry, beckoning her to give them a slow, " + "nervous lick across their expanse.</p>" + "<p>  She draws a deep, staggering breath, teeth lightly biting into her lower " +
		"lip, before releasing it in a slow, needy moan, her voice trembling with hunger.</p>");
	startQuestions();
	addLinkToPlaceC(md, "ask if Mrs. Granger needs anything", 56);
	WritePlaceFooter(md, "Script by EH")
}

function ShowPlace56() {
	var md = WritePlaceHeader();
	var perMG = findPerson("MrsGranger");
	perMG.showPerson("recharm2-day.jpg");
	addPlaceTitle(md, "Mrs. Granger Under A Spell");
	md.write('<p>"Mmm... yes... yes, I think I do..." she half-moans ' + "as she looks at you, eyes pulsing with both the gleam of magic and a building passion for you, " + '"Can you do me a favor? I think I need your help in a <i>very</i> special way..."</p>' + "<p>A thrilling pounding races through your heart, a rush of adrenaline at the thought of how close you are to taking her.</p>");
	startQuestions();
	addLinkToPlaceC(md, "tell her to play with herself?", 58);
	WritePlaceFooter(md, "Script by EH")
}

function ShowPlace58() {
	var md = WritePlaceHeader(false, "td-left-med");
	var perMG = findPerson("MrsGranger");
	perMG.showPerson("granger8.jpg");
	addPlaceTitle(md, "Mrs. Granger Under A Spell");
	md.write("<p>&quot;That.... That's not right,&quot; she frowns as " + "she shakes her head a bit, &quot;I mean... I don't want to " + "give you the wrong idea honey... you... you just can't go " + "around telling people to do those sort of things...&quot; " + "Even as she speaks, her hands have already followed your instruction.</p>" +
		"<p>In a small, almost nonexistent voice she whimpers, &quot;Can you...?&quot;</p>");
	startQuestions();
	addLinkToPlaceC(md, "ask her to play with herself", 59);
	addLinkToPlaceC(md, '"Yes...  I can. Give in, Mrs. Granger.  You belong to me now."', 59, "type=belong");
	WritePlaceFooter(md, "Script by EH")
}

function ShowPlace59(stype) {
	var md = WritePlaceHeader();
	var perMG = findPerson("MrsGranger");
	perMG.showPerson("granger9.jpg");
	var yt = stype === "" ? "friend" : perYou.getMaster();
	addPlaceTitle(md, "Mrs. Granger Under A Spell");
	md.write("<p>At last, the battle becomes too much for her impassioned mind. Her resistance melts away as she feels " + "the enchanting warmth sweep across her body, filling her with a " + "contented relaxation. Her will utterly consumed and replaced " + "with a heated energy, she stops trying to resist, and instead " +
		"gives in to the pleasure.  She stops trying to cover up her breasts, instead thrusting them forward as she leans " + "against the couch, putting herself on display for you.</p>" + "<p>&quot;Mmmm... you're right... I...  belong to you...&quot; " + "she says, her body quivering.  &quot;I should...relax...&quot;</p>" + "<p>She purrs, her body legs spread wide and finger teasing her folds. " + "&quot;I really shouldn't worry about being so shy... especially around you... Any... friend of " + "Kate's is welcome to be a " +
		yt + " of mine... After all...sharing is good... right?&quot;</p>");
	startQuestions();
	if (stype === "") {
		addLinkToPlace(md, "ask her to make love with you?", 60);
		perMG.charmThem(2)
	} else addLinkToPlace(md, "tell her to make love with you?", 60);
	WritePlaceFooter(md, "Script by EH")
}

function ShowPlace60() {
	var md = WritePlaceHeader(false, !perYou.isMaleSex() ? "td-left-large" : "");
	var perMG = findPerson("MrsGranger");
	if (perYou.isMaleSex())
		if (isExplicit()) perMG.showPersonRandomX("!granger17", 3, "height:max");
		else perMG.showPerson("!granger17.jpg");
	else perMG.showPersonRandom("!granger18", 2);
	addPlaceTitle(md, "Mrs. Granger Under A Spell");
	md.write('<p>"Oh... mmm.... ' + perYou.getMaster() + '..." Mrs. Granger practically drips as she leans back, looking at you lustfully, ' + '"I am going to show you such a good time... Why don\'t you come over here baby and give me the best fuck of my life."</p>' +
		"<p>The spell has totally consumed the will of the woman before you, her lust-filled body eagerly responding to " + "you, spreading her legs, revealing in a soft motion the expanse of her inner thighs, before her hands snake out, " + "threading through your hair as she pulls your face down to her lower lips. Her body shakes with a fervent " + "passion against yours, again and again, the pleasure dancing across her mind before her lips part and she " + "manages a whimpering beg to be allowed to do the same for you. With a seemingly unquenchable thirst for passion, " +
		"she remains unrelenting in her need for your kiss, your touch, your feel.</p>" + "<p>She seems insatiable in her desire. Your bodies meet time and again, wild forces of aggressive need burning " + "with a passion almost unknown. Still she cries out for more, her thirst still burning for another, and " + "another. At last, you feel your body drained, your strength weakened, and your energy almost totally gone, " + "and you can tell she is exhausted as well, and yet she begs you, pleads with you... anything for more.</p>" +
		'<p>"Oh...' + perYou.getMaster() + '...more, your Marie wants more...", you realise you had never known her given name, but she will still to you be your MILF Mrs. Granger.');
	startQuestions();
	if (nMana < 20 && perYourBody.FindItem(5) === 0) addLinkToPlaceC(md, "ask her for an artifact", 61);
	addLinkToPlace(md, "exit the house?", 43);
	WritePlaceFooter(md, "Script by EH")
}

function ShowPlace61() {
	var md = WritePlaceHeader();
	var perMG = findPerson("MrsGranger");
	perMG.showPerson(per.getCharmedLevel() == 3 ? "granger11b.jpg" : "granger11a.jpg");
	if (perYourBody.FindItem(5) === 0) perYourBody.PutItem(5, true);
	addPlaceTitle(md, "Mrs. Granger's Artifact");
	md.write("<p>She eagerly hands you an artifact, a small sculpture that is definitely one of the magic stones. As she hands it to you a wide, predatory smile forms on her face as she slowly licks her lips.</p>" + "<p>Her hands linger on yours a bit too long as she purrs, \"Please, take it... and anything else that you see that you like... Any time you want more just let me know... you're the best I've ever had, Mmmm... " +
		perYou.getMaster() + '.  Everything I am belongs to you now."</p>');
	startQuestions();
	addLinkToPlace(md, "talk to her again", 177);
	addLinkToPlace(md, "exit the house?", 43);
	WritePlaceFooter(md, "Script by EH")
}

function ExitTessOfficeR() {
	movePerson("MsTitus", 3);
	dispPlace(3, "");
	WriteComments("You leave Tess and Ms. Titus for now, and within a few minutes Ms. Titus follows looking mildly annoyed.")
}

function ShowPlace62(stype) {
	var md = WritePlaceHeader(false, "td-left-med");
	var perTitus = findPerson("MsTitus");
	var plcTitus = perTitus.place;
	var perTess = findPerson("Tess");
	if (plcTitus == 62) perTitus.showPerson(perTitus.checkFlag(9) ? "titus21b.jpg" : "titus21a.jpg");
	else perTess.showPerson("tess6.jpg");
	addPlaceTitle(md, "Tess Adams Under A Charm Spell");
	if (perTess.other == 5 && (nMana < 10 && nTime - perTess.extra[0] > 24 || nTime - perTess.extra[0] > 288) && perYourBody.FindItem(24) === 0) {
		PlaceI(24, 62);
		perTess.setFlag(3);
		perTess.other =
			2;
		perTess.extra[0] = 0;
		perYou.addExperience(1);
		showPopupWindow("Tess's Research", '<img src="Images/tess5a.jpg" class="imgpopup" alt="Tess">' + "\"I'm so glad that you've returned " + perYou.getPersonName() + '. Through my research I found the location of this gold stone, it was in the library archives and Monique got it for me. Please take it..." she says, her eyes straying all over your body as she begs you.</p>' + '<p><img src="Images/Items/stone3.png" style="float:left;width:10%;margin-right:5px" alt="Stone">' +
			"The stone is not like any other you have seen before, a gold colour but probably more like iron pyrites than actually gold. You know the difference from your days of collecting minerals, you have some of it in your collection in your room. " + "You reach out to touch it and feel a tingle and you can sense the power in it, so you now know about these different sort of stones.</p>")
	} else if (plcTitus !== 62)
		if (stype == "continue") md.write('<p>"Oh , ' + perYou.getPersonName() + '." Tess says.  "I\'m so confused, I feel so much more alive when you are here. It must be the warmth in here. I... I really feel that I have to see my husband and tell him about what I\'m feeling. I have to leave.  Please?"</p>');
		else if (perTess.checkFlag(8)) md.write('<p>"Oh , ' + perYou.getPersonName() + '." Tess says.  "I\'m so glad you\'re back."</p>' + "<p>\"I've needed you so much since you left but now that you're here I feel alive again. It must be the warmth in here.\"</p>");
	else md.write('<p>"Oh , ' + perYou.getPersonName() + '." Tess says.  "I\'m so glad you\'re back."</p>' + "<p>\"I've needed you so much since you left but now that you're here I feel alive again. It must be the warmth in here. I... I really feel that I have to see my husband and tell him about what I'm feeling. I have to leave.  Please?\"</p>");
	else if (perTitus.checkFlag(9)) md.write("<p>Ms. Titus joins you in the room.  She gives you a very odd glance, before focusing her attention on Tess. She looks at Tess's mostly undressed state, glancing from her, to you and back again.</p>" + '<p>"Well Tess, I did not think you would cheat so blatantly on your husband, and with this...person. I mean I practically saw ' + perYou.getHimHer() + ' chase you out of here and then basically drag you back!"</p>' + '<p>Tess looks terribly embarrased and torn, she is still worried about her husband but the spell is drawing her to you. She does mutter "but I wanted to come back...". You do not know what to say, so you snap at Ms. Titus,</p>' +
		'<p>"Tess is a lovely woman and she is so excited now that she is mine. She is kind, unlike you who is a bitch who goes out of her way to taunt her friend like that. Why don\'t you just shut up!"</p>' + "<p>You realise you may of gone too far, but you see Tess look at you relieved that you stood up for her. Ms. Titus on the other hand looks more curious than angry,</p>" + '<p>"Tess is yours, like some sort of...", Ms. Titus trails away.</p>');
	else md.write('<p>Ms. Titus joins you in the room.  She gives you a curious glance, before focusing her attention on Tess. She looks surprised at Tess\'s mostly undressed state, glancing from her to you and back again.</p><p>"I did not know you had it in you Tess...but that aside, what is it, Tess?", she demands. "What did you want?"</p>' +
		"<p>Tess looks a bit embarrassed at Ms. Titus's comments and makes up an excuse about problems with her computer.  Irritated, Ms. Titus tells her to <i>dress</i> and go file incoming books while she sorts things out.</p>");
	startQuestions();
	if (plcTitus != 62) {
		if (!perTess.checkFlag(10) && !isSpellKnown("Pass")) addQuestionCO(md, "tell Tess to look something up for you", "Tess", 2105);
		if (perYourBody.FindItem(4) > 0 && perYou.checkFlag(11) && perYou.canUseExperience()) addOptionLink(md, "ask Tess for help deciphering the passages in the book",
			"spendExperience()");
		if (!perTess.checkFlag(8) && perTess.other != 5) addLinkToPlaceC(md, "order Tess to stay", 30);
		else if (perTess.checkFlag(8))
			if (!checkPlaceFlag("Library", 1)) addLinkToPlaceC(md, "close the door for some private time with Tess", 62, "type=private");
			else addLinkToPlaceC(md, "have some private time with Tess", 62, "type=private");
		if (perTess.other <= 1) addQuestionC(md, "tell Tess to stay here and research more magic spells", "Tess", 2001);
		if (perTess.other <= 2 || perTess.checkFlag(8)) addQuestionC(md, perTess.checkFlag(8) ?
			"let's return to my home" : "order Tess to come to your house and wear something sexy", "Tess", 2002);
		if (perTess.other == 5) addQuestionCO(md, "tell Tess to forget about the research", "Tess", 2005);
		if (!(perTitus.isCharmedBy() || perTitus.isFreeSlave())) addQuestionC(md, "tell her to invite the library receptionist in here.", "Tess", 2003);
		if (perTess.checkFlag(8)) {
			if (isCharmedBy("Monique") && wherePerson("Monique") == 8) {
				if (perTitus.isCharmedBy() || perTitus.isFreeSlave()) addLinkToPlaceC(md, "bring in all the librarians",
					62, "type=all");
				addLinkToPlaceC(md, "invite Tess to bring in Monique to further assist", 62, "type=tessmonique")
			}
			if (perTitus.isCharmedBy() || perTitus.isFreeSlave()) addLinkToPlaceC(md, "invite Tess to bring in Ms. Titus to further assist", 62, "type=tesstitus")
		}
		addLinkToPlace(md, "go to the reception area.", 3)
	} else if (perTitus.checkFlag(9)) addLinkToPlace(md, "kiss Tess, turn your back on Ms. Titus and leave", 62, "type=slave1");
	else addOptionLink(md, "leave them and go to the reception area.", "ExitTessOfficeR()");
	WritePlaceFooter(md)
}

function ShowPlace63() {
	var md = WritePlaceHeader();
	var perDebra = findPerson("DebraKelly");
	var perKate = findPerson("Kate");
	if (perJesse.getDemonPath() == 30 && perJesse.place == 10) perJesse.place = 2;
	if (wherePerson("Kurndorf") == 2) movePerson("Kurndorf", 3);
	if (getPersonOther("Anita") == 12) setPersonOther("Anita", 13);
	addPlaceTitle(md, "Park Pathway", whereItem(37) === 0 ? "park3kite.jpg" : "park3.jpg");
	md.write("<p>A pathway takes you along a small river. The surroundings have a soothing effect on your well-being " + "and for a moment you wonder about what life would be like ");
	if (isSpellKnown("Charm")) md.write("without mind control.");
	else md.write("without your hunt for the spells in the Book of Control.");
	md.write(" Such a silly notion doesn't last very long and you set your mind back to your goal.</p>");
	if (whereItem(37) === 0) md.write("<p>A kite is caught in a tree.</p>");
	if (perKate.isHere()) md.write("<p>You look around to see one of your friends, Kate, approaching from the far end of the park. Kate isn't known for her social skills, probably due to the fact she always has her head in school books, but she does know a lot about practically everything. She's in a hurry and hasn't seen you yet.</p>");
	if (getPersonOther("Anita") == 900) md.write("<p>Anita lies still, a bullet hole in her heart.</p>");
	else if (getPersonOther("Anita") == 901) md.write("<p>The police have cleared the scene of Anita's murder.  You can still see the slight stain in the grass where her body fell to the ground, the sound of the shot echo's in your ears like a ghost.</p>");
	if (perJesse.place == 2) md.write("<p>You can see the face of Jesse peeking out from behind a tree - her eyes still glowing with the presence of the demon hiding within her body.</p>");
	if (perYou.getExperience() > 0)
		if (perDebra.place === 87 && isDay())
			if (!isPlaceKnown("KellyHouse")) md.write("<p>You see another pathway curving away and a girl walking along it.</p>");
			else md.write("<p>You see Debra walking in the distance.</p>");
	else md.write("<p>You see another pathway curving away.</p>");
	startQuestions();
	if (perJesse.place === 2) addLinkToPlaceC(md, "approach Jesse behind the tree", 63, "type=jessepark");
	if (perKate.isHere()) addLinkToPlaceC(md, "approach Kate", 4);
	else if (whereItem(37) === 0) addQuestionCO(md,
		"pull the kite out of the tree", "Misc", 63);
	if (perYou.getExperience() > 12)
		if (perDebra.place === 87 && isDay()) {
			var herName = perDebra.getPersonName();
			if (!isPlaceKnown("KellyHouse")) addLinkToPlaceC(md, "approach the girl on the other pathway", 87);
			else addLinkToPlaceC(md, "approach " + herName, 87)
		} else addLinkToPlace(md, "walk to the other pathway", 87);
	if (isPlaceKnown("WildRanges")) addOptionLink(md, "enter the wild ranges", "LeaveKate4(26)", "moveblock");
	addOptionLink(md, "walk to the park entrance", "LeaveKate4(47)");
	WritePlaceFooter(md)
}

function ShowPlace64() {
	var md = WritePlaceHeader();
	addPlaceTitle(md, perGates.getPersonName() + "' House Crime Scene", "mansion1.jpg", isPlaceKnown("SacredClearing") ? 25 : 100);
	if (perYou.getExperience() <= 6) md.write("<p>The house is one of the oldest and most prestigious buildings of the town. " + "Built originally as the country estate of a powerful noble family, it has weathered many years of use. It has passed from family to family over the centuries, some of the gentiles who have lived here include: Lord Geoff Halliway, Lord Percy Halliway, Lady Elizabeth Ross and Lord Beasley before bankruptcy caused the last noble family to sell the house. " + "A wealthy industrialist had the house moved brick by brick to the outskirts of Glendale in the late 19th century, including the family graves. The industrialist in turn went bust in the Great Depression, and several wealthy families have owned it since then.</p>");
	md.write("<p>There is a lot of bustle around the perimeter of the house as a police investigation is underway. Nervously you look for a way to slip away unseen.</p>");
	startQuestions();
	if (isPlaceKnown("SacredClearing")) addLinkToPlace(md, "go to the sacred clearing", 141);
	addLinkToPlace(md, "enter " + perGates.getPersonNameShort() + "'s House", 65);
	WritePlaceFooter(md)
}

function ShowPlace65(stype) {
	var perK = findPerson("OfficerKhan");
	var md;
	if (stype == "arrested") {
		md = WritePlaceHeader();
		perK.showPerson("Setting/pol2.jpg");
		findPerson("Diane");
		if (per.getQuestArrested() < 10) per.setQuestArrested(10);
		perYourBody.DropAllItems("Diane");
		perYou.setArrested(2);
		addPlaceTitle(md, "Under Arrest");
		md.write("<p>The " + getOfficer(false) + " quickly grabs your wrists and slaps handcuffs on before you realise what has happened. Fear grips your heart and you let yourself be led to jail.</p>");
		startQuestions();
		addLinkToPlace(md, "go to jail?", 260);
		WritePlaceFooter(md);
		return
	}
	if (getPersonOther("Mom") < 5 && !isCharmedBy("OfficerKhan")) {
		md = WritePlaceHeader();
		perK.showPerson("Setting/pol2.jpg");
		addPlaceTitle(md, "Evidence");
		md.write("<p>A police " + getOfficer(false) + " eyes you and sees that you have blood stains on your shirt.</p>" + '<p>"Stop in the name of the law!" she yells. Her gun points at your face. "You are under arrest for suspicion of murder."</p>' + "<p>There is nowhere to run and police surround you before you can cast a spell.</p>");
		startQuestions();
		addLinkToPlace(md, "go calmly", 65, "type=arrested");
		addLinkToPlace(md, "run from " + perGates.getPersonNameShort() + "'s estate?", 16);
		WritePlaceFooter(md);
		return
	}
	if (perK.isCharmedBy()) {
		md = WritePlaceHeader();
		AddImage("Setting/pol8.jpg")
	} else if (getPersonOther("Mayor") == 10 || perK.other == 11) {
		md = WritePlaceHeader();
		AddImage("Setting/pol3.jpg")
	} else {
		md = WritePlaceHeader(false, "td-left-med");
		AddImage("Setting/pol1.jpg")
	}
	addPlaceTitle(md, "Crime Scene");
	if (perK.isCharmedBy()) {
		md.write("<p>" + getOfficer() +
			' Khan meets your gaze. "Oh ' + perYou.getMaster() + '," she gasps between deep breaths. "Please tell me what you want of me."</p>');
		if (getPersonOther("Mom") < 5) md.write('<p>"Oh, ' + perYou.getMaster() + ", your clothes?!?  They're still covered in blood.  Leave quickly before one of the other officers notices!\"</p>")
	} else {
		if (!perK.checkFlag(1)) {
			perK.setFlag(1);
			showPopupWindow("Police " + getOfficer(), "<img src='Images/Setting/pol13a.jpg'  class='imgpopup' alt='Officer Khan'>" + "You recognise Ms Khan is the " +
				getOfficer(false) + " standing in front of you. She used to live next door to your house. Your mother talked to her a lot back in the day and sometimes Ms Khan even visited your house for dinner. " + "From these visits you learned that she did not want to be an " + getOfficer(false) + " first, she was more interested in becoming a soldier. However, her dominant nature and harsh attitude made her realize that by becoming a police " + getOfficer(false) + " she could exercise her power over the people quicker and easier. So, yeah, your first impressions of her were not so good...she\u2019s and uptight and arrogant bitch who\u2019s hunger for power could only be matched by her heavenly body and appearance and it looks like she hasn\u2019t changed a bit. " +
				"She worked her way through the ladder and is now the right hand woman to " + getPoliceChief() + " Batton.<br><br>" + "She comes to you and shakes your hand, introducing herself in the process. She doesn\u2019t seem to recognise you. What a surprise!", 'setPersonFlag("OfficerKhan",1);')
		}
		md.write("<p>A police " + getOfficer(false) + " stops you. She has been inspecting the body of " + perGates.getPersonNameShort() + " which lies nearby." + "<p>You nervously gulp with the guilt of committing a murder. " + perGates.getPersonNameShort() +
			" lies still, blood drying on his clothes. Remembering the blood stains on your own clothes, you look down to check if any are on your jeans. They are clean.</p>");
		if (perK.other === 10) md.write('<p>"The Mayor sent you to help, eh?  Perhaps you can give me a hand," she says. The forensics expert looks over, curious.' + '"Shot at point-blank range by the look of it ," says the ' + getOfficer(false) + ". \"You can't see much else from the body, but I'd like to turn him over.\"</p>");
		else if (perK.other == 11) md.write("<p>" +
			getOfficer() + " Khan waits patiently for you to analyse the crime scene.</p>");
		else md.write("<p>There is a forensics investigator nearby, analysing the scene.</p>")
	}
	if (perK.other === 0 && !perK.isCharmedBy()) md.write("<p>The " + getOfficer(false) + ' looks at you with a suspicious eye. "Excuse me," she says. "This is a crime scene and we are looking for witnesses. Can I have your name please?"</p>');
	startQuestions();
	if (perK.isCharmedBy()) addQuestionC(md, "order Cheryl to take you to the police station", "OfficerKhan",
		521);
	if (perK.other === 0) addQuestionC(md, "tell the " + getOfficer(false) + " your name and ask what is going on", "OfficerKhan", 530);
	else if (perK.other == 1) addQuestionC(md, "ask how " + perGates.getPersonNameShort() + " was murdered", "OfficerKhan", 531);
	if (perK.other == 2) addQuestionC(md, "tell the " + getOfficer(false) + "  that the mayor sent you to help", "OfficerKhan", 1610);
	if (perK.other === 10) addQuestionC(md, "tell her you can't work with all these people around.", "OfficerKhan", 5310);
	addLinkToPlace(md, perK.isCharmedBy() ?
		"go to the rear of the house" : "sneak past the police to the rear of the house", 131);
	if (isPlaceKnown("SacredClearing")) addLinkToPlace(md, "walk to the Sacred Clearing", 141);
	addLinkToPlace(md, "exit " + perGates.getPersonNameShort() + "'s estate?", 16);
	WritePlaceFooter(md)
}

function ShowPlace66() {
	var md = WritePlaceHeader();
	addPlaceTitle(md, "Secret Stairway", "stairs.jpg");
	md.write("<p>Behind the fireplace is a secret stairway leading upwards to the first floor of Gates' house. As you take each step you hear a low howl of wind from above.</p>");
	startQuestions();
	addLinkToPlace(md, "go up the stairs to the Attic", 67);
	addLinkToPlace(md, "go to back to the rear of the house", 131);
	WritePlaceFooter(md)
}

function ShowPlace67() {
	var md = WritePlaceHeader();
	addPlaceTitle(md, "Gates' Attic", "attic1.jpg");
	md.write("<p>At the top of the stairs is an attic. A wheelchair is situated in the middle of the floor - otherwise it appears to be an empty room. After a search you notice a small leather bound diary.</p>");
	if (!perYou.checkFlag(4)) md.write("<p>The shadows of the room also reveal a small rustic stone on the floor, evidently misplaced long ago.</p>");
	startQuestions();
	addLinkToPlace(md, "read the diary", 155);
	if (!perYou.checkFlag(4)) addQuestionCO(md, "pick up the stone", "Misc", 1891);
	addLinkToPlace(md, "go down the stairs to " + perGates.getPersonNameShort() + "'s secret stairway", 66);
	WritePlaceFooter(md)
}

function ShowPlace69() {
	showGeneralPlace("Nurses's Office", "school-nursesoffice.jpg", "The small office for the school nurse.", "return to the hallway", 70)
}

function ShowPlace70() {
	var bOpen = isShopOpen(2);
	if (!bOpen && !isPlaceBreakIn("HistoryClassroom")) return gotoPlaceDelayed(9, "", '<img src="UI/closed.png" style="float:left;width:15%;margin-right:5px">The Glenvale Secondary School closes and a teacher ushers you outside the gates.');
	var md = WritePlaceHeader();
	var perL = findPerson("MissLogan");
	if (perDavy.other == 1) perDavy.other = 2;
	addPlaceTitle(md, "School Hallway", bOpen ? "school2b.jpg" : "school2a.jpg");
	if (!bOpen || perL.other != 1) {
		if (isDay()) md.write("<p>The school has a few students moving from class to class. As you walk down the hallway you can hear other voices and other noises in the distance.</p>");
		else md.write("<p>The school is empty at this time of night.</p>");
		if (perL.other == 2) md.write("<p>On a bulletin board is a list of students working on projects and you see your name on the list for Neurology.</p>");
		else if (perL.other > 2) md.write("<p>On a bulletin board is a list of students working on projects and you see your name on the list for the Reproductive System.</p>")
	}
	if (isDemonQuestDone() && (perL.place == 9999 || perL.place == 269)) md.write("<p>You notice a small announcement of a new swimming club being started by Miss Logan, but oddly it is set for Sundays at the Broken Inn Hotel pool. Why on earth on Sunday, you doubt many students would attend...</p>");
	startQuestions();
	addLinkToPlace(md, "go to the history classroom", 10);
	addLinkToPlace(md, "go to the teacher's lounge", 242);
	if (isPlaceKnown("AnatomyClassroom")) addLinkToPlace(md, "go to the Anatomy classroom", 234);
	addLinkToPlace(md, "go to " + perBeasley.getPersonName() + "'s office", 11);
	if (isPlaceKnown("FrenchClassroom") || isBeasleyServant()) addLinkToPlace(md, "go to Ms. Jones' office", 145);
	if (isPlaceKnown("NursesOffice")) addLinkToPlace(md, "go to the Nurses office", 69, wherePerson("DoctorKay") == 69 && !isCharmedBy("DoctorKay") ?
		"type=followntinalater" : "");
	if (bOpen) addLinkToPlace(md, "exit the school", 9);
	else addTextForQuestions(md, "<b>The doors of the school are locked</b>", "center");
	WritePlaceFooter(md)
}

function ShowPlace71() {
	var md = WritePlaceHeader();
	perBeasley.showPerson("beasley1.jpg");
	perYourBody.DropItem(4, 76);
	setBeasleyServant(1);
	setPlaceKnown("FrenchClassroom");
	addComments("You give the book to Mr. Beasley.");
	addPlaceTitle(md, "Mr. Beasley With Book");
	md.write("<p>Mr Beasley tears the book out of your hands in one swift motion and hastily begins to flip through the pages.</p>" + '<p>"Yes... I finally have it, this is indeed the legendary book of Control." Your teacher chuckles to himself. "And here is just what I need now! Dai Chu "Dai Chu ' +
		perYou.getPersonName() + '!"</p>');
	if (perYou.checkFlag(18) && nMana > 19 || perYourBody.FindItem(43) > 0 || perYourBody.FindItem(46) > 0) {
		if (perYourBody.FindItem(43) > 0 || perYourBody.FindItem(46) > 0) {
			md.write("<p>The spell bounces off you, warded by your protections.</p>");
			AddMana(-20);
			md.write("<p>The mana in you surges as you struggle to resist the spell. You suddenly feel the spell vanish and your mana is drained by the struggle.</p>")
		}
		md.write("<p>What else can you do then, he has the book after all.</p>");
		startQuestions();
		addLinkToPlace(md, "exit the room", 70)
	} else {
		perYou.charmThem(4, "MrBeasley");
		startQuestions();
		addLinkToPlace(md, "what was that he said?", 72)
	}
	WritePlaceFooter(md)
}

function ShowPlace72() {
	var md = WritePlaceHeader();
	if (perYou.isBornMale()) AddImage("Player/" + sAvatarFolder + "/charmedbydavy-start.jpg");
	else AddImage("Player/" + sAvatarFolder + "/charmedbybeasley.jpg");
	addPlaceTitle(md, perYou.getPersonName() + " Under A Desire Spell");
	if (perYou.isBornMale()) md.write("<p>Mr Beasley tears the book out of your hands in one swift motion and hastily begins to flip through the pages.</p>" + '<p>"Yes... I finally have it, this is indeed the legendary book of Control." Your teacher chuckles to himself. "And here is just what I need now! Dai Chu, ' +
		perYou.getPersonName() + '!"</p>' + "<p>A strange feeling rushes through your body the moment your teacher speaks these words, like an unusual warmth starting in your chest and quickly spreading through every part of you, and there is something... unsettling in the way his eyes linger on you.</p>" + "<p>Well, not really unsettling as much as arousing.</p>" + "<p>You don't know why, but you quickly find yourself leaning against one of the tables, rolling back your shoulders to flex your chest muscles and returning the... weirdly charming smile he graces you with.</p>" +
		"<p>You are not sure why you never noticed, but Mr Beasley is actually a fairly attractive man, and you are not even that much into men. He is tall, clearly works out and that bulge in his pants looks so very promising...</p>" + "<p>If he wouldn't be so arrogant and constantly creeping after girls much younger than him, he could be quite popular with women.</p>" + "<p>Well, and really, doesn't a stud like him deserve to be arrogant? And sharing his vast experience with younger women suddenly does seem like a noble thing to do, in fact, you really hope he is into younger men as well.</p>" +
		"<p>He is talking to you, but your mind is so occupied thinking of what it would be like to tear off that sweater that you barely notice it until he harshly addresses you.</p>" + '<p>"' + perYou.getPersonName() + '!"</p>' + "<p>You snap out of your daydream, and as you try to focus a part of you realizes that something is very wrong... why would you think these thoughts? Why suddenly desire another man? More-so, this man of all people?</p>" + "<p>\u201cI will need you to be more attentive, if you are to be my apprentice, " +
		perYou.getPersonName() + "\u201d Mr Beasley sneers in annoyance, and every clear thought you just had is supplanted by the crushing realisation that you have disappointed him.</p>" + "<p>\u201cI am sorry sir.\u201d You quickly say. Maybe you can salvage this, you don't know why but there is absolutely nothing you want more than to be this mans apprentice, to earn his admiration. \u201cI will do everything to make up for it.\u201d</p>" + "<p>\u201cThat you will do.\u201d Mr Beasley seems immensely pleased with himself, and you barely notice that you have begun to take off your clothes as he once again stops you.</p>" +
		"<p>\u201cNo! You will not serve me this way, " + perYou.getPersonName() + "\u201d Your heart breaks a little as you hear that, but your mind quickly adjusts to the new input and your disappointment subsides.</p>" + "<p>\u201cYou are friends with the Ross sisters are you not?\u201d</p>" + "<p>\u201cYes... Yes, Sir!\u201d You quickly nod.</p>" + "<p>\u201cGood.\u201d He smiles smugly, and you never noticed how handsome he looks when he does that. \u201cCall them, arrange a meeting in a secluded part of the school and then do as I say. They will be the first to my harem.\u201d</p>" +
		"<p>There is a brief moment of struggle inside you, and you have to admit that a part of you is uncomfortable with this order. He is talking about enslaving your friends, after all, but of course, a man like him deserves to have the best of women for himself... you shouldn't be selfish.</p>" + "<p>\u201cOf course, sir! Oh! I'm sure you remember my sister Tracy, shall I call her as well?\u201d You take out your phone and watch your master expectantly in hopes that your initiative pleases him, and your heart skips a beat when he smiles and nods his head.</p>" +
		"<p>\u201cDo that, in fact, let us talk about the rest of your Family, did you know that your cousin recently transferred to Glenvale Secondary?\u201d</p>");
	else md.write("<p>A strange feeling rushes through your body the moment your teacher speaks these words, like an unusual warmth starting in your chest and quickly spreading through every part of you, and there is something... unsettling in the way his eyes linger on you.</p>" + "<p>Well, not really unsettling as much as arousing.</p>" + "<p>You don't know why, but you quickly find yourself leaning against one of the tables, rolling back your shoulders to push your chest out and returning the... weirdly charming smile he graces you with.</p>" +
		"<p>You are not sure why you never noticed, but Mr. Beasley is actually a fairly attractive man. He is tall, clearly works out and that bulge in his pants looks so very promising...</p>" + "<p>If he wouldn't be so arrogant and constantly creeping after girls much younger than him, he could be quite popular with women.</p>" + "<p>And really, you think as a pleasant shiver runs through your body, doesn't a stud like him deserve to be arrogant? And should young women like you not be thankful that he is so willing to take the time and... teach you?</p>" +
		"<p>He is talking to you, but your mind is so occupied thinking of what it would be like to tear off that sweater that you barely notice it until he harshly addresses you.</p>" + '<p>"' + perYou.getPersonName() + '!"</p>' + "<p>You snap out of your daydream, and as you try to focus a part of you realizes that something is very wrong... why would you think these thoughts? Why suddenly desire this man?</p>" + '<p>"As I was saying,\u201d He says with an annoyed sigh. \u201cI am more than willing to take you in as my apprentice, but it appears that I will need to apply some discipline first. Undress!"</p>' +
		"<p>There is something incredibly compelling in his voice and you have already discarded most of your clothing before you realize what is happening.</p>" + '<p>"Wh...why am I doing this? What... are you doing with me...?" You ask weakly as he rises to his feet and takes off his glasses.</p>' + "<p>\u201cThis is for your own good, " + perYou.getPersonName() + ".\u201d You shudder as he speaks your name, and despite something deep within you screaming that what is happening is wrong, you do not resist as he bends you over his knee, exposes your rear and brings his ruler down on it.</p>" +
		"<p>\u201cAhh!\u201d The sudden burst of pain catches you of guard, and it doesn't look as if he intents to give you a lot of time to recover.</p>" + "<p>\u201cYou are a bad girl," + perYou.getPersonName() + "\u201d the ruler comes down again on another spot, but just as hard.\u201d Constantly under-performing and asking for extensions, but no more, understood?\u201d</p>" + "<p>You try to answer, but only spout gibberish.  Tears well in your eyes as strike after strike lands on your poor ass, each hit bringing a sharp burst of pain, clouding your mind, making it harder to focus, to think...</p>" +
		"<p>When he finally stops, your backside tingles all over and your heart is racing. To your surprise, the sensation is rather... pleasant, and your thoughts are less focused on what he might be doing with your mind than what he could be doing with your aching, wet pussy.</p>" + "<p>\u201cYes, Mr. Beasley!\u201d You whimper, and immediately receive another rough strike.</p>" + "<p>\u201cYou will address me as master, my apprentice!\u201d He scolds you, any you feel ashamed for not doing so to begin with.</p>" +
		"<p>\u201cYes Master!\u201d</p>" + "<p>\u201cGood.\u201d He stops for a moment and gently drives his fingertips over your reddened skin. \u201cYou will be the first to my Harem, " + perYou.getPersonName() + " you will be attentive and dedicated, and you will do whatever I tell you to do without hesitance, understood?\u201d</p>" + "<p>Your mind absorbs every word without question, changing the very way you view the world to accommodate to his orders, everything is suddenly so clear, your goals, your purpose... to think you ever had doubts about this man!</p>" +
		"<p>\u201cYes, Master.\u201d You acknowledge the order, and his fingers slide so close to your pussy... if he'd just move them a tiny bit to the side they'd...</p>" + "<p>\u201cGood girl.\u201d You groan in frustration as he pushes you off his lap onto the floor, but quickly move to kneel before him and try to ignore the burning need inside you, your eyes focus on his crotch and your heart quickens as he opens his pants.</p>" + "<p>\u201cAnd now, my apprentice, you will learn how to service me.\u201d");
	addRestartLink(md);
	WritePlaceFooter(md)
}

function ShowPlace73() {
	var md = WritePlaceHeader();
	if (perYou.isBornMale()) AddImage("Player/" + sAvatarFolder + "/charmedbydavy-start.jpg");
	else AddImage("Player/" + sAvatarFolder + "/charmedbybeasley.jpg");
	addPlaceTitle(md, perYou.getPersonName() + " Under A Desire Spell");
	md.write("<p>The two of them are redefining the term \u201cTeachers Pet\u201d right before your eyes as they lounge over your enemy, and worse: he was expecting you.</p>" + "<p>\u201cDai Chu, " + perYou.getPersonName() + "!\u201d He speaks the incantation before you are able to react, and you are filled with dread as the warm tingle of his mana begins to spread through your body.</p>" +
		"<p>\u201cI knew you would return!\u201d You hear him gloat as you stumble out of the classroom, his voice following you outside. \u201c...and now you are going to regret ever finding that book!\u201d</p>" + "<p>It doesn't look like Mr Beasley has any interest in chasing you, though of course, why would he? The deed is done, you can feel his mana flow through you with every step you take, altering your perception and increasing your desire.</p>" + "<p>You try to fight it, but your mind is filled with images of Catherine and Amy, spread out on his table as he rams his cock into them... his amazing, huge... NO!</p>" +
		"<p>You try to push those images aside to no avail, running a few more steps before you finally collapse on the hallway, breathing heavily for air. Your entire body is burning with need and you don't even care that someone might see you as you open your pants, take out your cock/Push down your underwear and begin to furiously masturbate.</p>" + "<p>The images in your mind change and you no longer see Catherine and Amy with him, only yourself,  kneeing before him or bend over a table and screaming in pleasure as he takes you over and over.</p>" +
		"<p>You no longer care that he is another man/your teacher, and as you bring yourself to climax, the last vestiges of resistance inside you evaporate. Your mind clouds over, and you finally understand that you have never wanted anything as badly as to be with him.</p>" + "<p>As you recover from the intense torrent of sensations, everything begins to fall into place, you might not be fully under his control, as he did not direct the spell personally, but you still want to be his. You have found a new purpose life in helping him assemble the best Harem he can get, and you will devote yourself to it fully.</p>" +
		"<p>You gather your clothes and return to the classroom where he is still tending to your friends, barely paying you any heed while his huge, powerful, cock pounds Catherine's pussy like a steam hammer and Amy sits on her sisters face, passionately kissing him.</p>" + "<p>The way his muscles flex with every motion, how the sweat glisters on his skin... it's almost too much to bear, but you know it is not your turn yet, so you patiently take of the remains of your clothes and sit down, watching him lovingly and waiting to be finally noticed...</p>");
	startQuestionsOnly();
	addOptionLink(md, "Restart Game", "DoRestart()");
	WritePlaceFooter(md)
}

function ShowPlace74() {
	var md = WritePlaceHeader();
	perBeasley.setFlag(3);
	perBeasley.place = 11;
	var bCharmed = perBeasley.isCharmedBy();
	perBeasley.showPerson("beasley2.jpg");
	addPlaceTitle(md, "Mr. Beasley's Office");
	if (bCharmed) {
		md.write("<p>Your slave, Mr. Beasley has company. Two of your friends, the sisters Catherine and Amy, they look like they have fallen under a spell.</p>" + "<p>You quickly interrupt and Mr Beasley looks at you,</p>" + '<p>"New slaves for you ' + perYou.getMaster() + ", almost ready for my...your pleasure.</p>");
		startQuestions();
		addLinkToPlaceC(md, '"What is happening here Mr. Beasley"', 76, "type=freed")
	} else {
		findPerson("AmyRoss").charmThem(4, "MrBeasley");
		findPerson("Catherine").charmThem(4, "MrBeasley");
		md.write('<p>Mr. Beasley has company. Two of your friends, the sisters Catherine and Amy, have fallen under a spell. The girls are redefining the term "teacher\'s pet" as they lounge over your enemy.</p>' + '<p>The teacher turns to you. "So ' + perYou.getPersonName() + ", you have decided to return.");
		if (isBeasleyServant()) md.write("I did promise you would regret it if you did so now you are going to become my slave. Dai Chu " +
			perYou.getPersonName() + '!" he yells.</p>');
		else md.write(" Now you're going to regret ever finding this book. <i>Dai Chu " + perYou.getPersonName() + '</i>!" he yells.</p>');
		if (perYou.checkFlag(18) && nMana > 19 || perYourBody.FindItem(43) > 0 || perYourBody.FindItem(46) > 0) {
			if (perYourBody.FindItem(43) === 0 && perYourBody.FindItem(46) === 0) AddMana(-20);
			md.write("<p>For a moment you expect something to happen but everything is the same.  It appears that the spell has failed, but Mr. Beasley hasn't noticed.</p>");
			startQuestions();
			addLinkToPlaceC(md, "talk to Mr. Beasley", 75);
			addLinkToPlace(md, "exit the room", Place, "", "You cannot abandon your friends, and Mr. Beaslet has the Book!")
		} else {
			md.write("<p>It looks like Mr Beasley has not wasted any time to put what he learned from the book to use. Catherine and Amy both greet you at his side as you enter the room, their clothes halfway torn off and their eyes filled with blissful devotion.</p>" + "<p>The two of them are redefining the term \u201cTeachers Pet\u201d right before your eyes as they lounge over your enemy, and worse: he was expecting you.</p>" +
				"<p>\u201cDai Chu, " + perYou.getPersonName() + "!\u201d He speaks the incantation before you are able to react, and you are filled with dread as the warm tingle of his mana begins to spread through your body.</p>");
			startQuestions("You must");
			addLinkToPlace(md, "remove your clothes.", 73)
		}
	}
	WritePlaceFooter(md)
}

function ShowPlace75() {
	var md = WritePlaceHeader(false, isExplicit() ? "td-left-large" : "");
	perBeasley.showPersonRorX("beasley3.jpg");
	addPlaceTitle(md, "Mr. Beasley's Office");
	md.write("<p>Although you try to talk to Mr. Beasley, Catherine and Amy interrupt. The sisters look so aroused that their actions cannot be natural. Fearing for yourself, you back away.</p>");
	startQuestions();
	addLinkToPlace(md, "wait for the trio", 76);
	addLinkToPlace(md, "exit the room", Place, "", "You cannot abandon your friends, and Mr. Beaslet has the Book!");
	WritePlaceFooter(md)
}

function ShowPlace76(stype) {
	var bCharmed = perBeasley.isCharmedBy();
	var md = WritePlaceHeader(false, stype == "freed" && bCharmed ? "td-none" : "td-left-med");
	if (stype === "") {
		perBeasley.showPersonRorX("beasley4a.jpg");
		if (whereItem(4) == 999) moveItem(4, 76);
		addPlaceTitle(md, "Mr. Beasley's Office");
		md.write("<p>Mr. Beasley loses interest in you as his servants do whatever they can to satisfy him. Moans escape the sisters lips as they gyrate their bodies and play a game that could cause their master to lose his most valued possession.</p>")
	} else if (stype == "freed") {
		if (!bCharmed) perBeasley.showPerson("beasley4b.jpg");
		addPlaceTitle(md, "Catherine and Amy");
		if (bCharmed) perBeasley.showPerson("beasley4b.jpg", "30vw", "left");
		if (whereItem(4) == 999) moveItem(4, 76);
		unCharmPerson("AmyRoss");
		setPersonFlag("AmyRoss", 1);
		movePerson("AmyRoss", 435);
		unCharmPerson("Catherine");
		setPersonFlag("Catherine", 1);
		movePerson("Catherine", 436);
		setPlaceKnown("CheriseRd");
		setPlaceKnown("AmaranthPl");
		if (bCharmed) {
			perYou.setFlag(12);
			md.write("<p>You order Mr. Beasley to tell you what he is doing, he replies a little reluctantly,</p>" + '<p>"I have been preparing these two for a while now, using light hypnosis combined with a magical technique I had learned from my family archives. Amy thought it was to help focus on her studies, and her sister Catherine wanted help with her fear of spiders and I offered to help. I was actually trying to bring out their inner slut, to get them to focus on my coc..orders, and it has been remarkably easy so far.</p>' +
				'<p>These two are almost ready for my ... your ... our ... pleasure ... orders."</p>' + "<p>No matter how tempting this might be, there is no way you want Mr. Beasley to have control over your friends, if anyone is going to control them it will be you! You order Mr. Beasley to end the trance and sit at his desk. He looks at you very reluctantly and briefly speaks to the girls. As he does you notice they had been removing their clothing.</p>" + "<p>A thought crosses your mind as he walks away, that your friend, and Amy's sister Catherine has no inner slut, from how she talks about her relationships she is <b>all</b> slut! You are surprised about Amy though, but she is always reluctant to talk about relationships, changing the conversation and getting Catherine to talk about some racy details of her last lover.</p>" +
				'<p>Your friends look at you as Mr. Beasley walks away, and you step over and whisper to them to get out of here and avoid Mr. Beasley. You tell them you will speak to them later and "explain" more. They nod and quickly leave the room, clothes bundled in their arms.</p>' + '<p>You turn to Mr. Beasley and ask where the Book is and he reluctantly removes it from his desk and puts it down, "Here it is ' + perYou.getMaster() + '"</p>' + "<p>You then ask him to tell you more about the hypnotic technique he mentioned,</p>" +
				'<p>"' + perYou.getMaster() + ' do you understand the basics of hypnosis?", to which you tell him you do not, "Then please study the basics and come back to me for a lesson. The lesson will be the same as other <b>magical techniques</b> and will require some magical experience to learn."</p>')
		} else md.write("<p>Mr. Beasley has slumped in the afterglow of his session with Catherine and Amy, and is no longer paying attention.</p>" + '<p>The sisters look at you, confused and a little angry at what just happened, and you quietly step over and whisper to them to get out of here and avoid Mr. Beasley. You tell them you will speak to them later and "explain" more. They nod and quickly leave the room, clothes bundled in their arms.</p>' +
			"<p>You realise that trying to charm them here with Mr. Beasley present would be a very bad idea.</p>")
	}
	startQuestions();
	if (whereItem(4) == 76) addLinkToPlace(md, "exit the room", Place, "", "You cannot just leave the Book here!");
	else addLinkToPlace(md, "exit the room", 70);
	WritePlaceFooter(md)
}

function ShowPlace77() {
	var md = WritePlaceHeader(true);
	var nm = perBeasley.getPersonName();
	md.write('<table class="table-main" style="vertical-align:top"><tr><td>');
	addPlaceTitle(md, nm + "'s Office", "", 0, true);
	md.write('<p style="text-align:center"><img src="Images/school-beasleyoffice.jpg" style="display:block;margin-left:auto;margin-right:auto;width:30%" alt="Empty"></p>' + "<p>The office is empty ");
	if (isDay()) md.write(", Mr. Beasley must have gone somewhere with his students.</p>");
	else md.write("at this time of night.</p>");
	if (perBeasley.checkFlag(4)) md.write("<p>The desk draw is open.</p> ");
	else md.write("<p>The desk drawers are securely locked.</p> ");
	if (perBeasley.place != 11 && perYou.getExperience() > 7 && whereItem(7) === 0 && !isPlaceKnown("RobbinsHouse")) PlaceI(7, 77);
	if (whereItem(7) == 77) md.write("<p>Looking around the room you see an address book on his desk. ");
	if (perYou.getExperience() > 10 && !perBeasley.checkFlag(5)) md.write("Mr. Beasley's desk telephone light is flashing. It looks as though there is a message.</p>");
	startQuestions();
	if (perBeasley.place != 11 && perYou.getExperience() > 10 && !perBeasley.checkFlag(5)) addLinkToPlace(md, "listen to the telephone message", 159);
	addLinkToPlace(md, "exit the room", 70);
	WritePlaceFooter(md)
}

function ShowPlace79() {
	var md = WritePlaceHeader();
	PlaceI(8, 242);
	var perGeraldine = findPerson("MrsRobbins");
	perGeraldine.showPerson("robbins2.jpg");
	addPlaceTitle(md, "Mrs. Robbins Under A Charm Spell");
	md.write('<p>"What was that, my dear?" Mrs. Robbins asks absently as her eyes begin to take on the characteristic color of your new slaves.</p>' + "<p>Mrs. Robbins has fallen under the power of your spell. At first she denies the desire building up throughout her body. She stutters for a moment then ceases to talk, too bothered by the new sensations prickling across her skin.</p>");
	startQuestions();
	addLinkToPlace(md, "wait for the spell to take effect", 81);
	addLinkToPlace(md, "exit the house", 43);
	WritePlaceFooter(md)
}

function PuzzleComputer(doc) {
	if (perDavy.checkFlag(33) && doc.FormChar.research.value.toLowerCase().trim() == "e" || perDavy.checkFlag(34) && doc.FormChar.research.value.split(" ").join("").split("'").join("").toLowerCase().trim() == "butiwontdothat" || perDavy.checkFlag(35) && doc.FormChar.research.value.toLowerCase().trim() == "sandman") gotoPlace(80, "type=right");
	else gotoPlace(80, "type=wrong")
}

function FindIt105(doc) {
	if (isRunes()) Research("Spell", "ShioStinMur", "time1.jpg", 93);
	else ResearchOLD("P", doc.FormChar.research.value)
}

function ShowPlace80(stype) {
	var md = WritePlaceHeader(sType === "");
	if (stype === "") {
		if (!perDavy.checkAnyFlags()) perDavy.setFlag(Math.floor(Math.random() * 3) + 33);
		addPlaceTitle(md, "Davy's Computer", "", 0, true);
		if (!isSpellKnown("Teleport")) {
			findPerson("Monique");
			per.setFlag(4)
		}
		md.write("<p>You turn the computer on and access requires you to logon to the account. You try to guess a password but it is wrong, and a hint is shown for the correct one. If you can crack the meaning of the hint you will have access to Davy's files.</p>" + '<table class="table-main">' +
			'<tr><td class="td-left">' + '<img src="Images/time1.jpg" style="float:left;border-width:1px;width:95%" alt="Time">' + "</td>" + '<td class="td-center">' + "<p>Solve the problem:</p>" + '<div style="text-align:left">' + '<table class="table-main">' + '<tr><td style="text-align:center;background-image:url(' + getThemeFolder() + 'background.jpg)">');
		if (perDavy.checkFlag(33)) md.write('<p style="text-align:center">What is at the beginning of eternity, the\tend of time, the beginning of every end, and the end of every place?</p>');
		else if (perDavy.checkFlag(34)) md.write('<p style="text-align:center">Complete this line "I\'d do anything for love ..."</p>');
		else if (perDavy.checkFlag(35)) md.write('<p style="text-align:center">Complete this title "Enter ..."</p>');
		md.write("</td>" + "</tr>" + "<tr><td>" + '<form name="FormChar" onsubmit="PuzzleComputer(document);return false">' + '<input type="text" size="20" name="research">' + '<input type="submit" value="enter">' + "</form>" + "</td>" + "</tr>" + "</table>" + "</div><br>");
		startQuestions();
		addLinkToPlace(md,
			"forget the password", 93)
	} else if (stype === "right") {
		addPlaceTitle(md, "Right Answer", "", 0, true);
		if (!perDavy.checkFlag(12)) nPhoneWallpapers += 10;
		findPerson("Monique");
		per.setFlag(4, false);
		md.write("<p>You enter the correct password into the laptop and after a browsing for a while you find a couple of interesting images that you upload into your phone as wallpapers.</p>" + '<p>You then find a document that is called <b>"Spell to be deciphered"</b>. You examine the document and start working to decipher the spell.</p>');
		if (!isRunes()) md.write('<div style="text-align:center">' + '<p style="margin-bottom:0">Unscramble the letters: hot rum is sin</p>' + '<table class="table-main">' + "<tr>" + "<td>" + '<form method="POST" name="FormChar">' + '<input type="text" size="20" name="research">' + '<input type="button" name="button" value="enter" onClick="FindIt105(document)">' + "</form>" + "</td>" + "</tr>" + "</table>" + "</div><br>");
		startQuestions();
		if (isRunes()) addOptionLink(md, "try to learn the spell", "FindIt105(document)");
		addLinkToPlace(md,
			"forget the spell for now", 93)
	} else {
		addPlaceTitle(md, "Wrong Answer", "", 0, true);
		md.write("<p>You didn't get it right. Better luck next time.</p>");
		startQuestions()
	}
	addLinkToPlace(md, "leave Davy's room", 176);
	if (stype !== "") {
		AddRightColumnLarge();
		AddImage("time1.jpg")
	}
	WritePlaceFooter(md)
}

function ShowPlace81() {
	var md = WritePlaceHeader();
	var perGeraldine = findPerson("MrsRobbins");
	perGeraldine.showPerson("robbins3.jpg");
	addPlaceTitle(md, "Mrs. Robbins Under A Charm Spell");
	md.write("<p>No longer able to restrain herself, Mrs. Robbins slides her fingers between the folds of her blouse.</p>" + '<p>"I feel so odd," she manages to explain before a ripple of desire makes her body shiver. ' + '"You really must excuse me ' + perYou.getPersonName() + ", but I'm afraid I must go to the bathroom for a little while,\" she says.</p>");
	startQuestions();
	addLinkToPlaceC(md, "tell her to stay", 82);
	WritePlaceFooter(md)
}

function ShowPlace82() {
	var md = WritePlaceHeader();
	var perGeraldine = findPerson("MrsRobbins");
	perGeraldine.showPerson("robbins4.jpg");
	addPlaceTitle(md, "Mrs. Robbins Under A Charm Spell");
	md.write('<p>"Oh ' + perYou.getPersonName() + '," Mrs. Robbins begins removing her blouse. "I\'m so glad you came to visit me today. I really get quite lonely sometimes and having ');
	if (perYou.isMaleSex()) md.write("a man");
	else md.write("another woman");
	md.write(' with me is so exciting. Tell me, do you ever think of how much more experienced older women are?"</p>');
	if (isCharmedBy("MrsGranger")) md.write('<p>"Yes," you say with a knowing grin. "I hear they <i>really</i> know how to please in bed if properly motivated."</p>');
	else md.write('<p>You gulp a response, "I... ah... never really thought about it before, Mrs. Robbins. I suppose older women could be fun."</p>');
	startQuestions();
	addLinkToPlace(md, "wait for her to seduce you", 83);
	WritePlaceFooter(md)
}

function ShowPlace83() {
	var md = WritePlaceHeader();
	var perGeraldine = findPerson("MrsRobbins");
	perGeraldine.showPerson("robbins5.jpg");
	addPlaceTitle(md, "Geraldine Under A Charm Spell");
	md.write('<p>"You silly ' + perYou.getSex() + ' If we are going to get to know each other a lot better then I insist that you call me by my first name: Geraldine."</p>' + '<p>Geraldine removes her top and steps out of her jeans.  She leans back enticingly. "What do you think, ' + perYou.getPersonName() + '?" she asks. ' + '"I can see by your expression that we are going to have a lot of fun here."</p>');
	startQuestions();
	addLinkToPlace(md, "order her to fondle her breasts", 84);
	WritePlaceFooter(md)
}

function ShowPlace84() {
	var md = WritePlaceHeader(false, "td-left-med");
	var perGeraldine = findPerson("MrsRobbins");
	perGeraldine.showPerson("robbins6.jpg");
	addPlaceTitle(md, "Geraldine Under A Charm Spell");
	md.write('<p>"My breasts! I thought that you would never ask, ' + perYou.getPersonName() + '," she says, leaning in close. "Here you go, my darling. For your lips only."</p>' + "<p>Suddenly Geraldine loses her breath. A wave of lust ripples throughout her body, removing her last independent thoughts.  She hops onto the table.</p>" + '<p>"Ahh..." she moans. "I can\'t stand it anymore. Please fuck me you adorable ' +
		perYou.getSex() + '! Fuck me until I scream."</p>');
	startQuestions();
	addLinkToPlace(md, "take the woman", 85);
	WritePlaceFooter(md)
}

function ShowPlace85() {
	var md = WritePlaceHeader();
	var perMR = findPerson("MrsRobbins");
	if (perYou.isMaleSex())
		if (isExplicit()) perMR.showPersonRandomX("robbins7b", 2);
		else perMR.showPersonRorX("robbins7b.jpg");
	else perMR.showPersonRorX("robbins7g.jpg");
	addPlaceTitle(md, "Geraldine Under A Charm Spell");
	md.write("<p>Geraldine Robbins spreads her legs for you. In moments you embrace to begin a frenzy of love making. Even as you fall back exhausted, the woman still pleads for you. " + '"Please, ' + perYou.getPersonName() +
		'," she says.  "I\'ll do anything for more. All you have to do is ask and I\'ll please you in any way you want.  Just give me more!"</p>' + '<p>"No more," you reply.  "I\'ve had enough.  For now."  Then your eyes pick up an almost predatory sheen as you move in for the kill.</p>' + '<p>"But you are right about one thing, Geraldine...  You <i>will</i> do anything for me, wont\'t you. Anything I say, anything at all."  She only nods in agreement.  "What does that make you, Geraldine?" you ask.' + '<p>She thinks for but a second, as if she already knew the answer before you even asked.  "Your slave," she purrs, crawling towards you.' +
		'<p>"And what does that make me?" you ask, closing the net permanently around your newly acquired slave.' + '<p>"My ' + perYou.getMaster() + '," she says, relishing her newfound role in your relationship.<p>' + '<p>"What do you live for, Slave?" you ask her forcefully.</p>' + '<p>"I live to serve. I exist for your pleasure. I obey without question.  I belong to you! ' + perYou.getMaster() + '..." she says, rolling the last word over her tongue as if it was a treat just for her to say it in your presence.' + '<p>"Excellent," you say, reaching down and running your hand through her hair possessively.');
	startQuestions();
	if (isCharmedBy("Tina", "You")) addPopupLinkToPlace(md, "talk more with her", 176, "", "Tina...", "<img src='Images/People/Tina/Normal/tina10.jpg' class='imgpopup' alt='Tina'>" + "You start to ask Geraldine something and you hear a door open and you see Tina walk into the room. She steps over to a drinks cabinet and pours all three of you a glass of red wine. She toasts you,<br><br>" + '"My ' + perYou.getMaster() + '! Take us as you desire". She then addresses her mother, "Mom, I am returning to my bedroom, except when ' +
		perYou.getMaster() + ' requires us"', 'setPlaceKnown("TinasRoom");movePerson("Tina",163)', "", true);
	else addLinkToPlaceC(md, "talk more with her", 176);
	addLinkToPlace(md, "exit the house", 43);
	WritePlaceFooter(md)
}

function ShowPlace86(stype) {
	var md = WritePlaceHeader();
	var perThrall1 = findPerson("Seraphina");
	addPlaceImage(md, "stones.jpg");
	if (checkPlaceFlag("WildRanges", 4)) addPlaceImage(md, "hawthorn.jpg");
	addPlaceTitle(md, "Searching the Stones");
	md.write("<p>You search among the stones - between the massive boulders of the wild ranges and under the clumps of sticks and pebbles.</p>");
	if (checkPlaceFlag("WildRanges", 4)) md.write("<p>A few hawthorn trees, well more like bushes, grow wild near the stones.</p>");
	if (stype ==
		"thrall1") {
		perThrall1.setFlag(1);
		md.write('<p>"Hello, there", a cute blonde girl speaks to you, "Is that yours, you are lucky to find it. I lost...something here a little while ago and I just cannot find it!"</p>' + "<p>She is a very attractive young woman, with a slight build. She notices your appreciative looks, and she smiles,</p>" + '<p>"Nice to meet you, my parents call me Seraphina, my friends normally call be Serena or Peaches, I cannot live up to my name, I am no angel!"</p>' + '<p>You exchange some pleasant words but she quickly explains that she has to get back to work, that she was just here hiking a bit for exercise, "for my figure". She waves goodbye as she leaves towards the center of Glenvale.</p>')
	} else if (perDavy.other ===
		0) {
		perDavy.other = 1;
		md.write("<p>As you are about to you give up your quest you see a card. " + "You turn the card over to see that it has Mr. Beasley's name on the front and some illegible writing in Davy Robbins' handwriting on the back.</p>");
		if (!isSpellKnown("Charm")) {
			startQuestions("You are surprised by a voice behind you");
			addLinkToPlaceC(md, '"Hello, is that yours?"', 86, "type=thrall1")
		} else startQuestions()
	} else if (checkPersonFlag("Bambi", 5) && perYou.getQuestRustyKey() < 999) md.write("<p>You can see a dull rusty metallic object deep in a gap between two stones.</p>");
	else if (checkPersonFlag("Vampyre", 10) && !checkPlaceFlag("WildRanges", 4) && checkPlaceFlag("HistoryClassroom", 11)) {
		addPlaceImage(md, "hawthorn.jpg", "20%");
		md.write("<p>You see a hawthorn tree near the stones as Esmeralda described. Well it is nearer a bush that a tree...</p>");
		setPlaceFlag("WildRanges", 4)
	} else md.write("<p>You give up for now, there is nothing to find.</p>");
	startQuestions();
	if (checkPlaceFlag("WildRanges", 4)) addLinkToPlace(md, "craft some stakes from hawthorn wood", Place, "", "You find some pieces of fallen wood and trim them with a small pocket knife you have. You engrave the runes and place the stakes in your bag",
		"", "bChatLeft=false;perYou.AddItem(65)");
	addLinkToPlace(md, "walk to the wild ranges", 26);
	if (stype == "thrall1") {
		AddPeopleColumnLarge(md);
		perThrall1.showPerson("thrall1-0.jpg")
	}
	WritePlaceFooter(md)
}

function ShowPlace87() {
	var md = WritePlaceHeader();
	var perD = findPerson("DebraKelly");
	var herName = perD.getPersonName();
	var myName = perD.getYourNameFor();
	if (isDay() && perD.checkFlag(4) && !perD.checkFlag(5)) {
		perD.setFlag(5);
		PlaceI(5, 87);
		perD.place = 87
	}
	if (!perD.isHere()) {
		addPlaceImage(md, "park4.jpg");
		addPlaceTitle(md, "Shady Pathway");
		md.write("<p>A pleasant pathway through the park, shaded by large trees and skirting a small lake.</p>");
		if (perD.place === 87) md.write("<p>It seems Debra is not here at this time of night. She has probably gone home, or possibly visiting a friend.</p>")
	} else if (!perD.isCharmedBy()) {
		perD.showPerson("debra1.jpg");
		addPlaceTitle(md, "Debra Kelly in the Park");
		if (!perD.checkFlag(1)) {
			md.write("<p>You see a cute girl walking in the park.  She looks a little uncertain as you approach but she smiles with some confidence.</p>");
			md.write('<p>"Hi," you say. "I\'m ' + myName + ".  I haven't seen you around town before and thought that you might be looking for a friend.\"</p>");
			md.write('<p>"Um, hello, ' + myName + '," she says.  "I\'m Debra. My sister and I moved into Kollam Street last week. Glenvale is such a nice place, especially the old buildings and this park."</p>')
		} else {
			md.write('<p>You see Debra Kelly still out walking.  "Hey ' +
				myName + '!" She says, noticing your approach.  "Isn\'t it such a nice day out today?  I just couldn\'t stand staying all cooped up at home."</p>');
			md.write('<p>"So," she asks, "What are you up to on this fine ' + getTimeOfDay() + '?"</p>')
		}
	} else {
		perD.showPerson("debra7.jpg");
		addPlaceTitle(md, "Your <i>Pet</i> " + herName);
		md.write("<p>" + herName + " sees you and immediately drops to the ground, the pleasure of seeing her " + myName + " too much to resist.</p>");
		md.write('<p>"Have I been a good girl, ' + myName + '?" she asks.  "Is there anything I can do for you, anything you need?"</p>');
		if (whereItem(5) == Place) {
			md.write('"Oh ' + myName + '! I have done as you said!" she says, visibly very excited.  The smell of her sex suddenly reaches you.  "My dog dug up an old-looking stone.  Here, take it...</p>');
			md.write("<p>You look at the stone. It looks like one you saw somewhere else. Do you want it?<br>")
		}
	}
	startQuestions();
	if (isPlaceKnown("WildRanges")) addLinkToPlace(md, "enter the wild ranges", 26);
	addLinkToPlace(md, "walk to the main park pathway?", 63);
	WritePlaceFooter(md)
}

function ShowPlace88() {
	var md = WritePlaceHeader();
	var perDebra = findPerson("DebraKelly");
	perDebra.showPerson("debra2.jpg");
	addPlaceTitle(md, "Debra Kelly under a Charm Spell");
	md.write('<p>"I\'m sorry, what did... you... say...?" Debra asks, slowing as the spell begins to take effect. ' + "You smile as the customary pink hue begins to shine through her eyes.  She will soon be yours, " + "another pet in your harem.  Which gives you an idea.</p>" + '<p>"I said, don\'t you just love animals, Debra?" you continue as if nothing has happened.</p>' +
		'<p>"What?  Animals?" she asks, still confused by the new sensations coursing through her body and mind - opening ' + "both of them to suggestion, making her virtual putty in your hands.</p>" + '<p>"Yes.  Animals.  Pets.  The kind that follow you around, always obeying your commands, and worshipping ' + 'their owners like their own personal gods.  Like man\'s best friend," you say. "Don\'t you just love pets?"</p>' + '<p>"Yes...  Love pets..." she moans, the strength of her newly discovered feelings beginning to overwhelm her.</p>' +
		'<p>"I bet you\'d love to <i>be</i> a pet,too," you say to her, then notice how distracted she is getting.</p>' + '<p>"Perhaps you should sit down, Debra.  You seem a little light headed.  We wouldn\'t want you to fall, now would we?"</p>' + "<p>She stands, too confused and aroused to come to a conclusive decision on her own, but not ready to submit.</p>");
	startQuestions();
	addLinkToPlace(md, "order her to <i>SIT</i>", 89);
	WritePlaceFooter(md)
}

function ShowPlace89() {
	var md = WritePlaceHeader();
	var perDebra = findPerson("DebraKelly");
	perDebra.showPerson("debra3.jpg");
	addPlaceTitle(md, "Debra Kelly under a Charm Spell");
	md.write("<p>Debra sways on her feet, but doesn't fall.  She stares at you, eyes glazed.</p>" + '<p>"Mmm... Not a pet," she mutters.</p>' + '<p>"No?" You smile.  "You\'re a good girl though, aren\'t you? A good girl who always does as she is told."</p>' + '<p>Her brow furrowed, Debra is deep in thought.  "Yes?"</p>' + "<p>You pause to enjoy the moment, then start to chip away at her resolve. \"Yes, you're a good girl. In fact...  I bet you're going to start playing with yourself right now, aren't you.\"</p>");
	startQuestions();
	addLinkToPlaceC(md, '"Play with yourself, Debra"', 91);
	WritePlaceFooter(md)
}

function ShowPlace90(stype) {
	var td = "";
	if (stype.substr(0, 5) == "event")
		if ((stype == "eventk" || stype == "eventl" || stype == "eventm") && !isExplicit() || stype == "eventn" || stype == "eventd") td = "td-left-large";
	var md = WritePlaceHeader(false, td);
	var perAngela = findPerson("Angela");
	var clvA = perAngela.getCharmedLevel();
	var perKristin = findPerson("Kristin");
	var perMayor = findPerson("Mayor");
	var myName = perYou.getMaster();
	var myNameA = clvA == 4 ? myName : "my Love";
	switch (stype) {
		case "eventa":
			perKristin.showPerson("kristinevent1.jpg");
			if (!perMayor.checkFlag(4)) {
				perYou.setFlag(9);
				perYou.setBankBalance(perYou.getBankBalance() + 100)
			}
			perMayor.setFlag(4);
			addPlaceTitle(md, "Town Hall Meeting");
			md.write("<p>You quickly run trough the halls and floors up to the mayor\u2019s office. You smile briefly at Angela\u2019s salute and you enter the finely decorated office. Behind the desk sits Mayor Thomas as usual, but in front of her is none other than Kristin, the bank manager. She\u2019s dressed in a completely different outfit she usually wears. It\u2019s a simple butter colored garment with black stockings. Elegant yet free and natural, typical of Kristin! They were in a middle of a conversation when you barged in.</p>" +
				"<p>They both stand up and greet you in unison,</p>" + '<p>"Welcome, ' + myName + '! I\u2019ve been waiting for you!", says Mayor Thomas excitedly as she removes a pair of glasses. You have never seen her wearing glasses before..<p>');
			startQuestions();
			addLinkToPlaceC(md, '"Kristin! What is going here? Some kind of meeting I don\u2019t know about?"', 90, "type=eventc");
			addLinkToPlaceC(md, '"Beatrice what is it with the glasses?"', 90, "type=eventb");
			break;
		case "eventb":
			perKristin.showPerson("kristinevent1.jpg");
			addPlaceTitle(md, "The Mayors Glasses");
			md.write("<p>You ask Mayor Thomas about her glasses, and she smiles at you,</p>" + '<p>"I normally wear contacts ' + myName + ', but I lost one recently. Angela is arranging a replacement set for me, but for now I have to wear my glasses."</p>' + '<p>She leans over and softly says "Is that it..." and seems to look on the floor for her lost contact for a brief moment. As she does her short skit rides up and she adjusts her panties to completely expose herself to you. You realise she is just putting on a show for you, competing for your attention with Kristin.<p>');
			startQuestions();
			addLinkToPlaceC(md, '"Kristin! What is going here? Some kind of meeting I don\u2019t know about?"', 90, "type=eventc");
			break;
		case "eventc":
			perKristin.showPerson("kristinevent1.jpg");
			addPlaceTitle(md, "Town Hall Meeting");
			md.write("<p>You ask your slaves cockily what is happening, and Mayor Thomas responds,</p>" + '<p>"Don\u2019t worry, ' + myName + '! We just talked about the future of the town now that you have brought Kristin under your control too!", the Mayor tries to soften you up, she still doesn\u2019t know you are just acting.</p>' +
				'<p>You reply, "All right, share your thoughts with me! Kristin, with each new information the lovely Mayor gives me, you get rid of a single portion of your dress and orgasm each time."</p>' + '<p>Kristin replies, "Of course, my dear ' + myName + '!", she looks at the mayor, who\u2019s a little bit confused.</p>' + '<p>You order Mayor Thomas, "Go ahead!"</p>' + '<p>She immediately resumes, "' + myName + ', Kristin and I have discussed that money won\u2019t be a problem to you anymore. We will have a close relationship with each other and will monitor your financial things. Kristin has transferred some money into your account as a start.", pleads Beatrice, as if she\u2019s in trouble. Well, she still thinks she has offended you by not telling you about her meeting with Kristin.</p>');
			startQuestions();
			addLinkToPlaceC(md, '"Kristin, you know the drill..."', 90, "type=eventd");
			break;
		case "eventd":
			perKristin.showPerson("kristinevent2.jpg");
			addPlaceTitle(md, "Town Hall Meeting");
			md.write("<p>Kristin gets in position and seductively leans closer to you. She lets herself loose and like a wild animal, and is already on all fours, her firm bottock is pointing at your direction. She starts to finger herself.</p>" + '<p>Mayor Thomas continues, "Also, we have planned a collaboration where we would donate a large sum of money to your bank account through small, fake accounts and "charity profiles" so no one will notice a thing.", your puppet mayor keenly tries to impress you. Kristin on the other hand...</p>');
			startQuestions();
			addLinkToPlaceC(md, '"Whoops, Kristin you are fast! "', 90, "type=evente");
			break;
		case "evente":
			perKristin.showPerson("kristinevent3.jpg");
			addPlaceTitle(md, "Town Hall Meeting");
			md.write("<p>Kristin heatedly gets rid of the top of her dress. She already had an orgasm, but she kept it quiet, what a nice slave she is! She did not want to disturb your conversation with the mayor.</p>" + '<p>Mayor Thomas continues, "We have also talked about a fundraiser or politically important event that could be financially backed by the bank where a lot of important people would attend. They would be in one place and with a tightened security force we could trap them and have them ready for you to enslave them."</p>');
			startQuestions("You compliment the mayor\u2019s cleverness");
			addLinkToPlaceC(md, '"Great idea! I love the way you think, my little slave!"', 90, "type=eventf");
			break;
		case "eventf":
			perKristin.showPerson("kristinevent4.jpg");
			addPlaceTitle(md, "Town Hall Meeting");
			md.write("<p>Miss Thomas flushes and timidly looks at you. Meanwhile Kristin is already on the floor, masturbating furiously and begging you to take her..</p>" + '<p>Mayor Thomas continues, "We tried our best and our main goal is to make you feel safe in this town and also help you any way we can with the town\u2019s management. We want take off some of the weight from your shoulders, we understand how hard it is to rule over your kingdom.", Mayor Thomas is at a loss of words, she is still overwhelmed by your previous compliment.</p>');
			startQuestions("You ask Mayor Thomas");
			addLinkToPlaceC(md, '"Kingdom?"', 90, "type=eventg");
			break;
		case "eventg":
			perKristin.showPerson("kristinevent5.jpg");
			addPlaceTitle(md, "Town Hall Meeting");
			md.write('<p>You ask Mayor Thomas, "Kingdom? Like in medieval times or something like that?", you glance curiously between the mayor who\u2019s still sitting on the desk and Kristin who\u2019s busy trying to be the best nude model for your viewing pleasure.</p>' + '<p>Mayor Thomas answers, "Yes ' + myName + ', after all, soon the whole town will be your people, your servants, your objects or whatever you like to call them\u2026"</p>');
			startQuestions("Kristin tells you...");
			addLinkToPlaceC(md, '"Or at least the women will be!"', 90, "type=eventh");
			break;
		case "eventh":
			perKristin.showPerson("kristinevent6.jpg");
			addPlaceTitle(md, "Town Hall Meeting");
			md.write('<p>Kristin interrupts the Mayor, "Or at least the women will be!", she says, winking at you, still in feeling the pleasures of orgasms, she steadidly fingers her pussy.</p>' + '<p>Mayor Thomas answers, "This town will be your flock, your herd of slaves who will live the rest of their lives by your command. We thought you are going to need some help organizing them.", your mayor tries to impress you with her soothing yet cool voice."</p>' +
				'<p>You reply, "Yes, you are right my dear and those ideas that you have told me are good!", you step closer to Kristin and cup her breasts. She\u2019s still visibly quivers from those three consecutive orgasms she had. ' + "She kisses your finger and wipes the sweat from her face with one hand. Now, you got what you wanted, they told you all the things that interest you. It is time to resume your quest and let your slaves return to their work.</p>" + '<p>You tell them, "Alright, you two get to work already! I ain\u2019t keeping you around to have sex with you all the time!", you laugh at your own joke. Both of them stand up, Kristin puts her clothes on while Miss Thomas waits, standing next to her, she fixes her hair and waits for your further commands. Kristin, still sweating, rapidly puts back her dress, her nylon stockings however has split during her sexual journey, and now there\u2019s hole on her left side of the stockings After your two slaves stand in attention, ready for your next instructions, you give both of them a kiss on the cheek and...</p>');
			startQuestions();
			addLinkToPlace(md, "well, while the two are here...", 90, "type=eventj");
			addLinkToPlace(md, "call in Angela for a full meeting", 90, "type=eventi");
			break;
		case "eventi":
			AddImage("GenericSex/foursomea.jpg");
			addPlaceTitle(md, "Full Town Hall Meeting");
			md.write("<p>You tell the Mayor to bring Angela in to join the meeting. Before Mayor Thomas can call out Angela steps into the office, she was clearlu evesdropping on the meeting.</p>" + '<p>"Yes ' + myNameA + ' how can I help you?"</p>' + '<p>Kristin tells her, "' +
				myName + " is hot, I mean feeling ready from a little show I gave " + perYou.getHimHer() + ", so we are going to do our best to please " + perYou.getHimHer() + '"</p>' + "<p>You can see Mayor Thoma smile as she realises what is happening as well. All three of them seductively strip each other until they are ready for you...</p>" + '<p>Sometime later as you are all re-dressing, you remember the Kingdom discussion and have to think "It is good to be the ' + (perYou.isBornMale() ? "King" : "Queen") + '!"</p>');
			startQuestions();
			addLinkToPlace(md, "exit the Town Hall", 94);
			WritePlaceFooter(md);
			return;
		case "eventj":
			perKristin.showPerson("kristinevent7.jpg");
			addPlaceTitle(md, "Town Hall Meeting");
			md.write('<p>You tell them, "Then again, I can spare some time for sex!".</p>' + "<p>Kristin is still a little tired from before but she still eagerly starts to strip again. Mayor Thomas steps over offering to help you out of your clothing. As she does Kristin starts to help her out of her clothing.</p>" + '<p>Naked they stand before you, and Mayor Thomas asks, "So who first ' +
				myName + '?"</p>');
			startQuestions();
			if (perYou.isMaleSex()) {
				addLinkToPlace(md, "Mayor Thomas", 90, "type=eventk");
				addLinkToPlace(md, "Kristin", 90, "type=eventl")
			}
			addLinkToPlace(md, "Neither, both at once", 90, "type=eventm");
			WritePlaceFooter(md);
			return;
		case "eventk":
			perKristin.showPersonRorX(!perYou.isMaleSex() ? "kristinevent8g.jpg" : "kristinevent8bb.jpg");
			addPlaceTitle(md, "Mayor Thomas and Kristin");
			md.write("<p>You enjoy your slaves, paying particular attention to Mayor Thomas, but indulging in both of their bodies.</p>");
			startQuestions();
			if (isExplicit() && perYou.isMaleSex()) addLinkToPlace(md, "Finish!", 90, "type=eventn");
			addLinkToPlace(md, "dress and exit the Town Hall", 94);
			WritePlaceFooter(md);
			return;
		case "eventl":
			perKristin.showPersonRorX(!perYou.isMaleSex() ? "kristinevent8g.jpg" : "kristinevent8ba.jpg");
			addPlaceTitle(md, "Kristin and Mayor Thomas");
			md.write("<p>You enjoy your slaves, paying particular attention to Kristin, but indulging in both of their bodies.</p>");
			startQuestions();
			if (isExplicit() && perYou.isMaleSex()) addLinkToPlace(md,
				"Finish!", 90, "type=eventn");
			addLinkToPlace(md, "dress and exit the Town Hall", 94);
			WritePlaceFooter(md);
			return;
		case "eventm":
			perKristin.showPersonRorX(!isExplicit() || !perYou.isMaleSex() ? "kristinevent8g.jpg" : "kristinevent8bc.jpg");
			addPlaceTitle(md, "Mayor Thomas and Kristin Together");
			md.write("<p>You enjoy your slaves, indulging yourself equally with their bodies.</p>");
			startQuestions();
			if (isExplicit() && perYou.isMaleSex()) addLinkToPlace(md, "Finish!", 90, "type=eventn");
			addLinkToPlace(md, "dress and exit the Town Hall",
				94);
			WritePlaceFooter(md);
			return;
		case "eventn":
			perKristin.showPersonX("kristinevent9.jpg");
			addPlaceTitle(md, "After the Town Hall Meeting");
			md.write('<p>Sometime later as you look at your slaves covered in your cum, you remember the Kingdom discussion and have to think, "It is good to be the King!"</p>');
			startQuestions();
			addLinkToPlace(md, "dress and exit the Town Hall", 94);
			WritePlaceFooter(md);
			return
	}
	startQuestions();
	addLinkToPlace(md, "exit the Town Hall", 94);
	if (stype.substr(0, 5) == "event") {
		AddRightColumnLarge(md);
		if (stype == "eventb") perMayor.showPerson("mayorevent2.jpg", "95%", "right");
		else perMayor.showPerson("mayorevent1.jpg", "95%", "right")
	}
	WritePlaceFooter(md)
}

function ShowPlace91() {
	var md = WritePlaceHeader();
	var perDebra = findPerson("DebraKelly");
	perDebra.showPerson("debra4.jpg");
	addPlaceTitle(md, "Debra Kelly under a Charm Spell");
	md.write("<p>\"Play with myself?  That would be...  I shouldn't.  I'm in public...  should I?\" she asks, hands already " + "snaking down to rub her clit, sending even more waves of mind-numbing pleasure through her.</p>" + "<p>\"A real woman wouldn't do that in public.  But you're not a real woman, are you Debra... you're my pet.\"</p>" +
		'<p>"Your pet?" she asks, between moans.</p>' + '<p>"That\'s right, my pet. My dog, my toy, my bitch. A slut who always obeys her <i>Owner</i>."</p>' + '<p>"Owner?  But people can\'t be owned..."</p>' + '<p>"People?" you ask.  "People are independent, strong women in complete control of their actions.  You aren\'t in control ' + "anymore, Debra.  You can feel the pleasure can't you?  I'm causing that pleasure, Debra...  I am the reason you can't " + 'control yourself."</p>');
	startQuestions();
	addLinkToPlaceC(md,
		"tell Debra what she is", 399);
	WritePlaceFooter(md)
}

function ShowPlace92() {
	var md = WritePlaceHeader();
	var perDebra = findPerson("DebraKelly");
	perDebra.showPerson("debra5.jpg");
	addPlaceTitle(md, "Debra Kelly under a Charm Spell");
	var myName = perYou.getMaster();
	md.write('<p>"Yes!" she moans, orgasming at your command - her new reality finally washing over her in the ' + "overwhelming wave of pleasure.  She begins barking as the orgasm washes away the last traces of her will.</p>" + "<p>When she recovers she looks around, a sense of loss in her eyes.  For a moment you wonder if " + "something went wrong, then she looks up at you. " +
		'"Please," she begs "Please, will you be my ' + myName + '?"  She kneels at your feet, clothes ' + 'forgotten behind her.  "Please, I have no purpose without someone to own me. ' + 'Who will I love?  Who will I worship?"</p>' + '<p>You smile down at her, and pat her on the head - running your hand through her dark hair.  "Of ' + 'course, my pet.  I will take good care of you.  You belong to me now.  I <i>own</i> you."</p>' + '<p>She smiles a slow smile and looks up at you.  "Oh thank you, ' + myName + ". " + "I will be the most loyal, loving pet.  I will do anything you ask and I promise to never disobey you...  I owe you " +
		"everything " + myName + '; without you I am nothing."</p>' + "<p>You can hardly take it anymore, and pull her up to you and kiss her.  She responds, passionately " + "running her hands over your body.</p>" + "<p>You feel her need for you, her desire.  Then, pushing her back to her knees you unzip your pants. " + '"Now, my pet.  Worship your <i>' + myName + '</i> like the good little bitch you are," you command, looking down at her.</p>');
	if (perYou.isMaleSex()) md.write('<p>"Oh Yes, ' + perYou.getMaster() + '!" she cries, immediately taking you in her mouth and attempting to give you the best blowjob she can, licking and sucking gleefully - happy to serve her ' +
		perYou.getMaster() + ".</p>");
	else md.write('<p>"Oh Yes, Mistress!" she cries, diving at your muff, her sudden hunger for you even more evident - her tongue immediately seeking out the best ways to pleasure her Mistress.</p>');
	md.write("<p>You hear her sigh a mixture of pleasure and contentment as she takes to her task.");
	startQuestions();
	addLinkToPlace(md, "finish and tell her to STAY", 87);
	WritePlaceFooter(md)
}

function LetHer93() {
	movePerson("Ellie", 430);
	gotoPlace(93);
	WriteComments("She quickly dresses and leaves the room")
}

function ShowPlace93(stype) {
	var md = WritePlaceHeader(false, stype == "oral" && (perYou.isMaleSex() || !perYou.isMaleSex() && isExplicit()) ? "td-left-med" : "");
	var perE = findPerson("Ellie");
	var herName = perE.getPersonName();
	var clv = perE.getCharmedLevel();
	setPlaceKnown("DavysRoom");
	if (stype === "oral") {
		if (perYou.isMaleSex()) perE.showPersonRorX("ellie19b.jpg");
		else perE.showPersonRorX("ellie19g.jpg");
		if (clv == 4) addPlaceTitle(md, herName + " Showing Her Devotion");
		else addPlaceTitle(md, herName + " Showing Her Love");
		perE.place =
			422;
		if (clv == 4) {
			md.write("<p>You order your new slave to show her obedience and devotion. Ellie looks at you, unsure what you mean, but smiles as you remove your clothing and sit down on the bed.</p>");
			if (perYou.isBornMale()) md.write("<p>She kneels and takes over, pulling down your underwear and taking your cock and balls into her hands. She starts to lick along the entire length of your shaft, and you can tell she is no novice but also not all too practiced ether. Still, she is talented enough, and shows her somewhat playful nature as she pleases you.</p>" +
				"<p>You decide to enforce your dominance of her a little more, and while she is licking the head of your cock you firmly grasp her hair and make it clear she is to go deeper, as deep as she can. She tries to accommodate you, but she has definitely not done this before.</p>" + '<p>She manages to get a bit over half your length into her mouth and throat before you call out "Now swallow, Slave!" and cum into her throat. She gags a little, but manages to keep most of it inside, swallowing obediently and looking up at you, the smile returning to her face.</p>');
			else md.write("<p>She looks at you uncertain, hesitating until you reinforce your order and she finally kneels before the bed to nervously lick your pussy.</p>" + "<p>Well, at least for about 5 seconds, before she backs away and lowers her head in shame. \u201cY..your slave apologizes, mistress. But she is not a lesbian.... she can't do that.</p>" + "<p>Well, that was unexpected, you reach down and lift her chin to check her eyes, but she is clearly under your spell, you can feel your mana flowing through her body and see the pink shine in her eyes.</p>" +
				"<p>\u201cSlave Ellie.\u201d You speak firmly. You will do as you are told, and not question my orders.</p>" + "<p>The pink glow flares up and again, her head moves forward, but to your amazement, she again resists.</p>" + "<p>\u201cI... your slave really can't do this, mistress... It.... does not feel right...\u201d Her head slumps down again\u201d Sorry, mistress.\u201d</p>" + "<p>So, even with the spell in full effect, she has enough willpower to deny certain orders... you admit you are somewhat impressed, and decide to relent until you know more about this, telling her that she will not be required to serve you like this... for now.</p>");
			md.write('<p>"Slave, return to your home, I will visit you then when I want."</p>' + "<p>Ellie smiles and quickly puts on some of her clothing and leaves the room. She makes sure you get a good view of her as she dresses.</p>")
		} else {
			md.write("<p>You move to make her lie down on the bed, but as you try to press your body against hers, she suddenly recoils from your touch.</p>" + '<p>"Ouugh I... just had a horrible vision of someone else...not you..."</p>' + "<p>You realize she still has some memories of Davy and suggest delaying this for a while, but she shakes her head.</p>" +
				'<p>"N...no, It\'s fine. Let me show you my love another way, instead."</p>' + "<p>She asks you to sit down and kneels before you, reaching out with both hands to open your pants, but once again recoils after a few seconds, looking both confused and embarrassed.</p>" + "<p>\u201cCome to think of it, Tina and Mrs. Robbins might hear us.\u201d You finally interrupt her, realizing that she might still be fighting both your charm and the memories of her time as Davys slave in her subconsciousness.\u201c We might be taking this too fast, anyway, ");
			if (!perYou.isBornMale()) md.write("and you didn't even know you could fall for another woman until now, ");
			md.write(" so we better give it some time.</p>" + "<p>Ellie still looks a little embarrassed, but also relieved, and quickly nods. You tell her that it's best if she returns home now and that you will meet her later.</p>" + "<p>Ellie smiles and quickly puts on some of her clothing, making sure you get a good view of her as she dresses. She kisses your cheek and waves goodbye as she leaves the room.</p>")
		}
		startQuestions()
	} else if (stype ===
		"returnhome") {
		perE.showPerson("ellie20.jpg");
		addPlaceTitle(md, herName + " Returns Home");
		perE.place = 422;
		if (clv == 4) md.write("<p>You decide that it is time to leave here, and order your slave to return home and wait for you there. She stands and you see her there naked before the window and she says,</p>" + '<p>"Yes ' + perYou.getMaster() + ' this slave will return to her home, and await your presence"</p>' + '<p>She starts to walk out, ignoring her clothing, and you tell her that she should get dressed. She smiles "Of course ' +
			perYou.getMaster() + '", and dresses. You sense something of her normal self shining through the slave personna, or is it act?. She finishes dressing and with a longing glance she leaves the room.</p>');
		else md.write("<p>You tell Ellie not here in Davy's room and she agrees that she should return home and wait for you there.</p>" + "<p>She stands and you see her there naked before the window smiling at you and she says,</p>" + '<p>"' + perYou.getPersonName() + ' I really should get dressed before I leave."</p>' +
			"<p>She turns around a little giving you a good show and then dresses quickly. She gives you a kiss on the cheek and waves goodbye as she leaves the room.</p>");
		startQuestions()
	} else if (perE.place !== 93) {
		addPlaceTitle(md, "Davy's Room", "bedroom6.jpg");
		if (stype == "teleport") md.write("<p>The pass spell transfers you into Davy Robbins' room. ");
		else md.write("<p>You slip into Davy Robbins' room. ");
		md.write('There\'s a mess everywhere: games, clothes and papers clutter the tiny room, making it very difficult to move around.</p><p>There are a few posters on the wall and inside a cupboard, you guess Davy has a taste for hard rock and metal music across a wide range of periods. A poster for Meatloaf\'s "Bat Out of Hell II" is on the wall. as is one for "Metallica" and a little known parody band "Barbarion".</p>');
		if (checkPlaceFlag("RobbinsHouse", 8)) {
			md.write("<p>In the far corner you see a laptop");
			if (isSpellKnown("Teleport")) md.write(" but you have already found everything useful in it");
			md.write(".</p>")
		}
		startQuestions();
		if (!checkPlaceFlag("RobbinsHouse", 8)) addQuestionR(md, "search the mess", "You search through the mess and you find buried an old model laptop.", "Search the Room", "setPlaceFlag(\\'RobbinsHouse\\', 8);");
		else if (!isSpellKnown("Teleport"))
			if (isPuzzles()) addLinkToPlace(md, "check the laptop", 80);
			else addLinkToPlace(md, "check the laptop", 80, "type=right", "You remember one time at school Davy mentioned something about passwords, so you enter what he had mentioned")
	} else {
		if (stype === "") stype = "ellie10a";
		perE.showPerson(stype + ".jpg");
		if (stype === "ellie10a") {
			addPlaceTitle(md, herName + " in Davy' Robbins Room");
			md.write('There\'s a mess everywhere: games, clothes and papers clutter the tiny room, making it very difficult to move around.</p><p>There are a few posters on the wall and inside a cupboard, you guess Davy has a taste for hard rock and metal music across a wide range of periods. A poster for Meatloaf\'s "Bat Out of Hell II" is on the wall. as is one for "Metallica" and a little known parody band "Barbarion".</p>' +
				"<p>You see Ellie is relaxing on Davy's bed, wearing sheer pale blue lingerie, her clothes neatly pile on a chair nearby.</p>");
			if (!isInvisible()) {
				md.write('<p>She looks at you curiously, "Why are you here?", and she looks thoughtful for a moment. She reaches over to the bedside table and picks up her phone and starts looking for something in the phone, an image you think.</p>');
				startQuestions();
				addLinkToPlace(md, "Look over her shoulder at the phone", 93, "type=ellie10c")
			} else startQuestions()
		} else if (stype ===
			"ellie10c") {
			perE.place = 430;
			addPlaceTitle(md, herName + " in Davy' Robbins Room");
			md.write("<p>You see the image in her phone: it's a picture of you, and you have about a second to wonder why before Ellie swings the phone around with surprising force and speed, striking you in the side of your head.</p>" + "<p>You collapse, a dazed thought flits though your head about how fast she is while Ellie stands over you, a troubled look on her face while she reaches for a baseball bat.</p>" + "<p>\"I know what he told me to do if I meet you... and I would do anything for love, I'd run right into hell and back...\u201d</p>" +
				"<p>She begins to recite the words and tears well in her eyes as she lifts the bat, and while your vision is blurry, you can see her hands shaking.</p>" + "<p><i>\u201cI would do anything for... love...\u201d</i> She pauses.<i>\u201cbut I... won't do... do that...\u201d</i> She stumbles back, clenching her forehead as if in pain and the baseball bat falls out of her hands. \u201cI do not know why he hates you so much, but I can't... his mother can deal with you!</p>" + "<p>She gives you a firm kick into the stomach and as you are taken by a mix of pain and nausea, you are once again surprised by the force this sweet looking woman is able to muster. When you finally get back on your feet, she is already gone.</p>");
			startQuestions();
			if (!perYou.isBornMale() && isCharmedBy("MrsRobbins", "Davy")) addLinkToPlace(md, "You wake sometime later", 130, "", "", "", 'setPlaceFlag("RobbinsHouse", 9, false);');
			else addLinkToPlace(md, "You wake sometime later", 43);
			WritePlaceFooter(md);
			return
		} else if (stype === "ellie10b") {
			addPlaceTitle(md, herName + " in Davy' Robbins Room");
			md.write("<p>The ring glows as you clasp it in your fist and focus on the mana powering the charm over Ellie, absorbing it within moments.</p>" + "<p>Ellie looks startled, scanning the room in confusion.</p>" +
				'<p>"Where am I...? And Why am I dressed like this?"</p>' + "<p>When she finally notices you, her eyes widen in shock. \"Who are you, didn't we meet somewhere... recently? \u201c It seems the memory slowly catches up with her and tears begin to form.\u201d Oh no... This room... Davy... !\u201d</p>" + "<p>She picks up her phone from a side table and looks at you \"I'm sorry, but I need to go see Kristin, need to find out what happened... and why I'm even here.</p>");
			AddMana(5);
			perE.unCharmThem();
			startQuestions();
			addOptionLink(md, "Let her leave", "LetHer93()")
		} else {
			addPlaceTitle(md, herName + " Under a Charm Spell");
			if (stype === "ellie11") {
				md.write("<p>You recite the words of the spell and Ellie looks at you in surprise,</p>" + '<p>"I know those words, they are from a song Davy sung for me... but they make me feel..."</p>' + "<p>Her words trail off as the spell works itself into her mind and body again. She turns away from you, deep in thought with a soft sigh coming from her. The bank teller gives you a lovely view of her assets as she does so.</p>" +
					"<p>You are a little torn here, she is troubled by her time under Davy's influence and now you are doing the same to her. You " + (perYou.checkFlag(26) ? "can" : "could") + " make her your obedient little slave as Davy did, she is very cute and will be a delightful plaything." + (perYou.checkFlag(26) ? "You could also be gentler and convince her she has fallen in love with you dramatically, she will not be as obedient, but still yours and protected from Davy. It depends on what you want." : "") + "</p>");
				startQuestions();
				addLinkToPlace(md, "enslave Ellie", 93, "type=ellie12", "", "", "charmPerson('Ellie',4);");
				if (perYou.checkFlag(26)) addLinkToPlace(md, "charm Ellie", 93, "type=ellie12", "", "", "charmPerson('Ellie',2);")
			} else if (stype === "ellie12")
				if (clv == 4) {
					md.write('<p>You firmly tell Ellie "Forget about the song, it does not matter to you, all you need to do it listen to me and do what I ask you"</p>' + "<p>She turns to look at you surprised, her hands covering herself as she replies,</p>" + '<p>"What do you mean, what <b>are</b> you asking me to do?"</p>' +
						'<p>You reply firmly "It does not matter what, you just want to do anything I ask, don\'t you?"</p>' + "<p>Your words almost pound into her and for a moment her ever present smile fades, she then hesitantly says,</p>" + '<p>"I do...not...think I barely know you...you are ' + perYou.getPersonName() + ' right..."</p>');
					startQuestions();
					addLinkToPlaceC(md, "Ask her to strip", 93, "type=ellie13")
				} else {
					md.write('<p>You speak to her and she turns to face you, her hands covering herself as best she can. "Ellie, you should not worry about that song, but I can see how you are looking at me. Do you actually like me?"</p>' +
						'<p>Ellie looks at you curiously, "Well...I am feeling a bit odd...');
					if (perYou.isBornMale()) md.write("but yes you are handsome");
					else md.write("nd yes, you are beautiful... but I am not really into girls");
					md.write('..."</p><p>She looks at you more closely, and as the idea of you as a potential lover sinks into her mind, you reinforce it,</p>' + '<p>"You are a very cute girl and I did not come here expecting you to <b>fall in love with me</b>, I mean love at first sight is something for romance novels"</p>' +
						'<p>She hesitates as you words sink in more, pulling in her lower lip before she replies, "Love at first sight..." and you see a blush pass across her face, or maybe a flush of arousal.</p>');
					if (!perYou.isBornMale()) md.write("<p>\u201cN... no.\u201d She suddenly shakes her head. \u201cI may have two mothers, and I really believe that you should love whoever you want... but I'm only into guys.</p>");
					startQuestions();
					addLinkToPlace(md, "Increase her desire", 93, "type=ellie13")
				}
			else if (stype === "ellie13")
				if (clv ==
					4) {
					md.write("<p>Ellie looks surprised and involuntarily starts to remove the lingerie she is wearing, only stopping herself briefly with her remaining willpower,</p>" + "<p>\"No, I don't think so, I barely know you " + perYou.getPersonName() + '"</p>' + "<p>You focus on the magical link between you and Ellie, forcing your will on her and reply simply,</p>" + '<p>"You do not have to worry about these things, or think about anything other than obeying me, and you should not call me ' + perYou.getPersonName() + '"</p>' +
						'<p>She looks confused, the spell slowly taking its toll, "Why... what should I call you?"</p>');
					startQuestions();
					addLinkToPlace(md, 'You tell her: "' + perYou.getMaster() + '"', 93, "type=ellie14")
				} else {
					md.write("<p>You focus on her and the magical link between you and Ellie, willing her to desire you more and more. ");
					if (perYou.isBornMale()) md.write("\u201cI feel like there is a connection between you and me, is there?\u201d");
					else md.write(" \u201cBut if we are supposed to love whoever we want, can we really afford to not take a chance to find love because of our gender?\u201d");
					md.write("</p><p>She contemplates your words briefly, then looks at you smiling,</p>" + '<p>"It is so strange how attractive you are. Well, do you like me too?"</p>' + "<p>She starts to tease you, moving as if to remove her lingerie and not quite remembering how little she really has on. Once again she shows you her firm and round bottom as she looks back you expectantly.</p>" + "<p>There is only one real answer to her question, even if you do not really mean it, yet..</p>");
					startQuestions();
					addLinkToPlaceC(md,
						'"Yes, and I love you"', 93, "type=ellie14")
				}
			else if (stype === "ellie14")
				if (clv == 4) {
					md.write('<p>She looks troubled, "' + perYou.getMaster() + " that's not right! That would mean I was some sort of servant...!\"</p>" + "<p>You reply firmly,</p>" + '<p>"No, that means you are my slave, who will obey me, doing anything I ask, at anytime.<br>' + 'And now, my slave, you will strip!"</p>' + "<p>She almost tears off her lingerie at your order, but still maintains some tiny measure of control, she almost whispers,</p>" +
						"<p>\"I wont't...I can't do some things, I know there was something I had to do, but I can't...hurt...\"</p>" + "<p>You see how troubled she is about some orders Davy had given her before, and how there are some limits of what she will do, no matter what you say. You relent a little,</p>" + '<p>"I will never order you to harm another, that is not what I want from you as my slave. Obey me and only think of what I desire and my pleasure, and you will be happy as the slave you are."</p>' + '<p>She looks at you nervously, but your assurance seems to put her somewhat at ease as the spell washes away the last traces of doubt and resistance, a blissful smile forming on her lips "Yes, ' +
						perYou.getMaster() + '"</p>');
					startQuestions();
					addLinkToPlaceC(md, '"Prove your obedience"', 93, "type=ellie15")
				} else {
					md.write('<p>Ellie looks radiantly happy to hear this and  quickly replies "I love you too!"</p>' + "<p>Ellie smiles then and mostly removes her lingerie, just holding it in front of herself to cover her breasts and groin. She looks at you, the arousal from the magic spell still working itself on her.</p>" + '<p>"Do you want more, my love?"</p>');
					startQuestions();
					addLinkToPlaceC(md, '"Yes, I do"',
						93, "type=ellie15")
				}
			else if (stype === "ellie15")
				if (clv == 4) {
					md.write("<p>Ellie drops the lingerie she was wearing and kneels there before you, naked and beautiful with a wide smile on her lips,</p>" + "<p>" + perYou.getMaster() + ' what can you slave do to prove her devotion?"</p>' + "<p>You are a little surprised, and pleased, at the way she addresses you. She seems to have completely adopted a slave attitude, referring to herself as a slave and not by name. You can see she is yours now, to do anything you like, as long as you do not cross a certain line and ever ask her to harm another person.</p>" +
						"<p>You look at your smiling slave and decide how to proceed,</p>");
					startQuestions();
					addLinkToPlace(md, "Dominate her more", 93, "type=oral");
					addLinkToPlaceC(md, "Tell her to return to her home and wait for you there", 93, "type=returnhome")
				} else {
					md.write("<p>Playfully Ellie throws away her lingerie and sits there before you, completely naked in all her Beauty, and as you admire her body she smiles at you.</p>" + "<p>She leans in and kisses you, but while you can feel the force of the spell still coursing though her and reinforcing her feelings, the actual kiss is brief and still hesitant.</p>");
					if (perYou.isBornMale()) md.write("\u201cI can't believe how quick I fell for you, my love...\u201d");
					else md.write("\u201cI'm actually in love with another woman...\u201d");
					md.write("<p>She whispers as she breaks the kiss and looks deeply into your eyes, desire and love filling her expression,</p>" + "<p>Shall we...here?</p>");
					startQuestions();
					addLinkToPlaceC(md, '"I need you now"', 93, "type=oral");
					addLinkToPlaceC(md, '"Not here, meet me at your home"', 93, "type=returnhome")
				}
		}
	}
	if (!isCharmedBy("MrsRobbins",
			"You")) addTextForQuestions(md, "<b>as you are breaking in, leaving through the house is a bad idea</b>", "center");
	addLinkToPlace(md, isCharmedBy("MrsRobbins", "You") ? "leave Davy's room" : "run out of the house!", 176);
	WritePlaceFooter(md)
}

function ShowPlace94() {
	var md = WritePlaceHeader();
	var perAngela = findPerson("Angela");
	var perMayor = findPerson("Mayor");
	setPlaceBreakIn("TownHall", false);
	if (perAngela.isCharmedBy()) perAngela.setFlag(2);
	if (perMayor.isCharmedBy("You")) perMayor.setFlag(3);
	if (!isPlaceKnown("Hotel")) setPlaceKnown("Hotel");
	addPlaceTitle(md, "Glenvale Town Hall", "cityhall1.jpg", 25);
	if (perAngela.isCharmedBy() && perMayor.isCharmedBy("You")) md.write("<p>Glenvale\u2019s town hall proudly stands as a symbol of your power and authority. Not from the outside, as it still looks the same fifty-four years old building as always. " +
		"Instead, what\u2019s inside of it changed that matters. Mayor Beatrice Thomas has had a change of heart recently and decided to become your slave. " + "Her secretary, Angela, also joined her. The town hall is officially one of your strongholds, with your slaves working for you tirelessly inside it.</p>");
	else md.write("<p>Glenvale's town hall proudly stands as a symbol of unity in the community. Only fifty-four years old, the building has been occupied " + "by many of the finest council management officials, including the current Mayor Beatrice Thomas. Just passing by the town " +
		"center gives you a comfortable feeling of security and reliability.</p>");
	if (!isShopOpen(0)) md.write("<p>The town hall has a sign noting that it is closed, hours of business 8am to 6pm Monday to Friday.</p>");
	startQuestions();
	if (isShopOpen(0))
		if (checkPersonFlag("Angela", 6) && !checkPersonFlag("Mayor", 4)) addLinkToPlace(md, "enter the Town Hall for the meeting", 90, "type=eventa");
		else addLinkToPlace(md, "enter the Town Hall", 95);
	addLinkToPlace(md, "walk to the Library", 2);
	addLinkToPlace(md, "walk to the Hotel",
		123);
	if (isPlaceKnown("PoliceStation")) addLinkToPlace(md, "walk to the Police Station", 167);
	WritePlaceFooter(md)
}

function ShowPlace95(stype) {
	var md = WritePlaceHeader();
	if (!isShopOpen(0)) {
		if (!isPlaceBreakIn("TownHall")) return gotoPlaceDelayed(94, "", '<img src="UI/closed.png" style="float:left;width:15%;margin-right:5px">The Town Hall closes and you are asked to leave.');
		addPlaceTitle(md, "Town Hall Reception", "townhall-reception.jpg");
		md.write("<p>The reception is empty at night and no-one is present at all.<p>");
		startQuestions();
		addLinkToPlace(md, "look around", "", "", "You spend a while searching around but find nothing useful",
			"", "WaitHere(5);");
		addTextForQuestions(md, "<b>The doors of the Town Hall are locked</b>", "center");
		WritePlaceFooter(md);
		return
	}
	var perAngela = findPerson("Angela");
	var clv = perAngela.getCharmedLevel();
	if (perAngela.place != 95) {
		addPlaceTitle(md, "Town Hall Reception", "townhall-reception.jpg");
		md.write("<p>The reception is empty at the moment, Angela is not present.<p>");
		startQuestions();
		if (isPlaceKnown("JohnAdamsOffice")) addLinkToPlace(md, "visit John Adams's office", 96);
		if (wherePerson("Mayor") === 110) addLinkToPlace(md,
			"visit the Mayor", 110);
		addLinkToPlace(md, "exit the Town Hall", 94);
		WritePlaceFooter(md);
		return
	}
	if (perYou.getQuestRustyKey() == 5) perYou.setQuestRustyKey(7);
	if (clv === 0) perAngela.showPerson("angela1.jpg", "", "", "angela1a.jpg");
	else if (Math.random() < .5) perAngela.showPerson("angela8a.jpg");
	else perAngela.showPerson("angela8b.jpg", perAngela.checkFlag(11) ? "" : "50vw");
	if (clv === 0) {
		addPlaceTitle(md, "Town Hall Reception");
		md.write("<p>A young lady greets you at the entrance of the town hall. She introduces herself as Angela and asks your business.</p>")
	} else {
		addPlaceTitle(md,
			"Angela at Reception");
		if (isCharmedBy("Mayor", "You")) {
			md.write("<p>Over the course of the last few days you have taken control of the Town Hall. Mayor Thomas and her secretary, Angela, are your properties. Especially Miss Thomas, who has become a loyal supporter of yours, she is a puppet whose strings you control. With her influence and power, you can watch over Glenvale and know every small happenings in it.</p>");
			if (clv == 4) md.write("<p>Angela kneels down, greeting you as you enter the office. Her smile always brightens you up a bit. She attends you to her desk and offers you some coffee. She also declares to you that the Mayor is in her office, ready to see you anytime you wish it so. She says it in an official manner, but still keeping her husky voice sexy enough.</p>");
			else md.write("<p>Angela smiles, greeting you as you enter the office. Her smile always brightens you up a bit. She attends you to her desk and offers you some coffee. She also declares to you that the Mayor is in her office, ready to see you anytime you wish it so. She says it in an official manner, but still keeping her husky voice sexy enough.</p>")
		} else md.write("<p>Angela is pleased to see that you have returned. As you enter the office she begins to rub her breast.<p>");
		if (clv == 4) md.write('<p>"Hello, ' +
			perYou.getMaster() + '," she says, lowering her gaze as she speaks to you.  "How may your humble slave serve you?"</p>');
		else md.write('<p>"Oh my love," she says. "Have you come back for more?"</p>');
		if (isSpellKnown("Wealth") && perYourBody.FindItem(5) === 0 && !perAngela.checkFlag(8)) perAngela.setFlag(8)
	}
	startQuestions();
	switch (perAngela.other) {
		case 0:
			addQuestionC(md, "tell Angela your name, and that you're interested in the Town Hall", "Angela", 800);
			break;
		case 1:
			addQuestionC(md, "ask Angela what she does around here",
				"Angela", 801);
			break;
		case 2:
			if (perYou.isQuestStarted(1)) addQuestionC(md, "ask Angela whom you should tell about the strange things you've seen", "Angela", 802);
			break
	}
	if (checkPlaceFlag("Hotel", 8) && !checkPlaceFlag("Hotel", 4))
		if (!checkPlaceFlag("Hotel", 2)) addQuestionC(md, "ask Angela whether she has any records on the Broken Inn Hotel", "Angela", 4201);
		else {
			if (!checkPlaceFlag("Hotel", 3))
				if (clv === 0) addQuestionC(md, "ask Angela why the plans cost so much", "Angela", 4202);
			if (clv > 0) {
				addQuestionC(md, "tell your <i>Slave</i> that you will not <i>pay</i> for the plans",
					"Angela", 4202);
				addQuestionC(md, "ask your <i>lover</i> to give you the plans as a gift", "Angela", 4203)
			}
			addQuestionCO(md, "pay Angela " + sCurrency + "30 for the plans", "Angela", 4230)
		}
	if (getPersonOther("Mayor") === 0) addQuestionC(md, "tell Angela you would like to see the mayor", "Angela", 1600);
	if (clv > 0) {
		if (!isPlaceKnown("AngelasApartment")) addQuestionC(md, "ask Angela where she lives", "Angela", 2600);
		if (clv == 4) addLinkToPlaceC(md, "tell Angela to lay back and give you some more", Place, "type=angelamore");
		else addLinkToPlaceC(md,
			"ask Angela for some more", Place, "type=angelamore");
		if (!isPlaceKnown("BreakRoom")) addLinkToPlaceC(md, "ask Angela for a cup of coffee", 97, "type=coffee")
	}
	if (isPlaceKnown("BreakRoom")) addLinkToPlace(md, "visit the break room", 97);
	if (isPlaceKnown("JohnAdamsOffice")) addLinkToPlace(md, "visit John Adams's office", 96);
	else if (wherePerson("Tess") == 96 && !perAngela.checkFlag(7)) addQuestionC(md, "ask where is John Adams office", "Angela", 100);
	if (wherePerson("Tess") == 230 && !isPlaceKnown("AdamsHouse")) addQuestionC(md,
		"ask Angela for the address for John and Tess Adams home", "Angela", 101);
	if (wherePerson("Mayor") === 110) addLinkToPlace(md, "visit the Mayor", 110);
	if (whereItem(23) == 999) {
		addQuestionC(md, "pay Angela " + sCurrency + "30 for the hotel plans again", "Angela", 4230);
		if (clv === 0) addQuestionC(md, "demand another copy of the Hotel plans", "Angela", 999);
		else if (clv != 4) addQuestionC(md, "ask your <i>lover</i> to give you another copy of the plans", "Angela", 999);
		else addQuestionC(md, "demand another copy of the Hotel plans",
			"Angela", 999)
	}
	if (perAngela.checkFlag(8) && !perAngela.checkFlag(9)) addQuestionC(md, "ask Angela to look for magic places", "Angela", 702);
	addLinkToPlace(md, "exit the Town Hall", 94);
	WritePlaceFooter(md)
}

function ShowPlace96() {
	var perJohn = findPerson("JohnAdams");
	var perTess = findPerson("Tess");
	var bTessHere = perTess.place == 96;
	var md = WritePlaceHeader(false, bTessHere ? "td-left-med" : "");
	if (!bTessHere) {
		addPlaceTitle(md, "John Adams Office", "office1.jpg");
		md.write("<p>A simple and tidy office used by John Adams.</p>");
		if (!perJohn.checkFlag(3)) {
			md.write("<p>You notice sitting on a shelf a familiar stone being used as a paper-weight</p>");
			PlaceI(5);
			perJohn.setFlag(3)
		}
		startQuestions();
		addLinkToPlace(md, "go to the reception area.",
			95)
	} else {
		perTess.showPerson("tess1a.jpg");
		addPlaceTitle(md, "Tess Adams Hiding?");
		md.write('<p>You see Mrs. Adams sitting on a chair in the office, looking very nervous, she looks up "John...." but her voice trails away as she sees you.</p>' + '<p>"Oh ' + perYou.getPersonName() + '...sorry I ran out on you, I really had to see my husband, but he is not here, but I called he will be soon...I should go and wait for him...."');
		startQuestions("You have to hurry..");
		addLinkToPlace(md, "order Tess to stay", 30)
	}
	WritePlaceFooter(md)
}

function ShowPlace97() {
	setPlaceKnown("BreakRoom");
	showGeneralPlace("Break Room", "townhall-breakroom.jpg", "The break room for staff and visitors of the Town Hall", "return to reception", 95)
}

function ShowPlace98() {
	showGeneralPlace("Conference Room", "townhall-conferenceroom.jpg", "The Town Hall conference room", "return to reception", 95)
}

function ShowPlace103() {
	showGeneralPlace("Conference Room", "townhall-conferenceroom.jpg", "The Town Hall conference room", "return to reception", 95)
}

function ShowPlace107(stype) {
	var md;
	var perD = findPerson("DebraKelly");
	var herName = perD.getPersonName();
	if (stype === "") {
		md = WritePlaceHeader();
		perD.showPerson(Math.random() < .5 ? "debra5.jpg" : "debra7.jpg");
		addPlaceTitle(md, "Your Pet, " + herName);
		md.write("<p>Your loyal little pet immediately runs to your side and kneels at your feet, eagerly waiting to service you in any way you may desire.</p>" + '<p>"Oh thank you ' + perYou.getMaster() + '!" Debra cries. "I\'ve been a good girl. ' + perYou.getMaster() + " is happy with me." +
			"Within moments you can smell the heat coming from her moistening snatch as her hands pull up her dress and she begins to fondle her breasts." + '"Oh ' + perYou.getMaster() + ', is there anything else your little bitch can do to please you?  Will you take me now?  Or," she says with a honeyed tongue,' + '"Perhaps ' + perYou.getMaster() + ' would like me to <i>worship</i> at your feet once more?"</p>' + "<p>You look around.  Nobody else is in the park.</p>");
		startQuestions()
	} else {
		if (stype === "bj") {
			md = WritePlaceHeader(false,
				"td-left-med");
			if (perYou.isMaleSex()) {
				perD.showPerson("debra9b.jpg");
				addPlaceTitle(md, "Your Pet Licking a Bone")
			} else {
				if (isExplicit()) perD.showPersonX("debra9g.jpg");
				else perD.showPerson("debra9b.jpg");
				addPlaceTitle(md, "Your Pet Lapping At Something Moist")
			}
			md.write('<p>"Worship me, my little bitch in heat," you say, dropping your pants in front of her.</p>');
			if (perYou.isMaleSex()) md.write('<p>"Oh yes, ' + perYou.getMaster() + '!" she cries, immediately taking you in her mouth and lovingly giving you the best blowjob she can, licking and sucking gleefully - happy to serve her Master.</p>');
			else md.write('<p>"Oh yes, Mistress!" she cries, diving at your muff, her sudden hunger for you even more evident - Her tongue lovingly and gleefully lapping up every drop that her skillful attentions arouse.</p>');
			md.write("<p>You hear her moan, a mixture of pleasure and contentment as she devotes herself to her joyous task.")
		} else if (stype === "fuck")
			if (perYou.isMaleSex()) {
				md = WritePlaceHeader();
				perD.showPersonRandom("debra8", 3, "50vw,height:max,50vw");
				addPlaceTitle(md, "Giving Your Pet Your Bone");
				md.write("<p>You tell " + herName + " it is time for some doggy-style and you sink you manhood into her delightful pussy, ramming into her over and over. You feel her shudder in her release and that is the final straw and you pour your passion into her depths.</p>")
			} else {
				md = WritePlaceHeader(false, "td-left-large");
				AddImageRandomX("GenericSex/sex-ff anal strapon ", 2);
				addPlaceTitle(md, "Giving Your Pet Your Plastic Bone");
				md.write("<p>You put on your strap-on and tell " + herName + " that it is time for some doggy-style!</p>")
			}
		startQuestions()
	}
	if (stype ===
		"") {
		if (perYou.isMaleSex()) {
			addLinkToPlace(md, "give her a bone", 107, "type=fuck");
			addLinkToPlace(md, "lick the bone", 107, "type=bj")
		} else {
			addLinkToPlace(md, "lap dog!", 107, "type=bj");
			if (perYourBody.FindItem(45) > 0) addLinkToPlace(md, "give her a plastic bone", 107, "type=fuck")
		}
		addLinkToPlaceC(md, '"Walkies"', 107, "type=walkies");
		if (isCharmedBy("JanetKelly") && perD.checkFlag(2)) addLinkToPlaceC(md, '"Home time"', 107, "type=home")
	}
	addLinkToPlace(md, "finish up and play with Debra some more", 87);
	if (isPlaceKnown("WildRanges")) addLinkToPlace(md,
		"enter the wild ranges", 26);
	addLinkToPlace(md, "walk to the main park pathway?", 63);
	WritePlaceFooter(md)
}

function ShowPlace108(stype) {
	var md = WritePlaceHeader();
	var perKate = findPerson("Kate");
	var perMG = findPerson("MrsGranger");
	if (perDavy.other == 7) perDavy.other = 6;
	if (stype == "leave" || stype == "embrace") {
		perKate.other = 900;
		perKate.showPerson("kate17e.jpg");
		addPlaceTitle(md, "Stabbed!");
		if (stype === "leave") md.write("<p>Something about how she is acting troubles you and you make and excuse and turn to walk out of her room. As you do something cold and sharp pierces between your ribs. ");
		else md.write("<p>You embrace Kate. Her warm lips surround yours and she wraps her arms around you before something cold and sharp pierces between your ribs. ");
		md.write("You stagger backward and try to grasp the handle of a dagger lodged in your left side. Your bloodied fingers fail to grip, slipping off the hilt.</p>" + "<p>Kate sneers at your passing life. &quot;You conceited fool,&quot; she says. &quot;How could you ever think that I could " + "love anyone else but my master Davy?&quot;</p>" + "<p>You're unsure how you have failed to finish your journey or how you could ever win against the villains conspiring against you.</p>" + "<p>Better luck next time.</p>");
		startQuestions();
		addRestartLink(md)
	} else {
		if (perDavy.other == 7) perDavy.other = 6;
		perKate.showPerson("kate17a.jpg", "", "", "kate17c.jpg");
		addPlaceTitle(md, "Kate At Her House");
		md.write("<p>Kate is waiting for you in her bedroom. Although she's changed her clothes again she looks much calmer than the last time you saw her.</p>" + '<p>"Hello," she says. "I\'m so glad you\'re here. I was thinking that I have never met anyone quite as nice as you ' + perYou.getPersonName() + ". You know, we have a lot in common and, at times like this, it's " +
			"only natural for two people to find an attraction to one another. I know that you think that I'm a little " + "forward but I want to know you a lot better " + perYou.getPersonName() + '. Would you like to get to know me\ttoo?"</p>');
		if (perMG.other >= 50 && perMG.checkFlag(1)) {
			setPlaceKnown("Hospital");
			md.write("<p>&quot;By the way, I hope you've visited my mother in the hospital.  She kept saying your name in her sleep when I visited her there. I didn't know the two of you were so close.&quot;</p>")
		}
		startQuestions();
		if (perKate.other == 15) addQuestionC(md, "tell Kate that you like her too", "Kate", 5415);
		else if (perKate.other == 50) addLinkToPlace(md, "embrace your friend", 108, "type=embrace");
		if (perMG.whereNow() === 177) addLinkToPlace(md, "look for Mrs. Granger", 108, "type=leave");
		addLinkToPlace(md, "exit the house", 108, "type=leave")
	}
	WritePlaceFooter(md)
}

function ShowPlace109(stype) {
	var md = WritePlaceHeader();
	var perKate = findPerson("Kate");
	perKate.other = 900;
	perKate.showPerson("kate17e.jpg");
	addPlaceTitle(md, "Stabbed!");
	if (stype === "") md.write("<p>You embrace Kate. Her warm lips surround yours and " + "she wraps her arms around you before something cold and sharp pierces between your ribs. ");
	else md.write("<p>Something about how she is acting troubles you and you make and excuse and turn to walk out of her room." + "As you do something cold and sharp pierces between your ribs. ");
	md.write("You stagger backward and try to grasp the handle of a dagger lodged in your " + "left side. Your bloodied fingers fail to grip, slipping off the hilt.</p>" + "<p>Kate sneers at your passing life. &quot;You conceited " + "fool,&quot; she says. &quot;How could you ever think that I could " + "love anyone else but my master Davy?&quot;</p>" + "<p>You're unsure how you have failed to finish your journey or " + "how you could ever win against the villains conspiring against you.</p>" + "<p>Better luck next time.</p>");
	startQuestions();
	addRestartLink(md);
	WritePlaceFooter(md)
}

function ShowPlace110() {
	var md = WritePlaceHeader();
	var perAbby = findPerson("Abby");
	var perAngela = findPerson("Angela");
	var perKhan = findPerson("OfficerKhan");
	var perMayor = findPerson("Mayor");
	var sCharmedBy = perMayor.sCharmedBy;
	var bMayorYours = sCharmedBy == "You";
	var bMayorDavy = sCharmedBy == "Davy";
	if (!bMayorYours) perMayor.showPerson("mayor1.jpg");
	else perMayor.showPerson("mayor5.jpg");
	addPlaceTitle(md, "Mayor Thomas");
	md.write("<p>Mayor Beatrice Thomas greets you as you enter her office ");
	if (!bMayorYours) {
		md.write(", she looks quite concerned and unsure of your visit.</p>");
		if (isMurderPath()) {
			if (perMayor.other == 6 || perMayor.other == 11)
				if (!perMayor.checkFlag(6)) md.write('<p>She looks at you expectantly.  "So, did you bring the book with you this time?" she asks, running her tongue over her lips as if she is about to win a prize.<p>');
				else md.write('<p>She looks at you expectantly.  "Well, go and get the book" she asks, running her tongue over her lips.<p>');
			if (!bMayorDavy) md.write('<p>"What happened, ' + perYou.getPersonName() + '?  That boy, Davy...  Why did I?" she says, shaking her head in confusion.  "Everything was so fuzzy, but now I can think clearly again!</p>')
		}
	} else md.write("The once cold leader of the town is now rubbing her tits and pussy through her black panties for you, ready to serve your every desire.</p>" +
		'<p>"Welcome ' + perYou.getMaster() + '! Please take a seat. How can I be of service?", she lovingly asks as she still plays with her pussy, it\u2019s her way of welcoming you.</p>');
	startQuestions();
	if (perMayor.other == 3) addQuestionC(md, "say hello to the mayor", "Mayor", 1603);
	if (checkPersonFlag("Gina", 1) && !checkPersonFlag("Gina", 2)) addQuestionC(md, "ask about the museum security guard", "Mayor", 100);
	if (isMurderPath() && perMayor.other > 3 && bMayorDavy) {
		if (perMayor.other == 4 && perKhan.other < 10) addQuestionC(md, "ask to help out with the murder investigation",
			"Mayor", 5310);
		if (perMayor.other == 4) addQuestionC(md, "apologize for bothering her", "Mayor", 1601);
		else if ((perMayor.other == 5 || perMayor.other == 10) && perYourBody.FindItem(4) > 0) addQuestionC(md, "tell the mayor that you have the book", "Mayor", 1602);
		else if (!perMayor.checkFlag(6) && (perMayor.other == 6 || perMayor.other == 11)) {
			if (perYourBody.FindItem(4) > 0) {
				startAlternatives(md);
				addQuestionC(md, "tell the Mayor you have the book right here in your backpack", "Mayor", 16999)
			}
			addQuestionC(md, "tell the Mayor that you don't have it on you at the moment",
				"Mayor", 1606);
			if (perYourBody.FindItem(4) > 0) endAlternatives(md)
		}
		if (perMayor.other < 10 && getPersonCharm("Tina") >= 4) addQuestionC(md, "tell the mayor to go to the Robbins house", "Mayor", 6104)
	} else;
	if (bMayorYours && sType === "") {
		addLinkToPlace(md, "ask Mayor Thomas for more", 110, "type=askmore");
		if (isMurderPath() && perKhan.other < 10) addQuestionC(md, "ask to help out with the murder investigation", "Mayor", 5310);
		if (isPlaceKnown("Museum") && perAbby.getQuestDragonGem() > 0)
			if (!checkPlaceFlag("Museum", 8)) addQuestionC(md,
				"tell the Mayor to <i>close</i> the Museum to the public", "Mayor", 13400);
			else addQuestionC(md, "tell the Mayor to <i>re-open</i> the Museum", "Mayor", 13401);
		if (checkPlaceFlag("Hospital", 3) && !checkPlaceFlag("Hospital", 4)) addQuestionC(md, "ask the Mayor for a key to the hospital basement", "Mayor", 44201);
		if (checkPlaceFlag("Park", 6) && !checkPlaceFlag("Park", 5)) addQuestionC(md, "ask the Mayor for a key to the construction site", "Mayor", 44202)
	}
	addLinkToPlace(md, "go to the reception", 95);
	WritePlaceFooter(md)
}

function ShowPlace111() {
	var md = WritePlaceHeader();
	if (wherePerson("Mayor") === 0) movePerson("Mayor", 110);
	addPlaceTitle(md, "Phone Message", getThemeFolder() + "phone2.png");
	md.write("<p>You listen to the message on your machine.</p>" + '<p>"Hello," says a sweet voice. "This is Angela from the municipal office. Mayor Thomas is very keen to meet with you and asks that you come immediately to the town hall. Have a nice day."</p>');
	startQuestions();
	addLinkToPlace(md, "go to the kitchen", 45);
	WritePlaceFooter(md)
}

function ShowPlace112(stype) {
	var perJanet = findPerson("JanetKelly");
	var myNameJ = perJanet.getYourNameFor();
	var clvJ = perJanet.getCharmedLevel();
	var perDebra = findPerson("DebraKelly");
	var herNameD = perDebra.getPersonName();
	var clvD = perDebra.getCharmedLevel();
	var totpeople = perJanet.place == 112 ? 1 : 0;
	if (perDebra.place == 112) totpeople++;
	var hJ = "";
	if (clvJ == 2) hJ = "your lover ";
	else if (clvJ == 3) hJ = "your bimbo ";
	else if (clvJ == 4) hJ = "your slave ";
	else if (clvJ == 5) hJ = "your pet ";
	var sJ = "order";
	if (clvJ == 2 || clvJ === 0) sJ = "ask";
	var md = WritePlaceHeader(false, totpeople > 1 || perDebra.place == 112 && totpeople == 1 && clvD > 0 && clvD != 2 ? "td-left-large" : "td-left");
	md.write("<table><tr>");
	if (perJanet.place == 112) {
		md.write("<td" + (totpeople > 1 ? ' style="width:50%"' : "") + ">");
		if (clvJ > 0)
			if (clvJ == 3) perJanet.showPerson("janet7b.jpg", "99%");
			else if (clvJ == 5) perJanet.showPerson("janet7c.jpg", "99%");
		else perJanet.showPerson("janet2.jpg", "99%");
		else perJanet.showPerson("janet1.jpg", "99%")
	}
	if (perDebra.place == 112) {
		md.write("<td" + (totpeople > 1 ? ' style="width:50%"' :
			"") + ">");
		if (clvD === 0) perDebra.showPersonDN("debra11d.jpg", "99%", "", "debra11e.jpg");
		else if (clvD == 2) perDebra.showPersonDN("debra13b.jpg", "99%");
		else if (totpeople == 1) perDebra.showPerson("debra11c.jpg");
		else if (clvJ == 3) perDebra.showPersonRandom("debra11", 2, "99%");
		else {
			md.write("</tr><tr><td>");
			perDebra.showPerson("debra11c.jpg", "50vw")
		}
		md.write("</td>")
	}
	md.write("</tr></table>");
	addPlaceTitle(md, "Debra & Janet Kelly's Residence");
	md.write("<p>Furniture and boxes are strewn all over the house from the girls' settling into their new home.</p>");
	if (clvJ === 0) {
		if (!perJanet.checkFlag(1)) {
			md.write("<p>You introduce yourself as Debra's friend to her sister, Janet, who invites you into the guest room.</p>");
			perJanet.setFlag(1)
		}
		md.write("<p>Janet invites you to sit on one of the boxes as she hands you a glass of tea, evidently taking a break from the unpacking.</p>")
	} else if (perJanet.place == 112) {
		md.write("<p>You see " + hJ + "Janet is sitting on a chair looking at you,<br>");
		if (clvJ == 3) md.write('<p>"Like, Hi there, ' + myNameJ + ', you wanna do me?" She asks, her body and mind already responding to your presence, becoming more and more aroused every moment.</p>');
		else md.write('<p>"Welcome back, ' + myNameJ + ', what can I do for you?" She asks, her body and mind already responding to your presence, becoming more and more aroused every moment.</p>')
	}
	if (perDebra.place == 112)
		if (clvD == 1) md.write("<p>Your puppy Debra is sitting on the floor, completely naked, looking at you eagerly.</p>");
		else if (clvD === 0)
		if (isDay()) md.write("<p>Debra is nearby taking a break from unpacking some boxes.</p>");
		else md.write("<p>Debra is nearby relaxing, wearing a rather cute nightie.</p>");
	else if (clvD == 2) md.write("<p>Debra is standing looking at you, her lover, seductively.</p>");
	startQuestions();
	if (perJanet.place == 112) {
		if (perDebra.place != 112 && !perJanet.checkFlag(2)) addQuestionC(md, "ask " + hJ + "if Debra is home", "JanetKelly", 6800);
		if (!perJanet.checkFlag(3)) addQuestionC(md, "ask " + hJ + "Janet if she has ever lived in Glenvale before", "JanetKelly", 6801);
		else if (clvJ === 0 && !perJanet.checkFlag(4)) addQuestionC(md, "ask " + hJ + "Janet to tell you more about her ancestors", "JanetKelly", 6802);
		if (clvJ >
			0) {
			if ((perJanet.checkFlag(3) || perJanet.checkFlag(4)) && !perJanet.checkFlag(5)) addQuestionC(md, sJ + " " + hJ + "Janet to tell you about her ancestors", "JanetKelly", 6701);
			else if (perJanet.checkFlag(5) && !perJanet.checkFlag(6)) addQuestionC(md, sJ + " " + hJ + "Janet to tell you more about the warlock", "JanetKelly", 6702);
			addLinkToPlace(md, sJ + " " + hJ + "Janet to show you her room again.", 300)
		}
		if (perKurndorf.getQuestSeance() == 16) addQuestionC(md, sJ + " " + hJ + "Janet to tell where you could learn about s\u00e9ances", "JanetKelly",
			2716)
	} else if (perJanet.place == 300) addLinkToPlace(md, "check on " + hJ + "Janet upstairs.", 300);
	if (perDebra.place == 112) {
		if (clvD == 1) {
			addLinkToPlaceC(md, 'Debra, "Walkies"', 112, "type=walkies");
			if (isDay()) addLinkToPlaceC(md, "take your puppy for a run in the park", 87, "type=parkwalkies");
			if (perYou.isBornMale() || perYourBody.FindItem(45) > 0) addLinkToPlaceC(md, 'Debra, "Doggy-style"', 112, "type=debrafuck")
		} else if (clvD == 2) addLinkToPlace(md, isDay() ? "'join' Debra outside" : "'join' Debra in the TV room", 112, "type=debrafuck");
		if (clvJ > 0 && clvD > 0) addLinkToPlace(md, "ask them to show some sisterly affection", 112, "type=incest")
	}
	if (clvJ > 0) addSleepLink(md, "go to bed for the night with " + hJ + "Janet", "Going to Bed with Janet", '<p style="position:absolute;left:5%;top:5%;cursor:pointer;font-size:1.1em;width:50%">You tell ' + hJ + "Janet that you will sleep here tonight. She lies down awaiting you for you to join her.", "janet12.jpg");
	if (perDebra.place == 112 && clvD > 0) addSleepLink(md, "go to bed for the night with " + herNameD, clvD == 2 ? "Sleeping with Debra" :
		"Bedding Debra", '<p style="position:absolute;left:2%;top:60%;cursor:pointer;font-size:1.1em;width:40%">' + (clvD == 2 ? "You ask your lover Debra if you could spend the night. She looks quite happy and leads you to her very nicely furnished bedroom, and she does a little strip-tease for you before lying down. The lovely sight of her there tells you they you will not be getting to sleep soon." : "You tell your puppy that it is time to take her to bed. She looks brightly at you and eagerly leads you to her bedroom."),
		"debra14.jpg");
	addLinkToPlace(md, "exit the house", 44);
	WritePlaceFooter(md)
}

function ShowPlace113() {
	var md = WritePlaceHeader();
	var perJ = findPerson("JanetKelly");
	perJ.showPerson("janet2.jpg");
	addPlaceTitle(md, "Janet Under a Spell");
	md.write("<p>Janet falls under the spell. She starts to say something, then trails off after the first word, and shakes her head.</p>" + '<p>She tries again and asks, "Do you want to take me upstairs?"</p>' + "<p>What she really means is obvious. Everything says it: her gasping breaths, her stance, her gaze.</p>");
	startQuestions();
	addLinkToPlace(md,
		"follow her up the stairs", 114);
	addOptionLink(md, "exit the house", "LeaveMinJanet(false)");
	WritePlaceFooter(md)
}

function ShowPlace114() {
	var md = WritePlaceHeader(false, "td-left-large");
	var perJ = findPerson("JanetKelly");
	perJ.showPerson("janet3.jpg");
	perJ.charmThem(4);
	addPlaceTitle(md, "Janet Under a Spell");
	md.write("<p>Janet doesn't get farther than the top of the stairs. She turns to face you again. " + "By now her excitement is evident to anyone and she says,</p>" + '<p>"Forget the bedroom!"</p>');
	startQuestions();
	if (perYou.checkFlag(26)) addLinkToPlaceC(md, '"You forget where your room is, don\'t you"', 115, "", "",
		"", "charmPerson('JanetKelly', 3);");
	addLinkToPlaceC(md, '"Yes, I want you now too!"', 115, "", "", "", "charmPerson('JanetKelly',2);");
	addLinkToPlace(md, "take her now", 115);
	WritePlaceFooter(md)
}

function ShowPlace115() {
	var md = WritePlaceHeader();
	var perJ = findPerson("JanetKelly");
	var clv = perJ.getCharmedLevel();
	var myName = perJ.getYourNameFor();
	perJ.showPerson("janet5.jpg");
	addPlaceTitle(md, "Janet Under a Spell");
	if (clv == 2) {
		md.write('<p>Passion overcomes the girl, causing her to fall to the ground. "Oh god!" she exclaims, holding the raging excitement in her stomach.</p>' + '<p>"I want you so much, and that you want me too is so <b>hot</b>" she says, the excitement building.</p>' + '<p>"Please make love to me ' +
			myName + '. I want you, I need you, so badly."</p>');
		startQuestions();
		addLinkToPlace(md, "make love to Janet", 116)
	} else if (clv == 3) {
		md.write('<p>Passion overcomes the girl, causing her to fall to the ground. "What do you mean...my room..."</p>' + '<p>You quickly interrupt her "You don\'t remember, your sister looked after these things for you. After all you are more interested in your appearance, in being sexy than smart."</p>' + "<p>She looks confused as the spell reinforces your words, and also as it seems they are at least in some part the truth. She tries to deny your words,</p>" +
			'<p>"Well I like looking good, but it is not like I am some sort of..."</p>' + '<p>Again you interrupt her "A bimbo...a beautiful sexy woman who knows what is important in life, looking good and pleasing others"</p>' + '<p>She looks at you, "A bimbo...well I love being sexy and how others look at me...I suppose you could call me that...yes...I am a bimbo!!"</p>');
		startQuestions();
		addLinkToPlace(md, "let your bimbo service you", 116)
	} else if (clv == 4) {
		md.write('<p>Passion overcomes the girl, causing her to fall to the ground. "Oh god!" she exclaims, holding the raging excitement in her stomach. "I feel like such a cheap slut, like <i>your</i> cheap slut, your whore, your... <i>slave</i>," she says, relishing the word as it rolls off her tongue.</p>' +
			'<p>"Please take me ' + myName + '. I want you, I need... to serve you, so badly."</p>');
		startQuestions();
		addLinkToPlace(md, "order your slave to serve you?", 116)
	}
	WritePlaceFooter(md)
}

function ShowPlace116() {
	var md = WritePlaceHeader(false, "td-left-large");
	var perJ = findPerson("JanetKelly");
	var clvJ = perJ.getCharmedLevel();
	var myName = perJ.getYourNameFor();
	var hJ = "";
	if (clvJ == 2) hJ = "your lover ";
	else if (clvJ == 3) hJ = "your bimbo ";
	else if (clvJ == 4) hJ = "your slave ";
	else if (clvJ == 5) hJ = "your pet ";
	var sJ = "order";
	if (clvJ == 2 || clvJ === 0) sJ = "ask";
	perJ.showPerson("janet6.jpg");
	addPlaceTitle(md, "Janet Under a Spell");
	if (clvJ == 2) md.write("<p>Janet sheds her clothes and embraces you willingly. You enjoy yourselves utterly.</p>" +
		"<p>Afterwards, she looks up at you happily. \"We're lovers, " + myName + '" she says declares.</p>');
	else if (clvJ == 3) md.write("<p>Janet sheds her clothes at your command and allows you to take her willingly. You enjoy yourself utterly.</p>" + "<p>Afterwards, she looks up at you happily. \"I'm like a bimbo, ain't I " + myName + '" she says smiling.</p>');
	else if (clvJ == 4) md.write("<p>Janet sheds her clothes at your command and allows you to take her willingly. You enjoy yourself utterly.</p>" + "<p>Afterwards, she looks up at you happily. \"I'm yours, " +
		myName + '. I belong to you now," she says again.</p>');
	startQuestions();
	if ((perJ.checkFlag(3) || perJ.checkFlag(4)) && !perJ.checkFlag(5)) addQuestionC(md, sJ + " " + hJ + "Janet to tell you about her ancestors", "JanetKelly", 6701);
	else if (perJ.checkFlag(5) && !perJ.checkFlag(6)) addQuestionC(md, sJ + " " + hJ + "Janet to tell you more about the warlock", "JanetKelly", 6702);
	addLinkToPlace(md, "go downstairs with Janet", 112);
	addLinkToPlace(md, "exit the house", 44);
	WritePlaceFooter(md)
}

function ShowPlace117() {
	var md = WritePlaceHeader();
	var perDebra = findPerson("DebraKelly");
	perDebra.showPersonDN("debra13a.jpg");
	addPlaceTitle(md, "Debra Under a Spell");
	md.write("<p>Debra falls under the spell, and she looks uncertain and speaks hesitantly,</p>" + '<p>"Woof..I mean what was that..you know ' + perYou.getPersonName() + " you really have some animal magnetism..no, no, no animals..I mean, why don't you cum..ah..");
	if (isDay()) md.write('come out here and join with..uh join me."</p><p>You answer, "Yes, I would love to cum out there with you".');
	else md.write('come with me in the TV room..uh join me."</p><p>You answer, "Yes, I would love to cum with you".');
	md.write(" As you approach you notice she is tugging on her clothing and the lower part of her dress rides up, exposing her lovely bottom. She smiles at you,</p>" + '<p>"So ' + perYou.getPersonName() + ' do you have a girlfriend?"</p>');
	startQuestions();
	addLinkToPlace(md, isDay() ? "join her outside" : "join her in the TV room", 118);
	WritePlaceFooter(md)
}

function ShowPlace118() {
	var md = WritePlaceHeader();
	var perDebra = findPerson("DebraKelly");
	perDebra.showPersonDN("debra13b.jpg");
	addPlaceTitle(md, "Debra Under a Spell");
	if (isDay()) md.write("<p>You step outside into the garden with Debra, and she looks at you very seductively. She has little on her mind except the arousal from the spell. She hesitantly says,</p>" + '<p>"Would you like to..pet..I mean kiss me?"</p>' + "<p>No reply is needed, you take her into your arms and kiss your new charming and charmed lover. Your embrace becomes more passionate and you make love to Debra on the garden wall. You wonder if the neighbours saw anything, but you do not care, Debra is now yours!</p>");
	else md.write("<p>You step into the partially furnished entertainment room with Debra, and she looks at you very seductively. She has little on her mind except the arousal from the spell. She hesitantly says,</p>" + '<p>"Would you like to..pet..I mean kiss me?"</p>' + "<p>No reply is needed, you take her into your arms and kiss your new charming and charmed lover. Your embrace becomes more passionate and you make love to Debra on the couch. You wonder if Janet was watching, but you do not care, Debra is now yours!</p>");
	startQuestions();
	addLinkToPlace(md, isDay() ? "return inside" : "return to Janet", 112);
	addLinkToPlace(md, "exit the house", 44);
	WritePlaceFooter(md)
}

function afterSexTracy(md, perMom) {
	if (perMom.extra[0] != -1)
		if (perMom.place == 154 && !perMom.checkFlag(28)) {
			if (perMom.extra[0] !== 0) {
				IncreaseMomsArousal(1);
				perMom.setFlag(28)
			}
			md.write("<p>At one time you are sure you heard the bedroom door close, maybe you left it accidentally open and it swung shut?</p>")
		}
	startQuestions();
	if (!isDay()) addPopupLink(md, "go to bed for the night with Tracy", "Going to Bed with Tracy", '</p><img src="Images/tracy11a.jpg" style="position:absolute;width:100%;bottom:0" alt="Tracy">' +
		'<p style="position:absolute;left:2%;top:2em;cursor:pointer;font-size:1.1em;width:66%">As you you lie with Tracy after your love making, she asks you a little nervously, "Why not spend the night..with me?". You cannot refuse your sister the way she is looking as she lies there next to you.', true, "WaitforForDayNight();gotoPlace(122,'type=breakfast');", false, undefined, "background-color:white;color:black;top:10%;left:5%;width:85%;height:80%;padding:0")
}

function ShowPlace122(stype) {
	var md;
	var perTracy = findPerson("Tracy");
	var perMom = findPerson("Mom");
	var perTanika = findPerson("MrsTanika");
	var perTess = findPerson("Tess");
	var perAnita = findPerson("Anita");
	if (stype == "breakfast") {
		md = WritePlaceHeader();
		perTracy.showPerson("tracy-breakfast1.jpg");
		addPlaceTitle(md, "Breakfast with Tracy");
		md.write("<p>In the morning you wake in Tracy's arms and kiss her. Sometime later, you have a light breakfast with her in her room, chatting and joking around.");
		startQuestions()
	} else if (stype ==
		"charm") {
		md = WritePlaceHeader(false, perYou.isMaleSex() ? "td-left-med" : "");
		if (perYou.isMaleSex()) perTracy.showPersonRandom("tracy10b", 3);
		else if (isExplicit()) perTracy.showPersonRandomRorX("tracysex1g", 2);
		else perTracy.showPerson("tracysex1g.jpg");
		addPlaceTitle(md, "Making Love to Tracy");
		md.write("<p>You take Tracy's hand and lead her to her bedroom. She silently kisses you as she removes " + 'your clothing and what remains of hers. She whispers "We do not want Mom to interrupt"</p>' + "<p>You passionately make love to Tracy enjoying the forbidden fruit of your sister!</p>");
		if (perMom.extra[0] != -1) {
			md.write("<p>After, you do wonder at her words about your mother, do you really now want her to find out and get involved?");
			if (perMom.extra[0] !== 0) IncreaseMomsArousal(1, 4);
			else md.write(" The difficulty is you have no idea how to breach it with her, and using the charm spell...you are really unsure.");
			md.write("</p>");
			startQuestions();
			addLinkToPlaceC(md, '"Well...', 45, "", "As you leave Tracy&rsquo;s room you consider your mother and what to do");
			addLinkToPlaceC(md, '"No, she is my mother!"',
				45, "", "As you leave Tracy&rsquo;s room you reject the idea of anything involving your mother", "", "IncreaseMomsArousal(-1)")
		} else startQuestions()
	} else if (stype === "calltesssusan") {
		md = WritePlaceHeader();
		perTracy.showPerson("tracyfoursome1.jpg");
		addPlaceTitle(md, "Calling In Tess and Susan");
		md.write("<p>You tell Tracy to remain where she is and quickly go to your room to get Tess and Susan.</p>" + "<p>Tracy is, at first, not really keen on sharing you with other girls, especially Susan, and it takes you a bit of convincing to get her to open up to the idea. In the end, though, she is happy when you are happy, and even a little exited to be with Tess.</p>" +
			"<p>Tess happily embraces your sister, and after a brief moment of reluctance, the two share a tender kiss. It's more for your benefit than theirs, really, but you know the two get along well, and Tracy takes no small enjoyment out of slowly removing what little clothes Tess had on herself and expose the other woman's body to you.</p>");
		var clvT = perTanika.getCharmedLevel();
		if (clvT == 2) md.write("<p>You pull Susan into a warm embrace and gently drive one hand through her hair. Your usually oh so confident teacher is probably the most nervous woman in the room, but her doubts quickly melt away as you pull her into a deep kiss and assure her that she, too, will have a lot of fun, experience with other women or not. She quietly nods to you and steels herself as you help her remove the few clothes she is wearing and guide her towards the bed.</p>");
		else if (clvT == 3 || clvT == 4) md.write("<p>You take a hold of Susan's hair and pull her near you, your lips close to her ear as you once again remind her of her place: She is here to provide entertainment for you and your sister, a " + (clvT == 4 ? "slave" : "Fucktoy") + " who is using her tongue, hands and pussy to fulfill others desires, and should be thankful when her own are met in the process.</p>" + "<p>Susan shivers in your arms with every whispered word, and her spellbound mind happily accepts everything you tell her. She reassures you of her love and loyalty several times as she takes off her clothes, and demurely waits for your permission to join in as you move towards the bed.</p>");
		md.write("<p>The four of you use the next hour to explore each others bodies. Skin touching skin, lips trading tender kisses, sensual moans and the scent of arousal slowly filling the room every passing minute.</p>" + "<p>Tracy and Tess are mostly focused on you, but it doesn't take a lot to get them to enjoy each others attention as well, and under your guidance, Tess makes your sister climax more than once.</p>");
		if (clvT == 2) md.write("<p>You even get to see Tracy trade kisses with Susan, to your surprise. Your teacher is very eager to make sure both you and your sister, as well as Tess are left satisfied, and after a bit of motivating, Tracy helps you return the favor.</p>");
		else md.write("<p>Susan is reluctant to take initiative without permission, but you make sure that your " + (clvT == 4 ? "slave" : "Fucktoy") + " is making " + (clvT == 4 ? "herself" : "itself") + " useful. You guide her to please both Tess and Tracy, occasionally slapping her rear or pushing her face forward into someones crotch.</p>" + "<p>To your surprise, Tracy actually chastises you at one point for treating her that way and you had to tone it down a bit. You had expected her to be more eager to take revenge on the hated teacher as well, but ultimately, she is just a far too nice person, not that you don't love her for it.</p>");
		md.write("<p>At the end, all for of you are entangled in each others arms, exhausted from the pleasure and several orgasms, but blissfully happy.</p>");
		afterSexTracy(md, perMom)
	} else if (stype === "callanita") {
		md = WritePlaceHeader(false, isExplicit() ? "" : "td-left-med");
		perTracy.showPersonRorX("tracyanita1.jpg");
		addPlaceTitle(md, "Calling In Anita");
		var sibling = perYou.isBornMale() ? "brother" : "sister";
		md.write("<p>\u201cCommander! Ma'am!\u201d Anita is quick to enter the room as you call for her, and salutes both you and Tracy, who barely noticeably rolls her eyes back. \u201cYou require my assistance?\u201d</p>" +
			"<p>\u201cIndeed!\u201d You move both arms behind your back and lift your chin. \u201cSubcommander Tracy intents to give her " + sibling + " a blowjob, and your duty is to assist her.\u201d</p>" + "<p>A few seconds pass in which Tracy's eyes now very visibly roll back and Anita seems to asses if this is really an appropriate order to give, and of course her conclusion is: Absolutely!</p>" + "<p>The two shove each other around somewhat as they knee down before you. Tracy usually gets along with everyone, but she can be a little jealous if she has to share her " +
			sibling + "s cock, and Anita is just too headstrong to give up any space, but after some tense, wordless negotiating, and you opening your pants to give them something else to focus on, the little dispute is quickly forgotten.</p>" + "<p>The two trap your manhood between their lips and you enjoy the sensation of their tongues immensely as both of them leave trails of saliva all over your sensitive skin and playfully circle around the tip to lap up any spurts of precum.</p>" + "<p>They both try to take you into their mouth simultaneously, but this time, Anita backs away to let Tracy go first, and you enjoy the warm wetness of her mouth for a few moments before she passes you on to Anita.</p>" +
			"<p>See? They can get along.</p>" + "<p>The two girls now take turns tending to you, and when one pair of lips wraps around your shaft, the other quickly moves to the base or plays with your scrotum to assist.</p>" + "<p>You try to hold your climax back to savor the sight and sensations just a little longer, but Tracy is, as usual, only encouraged as she notices it, and Anita simply follows her lead, so it's only a matter of time until you have to pull your shaft from their lips and spray your seed onto both faces with a loud groan.</p>" +
			"<p>You take a moment to catch your bearings after that, and order Anita to clean Tracy's face with her tongue, before you send her back to guard the door.</p>");
		afterSexTracy(md, perMom)
	} else if (stype === "taste") {
		md = WritePlaceHeader();
		perTracy.showPerson(perYou.isMaleSex() ? "tracysex2b.jpg" : "tracysex2g.jpg");
		addPlaceTitle(md, "Tasting Tracy");
		md.write("<p>Tracy has been really good to you, so it's only fair that you repay some of it.</p>" + "<p>You tell her to remain where she is and slip onto the bed, slowly moving closer to her and spreading her legs.</p>" +
			"<p>Tracy gasps as you drag your tongue along her folds and flick it over her little nub, and you proceed to caress her tights, slide your fingertips to her side and tenderly drag them over her stomach and back down, each motion making her shiver in delight.</p>" + "<p>When you push the first fingers inside her, she is already delightfully wet, and you hear a lewd moan from your sisters lips, the moment you begin to move them.</p>" + "<p>Tracy hastily stifles the noise as good as she is able to while your fingers begin to seek her most sensitive spots and your lips wrap around her clit.</p>" +
			"<p>There is another series of sensual moans from her, muffled this time, but audible nevertheless as you flick four tongue along her jewel, playfully circling it and occasionally sucking it in-between your lips and letting it plop free, and each little motion makes her body twitch and wind itself on the bed.</p>" + "<p>As her climax draws closer, she finds it visibly harder to hold back, you feel one of her hand sliding over your head, briefly before she slams it onto the bed and digs her fingers into her sheets while she presses her other hand firmly on her lips, and as she finally reaches her peak, her body arches through in a blissful shudder, desperate to not make too much noise but clearly enjoying every second of it.</p>");
		afterSexTracy(md, perMom)
	} else if (stype === "makelove") {
		md = WritePlaceHeader(false, perYou.isMaleSex() ? "td-left-med" : "");
		if (!perYou.isMaleSex()) perTracy.showPersonRandom("tracy10g", 2);
		else perTracy.showPersonRandom("tracy10b", 3);
		addPlaceTitle(md, "Making Love to Tracy");
		if (!perYou.isMaleSex()) md.write("<p>You crawl onto the bed and on top of Tracy and press your lips to hers to share a long, tender Kiss. You enjoy the sensation of her warm body pressed against yours, your tongues dancing passionately and her fingertips caressing your back.</p>" +
			"<p>Deep within you, both of you know that what you do is frowned upon, but that only drives you further, makes it all the more exciting to taste the forbidden fruit before you and share those tender moments with your beloved big sister.</p>" + "<p>Tracy gasps as you break the kiss and rolls her head back to breath in while your own lips wander down, nibbling on her neck and collarbone, gently biting into her shoulder and flicking your tongue over her nipples. Each motion is drawing another sensual noise from her lips, you caress her breasts, slide your fingertips over her sides, and finally spread your legs to expose her damp nether lips.</p>" +
			"<p>The is a brief pause where the two of you look into each others eyes before you press your folds against hers and slowly begin to grind back and forth.</p>" + "<p>It's easy to get lost in the moment as the minutes fly by. You begin to increase the speed of your thrusts, adjusting them to make sure to stimulate her clit while your hands caress her body, and more than once, both of you need to find a way to muffle the others moans as you push closer to your peak.</p>" + "<p>When the moment comes, your lips touch one last time for a deep kiss as your orgasms rush through your bodies. Muffled moans filling the room and quickly dying down as the intense sensations subside.</p>" +
			"<p>You stay with your sister and hold her in your arms a little longer to feel her warmth. Yes, what you do might be forbidden, but it feels damn good.</p>");
		else md.write("<p>Taking your sister's hand both of you walk into her bedroom. Letting you enter first, she closes the door before she walks up to you and wraps her arms around your neck. \u201cWe don't want Mom to interrupt,\u201d she smiles before she kisses you. Her lips part as the tip of her tongue brushes across your lips. Coaxing your tongue out she groans as she continues to passionate embrace. Her crotch rubbing up against your cock as she reaches down to pull up your shirt.</p>" +
			"<p>Tracy's lips break the kiss to pull your shirt overhead, quickly pressing themselves into your chest. She continues to tease you with the occasional brushing of her tongue against your flesh. Her natural drive to be 'in charge' quickly exploding in her mind, but the goal is far different. Her 'in charge' mentality focused solely on your pleasure. To show her brother how she loves him like the man that he is! Her desire mixing into the taboo scenario she finds herself in under the control of your spell only drives her further.</p>" +
			"<p>Her lavished attentions are broken for a moment as she takes off her own top. Her chin cocks downward and she coyly looks at you as she reaches behind to to unfasten her bra, \u201cI want to feel you cum inside me, " + perYou.getPersonName() + ". I want you to cum inside your sister and lover.\u201d</p>" + "<p>Tracy turns around and bends over. She stares back at you, her hair cascading over her face as she begins to lower her panties and show you her pussy. Without hesitation you take off your own pants but are denied the instant gratification of plunging into your sister. Darling Tracy has other ideas as she turns back around to face you.</p>" +
			"<p>You have only your spell and the manipulations you applied to your sister to blame for this, but given the situation can you really complain? Her voice is low and seductive as she commands you, \u201cLay back on the bed. I want you to see my face while we make love.\u201d Her slender fingers gently push you back onto the bed before she climbs on top of you. All you can do is admire the view as she naturally takes control of the situation. Her hands reaching down to guide your cock into her awaiting hole.</p>" +
			"<p>As the head of your cock slides into her she gasps as her head leans back, \u201cOh god you feel so good inside of me. Only my brother could fill me so completely. I will always be your lover.\u201d Slowly she grinds herself against your crotch, staring down at you. She leans down and whispers into your ear, \u201cI don't want Mom to come in and ruin our fun, " + perYou.getPersonName() + ". Just let me take care of you.\u201d</p>" + "<p>She reacts sensually to you, embracing in passionate kisses as she gradually begins sliding herself along the length of your cock. At other times she stares down at you as she slowly works your cock with her pussy. She wants you to see her as your lover and you as her lover. Her hips slowly rock to from side to side and she impales herself upon your length, working her body in a slow and tender manner for your mutual pleasure.</p>" +
			"<p>She leans forward and thrusts her tongue into your mouth as she moans deeply. Her body shudders from her orgasm, yet she doesn't pause in her manipulations upon you. Within moments her her second you feel your own body react as your cum explodes into her awaiting pussy. The warm sensation flowing into her causing her to gasp as she stares down at you, \u201cOh god yes, cum inside your sister, " + perYou.getPersonName() + ".\u201d</p>" + "<p>As your orgasm subsides she kisses you once more before nuzzling against you. Her lips lightly kissing your chest as she basks in the wonderful sensation of your lovemaking. As your cock slowly shrinks inside of her she smiles, \u201cI love you, my little brother.\u201d</p>");
		afterSexTracy(md, perMom)
	} else if (stype === "bj") {
		md = WritePlaceHeader();
		if (isExplicit()) perTracy.showPersonRandomRorX(perYou.isMaleSex() ? "tracysex1b" : "tracysex1g", 2);
		else perTracy.showPerson(perYou.isMaleSex() ? "tracysex1b.jpg" : "tracysex1g.jpg");
		addPlaceTitle(md, "Tracy's Tongue");
		if (perYou.isMaleSex()) md.write("<p>Your body always tingles all over when you are so close to your sister, the risk of being discovered, the rush of adrenaline knowing you are doing something very forbidden, the intoxicating sensation of her body pressed against yours, her heart racing as you look into each others eyes, and finally the small explosion of electricity when you share the first kiss of the day.</p>" +
			"<p>Tracy is a good kisser, you had suspected it for a long time, but feeling her tongue playfully intermingle with yours, brushing over your lips only to suddenly pull back... it's something else.</p>" + "<p>Tracy wordlessly looks into your eyes after the kiss, and as you try to say something, she  shushes you by placing a finger to your lips with a playful grin.</p>" + "<p>Her lips briefly brush over yours again before she slides of the bed, motions for you to spread your legs, and begins to slowly caress  your manhood.</p>" +
			"<p>You hum softly as Tracy's lips touch your shaft and watch her tongue trail up along the entire length.</p>" + "<p>Tracy rarely breaks eye contact as she takes your manhood into her hand and begins to move it to her mouth, playfully licking around the tip before she guides it past her lips.</p>" + "<p>You look down to your sister and caress her cheek while her head rolls back and forth, her eyes still lovingly focused on yours while your cock slips in and out of her mouth. It's quite a sight and almost enough to get you close to climax by itself, but the sensation of her soft lips sliding over you certainly helps.</p>" +
			"<p>As she feels your peak approaching, she pulls back and begins to stroke your shaft in quick, rapid motions to push you over the edge, making sure you get a good look of your cum falling on her face.</p>");
		else md.write("<p>Your body always tingles all over when you are so close to your sister, the risk of being discovered, the rush of adrenaline knowing you are doing something very forbidden, the intoxicating sensation of her body pressed against yours, her heart racing as you look into each others eyes, and finally the small explosion of electricity when you share the first kiss of the day.</p>" +
			"<p>Tracy is a good kisser, you had suspected it for a long time, but feeling her tongue playfully intermingle with yours, brushing over your lips only to suddenly pull back... it's something else.</p>" + "<p>Tracy wordlessly looks into your eyes after the kiss, and as you try to say something, she  shushes you by placing a finger to your lips with a playful grin.</p>" + "<p>Her lips briefly brush over yours again before she slides of the bed, motions for you to spread your legs, and places a finger on your clit while using her other hand to spread your folds.</p>" +
			"<p>You bite your lower lip to muffle a moan as Tracy begins to caress your sensitive parts and she motions you to be quiet as her fingers move deeper inside to your wetness.</p>" + "<p>Your big sister doesn't take long to find your most sensitive spots, teasing them with her fingertips and using her tongue to tickle your clit, every second making it harder to stifle your voice, harder to focus on being quiet instead of just letting it all out.</p>" + "<p>As you reach your peak, you have to place one hand to your mouth to suppress your moans, and Tracy happily watches you as your body tenses up under the intense sensations.</p>" +
			"<p>As the feelings subside, you let yourself fall back on the bed ans Tracy quietly crawls into your arms, sharing some of her experience with another kiss.</p>");
		afterSexTracy(md, perMom)
	} else if (stype === "") {
		md = WritePlaceHeader();
		perTracy.showPerson("tracy16.jpg");
		addPlaceTitle(md, "Making Love to Tracy");
		md.write("<p>You guide Tracy into her room and the two of you silently kiss as she removes your clothes and what little remains of hers.</p>" + "<p>\u201cLet's be quiet.\u201d She whispers conspiratorially. \u201cWe do not want mom to interrupt.\u201d</p>" +
			"<p>You nod, quickly close the door, and as you turn around, your sister is already on the bed, her eyes on you as she seductively licks her fingers.</p>");
		if (perMom.place != 154) md.write("<p>You don't really have to be all that secretive anymore as long as you are in your own home, but you admit it is part of the appeal.</p>");
		startQuestions();
		addLinkToPlace(md, "make love to Tracy", 122, "type=makelove");
		addLinkToPlace(md, "enjoy your sister's tongue", 122, "type=bj");
		addLinkToPlace(md, "taste your sister",
			122, "type=taste");
		if (perTess.isCharmedBy() && perTess.whereNow() == 46 && perTanika.isCharmedBy() && perTanika.whereNow() == 46) addLinkToPlace(md, "call in Tess and Susan", 122, "type=calltesssusan");
		if (perYou.isMaleSex() && perAnita.isCharmedBy() && perAnita.whereNow() == 46) addLinkToPlace(md, "call in Anita", 122, "type=callanita");
		if (!isDay()) addPopupLink(md, "go to bed for the night with Tracy", "Going to Bed with Tracy", '</p><img src="Images/tracy11a.jpg" style="position:absolute;width:100%;bottom:0" alt="Tracy">' +
			'<p style="position:absolute;left:2%;top:2em;cursor:pointer;font-size:1.1em;width:66%">As you you lie with Tracy after your love making, she asks you a little nervously, "Why not spend the night..with me?". You cannot refuse your sister the way she is looking as she lies there next to you.', true, "WaitforForDayNight();gotoPlace(122,'type=breakfast');", false, undefined, "background-color:white;color:black;top:10%;left:5%;width:85%;height:80%;padding:0")
	}
	addLinkToPlace(md, "go to the kitchen", 45);
	addLinkToPlace(md,
		"go to your bedroom", 46);
	addLinkToPlace(md, "exit the house", 44);
	WritePlaceFooter(md)
}

function ShowPlace123() {
	var md = WritePlaceHeader();
	addPlaceTitle(md, "Broken Inn Hotel", "hotel1.jpg", 75);
	md.write("<p>The reputed establishment of the darkest hour of Glenvale, " + "the Broken Inn Hotel was once ruled by the tyrant Carl Kurndorf. There is a rumour " + "around town that the cellar is haunted by Kurndorf since " + "his bloody death in the early hours of a grim September morning. " + "From the exterior the building looks friendly enough and most of the tourists prefer to stay in the old style accommodation.</p>");
	if (!isPlaceKnown("Hotel")) setPlaceKnown("Hotel");
	startQuestions();
	addLinkToPlace(md, "enter the Hotel", 124);
	if (isPlaceKnown("RathdownRd")) addLinkToPlace(md, "walk to Rathdown Road", 229);
	if (isPlaceKnown("Graveyard")) addLinkToPlace(md, "walk to the Graveyard", 325);
	addLinkToPlace(md, "walk to the Town Hall", 94);
	WritePlaceFooter(md)
}

function KateConfrontsDavy() {
	var perKate = findPerson("Kate");
	if (!perKate.checkFlag(17)) {
		perKate.place = 184;
		if (sComment !== "") WriteComments("<p>Kate is gone, you assume to confront Davy</p>")
	}
}

function ShowPlace124(stype) {
	var md = WritePlaceHeader(false, stype == "bambichat1" ? "" : "td-left-small");
	var perM = findPerson("Monique");
	var perB = findPerson("Bambi");
	var perMia = findPerson("Mia");
	var perTess = findPerson("Tess");
	var perKate = findPerson("Kate");
	var perJessica = findPerson("Jessica");
	var perDonna = findPerson("Donna");
	var perLauren = findPerson("Lauren");
	var perBarPerson = perB.isHere() ? perB : perMia.isHere() ? perMia : undefined;
	if (perM.place === 8 && perDavy.place === 124 && perM.charmed > 4 && !checkPlaceFlag("Hotel",
			8)) perM.place = 124;
	addPlaceTitle(md, "Hotel Bar", "hotel2.jpg");
	if (perBarPerson === undefined) md.write("<p>Currently there is no-one manning the bar, but there are still a few patrons at the bar.</p><p>");
	if (perJesse.place === 0)
		if (isNight()) {
			if (perJesse.checkFlag(10)) md.write("It looks like Jesse must have gone to bed, she is not around that you can see. ")
		} else if (!perJesse.checkFlag(10)) md.write("One of the patrons, a girl with a bored expression and an innocent look about her, watches you enter. She looks kind of interested as you walk past. ");
	else if (perJesse.checkFlag(10)) md.write("Jesse looks kind of bored, sitting in the corner all alone. Even given the way she is dressed you can't shake your impression of her as just another innocent little girl. ");
	if (perDavy.place == 124) md.write("To your surprise, Davy Robbins is sitting alone at the farthest table. He is keeping to himself and does not look like he wants company. ");
	if (perM.place == 124) md.write("Monique is sitting in the corner. She beckons you over and, from the way she lifts her skirt hem, it is obvious that she is still under your control... and still reveling in her newfound slavery. ");
	if (perTess.place == 124) md.write("Mrs. Adams, wearing a cheerleader outfit, is seated at the bar and beckons you over. She may have found something of interest. ");
	if (perKate.place == 124) md.write("Kate is here heading for the hotel rooms intent on her revenge on Davy.");
	md.write("</p>");
	startQuestions();
	var s;
	if (perDavy.place == 124) {
		s = "";
		var sj = "";
		if (perM.place != 124 && !checkPlaceFlag("Hotel", 8)) {
			s = " You also think, there must be something important in the cellar here, if it still exists. You need to see if you can locate more recent sets of plans for the Broken Inn Hotel.";
			sj = ';setPlaceFlag("Hotel",8)'
		}
		addPopupLinkC(md, "talk to Davy Robbins", "Davy Robbins", "<img src='Images/door5.jpg' style='width:25%;float:right' alt='Door'>" + "You approach Davy to try to confront him about events, and as you approach you see he is looking at an old drawing of the hotel, with an area that looks like a cellar circled with the word 'witch!'. " + "As you approach he quickly puts it away and tries to make his getaway.<br><br>" + '<b>"Get away from me, ' + perYou.getPersonName() + '!"</b> Davy yells then runs out the door into the street.<br><br>' +
			"As he leaves you keep thinking, why is he so <b><i>terrified</i></b> of you? Sure you are rivals but you have not done anything to him. Davy is a smart but careful person by nature, not a coward, just cautious." + s, true, "perDavy.other=7;perDavy.place=1000" + sj + ";dispPlace()")
	}
	if (perM.place == 124) addQuestionC(md, "talk to Monique", "Monique", 307);
	if (perBarPerson !== undefined) {
		if (perBarPerson.other > 0) addQuestionC(md, "tell " + perBarPerson.getPersonName(true) + ' "I\'d like a scotch on the rocks, please."', perBarPerson.uid,
			10801);
		if (perBarPerson.isCharmedBy())
			if (!isDay() && !isPlaceKnown("DonnasRoom") && perDonna.isCharmedBy()) addPopupLinkC(md, "ask where is Donna's room", "Donna", "<img src='Images/donna-hotel1.jpg' style='width:37%;float:right;margin-left:5px' alt='Donna'>" + "You make your way into the Hotel and as you head to the bar where " + perBarPerson.getPersonName(true) + " is attending the customers you are greeted by Donna. Her face shines when she sees you and her face is mixed with joy and seriousness.<br><br>" + '"' +
				perYou.getPersonName() + '! Where the hell have you been? I haven\u2019t seen you for a long time!", you hear worry and playfullness. She clearly knows you are busy, but she is happy whenever you visit the Hotel.<br><br>' + '"I\u2019ve been having fun! You see, I turned some hot women into my slaves and have them bend over and fuck them regularly!", you joke. You wink at ' + perBarPerson.getPersonName(true) + " who blows a kiss to your direction and continues her work.<br><br>" + '"Ohh You little ' + (perYou.isBornMale() ?
					"bastard" : "bitch") + '! That\u2019s why you don\u2019t visit! You are occupied by having your hands buried in pussy all the time!", Donna slaps your back while laughing. It\u2019s good to see her again! She\u2019s not stiff as your slaves who would never say such things. They would rather die than to offend you in the slightest bit.<br><br>' + '"Yep, it would be a perfect life, but there are some complications that annoy me. Like, there are people who want to destroy me\u2026.", you tell your tale in five minutes becoming a bit sentimental in the process. You mention Kurndorf and your beef with Davy. Donna listens like a good puppy, her mood shifts from cheerful to grave in a second. After you are finished, she grabs your hand and leads you to the stairs where her hotel room is.<br><br>' +
				'"I know what you need! A good striptease to kill those bad things in your head!", she smiles wickedly.<br><br>', false, "gotoPlace(185,'type=strip1')");
		if (perDavy.other == 10 && perDavy.getQuestBlueBottle() > 0 && perKate.place != 124 && !isDavyDefeated() && perKurndorf.getQuestSeance() >= 50) addQuestionC(md, '"Have you seen Davy Robbins recently?"', perBarPerson.uid, 6010);
		if (isConspiracyPath() && !perB.checkFlag(5) && perLauren.checkFlag(10) && perLauren.place != 269) addQuestionC(md, '"Do you have any fine wine?"', perBarPerson.uid,
			1E3)
	}
	if (perTess.place == 124) {
		if (perTess.other == 13) addQuestionC(md, 'ask Tess "Have you found anything I\'d be interested in?"', "Tess", 2013);
		if (perTess.other == 14) addQuestionC(md, "take Tess to a private room to discuss what she found", "Tess", 2014)
	}
	if (perKate.place == 124) {
		startTimedEvent("KateConfrontsDavy()", 1);
		perDavy.place = 184;
		addLinkToPlace(md, "stop Kate and work out a plan", 184, "type=plan", "", "", "setPersonFlag('Kate',17);")
	}
	if (perJesse.place == 8) addOptionLink(md, "go to Room 113", "GoRoom113()");
	else if (isDemonQuestDone()) addOptionLink(md,
		"go to Room 113", "GoRoom113()");
	if (perDavy.place == 184) addLinkToPlace(md, "go to Room 101", 184);
	if (isPlaceKnown("DonnasRoom")) addLinkToPlace(md, "go to Donna's room", 185);
	if (checkPlaceFlag("Hotel", 12)) addLinkToPlace(md, "go to Room 205", 181);
	if (checkPlaceFlag("Hotel", 10)) addLinkToPlace(md, "go down the stairs to the cellar", 161);
	addLinkToPlace(md, "go to the hotel pool", 269);
	addLinkToPlace(md, "exit the hotel", 123);
	if (perB.isHere() || perMia.isHere() || perJesse.place === 0 && !isNight() || perDavy.place == 124 || perM.place ==
		124 || perTess.place == 124 || perKate.place == 124) {
		AddPeopleColumn();
		if (perB.isHere()) {
			var be = perB.checkFlag(16) ? "-be" : "";
			if (!perB.isCharmedBy()) perB.showPerson("bambi8.jpg", "100%", "", "bambi11a.jpg");
			else perB.showPerson("bambi9.jpg", "100%", "", "bambi11b" + be + ".jpg")
		} else if (perMia.isHere())
			if (!perMia.isCharmedBy()) perMia.showPerson("mia-face.jpg", "100%");
			else perMia.showPerson("mia-facec.jpg", "100%");
		if (perJesse.place === 0 && !isNight()) perJesse.showPerson("jesse1b.jpg", "100%", "", "jesse1.jpg");
		if (perDavy.place ==
			124) perDavy.showPersonFace("100%");
		if (perM.place == 124) perM.showPersonFace("100%");
		if (perTess.place == 124) perTess.showPersonFace("100%");
		if (perKate.place == 124) perKate.showPerson("kate5.jpg", "100%")
	}
	WritePlaceFooter(md)
}

function ShowPlace125() {
	var md = WritePlaceHeader();
	var perBambi = findPerson("Bambi");
	var bBambiCharmed = perBambi.isCharmedBy();
	if (!perDavy.checkFlag(2)) {
		nMoney = nMoney > 0 ? 0 : nMoney;
		AddCash(0);
		perDavy.setFlag(2);
		if (perDavy.getPathHellgate() === 0) perDavy.setPathHellgate(1);
		showPopupWindow("", "::THUD:: Did someone get the license number of that TRUCK!?!", "")
	}
	if (bBambiCharmed) perBambi.showPerson("bambi9.jpg");
	else addPlaceImage(md, "hotel5.jpg", "", "", "Hotel Room");
	if (bBambiCharmed) {
		var myName = perBambi.getYourNameFor();
		addPlaceTitle(md, "Waking up in Bambi's Arms");
		md.write("<p>You hear the soft voice of your slave Bambi as she caresses your head.</p>" + '<p>"There, there, ' + myName + '," She says, concern in your voice.  "I was about to call an ambulance, are you alright?"</p>')
	} else addPlaceTitle(md, "Waking up in an empty room");
	md.write("<p>Your head is throbbing and you are fairly sure that there is a very large <i>bump</i> on the back of your head for a while.</p>" + "<p>Evidently Kate made good on her threat.  <i>Man she can hit hard!</i> You think to yourself.</p>" +
		"<p>A few moments later you realize Kate did more than just sock you with a book...  it would seem she liberated your cash from your pocket before she left.</p>" + "<p><i>Either that, or Davy did.</i> You think, realizing that Davy is no longer in the room either.</p>");
	startQuestions();
	if (bBambiCharmed) addLinkToPlace(md, "take Bambi to her room for a little <i>tender loving care</i>", 182);
	addLinkToPlace(md, "head back to the Hotel Bar", 124);
	WritePlaceFooter(md)
}

function ShowPlace126() {
	var md = WritePlaceHeader();
	findPerson("OfficerKhan");
	if (isMurderPath()) {
		per.other = 12;
		PlaceI(9, 65)
	}
	if (isBritish()) per.showPerson("UK/pol4.jpg");
	else per.showPerson(isMurderPath() ? "Setting/pol4m.jpg" : "Setting/pol4c.jpg");
	addPlaceTitle(md, getOfficer() + " Khan Under a Spell");
	md.write("<p>You cast the charm spell on the " + getOfficer(false) + ". She is confused by the new sensations " + "pulsing through her body, making her think of thoughts " + "that defy her normally rather conservative sensibilities.</p>" +
		"<p>&quot;You are acting very suspiciously,&quot; " + "she says in a tone suddenly quite lacking authority. " + "&quot;What is your full name and address?&quot;</p>" + "<p>&quot; " + perYou.getPersonName() + ", and I live on " + "Kollam Street. What is your name, " + getOfficer(false) + "?&quot; you ask with a smile</p>" + "<p>The policewoman resists for a moment before confessing, " + "&quot;Cheryl. Cheryl Khan. You shouldn't ask me the questions. I am in charge here.&quot;</p>" + "<p>&quot;Whatever you say " + getOfficer() +
		" Khan.&quot;</p>");
	startQuestions();
	if (isMurderPath()) {
		addLinkToPlace(md, "wait for the spell to take effect", 127);
		addLinkToPlace(md, "exit " + perGates.getPersonNameShort() + "'s estate?", 16)
	} else {
		addLinkToPlace(md, "wait for the spell to take effect", 127);
		addLinkToPlace(md, "exit the ward", 214)
	}
	WritePlaceFooter(md)
}

function ShowPlace127() {
	var md = WritePlaceHeader();
	findPerson("OfficerKhan");
	if (isBritish()) per.showPerson("UK/pol5.jpg");
	else per.showPerson(isMurderPath() ? "Setting/pol5m.jpg" : "Setting/pol5c.jpg");
	addPlaceTitle(md, getOfficer() + " Khan Under a Spell");
	md.write("<p>" + getOfficer() + " Khan turns away, steadying herself against " + (isMurderPath() ? "Gate's" : "a") + " desk.  When she turns back her eyes are glassy." + '"I am in charge and... you are... uhm... under arrest. Yes. We are going to the police station to..." Khan trails off, lost.' +
		"Oh! I have to handcuff you so that we could... I am in charge of this situation!  Please believe me " + perYou.getPersonName() + ". I'm not a ");
	if (perYou.isBornMale()) md.write("whore");
	else md.write("lesbian");
	md.write(', who fucks her suspects."</p>' + "<p>Watching the waves of desire wash through " + getOfficer() + " Khan amuses you. You tease her, \"I didn't say anything about screwing, " + getOfficer(false) + '. Who do you want to screw?"</p>' + "<p>Khan's whole body shifts, as she loses ground against your magical compulsion. \"I... Nobody. I don't want to screw anybody. Now, spread your legs.  I need to frisk you to...  uh...  make sure you don't have any weapons.\"</p>");
	startQuestions();
	addLinkToPlace(md, "obey the " + getOfficer() + "?", 128);
	WritePlaceFooter(md)
}

function ShowPlace128() {
	var md = WritePlaceHeader();
	var perOK = findPerson("OfficerKhan");
	if (perYou.isMaleSex()) perOK.showPersonRandomRorX("Setting/pol6b", isExplicit() ? isBritish() ? 2 : 3 : 1, "45vw");
	else if (isBritish()) perOK.showPersonRorX("Setting/pol6ga.jpg", "45vw");
	else if (isMurderPath()) perOK.showPersonRandomRorX("Setting/pol6g", 2, "30vw,45vw");
	else perOK.showPersonRorX("Setting/pol6gb.jpg", "45vw");
	addPlaceTitle(md, getOfficer() + " Khan Under a Spell");
	var myName = perYou.isBornMale() ? "handsome" : "beautiful";
	md.write("<p>You spread your legs.</p>" + "<p>Arousal crashes over " + getOfficer() + " Khan, causing her first climax as she runs her hands all over your body, tugging at your clothes.");
	if (perYou.isMaleSex()) md.write("<p>When your cock springs into view she loses all pretense that this is a normal frisk.  She looks up at you with lust in her eyes." + "<p>I order you to fuck my mouth, " + perYou.getPersonName() + ". Fuck it, make me your slut, your whore, your <i>slave</i>. I'll do anything you want me to do, just fuck my mouth.\"</p>");
	else md.write('<p>"Oh, you are so ' + myName + '" she confesses. She quickly tugs off her uniform. "I order you to screw me, ' + perYou.getPersonName() + ". Screw me so hard that I have to scream. Take me, make me your slut, your whore, your <i>slave</i>. I'll do anything you want me to do. Anything! Take me " + perYou.getMaster() + '. Please!"</p>');
	startQuestions();
	if (isMurderPath()) {
		addOptionLink(md, "enter " + perGates.getPersonNameShort() + "'s House", "EnterMansion()");
		addLinkToPlace(md, "exit the estate", 16)
	} else addLinkToPlace(md,
		"exit the ward", 214);
	WritePlaceFooter(md)
}

function ShowPlace129() {
	var md = WritePlaceHeader(true);
	AddImage("Setting/pol8.jpg");
	addPlaceTitle(md, getOfficer() + " Khan at " + perGates.getPersonName() + "'s Estate", "", 0, true);
	md.write("<p>" + getOfficer() + ' Khan stops you the door. "Oh ' + perYou.getMaster() + '," she gasps between deep breaths. "Please tell me what you want of me."</p>');
	startQuestions();
	addOptionLink(md, "enter " + perGates.getPersonNameShort() + "'s House", "EnterMansion()");
	addLinkToPlace(md, "exit " + perGates.getPersonNameShort() + "'s estate?",
		64);
	WritePlaceFooter(md)
}

function ShowPlace130() {
	var md = WritePlaceHeader();
	addPlaceTitle(md, "Mrs. Robbins' Bedroom", "bedroom10.jpg");
	if (wherePerson("Tina") != 130) md.write("<p>Mrs Robbins bedroom.</p>");
	startQuestions();
	if (!(isCharmedBy("MrsRobbins", "Davy") && !perYou.isBornMale())) addLinkToPlace(md, "exit the bedroom", 176);
	WritePlaceFooter(md)
}

function ShowPlace131() {
	var md = WritePlaceHeader();
	addPlaceTitle(md, "Dead " + perGates.getPersonName() + "'s House", perYourBody.FindItem(4) === 0 ? "gates4.jpg" : "gates3.jpg");
	if (getPersonCharm("OfficerKhan") < 2) md.write("<p>The rear of the house is tastefully decorated.  You can hear police working several rooms away, though they're not currently searching this portion of the building.");
	md.write("<p>The idea of Gate's body lying several rooms away give you the creeps.  Best not to linger long.</p>");
	startQuestions();
	if (getPersonCharm("OfficerKhan") < 2) addLinkToPlace(md, "return to the crime scene", 65);
	addLinkToPlace(md, "exit the house", 16);
	WritePlaceFooter(md)
}

function FindItCupboard(doc) {
	ResearchOLD("W", doc.FormChar.research.value)
}

function ShowPlace132() {
	if (isRunes()) {
		Research("Spell", "DertPher", "", 161);
		return
	}
	var md = WritePlaceHeader();
	addPlaceTitle(md, "Cupboard Spell", "cellar1.jpg");
	md.write('<form method="POST" name="FormChar">' + "<p>What is the meaning of wealth? Enter the correct words to find the spell:</p>" + '<p><input type="text" size="20" name="research">');
	md.write('<input type="button" name="button" value="please" onClick="FindItCupboard(document)"></p></form>');
	startQuestions("or give up for now");
	addLinkToPlace(md,
		"Never mind...", 161);
	WritePlaceFooter(md)
}

function ShowPlace133() {
	var md = WritePlaceHeader();
	var perBambi = findPerson("Bambi");
	if (perBambi.isCharmedBy()) return dispPlace(182);
	perBambi.showPerson("bambi1.jpg");
	addPlaceTitle(md, "Meeting Bambi");
	md.write("<p>The barmaid escorts you to her hotel room, then excuses herself to freshen up. When she returns she is the icon of beauty.</p>" + "<p>&quot;You have made the right decision, " + perYou.getPersonName() + "&quot; she says as softly as the wind. " + "&quot;Not many people in this town can afford my company, especially students.&quot;</p>" + "<p>You gulp. &quot;I think that I did as well Miss Bambi. Where do we start?&quot;</p>");
	startQuestions();
	addLinkToPlaceC(md, '"Do... do we make love now?"', 134);
	addLinkToPlace(md, "go to the hotel bar", 124);
	WritePlaceFooter(md)
}

function ShowPlace134() {
	var md = WritePlaceHeader();
	var perBambi = findPerson("Bambi");
	perBambi.showPerson("bambi2.jpg");
	addPlaceTitle(md, "Meeting Bambi");
	md.write("<p>Bambi seats herself beside you. Her legs are stunning and she blushes like a teenager. You can't " + "resist touching her feather-light shawl.</p>" + "<p>&quot;I think you misunderstood me, " + perYou.getPersonName() + "&quot; she says, her " + 'voice taking on a harder tone. "The one hundred ' + getCurrencyName() + " is for my company. It will cost you fifty more if you want more than a talk.&quot;</p>" +
		"<p>&quot;Fifty " + getCurrencyName() + "! You have to be kidding.&quot; For " + "the first time you see the cunning in the woman of your dreams.</p>" + "<p>&quot;Don't you think that I'm worth it?&quot; she " + "replies innocently. &quot;A " + perYou.getSex() + " of your means should not balk at giving a little cash.&quot;</p>");
	startQuestions();
	if (perBambi.other == 5 && nMoney >= 50) addQuestionCO(md, "hand over another " + sCurrency + "50", "Bambi", 10806);
	addLinkToPlace(md, "head back to the Hotel Bar", 124);
	WritePlaceFooter(md)
}

function ShowPlace135(stype) {
	var md = WritePlaceHeader();
	var perBambi = findPerson("Bambi");
	var perMonique = findPerson("Monique");
	if (perMonique.other < 10) {
		perMonique.other = 10;
		if (perMonique.isCharmedBy()) perMonique.place = 10
	}
	perBambi.showPerson("bambi3.jpg");
	addPlaceTitle(md, "Bambi Under a Spell");
	if (stype == "bar") md.write("<p>You follow the confused barmaid into the room, her body trembling as she removes some of her clothing.</p>" + '<p>Bambi\'s whole body begins to quiver and she turns to face you. "What...  What did you do to me?" she asks. "I have never felt this way for anyone before, man nor woman. ' +
		'"Please..." she shudders again, "Please, just give me the money so we can be... friends."</p>' + "<p>You shake your head at Bambi. \"I don't think so.  I don't really <i>need</i> to give you any money, now do I,\" you say");
	else md.write("<p>You cast the spell.</p>" + '<p>Already halfway to the door, Bambi\'s whole body begins to quiver. She stops, and turns to face you. "What...  What did you do to me?" she asks. "I have never felt this way for anyone before, man nor woman. ' + '"Please..." she shudders again, "Please, just give me the money so we can be... friends."</p>' +
		"<p>You shake your head at Bambi. \"I don't think so.  I don't really <i>need</i> to give you any money, now do I,\" you say");
	if (perBambi.checkAnyFlags(33, 34)) {
		var val = 100 + (perBambi.checkFlag(34) ? 50 : 0);
		md.write(", slipping the " + sCurrency + val + " you have already handed over back into your wallet");
		AddCash(val);
		perBambi.setFlag(33, false);
		perBambi.setFlag(34, false)
	}
	md.write('. "Soon you will be begging for me to take you, even offering yourself to me.  Free of charge."</p>' + "<p>\"I... I don't understand, " +
		perYou.getPersonName() + '" she says. "I have to have the money so that we can make love." Her eyes stray up and down your body as her hands begin caressing her own. "Please, just pay me so I can... I mean you... can get some release."</p>');
	startQuestions();
	addLinkToPlace(md, "wait for the spell to take hold", 136);
	addLinkToPlace(md, "go to the bar?", 124);
	WritePlaceFooter(md)
}

function ShowPlace136() {
	var md = WritePlaceHeader();
	findPerson("Bambi");
	per.charmThem(4);
	per.showPerson("bambi4.jpg");
	addPlaceTitle(md, "Bambi Under a Spell");
	md.write('<p>Bambi slides her top off. "I\'ll make you pay me," she says with a seductive grin. "You won\'t be able to resist once you see my body. Everybody wants to be with me."</p>' + "<p>The barmaid's demeanor begins to change before your eyes, her coyness rapidly being replaced by a low growl of sexual excitement. " + '"That\'s right," she says, almost hissing through her teeth. "You can have these. They are all yours if only you would allow it, ' +
		perYou.getPersonName() + '."</p>');
	startQuestions();
	addLinkToPlaceC(md, "tell Bambi to remove the rest of her clothes", 137);
	WritePlaceFooter(md)
}

function ShowPlace137() {
	var md = WritePlaceHeader();
	findPerson("Bambi");
	per.showPerson("bambi5.jpg");
	addPlaceTitle(md, "Bambi Under a Spell");
	md.write("<p>\"That's right, Bambi, take off your clothes. You belong to me now and I'm not going to pay a cent for you.\"</p>" + '<p>"Whatever you say," she replies. "I need it so bad ' + perYou.getPersonName() + ' I need you to fuck me. Please!"</p>');
	startQuestions();
	addLinkToPlace(md, "fuck Bambi", 138);
	WritePlaceFooter(md)
}

function ShowPlace138() {
	var md = WritePlaceHeader(false, perYou.isMaleSex() ? "" : "td-left-large");
	var perBambi = findPerson("Bambi");
	if (perYou.isMaleSex()) perBambi.showPersonRorX("bambi6b.jpg");
	else perBambi.showPersonRorX("bambi6g.jpg");
	var myName;
	if (isBritish()) myName = perYou.isBornMale() ? "Lord and Master" : "Lady and Mistress";
	else myName = perYou.getMaster();
	addPlaceTitle(md, "Bambi Under a Spell");
	md.write("<p>You take the barmaid into your arms, and she surrounds you with insatiable passion. Never before have you had sex so good as with this girl. There is the energy and enthusiasm of youth, the calm aged passion those in mid-life, but this... This is the skillful application of years of professional experience heightened by her newfound need to please you in any and every way she can imagine.  As you submit to her ministrations she confesses her love for you. Over, and over, and over. Finally you can take it no longer and collapse.</p>" +
		"<p>As you stare into her eyes you realize that her mind is now an open book for you to rewrite however you see fit.  Unable to resist the temptation, you begin to compose upon the creature before you.  To reshape it in your image...  of the perfect slave.</p>" + '<p>"Bambi, you are now my slave and I am your ' + myName + ".  You <i>belong</i> to me now.  You obey me without question, without hesitation.  Serving me is the most important thing in your life, more important than your life itself.  Your body and mind are mine to use however I see fit, so I will have you whenever I like.</p>" +
		'<p>You also love to help me enslave others.  Other than servicing me, nothing gives you more pleasure than providing me with another slave to serve me as you do."  You watch in fascination as your words become ultimate truth within the malleable mind before you.  Slowly her expression begins to change from a blank, accepting stare to a sly seductive grin.  You hold her chin up and look deeply into her completely enslaved eyes.  "Do you understand?"</p>');
	myName = perBambi.getYourNameFor();
	md.write('<p>She returns your question with unabashed adoration and all but purrs her answer into your ear. "Oh yes, ' +
		myName + ', perfectly.  Everything that I am is yours."  Then she continues with an evil little grin as she whispers, "Shall I inform you whenever a beautiful little tart decides to stay in the hotel, ' + myName + '?"</p>' + "<p>You just smile, quite pleased with yourself and your newest acquisition.  Then you swat her on the ass and send her back to work.  She seems disappointed at first, then realizes that to truly serve you best she must continue to work at the hotel bar and immediately brightens up.</p>");
	startQuestions();
	addLinkToPlace(md, "go to the bar?", 124);
	WritePlaceFooter(md)
}

function ShowPlace139(stype) {
	var md;
	var perKate = findPerson("Kate");
	var perMG = findPerson("MrsGranger");
	var clv = perKate.getCharmedLevel();
	var plcMG = perMG.whereNow();
	if (perKate.isCharmedBy("You") && clv == 2) {
		md = WritePlaceHeader();
		perKate.showPerson("kate-home-charmedlover1.jpg");
		addPlaceTitle(md, perKate.getPersonName() + " At Home");
		md.write("<p>Your charmed lover Kate is waiting for you on her bed.</p>");
		startQuestions();
		addLinkToPlace(md, "time for some foreplay with Kate", 139, "type=bedroomforeplay");
		addLinkToPlace(md,
			"skip that and make love with Kate", 139, "type=bedroomsex");
		addSleepLink(md, "go to bed for the night with Kate", "Sleeping with Kate", '<p style="position:absolute;left:2%;top:2em;cursor:pointer;font-size:1.1em;width:66%">You tell your lover that is it late and you wish to spend the night.', Math.random() < .5 ? "kate-home-charmedlover-bed1.jpg" : "kate-home-charmedlover-bed2.jpg", true)
	} else if (perKate.isCharmedBy("You")) {
		md = WritePlaceHeader(false, "td-left-med");
		perKate.showPerson("kate-home-charmedslave1.jpg");
		addPlaceTitle(md, perKate.getPersonName() + " At Home");
		md.write("<p>Your slave Kate is waiting for her " + perYou.getMaster() + " on her bed.</p>");
		startQuestions();
		addLinkToPlace(md, "have your slave pleasure you", 139, "type=bedroomforeplay");
		addLinkToPlace(md, "take your slave", 139, "type=bedroomsex");
		addSleepLink(md, "go to bed for the night with Kate", "Going to Bed with Kate", '<p style="position:absolute;left:2%;top:2em;cursor:pointer;font-size:1.1em;width:66%">You order your slave that is it late and you will spend the night.',
			"kate-home-charmedslave-bed1.jpg", true)
	} else if (perKate.checkFlag(22)) {
		md = WritePlaceHeader();
		perKate.showPerson("kate-home-lover1.jpg");
		addPlaceTitle(md, "Kate At Home");
		md.write("<p>Your girlfriend Kate greets you as you visit her room. She is not wearing too much, a smile and some underwear.</p>");
		startQuestions();
		if (!perKate.checkFlag(27) && perKate.checkFlag(15)) addQuestionR(md, "ask Kate for the necklace back", "You explain to Kate that now Davy is dealt with, you need the necklace back, and talk about strange supernatural encounters in the Sacred Grove. You are trying to give good reasons, but secretly is it that you want her as your slave?</p>" +
			'<p>Kate replies hesitantly, "Alright, as you say I am now safe from Davy"</p>' + "<p>She hands you back the necklace.", "", "setPersonFlag(\\'Kate\\',27);setPersonFlag(\\'Kate\\',15,false);per.DropItem(43,\\'You\\')");
		addLinkToPlace(md, "time for some foreplay with Kate", 139, "type=bedroomforeplay");
		addLinkToPlace(md, "skip that and make love with Kate", 139, "type=bedroomsex");
		addSleepLink(md, "ask Kate if you can sleep-over", "Sleeping with Kate", '<p style="position:absolute;left:2%;top:2em;cursor:pointer;font-size:1.1em;width:66%">You ask your lover Kate if you could spend the night',
			"kate-home-lover-bed1.jpg", true)
	} else if (perKate.checkFlag(23)) {
		md = WritePlaceHeader();
		if (getQueryParam("hypno") == "true") {
			perKate.showPerson("kate16e.jpg");
			addPlaceTitle(md, "Hypnotised Kate");
			md.write("<p>You touch Kate on her shoulder and use the magical hypnotic technique and instantly she falls into a trance. She shifts and sits down, and as she does your fingers catch on her top and her flimsy top slips off exposing her breasts. You wait for the pain, expecting her to beat you, but she seems to be firmly in the trance and does not respond.</p>" +
				"<p>For a time she is yours to convince or</p>");
			startQuestions();
			addQuestionR(md, "convince her you are trustworthy, and you love her", "You explain ernestly to the hypnotised Kate that you can be trusted and that you love her completely. You talk at length try to explain, but in the back of your mind you wonder if secretly is it that you want her as your slave?</p>" + '<p>I her trance Kate replies, "Yes...yes...you did so much, I love you too"</p>' + "<p>It is a strange thing to hear her confess love this way but it is hopefully enough",
				"", "setPersonFlag(\\'Kate\\',22);setPersonFlag(\\'Kate\\',23,false);setPersonFlag(\\'Kate\\',27,false)");
			if (perKate.checkFlag(15)) addQuestionR(md, "take the necklace back", "You carefully remove the necklace from Kate as you remind her it was only a loan, and talk about strange supernatural encounters in the Sacred Grove. You are trying to give good reasons, but secretly is it that you want her as your slave?</p>" + "<p>Kate hesitates but does nothing, and you tell her to not worry, things will be fine.</p>",
				"", "setPersonFlag(\\'Kate\\',15,false);per.DropItem(43,\\'You\\')");
			addLinkToPlace(md, "end the hypnotic trance", 139);
			WritePlaceFooter(md);
			return
		} else {
			perKate.showPerson("kate16a.jpg");
			addPlaceTitle(md, "Kate At Home");
			md.write("<p>Kate greets you as you enter her room. You are still unsure about how she feels about you.</p>");
			startQuestions();
			if (perKate.checkFlag(15))
				if (!perKate.checkFlag(27)) addQuestionR(md, "ask Kate for the necklace back", "You explain to Kate that now Davy is dealt with, you need the necklace back, and talk about strange supernatural encounters in the Sacred Grove. You are trying to give good reasons, but secretly is it that you want her as your slave?</p>" +
					'<p>Kate replies, "No, I think I will keep it"</p>' + "<p>Well, it was worth a try", "", "setPersonFlag(\\'Kate\\',27)");
				else {
					if (!perKate.checkFlag(28) && perYou.checkFlag(25)) addLinkToPlaceC(md, "hypnotise Kate", 139, "hypno=true", "", 'setPersonFlag("Kate",28)')
				}
			else if (!perKate.checkFlag(28) && perYou.checkFlag(25)) addLinkToPlaceC(md, "hypnotise Kate", 139, "hypno=true", "", 'setPersonFlag("Kate",28)')
		}
	} else if (perMG.other == 50 && perMG.checkFlag(1) && (plcMG == 275.5 || plcMG == 278) && stype === "") {
		if (perDavy.other == 7) perDavy.other =
			6;
		md = WritePlaceHeader();
		perKate.showPerson("kate17b.jpg", "", "", "kate17c.jpg");
		addPlaceTitle(md, "Kate At Home");
		setPlaceKnown("Hospital");
		md.write("<p>Kate tries to be pleasant but you can tell she is upset." + '<p>"Hi," she says. "I heard that you were at the museum when Mama got shot. She is hurt so badly that the doctors don\'t think that she will pull through. I never knew that she liked you so much; even in her semi-coma she calls your name. Perhaps you should go to the hospital to see her?"</p>');
		startQuestions();
		if (!perKate.checkFlag(3)) addQuestionR(md, "comfort Kate", "You try to comfort Kate and she appreciates your attempt, but she seems a little distant.", "Kate", "setPersonFlag(\\'Kate\\', 3, true);")
	} else if (!perMG.checkFlag(1) && perKate.other == 7 && stype === "") {
		if (perDavy.other == 7) perDavy.other = 6;
		md = WritePlaceHeader();
		perKate.showPerson("kate17balt.jpg", "", "", "kate17c.jpg");
		addPlaceTitle(md, "Kate At Home");
		md.write("<p>Kate is acting oddly, much more reserved than usual. You ask her where she has been, and she looks almost embarrassed,." +
			'<p>"None of your business...Sorry to snap, it has been...difficult recently"</p>');
		startQuestions();
		if (!perKate.checkFlag(3)) addQuestionR(md, 'ask "difficult?"', "You try to get Kate to explain more, so you can help, but she seems a little distant and will not talk about it.", "Kate", "setPersonFlag(\\'Kate\\', 3, true);")
	} else {
		md = WritePlaceHeader();
		switch (stype) {
			case "":
				perKate.showPerson("kate16a.jpg");
				addPlaceTitle(md, "Kate At Home");
				md.write("<p>Kate has evidently arrived home and she seems pleased to see that you have come to visit.</p>");
				break;
			case "chat1":
				perKate.showPerson("kate16b.jpg");
				addPlaceTitle(md, "Chatting with Kate");
				nPhoneWallpapers += 4;
				md.write("<p>You chat with Kate for a while. She talks about her interest in martial arts and working out. She also talks about her love of martial arts movies, especially old-school ones, like those with Bruce Lee or Jackie Chan, but she likes any of those type of movie.</p>" + "<p>Kate is very animated and leans toward you excitedly at times, giving you a very nice view!</p>" + "<p>You try to talk a little about your interest in magic, the old covens and the legendary spell book. Kate is not particularly interested so you start to change the topic of conversation. Kate interrupts you for a moment and shows you an image from some game she had played with a friend, and sends a copy to your phone. You notice she also sent a few other images as well.</p>");
				perKate.setFlag(1, true);
				break;
			case "chat2":
				perKate.showPerson("kate16c.jpg");
				addPlaceTitle(md, "Chatting with Kate");
				md.write("<p>You comment on her working out and try to compliment her figure. She smiles briefly before her expression changes and she looks a little uncomfortable and changes the topic of the conversation and she starts gossiping a little about people at school.</p>" + "<p>Kate does stand briefly after you compliment her and you see a nice view of her thigh as she rearranges her dress. You struggle to think about how to continue the conversation...</p>");
				perKate.setFlag(2);
				break;
			case "chat3":
				perKate.showPerson("kate16b.jpg");
				addPlaceTitle(md, "Chatting with Kate");
				md.write('<p>You know a bit about the old Bruce Lee movies, and suggest a small wager about who knows a bit of trivia about the legend of martial arts. Kate looks excited "Sure! What shall we wager?"</p>' + '<p>You start to suggest a kiss, or maybe money, and she interrupts "I know what you want, if you win I\'ll give you a glimpse of heaven, but if I win then I get to try out a new martial arts technique on you"</p>' +
					'<p>While losing sounds painful, that is just part of being Kate\'s friend so you agree eagerly, "a glimpse of heaven" could be many pleasant things.</p>' + '<p>Kate then asks you, "What was Bruce Lee\'s last movie that he actually acted for?"</p>');
				perKate.setFlag(10);
				startQuestions("Your answer is?");
				startAlternatives(md);
				addLinkToPlace(md, "Game of Death II", 139, "type=chat5&answer=gd2");
				addLinkToPlace(md, "The Big Boss", 139, "type=chat5&answer=bb");
				addLinkToPlace(md, "Game of Death", 139, "type=chat6&answer=gd&strip=first");
				addLinkToPlace(md, "Enter the Dragon", 139, "type=chat5&answer=ed");
				addLinkToPlace(md, "give up and exit the house", 43);
				endAlternatives(md);
				WritePlaceFooter(md);
				return;
			case "chat4":
				perKate.showPerson("kate16a.jpg");
				addPlaceTitle(md, "Chatting with Kate");
				md.write('<p>You do you best to try to kiss Kate, but she leans away looking a little cross and says "Not yet, we should get to know each other better".</p>' + "<p>You are disappointed, but at least she has implied that there could be another time!</p>");
				perKate.setFlag(10, true);
				break;
			case "chat5":
				perKate.showPerson("kate16d.jpg");
				addPlaceTitle(md, "Wrong Answer");
				var ans = getQueryParam("answer");
				if (ans == "bb") md.write('<p>You tell her "The Big Boss" and she laughs, "Fool that was his first starring role, not his last!"</p>');
				else if (ans == "gd2") md.write('<p>You tell her "Game of Death II" and she laughs, "Fool that was made after his death using old footage so he never acted for that movie specifically, they re-used old footage."</p>');
				else md.write('<p>You tell her "Enter the Dragon" and she laughs, "Idiot that was his best movie but not his last one!"</p>');
				md.write('<p>Kate stands up and tells you to as well. You do and brace yourself for the pain. She starts to do a complex sort of round-house kick, and you have two thoughts "This is going to hurt" and "I can see her panties...ummm I mean no panties!"</p>' + '<p>You hear a ripping sound and see Kate slip and fall onto the floor, the polished floorboards must have been too slick for martial arts. You see Kate lying on the ground, her thin dress has been ripped and is lying next to her. She looks at you a bit embarrassed and she quickly redresses. Your main thought is "no panties"...</p>' +
					'<p>She gets back up and sits and says "Well...ummm...that will do for the bet"</p>');
				break;
			case "chat6":
				var strip = getQueryParam("strip");
				if (strip == "first") {
					perKate.setFlag(11);
					perKate.showPerson("kate16e.jpg");
					addPlaceTitle(md, "Correct Answer");
					md.write('<p>You tell her "Game of Death" and she looks pleased, "That\'s right, unfortunately he died during production of that movie so it is the last movie he acted in and for."</p>' + '<p>Kate smiles a little coyly and says "As I promised, a glimpse of heaven"</p>' +
						"<p>She adjusts her top and exposes her breasts. You expect her to immediately cover up again but...</p>");
					startQuestions();
					addLinkToPlace(md, "she continues", 139, "type=chat6&answer=gd2&strip=second");
					WritePlaceFooter(md);
					return
				} else {
					perKate.showPerson("kate16f.jpg");
					addPlaceTitle(md, "Heaven");
					md.write("<p>Kate stands and turns her back to you, she wiggles a bit and her clothes fall to the ground at her feet, she is wearing just a sheer set of panties, and nothing else. She looks at you over her shoulder and bends over and redresses quickly, giving you a beautiful view of her gorgeous rear end.</p>" +
						'<p>She sits and looks at you "Well the bet is over, and you have had your reward, but that is all for now..."</p>' + '<p>You are pleased that she added "now" to the end of that!</p>')
				}
				break
		}
		startQuestions();
		if (!perKate.checkFlag(1)) addLinkToPlaceC(md, "chat with Kate", 139, "type=chat1");
		else if (!perKate.checkFlag(2)) addLinkToPlaceC(md, "compliment her figure", 139, "type=chat2");
		else if (!perKate.checkFlag(10)) {
			startAlternatives(md);
			addLinkToPlace(md, "bet her about some trivia of Bruce Lee", 139, "type=chat3");
			addLinkToPlace(md, "try to kiss her", 139, "type=chat4");
			endAlternatives(md)
		}
	}
	if (plcMG === 177) addLinkToPlace(md, "look for Mrs Granger", 177);
	addLinkToPlace(md, "exit the house", 43);
	WritePlaceFooter(md)
}

function PickUpPebble() {
	var s = isDay() || sType === "" ? "" : "You reach down to pick up a pebble, and as you do a ghostly hand reaches up out of the ground and tries to grab the pebble. You almost leap back in surprise, but the hand vanishes so you steel yourself to try again.</p><p>";
	if (perYourBody.FindItem(25) !== 0 && perYou.checkFlag(6) && perYourBody.FindItem(6) !== 0) WriteComments(s + "The rustic stone you have glows, but otherwise nothing happens to the pebble. You drop the useless thing.");
	else {
		perYourBody.PutItem(6);
		perYou.setFlag(6, false);
		WriteComments(s + "You place the pebble into the wooden box. The pebble transforms into a rustic stone.");
		dispPlace()
	}
}

function PickUpPebbleNoUse() {
	var s = isDay() || getQueryParam("type") === "" ? "" : "You reach down to pick up a pebble, and as you do a ghostly hand reaches up out of the ground and tries to grab the pebble. You almost leap back in surprise, but the hand vanishes so you steel yourself to try again. ";
	if (perYourBody.FindItem(25) !== 0 && !perYou.checkFlag(6))
		if (!isDay()) WriteComments(s + "You reach down to pick up a pebble, and as you do a ghostly hand reaches up out of the ground and tries to grab the pebble pick up the pebble but you have no use for the stone, and the wooden box is closed. You casually throw it away.");
		else WriteComments(s + "You pick up the pebble but you have no use for the stone, and the wooden box is closed. You casually throw it away.");
	else WriteComments(s + "You pick up the pebble but you have no use for the stone, and nothing to put it in. You casually throw it away.")
}

function ShowPlace141(stype) {
	if (wherePerson("AdeleRoss") == 16) return dispPlace(186, "type=sacred");
	if (!isPlaceKnown("SacredClearing")) setPlaceKnown("SacredClearing");
	var perVamp = findPerson("Vampyre");
	var perLauren = findPerson("Lauren");
	var bMonster = perVamp.isMonstersInSacredClearing() && !checkPlaceFlag("SacredClearing", 2);
	var md = WritePlaceHeader();
	if (bMonster && !bPopupShown) {
		setQueryParams("type=monster");
		AddImageRandom("monster", 7, "height:max");
		addPlaceTitle(md, "<i>Too Thin</i> Sacred Clearing");
		md.write("<p>The clearing is shrouded in an unusually thick fog as you enter it, but the distance between the tunnel and the Gates mansion is not that large, you tell yourself. Nothing will dare to get too close to the mansion and if you hurry, you will make it even during the night, right?</p>" +
			"<p>You step into the fog despite the nagging feeling that this is not a good idea and soon find yourself swallowed by darkness.</p>" + "<p>A foreboding sense of dread fills you, and as you turn around, you can see neither the entry to the tunnel nor the Gates mansion... have you really already moved away that far? Can this even be?</p>" + "<p>Your heart beats faster and you feel panic swell within you, until you suddenly hear the music.</p>" + "<p>Faint at first, far in the distance but clearly audible, alluring and quite... enthralling. You follow the melody without a second thought, and as you run deeper into the darkness strange shapes begin to surround you... you hear shuffling, growls, things getting closer, but you don't care. The song is what's important! So lovely, so wonderful, luring you deeper into the darkness, away from the mansion, away from those who might help you... but you don't need help! You need to find the source of the song! The creature whose lovely voice fills your mind and claims your very soul...</p>" +
			"<p>But you never reach her.</p>" + "<p>A ghostly figure appears in the distance, nimble, alluring, beckoning you closer with a seductive smile, but as you have nearly reached her, something tackles you to the ground and you sense other... things getting closer. Sharp teeth flash before your eyes and a sharp pain rushes through you, but the song is still there, even louder than before and soothing your final moments as you come to one last epiphany:</p>" + "<p>You should have listened to Sarah...</p>");
		startQuestions();
		addRestartLink(md);
		WritePlaceFooter(md);
		return
	}
	if (wherePerson("Kurndorf") == 16) movePerson("Kurndorf", 141);
	var img = getPersonOther("OfficerKhan") == 11 ? "stones3a.jpg" : "stones3.jpg";
	if (wherePerson("Kurndorf") == 141) {
		addPlaceImage(md, img);
		md.write('<img src="Images/ghost2.png" style="float:left;position:absolute;width:50%;width:10vw; top:5; left:0;margin:0px 5px;border-style:none" alt="Ghost">');
		addBackgroundImage("Images/ghost2.png", "", nTheme === 0)
	}
	addPlaceTitle(md, "Sacred Clearing", wherePerson("Kurndorf") ==
		141 ? "" : img);
	if (wherePerson("Kurndorf") == 141) md.write("<p>The ghost leads you between the groves of " + perGates.getPersonName() + "'s estate and you see a clearing. Stones circle the clearing and, from the markings on one of the stones, you believe that it is a sacred site of druids or witches.</p>" + "<p>The ghost seems brighter, more solid once it enters the clearing, but still ethereal. Again it gestures and you can see through some trees the side of the mansion and a door with large panes of glass in it.</p>" +
		"<p>The ghost approaches the door and you see it fade and flicker, and the way it is moving it seems to be a great effort for it to get close. It stops near to the wall and then holds up a hand, showing 4 fingers, then it closes one finger, waits, and closes another. The ghost is counting down, and looking at you expectantly. Unsure you approach it, and as it closes all fingers there is a shimmer and you see the door blur and become trans The ghost gestures forcefully at the door and you see the door start to waver and start to become more solid again.</p>");
	else {
		md.write("<p>Between the groves of " + perGates.getPersonNameShort() + "'s estate you see a clearing. Stones circle the clearing and, from the markings on one of the stones, you believe that it is a sacred site of druids or witches, and said to be the home of the fairy-folk.</p>");
		if (!isDay()) md.write("<p>It is quite eerie here at night, the shadows seem to move in what light is available, once you were sure you saw a figure crouched on top of one of the stones, but it must have been your imagination, nothing was there when you looked again.</p>");
		if (getPersonOther("OfficerKhan") == 11) md.write("<p>" + getOfficer() + " Khan has followed you into the clearing. There is nobody else around in this secluded place.</p>")
	}
	if (perLauren.checkFlag(10)) md.write("<p>You see through some trees the side of " + perGates.getPersonNameShort() + "'s Mansion.</p>");
	md.write("<p>Granite pebbles lie scattered on the ground, possibly weathered parts of the Stones.</p>");
	startQuestions();
	if (wherePerson("Kurndorf") == 141) {
		addLinkToPlace(md, "quickly jump through the door", 19);
		addLinkToPlace(md, "ignore the ghost and go to the front of the estate", 141, "type=banshee")
	} else {
		addOptionLink(md, "enter " + perGates.getPersonNameShort() + "'s House", "EnterMansion()");
		if (isPlaceKnown("Tunnel")) addLinkToPlace(md, "go in the tunnel", 178);
		if (perYourBody.FindItem(25) !== 0 && perYou.checkFlag(6)) addOptionLink(md, "pick up a granite pebble", "PickUpPebble()");
		else addOptionLink(md, "pick up a granite pebble", "PickUpPebbleNoUse()");
		addLinkToPlace(md, "sit on a fallen stone for a while", "", "", "You sit for a time on a cold stone",
			"", "WaitHere(2);");
		addLinkToPlace(md, "go to " + perGates.getPersonNameShort() + "'s estate", 16)
	}
	WritePlaceFooter(md)
}

function ShotByAnita() {
	showPopupWindowNow0();
	if (perYourBody.FindItem(4) > 0) {
		perYourBody.DropItem(4, 999);
		if (wherePerson("MrBeasley") !== 11) movePerson("MrBeasley", 11)
	}
	perYourBody.DropAllItems(999);
	nMoney = nMoney > 0 ? 0 : nMoney;
	perYou.setInjury(1);
	findPerson("Anita");
	per.other = 100
}

function ShowPlace142() {
	var md = WritePlaceHeader();
	findPerson("Anita");
	per.other = 13;
	per.showPerson("anita1.jpg", "height:max");
	addPlaceTitle(md, "Anita");
	md.write("<p>A girl jumps out from behind a rock. You recognize her from the description as Anita, and she is sporting a large shotgun. She aims at your head.</p>" + '<p>"So scumbag," she yells. "You are here to steal my master Davy\'s treasure. He told me that you might come and he ordered your death. Say goodbye to the world!"</p>' + "<p>You are trapped and she is watching you very closely.</p>");
	startQuestions();
	addOptionLink(md, "duck and run!", "ShotByAnita()");
	addOptionLink(md, "surrender to Anita", "ShotByAnita()");
	addPopupWindow(md, "Shot!", "<img src='Images/shot1.jpg' style='width:30%;float:right;margin-left:5px' alt='Shot'>" + "A shot rings out before you can act, then blackness consumes you.<br><br>" + '<a style="color:white;" href="javascript:closePopupWindowNow0()">unconsciousness claims you</a>', "gotoPlace(213);", undefined, true, false, true);
	WritePlaceFooter(md)
}

function ShowPlace143(stype) {
	var perMJ = findPerson("MsJones");
	var herName = perMJ.getPersonName();
	var md;
	if (stype === "") {
		md = WritePlaceHeader();
		perMJ.showPerson("jones1e.jpg");
		addPlaceTitle(md, herName);
		md.write("<p>You barely had a chance to finish speaking as she had already begun to discard her clothes in simple and yet deliberately erotic motions, straightening her back with her arms crossed behind her and her legs slightly spread.</p>" + '<p>"I am always <i>very</i> eager to provide another demonstration, my ' +
			perYou.getMaster() + '." She draws the last two words out into a sensually vibrating purr. "How may I prove myself worthy of you?"</p>');
		startQuestions();
		if (perYou.isMaleSex()) {
			addLinkToPlaceC(md, '"With your body"', 143, "type=fuck");
			addLinkToPlaceC(md, '"With your tongue"', 143, "type=bj");
			addLinkToPlaceC(md, '"With your tits"', 143, "type=titsfuck")
		} else {
			addLinkToPlaceC(md, '"With your tongue"', 143, "type=bj");
			addLinkToPlaceC(md, '"With your body"', 143, "type=fuck");
			if (perYou.FindItem(45) > 0) addLinkToPlaceC(md,
				'"With a strap-on"', 143, "type=strapon1")
		}
	} else if (stype == "fuck") {
		md = WritePlaceHeader(false, perYou.isMaleSex() && !isExplicit() ? "" : "td-left-large");
		if (!perYou.isMaleSex()) perMJ.showPerson("jones12.jpg");
		else if (isExplicit()) perMJ.showPersonRandomX("jones6", 2, "", "", "", "", 3);
		else perMJ.showPerson("jones6.jpg");
		addPlaceTitle(md, herName + "'s Body");
		if (perYou.isMaleSex()) md.write("<p>You know Ms Jones always enjoys a challenge, but also that she is at her best when allowed to use all the assets at her disposal, and as usual, she does not disappoint.</p>" +
			"<p>Within seconds, you find her on top of her teachers desk, enticingly tracing the ruler over her naked body and gesturing you to come closer, though it is not that you need this encouragement by now. Moments later, you are taking her roughly, the ruler now in your hands occasionally placing a slap onto her clit to make her squeal in delight while she whispers sweet lewdities to you, some in French, some in English, but always making your skin crawl in the most delightful way possible.</p>" + "<p>You love how devoted she is to pleasing you and yet, you have started to suspect that she has also been somehow guiding you, teaching you subtly how to please her and by extend the rest of your Harem.</p>" +
			"<p>You have yet to confront her about it and got to admit that you are in no hurry to do so. The things you pick up are proving to be very useful and she is just too good for you to care...</p>");
		else md.write("<p>You know Ms Jones always enjoys a challenge, but also that she is at her best when allowed to use all the assets at her disposal, and as usual, she does not disappoint.</p>" + "<p>Within minutes, you find yourself on the floor behind your teachers desk, your naked bodies intertwined as you both touch, kiss and caress each others skin with all her attention fully focused on you and your pleasure alone. You love how she is coming up with new and inventive ways to send pleasant shivers all over your body or make you scream in ecstasy every time you meet, and yet, you have started to suspect that  that she is also somehow guiding you, teaching you subtly how to please her and by extend the rest of your Harem.</p>" +
			"<p>You have yet to confront her about it and got to admit that you are in no hurry to do so. The things you pick up are proving to be very useful and she is just too good for you to care...</p>")
	} else if (stype == "strapon1") {
		md = WritePlaceHeader();
		perMJ.showPersonX("jones13.jpg");
		addPlaceTitle(md, herName + "'s Strap-On");
		md.write("<p>Usually, you are the one using this toy, but you'll be damned if you'd pass up an opportunity to see what Ms Jones is able to do with it.</p>" + "<p>Her eyes lighten up like a child's on Christmas as you hand it over and tell her that she is allowed to use it on you for being such a good slave.</p>" +
			"<p>She doesn't hesitate a second to put it on, swinging her hip to let the dildo waggle around with a gleeful giggle before her eyes focus on you with an almost predatory sheen.</p>" + "<p>She gently takes your hands and walks backwards, guiding you to the teachers desk, only to suddenly move behind you and push your body against it in a swift, rough motion. You gasp as her hands slide under your clothes, eagerly playing along as she removes and carelessly throws them to the side.</p>" + "<p>Your heart is beating faster as she spreads your legs and guides your upper body slightly forward, wrapping her arms around you tenderly. You feel her lips on the back of your neck, her breasts pressed against your back, and the tip of the strap on against your damp folds.</p>");
		startQuestions();
		addLinkToPlaceC(md, '"Do it"', 143, "type=strapon2")
	} else if (stype == "strapon2") {
		md = WritePlaceHeader();
		perMJ.showPersonX("jones13.jpg");
		addPlaceTitle(md, herName + "'s Strap-On");
		md.write("<p>You roughly breath out the order and she all to eagerly complies, fully pushing the toy cock into you with a long, delightful purr. She whispers to you to relax, let yourself go and allow her to read your body language as she begins to drive the toy in and out of you, subtly adjusting her position until you can't help but release some of the most lewd noises you ever heard escaping your lips every time she pushes forward.</p>" +
			"<p>As the seconds pass, her motions grow faster and more confident, having developed a good feel for your reactions, she ably begins to play with your body, driving you on a seemingly endless wave of pleasure until you are no longer able to hold back, collapsing on her desk in a powerful climax.</p>")
	} else if (stype == "titsfuck") {
		var idx = Math.floor(Math.random() * 4);
		var img = "jones7" + String.fromCharCode(idx + 97) + ".jpg";
		md = WritePlaceHeader(false, isExplicit() && idx < 2 ? "td-left-large" : "");
		if (isExplicit()) perMJ.showPersonX(img);
		else perMJ.showPerson("jones7.jpg");
		addPlaceTitle(md, herName + "'s Tits");
		md.write('<p>"I know just the thing, my Master." She eagerly helps you undress and pushes you to the ground behind the teachers desk. You watch her curiously as she straddles your legs and gathers a small bottle of oil from one of the drawers and makes sure to push out her chest and crotch invitingly while slowly pouring the contents over her breasts, moaning sensually when the oil touches her skin and making a huge show out of spreading it over both her full orbs.</p>' +
			"<p>You try to touch her breasts, but she just pushes your hand aside and teasingly waggles a finger before leaning down do rub her oiled breasts over your body.</p>" + "<p>It may not be as inventive as many of the things she usually does, but you really enjoy the sensation of her naked body sliding all over you nevertheless, your fingers caressing her sides and squeezing her rear as it gets into range until she slides down all the way and traps your manhood between her glistering tits.</p>" + "<p>You see a sly grin on her lips as she begins to move them, massaging your trapped member with slow, skillful motion to finally drive you over the edge.</p>")
	} else if (stype ==
		"bj") {
		md = WritePlaceHeader(false, isExplicit() && !perYou.isMaleSex() ? "td-left-large" : "");
		if (isExplicit())
			if (perYou.isMaleSex()) perMJ.showPersonRandomX("jones8", 5);
			else perMJ.showPersonRandomX("jones9", 3);
		else if (perYou.isMaleSex()) perMJ.showPersonRandom("jones8", 2);
		else perMJ.showPerson("jones9.jpg");
		addPlaceTitle(md, herName + "'s Tongue");
		if (perYou.isMaleSex()) md.write('<p>"You wish to examine moi experteez in fran\u00e7ais, mon Ma\u00eetre?" She playfully falls back into her discarded accent and presses her naked body against yours with a hungry look in her eyes. "It eez one of moi <i>many</i> specialties, you know?"</p>' +
			"<p>You can feel her heart already racing in anticipation as she wraps her arms around you, her lips briefly brushing over yours, and yet, before you are able to return her affection, you find your body spun around with almost scary ease and quickly coaxed to sit on the teacher's desk. You gasp as she places gentle kisses on your chin and neck while her hands expertly remove whatever piece of clothing was standing between her and your growing hard on.</p>" + "<p>In the next minutes, you once again experience the full impact of centuries of experience combined with a completely uninhibited mind focused only this task. Several times, you find yourself close to orgasm and your hands clamping at the desk in anticipation, only for her tongue and fingers to make a seemingly minor shift in her approach to keep you in suspense and prolong your release a little longer, skillfully toying with your manhood for a bit until she finally pushes you over the edge.</p>");
		else md.write('<p>"You wish to examine moi experteez in fran\u00e7ais, ma ma\u00eetresse?" She playfully falls back into her discarded accent and presses her naked body against yours with a hungry look in her eyes. "It eez one of moi -many- specialties, you know?"</p>' + "<p>You can feel her heart already racing in anticipation as she wraps her arms around you, her lips briefly brushing over yours, and yet, before you are able to return her affection, you find your body spun around with almost scary ease and quickly coaxed to sit on the teacher's desk. You gasp as she places gentle kisses on your chin and neck while her hands expertly remove whatever piece of clothing was standing between her and your dampening folds.</p>" +
			"<p>In the next minutes, you once again experience the full impact of centuries of experience combined with a completely uninhibited mind focused only this task. Several times, you find yourself close to orgasm and your hands clamping at the desk in anticipation, only for her tongue and fingers to make a seemingly minor shift in her approach to keep you in suspense and prolong your release a little longer, skillfully toying with you for a bit until she finally pushes you over the edge.</p>")
	}
	startQuestions();
	addLinkToPlaceC(md, '"Actually, I just want to ask a few questions."', 145, "post=true", "&quot;Of course, my " + perYou.getMaster() + ".&quot; She can barely hide her disappointment, but quickly returns most of her clothes to the way they were, looking at you expectantly with an eager smile.", "Ms Jones");
	if (isPlaceKnown("AnitasLair")) addLinkToPlace(md, "visit Anita's hiding place", 252);
	addLinkToPlace(md, "exit the office", 70);
	WritePlaceFooter(md)
}

function ShowPlace144(stype) {
	var md = WritePlaceHeader(false, stype == "charm3" ? "td-left-large" : "");
	var perKylie = findPerson("Kylie");
	var clv = perKylie.getCharmedLevel();
	if (stype.substr(0, 5) == "charm") {
		var idx = parseInt(stype.charAt(5), 10) + 1;
		perKylie.showPerson("kylie" + idx + ".jpg");
		addPlaceTitle(md, "Cousin Kylie Under a Charm Spell");
		if (stype == "charm1") {
			md.write("<p>You call out to your cousin Kylie and ask her to join you for a little. She looks at you and smiles,</p>" + '<p>"Sure ' + perYou.getPersonName() + " but don't think that we are going to be 'Kissing Cousins', family is out of the question!\". She is smiling, this is more her way of joking around with you than a warning.</p>" +
				'<p>You do not agree though with her, she is virtually a stranger and very cute, so you tell her "Dai Chu Kylie!"</p>' + '<p>She looks at you oddly, "Ehhh what was that Cuz" and she glances around and you see the other players have left the court and you are almost alone now. She continues,</p>' + '<p>"Cuz, we are not really close family are we", and she partly pulls down the back of her shorts. "It is strange, I really feel like I would like to get to know you better, so maybe a little making out and touching..."</p>' +
				"<p>Wow, she has fallen under the spell quickly, maybe she already liked you a bit</p>");
			startQuestions();
			addLinkToPlace(md, "touch her", 144, "type=charm2");
			WritePlaceFooter(md, "", false, true);
			return
		} else if (stype == "charm2") {
			md.write("<p>You reach out to touch her tantilising ass, but she laughs and amost dances away as she pulls up her shorts. She gestures to you in a 'come this way' fashion and leads you to a partly secluded bench. You start to talk to her about obedience, but she laughs,</p>" + '<p>"Hey Cuz, who wants to talk about boring who is in charge stuff. I am more interested in talk of who is on <i>top</i>!"</p>' +
				"<p>Your immediate thought is what is it with the women of your family, everyone wants to be in charge. As you think this she sits rather provocatively, pulling aside her shorts showing her cleanly shaven pussy and a lack of panties.</p>" + '<p>"Well Cuz, isn\'t this a better thing to talk about. How about you kiss your cousin, in a more <i>personal</i> way?"</p>');
			startQuestions();
			addLinkToPlace(md, "kiss your cousin", 144, "type=charm3");
			WritePlaceFooter(md, "", false, true);
			return
		} else if (stype == "charm3") {
			if (!perKylie.checkFlag(2)) {
				PlaceI(5);
				perKylie.setFlag(2)
			}
			md.write("<p>Kylie guides you to kiss her <i>intimately</i> and passionately! Together you explore and enjoy each others bodies. As children you may of last hugged, but now as adults you can truly embrace each other.</p>" + "<p>Later you dress and Kylie <i>mostly</i> does, her shorts removed and showing her delightful ass for your, and her, enjoyment.</p>" + "<p>As she shows off to you, Kylie stumbles and picks up something partially buried in the sand of the volleyball court</p>" +
				'"It\'s one of these silly things, carved by someone who knows nothing about art!", and she drops the familiar looking stone.</p>')
		}
	} else {
		addPlaceTitle(md, "School Sports Fields", isShopOpen(2) ? "schoolfield2.jpg" : "schoolfield1.jpg");
		setPlaceKnown("SchoolField");
		md.write("<p>The sporting fields for Glenvale High border part of the park on one side, and the school on the others. Glenvale High is proud of it's sporting achievements but as of yet it is not highly ranked in sports, but everyone is working to improve this. Well, almost everyone, magic has always been more interesting to you.</p>" +
			"<p>There are a variety of areas, from the ovals and volleyball and tennis courts. You have often seen matches being played on the courts at lunch time.</p>" + "<p>There is a simple noticeboard listing reservations for fields and courts. The list is chaotic with many changes and erasures, but there is a volleyball match fairly consistently around lunch time most school days.</p>");
		if (perKylie.isHere())
			if (clv > 0) md.write("<p>Kylie is waiting for you near the courts,<br>" + "\"Hey Cuz, how about we explore the term 'Kissing Cousins'?\"</p>");
			else md.write("<p>Your cousin Kylie is over at the volleyball court, playing a game with some friends. She flashes you a cute smile.</p>")
	}
	startQuestions();
	if (perKylie.isHere())
		if (clv > 0) addLinkToPlace(md, "kiss your cousin", 144, "type=kiss");
	if (isShopOpen(2)) addLinkToPlace(md, "enter the School", 70);
	if (isPlaceKnown("Park")) addLinkToPlace(md, "walk into the park", 63);
	addLinkToPlace(md, "return to the front of the school", 9);
	if (perKylie.isHere() && stype != "charm3") {
		AddPeopleColumnLarge();
		perKylie.showPerson(clv >
			0 ? "kylie1b.jpg" : "kylie1a.jpg")
	}
	WritePlaceFooter(md)
}

function ShowPlace145(stype) {
	var md;
	var perJ = findPerson("MsJones");
	var clv = perJ.getCharmedLevel();
	if (!isShopOpen(2) || !perJ.isHere()) {
		md = WritePlaceHeader();
		addPlaceTitle(md, "French Classroom", "classroom3.jpg");
		if (!isShopOpen(2)) md.write("<p>The French Classroom, empty at night</p>");
		else md.write("<p>The French Classroom, empty at now, the teacher Ms. Jones is not here.</p>");
		startQuestions();
		if (isPlaceKnown("AnitasLair")) addLinkToPlace(md, "sneak back into Anita's hiding place", 252);
		addLinkToPlace(md,
			"exit the office", 70);
		WritePlaceFooter(md);
		return
	}
	if (getBeasleyServant() == 30) return dispPlace(150);
	var perLeanne = findPerson("Leanne");
	md = WritePlaceHeader(false, clv > 0 ? "" : "td-left-large");
	if (clv > 0) perJ.showPerson("jones2.jpg");
	else perJ.showPerson("jones1b.jpg");
	addPlaceTitle(md, "Ms. Jones' Office");
	if (clv > 0) md.write("<p>Ms Jones, your teacher, toy, devoted servant, cock-ornament and warrior slave has certainly acquired a lot of titles in her centuries of servitude, and sometimes seems to make up new ones just for the hell of it.</p>" +
		"<p>She always purposely follows the same ritual when you enter her classroom, quickly opening her top to put her breasts on display before sinking onto one knee in a sensual, yet disciplined looking gesture.</p>" + "<p>Her eyes are submissively downcast as she welcomes you, asking eagerly how she may serve you today.</p>");
	else {
		md.write("<p>Ms. Jones, your French teacher, greets you in her office. Ever since she joined the staff last year every boy in class has paid a lot more attention to their lessons.</p>" +
			'<p>"Bonjour ' + perYou.getPersonName() + '. Is zere anything I can help you with?"</p>');
		if (!perJ.checkFlag(2)) {
			perJ.setFlag(2);
			perJ.showPersonInfo(md)
		}
	}
	startQuestions();
	if (isMurderPath())
		if (getPersonOther("Anita") == 100) addQuestionC(md, "ask Ms. Jones if she has seen Anita", "MsJones", 1001);
	if (!isPlaceKnown("WildRanges")) addQuestionC(md, "ask Ms. Jones if she knows about magic stones", "MsJones", 4600);
	if (getBeasleyServant() == 6) addQuestionC(md, "ask Ms. Jones where Mr. Beasley went", "MsJones", 1406);
	if (perYou.isQuestStarted(5) &&
		perLeanne.place == 382 && !perLeanne.checkFlag(8)) addLinkToPlaceC(md, "ask Ms. Jones about saving Leanne", 145, "type=askleanne");
	if (clv > 0) {
		if (getQueryParam("post") === "") addLinkToPlace(md, "let her prove her experience again", 143);
		if (perJ.other === 0) addQuestionC(md, "ask her about her eagerness to serve", "MsJones", 2E3);
		else if (perJ.other == 1) addQuestionC(md, "ask her about the accent", "MsJones", 2001);
		else if (perJ.other == 2) addQuestionC(md, "ask what she knows about Davy Robbins", "MsJones", 2002);
		else if (perJ.other ==
			3) addQuestionC(md, "ask about who had charmed her, if not Davy", "MsJones", 2003);
		else if (perJ.other == 4) addQuestionC(md, '"I think I have seen newspaper clippings of this, the police just put it off as a depraved sexcult which dispersed after the leader died of drug overdose... wait, you were part of that?"', "MsJones", 2004);
		else if (perJ.other == 5) addQuestionC(md, '"Why would he do that?"', "MsJones", 2005);
		if (perJ.checkFlag(5) && !perJ.checkFlag(6)) addQuestionC(md, "ask about her and Miss Logan", "MsJones", 2100);
		if (perJ.checkFlag(7) && !perJ.checkFlag(8)) addQuestionC(md, "ask about her relationship with Susan Tanika", "MsJones", 2200)
	}
	if (isPlaceKnown("AnitasLair")) addLinkToPlace(md, clv > 0 ? "visit Anita's hiding place" : "sneak back into Anita's hiding place", 252);
	addLinkToPlace(md, "exit the office", 70);
	WritePlaceFooter(md)
}

function ShowPlace146() {
	var md = WritePlaceHeader();
	addPlaceTitle(md, "Phone Message", getThemeFolder() + "phone2.png");
	if (getBeasleyServant() == 7) setBeasleyServant(8);
	md.write("<p>You listen to the message on the answering machine.</p>" + "<p>&quot;Hello,&quot; says a rough voice. It sounds like Mr. " + "Beasley. &quot;I wanted to thank you for the book " + perYou.getPersonName() + ".</p>" + "<p>As you can guess by now, I know a spell or two myself and, thanks to your little gift, I can learn " + "more. I bumped into Ms. Jones, who said that you are trying to " +
		"find me. I advise you to stop or you will lose more than just an old book.&quot;</p>" + "<p>Mr. Beasley's voice takes an evil twist, making a chill run down\tyour spine.</p>" + "<p>After a slight pause the message continues, &quot;I am truly " + "grateful for what you have given me so far and I may have a " + "position open for another assistant if you prove useful. Help me find one " + "more thing and I promise you a reward that you will remember for a " + "long time. In the book I have read the words <em>Dai Chu</em>. I " +
		"must have the meaning of these words. Tell me where I can find " + "this information and I will reward you handsomely.&quot;</p>");
	startQuestions();
	addLinkToPlace(md, "go to the kitchen", 45);
	WritePlaceFooter(md)
}

function ShowPlace147() {
	var md = WritePlaceHeader();
	var perTracy = findPerson("Tracy");
	perTracy.showPerson("tracy9.jpg");
	addPlaceTitle(md, "Tracy At the Library");
	md.write("<p>&quot;Over here,&quot; says Tracy. &quot;I found a " + "text book that mentions Dai Chu. It looks like it is a " + "sort of spell. Druids used to use it during fertility " + "rituals. It is not used anymore because the meaning was " + "lost years ago. There is some sort of puzzle that might " + "contain the answer to the spell's whereabouts.</p>");
	startQuestions();
	addLinkToPlace(md, "try the puzzle", 148);
	addLinkToPlace(md, "go to the library reception", 3);
	WritePlaceFooter(md)
}

function FindItDaiChu(doc) {
	var sText = doc.FormChar.research.value.toLowerCase().trim();
	if (sText == "alley" || sText == "the alley") {
		movePerson("Tracy", 1);
		if (getBeasleyServant() < 11) setBeasleyServant(11);
		gotoPlace(3, "", "Correct! Dai Chu is located in the alley. Mr Beasley will be pleased that you have served him well.")
	}
}

function ShowPlace148() {
	var md = WritePlaceHeader(true);
	if (getBeasleyServant() < 10) setBeasleyServant(10);
	addPlaceTitle(md, "Dai Chu Puzzle", "", 0, true);
	md.write("<p>In the time before the sacred church, the druids influenced the " + "hearts and minds of the people. A wicked building was constructed " + "to hold great spells of magic, including the sinful act of Dai Chu. " + "There unseemly acts were conducted by the powerful magi " + "until the Brotherhood of St. Mark, with the aid of court officials, " + "overcame the evil. A bull marked the place where no man should ever enter.</p>" +
		'<form method="POST" name="FormChar">' + '<p><img src="Images/daichu.jpg" style="float:right;width:25%;margin-left:5px" alt="DaiChu">' + "Where is the place of Dai Chu?</p>" + '<p><input type="text" size="20" name="research">' + '<input type="button" name="button" value="please" onClick="FindItDaiChu(document)"></p>' + "</form>");
	startQuestions();
	addLinkToPlace(md, "go to the library reception", 3);
	WritePlaceFooter(md)
}

function ShowPlace149() {
	var md = WritePlaceHeader();
	addPlaceTitle(md, "Phone Message", getThemeFolder() + "phone2.png");
	if (getBeasleyServant() == 11) setBeasleyServant(30);
	if (!isPlaceKnown("FrenchClassroom")) setPlaceKnown("FrenchClassroom");
	md.write("<p>You listen to the message on the answering machine. It is Mr. Beasley again.</p>" + "<p>&quot;So " + perYou.getPersonName() + ", you have " + "served me well already. If I knew that you had such a knack for " + "finding things I may have employed you earlier than today. Not " +
		"only did you get the book away from " + perGates.getPersonNameShort() + " but you have found " + "the location of the Dai Chu spell as well. I would never have thought of " + "the alley. I really have to thank you for that.&quot;</p>" + "<p>You wonder how Mr. Beasley could have found out about the spell's " + "location before you told him. Did somebody see you reveal the " + "secret? <b>Only Tracy knew that you found the location</b>.</p>" + "<p>Mr. Beasley's message continues, &quot;In appreciation of your " + "work I have arranged the reward as promised. Come to the school " +
		"and claim the satisfaction of every youngster.&quot;</p>");
	startQuestions();
	addLinkToPlace(md, "go to the kitchen", 45);
	WritePlaceFooter(md)
}

function ShowPlace150() {
	var md = WritePlaceHeader();
	var perJ = findPerson("MsJones");
	perJ.showPerson("jones2.jpg");
	if (getBeasleyServant() == 30) setBeasleyServant(31);
	if (!isPlaceKnown("FrenchClassroom")) setPlaceKnown("FrenchClassroom");
	addPlaceTitle(md, "Ms. Jones In French Classroom");
	md.write("<p>Ms. Jones greets you in the classroom. There is " + "something odd about her eyes and her expression is a " + "mixer of hunger and despair. The teacher's body is " + "swaying in time to music played on the radio, a wicked " +
		"grin escaping her lips.</p>" + "<p>&quot;Ms. Jones,&quot; you gasp. &quot;What are you " + "doing here? Did you find Mr. Beasley?&quot;</p>" + "<p>&quot;Mmm, Monsier Beasley,&quot; the teacher moans to " + "herself. She begins to play with her breasts. " + "&quot;Yes I have found zee wonderful M. Beasley " + "and he taught me some things I did not know about myself. Hmmm.&quot;</p>" + "<p>&quot;Ms. Jones! Are you alright?&quot;</p>" + "<p>&quot;Oh yes " + perYou.getPersonName() + "I am feeling very well and I am glad zat you are here. I " +
		"must instruct you in some very important lessons about zee French.&quot;</p>" + "<p>You are not sure which way to turn, either out of the " + "door or wait to see what lessons Ms. Jones has for you.</p>");
	startQuestions();
	addLinkToPlace(md, "wait for the lesson", 151);
	addLinkToPlace(md, "exit the room", 70);
	if (!perJ.checkFlag(2)) {
		perJ.setFlag(2);
		perJ.showPersonInfo(md)
	}
	WritePlaceFooter(md)
}

function ShowPlace151() {
	var md = WritePlaceHeader(false, "td-left-large");
	var perJones = findPerson("MsJones");
	perJones.showPerson("jones3.jpg");
	addPlaceTitle(md, "Ms. Jones' Lesson");
	md.write("<p>You jump a little as Ms. Jones violently frees her breasts.</p>" + "<p>&quot;Relax,&quot; she coos. &quot;Zee lesson I have " + "today is about earning rewards " + perYou.getPersonName() + ". If you do zee good work " + "for zee teachers we do work for you.&quot; She reaches over and fondles your crotch.</p>" + "<p>&quot;Please don't, Ms. Jones,&quot; you say, trying to " +
		"push her hand away. &quot;You don't know what you are " + "doing. Mr. Beasley has done something to you.&quot;</p>" + "<p>&quot;Ohh, Monsieur Beasley,&quot; she says again, her " + "expression increasing with desire. &quot;He did do " + "something to me. Something very special. Zat is why I " + "have to give you something special too.&quot;</p>" + "<p>&quot;No Ms. Jones! Mr. Beasley is a thief and you should not do this.&quot;</p>" + "<p>Ms. Jones is clearly under the influence of a spell. " + "You should leave her alone before her actions go too far.</p>");
	startQuestions();
	addLinkToPlace(md, "stay with Ms Jones", 152);
	addLinkToPlace(md, "exit the room", 70);
	WritePlaceFooter(md)
}

function ShowPlace152() {
	var md = WritePlaceHeader();
	var perJones = findPerson("MsJones");
	perJones.showPerson("jones4.jpg");
	addPlaceTitle(md, "Ms. Jones' Lesson");
	md.write("<p>&quot;You are right " + perYou.getPersonName() + ",&quot; " + "says Ms. Jones. &quot;I am a very naughty girl and you should teach me a lesson.&quot;</p>" + "<p>The grabs a " + (isBritish() ? "metre" : "yard") + " stick from her desk and begins spanking her crotch. &quot;Punish me, " + perYou.getPersonName() + ", just like this.&quot;</p>" + "<p>Hesitatingly, you take the " +
		(isBritish() ? "metre" : "yard") + " stick from her hand.</p>" + "<p>&quot;Ow! Zat's a little hard darling. Ow! Yes zat is just right. Oh please take me " + "before my panties get all wet.&quot;</p>");
	startQuestions();
	addLinkToPlace(md, "take Ms. Jones", 153);
	WritePlaceFooter(md)
}

function ShowPlace153() {
	var md = WritePlaceHeader(false, "td-left-large");
	var perJones = findPerson("MsJones");
	perJones.showPerson("jones5.jpg");
	addPlaceTitle(md, "Ms. Jones' Lesson");
	md.write("<p>Your French teacher leans over the desk. &quot; Oh my little pussy aches so much you wicked ");
	if (perYou.isMaleSex()) md.write("boy. Your next lesson is to make it better with that juicy cock of yours.");
	else md.write("girl. Your next lesson is to lick it better.");
	md.write(". .&quot;</p>" + "<p>You do as your teacher orders, with her gasping out instructions between orgasms. " +
		"Only one thing annoys you: Every time Ms. Jones climaxes she screams out for Beasley.</p>" + "<p>The lesson leaves you feeling satisfied but there are more adventures waiting so you have to get going.</p>");
	startQuestions();
	addLinkToPlace(md, "exit the room", 70);
	WritePlaceFooter(md)
}

function ShowPlace154(stype) {
	var perMom = findPerson("Mom");
	var clvM = perMom.getCharmedLevel();
	var perGabby = findPerson("Gabby");
	var bGabbyHere = perGabby.isHere();
	var md;
	if (!perMom.isHere()) {
		md = WritePlaceHeader();
		addPlaceTitle(md, "Mom's Bedroom", "mom-bedoom.jpg");
		md.write("<p>Mom's bedroom usually neat and tidy, but her funiture is a little old fashioned for your taste.</p>")
	} else if (bGabbyHere) {
		md = WritePlaceHeader();
		perGabby.showPerson("gabby-mom5.jpg");
		addPlaceTitle(md, "Mom and Gabby In the Bedroom");
		md.write("<p>Mom and Gabby quickly break up a kiss as you enter the room and both look at you, Mom clearly happy to see you while Gabby is more reserved, but still watching you intently.</p>" + "<p>\u201cHey Hun, Mommy is a little busy with her assistant right now, but if there's anything you need just say it.\u201d</p>")
	} else if (clvM > 0) {
		if (clvM == 1) {
			md = WritePlaceHeader(false, "td-left-large");
			perMom.showPerson("mom33.jpg");
			addPlaceTitle(md, "<i>Your</i> Mom In Her Bedroom");
			md.write("<p>Mom is always glad to see you even now after a long day of work at the local television studio. " +
				"The way she tells her friends about how well your sister Tracy and you have turned out is quite embarrassing.</p>" + "<p>She hasn't changed much under your spell, but her behavior is a lot more sexual towards you and others, and she often lounges seductively on the bed when you enter her room.</p>")
		} else {
			md = WritePlaceHeader();
			perMom.showPersonDN("mom10.jpg");
			addPlaceTitle(md, "Mom In Her Bedroom");
			md.write("<p>Mom is always glad to see you even now after a long day of work at the local television studio. " +
				"The way she tells her friends about how well your sister Tracy and you have turned out is quite embarrassing. " + "Even so she is a pretty good mom to hang around with.</p>" + "<p>Things are a little different now, she is your mother but now is more open to more <i>unusual</i> ideas.</p>")
		}
		if (getPersonCharm("OfficerKhan") == 10) md.write('<p>"Hi, did you hear about ' + getOfficer() + " Khan, didn't you mentioned you knew her?\"</p>")
	} else {
		md = WritePlaceHeader(false, perJesse.getDemonPath() == 60 && perJesse.place !=
			6 && isDay() ? "td-left-large" : "");
		if (perJesse.getDemonPath() == 60 && perJesse.place != 6) perMom.showPersonDN("mom1d.jpg");
		else perMom.showPersonRandomDN("mom1", 3);
		addPlaceTitle(md, "Mom In Her Bedroom");
		md.write("<p>Mom is always glad to see you even now after a long day of " + "work at the local television studio. The way she tells her " + "friends about how well your sister Tracy and you have turned " + "out is quite embarrassing. Even so she is a pretty good mom to hang around with.</p>");
		if (perYou.getExperience() >
			7 && perMom.other < 7) md.write('<p>"I\'m glad that you are back," says Mom, looking at her watch. "Do you mind going to the ' + getShopStore() + ' to pick up some bread and milk for breakfast?"</p>');
		if (perJesse.getDemonPath() == 60 && perJesse.place != 6) md.write('<p>Your mother looks a little embarrassed as if you disturbed her,<br/>"By the by," She says with a sly grin. "A lovely young lady stopped by to see you just a bit ago.  Making new friends are we?"</p>');
		else if (isCharmedBy("Tracy") && !perMom.checkFlag(31)) md.write('<p>She speaks to your firmly "Young ' +
			perYou.getManWoman() + ' we need to talk about Tracy!"</p>');
		if (getPersonCharm("OfficerKhan") == 10) md.write('<p>"Hi, did you hear about ' + getOfficer() + " Khan, didn't you mentioned you knew her?\"</p>")
	}
	startQuestions();
	addLinkToPlace(md, "leave your Mom's bedroom", 45);
	WritePlaceFooter(md)
}

function ShowPlace155() {
	var md = WritePlaceHeader(true);
	if (getPersonOther("Tracy") < 4) {
		setPersonOther("Tracy", 4);
		if (wherePerson("Tracy") === 0) movePerson("Tracy", 1)
	}
	addPlaceTitle(md, perGates.getPersonNameShort() + "'s Diary", "", 0, true);
	md.write('<div style="text-align:center"><br><table style="width:99%">' + "<tr>" + '<td style="background-image:url(UI/books/booktopleft.jpg);width:30px">&nbsp;</td>' + '<td style="background-image:url(UI/books/booktop.jpg)">&nbsp;</td>' + '<td style="background-image:url(UI/books/booktopright.jpg);width:30px">&nbsp;</td>' +
		"</tr><tr>" + '<td style="background-image:url(UI/books/bookleftside.jpg);width:30px">&nbsp;</td>' + '<td style="background-image:url(UI/books/bookbackground1.jpg);text-align:left;padding:0 5px 0 5px;color:black">26 August' + "<p>He visited me again today and again he asked for " + "the artifact. He knows that I have it now and he knows " + "that his power is limited until I surrender my artifact.</p>" + "<p>All these years I hoped that Beasley forgave my " + "ancestors for the ownership. Only recently did I witness " +
		"his jealousy. Maybe it has been within him all along his " + "training in the arts. Worse yet, his apprentice Davy " + "has an influence I like not. That young man has ambitions " + "which I am scared to tell Beasley. They have no " + "appreciation of the meaning of guardianship of the most powerful book on earth.</p>" + "<p>I fear that they will send someone to steal my " + "artifact. So much that I have taken to wearing a loaded " + "gun. God help us if the book should fall into the wrong hands.</p>" + "<p>I told the authorities about my danger. Mayor Thomas " +
		"guaranteed me that she would protect my life. I hope that she can do so.</p>" + "</td>" + '<td style="background-image:url(UI/books/bookrightside.jpg);width:30px">&nbsp;</td>' + "</tr><tr>" + '<td style="background-image:url(UI/books/bookbottomleft.jpg);width:30px">&nbsp;</td>' + '<td style="background-image:url(UI/books/bookbottom.jpg)">&nbsp;</td>' + '<td style="background-image:url(UI/books/bookbottomright.jpg);width:30px">&nbsp;</td>' + "</tr>" + "</table></div><br>");
	startQuestions("Close the book and then...");
	addLinkToPlace(md, "return to the attic", 67);
	WritePlaceFooter(md)
}

function ShowPlace156() {
	var md = WritePlaceHeader(false, "td-left-med");
	var perTracy = findPerson("Tracy");
	var bMurderKnown = perYou.getExperience() > 9;
	perTracy.showPersonDN("tracy7.jpg");
	var myName;
	if (perYou.isBornMale()) myName = "little brother";
	else myName = "little sister";
	addPlaceTitle(md, "Tracy In The Laundry");
	md.write("<p>Tracy is in the laundry-room, studying. ");
	if (getPersonOther("Mom") >= 5 && !perYou.checkFlag(35)) {
		perYou.setFlag(35);
		md.write("You recognise your cleaned shirt on top of a nearby pile of clothes.</p>");
		if (!bMurderKnown) {
			md.write('<p>"Hey there ' +
				myName + '," says Tracy. "You never can tell what is going to happen, can you? Here I am doing your washing. Don\'t think that it is going to happen every day. I only did it because Mom asked me to. Your shirt was a mess. Did you have had a mammoth bloody nose or something?"</p>');
			md.write("<p>You gulp and wonder whether Tracy will figure out the connection with " + perGates.getPersonNameShort() + "'s murder.</p>")
		} else {
			md.write("<p>\"Well you're back," + myName + '" says your sister. "Did you hear about what happened at the Gates\' place? There was a murder, someone chopped ' +
				perGates.getPersonNameShort() + "'s head off and shoved it though a mincer. The cops are everywhere, trying to find out who did it.\"</p>");
			md.write("<p>You ignore your sister's exaggerated version of the murder and grab your shirt out of the washing basket.</p>")
		}
	} else if (perYou.checkFlag(35)) md.write('<p>"Hey there ' + myName + '," says Tracy.</p>');
	startQuestions();
	if (getPersonCharm("Tina") >= 4) addQuestionC(md, '"Hey Tracy, I ran into Davy and he asked me to have you meet him at his house."', "Tracy", 8906);
	if (getBeasleyServant() == 8) addQuestionC(md, '"Hey Tracy, could you help me find the meaning of <i>Dai Chu</i>?"', "Tracy", 1408);
	else if (getBeasleyServant() == 12) addQuestionC(md, '"Hey Sis, did Mr. Beasley say anything about <i>mana</i>?"', "Tracy", 1412);
	addLinkToPlace(md, "exit the laundry room", 45);
	WritePlaceFooter(md)
}

function ExitPhoneMessage() {
	var perB = findPerson("Mr Beasley");
	if (!perB.checkFlag(5)) perB.setFlag(5)
}

function ShowPlace159() {
	var md = WritePlaceHeader();
	moveDavyToHotel1();
	var myName = perYou.getPersonName();
	var HisHer = perYou.getHisHer();
	var HeShe = perYou.getHeShe();
	var HimHer = perYou.getHimHer();
	addPlaceTitle(md, "Davy's Telephone Message", getThemeFolder() + "phone2.png");
	md.write("<p>You listen to the telephone message. It is Davy Robbins' voice.</p>");
	if (isMurderPath()) {
		md.write('<p>"Beasley," the message begins. "' + perGates.getPersonNameShort() + " is dead and the police are looking for you. Someone tipped them off about your argument with " +
			perGates.getPersonNameShort() + ", so they think you are the murderer. I know it's not true because I brought several people under my control. The taxi driver was especially useful: he tipped me off that he drove that idiot " + myName + " to the Gates estate. I remembered what you told me about " + myName + " asking about the book so I turned " + HisHer + " sister into my slave. " + myName + "'s clothes were covered with blood when " + HeShe + " returned home and " + HeShe + " was carrying something large in " + HisHer + ' bag."</p>');
		if (perGates.other == 600) md.write("<p>You pause the message to catch your breath. Davy is trying to frame you for what his woman did! It might not be long before the police are told. You play the message along.</p>");
		else md.write("<p>You pause the message to catch your breath. If Davy knows about what you have done then it might not be long before the police are told. You play the message along.</p>");
		md.write("<p>Davy's voice continues, \"We must not let anyone find out about the magic. I have charmed several people including the mayor. They will do whatever they can to rescue the book from " +
			myName + " and they will keep everything quiet. I am scared to go near " + myName + " in case " + HeShe + " uses the magic against me. I have no mana left so I am going to the Broken Inn Hotel to look for some more. I'll meet you there.\"</p>")
	} else md.write('<p>"Beasley," the message begins. "I got your message about ' + myName + ' asking questions about magic.  I\'ve looked into it and I think Mr Gates may have found the "apprentice" he was looking for."  There is a pause in Davy\'s voice as if he\'s not sure how to continue.  "I brought several people under my control to find out what ' +
		HeShe + "'s been up to. The taxi driver was especially useful.  He tipped me off that he drove that idiot " + myName + " to the Gates estate.  Just to be sure, I also turned " + HisHer + " sister into my slave to keep an eye on " + HimHer + " at home.  The sister told me that " + HeShe + " was carrying something large in " + HisHer + ' bag when he came home."</p>' + "<p>Davy's voice continues, \"We must not let anyone find out about magic or that book. I have charmed several other people in town.  I tried to get the mayor but she wasn't in her office and I didn't have the time to wait for her.  I've instructed all of them to do whatever they can to get the book from " +
		myName + ' and they will keep everything as quiet as possible." He pauses for a moment again.</p>' + '<p>"I am scared to go near ' + myName + " in case " + HeShe + " tries to cast a spell on me. I have no mana left so I am going to the Broken Inn Hotel to look for some more. I'll meet you there.\"</p>");
	startQuestions();
	addLinkToPlace(md, "delete the message", 160, "", "", "", "ExitPhoneMessage()");
	addLinkToPlace(md, "hang up the telephone", 77);
	WritePlaceFooter(md)
}

function ShowPlace160() {
	var md = WritePlaceHeader();
	setPersonFlag("MrBeasley", 5);
	addPlaceTitle(md, "Davy's Telephone Message", getThemeFolder() + "phone2.png");
	md.write("<p>You delete Davy's telephone message.</p>");
	startQuestions();
	addLinkToPlace(md, "hang up the telephone?", 77);
	WritePlaceFooter(md)
}

function FindIt161() {
	if (isRunes()) Research("Spell", "DertPher", "", 161);
	else gotoPlace(132)
}

function ShowPlace161(stype) {
	var perAnita = findPerson("Anita");
	var perJessica = findPerson("Jessica");
	var bWitchSlave = perJessica.getRivalry() == -1;
	var bDavySlave = perDavy.isHere();
	var perVamp = findPerson("Vampyre");
	var perBambi = findPerson("Bambi");
	var perTina = findPerson("Tina");
	var nSlaves = perJessica.isHere() ? 1 : 0;
	if (bDavySlave) nSlaves++;
	var b2Cols = perTina.isHere() || perJesse.isHere() || nSlaves > 0;
	var md = WritePlaceHeader(false, b2Cols && !(perAnita.isHere() && perBambi.isHere()) ? "td-left-small" : "td-left");
	if (perAnita.isHere() &&
		perBambi.isHere()) perBambi.showPerson("bambianitaguard1.jpg");
	else if (perAnita.isHere()) perAnita.showPerson("anitaguard1.jpg");
	else if (perBambi.isHere()) perBambi.showPerson("bambiguard1.jpg");
	if (nSlaves < 2 && !(b2Cols && perVamp.isHere()))
		if (checkPlaceFlag("Hotel", 9)) addPlaceImage(md, "dungeon.jpg");
		else addPlaceImage(md, "cellar1.jpg");
	if (b2Cols && perVamp.isHere()) perVamp.showPerson("vamp5a.jpg");
	if (checkPlaceFlag("Hotel", 9)) {
		addPlaceTitle(md, "Hotel Dungeon");
		if (nSlaves > 1) addPlaceImage(md, "dungeon.jpg",
			"20%", "left");
		md.write("<p>Once the Hotel's cellar, now has had a quick refit to be more a dungeon of some sort of BDSM fantasy, you are always surprised at the skill and depravity of Bambi.</p>" + "<p>The altar is still there and some wine racks, but other sort of racks have also been added. Heating has been turned on and it is a pleasant temperature now, with no obvious drafts, probably for the comfort of naked slaves.</p>")
	} else {
		addPlaceTitle(md, "Hotel Cellar");
		if (nSlaves > 1) addPlaceImage(md, "cellar1.jpg",
			"25%", "left");
		md.write("<p>Under your feet the steps creak from age and moisture. Through the dim lighting you see " + "a tiny altar. A breeze blows across your ankles, almost freezing you in place.</p>")
	}
	if (!isSpellKnown("Wealth"))
		if (checkPlaceFlag("Hotel", 6)) md.write("<p>Under the altar is a cupboard, and it is open but you have not mastered it's power yet.<br>");
		else md.write("<p>Under the altar is a cupboard.  You try it, but it seems it can only be opened by answering a magical puzzle.<br>");
	else md.write("<p>Under the altar is a cupboard.  The puzzle spell is broken, its power now yours to control.<br>");
	if (!checkPlaceFlag("Hotel", 6))
		if (isPuzzles()) md.write("<i>Inscribed on the surface of the cupboard is a strange question for you to answer.</i></p>");
		else {
			md.write("<i>Inscribed on the surface of the cupboard are some strange runes that may be a spell.</i></p>");
			setPlaceFlag("Hotel", 6);
			setPersonFlag("Monique", 3, false)
		}
	if (isMurderPath())
		if (perYou.getQuestRustyKey() < 999) md.write("<p>There is also an old wine rack up against the wall.  It must be from quite some time ago, as the cage seems rusted shut and the one bottle left is covered in dust.</p>");
		else md.write("<p>There is also an old wine rack up against the wall...  The key is still jammed in the lock and simply will not budge.</p>");
	else if (perYou.getQuestRustyKey() < 1001) md.write("<p>There is also an old wine rack up against the wall.  It must be from quite some time ago, as the cage seems rusted shut and the one bottle left is covered in dust.</p>");
	else md.write("<p>There is also an old wine rack up against the wall...  it is open and empty of any wine bottles.</p>");
	if (perJesse.isHere()) md.write('<p>Jesse asks, "Is this the <i>exciting</i> place? It looks kind of boring to me."</p>');
	if (perJessica.isHere())
		if (perJessica.getRivalry() == 1) {
			md.write("<p>You see Jessica is here, the demon ignored her as she left. Jessica is still bound and chained to the cellar walls. You try to locate any sort of locks or ways of freeing her but everything is seamless metal or other material. There is nothing to open, even the gag is tight and cannot be gotten free. You try to pull the chain free, but they are sunken into the walls.</p>" + "<p>It seems you will have to find help to free her...unless you want to have your own personal witch-toy...but the Demon is free and Kurndorf is in the next room, so it is a dangerous place to play.</p>" +
				"<p>You tell Jessica that you will return with help to free her, though to yourself you are still thinking of <b>not</b> freeing her.</p>");
			perJessica.setRivalry(2)
		} else if (bWitchSlave) md.write("<p>Jessica is here, naked, chained and gagged, your powerless witch-slave.</p>");
	else md.write("<p>Jessica is here, naked, chained and gagged, and waiting for you to free her.</p>");
	if (perKurndorf.getQuestRitual() == 200) {
		md.write("<p>You barely make it out of the room in time as the space <i>between places</i> closes up behind you.  Evidently without the Witch or Kurndorf maintaining it, it could no longer exist.</p>");
		perKurndorf.setQuestRitual(201)
	}
	if (whereItem(52) == 161) md.write("<p><i>You can see the Crystal on the floor.  Evidently it was ejected from Kurndorf's prison as it closed behind you.<br>" + "It seems to pulse with a dark light, proof of the spirit trapped within.</i></p>");
	startQuestions();
	if (!checkPlaceFlag("Hotel", 6)) addLinkToPlace(md, "try the puzzle", 162);
	else if (!isSpellKnown("Wealth")) addOptionLink(md, "try to learn the spell", "FindIt161()");
	if (getPersonOther("Jessica") > 0 && perKurndorf.getQuestRitual() <
		200)
		if (perKurndorf.getQuestSeance() < 50) addLinkToPlace(md, "enter the witch's prison", 193);
		else addLinkToPlace(md, "visit Kurndorf's Ghost", 342);
	if (bWitchSlave) addLinkToPlace(md, "play with your witch-toy", 161, "type=playjessica");
	addLinkToPlace(md, "go back up to the hotel bar", 124);
	if (b2Cols)
		if (perJesse.isHere()) {
			AddPeopleColumnMed(md);
			perJesse.showPerson("jesse1a.jpg");
			if (perTina.isHere()) perTina.showPlaceImageRight(md)
		} else {
			AddPeopleColumnLarge(md);
			if (nSlaves > 0) md.write("<table><tr>");
			if (perJessica.isHere()) {
				if (nSlaves >
					0) md.write('<td style="width:50%">');
				if (bWitchSlave) perJessica.showPersonRandom("jessica3", 2, "100%", "", "", "Witch-Toy");
				else if (stype == "cut2") perJessica.showPerson("jessica2d.jpg", "100%", "", "", "Freed Witch");
				else perJessica.showPersonRandom("jessica2c", 6, "100%", "", "", "Bound Witch");
				if (perTina.isHere()) perTina.showPlaceImageRight(md);
				if (nSlaves > 0) md.write("</td>")
			}
			if (bDavySlave) {
				if (nSlaves > 0) md.write('<td style="width:50%">');
				if (perDavy.isMan()) perDavy.showPerson("davycellar-male-1.jpg");
				else perDavy.showPersonRandom("davycellar-female-1",
					2);
				if (perTina.isHere() && !perJessica.isHere()) perTina.showPlaceImageRight(md)
			}
			if (nSlaves > 0) md.write("</td></tr></table>")
		}
	WritePlaceFooter(md)
}

function FindItCupboard2(doc) {
	var sBody = doc.FormChar.research.value.toLowerCase().trim();
	var perMonique = findPerson("Monique");
	if (perMonique.checkFlag(33) && sBody == "one word" || perMonique.checkFlag(34) && sBody == "bookkeeper" || perMonique.checkFlag(35) && sBody == "balance") {
		setPlaceFlag("Hotel", 6);
		perMonique.setFlag(3, false);
		sBody = "Correct, wise one! You may now attempt to learn a new spell.  May your wisdom serve you well.";
		Place = 161
	} else sBody = "Incorrect. Try again.";
	gotoPlace(Place, "", sBody)
}

function ShowPlace162() {
	var md = WritePlaceHeader();
	var perMonique = findPerson("Monique");
	perMonique.setFlag(3);
	if (!perMonique.checkAnyFlags(33, 35)) perMonique.setFlag(Math.floor(Math.random() * 3) + 33);
	addPlaceTitle(md, "Cupboard Puzzle", "cupboard.jpg");
	md.write('<p style="text-align:center">Only the wise one could know the meaning of the word.</p>' + '<form method="POST" name="FormChar">');
	if (perMonique.checkFlag(33)) md.write('<p style="text-align:center">How would you rearrange the letters in the words new door to make one word?</p>');
	else if (perMonique.checkFlag(34)) md.write("<p style=\"text-align:center\">If it's information you seek, come and see me. If it's pairs of letters you need, I have consecutively three. Who am I?</p>");
	else md.write('<p style="text-align:center">A natural state, I\'m sought by all. Go without me, and you shall fall. You do me when you spend, and use me when you eat to no end. What am I?</p>');
	md.write('<p style="text-align:center"><input type="text" size="20" name="research">' + '<input type="button" name="button" value="please" onClick="FindItCupboard2(document)"></p>' +
		"</form>");
	startQuestions();
	addLinkToPlace(md, "look around the cellar", 161);
	WritePlaceFooter(md)
}

function ShowPlace163() {
	var md = WritePlaceHeader();
	addPlaceTitle(md, "Tina' Bedroom", "bedroom10.jpg");
	startQuestions();
	addLinkToPlace(md, "exit the bedroom", 176);
	WritePlaceFooter(md)
}

function ShowPlace167() {
	var md = WritePlaceHeader();
	var perSmith = findPerson("OfficerSmith");
	var perBatton = findPerson("OfficerBatton");
	var perKhan = findPerson("OfficerKhan");
	var perDA = findPerson("Diane");
	if (perSmith.pther == 100) perSmith.other = 900;
	if (perBatton.isCharmedBy()) {
		perBatton.setFlag(2);
		if (perDA.isCharmedBy() && perKhan.isCharmedBy() && perBatton.checkFlag(3)) perBatton.setFlag(5)
	}
	if (perSmith.isCharmedBy()) perSmith.setFlag(2);
	if (perDA.isCharmedBy()) perDA.setFlag(1);
	if (!isPlaceKnown("PoliceStation")) setPlaceKnown("PoliceStation");
	addPlaceImage(md, "police1station.jpg", "", "", "Police Station");
	if (perKhan.charmed == 2)
		if (isBritish()) md.write('<p><img src="Images/UK/policecar1.jpg" style="width:75%" alt="Police Car"></p>');
		else md.write('<p><img src="Images/US/policecar1.jpg" style="width:75%" alt="Police Car"></p>');
	addPlaceTitle(md, "Glenvale Police Station");
	if ((perSmith.isDead() || perSmith.isCharmedBy()) && (perDA.isCharmedBy() || perDA.isDead()) && perBatton.isCharmedBy() && (perKhan.isCharmedBy() || perKhan.isDead())) md.write('<p>You consider the newly "refurnished" police station one of your great achievements. Everytime you visit, slaves jump from every corner to look after your wishes. With the ' +
		getPoliceChief() + " and the " + getProsecutor() + " in your hands you technically own the law enforcement in Glenvale.</p>" + '<p>Not long ago the police station was celebrated as the "Tidiest Cop Shop in the Country\u201d, a title that was important to the people and something to be proud of. Maybe you should come with an award, like "Most Obedient Slaves in the Country" or "The Best Serving Police Officers". You are sure Officer Kerry wouldn\u2019t mind an award like that.</p>');
	else md.write("<p>The hub of law and order in Glenvale, the police station is the finest in the " +
		"district. With little crime and a crack team of police " + "officers there is not much to worry about in this town. " + "Last year the Glenvale police station was awarded with the title " + "&quot;Tidiest Cop Shop in the Country,&quot; " + "a title that everyone considers to be very important.</p>");
	if (perKhan.charmed == 2) md.write("<p>There is a police car parked in the street.</p>");
	startQuestions();
	addLinkToPlace(md, "enter the Police Station", 168);
	if (isPlaceKnown("TVStation")) addLinkToPlace(md, "walk to the TV Station",
		359);
	addLinkToPlace(md, "walk to the Town Hall", 94);
	WritePlaceFooter(md)
}

function ShowPlace168(stype) {
	var perSmith = findPerson("OfficerSmith");
	var perBatton = findPerson("OfficerBatton");
	var clvBatton = perBatton.getCharmedLevel();
	var perKhan = findPerson("OfficerKhan");
	var perDA = findPerson("Diane");
	var clvDA = perDA.getCharmedLevel();
	var bDAHere = perDA.place == 168 && (perDA.other > 0 && perDA.other < 900) && perDA.other != 50;
	var perAR = findPerson("AdeleRoss");
	var plcAR = perAR.place;
	var bArrest = getQueryParam("arrest") == "true";
	var perMG = findPerson("MrsGranger");
	var tot = perBatton.place == 168 ? 1 :
		0;
	if (stype == "daappears" || stype == "daappears2") bDAHere = true;
	if (bDAHere) tot++;
	if (perKhan.place == 168) tot++;
	var md = WritePlaceHeader();
	if (clvBatton > 0 && perBatton.place == 168 && bDAHere) perBatton.showPerson("Setting/polb6.jpg");
	else if (bDAHere)
		if (clvDA > 0)
			if (clvBatton === 0)
				if (perBatton.place == 168) perBatton.showPerson("Setting/polb1.jpg");
				else perDA.showPerson("diane5.jpg");
	else if (perBatton.place == 168) perBatton.showPerson("Setting/polb6.jpg");
	else perDA.showPerson("diane5.jpg");
	else if (perBatton.place == 168)
		if (clvBatton ===
			0) perBatton.showPerson("Setting/polb1.jpg");
		else if (perDA.other != 50) perBatton.showPerson("Setting/polb2.jpg");
	else perBatton.showPerson("Setting/polb6.jpg");
	else {
		if (perDA.other != 50) perDA.showPerson("diane1.jpg")
	} else if (perBatton.place == 168)
		if (clvBatton === 0) perBatton.showPerson("Setting/polb1.jpg");
		else perBatton.showPerson("Setting/polb6.jpg");
	if (perKhan.place == 168 && tot > 2) perKhan.showPerson("Setting/pol9.jpg");
	addPlaceTitle(md, "Police Station Reception", tot === 0 ? "police2station.jpg" : "");
	if (bDAHere) {
		if (clvDA >
			0 && clvBatton > 0 && perBatton.place == 168) md.write("<p>" + getProsecutor() + " White and " + getPoliceChief() + " Batton greet you as you enter. Both slaves displaying themselves for your enjoyment, both willing and eager to do whatever you ask.</p>");
		else if (clvDA > 0 && (clvBatton === 0 || perBatton.place !== 168)) md.write("<p>" + getProsecutor() + " White looks you over as you enter, her eyes still betraying her slavery and loyalty to you. You know she would do anything you asked her to.</p>");
		else if (clvBatton > 0 && clvDA ===
			0 && perBatton.place == 168) md.write("<p>" + getPoliceChief() + " Kerry Batton smiles at you as you enter, running her tongue over her lips and discreetly exposing her bra for your enjoyment.  Only the presence of the " + getProsecutor() + " keeps her from throwing off her clothes and begging you to take her again.</p>");
		if (clvDA === 0) {
			if (perDA.other == 1) {
				md.write("<p>A smug-looking lady stands ");
				if (perBatton.place == 168) md.write("between you and " + getPoliceChief() + " Batton");
				else md.write("before you");
				md.write(". The blond haired woman introduces herself to you as Diane White the " +
					getProsecutor() + " who got the case of the ");
				if (perYou.getArrested() == 2) md.write("murder of " + perGates.getPersonName());
				else if (perYou.getArrested() == 3) md.write('museum "accident"');
				else md.write("theft of a certain Book");
				md.write(". Ms. White as it turns out to be, is living in a bigger city not far away from here, but this town is still under her supervision, that means every  homicide case in the area comes directly to her. She seems suspicious of you and you have strange feeling that won\u2019t stand a chance against her in court. If, she wants to take the case to court of course \u2026but that depends on her. Maybe you can alter her attitude towards you and show her a new world\u2026the world of servitude. She must also understand that the vase belongs to you. She will see that you did not commit any crime and you could always use a good lawyer. Who knows what mess will you get into next time?</p>" +
					'<p>She is eyeballing you warily, but after the formal introduction she asks: "Can we talk, ' + perYou.getPersonName() + '? Because we\u2019ve got a lot to discuss."</p>')
			} else if (perDA.other > 1)
				if (perBatton.place == 168) md.write("<p>" + getProsecutor() + " White stands between you and " + getPoliceChief() + " Batton. She looks you over with a contemptuous sneer");
				else md.write("<p>" + getProsecutor() + " White looks you over with a contemptuous sneer");
			if (perDA.other == 10) {
				md.write(' and orders your arrest. "You have the right to..."</p>');
				if (perBatton.place == 168)
					if (clvBatton === 0) md.write("<p>" + getPoliceChief() + " Batton steps up and throws handcuffs around your hands.  It seems you have no choice.</p>");
					else md.write("<p>" + getPoliceChief() + " Batton looks at you, her devotion obviously outweighing the order from the " + getProsecutor() + " to arrest you.")
			} else if (perDA.other > 1) md.write(".</p>")
		}
	}
	if (perDA.other === 0 || perDA.other >= 15)
		if (clvBatton === 0) {
			md.write("<p>Due to a recent increase in budget the station has been renovated and refurbished. It could almost be a pleasant place to visit if it were not for the cops.</p>");
			if (perBatton.place == 168) {
				md.write("<p>As you enter the police reception you are greeted by " + getPoliceChief() + " Kerry Batton, the policewoman in charge. ");
				if (perKhan.charmed == 2 || !isMurderPath() && perKhan.place == 168) md.write(" The threatening woman acknowledges you before she turns back to her work.</p>");
				else if (perKhan.charmed == 15 && perBatton.other < 10) md.write(" She asks you whether you have seen " + getOfficer() + " Khan, who is missing. You stay quiet but feel that you should ask around for any news.</p>")
			}
		} else if (perBatton.place ==
		168) {
		if (isBritish()) md.write("<p>Kerry greets you with the eagerness of a slave. She opens her shirt and shows you her breasts to please her " + perYou.getMaster() + ". ");
		else md.write("<p>Kerry greets you with the eagerness of a slave. She holds her breasts up as an offering to you as her " + perYou.getMaster() + ". ");
		if (perKhan.charmed > 0 || perKhan.charmed == 15) md.write(" She begs you to fuck her.</p>");
		if (perKhan.charmed == 15 && perBatton.other < 10) md.write('<p>"' + perYou.getMaster() + '," she begs, "I do not mean to bother you, but one of my ' +
			getOfficer(false) + "s is missing: " + getOfficer() + " Khan.  Have you seen her?  As her superior I am responsible for her safety.  Please, " + perYou.getPersonName() + ', tell me if you hear of anything?"</p>');
		md.write("<p>You ignore her for now, knowing you can have her any time you wish. There are more important things to deal with for the time being.</p>")
	} else md.write("<p>Papers and pens are scattered over Kerry Batton's desk from your playing around.</p>");
	if (perDA.other === 0 || perDA.other >= 15)
		if (perKhan.charmed ==
			2) md.write(getOfficer() + " Khan leads you through the reception area.</p>");
		else if (!isMurderPath() && perKhan.place == 168) md.write(getOfficer() + " Khan greets you and offers to take you through to her office.</p>");
	if (perDA.other == 900 && perDA.isHere()) md.write("<p>" + getProsecutor() + " Diane White lies dead beside the counter.</p>");
	if (perSmith.other == 100) md.write("<p>" + getOfficer() + " Rebecca Smith is rolling around on the floor. Her chest is red with blood flowing from a fresh bullet wound.</p>");
	else if (perSmith.other ==
		900 && perSmith.isHere()) md.write("<p>" + getOfficer() + " Rebecca Smith lies dead on the floor, the pool of blood beneath her a reminder of her sacrifice for you.</p>");
	startQuestions();
	if (bDAHere) {
		var bookQ = false;
		if (perDA.other == 1) addQuestionC(md, "help " + getProsecutor() + " White with the investigation", "Diane", 5701);
		else {
			if (perYou.getArrested() != 3) {
				if (perYourBody.FindItem(4) === 0 && perDA.other < 3) addQuestionC(md, "tell her that you do not have the book", "Diane", 9002);
				if (perDA.other < 10) {
					addQuestionC(md, "tell her that you found the book in the alley",
						"Diane", 5710);
					addQuestionC(md, "tell her that " + perGates.getPersonNameShort() + " gave you the book", "Diane", 5711)
				}
			} else if (perMG.place == 177) addQuestionC(md, "tell her you had nothing to do with it", "Diane", 5705);
			else if (perDA.other == 2) {
				addQuestionC(md, "tell her you had nothing to do with it", "Diane", perMG.checkFlag(4) ? 5705 : 5704);
				addQuestionC(md, "tell her Mrs. Granger was obeying your commands like a good slave", "Diane", 5705)
			}
			if ((perDA.other == 3 || perDA.other == 15) && !perYou.checkFlag(8) && perYourBody.FindItem(4) ===
				0) {
				addQuestionC(md, "ask " + getProsecutor() + " White where the book is now", "Diane", 5703);
				bookQ = true
			}
		}
		if (perDA.other == 10)
			if (perBatton.place !== 168) addQuestionC(md, "give in and go to the jail cell", "Diane", 5712);
			else if (clvBatton === 0) addQuestionC(md, "give in and go to the jail cell", "Diane", 5713);
		else {
			startAlternatives(md);
			addQuestionC(md, "play along and go to the jail cell", "Diane", 5714);
			addQuestionC(md, "order " + getPoliceChief() + " Batton to throw the " + getProsecutor() + " in jail instead", "OfficerBatton",
				5750);
			endAlternatives(md)
		}
		if (clvDA > 0 && clvBatton > 0 && perBatton.place == 168) addLinkToPlace(md, "tell " + getPoliceChief() + " Kerry and Diane to demonstrate some legal procedures", 168, "type=kerrydianethreesome");
		if (clvDA > 0) {
			if (!bookQ && !perYou.checkFlag(8) && (whereItem(4) == 168 || whereItem(4) == 999 || whereItem(4) == 76)) addQuestionC(md, "ask " + getProsecutor() + " White where the book is again", "Diane", 5703);
			if (clvBatton !== 0 || perBatton.place !== 168) addLinkToPlaceC(md, "discuss the law with Diane", 223, "type=law");
			if (perMG.place ==
				261) addQuestionC(md, "ask " + getProsecutor() + " White to free Mrs. Granger", "Diane", 6E3);
			if (perDA.NoItems > 0) addQuestionC(md, '"May I have my possessions back"', "Diane", 7E3)
		}
	}
	if (perBatton.place == 168 && (perDA.other === 0 || perDA.other >= 15))
		if (clvBatton === 0) {
			if (perKhan.charmed == 15 && perBatton.other < 10) {
				startAlternatives(md);
				addQuestionC(md, "tell " + getPoliceChief() + " Batton you heard " + getOfficer() + " Khan was killed", "OfficerBatton", 5215);
				addQuestionC(md, "tell " + getPoliceChief() + " Batton you heard " + getOfficer() +
					" Khan was shot", "OfficerBatton", 5216);
				endAlternatives(md)
			}
			if (perBatton.other == 10) addQuestionC(md, "ask " + getPoliceChief() + " Batton if she has heard anything about Officer Khan", "OfficerBatton", 9910)
		} else {
			if (perKhan.charmed == 15 && perBatton.other < 10) {
				startAlternatives(md);
				addQuestionC(md, "order Kerry to investigate " + getOfficer() + " Khan's murder", "OfficerBatton", 5215);
				addQuestionC(md, "order Kerry to investigate " + getOfficer() + " Khan's shooting", "OfficerBatton", 5216);
				endAlternatives(md)
			}
			if (perBatton.other ==
				10) addQuestionC(md, "ask Kerry what her investigation revealed", "OfficerBatton", 9910);
			if (plcAR == 16 && perAR.checkFlag(4))
				if (getPersonOther("Diane") === 0 && !isArrestPossible()) addLinkToPlaceC(md, "order Kerry to withdraw the police from the Gates estate", 168, "type=daappears");
				else {
					if (clvDA > 0 || perDA.other === 0 || perDA.other == 900 || perDA.other == 50) addQuestionC(md, "order Kerry to withdraw the police from the Gates estate", "OfficerBatton", 10201)
				}
			else if (perAR.checkFlag(2) && !perAR.checkFlag(3)) addQuestionC(md, '"' +
				getOfficer() + ' Ross, do you mean the older sister of Amy Ross?"', "OfficerBatton", 10202);
			if (clvDA > 0 || perDA.other >= 50) addLinkToPlace(md, "tell Kerry it's a bust", 168, "type=kerryfuck");
			else if (perDA.place === 0 && getPersonOther("Diane") === 0 && !isArrestPossible() && (plcAR == 436 || plcAR >= 900))
				if (isMurderPath() && perBatton.other > 10) addLinkToPlace(md, "tell Kerry it's a bust", 168, "type=daappears2");
				else if (!isMurderPath()) addLinkToPlace(md, "tell Kerry it's a bust", 168, "type=daappears2");
			if (perDA.other >= 50 && perMG.place ==
				261) addQuestionC(md, "ask Kerry to free Mrs. Granger", "Diane", 6E3);
			if (checkPlaceFlag("Museum", 3) && !checkPlaceFlag("Museum", 4)) addQuestionC(md, "ask Kerry about the incident at the Museum", "OfficerBatton", 1131);
			if (perDA.other == 900 && perDA.isHere()) addQuestionC(md, "ask Kerry to call an ambulance to remove " + getProsecutor() + " White's body", "OfficerBatton", 2E3);
			if (perSmith.other == 900 && perSmith.isHere()) addQuestionC(md, "ask Kerry to call an ambulance to remove " + getOfficer() + " Smith's body", "OfficerBatton",
				2001);
			if (perGates.checkFlag(6) && !isPlaceKnown("AvernusClub")) addQuestionR(md, "ask about the gentleman's club", "You ask her about the gentlemans's club you were told about. Kerry looks a little annoyed,</p>" + "<p>\"Yes, yes, it is such a pain. Not the club itself, it seems to be clean and well run. It is just we get compaints and petitions to close it. The compaints are unfounded, it is the 'moral' people in town trying to get it closed! Well, it is law abiding and we have no problems with it, so it will stay open!\"</p>" +
				"<p>She gives you directions to the club, it is located in a side street off the shopping center. The club is open late at night until the early hours and is by invitation only. She quickly makes a phone call, and tells you,</p>" + '<p>"I just asked the bartender there to consider you an invited guest in the club, you can visit any time you want"', "OfficerBatton", "setPlaceKnown(\\'AvernusClub\\')")
		}
	if (perDA.other === 0 || perDA.other >= 15)
		if (perKhan.place == 168 || perKhan.charmed == 2) addLinkToPlace(md, "go to " +
			getOfficer() + " Khan's office", 169);
	if (perDA.other != 10 && (!perYou.isArrested() || perSmith.other > 0 || isPlaceKnown("JailCell"))) addLinkToPlace(md, "visit the jail cells", 260);
	if (isPlaceKnown("PoliceInterrogationRoom")) addLinkToPlace(md, "visit the interrogation room", 175);
	if (clvDA === 0 && perDA.other > 0 && perDA.other < 15) addQuestionCO(md, "exit the police station", "Diane", 5702);
	else addLinkToPlace(md, "exit the police station", 167);
	if (tot > 1) {
		AddPeopleColumnLarge(md);
		if (clvDA > 0 && clvBatton > 0 && perBatton.place == 168 &&
			perDA.other < 900) perDA.showPerson("diane5.jpg");
		else if (perDA.other > 0 && perDA.other < 900 && perBatton.place == 168)
			if (clvDA > 0) perDA.showPerson("diane9.jpg");
			else if (perDA.other != 50) perDA.showPerson("diane1.jpg");
		if (perKhan.place == 168 && tot < 3) perKhan.showPerson("Setting/pol9.jpg")
	}
	WritePlaceFooter(md)
}

function ShowPlace169(stype) {
	var md = WritePlaceHeader(false, stype == "bj" || stype == "fuck" ? "td-left-large" : "");
	var perOK = findPerson("OfficerKhan");
	if (stype === "") {
		perOK.showPerson("Setting/pol10a.jpg");
		addPlaceTitle(md, getOfficer() + " Khan's Office");
		md.write("<p>" + getOfficer() + " Khan swoons over to you, seeking to satisfy your desire. Anything you ask for is yours.</p>");
		startQuestions();
		if (perOK.charmed == 2 && !isDavyDefeated()) addQuestionC(md, "tell her to arrest Davy and bring him here", "OfficerKhan", 522);
		addLinkToPlaceC(md, '"I desire you!"', 169, "type=desire")
	} else if (stype == "desire") {
		perOK.showPerson("Setting/pol10b.jpg");
		addPlaceTitle(md, "Desiring " + getOfficer() + " Khan");
		md.write('<p>Cheryl starts to strip her clothing, "How is this for a strip search, what do you want me to search now?"</p>');
		startQuestions();
		if (perYou.isMaleSex()) addLinkToPlaceC(md, '"Let me do internal search of you!"', 169, "type=fuck");
		addLinkToPlaceC(md, 'Gesture and "Search this!"', 169, "type=bj")
	} else if (stype == "bj") {
		if (perYou.isMaleSex()) perOK.showPerson("Setting/pol14b.jpg");
		else perOK.showPersonRorX(isBritish() ? "Setting/pol6ga.jpg" : "Setting/pol6gb.jpg");
		addPlaceTitle(md, getOfficer() + " Khan's Search");
		md.write("<p>Cheryl thoroughly searches your groin making sure to touch, stroke and lick everything to make sure no orgasm remains concealed.</p>");
		startQuestions()
	} else if (stype == "fuck") {
		perOK.showPersonRorX("Setting/pol15b.jpg");
		addPlaceTitle(md, "Searching " + getOfficer() + " Khan");
		md.write("<p>You give " + getOfficer() + " Khan a very thorough internal examination. You do not find anything, except a mutual orgasm.</p>");
		startQuestions()
	}
	addLinkToPlace(md, "exit " + getOfficer() + " Khan's office?", 168);
	WritePlaceFooter(md)
}

function ShowPlace170(stype) {
	var md = WritePlaceHeader();
	var perJ = findPerson("JohnAdams");
	var perTess = findPerson("Tess");
	var perTanika = findPerson("MrsTanika");
	var clvT = perTanika.getCharmedLevel();
	var nmT = perTanika.getPersonName();
	var nmTs = perTanika.getPersonNameShort();
	var myName = perTess.getYourNameFor();
	if (perTess.other == 10) perTess.other = 11;
	if (stype === "enter") {
		WriteComments("\"I'm so glad that you like it " + myName + '. Here, do you want to kiss these?" She asks, exposing her breasts for your viewing pleasure.<br>');
		setQueryParams("")
	}
	if (!isDay()) perTess.showPerson("tess20b.jpg");
	else if (perTess.other == 27) perTess.showPerson("tess14c.jpg");
	else perTess.showPerson("tess8.jpg");
	addPlaceTitle(md, "Mrs. Adams In Your Bedroom");
	md.write("<p>Mrs. Adams holds her breasts out for you to play with. You take your time to explore her mounds and she groans as your fingers touch each nipple.</p>");
	startQuestions();
	addLinkToPlace(md, "play with Tess even more", 170, "type=tessplaymore");
	if (perTanika.whereNow() == 46) {
		addLinkToPlace(md,
			"ask Tess and " + nmTs + " to work together for you", 170, "type=tesstanikathreesome");
		addLinkToPlace(md, "ask " + nmTs + " and Tess to play together", 170, "type=tanikatesssex")
	}
	if (perTess.other == 11) addQuestionC(md, '"Tess, do you have any magic artifacts?"', "Tess", 2011);
	else if (perTess.other == 12) addQuestionC(md, '"Ask your husband for magic, but do <b>NOT</b> tell him about <i>us</i>."', "Tess", 2012);
	else if (isDay() && perJ.checkFlag(2)) addLinkToPlaceC(md, 'Tess, "Maybe you could change your outfit?"', 46, "", "&quot;Of course my love, I will change for you immediately&quot;",
		"", "TessChangeClothes();");
	if (perYourBody.FindItem(4) > 0 && perYou.checkFlag(11) && perYou.canUseExperience()) addOptionLink(md, "ask Tess for help deciphering the passages in the book", "spendExperience()");
	if (perTess.other > 24 && isShopOpen(2, 1, true)) addQuestionC(md, '"Tess, let\'s meet at the library"', "Tess", 10421);
	addSleepLink(md, "go to bed for the night with Tess", "Going to Bed with Tess", '<p style="position:absolute;left:2%;top:2em;cursor:pointer;font-size:1.1em;width:66%">As you prepare to go to bed for the night, Tess lies down on the bed looking beautiful as always. She looks at you with desire and you can see you will not be sleeping for a while...</p>',
		"tess20c.jpg", true, 46);
	addLinkToPlace(md, "finish playing with Tess", 46);
	WritePlaceFooter(md)
}

function ShowPlace171(stype) {
	var md = WritePlaceHeader();
	var perTess = findPerson("Tess");
	if (stype === "") perTess.showPerson("tess10.jpg");
	else perTess.showPerson("tess11a.jpg");
	addPlaceTitle(md, "Mrs. Adams In Hotel Room");
	if (stype === "") {
		md.write('<p>"What do you think of my outfit?" gushes Mrs. Adams. ' + '"I picked it especially for you. As you are so young and all, I thought that you might like a cheerleader."</p>' + "<p>There is a strange object on the table. It kind of looks like a worm with a human head. You could be " +
			'mistaken in thinking that the thing is actually moving. "What is it?" you ask Mrs. Adams.</p>' + '<p>"Oh, you saw my little surprise. This is what my..husband found. The silly thing keeps asking questions ' + "that I don't know the answer to. He said that it might be magical but I think that it is annoying.\"</p>");
		startQuestions();
		addLinkToPlace(md, "ask Mrs. Adams to show off more of herself", 171, "type=expose")
	} else {
		md.write("<p>Mrs Adams removes her top to reveal her firm breasts.</p>" + '<p>"You are so cheeky darling," says the librarian. "I just know that we are going to have so much fun together."</p>');
		startQuestions()
	}
	addLinkToPlace(md, "try to solve the worm's puzzle", 173, stype !== "" ? "type=" + stype : "");
	addLinkToPlace(md, "exit the room?", 124);
	WritePlaceFooter(md)
}

function ShowPlace172() {
	showGeneralPlace("Waiting Room", "policewaitingroom.jpg", "The waiting room for the police station", "exit the waiting room", 168)
}

function PuzzleGoldWorm(doc, bTrue) {
	var perTess = findPerson("Tess");
	if (bTrue !== true) bTrue = perTess.checkFlag(33) && (doc.Puzzle.answera.selectedIndex + doc.Puzzle.answerb.selectedIndex) * 25 / 40 == 24.375 || perTess.checkFlag(34) && doc.Puzzle.answera.selectedIndex == 3;
	if (bTrue) {
		perTess.other = 20;
		AddMana(20);
		perYou.addExperience(3)
	} else perTess.other = 15;
	perTess.place = 194;
	gotoPlace(174, "type=answer1")
}

function ShowPlace173(stype) {
	var md = WritePlaceHeader();
	if (!isPuzzles()) return PuzzleGoldWorm(md, true);
	var perTess = findPerson("Tess");
	if (!perTess.checkAnyFlags(33, 34)) perTess.setFlag(Math.floor(Math.random() * 2) + 33);
	md.write('<img src="Images/goldworm1.png" alt="Gold Worm">');
	addPlaceTitle(md, "Golden Worm Puzzle");
	md.write("<p>&quot;Another stupid creature,&quot; says the magical worm. " + "You wouldn't believe that a such a creature could exist but it does. It adds,</p>" + "<p>&quot;You do not have any chance of solving this riddle. Nobody ever has, but if you should do so, magic will be bestowed upon you.&quot;</p>");
	if (perTess.checkFlag(33)) md.write('<p style="text-align:center">Insert the missing number and letter:</p>' + '<form method="POST" name="Puzzle">' + '<div style="text-align:center"><table style="background-image:url(' + getThemeFolder() + 'background.jpg);padding:0px;border-collapse:collapse;border-spacing:0;border-width:0;margin:auto">' + "<tr>" + '<td style="text-align:center;width:30px"><p style="text-align:center">I</p></td>' + '<td style="text-align:center;width:30px"><p style="text-align:center">9</p></td>' +
		'<td style="text-align:center;width:30px"><p style="text-align:center">P</p></td>' + '<td><select name="answera" size="1">' + '<option selected value="1">1</option>' + "<option>2</option>" + "<option>3</option>" + "<option>4</option>" + "<option>5</option>" + "<option>6</option>" + "<option>7</option>" + "<option>8</option>" + "<option>9</option>" + "<option>10</option>" + "<option>11</option>" + "<option>12</option>" + "<option>13</option>" + "<option>14</option>" + "<option>15</option>" + "<option>16</option>" + "<option>17</option>" +
		"<option>18</option>" + "<option>19</option>" + "<option>20</option>" + "<option>21</option>" + "<option>22</option>" + "<option>23</option>" + "<option>24</option>" + "<option>25</option>" + "<option>26</option>" + "<option>27</option>" + "<option>28</option>" + "<option>29</option>" + "<option>30</option>" + "</select></td>" + "</tr>" + "<tr>" + '<td style="text-align:center;width:30px"><p style="text-align:center">5</p></td>' + '<td style="text-align:center;width:30px"><p style="text-align:center">L</p></td>' + '<td style="text-align:center;width:30px"><p style="text-align:center">14</p></td>' +
		'<td><select name="answerb" size="1">' + "<option>A</option>" + "<option>B</option>" + "<option>C</option>" + "<option>D</option>" + "<option>E</option>" + "<option>F</option>" + "<option>G</option>" + "<option>H</option>" + "<option>I</option>" + "<option>J</option>" + "<option>K</option>" + "<option>L</option>" + "<option>M</option>" + "<option>N</option>" + "<option>O</option>" + "<option>P</option>" + "<option>Q</option>" + "<option>R</option>" + "<option>S</option>" + "<option>T</option>" + "<option>U</option>" + "<option>V</option>" +
		"<option>W</option>" + "<option>X</option>" + "<option>Y</option>" + "<option>Z</option>" + "</select></td>" + "</tr>" + "</table>" + '</div><p style="text-align:center">');
	else md.write('<p style="text-align:center">Insert the next number in the sequence:</p>' + '<form method="POST" name="Puzzle">' + '<div style="text-align:center"><table style="background-image:url(' + getThemeFolder() + 'background.jpg);padding:0px;border-collapse:collapse;border-spacing:0;border-width:0;margin:auto">' + "<tr>" + '<td style="text-align:center" width="8"><p>1,11,21,1211,111221,312211&nbsp;</p></td>' +
		'<td><select name="answera" size="1">' + "<option selected>1</option>" + "<option>11113121</option>" + "<option>22331111</option>" + "<option>13112221</option>" + "<option>21113112</option>" + "<option>31112111</option>" + "<option>13121122</option>" + "<option>41112211</option>" + "<option>11141121</option>" + "<option>41112121</option>" + "</select></td>" + "</tr>" + "</table>" + '</div><p style="text-align:center">');
	md.write('<input type="button" name="button" value="Go" onClick="PuzzleGoldWorm(document)"></p></form>');
	startQuestions("If it is too hard then:");
	addLinkToPlace(md, "go to the hotel bar", 124);
	AddRightColumnMed();
	if (stype == "expose") perTess.showPerson("tess11a.jpg");
	else perTess.showPerson("tess10.jpg");
	WritePlaceFooter(md)
}

function ShowPlace174(stype) {
	var md = WritePlaceHeader(stype != "sex", stype == "sex" ? "td-left-large" : "");
	var perTess = findPerson("Tess");
	var bRight = perTess.other == 20;
	if (stype == "sex") {
		perTess.showPerson("tess11c.jpg");
		addPlaceTitle(md, "Making love to Tess");
		md.write("<p>Tess lies back sefuctively and you embrace her and you make love to your mutual ecstasy.</p>" + "<p>Later Tess tells you of her love for you, and how she will check for more magic. ");
		if (isDay()) {
			md.write('She gets out of the bed, trips over, and then redresses. She is an adorable clutz, and when you are ready she links her arm with yours and says "Shall we go?"</p>');
			startQuestions();
			if (perYourBody.FindItem(4) > 0 && perYou.checkFlag(11) && perYou.canUseExperience()) addOptionLink(md, "ask Tess for help deciphering the passages in the book", "spendExperience()");
			addLinkToPlace(md, "walk with Tess to the hotel bar", 124)
		} else {
			md.write(' She looks at you and asks,</p><p>"Night has fallen, why not spend the night here with me?"</p><p>A decidedly tempting proposition, like her last...</p>');
			startQuestions();
			if (perYourBody.FindItem(4) > 0 && perYou.checkFlag(11) && perYou.canUseExperience()) addOptionLink(md,
				"ask Tess for help deciphering the passages in the book", "spendExperience()");
			addSleepLink(md, "spend the night with Tess", "", "<p style='position:absolute;top:74%;left:55%;cursor:pointer;margin-top:-12px;font-size:x-large'><b>Going to Bed with Tess</b></p>" + '<p style="position:absolute;left:45%;top:75%;cursor:pointer;font-size:1.1em;width:55%">You spend the night with Tess in the hotel, to her delight and your equally great pleasure. In the morning you have a light breakfast with her in the hotel dining room before she leaves to speak to Victoria.',
				"tess11d.jpg", false, 124);
			addLinkToPlace(md, '"Not tonight Tess" and walk with Tess to the hotel bar', 124, "", "She gets out of the bed, trips over, and then redresses. She is an adorable clutz, and when you are ready she links her arm with yours and says &quot;Shall we go?&quot;")
		}
	}
	if (stype == "answer1" || stype == "answer2") {
		addPlaceTitle(md, "Golden Worm Answer", "", 0, true);
		md.write('<table class="table-main"><tr><td>&nbsp;</td><td><img src="Images/goldworm2.png" alt="Gold Worm"></td><td style="vertical-align:top">')
	}
	if (stype ==
		"answer1")
		if (bRight) {
			md.write('<p>"Correct!" says the worm. "Never before has a human been so clever. Your reward is forthcoming. My power is yours to use as you wish."</p>' + "<p>You absorb twenty mana points from the worm.</p>" + "<p>The worm then whispers to you, strange words, magical secrets of some sort that expand your magical knowledge.</p>");
			if (isSpellKnown("Transform")) stype = "answer2";
			else {
				md.write("<p>In the words of the worm you realise there is a secret knowledge that could yeild a spell, but you will only get one chance!</p>");
				startQuestions();
				if (perYou.FindItem(4) > 0)
					if (isRunes()) addOptionLink(md, "learn the spell", "Research('Spell','AlMass','',174,'type=answer2');");
					else md.write("<p>What are the strange words you heard?</p>" + '<p><form method="POST" name="FormChar"><input type="text" size="20" name="research"><input type="button" name="button" value="enter" onClick=ResearchOLD("AM",document.FormChar.research.value)></form></p>');
				else addLinkToPlace(md, "unfortunately you do not have the Book", 174, "type=answer2", "Regretfully you do not have the book...");
				AddRightColumnLarge();
				perTess.showPerson("tess11b.jpg")
			}
		} else {
			md.write('<p>"Fool!", yells the worm. "Such idiocy deserves nothing. Goodbye, you weak link of the human species"</p>' + "<p>You got the answer wrong. Better luck next time you play the game.</p>");
			stype = "answer2"
		}
	if (stype == "answer2") {
		md.write("<p>The worm freezes in place and falls silent. You start to ask Tess if there were any other items like this, and you notice Tess has removed some more of her clothing and is looking at you expectantly. She tells you,</p>" +
			'<p>"I think Victoria may be able to help me, but Love, we have this room for as long as we want, make love to me..."</p>');
		startQuestions();
		addLinkToPlace(md, "no words are needed, embrace her", 174, "type=sex");
		addLinkToPlace(md, '"Later Tess" and go to the hotel bar', 124, "", "Tess looks disappointed, but she smiles and gives you a quick kiss before dressing and then insists on walking arm-in-arm to the Bar");
		AddRightColumnLarge();
		perTess.showPerson("tess11b.jpg")
	}
	if (stype === "") return gotoPlace(124);
	WritePlaceFooter(md)
}

function ShowPlace175() {
	showGeneralPlace("Interrogation Room", "policeinterrogation.jpg", "The interrogation room for the police station", "exit the interrogation room", 168)
}

function isTrapped() {
	if (perYou.isBornMale()) return false;
	else if (!isCharmedBy("MrsRobbins", "Davy")) return false;
	else if (nMana >= 10 && isSpellKnown("Charm")) return false;
	else if (nMana >= 1 && isSpellKnown("Teleport")) return false;
	else if (nMana >= 3 && isSpellKnown("Pass")) return false;
	else if (perYourBody.FindItem(32) > 0) return false;
	else if (isSpellKnown("Pass") && nMana > 1) return false;
	else if (isSpellKnown("Invisibility") && nMana > 4) return false;
	return true
}

function ThrownToBedroom() {
	setPlaceFlag("RobbinsHouse", 9, false)
}

function ShowPlace176() {
	var perTina = findPerson("Tina");
	var perSister = findPerson("Tracy");
	var perMayor = findPerson("Mayor");
	var perGeraldine = findPerson("MrsRobbins");
	var bDCharm = perGeraldine.isCharmedBy("Davy");
	var b2Cols = perMayor.place == 176 || perSister.place == 176 || !isDay() && perTina.isVampyre() && !perTina.checkFlag(5);
	var md = WritePlaceHeader(false, b2Cols ? "td-left-small" : "");
	if (perSister.place == 176 && !perSister.isCharmedBy("Davy")) perSister.place = 1;
	if (isCharmedBy("Ellie", "You") && wherePerson("Ellie") == 93) movePerson("Ellie",
		420);
	if (perGeraldine.isCharmedBy("You") && perTina.isCharmedBy() && perTina.whereNow() == 130) {
		setPlaceKnown("TinasRoom");
		perTina.moveThem(163)
	}
	if (perGeraldine.isCharmedBy("You") && (perTina.isCharmedBy() && perTina.place != -1 && perTina.isHere() && !perTina.isVampyre())) perGeraldine.showPerson("robbins8b.jpg");
	else if (perGeraldine.isCharmedBy("You")) perGeraldine.showPerson("robbins4.jpg");
	else perGeraldine.showPerson(bDCharm ? "robbins1d.jpg" : "robbins1f.jpg");
	addPlaceTitle(md, "Robbins' Residence");
	md.write("<p>The Robbins' Residence at 36 Yoolaroo Drive is the address of the Mr and Mrs Robbins and their children Davy and Tina. Situated in the pleasant neighbourhood, the Robbins make sure that they keep their house tidy.</p>");
	startQuestions();
	if (isPlaceKnown("DavysRoom") && perGeraldine.isCharmedBy("You")) addLinkToPlace(md, "visit Davy's room", 93);
	if (isPlaceKnown("TinasRoom")) addLinkToPlace(md, "visit Tina's room", 163);
	if (!perYou.isBornMale() && bDCharm) addLinkToPlace(md, "exit the house", 130, "", "", "", "ThrownToBedroom()");
	else addLinkToPlace(md, "exit the house", 43);
	if (isTrapped() && checkPlaceFlag("RobbinsHouse", 9)) addLinkToPlace(md, "hit Mrs Robbins with a frying pan and run out of the house", 43);
	if (b2Cols) {
		AddPeopleColumnMed();
		if (!isDay() && perTina.isVampyre() && perTina.checkFlag(6)) perTina.showPerson("tina-stopped.jpg");
		if (perMayor.place == 176)
			if (!perMayor.isCharmed()) perMayor.showPerson("mayor2.jpg");
			else perMayor.showPerson("mayor2a.jpg");
		if (perSister.place == 176) perSister.showPerson("tracy9.jpg")
	}
	WritePlaceFooter(md)
}

function ShowPlace177() {
	var md = WritePlaceHeader();
	var perMG = findPerson("Mrs Granger");
	var clv = perMG.getCharmedLevel();
	var perKate = findPerson("Kate");
	var perAbby = findPerson("Abby");
	if (perMG.place === 177)
		if (clv > 0)
			if (perMG.checkFlag(13) && perKate.place == 1) perMG.showPersonRandom("!grangerfamily1", 2);
			else perMG.showPersonDN("granger-home.jpg");
	else perMG.showPerson("granger1.jpg");
	else addPlaceImage(md, "livingroom1.jpg");
	addPlaceTitle(md, "34 Yoolaroo Dr");
	md.write("<p>34 Yoolaroo Drive, the address of the Granger family.</p>");
	if (perMG.place === 177)
		if (clv === 0)
			if (perMG.extra[1] === 0) md.write("It is a pleasant house with a flower garden in the front yard. Everything is neatly trimmed and painted, reminding you of a house from a movie. The front fence is made of low pickets and the gate swings open without a squeak. A concrete pathway leads to the front door where you meet Mrs. Granger." + "<p>Smiling, Kate's mother greets you and asks you into the house. Looking around you can see Mrs. Granger is alone and you curse silently to yourself. Not wanting to appear rude you wait until you are in the front room.</p>" +
				"<p>You once heard Kate mention that her mother works as an archaeologist, and you think she said her mother has a 'top' position but only works part-time due to budget issues at her...university? Well that certainly explains where Kate got her brains from, and looking at Mrs. Granger now, at lot of her beauty as well!</p>");
			else md.write("<p>Smiling, Mrs. Granger meets you in the front room of the house.</p>");
	else if (perMG.other == 23) md.write('Mrs. Granger greets you with a kiss.<br><br>"I did as you asked, dear, and I have found something at the wild ranges."</p>');
	else if (perMG.other == 24 || getPersonOther("Tess") == 27) md.write('Mrs. Granger greets you with a kiss.<br><br>"What else can I do for you my dear?" she asks, her eyes imploring you.</p>');
	else if (perMG.other == 21 || clv == 3) md.write("Mrs. Granger greets you as you enter. She beckons you over; you can see what she has on her mind.</p>");
	else if (clv == 3) md.write("Mrs. Granger invites you in seductively and you see she is wearing her " + (isDay() ? "tight blue dress" : "blue lingerie") + ".</p>" + '<p>"Can I make you comfortable, dear?"</p>');
	else {
		if (clv == 1) md.write("Mrs. Granger invites you in and you see she is wearing her " + (isDay() ? "top and leather pants" : "exercise gear") + ".</p>" + '<p>"Why don\'t you make yourself comfortable, dear"</p>')
	} else {
		md.write("So far your visits here have been very rewarding.");
		if (perKate.place == 1) md.write(" As you step into the room you hear a noise elsewhere in the house.");
		md.write("</p>")
	}
	if (perKate.place == 9999 && (perMG.other == 50 && perMG.checkFlag(1)) && perMG.place !== 177) {
		md.write("<p>There is a opened letter on the table, a glance at it and it tells of Mrs. Grangers hospitalisation and that she is in the ICU.</p>");
		setPlaceKnown("Hospital")
	}
	if (perMG.place === 177) {
		if (perMG.extra[1] == 1) md.write('<p>"Hmm.  Would you like something to drink, hon?"<br>');
		else if (perMG.extra[1] == 1.1) md.write('<p>Mrs. Granger returns with a cold glass of water.  "Need anything else, hun?" she asks.</p>');
		else if (perMG.extra[1] == 4)
			if (perMG.checkFlag(33)) md.write('<p>She looks at you expectantly.  "Willing to help me out with my party planning?" she asks.</p>');
			else md.write('<p>She looks at you expectantly.  "Willing to help me out with my little problem?" she asks.</p>');
		startQuestions();
		if (perMG.extra[1] === 0) addQuestionC(md, "tell Mrs. Granger that she is very pretty", "MrsGranger", 240);
		else if (perMG.extra[1] >= 1 && perMG.extra[1] < 2) {
			if (perMG.extra[1] == 1) addQuestionC(md, "hopefully tell her you wouldn't mind a beer", "MrsGranger", 243);
			startAlternatives(md);
			addQuestionC(md, "ask Mrs. Granger if she works out often", "MrsGranger", 241);
			addQuestionC(md, "ask Mrs. Granger if you could help with anything", "MrsGranger", 245);
			addQuestionC(md, "ask Mrs. Granger if you could do anything...for...her",
				"MrsGranger", 246);
			endAlternatives()
		} else if (perMG.extra[1] == 2) addQuestionC(md, "ask Mrs. Granger about her work in archaeology", "MrsGranger", 242);
		else if (perMG.extra[1] == 6)
			if (isPuzzles()) addLinkToPlace(md, "try the puzzle", 39);
			else addLinkToPlace(md, "try the puzzle", 40, "type=right", "You discuss her problem and easily work out a solution for her");
		if (clv > 0) {
			if (clv > 1) addLinkToPlaceC(md, perMG.other > 3 ? 'tell Mrs. Granger "Let\'s Celebrate"' : "tell Mrs. Granger to get comfortable", Place, "type=comfortable");
			if (perMG.extra[1] == 15) addQuestionC(md, "ask if she has ever found anything magical", "MrsGranger", 2415);
			if (perMG.other == 1) addQuestionC(md, clv == 1 ? "ask her if she has ever explored the Wild Ranges" : "ask her to explore the wild ranges", "MrsGranger", 231);
			else if (Math.floor(perMG.other) == 2 && perMG.other > 2) addQuestionC(md, "ask what she found in the wild ranges", "MrsGranger", 232);
			else if (perMG.other == 3) addQuestionC(md, "ask if she found anything else", "MrsGranger", 233);
			else if (whereItem(29) == 240 && perMG.other ==
				4 && !checkPlaceFlag("Museum", 8) && perAbby.getQuestDragonGem() > 0)
				if (perAbby.getQuestDragonGem() < 3) addQuestionC(md, "ask her to find a dragon gem", "MrsGranger", 2502);
				else if (perAbby.getQuestDragonGem() == 3) addQuestionC(md, clv == 1 ? "ask her to check the museum to find the dragon vase" : "tell her to go to the museum and find the dragon vase", "MrsGranger", 2503);
			if (perMG.other > 3 && clv == 1 && !perMG.checkFlag(7)) addQuestionC(md, '"Celebrate?"', "MrsGranger", 1E3);
			if (clv == 1) addSleepLink(md, "ask Mrs Granger to spend the night",
				"", "<p style='position:absolute;top:3%;left:45%;width:55%;cursor:pointer;margin-top:-12px;font-size:x-large'><b>Sleeping over with Mrs. Granger</b></p>" + '<p style="position:absolute;left:45%;top:5%;cursor:pointer;font-size:1.1em;width:55%">You ask Mrs. Granger if they have a spare room and she immediately invites you,<br>' + '"Why not sleep with...spend the night here?", and she shows you to the spare bedroom. A little later you step out and see Mrs. Granger exercising in the lounge-room, completely naked. As you look appreciately, she looks back and smiles,<br>' +
				'"I love working up a sweat! Could you help me to get off...I mean up"<br><br><br><br><br><br>' + "You find it a little harder to get to sleep after this encounter!", perMG.getImg("granger-bed.jpg"));
			else addSleepLink(md, "go to bed for the night with Mrs Granger", "", "<p style='position:absolute;top:62%;left:2%;cursor:pointer;margin-top:-12px;font-size:x-large'><b>Going to Bed with Mrs. Granger</b></p>" + '<p style="position:absolute;left:2%;top:65%;cursor:pointer;font-size:1.1em;width:50%">You notice night has fallen, and as you look back at Mrs. Granger she reaches out and takes your hand and leads you into her bedroom. She changes into some delightful lingerie and lies down ready for you to join her.',
				perMG.getImg("granger-bed.jpg"));
			if (perMG.checkFlag(13) && perKate.place == 1) {
				addLinkToPlaceC(md, 'ask to watch some "Family Time"', 177, "type=familytimewatch");
				addLinkToPlaceC(md, 'ask for some "Family Time"', 177, "type=familytimejoin")
			}
		}
		if (perMG.other == 54 || perAbby.getQuestDragonGem() == 5) addQuestionC(md, "ask Mrs. Granger about the dragon vase", "MrsGranger", 2354);
		if (!(perMG.checkFlag(9) || perKate.checkFlag(16))) addQuestionC(md, "ask Mrs. Granger if she has seen Kate", "MrsGranger", 1)
	} else startQuestions();
	if (perKate.place == 1 || perKate.place == 139.5)
		if (perKate.place == 1 && perKate.other >= 15 && perKate.isCharmedBy("Davy")) addLinkToPlace(md, "visit Kate's room", 108);
		else if (perKate.checkFlag(6) || perKate.checkFlag(16)) addLinkToPlace(md, "visit Kate's room", 139, "", perMG.checkFlag(13) ? 'Kate follows you into her room. Mrs. Granger calls out, "Have fun!"' : "");
	else {
		if (perKate.place == 1 && perMG.place != 177) addLinkToPlaceC(md, '"Hello! Kate are you there?"', 139, "", "You call out to Kate, and she steps out and invites you into her room")
	} else addLinkToPlace(md,
		"visit Kate's room", 35);
	addLinkToPlace(md, "exit the house?", 43);
	WritePlaceFooter(md)
}

function ShowPlace178() {
	var md = WritePlaceHeader();
	addPlaceTitle(md, "Tunnel", "tunnel1.jpg");
	md.write("<p>Through the limestone of Glenvale you walk in the\tgloomy tunnel, a tunnel that must have been carved by the first inhabitants of the town.</p>");
	startQuestions();
	if (nFromPlace == 141) {
		addLinkToPlace(md, "go to the wild ranges", 26);
		addLinkToPlace(md, "go to the sacred clearing", 141)
	} else {
		addLinkToPlace(md, "go to the sacred clearing", 141);
		addLinkToPlace(md, "go to the wild ranges", 26)
	}
	WritePlaceFooter(md)
}

function ShowPlace179() {
	var md = WritePlaceHeader();
	var bGabbyTold = checkPersonFlag("Gabby", 1) && !isArrestPossible();
	if (bGabbyTold && perYou.checkFlag(12) && !perYou.checkFlag(25) && !perBeasley.checkFlag(3)) perBeasley.setFlag(9, false);
	perBeasley.showPerson("beasley7-male.jpg");
	addPlaceTitle(md, "Mr. Beasley Under a Spell");
	md.write('<p>Mr. Beasley is under your spell.</p><p>"Oh ' + perYou.getPersonName() + '," he says, suddenly admiring you in the way a teacher should not. "It is wrong for you to use magic on your teacher. If you insist on misbehaving I will have to give you a suitable punishment."</p>');
	startQuestions();
	if (!perYou.isBornMale()) addLinkToPlace(md, "tell Mr. Beasley to kiss you", 11, "type=service");
	else {
		startAlternatives(md);
		addLinkToPlace(md, "tell Mr. Beasley to service you", 11, "type=service");
		addLinkToPlace(md, "tell Mr. Beasley to serve you, but not with his body", 11, "", "You command Mr. Beasley to always serve you, but you make it clear that this is not in a sexual way, but is in <i>all</i> other ways. He smiles, &quot;Of course " + perYou.getMaster() + "!&quot;");
		endAlternatives(md)
	}
	if (perDavy.other ===
		6) addQuestionCO(md, "ask Beasley where Davy has gone", "MrBeasley", 5501);
	addLinkToPlace(md, "exit the room", 70);
	WritePlaceFooter(md)
}

function ShowPlace181() {
	showGeneralPlace(checkPersonFlag("DrKay", 2) ? "Tina's Room" : "Hotel Room", "hotel5.jpg", "Room 205, " + (checkPersonFlag("DrKay", 2) ? "Dr Tina Kay's room" : "the room of the nurse Bambi mentioned."), "return to the bar", 124)
}

function ShowPlace182(stype) {
	var md = WritePlaceHeader(false, stype !== "bambichat1" && stype == "bj" && !perYou.isMaleSex() && isExplicit() ? "td-left-large" : "");
	var perBambi = findPerson("Bambi");
	var myLord = perBambi.getYourNameFor();
	var myName = perYou.getMaster();
	var be = perBambi.checkFlag(16) ? "be" : "";
	if (stype == "bambichat1") {
		perBambi.showPerson("bambi16" + be + ".jpg");
		addPlaceTitle(md, "Bambi's Career");
		perBambi.setFlag(2);
		md.write("<p>As you make your way to the back of the bar, the room where usually you and Bambi spend your intimate time, you see the riding crop again and you become curious about Bambi\u2019s past with visitors. Bambi smiles and asks if she can change into something more appropriate. You give permission, and she returns a little while later dressed in some lovely lingerie,</p>" +
			'<p>"All right, Bambi! Talk to me about your career at the Hotel. The stuff you were doing with customers in this room.", you ask Bambi after she closed the door behind you.</p>' + '<p>"I was an escort, more or less, ' + myLord + '! I entertained them, I gave them what they wanted for their money! Regularly I slept with them or gave them a blowjob.", she answers in a reserved voice.</p>' + '<p>"Any fetishes involved? Anything interesting?", you ask your slave. While you do this you sit down in the couch in the middle of the room and order her to kneel next to it. She obliges without a word.</p>' +
			'<p>"' + myLord + '! I was a slut\u2026 I am not proud of what I\u2019ve did back then. Please\u2026I don\u2019t want you to know how many men I had sex with or what kind of sick things I had to for them.", Bambi begs and breaks down. She\u2019s almost crying, clearly disturbed by the topic.</p>' + '<p>"Answer me! I don\u2019t care what kind of person you were. Now you are mine, you have a new personality and a new purpose. So, out with it!", you push her more.</p>' + '<p>"As you wish, ' + myLord + '! I am your humble servant! There were some clients who liked BDSM and we roleplayed that I was the mistress and they were the slaves. Other times I was a caring girlfriend whom they only liked to talk to. There were a few men who liked hardcore things like caning and bondaging. Oddly though, my most bizarre experience was with a young man who wanted to watch movies with me while both of us were naked and eating fruits only. We didn\u2019t have sex or anything, just sitting next to each other on the couch without clothes. He was a strange guy\u2026", she looks up to you, her eyes vibrate with a purple glow. You can see she is trying to hold herself from crying and trying to show you respect and obedience.</p>' +
			'<p>"Hmm\u2026odd. You seemed to like this when we first met.", you put one hand on her head and play with her hair a bit.</p>' + '<p>"As I have mentioned I did not care who I slept with, I just wanted money to support myself better. I didn\u2019t want to talk about this, because I was afraid that you would throw me away if you knew about more about my past self.", Bambi answers with long pauses as she is enjoying your hand against her face, carefully putting her head next to your palm, fondling her nose to it and closing her eyes in the action. She is like a purring kitten enjoying the moment.</p>' +
			'<p>"You have to be honest with me! I am going to use you for many things and I can\u2019t have you lying to me. I have told you\u2026 I am not mad at you for who you were, but if you ever hold me back any information you know I will be unforgiving and disappointed. You don\u2019t want that, do you?", you playfully stroke her hair, then grab a handful of it and turn her head to face yours. Bambi opens her eyes and looks at you with honest love, the fear and skepticism  are gone from her face.</p>' +
			'<p>"I understand! I won\u2019t fail you again, I promise ' + myLord + '!", she firmly states.</p>' + "<p>Both of you stand up (Bambi after you, of course) and you pull yourself towards her and kiss her neck. After a minute or two the kisses turn into slow, soft bites.</p>" + '<p>"So let it be!", you say after you are finished.</p>')
	} else if (stype === "") {
		perBambi.showPerson("bambi17.jpg");
		if (perBambi.checkFlag(4)) perBambi.showPerson("bambimother.jpg", "40%");
		addPlaceTitle(md, "Bambi's Room");
		md.write("<p>Bambi is so overwhelmed by your invitation to the bedroom.  She can't wait to show you just how good a slave she can be, quickly preparing herself for your use.</p>" +
			'<p>"Oh ' + myLord + '," she says in a soft moan. "I\'ve never loved anyone as much as I love you. Please command me ' + myName + ', I live to serve you, and only you..."</p>');
		if (!perBambi.checkFlag(8)) md.write("<p>You notice a familiar stone in Bambi's room.  It would seem that such stones make excellent paper weights... or book ends.</p>");
		else if (!perBambi.checkFlag(4)) md.write("<p>You glance to the place where you saw the stone earlier. Nearby you see a framed photo of Bambi and an older woman.</p>");
		startQuestions("Accept her devotion and...");
		addLinkToPlace(md, "enjoy Bambi's services", 182, "type=bambifuck");
		if (perYou.isMaleSex()) addLinkToPlace(md, "get a blowjob", 182, "type=bambibj");
		else addLinkToPlace(md, "have her lick you", 182, "type=bambibj")
	} else if (stype == "bambifuck") {
		if (perYou.isMaleSex()) perBambi.showPersonRandomRorX("bambi7b" + be, isExplicit() ? 4 : 2);
		else perBambi.showPersonRandomRorX("bambi7g" + be, isExplicit() ? 2 : 1);
		addPlaceTitle(md, "Bambi");
		md.write("<p>Bambi pushes you onto the couch, straddles you in a single fluent motion and moves her lips close to yours. \u201cI am so happy to be of service again, my " +
			perYou.getLord() + "...\u201d She purrs out the last word in a deep, sensual voice, places her arms on your shoulders and presses her beautiful, naked body against yours. \u201cPlease, allow your faithful servant to tend to your needs...\u201d</p>" + "<p>You like how she uses these words to drag the moment out for precious seconds, allowing the subtle scent of her perfume to fill your nose and the warmth of her breath to caress your skin as the tension slowly builds up until you finally get to taste her sweet lips in a long, tender kiss.</p>" +
			"<p>And what a kiss it is.</p>" + "<p>Your tongues mingle, lips touch, soft, muffled gasps fill the room. Bambi has a way of subtly guiding you along, taking the lead often without you even realizing it and letting your body melt away under her tender care.</p>" + "<p>With each passing minute another piece of your clothes hits the floor, and every inch of exposed skin unveils new ways for her to fulfill desires you did not even know you had and guide you deeper into a sensual haze of lust, pleasure and just a sliver off pain to spice things up.</p>" +
			"<p>By the time " + (perYou.isBornMale() ? "your manhood finally pushes into her" : "you are finally grinding your folds against hers") + ", the actual act feels like an afterthought. A grand finale to Bambi's performance as you both prepare to share a last, intense climax and collapse in each other arms to bask in the afterglow.</p>")
	} else if (stype == "bambibj") {
		if (perYou.isMaleSex()) perBambi.showPersonRandomRorX("bambi12b" + be, isExplicit() ? 4 : 1);
		else perBambi.showPersonRandomRorX("bambi12g", isExplicit() ? 2 :
			1);
		addPlaceTitle(md, "Bambi");
		if (perYou.isMaleSex()) md.write("<p>A blowjob doesnt even get close to fully utilize Bambi's skills, but it is a good way to pass a few minutes when you are at the hotel and time is short, and Bambi certainly knows how to make the most of it.</p>" + "<p>Bambi treats your shaft as if it is the most delicious treat she ever had.</p>" + "<p>Her tongue expertly caresses your manhood, circling the tip and teasing the most sensitive veins in-between short bouts where she roughly forces the entire length into her throat and bobs her head back and forth, always alternating between sloppy and sensual, rough and tender, completely devoted to your pleasure and certain you are enjoying yourself immensely.</p>" +
			"<p>You want these moments to last forever, and while Bambi is able to drag them out, if you want her to, she also takes delight in her ability to suddenly and unexpectedly push you over the edge, and with a sudden rush of a thousand small electric shocks hitting your body, you unload your seed into your slave's mouth.</p>");
		else md.write("<p>Limiting Bambi to licking your pussy doesn't even get close to fully utilizing her skills, but it is a good way to pass a few minutes when you are at the hotel and time is short, and Bambi certainly knows how to make the most of it.</p>" +
			"<p>Bambi treats your pussy as if it is the most delicious treat she ever had. Her tongue expertly caresses your folds, circling the little nub and teasing your most intimate areas in-between short bouts where her fingers enter your twitching sex to roughly stimulate your most sensitive spots, always alternating between sloppy and sensual, rough and tender, completely devoted to your pleasure and certain you are enjoying yourself immensely.</p>" + "<p>You want these moments to last forever, and while Bambi is able to drag them out, if you want her to, she also takes delight in her ability to suddenly and unexpectedly push you over the edge, and with a sudden rush of a thousand small electric shocks hitting your body, you reach your peak, tensing up under the intense  rush of pleasure as Bambi leaps up your juices.</p>")
	}
	startQuestions(stype !==
		"" ? "Afterwards..." : "");
	if (!perBambi.checkFlag(8)) addQuestionCO(md, "grab the stone off the desk", "Bambi", 10701);
	else if (!perBambi.checkFlag(4)) addQuestionC(md, '"Nice photo Bambi, who is she?"', "Bambi", 10702);
	if (nMana >= 50 && wherePerson("Donna") === 0) addQuestionC(md, '"Have there been any new guests I should know about, my pet?"', "Bambi", 11900);
	if (perKurndorf.getQuestCrypt() == 6) addQuestionC(md, '"Do you know anything about Kurndorf?"', "Bambi", 2206);
	else if (perKurndorf.getQuestCrypt() == 10) addQuestionC(md,
		'"How do I find Kurndorf\'s grave?"', "Bambi", 2210);
	if (!isDay()) {
		if (wherePerson("Lauren") != 269 && (wherePerson("Diane") > 0 && !checkPersonFlag("MrsGranger", 1) || !isArrestPossible()) && !perBambi.checkFlag(6)) addQuestionC(md, '"Anything interesting happening at the hotel?"', "Bambi", 11901);
		addPopupLink(md, "go to bed for the night with Bambi", "", '<img src="Images/bambi15' + be + '.jpg" style="position:absolute;width:100%;bottom:0" alt="Bambi"></p>' + "<p style='position:absolute;top:5%;left:2%;cursor:pointer;margin-top:-12px;font-size:x-large;color:black;text-shadow:-1px -1px 0 white, 1px -1px 0 white, -1px 1px 0 white, 1px 1px 0 white;'><b>Going to Bed with Bambi</b></p>" +
			'<p style="position:absolute;right:2%;bottom:4%;cursor:pointer;font-size:1.1em;width:50%">Bambi invites you to stay for the night so she can serve you and show her considerable talents. You do not need another invitation as Bambi lies down ready to show you her devotion.', true, "sleepForNight(124,'In the morning you join Bambi for breakfast in the bar')", false, undefined, "background-color:#FFFAEA;top:10%;left:5%;width:85%;height:80%;padding:0")
	}
	addLinkToPlace(md, "go back down to the bar", 124);
	WritePlaceFooter(md)
}

function ShowPlace183() {
	var md = WritePlaceHeader();
	var perBambi = findPerson("Bambi");
	perBambi.showPerson("bambi10.jpg", "height:max");
	addPlaceTitle(md, "Bambi");
	md.write("<p>Bambi takes your money, then begins a seductive strip tease. " + "&quot;Well here are the twins, " + perYou.getPersonName() + ",&quot; she says, removing her top.</p>" + "<p>She stops dancing. &quot;Now that you have a taste for what I can " + "give you, how about five hundred for the rest?&quot;</p>" + '<p>"You\'ve got to be are kidding me!" you reply."I have to get out of here."</p>');
	if (isItemNotHere(6, 183) && nMana < 50) PlaceI(6, 183);
	if (whereItem(6) == 183) md.write("<p>As you turn to leave you see something on the floor, a stone being used as a door-stop.</p>");
	startQuestions();
	addLinkToPlace(md, "go to the bar", 124);
	WritePlaceFooter(md)
}

function BambiDominatesDavy() {
	perDavy.setFlag(3);
	movePerson("Bambi", 184)
}

function ShowPlace184(stype) {
	var perB = findPerson("Bambi");
	var md = WritePlaceHeader(false, stype == "interrupt" || (perB.place == 184 || stype == "looking" || stype == "training") && !isExplicit() ? "td-left-med" : "");
	var perKate = findPerson("Kate");
	var bKateCharmed = perKate.isCharmedBy("Davy");
	var myLord = perB.getYourNameFor();
	setPlaceFlag("Hotel", 8);
	var fldr;
	if (perB.place == 184 || stype == "looking") {
		setQueryParams("type=looking");
		perDavy.setFlag(3, false);
		perB.place = 124;
		if (isExplicit()) perDavy.showPersonRandomX("davy4", 2);
		else perDavy.showPerson("davy4.jpg");
		addPlaceTitle(md, "Bambi Looking After Davy");
		md.write("<p>You go to check on Davy, wondering why Bambi is not at the hotel bar, maybe she is doing something to look after him. As you enter the room you hear,</p>" + '<p>"..lick it faster scum! You are nothing, a pale shadow of ' + myLord + ', but you have one use. Ahh..that is better...Ahhhh!"</p>' + "<p>You see Bambi is sitting on Davy's face, forcing him to lick her, and she just came hard on his face. She looks at you, a guilty expression forms on her face and she says.</p>");
		if (checkPlaceFlag("Hotel", 8)) md.write('<p>"' + myLord + ' he asked for something to drink..."</p>');
		else {
			md.write('<p>"' + myLord + ' he asked for something from the cellar, but that place has been closed for years, I am not even sure where the door to it is. I doubt there is any decent wine there, so I decided he deserved something nicer..."</p>' + "<p>You doubt he was asking for wine, so what was he after in the cellar? You need to see if you can locate more recent sets of plans for the Broken Inn Hotel.</p>");
			setPlaceFlag("Hotel", 8)
		}
		md.write("<p>You can see from her talk previously about customers odd tastes, she must share them as well. She climbs off Davy and re-gags him.</p>");
		if (!perYou.isMaleSex()) md.write('<p>She asks you, "He has some skill but he needs more training. Would you like to train him?"');
		startQuestions();
		if (!perYou.isMaleSex()) addLinkToPlace(md, "train Davy", 184, "type=training");
		addLinkToPlace(md, "go back to the bar", 124);
		WritePlaceFooter(md);
		return
	} else if (stype === "training") {
		var bFirst = !perDavy.checkFlag(4);
		perDavy.setFlag(4);
		perDavy.showPersonRandomRorX("davy5", 2);
		addPlaceTitle(md, "Training Davy");
		if (bFirst) md.write("<p>Well, Davy certainly needs to be controlled and dominated, so some more training seems a good idea, and you are feeling aroused from watching Bambi with him. You briefly talk to Bambi in another room to get suggestions and tips for training Davy and she gives you some expert information.</p>" + "<p>Bambi provides you with a whip and you use it on his ass while talking about how he has failed and is now worthless, that you have taken his family, and freed all the people he had charmed. You tell him how he is a complete failure, only worth serving you and your servant Bambi.</p>" +
			'<p>After a while Bambi repositions him and removes his gag. Before he can speak you sit on him, filling his mouth with your pussy and you order him "Lick"</p>' + "<p>Sometime later, after Davy has satisfied you, you redress and notice Bambi reward Davy, stroking his cock until he cums. You leave Davy to Bambi's expert attentions.</p>");
		else md.write("<p>You return to further train Davy as your slave</p>");
		startQuestions();
		addLinkToPlace(md, "go back to the bar", 124);
		WritePlaceFooter(md);
		return
	} else if (stype ===
		"restrain") {
		perDavy.place = 184;
		perDavy.setFlag(8);
		startTimedEvent("BambiDominatesDavy()", 10);
		perDavy.showPerson("davy3.jpg");
		addPlaceTitle(md, "Restraining Davy");
		if (!perKate.checkFlag(22) && !perKate.checkFlag(23)) md.write('<p>Kate leaves the room, saying "I am going home to pack, do not follow me!".</p>');
		md.write("<p>You look at the unconscious Davy and you want to stop him from starting this all over again once he regains more Mana. While he is free from the influence of Kurndorf you have no doubt he will resume Charming people where he can and interfering with you.</p>" +
			"<p>You use the phone in the room to call the hotel bar and you ask Bambi to join you in the room, you hope she can help with Davy.</p>" + "<p>An excited Bambi enters the room a little later, and as she steps in she is already starting to undo her clothes, expecting something more carnal. You explain about how you need to restrain Davy for a while and ask if you can lock him in the room. She looks at Davy, and you see a grin form on her face,</p>" + '<p>"' + myLord + ' I know what to do here, excuse me for a few minutes while I get something"</p>' +
			"<p>She unplugs the phone in the room and gathers all of Davy's possessions, commenting she will lock these away.</p>" + "<p>About 5 minutes later she returns with a collection of ropes and other items and proceeds to expertly tie and gag Davy, tightly restraining him. As she does so she explains,</p>" + '<p>"' + myLord + ', I have had customers with odd tastes and I have a range of items to satisfy their needs."</p>' + "<p>You can see she must have had many such customers! She completes the rope work and she assures you that she will look after Davy for you.</p>");
		startQuestions();
		addLinkToPlace(md, "you notice Davy's phone on a table", 184, "type=checkphone");
		addLinkToPlace(md, "go back to the bar", 124);
		WritePlaceFooter(md);
		return
	} else if (stype === "restrainlater") {
		if (perDavy.checkFlag(6)) {
			AddImage("bedroom4.jpg");
			addPlaceTitle(md, "Davy has Escaped!");
			perDavy.place = 9999;
			perDavy.setFlag(7);
			md.write("<p>You take Bambi to the room but it is empty, is seems Davy has escaped, who knows where.</p>")
		} else {
			perDavy.place = 184;
			perDavy.setFlag(8);
			startTimedEvent("BambiDominatesDavy()",
				10);
			perDavy.showPerson("davy3.jpg");
			addPlaceTitle(md, "Restraining Davy");
			md.write("<p>You and Bambi go to room 101, and Bambi gets more and more excited as you approach, and as you open the door she is already starting to undo her clothes.</p>" + "<p>You explain about how you need to restrain Davy for a while and ask if you can lock him in the room. She looks at Davy, and you see a grin form on her face,</p>" + '<p>"' + myLord + ' I know what to do here, excuse me for a few minutes while I get something"</p>' +
				"<p>She unplugs the phone in the room and gathers all of Davy's possessions, commenting she will lock these away.</p>" + "<p>About 5 minutes later she returns with a collection of ropes and other items and proceeds to expertly tie and gag Davy, tightly restraining him. As she does so she explains,</p>" + '<p>"' + myLord + ', I have had customers with odd tastes and I have a range of items to satisfy their needs."</p>' + "<p>You can see she must have had many such customers! She completes the rope work and she assures you that she will look after Davy for you.</p>" +
				"<p>In passing you notice Davy's phone on a side table but it is locked and you doubt you could get him to give you the code.</p>")
		}
		startQuestions();
		addLinkToPlace(md, "go back to the bar", 124);
		WritePlaceFooter(md);
		return
	} else if (perDavy.checkFlag(5) && (!perDavy.checkFlag(6) && !perDavy.checkFlag(7) && !perDavy.checkFlag(8))) {
		perDavy.showPerson("davy8.jpg");
		addPlaceTitle(md, "Davy Unconscious in Hotel Room 101");
		md.write("<p>You see Davy is lying on the bed, still unconscious from Kate's blow.</p>");
		startQuestions();
		addLinkToPlace(md, "go back to the bar", 124);
		WritePlaceFooter(md);
		return
	} else if (perDavy.checkFlag(6) || stype == "escaped") {
		setQueryParams("type=escaped");
		AddImage("bedroom4.jpg");
		addPlaceTitle(md, "Davy has Escaped!");
		perDavy.place = 9999;
		perDavy.setFlag(7);
		md.write("<p>You see the room is empty, is seems Davy has escaped, who knows where.</p>");
		startQuestions();
		addLinkToPlace(md, "go back to the bar", 124);
		WritePlaceFooter(md);
		return
	} else if (isDavyDefeated()) {
		perDavy.showPerson("davy3.jpg");
		addPlaceTitle(md,
			"Davy Restrained in Hotel Room 101");
		md.write("<p>You see Davy is still tightly restrained, unable to speak or move, Bambi is a very good rigger.</p>");
		startQuestions();
		if (!perYou.isMaleSex() && perDavy.checkFlag(4)) addLinkToPlace(md, "train Davy some more", 184, "type=training");
		addLinkToPlace(md, "go back to the bar", 124);
		WritePlaceFooter(md);
		return
	} else if (stype == "plan") {
		perKate.unCharmThem();
		perKate.showPerson("kate15a.jpg");
		addPlaceTitle(md, "Planning with Kate");
		md.write("<p>You quickly stop Kate before she runs head-long into confront Davy, she looks at you annoyed,</p>" +
			'<p>"Not now, I need to punish an arsehole!"</p>' + "<p>You tell her that we need to work out how the confront him safely, he has controlled Kate before. She looks a little less certain");
		if (perKate.checkFlag(15)) {
			md.write(' but then touches the silver necklace and says, "But I am safe with this, right!", you cannot argue this and she just runs towards Davy\'s room, and you follow after her');
			startQuestions();
			addLinkToPlace(md, "follow Kate", 267, "type=kick")
		} else {
			md.write("</p>");
			startQuestions("What will you both do?");
			startAlternatives(md);
			addTextForQuestions(md, "<b>Kate suggests</b>", "center");
			addLinkToPlaceC(md, '"I\'ll run in and kick him before he can say a word!"', 267, "type=kick");
			addTextForQuestions(md, "<b>You suggest</b>", "center");
			addLinkToPlaceC(md, '"Let me go first and talk to him, you follow and kick him when I have him distracted"', 184, "type=distract");
			if (perYourBody.FindItem(32) > 0 || perYourBody.FindItem(33) > 0) addLinkToPlaceC(md, '"I\'ll take him out!"', 184, "type=mechoose");
			if (isCharmedBy("Bambi")) addLinkToPlace(md,
				"get Bambi to distract Davy with some room-service", 184, "type=roomservice");
			endAlternatives(md)
		}
		addLinkToPlace(md, "go back to the bar", 124, "", "As you leave Kate looks pissed off at your apparent cowardice! and runs toward the room Davy is in", "Kate", "setPersonFlag('Kate',4);movePerson('Kate', 4);");
		WritePlaceFooter(md);
		return
	} else if (perKate.place == 184 && !bKateCharmed) {
		perKate.showPerson("kate12b.jpg");
		addPlaceTitle(md, "Hotel Room 101");
		md.write("<p>You step into room 101, and you see Kate has removed her clothes and is looking lustfully at Davy. She turns to you and says,</p>" +
			'<p>"Hello,have you come to join in the fun?"</p>');
		startQuestions();
		if (perYourBody.FindItem(43) > 0 || perYourBody.FindItem(46) > 0) addLinkToPlace(md, "interrupt Davy's fun", 184, "type=interrupt");
		else addLinkToPlace(md, "interrupt Davy's fun", 990)
	} else if (perKate.place == 184 && !bKateCharmed && perKate.checkFlag(15)) {
		dispPlace(267);
		return
	} else if (stype === "" && bKateCharmed) {
		perKate.showPersonRorX("kate12a.jpg", "50vw");
		addPlaceTitle(md, "Hotel Room 101");
		md.write("<p>You stumble into room 101.  Kate and Davy are on the bed, <i>in flagrante delicto</i>.  The bed is shaking.</p>" +
			'<p>"Hello," says Kate, smiling a welcome to you. "Have you come to join in the fun?"</p>');
		startQuestions();
		if (perYourBody.FindItem(43) > 0 || perYourBody.FindItem(46) > 0) addLinkToPlace(md, "interrupt Davy's fun", 184, "type=interrupt");
		else addLinkToPlace(md, "interrupt Davy's fun", 990)
	} else if (stype == "interrupt") {
		if (isExplicit()) perKate.showPersonX("kate13.jpg");
		else perKate.showPerson("kate12a.jpg");
		addPlaceTitle(md, "Hotel Room 101");
		md.write('<p>Davy looks angry as you intrude on his activity. "You are really beginning to annoy me," he says, then you hear him whisper <i>"Dai Chu ' +
			perYou.getPersonName() + '"</i>.</p>');
		if (perYourBody.FindItem(46) > 0) md.write("<p>You feel a pulse of warmth in your bracelet.</p>");
		else md.write("<p>You feel a pulse of warmth from your necklace.</p>");
		md.write("<p>It takes him a moment to realize the spell didn't work, and you are sure you see a flash of fear in his eyes before his bravado reasserts itself.  \"I'll give you one minute to get out of this room and leave me and my bitch alone.\"</p>");
		startQuestions()
	} else if (stype == "distract") {
		if (perYourBody.FindItem(43) >
			0 || perYourBody.FindItem(46) > 0) {
			perDavy.showPersonFace();
			addPlaceTitle(md, "Take Davy Out")
		} else {
			fldr = "Player/" + sAvatarFolder;
			AddImage(fldr + "/charmedbydavy-start.jpg");
			addPlaceTitle(md, "Kate's Slave")
		}
		md.write('<p>You enter the room and confront Davy, with the ideal of distracting him while Kate attacks. You tell him "Davy, you are a fool, I have taken you slaves, and I have the book, you are nothing!"</p>' + '<p>Davy looks angry as you intrude on his activity. "Rubbish!" he says, then you hear him whisper <i>"Dai Chu' +
			perYou.getPersonName() + '"</i>.</p>');
		if (perYourBody.FindItem(43) > 0 || perYourBody.FindItem(46) > 0) {
			md.write("<p>The spell has no effect on you and Davy looks very afraid...</p>");
			startQuestions();
			addLinkToPlace(md, "Let Kate do her thing", 267, "type=kick&after=you")
		} else {
			md.write("<p>You feel a rush as the spell washes over you and you feel a surge of arousal. As you are becoming lost to the spell there is a blur as Kate runs in a drop-kicks Davy.</p>" + '<p>You look over at the scene, your mind a fog of arousal, and Kate looks at you annoyed, "Well you were useless, what good are you?"</p>' +
				'<p>You reply "Anything you want Mistress" and mean it as the spell locks you to the service of your beautiful mistress.</p>');
			startQuestions("You can only:");
			addRestartLink(md);
			WritePlaceFooter(md);
			return
		}
		AddPeopleColumn();
		perKate.showPerson("kate15a.jpg");
		WritePlaceFooter(md);
		return
	} else if (stype == "mechoose") {
		if (perYourBody.FindItem(43) > 0 || perYourBody.FindItem(46) > 0) {
			perDavy.showPersonFace();
			perDavy.showPersonFace();
			addPlaceTitle(md, "Take Davy Out")
		} else {
			fldr = "Player/" + sAvatarFolder;
			AddImage(fldr +
				"/charmedbydavy-start.jpg");
			addPlaceTitle(md, "Kates Slave")
		}
		md.write("<p>You enter the room with the intention of dealing with Davy yourself, Kate discretely follows you, waiting at the doorway.</p>" + '<p>Davy looks angry as you intrude on his activity. "You are really beginning to annoy me," he says, then you hear him whisper <i>"Dai Chu ' + perYou.getPersonName() + '"</i>.</p>');
		if (perYourBody.FindItem(43) > 0 || perYourBody.FindItem(46) > 0) {
			md.write("<p>The spell has no effect on you and Davy looks very afraid...</p>");
			startQuestions();
			addLinkToPlace(md, "Let Kate do her thing", 267, "type=kick&after=you");
			AddPeopleColumn();
			perKate.showPerson("kate15a.jpg");
			WritePlaceFooter(md);
			return
		} else {
			md.write("<p>You feel a rush as the spell washes over you and you feel a surge of arousal. As you are becoming lost to the spell there is a blur as Kate runs in a drop-kicks Davy.</p>" + '<p>You look over at the scene, your mind a fog of arousal, and Kate looks at you annoyed, "Well you were useless, what good are you?"</p>' + '<p>You reply "Anything you want Mistress" and mean it as the spell locks you to the service of your beautiful mistress.</p>');
			startQuestions("You can only:");
			addRestartLink(md);
			AddPeopleColumn();
			perKate.showPerson("kate15a.jpg");
			WritePlaceFooter(md);
			return
		}
	} else if (stype == "roomservice") {
		perB.showPersonRorX("bambi13.jpg");
		addPlaceTitle(md, "Room Service");
		md.write('<p>You ask Bambi to distract Davy with a little "room-service" and she eagerly agrees. You watch from nearby as she knocks on the door and enters a moment later. You wait for a discrete time and follow her into the room</p>' + '<p>Inside you see Bambi expertly giving Davy some complimentary "room-service". You can see Davy is quite absorbed, close to his..end of service.</p>' +
			"<p>You have a few moments to decide what to do, otherwise the angry Kate will take matters into her own hands.</p>");
		startQuestions();
		addLinkToPlace(md, "Let Kate do her thing", 267, "type=kick&after=bambi");
		AddPeopleColumn();
		perKate.showPerson("kate15a.jpg");
		WritePlaceFooter(md);
		return
	}
	addLinkToPlace(md, "go back to the bar", 124, "", "You leave Davy and Kate, and it seems likely that they will flee, given how fearful Davy has been of you", "", "perDavy.place = 9999;movePerson('Kate', 9999);");
	WritePlaceFooter(md)
}

function ShowPlace185(stype) {
	var md = WritePlaceHeader();
	var perDonna = findPerson("Donna");
	if (stype == "strip1") {
		setPlaceKnown("DonnasRoom");
		perDonna.showPerson("donna-hotel2.jpg");
		addPlaceTitle(md, "Donna's Strip-tease");
		md.write("<p>After you enter Donna\u2019s room she closes the door behind you and turns to you. In a few seconds she\u2019s already out of her dress and leaning against the door in only her black stockings.</p>");
		startQuestions();
		addLinkToPlaceC(md, '"Turn around! Make it sexy!"', 185, "type=strip2")
	} else if (stype ==
		"strip2") {
		perDonna.showPerson("donna-hotel3.jpg");
		addPlaceTitle(md, "Donna's Strip-tease");
		md.write("<p>She flashes a smile at you, obeying your request.</p>" + '<p>"I know that my little clam is much better than those girls\u2019s",  Donna teases you while slowly turns around facing the door. She puts both her hands up to give you a better look.</p>');
		startQuestions();
		addLinkToPlaceC(md, '"No way! You look good, but nowhere near as good as Bambi or Miss Titus. God, she has world class tits!"', 185, "type=strip3")
	} else if (stype ==
		"strip3") {
		perDonna.showPerson("donna-hotel4.jpg");
		addPlaceTitle(md, "Donna's Strip-tease");
		md.write("<p>You giggle to yourself knowing that Donna will try even harder now.</p>" + '<p>"Okay, but these legs are a thing to die for. You gotta acknowledge at least that!", she says.</p>' + "<p>Your ginger friend pulls her legs towards the sky, stretching them as strongly as she can.</p>");
		startQuestions();
		addLinkToPlaceC(md, '"Have to agree there! You put up a nice show!"', 185, "type=strip4")
	} else if (stype == "strip4") {
		perDonna.showPerson("donna-hotel5.jpg");
		addPlaceTitle(md, "Donna's Strip-tease");
		md.write("<p>She kneels in front of the door, trying to position her naked body for the best experience you can get.</p>" + '<p>"And this little show is only for besties like you!", she adds, a sensation in her voice can be heard. You understand now; she is having an orgasm just by teasing you. Donna doesn\u2019t look at you instead looking at the floor, reminding you  of your slaves.</p>');
		startQuestions();
		addLinkToPlaceC(md, '"Whew! That really did the trick! I feel great! I can already forget about all those annoyances!"',
			185, "type=strip5")
	} else if (stype == "strip5") {
		perDonna.showPerson("donna-hotel5.jpg");
		addPlaceTitle(md, "End of Donna's Strip-tease");
		md.write("<p>Donna looks up to you and you notice something in her eyes. The purple glow vividly dances, pointing out to you the power you have over her. And this power is growing as you can see the submissiveness in her eyes.</p>" + '<p>"Whenever you want it! That\u2019s what friends are for!"</p>');
		startQuestions()
	} else {
		if (!isDay()) perDonna.showPerson("donna8.jpg");
		else addPlaceImage(md,
			"hotel5.jpg");
		addPlaceTitle(md, "Donna's Room");
		if (isDay()) md.write("<p>Donna's hotel room, empty as Donna is not here, most lkely at the pool.</p>");
		else {
			if (!isPlaceKnown("DonnasRoom")) setPlaceKnown("DonnasRoom");
			md.write("<p>Donna\u2019s in her lingerie, sitting by the only table in her room. She plays with her stockings, trying to fix it when you enter. She leaves her lingerie as it is and hugs you, motioning you to sit down on her bed.</p>" + '<p>"' + perYou.getPersonName() + ", I\u2019m glad to see you. Please feel at home. What\u2019s mine is yours, as always. That includes my body too, you know\u2026\u201d she is trying to seduce you to bed. She is showing her pretty chest to you and holding you with both of her hands.</p>")
		}
		startQuestions();
		if (!isDay()) {
			addLinkToPlace(md, "enjoy Donna", Place, "type=enjoy");
			addPopupLink(md, "go to bed for the night with Donna", "Sleeping with Donna", '<img src="Images/donna10.jpg" style="position:absolute;width:100%;bottom:0" alt="Donna"></p>' + '<p style="position:absolute;left:4%;top:2em;cursor:pointer;font-size:1.1em;width:60%">' + "You jump into the bed followed by Donna. Raw, friends with benefits type of sex keeps you awake through most of the night. When Donna is exhausted she goes to take a shower, finnally letting you some well deserved sleep. Your bestie joins you in your rest, tugging in and hugging you from the back.",
				true, "sleepForNight(124,'In the morning you join your friend Donna for breakfast in the bar')", false, undefined, "top:10%;left:5%;width:85%;height:80%;padding:0")
		}
	}
	addLinkToPlace(md, "go to the Hotel Bar", 124);
	WritePlaceFooter(md)
}

function ShowPlace186(stype) {
	var md = WritePlaceHeader();
	var perAR = findPerson("AdeleRoss");
	perAR.setFlag(4);
	perAR.showPerson("Setting/adele1.jpg");
	if (stype == "sacred") {
		addPlaceTitle(md, "Sacred Clearing");
		md.write("<p>As you enter the clearing, you are approached by a policewoman. You think she is your friend Amy's older sister but you have only me her once quite a while ago.</p>")
	} else {
		addPlaceTitle(md, "Gates Estate");
		md.write("<p>Before you can enter the house, you are barred by a policewoman. You think she is your friend Amy's older sister but you have only me her once quite a while ago.</p>")
	}
	if (isMurderPath()) md.write("<p>There are a couple of other officers in the area, apparently searching the grounds.</p>" +
		"<p>No matter how much you plead, you are not allowed to enter.</p>");
	else {
		md.write("<p>She tells you that this place is under police protection and no one is permitted entry to the estate without prior approval.</p>");
		if (isCharmedPath()) md.write("<p>Unfortunately you now realise you do not have " + perGates.getPersonNameShort() + "'s phone number and a quick check shows his number is unlisted.</p>")
	}
	startQuestions();
	if (isPlaceKnown("Tunnel") && stype == "sacred") addLinkToPlace(md, "go in the tunnel", 178);
	addLinkToPlace(md, "return to the grounds?", 16);
	WritePlaceFooter(md)
}

function ShowPlace187() {
	var md = WritePlaceHeader();
	AddImage("Setting/polb2.jpg");
	addPlaceTitle(md, "Kerry Under a Charm Spell");
	md.write("<p>Your spell works, and quickly takes hold of " + getPoliceChief() + " Batton. " + '"God, I\'m horny," says the firm-looking police woman. ' + '"It must have been something in the coffee to make me feel this good.."</p>');
	startQuestions();
	addLinkToPlaceC(md, "tell Kerry that she looks hot", 188);
	addLinkToPlace(md, "exit the police station", 167);
	WritePlaceFooter(md)
}

function ShowPlace188() {
	var md = WritePlaceHeader();
	AddImage("Setting/polb3.jpg");
	addPlaceTitle(md, "Kerry Under a Charm Spell");
	md.write("<p>&quot;Do you think so?&quot; Kerry says.  She turns and puts her gun " + "on the desk &quot;Not many people know this but I have a " + "fantasy about arresting someone like you and. . . Well " + "let's just say that I have a terrific imagination. Do you " + "want to see what I mean?&quot;</p>");
	startQuestions();
	addLinkToPlace(md, "ask Kerry to show you", 189);
	addLinkToPlace(md,
		"exit the police station", 167);
	WritePlaceFooter(md)
}

function ShowPlace189() {
	var md = WritePlaceHeader();
	AddImage("Setting/polb4.jpg");
	addPlaceTitle(md, "Kerry Under a Charm Spell");
	if (isBritish()) md.write("<p>Kerry pulls off her skirt exposing her natural, unshaven pussy. You can see her large breasts moving in her white shirt.</p>" + '<p>"This is the first part of my fantasy," she says, her voice becoming husky. "I arrest my subject. Show ' + perYou.getHimHer() + " my beautiful pussy then tease the hell of " + perYou.getHimHer() + " by masturbating while all " +
		perYou.getHeShe() + ' can do is watch me get off."</p>');
	else md.write("<p>Kerry pulls off her top and her huge breasts fall out of the bra.</p>" + '<p>"This is the first part of my fantasy," she says, her voice becoming husky. "I arrest my subject. Show ' + perYou.getHimHer() + " my beautiful big titties then tease the hell of " + perYou.getHimHer() + " by masturbating while all " + perYou.getHeShe() + ' can do is watch me get off."</p>');
	startQuestions();
	addLinkToPlaceC(md, "tell Kerry to show you", 190);
	WritePlaceFooter(md)
}

function ShowPlace190(stype) {
	var md;
	if (stype === "") {
		md = WritePlaceHeader(false, isBritish() ? "" : "td-left-med");
		AddImage("Setting/polb5.jpg");
		addPlaceTitle(md, "Kerry Under a Charm Spell");
		md.write('<p>"Well watch me then." Kerry says. Her hand snakes down to a place between her legs. Staring into your eyes, she pushes herself to the limit - groaning and thrusting her hips until she cries out your name, "Oh ' + perYou.getPersonName() + ', fuck me!"</p>');
		startQuestions();
		addLinkToPlace(md, "take her", 190, "type=take")
	} else {
		if (perYou.isMaleSex()) {
			md =
				WritePlaceHeader(false, isBritish() && !isExplicit() ? "" : "td-left-med");
			AddImageRorX("Setting/polb7b.jpg")
		} else if (isBritish()) {
			md = WritePlaceHeader(false, isExplicit() ? "" : "td-left-med");
			AddImageRandomRorX("UK/polb7g", isExplicit() ? 3 : 1)
		} else {
			md = WritePlaceHeader(false, isExplicit() ? "" : "td-left-med");
			AddImageRandomRorX("US/polb7g", 1)
		}
		addPlaceTitle(md, "Enjoying your new Slave");
		md.write("<p>You cannot refuse her invitation and you sate yourself on her body, and she upon yours.</p>");
		startQuestions()
	}
	addLinkToPlaceC(md,
		"talk more with Kerry", 168);
	addLinkToPlace(md, "exit the police station", 167);
	WritePlaceFooter(md)
}

function ShowPlace191() {
	var md = WritePlaceHeader();
	if (perYou.getQuestAftane() < 10) addPlaceImage(md, "safe-closed.jpg");
	else addPlaceImage(md, "safe-open.jpg");
	addPlaceTitle(md, "Gates Family Safe");
	md.write("<p>You see a small safe, relatively unmentionable... aside from the fact that you don't know where the key is nor does Sarah.  However will you get it open?</p>");
	if (perYou.getQuestAftane() < 10) md.write("<p>The safe seems to be stuck, or shall we say... locked...  shut.</p>");
	else md.write('<p>The safe seems to have just "popped" open...</p>');
	startQuestions();
	addLinkToPlace(md, "revisit Sarah in the main room", 192);
	WritePlaceFooter(md)
}

function ShowPlace192(stype) {
	var md = WritePlaceHeader();
	var bMurder = isMurderPath();
	var perMiku = findPerson("Miku");
	var perLauren = findPerson("Lauren");
	var perSarah = findPerson("Sarah");
	var bCharmed = perSarah.isCharmedBy();
	var myName = perSarah.getYourNameFor();
	if (perSarah.place == 17) perSarah.place = 192;
	if (whereItem(41) == 191) moveItem(41, 192);
	if (perYou.getQuestAftane() == 3 && bCharmed && bMurder) perYou.setQuestAftane(1);
	if ((bCharmed || isConspiracyPath()) && whereItem(4) == 998) moveItem(4, 999);
	var bAfter = perSarah.place ==
		192 && (Math.floor(perSarah.other) == 114 || Math.floor(perSarah.other) == 117 || Math.floor(perSarah.other) == 120);
	if (perMiku.other == -3) addPlaceImage(md, "mansionlibrary.jpg");
	else if (bAfter) perSarah.showPerson("sarah13.jpg");
	else if (bCharmed) perSarah.showPersonDN("sarah7.jpg");
	else if (bMurder) perSarah.showPerson("sarah1a.jpg");
	else perSarah.showPersonDN("sarah12.jpg");
	if (bMurder) addPlaceTitle(md, "Gates Mansion");
	else addPlaceTitle(md, "Sarah Gates's Room");
	if (stype == "magic" || stype == "power") {
		perLauren.showPersonDN("lauren1a.jpg",
			"40%", "right");
		if (stype == "magic") {
			perYou.addCorruption(-5);
			md.write("<p>You explain about you fascination with magic and the legends of the Book of Control and how this has shaped your quest to date. Sarah listens sipping her wine with a doubtful expression on her face, she does not seem to completely believe you.</p>")
		} else {
			perYou.addCorruption(5);
			md.write("<p>You agree with Sarah, she has summed up what you want as well, though maybe the term 'modicum' could be expanded upon.</p>")
		}
		md.write('<p>"Well ' +
			perYou.getPersonName() + ' I think our first order of business is to exchange magic. Please teach me the spells you have learned so far. I will teach you the spell I know currently and any more I learn."</p>' + "<p>You spend a little while teaching Sarah the spells from the Book that you know, she is brilliant and learns the spells with no effort. She offers to teach you her spell any time you like.</p>" + "<p>Lauren re-fills the wine glasses, and Sarah continues talking, \"You are looking to perform a s\u00e9ance soon, to talk to the despised warlock Kurndorf. You must be very careful, he will be dangerous even in death. You will need protection, my uncle has an item call an 'Aftane' that will help you.\"</p>" +
			'<p>She pauses, "Do not attempt to ally yourself with Kurndorf, he will enslave you, he will never help you or share power with you, just use you for his own evil."</p>' + '<p>She smiles again, "Alright, let\'s leave it there for now, you are welcome to visit again other evenings in the same way you did tonight. Lauren can escort you out of the mansion when you wish to leave. Ohh one last thing, Lauren is my maid, mine in mind and body, she will do anything I ask of her."</p>' + "<p>You see Lauren look at Sarah, a look of acceptance and loyalty, not one of devotion.</p>")
	} else if (perSarah.place ==
		192 && perSarah.other == 50 && isConspiracyPath()) {
		perYou.setQuestAftane(1);
		perSarah.setFlag(1);
		perSarah.other = 51;
		perYourBody.RemoveItem(40);
		perLauren.showPersonDN("lauren1a.jpg", "40%", "right");
		md.write("<p>Lauren leads you to a bedroom and gestures for you to enter before her, which you do and you are met by a beautiful young woman dressed in a lovely black nightie. She smiles at you as Lauren takes her place nearby,</p>" + '<p>"Well ' + (perYou.isBornMale() ? "Mr" : "Miss") + " Not Apprentice, we finally meet in person. I am Sarah Gates, the niece of " +
			perGates.getPersonNameShort() + ' Gates whom you met before."</p>' + '<p>She looks at the wine bottle you are carrying, "An excellent vintage, a delightful exchange of gifts isn\'t it Lauren? Will you please pour the wine for us Lauren, you may have a glass as well if you like". Lauren opens the bottle and pours 3 glasses handing one to Sarah and then one to yourself. She stands back, awkwardly sipping from the remaining glass.</p>' + "<p>One small thing you noticed in that exchange there, Sarah subtly stressed Lauren's name. Was she teasing Lauren about her offer at the hotel, but it seemed something else, maybe Lauren is a nickname or something.</p>" +
			'<p>Sarah sips her wine and addresses you, "I suppose you want to know why I am doing this, taking the Book of Control and helping you. It is simple, Uncle Ronny will not teach me magic, he says my attitude is wrong, that magic is to defend and help, never for your personal desires. I am no Buddhist or Jedi, but I am not a wanton power-mad despot like the warlock Kurndorf was. ' + 'I want to have fun and a modicum of power and not <i>only</i> help people. I can see you have similar desires from what I have seen of your explorations. Is that not true?"</p>');
		startQuestions("You reply");
		addLinkToPlaceC(md, '"No, I am just fascinated by magic"', 192, "type=magic");
		addLinkToPlaceC(md, '"Yes, that is it precisely!"', 192, "type=power");
		WritePlaceFooter(md);
		return
	} else if (isConspiracyPath()) {
		md.write("<p>You knock on the door to Sarah Gate's room and she brightly asks you to enter.</p>");
		if (whereItem(25) == 999 || whereItem(21) == 999) {
			md.write('<p>"' + perYou.getPersonName() + "! I am so glad you are alright.  I visited you in the hospital but you were still in intensive care.  Here, the police brought a few things from when you were shot, I was able to keep them from Uncle Ronnie.</p>");
			if (whereItem(25) == 999) moveItem(25);
			if (whereItem(21) == 999) moveItem(21)
		}
	} else if (bCharmed) {
		md.write("<p>Sarah Gates is so glad to see her One True " + perYou.getMaster() + ". She grovels before you, begging for attention.</p>");
		if (perLauren.flags[0] === 0)
			if (whereItem(40) == 192) md.write('<p>"This wine looks very delicious.  Thank you, ' + perYou.getMaster() + '. Would you like me to call the maid to open it?" Sarah asks.</p>');
			else if (perYourBody.FindItem(40) > 0) md.write('<p>"Oh yes, ' + myName + '," says Sarah. "I see that you brought me a special wine. Please give it to me so we can celebrate my new role as your faithful, loyal, devoted, and oh so <i>willing</i> slave."</p>');
		else md.write('<p>"' + perYou.getMaster() + '," says Sarah. "I am so thirsty... if only we had a bottle of wine, I could serve you properly..."</p>');
		else md.write('<p>"Thank you for the wine, ' + perYou.getMaster() + '. Is there any <i>other</i> way that I may serve you?"</p>');
		if (perSarah.checkFlag(1) && !isSpellKnown("Clairvoyance")) md.write('<p>"Oh darling," she says in a husky tone. "I can teach you something I know you would like. A spell, so powerful that it will lead you to places no other can go."');
		if (whereItem(25) == 999 || whereItem(21) == 999) {
			md.write('<p>"' + perYou.getMaster() + "! I am so glad you are alright.  I visited you in the hospital but you were still in intensive care.  Here, the police brought a few things from when you were shot.</p>");
			if (whereItem(25) == 999) moveItem(25);
			if (whereItem(21) == 999) moveItem(21)
		}
	} else if (bMurder) {
		md.write("<p>You enter the Gates' Mansion to see a elegant young lady, sitting on the floor. You recognise her from her from the paper. It is Sarah Gates, the richest lady in Glenvale.</p>");
		if (perSarah.other === 1) md.write('<p>She is obviously distressed by the departing of her uncle Ronald. Drying tears away she looks up to see you. "Who are you?" she asks in a sweet, if wearied voice. "Do you know what happened to Uncle Ronny?"</p>')
	} else if (perSarah.place == 192 && (perSarah.other == 114 || perSarah.other == 117 || perSarah.other == 120)) md.write("<p>Sarah sits up after Lauren finishes 'attending' her, still partially unclothed. Lauren stand nearby looking acutely uncomfortable.</p>");
	else md.write("<p>You knock on the door to Sarah Gate's room and she brightly asks you to enter.</p>");
	if (perLauren.flags[0] == 1) md.write("<p>With a brisk, set pace a woman enters the room to open the darkened bottle of wine. For the first time you notice that the label seems old and faded.  Most likely a rather rare and expensive wine, and very good as well. With practiced grace she lifts the bottle and pours out the appropriate amounts, filling the flute with a deep red liquid, almost as if blood poured for the lips of her mistress. After setting the wine down carefully upon the table, she takes hold of the slender shaft of a feather duster and waits for permission to leave.</p>" +
		"<p>When you turn your eyes upon her, she seems to lightly tilt her head and look away not seeming to care about your presence one or another, simply tolerating you for the moment. However, your eyes tend to stray to the shiny material of uniform, done in the classic cut of a French maid, with the appropriate touches of frilly lace, high heels and stockings, but, done in latex instead of the usual cotton or silk. Upon her release, she quickly turns and makes her way back into a guest rooms.</p>");
	startQuestions();
	if (bCharmed) addLinkToPlaceC(md, '"You may <i>serve</i> me now Sarah."', Place, "type=sarahservice");
	if (bMurder || isConspiracyPath()) {
		if (perYou.getQuestAftane() > 0) {
			if (perYou.getQuestAftane() == 1) addQuestionC(md, isConspiracyPath() ? '"Do you know where your uncle keeps the <i>Aftane</i>?"' : '"Do you know where your uncle kept the <i>Aftane</i>?"', "Sarah", 901);
			if (perYou.getQuestAftane() == 5) addQuestionC(md, '"Show me this safe. The one with the Aftane."', "Sarah", 905)
		}
		if (perSarah.checkFlag(1) &&
			!isSpellKnown("Clairvoyance")) addQuestionC(md, "try to learn the spell", "Sarah", 2801);
		if (perYou.isShot() && whereItem(4) == 999) addQuestionC(md, '"Do you have the book?"', "Sarah", 999);
		if (isDemonFreed() && !perGates.checkFlag(6)) addQuestionC(md, "ask Sarah about demons", "Sarah", 666)
	}
	if (isConspiracyPath()) {
		if (perYourBody.FindItem(4) > 0 && perYou.checkFlag(11) && perYou.canUseExperience()) addOptionLink(md, "ask Sarah for help deciphering the passages in the book", "spendExperience()");
		if (!perSarah.checkFlag(5)) addQuestionC(md,
			'"Can you help me with some money?"', "Sarah", 100)
	} else if (bMurder) {
		if (perDavy.getQuestBlueBottle() == 4) addQuestionC(md, '"Hey... Have you noticed a, uh...  little <i>blue</i> bottle lying around?"', "Sarah", 5904);
		else if (perDavy.getQuestBlueBottle() == 5 && bCharmed) addQuestionC(md, '"Lets try this again...  Have you noticed a little blue bottle?"', "Sarah", 5904);
		if (perSarah.other == 1) {
			if (isMurderPath(true)) addQuestionC(md, '"I saw his murderers, Miss."', "Sarah", 2904);
			else addQuestionC(md, '"I\'m afraid <i>I</i> killed your uncle, Miss."',
				"Sarah", 2901);
			addQuestionC(md, '"I\'m a police detective"', "Sarah", 2902)
		} else if (perSarah.other == 2) addQuestionC(md, '"Why couldn\'t I have killed him?"', "Sarah", 2903);
		else if (perSarah.other == 3) addQuestionC(md, '"Why couldn\'t they have killed him?"', "Sarah", 2906);
		else if (perSarah.other == 5) addQuestionC(md, '"Please just come down to the station with me"', "Sarah", 2905)
	}
	if (sType === "" && whereItem(40) == 192 && perLauren.flags[0] === 0 && bMurder) addQuestionC(md, '"Summon the maid, Sarah."', "Sarah", 11200);
	if (perLauren.flags[0] ==
		1) addLinkToPlace(md, "follow the maid to the guest rooms", 290, "", "", "", "", "moveblock");
	else if (perLauren.checkFlag(3)) addLinkToPlace(md, "go to the guest room", 290, "", "", "", "", "moveblock");
	if (bMurder && bCharmed) addSleepLink(md, "take Sarah to bed for the night", "Sleeping with Sarah", '<p style="position:absolute;left:5%;top:15%;cursor:pointer;font-size:1.1em;width:50%">' + "You tell Sarah that it is time for bed, and she calls Lauren to prepare the bed, and then lies down ready for you to join her.", perSarah.getImg("sarah-bed1.jpg"),
		true);
	if (!isConspiracyPath() && !bMurder) {
		addLinkToPlace(md, "leave Sarah's room", 18, "area=upstairs", "", "", "", "moveblock");
		addLinkToPlace(md, "go downstairs", 18, "", "", "", "", "moveblock")
	}
	addLinkToPlace(md, "exit the house", 16);
	if (bAfter || bMurder && perLauren.flags[0] == 1 || isConspiracyPath() && stype === "" || isCharmedPath()) {
		AddPeopleColumnMed(md);
		perLauren.showPersonDN("lauren1a.jpg")
	}
	WritePlaceFooter(md)
}

function ShowPlace193() {
	var perJessica = findPerson("Jessica");
	if (perJesse.place == 161) perJesse.place = 193;
	var b2Cols = perJesse.place == 193;
	var md = WritePlaceHeader(false, b2Cols ? "td-left-small" : "td-left");
	var bLonely = perJessica.checkFlag(1) && !perJessica.checkFlag(7) && perJessica.checkFlag(6) && perJessica.other > 10 && perJesse.place != 193;
	if (bLonely) perJessica.showPerson("jessica1c.jpg", "height:max");
	else perJessica.showPerson(perJessica.checkFlag(1) ? "jessica1b.jpg" : "jessica1a.jpg", "height:max");
	var myName = perJessica.getYourNameFor();
	addPlaceTitle(md, "Dungeon");
	md.write("<p>You pass through a magic door into a dungeon hidden under the hotel. ");
	if (bLonely) {
		perJessica.setFlag(7);
		md.write("Jessica is sitting on a chair and looking up at you a little sadly. You ask her what is the matter, and she smiles a little,</p>" + '<p>"Welcome back ' + perJessica.getYourNameFor() + ', do not worry, I have been here too long, and you kind words before affected me. I was thinking about what could have been if I was not trapped here, and what could be if I can finally be freed."</p>' +
			"<p>You ask if there is anything you can do for her now, or just if she would like to talk. She smiles,</p>" + '<p>"Thank you again ' + perJessica.getYourNameFor() + ', please just do your best to find how to perform the summoning."</p>')
	} else if (perJessica.checkFlag(1)) md.write('Jessica looks at you with a gentle smile, "Welcome back ' + perJessica.getYourNameFor() + '.". She seems to have altered her clothing for you.</p>');
	if (perJessica.other === 0) md.write("From the shadow and mist comes out a lady dressed in black. You are already feeling anxious just by standing there alone with her. She slowly eyes you up and down, her calm and otherworldy presence makes you even more afraid. She\u2019s someone powerful who you don\u2019t want to cross paths with in a bad way!</p>" +
		"<p>She's staying mostly in the darkness, but you can still make out her pale white face and red hair whose colour reminds you of blood. Her dress looks like something from the previous century. Maybe she knows something about Kurndorf? You have to be careful, though, because she could be a magic wielder too!</p>" + "<p>She's waiting patiently without a single word leaving her mouth, it looks like she wants you to make the first move.</p>");
	if (perJesse.place == 193) md.write('<p>Jessica exclaims, "Oh ' +
		myName + ', I knew that you would bring another for our s\u00e9ance. Lets get started, do you have the information we need?"</p>' + '<p>Jesse says "What you mean like with a Ouija Board and all that, sounds like fun!", and Jessica answers,</p>' + '<p>"Yes young lady, something like that. We need a person to play the part of the Medium, are you happy to do this for ' + myName + ' and myself?", and Jess laughs,</p>' + "<p>\"That's funny, " + myName + " you said! Sure let's have some fun!\"</p>");
	startQuestions();
	if (!perJessica.checkFlag(5)) addQuestionC(md,
		"ask her who she is", "Jessica", 1E3);
	else if (perJessica.other === 0) addQuestionC(md, "ask Jessica if she is the witch from the legend", "Jessica", 12500);
	else {
		if (!perJessica.checkFlag(3)) addQuestionC(md, "ask Jessica where you can find more mana", "Jessica", 12600);
		if (perJessica.other == 1) addQuestionC(md, "ask Jessica why Kurndorf put her in this prison", "Jessica", 12502);
		else if (perJessica.other == 10) {
			startAlternatives(md);
			addQuestionC(md, "ask how you could learn Kurndorf's spells", "Jessica", 12510);
			addQuestionC(md,
				"ask how you can help free her", "Jessica", 12511);
			endAlternatives(md)
		}
	}
	if (perJessica.other == 11 && perJesse.place == 193 && perYourBody.FindItem(26) > 0) addQuestionC(md, 'say, "I have everything we need.  Let\'s get this s\u00e9ance started."', "Jessica", -2749);
	if ((perDavy.getQuestBlueBottle() == 10 || perDavy.getQuestBlueBottle() == 20) && perYourBody.FindItem(33) > 0) addQuestionC(md, "ask Jessica about the blue bottle", "Jessica", 5910);
	addLinkToPlace(md, "leave the dungeon", 161, "", "", "", "setPersonFlag('Jessica',6)");
	if (b2Cols) {
		AddPeopleColumnMed();
		perJesse.showPerson("jesse1a.jpg")
	}
	WritePlaceFooter(md)
}

function ShowPlace194() {
	var md = WritePlaceHeader();
	var perJ = findPerson("JohnAdams");
	var perTess = findPerson("Tess");
	var bTessHere = isShopOpen(0) && perTess.place == 194;
	addPlaceTitle(md, "Shopping Center", isDay() ? "shops" + (Math.floor(Math.random() * 2) + 2) + ".jpg" : "shops1.jpg", 75);
	var b2Cols = bTessHere || perJ.place == 194 && perJ.other >= 30 && perJ.other < 40;
	md.write("<p>" + getShopStore(true) + "s line the Glenvale central shopping street. ");
	if (isDay()) md.write("At this time of day the townsfolk are browsing casually along the footpaths.</p>");
	else md.write("At this time of day there are only a few townsfolk around.</p>");
	if (!checkPlaceFlag("ShoppingCenter", 7)) {
		setPlaceFlag("ShoppingCenter", 7);
		md.write("<p>On your left is the general " + getShopStore() + " that sells everything from toothpaste to magazines. It is possibly the busiest " + getShopStore() + " on town - a constant flow of people are entering and exiting the tiny " + getShopStore() + ".</p>" + "<p>Across the road is the newly opened restaurant, \"Bavaria Hut.\" It's a German theme restaurant, and since it was opened last month it's been almost always empty. You wonder how it could possibly be turning a profit.</p>" +
			"<p>The Friendly Loan Company stands as a solid and secure symbol of the town's economy. Built during the boom times when farming and mining brought riches to the community, everyone is proud to call the bank their own.</p>")
	}
	if (checkPersonFlag("Kristin", 9)) md.write("<p>The Friendly Loan Company has a sign saying it is temporarily <b>closed</b> for repair work. The ATM is still available to be used.</p>");
	else if (!isShopOpen(0)) md.write("<p>The Friendly Loan Company has a sign noting that it is <b>closed</b>, hours of business 8am to 6pm Monday to Friday. The ATM is still available to be used.</p>");
	if (bTessHere) md.write("<p>Tess Adams calls out to you from across the street. She is stunning in yet another outfit.</p>");
	if (perJ.place == 194 && perJ.other >= 30 && perJ.other < 40) md.write("<p>You see John Adams standing in an alley near the New Age " + getShopStore(true) + ".</p>");
	if (!isShopOpen(2, 1, true)) md.write("<p>The General " + getShopStore(true) + " has a sign noting that it is <b>closed</b>, hours of business 8am to 8pm.</p>");
	if (!isShopOpen(0)) {
		md.write("<p>The Antiques " + getShopStore(true) + " has a sign noting that it is <b>closed</b>, hours of business 8am to 6pm Monday to Friday.");
		if (isCharmedBy("Victoria")) md.write(" As Victoria lives in an apartment over the " + getShopStore() + ", you can still enter the " + getShopStore() + " anytime to visit her.");
		md.write("</p>");
		if (isPlaceKnown("MechanicsShop")) {
			md.write("<p>The Mechanics Workshop has a sign noting that it is <b>closed</b>, hours of business 8am to 6pm.");
			if (isCharmedBy("Hannah")) md.write(" You do have a key to Hannah's apartment so you can enter any time you like.");
			md.write("</p>")
		}
	}
	if (!isShopOpen(4, 0, true)) md.write("<p>The Restaurant has a sign noting that it is <b>closed</b>, hours of business 8am to 10pm.</p>");
	startQuestions();
	if (b2Cols) {
		if (bTessHere) addLinkToPlaceC(md, "talk to Tess Adams", 194, "type=tesscar");
		if (perJ.place == 194 && perJ.other >= 30 && perJ.other < 40) addLinkToPlaceC(md, "talk to John Adams", 224);
		md.write("<br>")
	}
	if (isShopOpen(0) || isCharmedBy("Victoria")) addLinkToPlace(md, isShopOpen(0) ? "enter the Antique " + getShopStore(true) : "visit Victoria's apartment", 348);
	if (isShopOpen(0) && !checkPersonFlag("Kristin", 9)) addLinkToPlace(md, "enter the Bank", 225);
	else if (perYou.getBankBalance() !== 0) addOptionLink(md,
		"use the ATM", "Leave();useATM()");
	if (isShopOpen(4, 0, true)) addLinkToPlace(md, "enter the Restaurant", 196);
	if (isShopOpen(2, 1, true)) addLinkToPlace(md, "enter the General " + getShopStore(true), 195);
	if (isPlaceKnown("MechanicsShop"))
		if (isShopOpen(0))
			if (wherePerson("Hannah") == 457) addLinkToPlace(md, "enter the Mechanic's Workshop", 194, "", "The workshop seems to be closed and no one opens the door when you ring the apartments bell, maybe Monique knows more.");
			else addLinkToPlace(md, "enter the Mechanic's Workshop",
				279);
	else if (isCharmedBy("Hannah")) addLinkToPlace(md, "enter Hannah's apartment", 237);
	if (isPlaceKnown("NewAgeStore")) addLinkToPlace(md, "walk to the New Age " + getShopStore(true), 344);
	if (isPlaceKnown("AvernusClub")) addLinkToPlace(md, "visit strip club", 281);
	if (isPlaceKnown("HavenApartments")) addLinkToPlace(md, "visit Haven Apartments", 465);
	addLinkToPlace(md, "walk to Kollam St", 44);
	if (isPlaceKnown("DervishRd")) addLinkToPlace(md, "walk to Dervish Rd", 5);
	if (b2Cols) {
		AddPeopleColumnMed();
		if (bTessHere) perTess.showPerson("tess9a.jpg",
			"100%");
		if (perJ.place == 194 && perJ.other >= 30 && perJ.other < 40) perJ.showPerson("john11.jpg", "100%")
	}
	WritePlaceFooter(md)
}

function ShowPlace195() {
	var md = WritePlaceHeader();
	var perLou = findPerson("Louise");
	var clvLou = perLou.getCharmedLevel();
	var perLea = findPerson("Leanne");
	var perAnita = findPerson("Anita");
	var myName = perYou.getPersonName();
	if (perAnita.isHere())
		if (!perAnita.checkFlag(1)) startTimedEvent("movePerson('Anita',1000)", 40);
		else if (perAnita.setFlag(11) && !perAnita.checkFlag(10)) startTimedEvent("movePerson('Anita',1000)", 40);
	if (perLea.place == 195) perLea.showPerson(Math.random() < .5 ? "leanne1b.jpg" : "leanne1c.jpg");
	else if (!perLou.checkFlag(1)) perLou.place =
		195;
	addPlaceTitle(md, "General " + getShopStore(true));
	if (perLea.place == 195) {
		md.write("<p>Leanne, your friend and part-time shopkeeper, greets you as you enter the general " + getShopStore() + ". In her normal bubbly manner she smiles and asks ");
		if (perLea.other === 0 && nMoney < 20 && perLea.checkFlag(25)) md.write("if you could look after the " + getShopStore() + " while she goes out to the back to take care of something.</p>");
		else md.write('"What are you looking for today, ' + myName + '?"</p>');
		if (perLea.other == 2) md.write('<p>Leanne hesitates for a moment, then asks "' +
			myName + ", you didn't notice anyone near the register before, did you?  I seem to be short " + sCurrency + '20."</p>');
		else if (perLea.other == 5) md.write('<p>Leanne smiles warmly at you. "Thank you so much for watching the ' + getShopStore() + " for me, " + myName + '.  If I can ever help you out just let me know."</p>')
	}
	if (perLou.place == 195)
		if (clvLou === 0) {
			md.write("<p>The " + getShopStore() + " is almost deserted this time of day and Leanne has stepped out.  The only employee present is Louise, who smiles companionably at you as she mops the floor.</p>");
			if (perLou.checkFlag(2)) md.write('<p>"Hey, ' + perYou.getPersonName() + ".  How's my favorite co-worker doing?\"</p>");
			else md.write('<p>"Hey, ' + perYou.getPersonName() + ".  How're you doing?\"</p>")
		} else if (perLou.checkFlag(4)) md.write("<p>The " + getShopStore() + " is almost deserted this time of day and Leanne has stepped out.  The only employee present is your slave Louise, who smiles eagerly and opens her uniform to show her newly enlarged breasts for your viewing pleasure.</p>");
	else if (perLou.checkFlag(5)) md.write("<p>The " +
		getShopStore() + " is almost deserted this time of day and Leanne has stepped out.  The only employee present is your slave Louise, who smiles eagerly and opens her uniform to show her body and her new cock for your viewing pleasure.</p>");
	else md.write("<p>The " + getShopStore() + " is almost deserted this time of day and Leanne has stepped out.  The only employee present is your slave Louise, who smiles eagerly and lifts the edge of her outfit discreetly for your viewing pleasure.</p>");
	if (perAnita.isHere())
		if (!perAnita.checkFlag(1)) {
			md.write("<p>You notice a young woman doing some shopping in the " +
				getShopStore() + ', wearing a tight green dress. She attracted your attention, aside from her figure, because she is looking a bit nervous and glancing around. You hear her mutter something about "cops" and "gotta be quick", it seems she may be wanted or maybe just paranoid.</p>');
			perAnita.setFlag(1)
		} else if (perAnita.checkFlag(11) && !perAnita.checkFlag(10)) {
		md.write("<p>You notice the young woman you saw the other day doing some more shopping in the " + getShopStore() + ', wearing the same tight green dress. You hear her mutter something about "almost time to get out...".</p>');
		perAnita.setFlag(10)
	} else md.write("<p>You notice the young woman wearing the tight green dress is quickly doing her shopping.</p>");
	else if (perAnita.checkFlag(1) && !perAnita.isCharmedBy() && !perAnita.checkFlag(3)) {
		md.write("<p>It seems the customer in the tight green dress has finished her shopping and left.</p>");
		perAnita.setFlag(3)
	}
	if (whereItem(30) == 999) moveItem(30, 195);
	if (perYou.getExperience() > 9 && whereItem(28) === 0) PlaceI(28, 195);
	if (whereItem(28) == 195) md.write("<p>An object catches your eye. Inside of a glass paperweight you see a stone that looks familar.</p>");
	if (!checkPlaceFlag("ShoppingCenter", 2) && isCharmedBy("Monique")) {
		setPlaceFlag("ShoppingCenter", 2);
		md.write("<p>You notice that quite a few headlines in the newspaper stand refer to a series of <b>burglaries</b> within the last 2 weeks. The police is openly asking for leads in the investigation and advises everyone to double check doors and windows at night.</p>")
	}
	startQuestionsOnly("Items for sale");
	if (whereItem(28) == 195) addQuestionC(md, "buy a paperweight for " + sCurrency + "3", "Leanne", -19528, "travelblock");
	addQuestionC(md, "buy a shovel for " + sCurrency + "15", "Leanne", -19530, "travelblock");
	addQuestionC(md, "buy a pair of scissors for " + sCurrency + "5", "Leanne", -19555, "travelblock");
	if (whereItem(47) == 195) addQuestionC(md, "buy a sports bag for " + sCurrency + "10", "Leanne", -19556, "travelblock");
	if (checkPersonFlag("Vampyre", 10)) addQuestionC(md, "buy some garlic for " + sCurrency + "2", "Leanne", -19557, "travelblock");
	md.write("<br>");
	startQuestions();
	if (perLea.other === 0 && perLea.place == 195 && nMoney < 20 && perLea.checkFlag(25)) addLinkToPlaceC(md,
		"agree to look after the " + getShopStore(), 211);
	if (perAnita.isHere())
		if (!perAnita.checkFlag(2)) addQuestionR(md, "say hello to the customer", "You approach the girl and say hello, she looks at you, clearly thinking you are trying to pick her up. Angrily she tells you <i>&quot;Get lost " + (perYou.isMaleSex() ? "man " : "") + "slut!&quot;</i><br><br>She turns her back to you and ignores you.", "Girl", "bChatLeft=false;setPersonFlag(\\'Anita\\',2);");
		else if (!perAnita.checkFlag(5)) addQuestionR(md, '"Well lady, you\'re a bitch"',
		"You snap back calling her a bitch, <i>&quot;I&rsquo;m no lady, I am a pat..I am Anita. Get lost or you will be in a world of pain!&quot;</i><br><br>She turns her back to you again. You do not doubt her words.", "Girl", "bChatLeft=false;setPersonFlag(\\'Anita\\',5);");
	addLinkToPlace(md, "exit the general " + getShopStore(), 194);
	if (perAnita.isHere()) {
		AddPeopleColumnLarge();
		perAnita.showPerson("anita10a.jpg", "100%", "", "", "Customer")
	}
	WritePlaceFooter(md, "", true)
}

function ShowPlace196(stype) {
	if (!isShopOpen(4, 0, true)) return gotoPlaceDelayed(194, "", '<img src="UI/closed.png" style="float:left;width:15%;margin-right:5px">The Bavaria Hut restaurant closes and all customers are asked to leave.');
	var md = WritePlaceHeader();
	addPlaceTitle(md, "Bavaria Hut");
	startQuestions();
	addLinkToPlace(md, "exit the restaurant", 194);
	WritePlaceFooter(md)
}

function ShowPlace197(stype) {
	if (stype === "" && !isConspiracyPath()) passTimeNight();
	var md = WritePlaceHeader(false, "", "black");
	var perS = findPerson("Sarah");
	var perV = findPerson("Vampyre");
	if (stype === "") {
		perV.showPerson("vamp1a.jpg", "height:max");
		charmPerson("Vampyre", 4, "Sarah");
		setPersonOther("Vampyre", 100);
		addPlaceTitle(md, "Vampyre Awakes", "", 0, false, "white");
		md.write("<p>Silence envelops the night, freezing the air and chilling your spine. Sarah reaches for the book, barely " + "grasping it before the sound of old timber is heard from somewhere above. She quickly starts to search the book for something.</p>" +
			"<p>You are too scared to move, and then you see a black shadow and a female form leaps to attack you, her fangs bared to bite you and drain your life away. Suddenly she recoils away from you, blocked by some force...</p>" + "<p>Sarah starts to recite a complex spell, and the vampire reacts and leaps to attack her. You step in the way and the vampyre recoils again. The vampyre tries again to reach Sarah, but again you stop the vampyre.</p>" + "<p>The vampyre screams and collapses onto the floor crying out in pain or ecstasy and Sarah finishes the spell.</p>");
		startQuestions();
		addLinkToPlaceC(md, "ask Sarah what she did", 197, "type=askvampyre")
	} else if (stype == "askvampyre") {
		perV.showPerson("vamp1b.jpg", "height:max");
		movePerson("Vampyre", 192);
		addPlaceTitle(md, "Vampyre Bound", "", 0, false, "white");
		perS.other = 116;
		perS.DropItem(4, "You");
		md.write("<p>As you ask Sarah, you see the Vampyre stand, and partially remove her clothing, leaving a hood in place to cover most of her face. She has a beautiful, if pale body, and black hair, but her hair had odd qualities, and can appear reddish at times.</p>" +
			"<p>She stands and looks at Sarah, completely ignoring you, utterly silent and motionless as Sarah answers you,</p>" + '<p>"That is a spell I knew was in the book, and I knew the key to deciphering it. According to my family history it is supposed to protect us from the dead in some way"</p>' + "<p>Sarah returns the Book to you, and as she does the vampyre speaks to Sarah, her voice sensual but with a dangerous quality,<br>" + "<p>\"Mistress, that was the spell of Necromancy the charm of 'Bind the Dead', or 'Unlife Enspelled'. It has made me your thrall, in body and heart. I will do anything you command, my mind is my own but I still must obey and love you.\"</p>" +
			'<p>Sarah asks the vampyre her name, "That I will never tell you, no spell will compel me to reveal that ultimate truth. You may call me Lilith for the woman from legend."</p>' + '<p>You ask the vampyre where she came from, and she glances at you, like a lion at a piece of meat, and turns away ignoring you, and speaks to Sarah "Mistress, I am yours to command, take the charms from the witchling and I will kill them, and make them a loyal thrall for you. <b>You</b> may command me to do anything, except answer questions.</p>' +
			'<p>Mistress, the ways are opening, the <i>thin</i> places will be very dangerous, and those of power, do not venture there without me, then again, I will never leave your side..."</p>');
		if (isCharmedBy("Sarah")) md.write('<p>Sarah tells the vampyre, "' + perYou.getPersonName() + '" is my ' + perYou.getMaster() + ' so you will obey them as if I were ordering you.", to which the vampyre simply replies "No"</p>');
		else if (isConspiracyPath()) md.write('<p>Sarah tells the vampyre, "' + perYou.getPersonName() + '" is my ally so you will obey them as if I were ordering you.", to which the vampyre simply replies "No"</p>');
		else md.write('<p>Sarah tells the vampyre, "' + perYou.getPersonName() + '" is my Uncle\'s apprentice so you will obey them as if I were ordering you.", to which the vampyre simply replies "No"</p>');
		startQuestions();
		addLinkToPlaceC(md, "talk more to Sarah", 192)
	}
	WritePlaceFooter(md, "", true, true)
}

function ShowPlace198(stype) {
	var bKilled = perYourBody.FindItem(46) === 0 && perYourBody.FindItem(44) === 0 && !checkPersonFlag("Vampyre", 11);
	if (stype === "" && !isConspiracyPath()) passTimeNight();
	var md = WritePlaceHeader(false, stype != "reassure" && !bKilled ? "td-left-large" : "", "black");
	ClearComments();
	var perV = findPerson("Vampyre");
	var perSarah = findPerson("Sarah");
	var bCharmed = perSarah.isCharmedBy();
	var myName = bCharmed ? perYou.getMaster() : perYou.getPersonName();
	if (stype == "reassure") {
		perV.showPerson("vamp4b.jpg");
		addPlaceTitle(md,
			"Vampyre Repelled", "", 0, false, "white");
		md.write("<p>In the distance you see the vampyre looking back at you with hatred in her eyes, her injuries almost healed and the she is gone. Sarah signs raggedly, and you tell her,</p>" + '<p>"I will always protect you Sarah. I will find that vampyre and make sure she never returns."</p>' + '<p>Sarah looks grateful, and she warns you, "Now the ways are opening, the <i>thin</i> places will be very dangerous, I warn you to not visit the <b>Sacred Grove</b> at night, and the <b>Wild Ranges</b> might be risky while the vampyre is free, then again they will likely always be dangerous at night from now. The vampyre will have a hiding place but I have no idea where it would be, a tomb or similar place.</p>' +
			"<p>You ask Sarah why she wanted the Book, and she tells you,</p>" + '<p>"That is a spell I knew was in the book, and I knew the key to deciphering it. According to my family history it is supposed to protect us from the dead in some way"</p>');
		startQuestions();
		addLinkToPlaceC(md, "talk more to Sarah", 192)
	} else if (bKilled) {
		perV.showPerson(perSarah.FindItem(4) > 0 ? "vamp3a.jpg" : "vamp2.jpg");
		addPlaceTitle(md, "Vampyre Awakes", "", 0, false, "white");
		if (isConspiracyPath()) md.write("<p>You wait nervously, the fear rising in your heart, ");
		else md.write("<p>Darkness falls and the fear rises in your heart, ");
		if (perSarah.FindItem(4) === 0) md.write("and Sarah is looking anxiously at you,</p>" + '<p>"Please ' + myName + ' give me the book..."</p>' + "<p>A black shadow leaps through the window, a female with bared fangs, a vampyre! She pounces on your throat!</p>" + "<p>Your life drains away, you did not have any <b>defenses</b> against a vampyre and Sarah could not help, and were an easy prey for her.</p>" + '<p style="text-align:center"><b>This is the end, there is nothing left for you, you can only try again.</p>');
		else md.write("and Sarah is looking anxiously at you, and then she opens the book, looking for something.</p>" + "<p>A black shadow leaps through the window, a female with bared fangs, a vampyre! She looks at Sarah and then at you. Sarah starts to recite a spell, a quite complex one, and the vampyre leaps at her. You jump in the way and the vampyre pounces on your throat. As she drains your blood, she strikes Sarah down with a casual swipe of her hand.</p>" + "<p>Your life drains away, you did not have any <b>defenses</b> against a vampyre and Sarah could not help, you were an easy prey for the vampyre.</p>" +
			"<p>As are about to close your eyes for the last time you see a vision of how things will come to pass, the vampyre with her new servant in death, Sarah...</p>" + '<p style="text-align:center"><b>This is the end, there is nothing left for you, you can only try again.</p>');
		startQuestions();
		addRestartLink(md)
	} else {
		perV.showPerson("vamp4a.jpg", "100%");
		addPlaceTitle(md, "Vampyre Awakes", "", 0, false, "white");
		setPersonOther("Vampyre", 60);
		movePerson("Vampyre", 1E3);
		md.write("<p>Selfishly, you keep the book, despite Sarah's begging.</p>" +
			"<p>Silence envelops the night, freezing the air and chilling your spine. Sarah reaches to take to book from you " + "and then you see a black shadow and a female form leap to attack you, her fangs bared to bite you and drain your life away.</p>" + "<p>Suddenly she recoils away from you, held back by some force, the flesh of her face and body rending and dissolving in places</p>" + "<p>Wordlessly the vampyre flees with inhuman speed back out the window, before you can act. Sarah looks at you with fear on her face but also a growing look of relief.</p>");
		startQuestions();
		addLinkToPlaceC(md, "reassure Sarah", 198, "type=reassure")
	}
	WritePlaceFooter(md)
}

function ShowPlace199() {
	var md = WritePlaceHeader();
	var perSarah = findPerson("Sarah");
	perSarah.showPerson("sarah3.jpg");
	addPlaceTitle(md, "Charmed Sarah Gates");
	md.write("<p>&quot;What the...&quot; exclaims Sarah. &quot;How did you learn the Dai Chu spell? That magic is a family secret " + "that should never be used without proper training.&quot;</p>" + "<p>The young lady staggers to her feet, lifting her hands raised into a fighting stance. &quot;You cast it on me!&quot; she finally realizes. &quot;I have to...  I have to resist. I have " + "to... to find a counter spell.&quot; Her fists are already relaxing, fingers tugging at her clothes.</p>");
	startQuestions();
	addLinkToPlace(md, "wait for the spell to take effect", 200);
	WritePlaceFooter(md)
}

function ShowPlace200() {
	var md = WritePlaceHeader();
	var perSarah = findPerson("Sarah");
	perSarah.showPerson("sarah4.jpg");
	addPlaceTitle(md, "Charmed Sarah Gates");
	md.write('<p>"I... I can\'t resist can I," Sarah cries out, unable to stop her hands from fondling herself. "Whatever ' + 'happens, I must keep my virginity. Uncle Ronny told me that I have to wait for the one. Oh..."</p>' + '<p>"Look at me," you tell the heiress. "And tell me that you want me."</p>' + "<p>Sarah throws her head back, trying to avoid your stare.  Inch by inch her face turns towards you, until her eyes lock with yours. " +
		"A wave shudders through her body as the first orgasm hits.</p>");
	startQuestions();
	addLinkToPlaceC(md, "tell Sarah to remove her clothes", 201);
	WritePlaceFooter(md)
}

function ShowPlace201() {
	var md = WritePlaceHeader();
	var perSarah = findPerson("Sarah");
	perSarah.showPerson("sarah5.jpg");
	addPlaceTitle(md, "Charmed Sarah Gates");
	md.write('<p>"Remove my clothes? Are you the one? You have the book, the mana and knowledge of the magic. Perhaps I must give myself to you."</p>' + "<p>The inner turmoil within Sarah dissolves as her mind comes to terms with the spell's effects. Her movements become more fluid and relaxed. She smiles.</p>");
	startQuestions();
	addLinkToPlaceC(md,
		"tell Sarah that you are the one she was waiting for", 202);
	WritePlaceFooter(md)
}

function Leave202() {
	if (whereItem(25) == 202) moveItem(25, 192)
}

function ShowPlace202() {
	var md = WritePlaceHeader();
	var perSarah = findPerson("Sarah");
	perSarah.showPerson("sarah6.jpg");
	addPlaceTitle(md, "Charmed Sarah Gates");
	md.write("<p>Sarah's hands grope her sensitive spots as she kneels on the floor. She sighs, giving up her will to you. " + "&quot;Yes... Yes, you are aren't you. I know that it is the spell making me feel this way but I simply cannot live without you. " + "Everything that I have, everything I own, is yours. Please, accept " + "this box - a family heirloom for generations.  It will give you all " +
		"the power you need to continue my family's legacy.&quot;</p>");
	startQuestions();
	addLinkToPlaceC(md, "talk more to Sarah", 192, "", "", "", "Leave202()");
	addLinkToPlace(md, "exit the house?", 16, "", "", "", "Leave202()");
	WritePlaceFooter(md)
}

function ShowPlace203() {
	var md = WritePlaceHeader();
	addPlaceTitle(md, "Bavaria Hut Storeroom");
	startQuestions();
	addLinkToPlace(md, "exit the restaurant", 194);
	WritePlaceFooter(md)
}

function LeaveMinJenny() {
	dispPlace(194, "");
	WriteComments("You leave the cafe and Jenny to deal with the spell.<br/>She will be affected by the spell but you have chosen to not try to reinforce or guide her so the effect will be minimal.")
}

function ShowPlace204() {
	var md = WritePlaceHeader();
	var perJenny = findPerson("Jenny");
	perJenny.showPerson("jenny3.jpg");
	addPlaceTitle(md, "Jenny Charmed");
	md.write('<p>Jenny stiffens as you cast the spell, then crashes down on the chair with a cute "oof". "Oh!" she exclaims. "What... what did you say?"</p>' + "<p>You smile. The spell has taken her swiftly.</p>");
	startQuestions();
	addLinkToPlaceC(md, "tell Jenny to lower her shirt", 205);
	addLinkToPlace(md, "leave the cafe and Jenny as she gets used to the spell?",
		194, "", "", "", "LeaveMinJenny()");
	WritePlaceFooter(md)
}

function ShowPlace205() {
	var md = WritePlaceHeader();
	var perJenny = findPerson("Jenny");
	if (perJenny.other == 1) {
		perJenny.other = 2;
		AddCash(20)
	}
	perJenny.showPerson("jenny4.jpg");
	addPlaceTitle(md, "Jenny Charmed");
	perJenny.charmThem(4);
	md.write("<p>&#147;Yes, my love,&#148; Jenny replies, hands caressing her tits. She turns to face you, eager to do whatever you might wish.</p>");
	startQuestions();
	addLinkToPlaceC(md, "tell Jenny to pleasure herself", 206);
	WritePlaceFooter(md)
}

function ShowPlace206() {
	var md = WritePlaceHeader(false, "td-left-large");
	var perJenny = findPerson("Jenny");
	perJenny.showPerson("jenny5.jpg");
	addPlaceTitle(md, "Jenny Charmed");
	md.write('<p>"Oh, YES, ' + perYou.getMaster() + '," Jenny gasps. She drives a finger into her asshole, while the other hand teases her folds. As she nears climax she gasps out for you. ' + '"Please ' + perYou.getMaster() + '" she says. "Take me."</p>');
	startQuestions();
	addLinkToPlace(md, "exit the restaurant", 194);
	WritePlaceFooter(md)
}

function ShowPlace208(stype) {
	var md = WritePlaceHeader();
	findPerson("MsTitus");
	per.other = 10;
	per.place = 3;
	var bReception = stype == "reception";
	per.showPerson("titus22.jpg");
	addPlaceTitle(md, "Ms. Titus Under a Spell");
	md.write('<p>Miss Titus turns around. "What did you say?" she asks.</p>' + "<p>You remain silent and wait for the spell to take effect. After a moment, Ms. Titus does an elaborate stretch, thrusting out her already prominent chest, and she looks at ");
	if (!bReception) md.write("Tess and then at you. She is smiling and waiting for one of you to explain or at least speak. Tess looks at you.</p>");
	else md.write("you. She is smiling and waiting for you to explain or at least speak.</p>");
	startQuestions();
	addLinkToPlace(md, "force Ms. Titus to submit to your commands", 209, "type=" + stype);
	WritePlaceFooter(md)
}

function ShowPlace209(stype) {
	var md = WritePlaceHeader(false, "td-left-large");
	var perTitus = findPerson("MsTitus");
	perTitus.showPerson("titus23.jpg");
	addPlaceTitle(md, "Ms. Titus Under a Spell");
	md.write("<p>You order Ms. Titus to submit completely and utterly to your commands. To your surprise she replies,</p>" + '<p>"Oh submission!" replies Ms. Titus. "You should have said so. I have always wanted to be dominated, I fantasise about it all the time. You are just the one to be my ' + perYou.getMaster() + '."</p>' +
		"<p>You nod mutely, she's pulled down her top, and breasts fill your vision and have taken your voice for a moment.</p>");
	startQuestions();
	addLinkToPlaceC(md, "order your new slave to surrender completely", 210, "type=" + stype);
	WritePlaceFooter(md)
}

function ShowPlace210(stype) {
	var md = WritePlaceHeader(false, isExplicit() ? "td-left-large" : "");
	var bReception = stype == "reception";
	var perTitus = findPerson("MsTitus");
	setPersonFlagAfterTime("MsTitus", 1, true, 288);
	if (perYou.isMaleSex()) {
		perTitus.showPersonRorX("titus24b.jpg");
		addPlaceTitle(md, "Ms. Titus Under a Spell");
		md.write("<p>Ms. Titus does not wait for a second longer.  Reaching over, she expertly undoes your fly and pulls out your cock.  With a satisfied grin she expertly swallows you whole.  Despite your best efforts, you do not last long.</p>")
	} else {
		perTitus.showPerson("titus24g.jpg");
		addPlaceTitle(md, "Ms. Titus Under a Spell");
		md.write('<p>Ms. Titus can not contain herself and yanks up her skirt. Leaning back and giving you a lascivious grin she offers all that she is. "Oh please ' + perYou.getMaster() + '," she begs, "Use me, dominate me!"</p>')
	}
	startQuestions();
	if (bReception) addLinkToPlace(md, "speak more to Ms. Titus", 3, "");
	else {
		if (isCharmedBy("Tess")) addLinkToPlace(md, "talk to Tess Adams", 62, "type=continue");
		addLinkToPlace(md, "return to the library reception", 3)
	}
	WritePlaceFooter(md)
}

function ExitGeneralShop() {
	var perLea = findPerson("Leanne");
	if (perLea.other == 1) perLea.other = 5
}

function ShowPlace211() {
	var md = WritePlaceHeader();
	var perLea = findPerson("Leanne");
	if (perLea.other === 0) perLea.other = 1;
	addPlaceTitle(md, "General " + getShopStore(), "generalshop1.jpg");
	md.write("<p>Leanne thanks you for the help and exits to the back of the " + getShopStore() + ".</p>" + '<p>You are left "supervising" the ' + getShopStore() + ", which isn't much of a problem because there are no customers around. The till is partly open and you can see " + sCurrency + "20 bill peeking out.</p>");
	startQuestions();
	addQuestionCO(md,
		"take the " + sCurrency + "20 from the till", "Leanne", -211);
	addLinkToPlaceO(md, "leave the " + sCurrency + "20 and wait for Leanne to return", 195, "", "", "", "ExitGeneralShop()");
	WritePlaceFooter(md)
}

function ShowPlace212() {
	var md = WritePlaceHeader();
	if (!isCharmedPath()) findPerson("Sarah").showPerson("sarah9a.jpg");
	else findPerson("SirRonald").showPerson("gates6.jpg");
	addPlaceTitle(md, "New Spell Research");
	md.write('<form method="POST" name="FormChar">' + "<p>I want to look up the word(s):</p>" + '<p><input type="text" size="20" name="research">' + '<input type="button" name="button" value="please" onClick="ResearchOLD(\'C\', document.FormChar.research.value)"></p></form>');
	addLinkToPlace(md, "Never mind...",
		isCharmedPath() ? 17 : 192);
	WritePlaceFooter(md)
}

function ShowPlace213() {
	var md = WritePlaceHeader(false, "td-left-small");
	var perNS = findPerson("NurseSandra");
	var clv = perNS.getCharmedLevel();
	var perOS = findPerson("OfficerSmith");
	var perKhan = findPerson("OfficerKhan");
	var perGhost = findPerson("Ghost");
	if (clv === 0) perNS.showPerson("Setting/sandra1.jpg");
	else perNS.showPerson("Setting/sandra5.jpg");
	addPlaceTitle(md, "Ward 1 East");
	if (perOS.place == 213) {
		if (perKhan.place == 213) md.write('<div style="text-align:right">');
		perOS.showPerson("polg7.jpg", "height:30vh",
			"right");
		if (perKhan.place == 213) md.write('</div><div style="clear:both;">')
	}
	if (perYou.checkInjury(1) && !perYou.checkInjury(2)) {
		md.write("You wake up from the blackness. Slowly your eyes make out shapes until you see that you are in a hospital ward. A sharp pain stabs at you from your shoulder and you remember the bullet piercing you there. ");
		perYou.setInjury(2);
		WaitHereOnly(288 + Math.floor(Math.random() * 12));
		perNS.other = 1;
		if (getPersonOther("Diane") === 0) {
			setPersonOther("Diane", 1);
			movePerson("Diane",
				168)
		}
	} else if (perYou.checkInjury(5) && !perYou.checkInjury(6)) {
		md.write("You wake up from the blackness. Slowly your eyes make out shapes until you see that you are in a hospital ward. A sharp pain stabs at you from your shoulder probably from some rock as the prison was collapsing. ");
		perYou.setInjury(6);
		WaitHereOnly(12 + Math.floor(Math.random() * 12))
	}
	md.write("<p>Stark white walls greet you in the hospital room.</p>");
	if (perNS.other == 1)
		if (clv > 0) md.write('<p>Your slave Nurse Sandra approaches your bed very concerned and examines your chart for a moment before moving to your side.  "Please Boss, be careful.  Your injuries have not yet healed."  Her eyes well up with tears as she looks at you.  "Boss, I was so worried!</p>');
		else md.write('<p>A nurse approaches you. She checks her notes and exclaims, "You should stay still! Your not yet recovered from your injury. Let Nurse Sandra take care of you!"</p>');
	else {
		if (perOS.place == 213 && perOS.other == 101)
			if (clv > 0) md.write('<p>Your slave Sandra looks at you. "Are you here for Officer Rebecca Smith, Boss? Does she serve you as I do Boss?</p>');
			else md.write("<p>The nurse asks you whether you have come to visit " + getOfficer() + " Rebecca Smith.</p>");
		else if (perOS.place == 213) md.write("<p><b>" +
			getOfficer() + " Smith could lose her life.</b></p>");
		if (perKhan.place == 213)
			if (clv > 0) md.write('<p>Your slave Sandra looks at you. "Are you here for ' + getOfficer() + " Cheryl Khan, Boss? Does she serve you as I do Boss?</p>");
			else md.write("<p>The nurse asks you whether you have come to visit " + getOfficer() + " Cheryl Khan.</p>");
		else if (perOS.place != 213)
			if (clv > 0) md.write('<p>Your slave Sandra looks at you. "Are here to visit a patient Boss?"</p>');
			else md.write("<p>The nurse asks if you are here to visit a patient?</p>")
	}
	if (perKhan.place !=
		213) md.write('<div style="clear:both;">');
	startQuestions();
	if (clv > 0) addLinkToPlace(md, "have Sandra give you a checkup", Place, "type=sandracheckupsex");
	if (perYou.checkInjury(6) && !perYou.checkInjury(7)) addQuestionC(md, "ask the nurse what happened", "NurseSandra", 922);
	else if (perNS.other == 1) addQuestionC(md, "ask the nurse what happened", "NurseSandra", 921);
	if (perOS.place == 213 && perOS.other == 101) addQuestionC(md, "ask Nurse Sandra about Becky's condition", "NurseSandra", 93102);
	if (perGhost.checkFlag(2) && !perGhost.checkFlag(3)) addQuestionC(md,
		"tell the nurse about seeing the ghost", "NurseSandra", 100);
	if (!isDay() && clv > 0 && perGhost.checkFlag(5) && !perGhost.checkFlag(6)) addLinkToPlaceC(md, "ask her to come with you to the basement", 443, "type=sandra");
	addLinkToPlace(md, "exit the ward", 214);
	if (perOS.place == 213) md.write("</div>");
	if (perKhan.place == 213) {
		AddRightColumnLarge(md);
		AddImage("Setting/pol12.jpg", "", "right")
	}
	WritePlaceFooter(md)
}

function ShowPlace214(stype) {
	var md = WritePlaceHeader();
	var perMG = findPerson("MrsGranger");
	var perOK = findPerson("OfficerKhan");
	var perNS = findPerson("NurseSandra");
	var ele = isBritish() ? "lift" : "elevator";
	addPlaceImage(md, "hospdesk.jpg");
	if (perMG.other >= 54 && perMG.place == 278 && !isMurderPath() && perMG.checkFlag(3) && checkPlaceFlag("Hospital", 2)) {
		md.write('<p style="text-align:center">Ride the ' + ele + '<br><img src="Images/elevatorbuttons.jpg" style="margin: 5px 5px;width:75%" alt="Elevator" title="The elevator"></p>');
		addLinkToPlace(md, isBritish() ? "First Floor" : "Second Floor", 444, "", "", "", "", "hailblock");
		addLinkToPlace(md, "Basement", 442, "", "", "", "", "hailblock hailup")
	}
	addPlaceTitle(md, "Hospital Foyer");
	md.write("<p>The public areas of the hospital, with visitor access to the various wards and a desk for reception. You have never seen someone at the desk, this hospital is a little understaffed at times.</p>" + "<p>There is " + (isBritish() ? "a lift" : "an elevator") + " leading to the other levels of the hospital, but you have had little reason to visit them.</p>");
	if (!checkPlaceFlag("Hospital", 2)) md.write("<p>You notice a black framed picture of a pretty nurse near the front desk.</p>");
	if (perMG.other >= 54 && perMG.place == 278 && !isMurderPath() && perMG.checkFlag(3))
		if (perOK.isCharmedBy()) md.write("<p>You notice up the corridor in front of Ward 1 East, your slave " + getOfficer() + " Cheryl Khan.</p>");
		else md.write("<p>You notice up the corridor in front of Ward 1 East, a police " + getOfficer(false) + " on guard.</p>");
	startQuestions();
	addLinkToPlace(md, "wait for a while",
		"", "", "You sit in the waiting area for a time", "", "WaitHere(5);");
	if (!checkPlaceFlag("Hospital", 2)) addPopupLink(md, "look at the picture", "In Memory Of Keana", "<img src='Images/" + findPerson("Ghost").getImg("ghostnurse0.jpg") + "' style='width:40%;float:right;margin-left:5px' alt='Nurse'>" + "The picture bears a short message<br><br>" + '"In memory of our friend Keana, a beautiful and talented nurse. Her life was tragically cut short, we all miss her terribly"', true, 'setPlaceFlag("Hospital",2);dispPlace(214' +
		(perYou.isShot() ? ")" : ',"type=meetsandra")'));
	if (perMG.other >= 50 && perMG.checkFlag(1)) {
		if (!perMG.checkFlag(5) && !isMurderPath() && perMG.checkFlag(3)) {
			perOK.setFlag(1);
			perOK.place = 278;
			showPopupWindow("Police Officer", "<img src='Images/Setting/pol13a.jpg' style='width:35%;float:right;margin-left:5px' alt='Officer Khan'>" + "You notice a police " + getOfficer() + " leaving the Intensive Care Unit, and she turns and talks to someone still inside,<br><br>" + '"..alright, contact me when she is moved into a regular Ward. I will return then."' +
				"<br><br>" + "Before you can do anything, hide or ask her if she is talking about Mrs. Granger, the " + getOfficer(false) + " quickly walks away." + "<br><br>" + "You recognise the " + getOfficer(false) + " as Ms Khan . She used to live next door to your house. Your mother talked to her a lot back in the day and sometimes Ms Khan even visited your house for dinner. " + "From these visits you learned that she did not want to be an " + getOfficer(false) + " first, she was more interested in becoming a soldier. However, her dominant nature and harsh attitude made her realize that by becoming a police " +
				getOfficer(false) + " she could exercise her power over the people quicker and easier. So, yeah, your first impressions of her were not so good...she\u2019s and uptight and arrogant bitch who\u2019s hunger for power could only be matched by her heavenly body and appearance and it looks like she hasn\u2019t changed a bit. " + "She worked her way through the ladder and is now the right hand woman to " + getPoliceChief() + " Batton.<br><br>" + "She did not notice you, and you have to admire the dress-code of the local police!",
				'setPersonFlag("MrsGranger",5);dispPlace()')
		}
		addLinkToPlace(md, "enter the Intensive Care Unit", 275)
	} else if (isPlaceKnown("HospitalICU")) addLinkToPlace(md, "enter the Intensive Care Unit", 275);
	if (perMG.other >= 54 && perMG.place == 278) addLinkToPlace(md, "enter Ward 1 West", 278);
	if (perYou.isShot() || perOK.place == 213 || wherePerson("OfficerSmith") == 213 || perNS.checkFlag(1) || perNS.isCharmedBy()) addLinkToPlace(md, "enter Ward 1 East", 213);
	addLinkToPlace(md, "exit the hospital", 215);
	if (perMG.other >= 54 && perMG.place ==
		278 && !isMurderPath() && perMG.checkFlag(3)) {
		AddRightColumnLarge(md);
		if (checkPlaceFlag("Hospital", 2)) addPlaceImage(md, "elevator.jpg", "50%");
		perOK.showPerson(perOK.isCharmedBy() ? "Setting/pol13b.jpg" : "Setting/pol13a.jpg")
	} else if (checkPlaceFlag("Hospital", 2)) {
		AddRightColumn(md);
		addPlaceImage(md, "elevator.jpg");
		md.write('<p style="text-align:center">Ride the ' + ele + '<br><img src="Images/elevatorbuttons.jpg" style="margin: 5px 5px;width:100%" alt="Elevator" title="The elevator"></p>');
		addLinkToPlace(md, isBritish() ?
			"First Floor" : "Second Floor", 444, "", "", "", "", "hailblock");
		addLinkToPlace(md, "Basement", 442, "", "", "", "", "hailblock hailup")
	}
	WritePlaceFooter(md)
}

function ShowPlace215() {
	var md = WritePlaceHeader(false, "td-left-med");
	addPlaceTitle(md, "Glenvale Hospital", "hospital1.jpg", 50);
	md.write("<p>Standing in front of the hospital you realize how old the town is. The hospital was erected more than 100 years ago.</p>");
	setPlaceKnown("Hospital");
	startQuestions();
	addLinkToPlace(md, "enter the hospital", 214);
	addLinkToPlace(md, "walk to the park bridge", 216);
	WritePlaceFooter(md)
}

function ShowPlace216() {
	var md = WritePlaceHeader();
	var perKate = findPerson("Kate");
	addPlaceTitle(md, "Park Bridge", "park2.jpg");
	if (perYou.isShot()) md.write("<p>You enjoy the fresh air from the surrounding gardens and, for a moment, you forget about the pain in your shoulder.</p>");
	else md.write("<p>You enjoy the fresh air from the surrounding gardens as you cross the bridge over the river and leaving the park.</p>");
	if (perKate.isHere()) md.write("<p>You look around to see one of your friends, Kate, approaching from the far end of the bridge. Kate isn't known for her social skills, probably due to the fact she always has her head in school books, but she does know a lot about practically everything. She's in a hurry and hasn't seen you yet.</p>");
	startQuestions();
	if (perKate.place == 216) addLinkToPlaceC(md, "approach Kate", 4);
	if (nFromPlace == 47) {
		addOptionLink(md, "walk to the Hospital", "LeaveKate4(215)");
		addOptionLink(md, "walk to the Park entrance", "LeaveKate4(47)")
	} else {
		addOptionLink(md, "walk to the Park entrance", "LeaveKate4(47)");
		addOptionLink(md, "walk to the Hospital", "LeaveKate4(215)")
	}
	WritePlaceFooter(md)
}

function ShowPlace221() {
	var md = WritePlaceHeader();
	var perBatton = findPerson("OfficerBatton");
	var perDA = findPerson("Diane");
	perDA.showPerson("diane2.jpg");
	addPlaceTitle(md, getProsecutor() + " White Under a Charm Spell");
	var jailed = "";
	perYou.setArrested(0);
	if (perDA.other < 15) perDA.other = 15;
	else if (perDA.other == 50) {
		perDA.other = 49;
		jailed = "jailed=yes"
	}
	md.write("<p>The " + getProsecutor() + "'s demeanor changes as you cast " + "the spell. Fidgeting, she shrugs out of her jacket. \"I've been kind of " + (perYou.isMaleSex() ?
		"hard on" : "strict with") + ' you," she ' + "says with a smile, one hand baring a nipple. &quot;And I think it's time for you to be " + (perYou.isMaleSex() ? "hard on" : "strict with") + " me.&quot;</p>");
	if (perBatton.place == 168 && !perBatton.isCharmedBy()) md.write("<p>" + getProsecutor() + " White looks over at " + getPoliceChief() + ' Batton.  "I can handle this, Officer.  Why don\'t you go check on the cells in the back," she says.  ' + getPoliceChief() + " Batton reluctantly agrees and heads off to the back of the station.</p>");
	startQuestions();
	if (perYou.isMaleSex()) addLinkToPlace(md, "tell Diane White that you <i>are</i> hard", 222, jailed);
	else addLinkToPlace(md, "tell Diane White that you are <i>strict</i>", 222, jailed);
	addLinkToPlace(md, "exit the police station", 167, "", "You leave " + getProsecutor() + " White for now and on the way out you retrieve your possessions", "", "DAReturnItems()");
	WritePlaceFooter(md)
}

function ShowPlace222(stype) {
	var jailed = getQueryParam("jailed") == "yes" ? "jailed=yes" : "";
	var perDA = findPerson("Diane");
	var md = WritePlaceHeader();
	var bWasArrested = perYou.checkFlag(36);
	var bReturn = bWasArrested && perDA.NoItems > 0;
	if (bReturn) DAReturnItems();
	perDA.showPerson("diane3.jpg");
	addPlaceTitle(md, getProsecutor() + " White Under a Charm Spell");
	md.write('<p>"Ohh" sighs the ' + getProsecutor() + '. "So you do want to play. Perhaps I can show you how the law works." She poses on the desk, her lips in a slight pout.</p>' +
		"<p>You smile smugly, the former ice queen transformed into another plaything.</p>");
	if (bReturn) md.write("<p>Before you have her show you what the law is capable of, you ask her for your possessions that were confiscated. She hands you a box containing your items. You are distracted by the beautiful woman in front of you and put them to the side for now.</p>");
	startQuestions();
	addLinkToPlaceC(md, "ask Diane to show you what the law can do", 223, jailed);
	addLinkToPlace(md, "exit the police station", 167,
		"", "You leave " + getProsecutor() + " White for now and on the way out you retrieve your possessions", "", "DAReturnItems()");
	WritePlaceFooter(md)
}

function ShowPlace223(stype) {
	var md;
	var perDA = findPerson("Diane");
	if (stype === "") {
		md = WritePlaceHeader();
		perDA.showPerson("diane4.jpg");
		addPlaceTitle(md, getProsecutor() + " White Under a Charm Spell");
		md.write("<p>&quot;I'm so pleased that you asked,&quot; says Diane, removing the last item of her clothing. " + "&quot;Let's get to it. Take me, " + perYou.getMaster() + ".&quot;</p>");
		startQuestions();
		addLinkToPlace(md, "take her", 223, "type=take")
	} else if (stype == "law") {
		md = WritePlaceHeader();
		perDA.showPerson("diane4.jpg");
		addPlaceTitle(md, getProsecutor() + " White Under a Charm Spell");
		md.write("<p>&quot;I'm so pleased that you asked,&quot; says Diane, removing the last item of her clothing. " + "&quot;Let's get to it. Take me, " + perYou.getMaster() + ".&quot;</p>");
		startQuestions();
		if (perYou.isMaleSex()) {
			addLinkToPlaceC(md, "time for a de-briefing", 223, "type=fuck");
			addLinkToPlaceC(md, "ask her to work on a hard case", 223, "type=bj");
			addLinkToPlaceC(md, "she needs to get something off her chest", 223, "type=tf")
		} else {
			addLinkToPlaceC(md,
				"time for a de-briefing", 223, "type=fuck");
			addLinkToPlaceC(md, "ask her to lick a case", 223, "type=bj");
			addLinkToPlaceC(md, "you need to get something off your chest", 223, "type=tf")
		}
	} else if (stype == "fuck") {
		md = WritePlaceHeader(false, perYou.isMaleSex() ? "" : "td-left-large");
		if (!isExplicit()) perDA.showPersonRandom("diane6" + (perYou.isMaleSex() ? "b" : "g"), 2);
		else perDA.showPersonRandomX("diane6" + (perYou.isMaleSex() ? "b" : "g"), perYou.isMaleSex() ? 3 : 2);
		addPlaceTitle(md, "Taking the Law");
		if (perYou.isMaleSex()) md.write("<p>You educate the " +
			getProsecutor() + " in the law, your law!</p>" + "<p></p>");
		else md.write("<p>You educate the " + getProsecutor() + " in the law, your law!</p>" + "<p></p>")
	} else if (stype == "bj") {
		md = WritePlaceHeader(false, "td-left-large");
		if (isExplicit()) perDA.showPersonRandomX("diane10" + (perYou.isMaleSex() ? "b" : "g"), perYou.isMaleSex() ? 2 : 4);
		else if (perYou.isMaleSex()) perDA.showPerson("diane10ba.jpg");
		else perDA.showPerson("diane6ga.jpg");
		addPlaceTitle(md, "Taking the Law");
		if (perYou.isMaleSex()) md.write("<p>You educate the " +
			getProsecutor() + " in the law, your law!</p>" + "<p></p>");
		else md.write("<p>You educate the " + getProsecutor() + " in the law, your law!</p>" + "<p></p>")
	} else if (stype == "tf") {
		md = WritePlaceHeader(false, stype == "tf" && !perYou.isMaleSex() ? "td-left-large" : "");
		if (isExplicit()) perDA.showPersonRandomX("diane11" + (perYou.isMaleSex() ? "b" : "g"), 2);
		else if (perYou.isMaleSex()) perDA.showPerson("diane11ba.jpg");
		else perDA.showPerson("diane11ga.jpg");
		addPlaceTitle(md, "Taking the Law");
		if (perYou.isMaleSex()) md.write("<p>You educate the " +
			getProsecutor() + " in the law, your law!</p>" + "<p></p>");
		else md.write("<p>You educate the " + getProsecutor() + " in the law, your law!</p>" + "<p></p>")
	} else if (stype == "take") {
		md = WritePlaceHeader(false, "td-left-large");
		if (!isExplicit()) perDA.showPersonRandom("diane6" + (perYou.isMaleSex() ? "b" : "g"), 2);
		else perDA.showPersonRandomX("diane6" + (perYou.isMaleSex() ? "b" : "g"), perYou.isMaleSex() ? 3 : 2);
		addPlaceTitle(md, "Taking the Law");
		md.write("<p>You educate the " + getProsecutor() + " in the law, your law!</p>");
		startQuestions()
	}
	addLinkToPlace(md,
		"return to the station reception area", 168);
	addLinkToPlace(md, "exit the police station", 167);
	WritePlaceFooter(md)
}

function ShowPlace224(stype) {
	var md = WritePlaceHeader();
	var perJ = findPerson("JohnAdams");
	perJ.showPersonRorX(stype !== "" && !isExplicit() ? "john5b.jpg" : "john5a.jpg");
	addPlaceTitle(md, "John Adams");
	if (stype === "") {
		perJ.place = 344;
		setPersonFlag("Jessica", 2);
		md.write("<p>You see John Adams standing in an alley, partially clothed, looking very distracted, and touching himself every so often.</p>");
		startQuestions();
		addLinkToPlaceC(md, "&quot;What are you doing here?&quot;", 224, "type=chat1")
	} else if (stype == "chat1") {
		md.write("<p>He looks at you, he almost does not seem to recognise you,</p>" +
			'<p>"It\'s you, I cannot help you anymore, my Mistress has commanded me and I may do nothing else"</p>');
		startQuestions();
		addLinkToPlaceC(md, "&quot;Who is your Mistress?&quot;", 224, "type=chat2")
	} else if (stype == "chat2") {
		md.write("<p>He looks at you, his cock stiffening,</p>" + '<p>"I cannot say, my Mistress will not allow me to tell of her."</p>');
		startQuestions();
		addLinkToPlaceC(md, "&quot;What about Tess, don't you still love her?&quot;", 224, "type=chat3")
	} else if (stype == "chat3") {
		md.write("<p>He looks at you, and a faint frown passes over his face,</p>" +
			'<p>"My Mistress is everything, no one else matters."</p>' + "<p>You can see he has been very dominantly charmed and it is pointless trying to get anything more out of him. You will have to find out who his new Mistress is another way.</p>");
		startQuestions()
	}
	addLinkToPlace(md, "leave him and return to the shops", 194);
	WritePlaceFooter(md)
}

function ShowPlace225() {
	if (!isShopOpen(0)) return gotoPlaceDelayed(194, "", '<img src="UI/closed.png" style="float:left;width:15%;margin-right:5px">The Friendly Loan Company closes and all customers are asked to leave.');
	var md = WritePlaceHeader();
	var perEllie = findPerson("Ellie");
	var bEllieCharmed = perEllie.isCharmedBy("You");
	var myName = perEllie.getYourNameFor();
	var clv = perEllie.getCharmedLevel();
	if (bEllieCharmed) perEllie.showPerson("ellie1b.jpg", "", "", "ellie1c.jpg");
	else perEllie.showPerson("ellie1.jpg",
		"", "", "ellie1a.jpg");
	addPlaceTitle(md, "Friendly Loan Company");
	md.write('<p>Looking around you can see a lot of CCTv cameras.  It would seem that the "Friendly Loan Company" isn\'t taking any chances with their money.</p>');
	if (bEllieCharmed) md.write("<p>After waiting in line for a short while you finally meet up with one of the desk attendants, " + (clv == 4 ? "your slave" : "your lover") + ' Ellie, who is happy to explain the range of bank services.  "And what would you like me to help you with today ' + myName +
		'?" she asks.</p>');
	else md.write("<p>After waiting in line for a short while you finally meet up with one of the desk attendants, who turns out to be Ellie, a familiar face from your school.</p>" + '<p>She formally asks "And what would you like me to help you with today?"</p>');
	if (perYou.getBankBalance() > 0) md.write('<p>"If you\'d like to make deposits or withdrawals from your account, please use our ATM located in the corner," she says cheerfully.</p>');
	if (checkPersonFlag("Kristin", 12) && checkPersonFlag("Mom",
			6)) md.write("<p>You can go to see the manager about your credit card application, after a short wait.</p>");
	else if (perYourBody.FindItem(27) === 0) md.write("<p>It would seem that you don't have any <i>official</i> business to attend to here.</p>");
	startQuestions();
	if (perYou.getBankBalance() === 0) addQuestionR(md, "&quot;I'd like to start an account, please.&quot;", "&quot;Of course,&quot; she says cheerfully. &quot;I will just need a few pieces of information.&quot;<br/>Within moments she has your account up and running.",
		"Bank " + (isBritish() ? "Teller" : "Clerk") + " Ellie", "changeBankBalance(0);");
	else addOptionLink(md, "use the ATM", "Leave();useATM()");
	if (perYourBody.FindItem(27) > 0) addLinkToPlace(md, "show her the letter of credit from " + perGates.getPersonNameShort(), 362);
	if (checkPersonFlag("Mom", 6) || isCharmedBy("Kristin") && wherePerson("Kristin") === 362) addLinkToPlace(md, "speak with the bank manager", 362);
	addLinkToPlace(md, "exit the Bank", 194);
	WritePlaceFooter(md)
}

function ShowPlace228() {
	showGeneralPlace("Ms Titus's House", "livingroom5.jpg", "The home of Karen Titus, a small house, not that neat, it seems Ms. Titus does her housework only when she has to.", "return to Rathdown Rd", 229, sType === "" && wherePerson("MsTitus") == 228 && per.isFreeSlave() ? "td-left-med" : "")
}

function ShowPlace229() {
	var md = WritePlaceHeader(true);
	md.write('<table cellspacing="5">' + "<tr>" + '<td colspan=2 style="vertical-align:top">' + '<p style="text-align:center;font-size:x-large;margin-bottom:-1px;margin-top:0px"><b>Rathdown Rd</b></font></p>' + "</td>" + "</tr>" + "<tr>" + "<td colspan=2>" + '<p style="margin-bottom:-1px">A quiet place in Glenvale. Most of the residents on Rathdown Road work and do not have children. ' + "It is rare to see any cars or people here during the\tweek.</p><br>" + "</td>" +
		"</tr>" + '<tr><td class="td-left-xsmall">');
	if (!isPlaceKnown("RathdownRd")) setPlaceKnown("RathdownRd");
	if (isPlaceKnown("AdamsHouse")) {
		addPlaceImage(md, "house5.jpg", "90%");
		md.write('</td><td><p style="margin-bottom:-1px;margin-top:0px">2121 Rathdown Rd.  Tess & John Adams\' Residence.</p>');
		if (getPersonOther("JohnAdams") < 20) md.write("<p>You can see a car parked in front of the house.  Evidently someone is home.</p>");
		md.write("</td></tr><tr>")
	}
	if (isPlaceKnown("MsTitussHouse")) {
		if (isPlaceKnown("AdamsHouse")) md.write("<td>");
		addPlaceImage(md, "house13.jpg", "90%");
		md.write('</td><td><p style="margin-bottom:-1px;margin-top:0px">2628 Rathdown Rd.  Ms Titus\'s Residence.</p>');
		md.write("</td></tr><tr>")
	}
	if (isPlaceKnown("GinasHouse")) {
		if (isPlaceKnown("AdamsHouse") || isPlaceKnown("MsTitussHouse")) md.write("<td>");
		addPlaceImage(md, "house6.jpg", "90%");
		md.write('</td><td><p style="margin-bottom:-1px;margin-top:0px">2138 Rathdown Rd.  Residence of Gina James, the Museum Guard. A surprisingly modern and luxurious home for a security guard.</p>');
		if (wherePerson("Gina") == 302) md.write("<p>A light is on and you can see someone moving through the front window.</p>");
		else md.write("<p>The lights are out and there is no sign of movement inside.</p>");
		md.write("</td></tr><tr><td>")
	} else if (!isPlaceKnown("AdamsHouse") && !isPlaceKnown("MsTitussHouse")) addPlaceImage(md, "street4.jpg");
	else md.write("<td>");
	md.write("</td><td>");
	startQuestions();
	if (isPlaceKnown("AdamsHouse")) addLinkToPlace(md, "enter the Adams residence", 230);
	if (isPlaceKnown("MsTitussHouse")) addLinkToPlace(md,
		"enter Ms. Titus's residence", 228);
	if (isPlaceKnown("GinasHouse")) addLinkToPlace(md, "enter Gina's residence", 302, wherePerson("Gina") !== 302 ? "type=locked" : "");
	addLinkToPlace(md, "walk to Amaranth Pl", 38);
	addLinkToPlace(md, "walk to the Hotel", 123);
	WritePlaceFooter(md)
}

function ShowPlace230() {
	var md = WritePlaceHeader(false, "td-left-small");
	var perJohn = findPerson("JohnAdams");
	var nmJ = perJohn.getPersonName(false);
	var perTess = findPerson("Tess");
	var bTwoCols = perJohn.place === 230 && perTess.whereNow() == 230 && perTess.other >= 25;
	if (perJohn.place === 230 && perTess.other >= 25)
		if (!perJohn.isCharmedBy()) perJohn.showPerson("john1.jpg");
		else perJohn.showPerson("john2.jpg");
	else if (perTess.whereNow() !== 230) addPlaceImage(md, "livingroom4.jpg", "", "", "Living Room");
	if (perTess.whereNow() ==
		230 && !bTwoCols)
		if (perTess.other == 27) perTess.showPerson("tess14a.jpg");
		else if (perTess.other == 28) perTess.showPerson("tess15.jpg");
	else perTess.showPerson("tess_driving.jpg");
	addPlaceTitle(md, "Adams Residence");
	md.write("<p>Entering the Adams residence, you marvel at the neatness of the house and the expensive furniture. John and Tess Adams must earn quite a bit to afford such items.</p>");
	if (perJohn.place === 230 && perTess.other >= 25)
		if (perJohn.isCharmedBy())
			if (!perYou.isBornMale()) md.write("<p>" + nmJ +
				" welcomes you with a passionate french kiss and a hug. " + capitalizeFirstLetter(perJohn.getHeShe()) + " squeezes your arse just the way " + perJohn.getHeShe() + ' knows you like it and whispers, "It is so good to have you here, Mistress."</p>');
			else md.write("<p>" + nmJ + " Adams presents " + perJohn.getHimHer() + 'self to you like a good little slave.  "How may I serve, Master?" ' + perJohn.getHeShe() + " asks.</p>");
	else {
		if (perJohn.other === 0) {
			if (!perJohn.checkFlag(2)) showPopupWindow("John Adams", "<img src='Images/People/JohnAdams/Male/john0.jpg' class='imgpopup' alt='John'>" +
				"A man stands in the doorway. He must be Tess\u2019s husband as the way he looks at her gives it away. Tess introduces him as John and shepherds you into the living room. You judge that the couple live well, they have a huge house with a big garden and two expensive cars. The living room is also well furnished and shows a great taste in art and style with modern paintings hanging on the walls.<br><br>" + "John is suspicious of you, just like anyone else when a stranger barges into their home with their wife at their side. What did you expect; a warm welcome?<br><br>" +
				"Well, John is an average looking guy and doesn\u2019t look too muscular so if you would happen to be in a fight with him you could easily overpower him. You hope it won\u2019t come to that and Tess can help you get what you want from him without harm.", "setPersonFlag('JohnAdams',2)");
			md.write('<p>"Hello ' + perYou.getPersonName() + '," says John. "I\'m pleased to meet you. Tess here tells me that you solved the puzzle that talking worm kept going on about. Impressive, I tried for more than a day - quite unsuccessfully I must admit."</p>')
		} else if (perJohn.other ==
			8) md.write('<p>John eyes his wife suspiciously. The bulge in his jeans gives away his interest but he acts determined.</p><p>"What have you done to my wife?" he declares. "I should give you a beating for ordering her around."</p>');
		else if (perJohn.other == 9) md.write('<p>Tess returns as a nun, leaving John distraught and confused. "Okay," he says, giving in to you. "What do you want me to do?"</p>');
		if (perTess.whereNow() == 230 && perTess.checkFlag(13)) md.write("<p>Tess is looking uncertain and John is acting protective of her. It seems clear Tess will not leave her until you can exert more influence over John.</p>")
	} else if (perTess.whereNow() ==
		230 && perTess.other < 10) {
		md.write('<p>You knock on the door to the home and Mrs. Adams answers the door, looking very nervous, she looks up "John...." but her voice trails away as she sees you. She gestures nervously for you to follow her in and she sits on a chair in the lounge room near a small computer desk.</p>' + '<p>"Oh ' + perYou.getPersonName() + '...sorry I ran out on you, I really had to see my husband, but he is not here, but I called he will be soon...I should go and wait for him outside...."</p>');
		startQuestions("You have to hurry..");
		addLinkToPlace(md, "order Tess to stay", 30);
		WritePlaceFooter(md);
		return
	}
	startQuestions();
	if (perJohn.place === 230 && perTess.other >= 25)
		if (!perJohn.isCharmedBy())
			if (perJohn.other === 0) {
				addQuestionC(md, '"You don\'t happen to have any <i>more</i> magical items, do you John?"', "JohnAdams", 10400);
				addQuestionC(md, '"Like the way Tess has been dressing lately, John?"', "JohnAdams", 10405)
			} else if (perJohn.other == 1) addQuestionC(md, '"May I see the ring, John?"', "JohnAdams", 10401);
	else if (perJohn.other == 2) addQuestionC(md, '"Tess, get the ring!"', "JohnAdams", 10402);
	else if (perJohn.other == 5) addQuestionC(md, '"Do you like the way she\'s been dressing lately?"', "JohnAdams", 10405);
	else if (perJohn.other == 6) addQuestionC(md, '"You see John, I can make Tess dress anyway I want."', "JohnAdams", 10406);
	else if (perJohn.other == 7) addQuestionC(md, '"Go put on something <i>nice</i> for your husband, Tess."', "Tess", 10407);
	else if (perJohn.other == 8) addQuestionC(md, 'threaten - "Back away or I\'ll turn Tess into a prudish nun."',
		"JohnAdams", 10408);
	if (perTess.whereNow() == 230 && !perJohn.isCharmedBy()) {
		if (!perJohn.isCharmedBy() && !perTess.checkFlag(13)) {
			addQuestionC(md, '"I think I prefer you in my bedroom, Tess."', "Tess", 10420);
			if (isShopOpen(2, 1, true)) addQuestionC(md, '"Tess, let\'s meet at the library"', "Tess", 10421)
		}
		if (perYourBody.FindItem(4) > 0 && perYou.checkFlag(11) && perYou.canUseExperience()) addOptionLink(md, "ask Tess for help deciphering the passages in the book", "spendExperience()")
	}
	if ((perJohn.isCharmedBy() || perJohn.place !=
			230) && (perTess.whereNow() == 230 || perJohn.place == 230)) {
		if (perJohn.isCharmedBy() && isItemNotHere(32, 230))
			if (perJohn.place === 230) addQuestionC(md, '"Give me any other magical items you have ' + nmJ + '. Now."', "JohnAdams", 10301);
			else if (perTess.whereNow() == 230) addQuestionC(md, '"Tess, are there any other magical items your husband mentioned?"', "Tess", 10301);
		if (perJohn.getCharmedLevel() == 2 && perJohn.place === 230) addLinkToPlace(md, "enjoy " + nmJ + " Adams", 230, "type=johnsex&with=john");
		if (perTess.whereNow() == 230) {
			if (perJohn.place ===
				230) addLinkToPlace(md, "enjoy the couple", 230, "type=johnsex&with=bothrepeat");
			addQuestionC(md, '"I think I prefer you in my bedroom, Tess."', "Tess", 10420);
			if (isShopOpen(2, 1, true) && perTess.place == 230) addQuestionC(md, '"Tess, let\'s meet at the library"', "Tess", 10421);
			if (perYourBody.FindItem(4) > 0 && perYou.checkFlag(11) && perYou.canUseExperience()) addOptionLink(md, "ask Tess for help deciphering the passages in the book", "spendExperience()")
		}
		if (perTess.whereNow() == 230 && perJohn.place === 230) addSleepLink(md,
			"go to bed for the night with " + nmJ + " and Tess", "", "<p style='position:absolute;top:0.6em;left:2%;width:96%;text-align:center;cursor:pointer;margin-top:-12px;font-size:x-large" + (perYou.isBornMale() ? "" : ";color:white;text-shadow:-1px 0px black, 0px 1px black, 1px 0px black, 0px -1px black;") + "'><b>Going to Bed with " + nmJ + " and Tess</b></p>" + '<p style="position:absolute;left:2%;top:2em;cursor:pointer;font-size:1.1em;width:66%">Tess notices that night has fallen and suggests you spend the night, and sleep with her..and her husband. ' +
			nmJ + " does not notice her hesitation and agrees. You all retire for the night, after some mutual pleasure in each others arms.", "bed" + (perYou.isBornMale() ? "a" : "b") + ".jpg", perYou.isBornMale());
		else {
			if (perTess.whereNow() == 230) addSleepLink(md, "go to bed for the night with Tess", "Going to Bed with Tess", '<p style="position:absolute;left:2%;top:2em;cursor:pointer;font-size:1.1em;width:66%">As you prepare to go to bed for the night, Tess lies down on the bed looking beautiful as always. She looks at you with desire and you can see you will not be sleeping for a while...',
				"tess20c.jpg", true);
			if (perJohn.place == 230) addSleepLink(md, "go to bed for the night with " + nmJ, "Going to Bed with " + nmJ, '<p style="position:absolute;left:2%;top:2em;cursor:pointer;font-size:1.1em;width:66%">As you prepare to go to bed for the night, ' + nmJ + " lies down on the bed, ready for you" + (perJohn.isMaleSex() ? ", or at least he will be soon as you see his cock stir..." : ""), perJohn.getImg("johnbed.jpg"), false, "", "", "", "background-color:#110705")
		}
	}
	addLinkToPlace(md, "exit the Adams home", 229);
	if (bTwoCols) {
		AddRightColumnMed(md);
		if (perTess.other == 27) perTess.showPerson("tess14a.jpg", "95%", "right");
		else if (perTess.other == 28) perTess.showPerson("tess15.jpg", "95%", "right");
		else perTess.showPerson("tess_driving.jpg", "95%", "right")
	}
	WritePlaceFooter(md)
}

function ShowPlace234() {
	var md = WritePlaceHeader();
	var bOpen = isShopOpen(2);
	var perLogan = findPerson("MissLogan");
	var clv = perLogan.getCharmedLevel();
	if (bOpen && perLogan.place === 0)
		if (clv == 1) perLogan.showPerson("logan7a.jpg");
		else if (clv == 2) perLogan.showPerson("logan7b.jpg");
	else if (perLogan.other == 6) perLogan.showPerson("logan2.jpg");
	else if (perLogan.other == 7) perLogan.showPerson("logan3.jpg");
	else addPlaceImage(md, "classroom3.jpg");
	else addPlaceImage(md, "classroom3.jpg");
	addPlaceTitle(md, "Anatomy Classroom");
	md.write("<p>Your favorite class. You have enjoyed many hours in this room watching Miss Logan explain about things that are usually banned at home. Vandals have defaced the chalkboard. Again.</p>");
	if (bOpen)
		if (clv > 0)
			if (clv == 1) md.write("<p>After you took over her mind, Miss Logan rapidly forgot about that project that she gave to you. However you two have discussed the idea of some private lessons about the only thing that interests you in anatomy; Her. Miss Logan liked the idea so much that she doesn\u2019t even care about the other students or her normal lessons. She\u2019s always well prepared for your arrival to these kind of sessions. By dressing sexy and letting you fuck her anytime you want she slowly turns into your servant.</p>" +
				"<p>Miss Logan is patiently sitting next to her desk, waiting for you when you enter the somewhat run down empty classroom. She gently kisses you on the lips (her way of welcoming you) and asks you if you want your extra coaching or you want something more.</p>");
			else {
				md.write("<p>After you took over her mind, Misss Logan rapidly forgot about that project that she gave to you. However you two have discussed the idea of reproduction, and breeding, breeding her that is.</p>");
				if (perYou.isMaleSex())
					if (perLogan.checkFlag(1)) md.write("<p>With luck you have already bred her, but if not you can always try again!. Miss Logan is standing near her desk waiting for more discussions on breeding.</p>");
					else md.write("<p>You have not yet tried to  breed her, and you look forward to fulfilling her desire! Miss Logan is standing near her desk waiting for more discussions on breeding.</p>");
				else md.write("<p>While you cannot breed her personally, you have promised to find a good slave to breed her! Miss Logan is standing near her desk waiting for more discussions on breeding.</p>")
			}
	else if (perLogan.other == 6) md.write("<p>She is busy marking some papers.</p>");
	else if (perLogan.other == 7) md.write('<p>She looks up and asks, "How is that project going? Do you need any help?"</p>');
	startQuestions();
	if (bOpen) {
		if (perLogan.other == 6 && clv === 0) addQuestionCO(md, "cough to get Miss Logan's attention", "MissLogan", 6);
		if (clv > 0) addLinkToPlaceC(md, clv == 1 ? "ask Miss Logan for a lesson" : "discuss reproduction with Miss Logan", 234, "type=loganxxx")
	}
	addLinkToPlace(md, "exit the room", 70);
	WritePlaceFooter(md)
}

function ShowPlace235() {
	var md = WritePlaceHeader(true);
	md.write('<table class="table-main"><tr><td style="vertical-align:top;background-color:#C0C0C0;color:black">' + '<p style="text-align:center;font-size:x-large"><b>History of the Sanctuary Arms</b></p>' + "<p>When Glenvale was first founded a dark coven of witches opened a hellgate. Arrogant in their " + "power and curiosity, the coven believed that they could control the forces that they had unleashed. It was not so.</p>" + "<p>An ancient family of mystics found out about the gate, managed to close it with a mystic " +
		"artifact that locked it down, and remained in Glenvale to " + "make sure that it would never be reopened. To aid in this task, they built a building called The Sanctuary Arms.</p>" + "<p>Later an evil warlock, Carl Kurndorf, stole the artifact and managed to kill the most powerful " + "of the guardian family through treachery and unholy alliances while they were trying to prevent the Hellgate " + "from opening. The guardian's apprentice and lover managed a barrier spell that trapped her in the dungeon beneath " +
		"the building to prevent the gate from opening. Her presence " + "is a cork to stop the hellgate's opening. Since the apprentice was trapped, and the other protectors were " + "murdered, Carl Kurndorf took over the town. He set " + "himself up as ruler in the very building which guards the hellgate and from which he stole the artifact.</p>" + "<p>Carl Kurndorf renamed the building which became his seat of power to commemorate this major event " + "in his life: The building known as The Broken Inn Hotel.</p>");
	startQuestions();
	addLinkToPlace(md, "exit the reference area", 3);
	WritePlaceFooter(md)
}

function ShowPlace236() {
	var md = WritePlaceHeader();
	addPlaceTitle(md, "Phone Message", getThemeFolder() + "phone2.png");
	md.write("<p>You listen to the phone message. It is a Friendly Loan Company manager.</p>");
	var chance = Math.random();
	if (nMoney > 19) chance = 1;
	if (chance < .5) {
		md.write('<p>"Hello ' + perYou.getPersonName() + '," says the bank manager. "Congratulations for winning our saver of the minute prize. We have sent ' + sCurrency + '2.00 to your house. Spend it wisely."</p>' + "<p>An envelope slides through your front door letter latch. You pick it up and incredibly find " +
			sCurrency + "2.00.</p>");
		AddCash(2)
	} else md.write('<p>"Hello ' + perYou.getPersonName() + '," says the bank manager. "We want to tell you that the Friendly Loan Company is the bank of your choice."</p>');
	startQuestions();
	addLinkToPlace(md, "go to the kitchen?", 45);
	WritePlaceFooter(md)
}

function ShowPlace237() {
	var perHannah = findPerson("Hannah");
	var perMonique = findPerson("Monique");
	var clvM = perMonique.getCharmedLevel();
	var md = WritePlaceHeader();
	perHannah.showPerson(perHannah.isHere() ? "hannah9.jpg" : "hannah-stairway.jpg");
	addPlaceTitle(md, "Hannah's Apartment");
	md.write("<p>Hannah and Monique live in a  comparably small apartment right above Hannah's workshop with a single corridor connecting a Kitchen, the bath and a room for each of them. You've heard that the rent is quite steep around the commercial center, which is likely the reason they live together.</p>" +
		"<p>The place is neat and tidy, much like the workshop.</p>");
	if (perHannah.isHere()) {
		md.write("<p>Hannah looks happy to see you as she opens the door, ushering you in and offering whatever you want, a drink, food, or herself.</p>");
		if (perMonique.isHere()) md.write("<p>Monique seems to be in her room as well, working on her PC.</p>")
	} else if (perMonique.isHere()) md.write("<p>Hannah is not here to greet you this time, but you hear noises from Monique's room as you enter the stairway.</p>");
	else md.write("<p>Hannah is not here to greet you this time, and Monique is probably at the Library.</p>");
	startQuestions();
	if (perHannah.isHere()) {
		if (perYou.isMaleSex() || perYourBody.FindItem(45) > 0) addLinkToPlaceC(md, '"I want you, now"', 237, "type=iwantyou");
		if (perMonique.isHere() && clvM > 0) addLinkToPlaceC(md, 'Tell Monique and Hannah to "Service your ride"', 237, "type=service");
		addLinkToPlace(md, "enter Hannah's room", 284)
	}
	if (perMonique.isHere()) addLinkToPlace(md, "enter Monique's room", 283);
	addLinkToPlace(md, "leave the apartment", 194);
	WritePlaceFooter(md)
}

function ShowPlace238() {
	var md = WritePlaceHeader();
	addPlaceTitle(md, "Glenvale Museum", "museum.jpg");
	setPlaceBreakIn("Museum", false);
	setPlaceKnown("Museum");
	md.write("<p>Glenvale museum stands proudly, representing the community spirit of the town's people. For the last seventy years local groups and councils having lovingly cared for its contents.</p>");
	if (checkPlaceFlag("Museum", 8)) md.write('<p>There is a big yellow sign on the front steps.  "MUSEUM CLOSED TO THE PUBLIC"</p>');
	else if (!isShopOpen(2,
			0, true)) md.write("<p>The Museum has a sign noting that is closed, hours of business 8am to 8pm.</p>");
	startQuestions();
	if (isShopOpen(2, 0, true) && !checkPlaceFlag("Museum", 8)) addLinkToPlace(md, "enter the Museum", 239);
	if (isPlaceKnown("Aquarium")) addLinkToPlace(md, "walk to the Aquarium", 360);
	if (isPlaceKnown("CelesteRd")) addLinkToPlace(md, "walk down Celeste Road", 455);
	addLinkToPlace(md, "walk to the Library", 2);
	WritePlaceFooter(md)
}

function ShowPlace239() {
	var md = WritePlaceHeader();
	var perGina = findPerson("Gina");
	if (!isShopOpen(2, 0, true) && !isPlaceBreakIn("Museum") && !perGina.isCharmedBy() && !isPossess())
		if (!perGina.isCharmedBy()) return gotoPlaceDelayed(9, "", '<img src="UI/closed.png" style="float:left;width:15%;margin-right:5px">The Museum closes and the security guard makes sure everyone leaves.');
	if (perYou.getQuestRustyKey() == 5) perYou.setQuestRustyKey(7);
	addPlaceTitle(md, "Museum Main Hall", "museumroom-main1.jpg");
	md.write("<p>Artifacts of ancient times fill the rooms of the small but elegantly-attired museum.</p><p>This is the central hall giving access to all the other areas of the museum.</p>");
	if (!isPlaceKnown("Aquarium")) {
		md.write("<p>You notice a sign advertising the newly refurbished Glenvale Aquarium, a new annex of the museum. You note the directions to visit the new attraction, it is outside the museum proper in a separate building.</p>");
		setPlaceKnown("Aquarium")
	}
	if (!checkPlaceFlag("Museum", 8) && perGina.isCharmedBy()) md.write("<p>You see your slave Gina waving to you and gesturing towards a door, the security office it seems.</p>");
	startQuestions();
	addLinkToPlace(md, "examine the museum safe",
		276);
	addLinkToPlace(md, "check the local history exhibits", 240);
	addLinkToPlace(md, "check the other exhibits", 249);
	if (isPossess()) addLinkToPlace(md, "check out the Security Office", 304);
	else {
		if (perGina.other > 0 && perGina.place === 0 && !perGina.isCharmedBy()) addLinkToPlace(md, "approach the security guard", 277);
		if (checkPlaceFlag("Museum", 8) || perGina.isCharmedBy()) addLinkToPlace(md, "check out the Security Office", 304);
		if (isShopOpen(2, 0, true)) addLinkToPlace(md, "exit the museum", 238);
		else addTextForQuestions(md,
			"<b>The doors of the Museum are locked</b>", "center")
	}
	WritePlaceFooter(md)
}

function ShowPlace240() {
	var md = WritePlaceHeader();
	var perMG = findPerson("MrsGranger");
	var clv = perMG.getCharmedLevel();
	var img = checkPlaceFlag("Museum", 8) || perMG.place == 1 || !isShopOpen(2, 0, true) ? "museumroom-local1.jpg" : "museumroom-local2.jpg";
	addPlaceTitle(md, "Local History Exhibits", img, 0, false, "", true, img == "museumroom-local1.jpg" ? "90%" : "");
	md.write("<p>Looking around the museum you find lots of interesting items that must have been really useful once upon a time.</p><p>You arrive at the area for Glenvale local history, stretching from pre-history to recent times.</p><p>This area has some large windows to allow natural light into the rooms. They appear to be made of some security material like bullet-proof plastic or similar.</p>");
	if (perMG.other ==
		5 && whereItem(29) === 0) PlaceI(29);
	if (perMG.place == 1)
		if (clv == 1) md.write('<p>Only Mrs. Granger is present in the area and she calls out, "Oh look dear," says Mrs. Granger. "I have found a vase. It might have something to do with the dragon gem. It is a sealed steel vase, the top is melted shut in some way. Interestingly is it warmer than it should be, but this is thought to just be a quirk of it\'s metal and color, it is not radioactive or anything like that."</p>');
		else md.write('<p>"Oh look darling," says Mrs. Granger. "I have found a vase. It might have something to do with the dragon gem. It is a sealed steel vase, the top is melted shut in some way. Interestingly is it warmer than it should be, but this is thought to just be a quirk of it\'s metal and color, it is not radioactive or anything like that."</p>');
	else if (img == "museumroom-local1.jpg") md.write("<p>Current the area is deserted.</p>");
	else md.write("<p>Generally a popular exhibit, you see a number of people walking around looking at the exhibits.</p>");
	startQuestions();
	addLinkToPlace(md, "return to the main hall?", 239);
	addLinkToPlace(md, "explore the remainder of the museum?", 249);
	if (perMG.place == 1) {
		AddPeopleColumn();
		perMG.showPerson("granger-face.jpg", "100%", "", "!granger12a.jpg")
	}
	WritePlaceFooter(md, "", !isDay())
}

function ShowPlace241(stype) {
	var md = WritePlaceHeader();
	var perGina = findPerson("Gina");
	var perMG = findPerson("MrsGranger");
	var clvMG = perMG.getCharmedLevel();
	if (stype === "") {
		perGina.showPerson("gina1c.jpg");
		addPlaceTitle(md, "Museum Guard");
		md.write('<p>As you reach for the vase a security guard leaps out, drawing a pistol. "Stop right there!" she yells, her finger itching to pull the trigger.</p>');
		if (perGina.other === 0) perGina.other = 1;
		if (perGina.isCharmedBy()) {
			md.write("<p>You see it is Gina, and she immediately re-holsters her pistol,</p>" +
				'<p>"Ohhh, sorry ' + perYou.getMaster() + ' I did not realise it was you! Did you want this vase? Please take it, I will report it stolen later by an unknown person!"</p>');
			if (perYourBody.FindItem(29) === 0)
				if (perYourBody.PutItem(29)) {
					moveItem(29, 0);
					SetVaseVariables()
				}
		}
		startQuestions();
		if (perGina.isCharmedBy()) {
			startQuestions();
			addLinkToPlace(md, "return to the main hall?", 239);
			addLinkToPlace(md, "explore the remainder of the museum?", 249)
		} else {
			if (perMG.other == 5)
				if (clvMG == 1) {
					startAlternatives(md);
					addLinkToPlaceC(md,
						"Mrs. Granger moves to distract the guard", 241, "type=distract");
					addQuestionC(md, "ask Mrs. Granger to go home", "MrsGranger", 236);
					endAlternatives(md)
				} else {
					startAlternatives(md);
					addLinkToPlaceC(md, "order Mrs. Granger to attack the guard", 241, "type=attack");
					addLinkToPlaceC(md, "Mrs. Granger moves to distract the guard", 241, "type=distract");
					addQuestionC(md, "order Mrs. Granger to go home", "MrsGranger", 236);
					endAlternatives(md)
				}
			else addLinkToPlace(md, "attack the guard", 241, "type=meattack");
			addLinkToPlace(md,
				"exit the museum before you get arrested?", 238)
		}
		if (perMG.other == 5) {
			AddPeopleColumn();
			if (perMG.other == 5) perMG.showPerson("granger-face.jpg", "100%", "", "!granger12a.jpg")
		}
	} else {
		var perKate = findPerson("Kate");
		if (stype != "meattack") {
			perMG.other = 50;
			perMG.setFlag(3);
			if (perKate.place != 9999) perKate.place = 1;
			perKate.other = 7;
			perKate.charmedTime = nTime
		}
		moveItem(29, 1001);
		if (whereItem(34) === 0) PlaceI(34, 276);
		setPlaceFlag("Museum", 3);
		if (!isPlaceKnown("PoliceStation")) setPlaceKnown("PoliceStation");
		if (perYourBody.FindItem(4) >
			0) perYourBody.DropItem(4, isCharmedBy("Diane") ? 999 : 76);
		if (perYourBody.FindItem(9) > 0) perYourBody.DropItem(9, 1);
		if (getPersonOther("Diane") === 0) {
			setPersonOther("Diane", 1);
			movePerson("Diane", 168)
		}
		perYou.setArrested(3);
		perYourBody.DropAllItems("Diane");
		if (stype == "meattack") {
			perMG.place = 177;
			if (perMG.other == 5) perMG.other = 4;
			perGina.showPerson("gina1d.jpg");
			addPlaceTitle(md, "You try to attack");
			md.write("<p>You try to jump the guard but you are just too slow, she leaps aside and threatens you and you freeze as the gun it pointing at your chest and you have no hope...</p>" +
				"<p>The guard radios for assistance and quickly the police arrive. You are handcuffed and escorted to jail for attempted robbery.</p>");
			startQuestions("You have no choice...");
			addLinkToPlace(md, "you are taken to the police station", 168, "arrest=true")
		} else if (stype == "attack") {
			perMG.place = 275.5;
			perMG.health = 20;
			setPlaceKnown("HospitalICU");
			perMG.setFlag(1);
			perMG.showPerson("!granger12a.jpg", "height:max");
			addPlaceTitle(md, "Mrs Granger shot, and you are arrested!");
			md.write("<p>Mrs Granger moves in the light of the large windows, and jumps the guard and the two blondes crash to the floor. After a brief wrestle the guard's pistol sounds out and Mrs Granger crumples, blood pouring from her chest.</p>" +
				"<p>The guard radios for assistance and quickly the police arrive. You are handcuffed and escorted to jail for attempted robbery. An ambulance is called to take Mrs. Granger to the hospital.</p>");
			startQuestions("You have no choice...");
			addLinkToPlace(md, "you are taken to the police station", 168, "arrest=true")
		} else {
			perMG.place = 261;
			perMG.setFlag(4);
			perMG.showPersonRandom("!granger12b", 2, "height:max");
			addPlaceTitle(md, "Both Arrested!");
			md.write("<p>Mrs Granger moves in front of a large window and starts to do a strip-tease as the guard watches nervously. The guards eyes focus on Mrs. Granger and you make a move to take the Vase and run. " +
				"The guard notices and shoots but her aim was off as she was absorbed in watching Mrs. Granger. The shot goes wild but she immediately re-aims and calls for you to surrender. Mrs. Granger freezes, unwilling to push further and endanger your life. The guard radios for assistance and in a surprising short time the police arrive.</p>" + "<p>Mrs Granger and yourself are handcuffed and escorted to jail for attempted robbery.</p>");
			startQuestions("You have no choice...");
			addLinkToPlace(md, "you are taken to the police station",
				168, "arrest=true")
		}
	}
	WritePlaceFooter(md)
}

function ShowPlace242() {
	var bOpen = isShopOpen(2);
	var perT = findPerson("MrsTanika");
	var clv = perT.getCharmedLevel();
	var perJ = findPerson("MsJones");
	var bTanika = perT.place == 242 && bOpen;
	var bJones = perJ.isHere() && bOpen;
	if (perYou.getQuestRustyKey() == 5) perYou.setQuestRustyKey(7);
	var md = WritePlaceHeader(false, bJones ? "td-left-med" : "");
	if (bTanika) perT.showPerson(clv > 0 ? "tanika2.jpg" : "tanika1b.jpg");
	else if (bJones) perJ.showPerson("jones15.jpg");
	else addPlaceImage(md, "school4.jpg");
	addPlaceTitle(md, "Teacher's Lounge");
	md.write("<p>The tea room is often the meeting place for the staff of Glenvale High. Other than the tables and chairs in the room, you can see some plants in the far corner. A blue lounge is against one wall and a small desk was setup some time ago when a teachers office was under repair, and then staff never bothered removing the desk after that.</p><p>");
	if (bJones) md.write("<p>Ms. Jones is busy grading student homework, but seeing you enter the room, she greets you with a welcoming smile.</p>");
	else if (bTanika)
		if (clv > 0)
			if (clv == 2) md.write("<p>As you enter her classroom, Mrs. Tanika, is sitting reviewing some papers, completely naked. She rises from her desk and spins to you. She hugs and kiss you for a few seconds that feels an eternity in heaven to you, her boobs touching your chest in the process.</p>" + "<p>Mrs. Tanika, your math teacher, and now lover. She is still strict and stand-offish to others, but she is your lover now! You\u2019ve learned that she was a mathematician before coming to your school. She was working for a technology leading company where she was assisting them with all the computational techniques, algorithms, and the latest computer technology she knew. She\u2019s quite smart and pretty\u2026 what more could a " +
				(perYou.isBornMale() ? "guy" : "gal") + " want? Well, she is extremely fond of you and seems really attached to your presence. She\u2019s constantly offering you private lessons and good grades when you two are together. That means you don\u2019t have to worry about math anymore. That\u2019s awesome! You always hated that subject!</p>");
			else md.write("<p>Mrs. Tanika, is sitting reviewing some papers, completely naked, waiting for your return.</p>");
	else md.write("<p>Mrs. Tanika, your math teacher, is relaxing and reading some papers. She tries to ignore you so that you will leave.</p>");
	startQuestions();
	if (bTanika) {
		if (!perT.checkFlag(1)) addPopupLinkC(md, "say hello to Mrs. Tanika", "Mrs. Tanika", "<img src='Images/tanika1a.jpg' class='imgpopup' alt='Ms. Tanika'>" + "Mrs. Susan Tanika, your math teacher, is <i>unfortunately</i> in the lounge, apparently relaxing and reading some papers." + "<br><br>" + "You thought <i>unfortunately</i> as you do not really like her, she is a rather strict and standoff-ish teacher who seldom smiles. She has a body to die for but she is either uncaring or looks down on her students. Your friend Catherine once suggested she might get off on humiliating people, and be a closet dominatrix. Then again Catherine always assumes people are kinky, maybe she is right." +
			"<br><br>" + "Despite this you try to be respectful and sociable and say &quot;Hello Mrs. Tanika&quot; but she glances at you and continues reading her papers, her way of saying &quot;Leave me alone&quot;", false, "setPersonFlag('MrsTanika',1);dispPlace();");
		if (clv > 0) {
			addLinkToPlaceC(md, "talk to Mrs. Tanika", Place, "type=tanikaxxx");
			addLinkToPlace(md, "relax for a while with Mrs. Tanika", "", "", "You kill some time chatting with Mrs. Tanika", "", "WaitHere(3);")
		}
	} else if (bJones) addLinkToPlace(md, "relax for a while with Ms. Jones",
		"", "", "You spend some time chatting with Ms. Jones", "", "WaitHere(3);");
	else addLinkToPlace(md, "relax for a while", "", "", "You kill some time for an hour, you have a coffee from the machine here the teachers use", "", "WaitHere(5);");
	if (bJones && perJ.checkFlag(16)) addPopupLinkToPlace(md, "exit the room", 70, "", "Leaving", "<img src='Images/jones16.jpg' class='imgpopup' alt='MsJones'>" + "\u201cOh, could you please 'old ze door open for me?\u201d Ms Jones rises from her chair and gathers her papers in both hands while you wait for her.</p>" +
		"<p>Merci beaucoup, " + perYou.getPersonName() + "!\u201d She moves past you with a wide smile. \u201cI am -very much- looking forward to seeing the results of your studies, I know you 'ave talent, so do not let minor setbacks discourage you.\u201d</p>" + "<p>You think she gave you a wink as she said that, but before you are able to say anything, Ms Jones is already on her way outside.", 'movePerson("MsJones",0)', "", true);
	else addLinkToPlace(md, "exit the room", 70);
	WritePlaceFooter(md)
}

function ShowPlace243() {
	var md = WritePlaceHeader();
	var perMayor = findPerson("Mayor");
	if (perMayor.place == 176) perMayor.showPerson("mayor3.jpg");
	else perMayor.showPerson("mayor7.jpg");
	if (wherePerson("MrsTanika") === 0) {
		movePerson("MrsTanika", 242);
		if (!isMurderPath()) movePerson("MsJones", 145)
	}
	addPlaceTitle(md, "Mayor Thomas Charmed");
	md.write("<p>The spell immediately takes hold of the mayor, extracting her inhibitions before your eyes...</p>" + '<p>"Oh god!" she cries, pulling her shirt open. "I feel so fucking horny." She turns a suddenly predatory grin your way. "I bet that you have never had a woman like me before."</p>');
	startQuestions();
	addLinkToPlace(md, "watch the spell take over", 244);
	if (perMayor.place == 176) addLinkToPlace(md, "exit the house?", 43);
	else addLinkToPlace(md, "exit the town hall", 94);
	WritePlaceFooter(md)
}

function ShowPlace244() {
	var md = WritePlaceHeader();
	var perMayor = findPerson("Mayor");
	if (perMayor.place == 176) perMayor.showPerson("mayor4.jpg");
	else perMayor.showPerson("mayor8.jpg");
	addPlaceTitle(md, "Mayor Thomas Charmed");
	if (perMayor.place == 176) md.write("<p>The Mayor's passion is amazing. Without hesitation she reaches into her handbag to pull out a blue dildo.  Her left hand slides down between her legs and she begins to enjoy herself.</p>");
	else md.write("<p>The Mayor's passion is amazing. Without hesitation she reaches into her desk to pull out a massive purple dildo.  Her left hand slides down between her legs and she begins to enjoy herself.</p>");
	md.write('<p>"It has been sooo long," she moans as much to herself as to you. "Please. Please give me what you\'ve got. Uhhh."</p>');
	startQuestions();
	if (perMayor.place == 176) {
		addLinkToPlaceC(md, "talk more with the mayor", 176);
		addQuestionC(md, "order the mayor to return to her office", "Mayor", 1650);
		addLinkToPlace(md, "exit the house?", 43)
	} else {
		addLinkToPlaceC(md, "talk more with the mayor", 110);
		addLinkToPlace(md, "exit the town hall", 94)
	}
	WritePlaceFooter(md)
}

function FindIt246(doc) {
	var sText = doc.FormChar.research.value.toLowerCase().trim();
	if (checkPlaceFlag("Crypt", 3) && sText == "modest" || checkPlaceFlag("Crypt", 4) && sText == "mason" || checkPlaceFlag("Crypt", 5) && sText == "garlic") {
		if (perKurndorf.getQuestCrypt() == 18) perKurndorf.setQuestCrypt(19);
		setPlaceKnown("Crypt");
		var perMonique = findPerson("Monique");
		perMonique.setFlag(5, false);
		gotoPlace(247, "", "Correct! The ground shakes as the great tablet before you crumbles to dust beneath your feet. You have discovered an ancient crypt.")
	}
}

function ShowPlace246() {
	var md = WritePlaceHeader();
	var perMonique = findPerson("Monique");
	perMonique.setFlag(5);
	addPlaceTitle(md, "Tablet Puzzle", "Items/tablet.jpg");
	if (!checkPlaceFlag("Crypt", 3) && !checkPlaceFlag("Crypt", 4) && !checkPlaceFlag("Crypt", 5)) setPlaceFlag("Crypt", Math.floor(Math.random() * 3) + 3);
	md.write("<p>Embossed are the words, ");
	if (checkPlaceFlag("Crypt", 3)) md.write("&quot;One is vain by nature, <b>teomds</b> by necessity.&quot;");
	else if (checkPlaceFlag("Crypt", 4)) md.write("&quot;A maker of tablets, often said to be free <b>amnos</b>.&quot;");
	else md.write("&quot;A guard against the dead and often the living, <b>aiglcr</b>.&quot;");
	md.write('</p><form method="POST" name="FormChar"><p>Unscramble the letters:</p>' + '<p><input type="text" size="20" name="research"><input type="button" name="button" value="please" onClick="FindIt246(document)"></p></form>');
	startQuestions();
	addLinkToPlace(md, "go to the wild ranges?", 26);
	WritePlaceFooter(md)
}

function ShowPlace247(stype) {
	var md = WritePlaceHeader();
	var perV = findPerson("Vampyre");
	addPlaceTitle(md, "The Crypt", "crypt1.jpg");
	md.write("<p>An ancient crypt, hidden for over a hundred years, lies before you. Motes of dust float through the air in the ");
	if (isDay()) md.write("sunlight dimly lighting the crypt");
	else md.write("limited light from your phone and the moonlight from outside");
	md.write(". A coffin stands on an ornate pedestal.</p>");
	startQuestions();
	if (perV.isCharmedBy("You"))
		if (!isDay()) addOptionLink(md,
			"wait for daytime", "WaitforForDayNight()");
		else addOptionLink(md, "wait for darkness", "WaitforForDayNight()");
	addLinkToPlace(md, "examine the coffin", 248);
	addLinkToPlace(md, "exit the crypt?", 26);
	WritePlaceFooter(md)
}

function GiveSkull() {
	if (perYourBody.NoItems == perYourBody.MaxItems && perYourBody.FindItem(57) === 0) WriteComments("You don't have enough room to carry any more items.  Make room and try again.");
	else {
		if (perYourBody.FindItem(57) === 0) perYourBody.PutItem(57, true);
		perKurndorf.setFlag(1);
		dispPlace()
	}
}

function ShowPlace248() {
	var md = WritePlaceHeader();
	if (perKurndorf.checkFlag(1)) md.write('<img src="Images/coffin2.jpg" style="margin:0px 5px;border-style:solid;border-width:2px" width="190" height="222" alt="Coffin">');
	else md.write('<img src="Images/coffin1.jpg" style="margin:0px 5px;border-style:solid;border-width:2px" width="190" height="222" alt="Coffin">');
	if (!isMurderPath() && isItemNotHere(25, 46)) moveItem(25);
	addPlaceTitle(md, "The Coffin");
	md.write("<p>Inside the coffin are the remains of Kurndorf, the evil of Glenvale. His skeleton burns with a fierce magic that you fear to touch.</p>");
	if (whereItem(25) == 248) md.write("<p>A small wooden box lies in the coffin beneath his feet.  It seems simple enough: barely decorated but there is still something odd about it.</p>");
	startQuestions();
	if (perKurndorf.getQuestGhost() >= 100 && perKurndorf.getQuestRitual() < 200 && !perKurndorf.checkFlag(1)) addLinkToPlace(md, "Carefully remove Kurndorf's skull", 248, "", "", "", "GiveSkull()");
	addLinkToPlace(md, "look around the crypt?", 247);
	WritePlaceFooter(md)
}

function ShowPlace249(stype) {
	var md = WritePlaceHeader();
	var nRoom = stype !== "egypt" && checkPlaceFlag("Museum", 5) ? Math.floor(Math.random() * 2) + 3 : 4;
	addPlaceTitle(md, "Museum Exhibits", "museumroom" + nRoom + ".jpg");
	if (nRoom == 3) md.write("<p>Artifacts celebrating Glenvale's ties to Asia and its small Chinese community.</p>");
	else {
		md.write("<p>A small Egyptology exhibit, mostly donated long ago by Lady Elizabeth Ross. Your friend Amy once mentioned this ancestor of hers, but you forget whatever she told you.</p>" +
			"<p>There is a painting near the entrance of the exhibit of Lady Elizabeth Ross, noted as a copy of a work held by the Ross estate. The copy is credited to the renowned artist Samuel James, probably the best known artist that Glenvale ever produced. Th original work is noted as by an unknown artist.</p>");
		setPlaceFlag("Museum", 5);
		setQueryParams("type=egypt")
	}
	startQuestions();
	addLinkToPlace(md, "examine the exhibits", "", "", "You spend an hour looking at all the exhibits for anything useful for your quest.",
		"", "WaitHere(5);");
	addLinkToPlace(md, "check the local history exhibits", 240);
	addLinkToPlace(md, "return to the main hall?", 239);
	WritePlaceFooter(md)
}

function LeaveLair() {
	var perAnita = findPerson("Anita");
	perAnita.place = 9999
}

function ShowPlace252(stype) {
	var md = WritePlaceHeader();
	var perAnita = findPerson("Anita");
	var bCharmed = perAnita.isCharmedBy("You");
	var bNoShow = false;
	var myName = perYou.isBornMale() ? "Sir" : "Ma\\'am";
	if (perAnita.place !== 252) {
		addPlaceTitle(md, "Empty Storeroom", "storage.jpg");
		md.write("<p>This is a disused storeroom, once Anita's Lair, she must have left here to go somewhere else. Assorted useless things are stored here and there.</p>");
		if (whereItem(47) == 252) md.write("<p>You see a sports bag left here, probably abandoned by Anita.</p>");
		startQuestions();
		addLinkToPlace(md, "return to Ms Jones' office", 145)
	} else if (stype == "deploy") {
		perAnita.showPerson("anita6.jpg");
		addPlaceTitle(md, "Anita's Deployment");
		perAnita.moveThem(45);
		md.write("<p>You tell Anita that you have new orders for her, and she stands to attention. You walk around, inspecting her assets, and tell her,</p>" + '<p>"Soldier, I need you to redeploy as a guard for myself. Go to my home and wait for me in my bedroom, make sure to wear something appropriate. You will be undercover as my girlfriend, so wear something sexy."</p>' +
			'<p>You tell her your address and remind her to dress before leaving. She looks at you, and replies "Yes ' + myName + '!"</p>' + "<p>She quickly gathers some gear and dresses and leaves you with a salute.</p>");
		bNoShow = true;
		startQuestions();
		addLinkToPlace(md, "return to Ms Jones' office", 145)
	} else if (stype == "freed") {
		perAnita.showPerson("anita4.jpg");
		addPlaceTitle(md, "Anita's Lair");
		md.write("<p>Anita looks puzzled, her clothes covering little of her body. She rests the shotgun on her shoulder and asks you,</p>" +
			'<p>"Who the hell are you, why have you brought me here! Did you drug me, is that why I feel this hatred towards you, despite I have never seen you before!"</p>' + "<p>You point out that <i>she</i> is the one with the weapon and put your hands up. She looks startled and seems to just then realise she is holding the shotgun, and continues talking,</p>" + '<p>"Well I guess you are right, I can see some of my gear around here too. I must have really, really got drunk last night!! So did we....you know...?"</p>');
		bNoShow = true;
		startQuestions();
		addLinkToPlaceC(md, '"No, no I just found you here in this storeroom"', 145, "", "&quot;Well then, excuse me while I get dressed and get the hell out of here, I was only supposed to be in the town overnight, I need to get going&quot;<br>With that she kicks you out of the storeroom.", "Anita", "LeaveLair()");
		addLinkToPlace(md, "return to Ms Jones' office", 145, "", "", "", "LeaveLair()")
	} else if (stype == "shotjump" || stype == "shotcharm") {
		perAnita.showPerson("anita1.jpg", "height:max");
		addPlaceTitle(md, "Shot!");
		if (stype == "shotjump") md.write("<p>You leap at Anita, with the idea of wrestling the gun from her in her confusion, but her expression immediately hardens at the threat. " + "Anita immediately reacts, the shotgun swings up and there is a devastating roar as the blast hits you in the chest. You collapse, your life blood pouring from the wound.</p>");
		else md.write("<p>You read a spell.... but it nothing happens, she must already be under the effects of a charm spell.</p>" + "<p>Anita immediately reacts to your words, the shotgun swings up and there is a devastating roar as the blast hits you in the chest. You collapse, your life blood pouring from the wound.</p>");
		md.write("<p>You can't believe that after all this play the " + "game has ended this way. Your life ebbs away and all you can " + "think of is revenge in the afterlife.</p>" + "<p>Better luck next time...</p>");
		bNoShow = true;
		startQuestions();
		addRestartLink(md)
	} else if (stype === "" && !bCharmed) {
		perAnita.showPerson("anita3.jpg");
		addPlaceTitle(md, "Anita's Lair");
		if (whereItem(21) === 0 && perAnita.other < 900) PlaceI(21);
		if (!isPlaceKnown("AnitasLair")) setPlaceKnown("AnitasLair");
		md.write("<p>You catch Anita unawares, she was in the process of changing clothes. She awkwardly tries to cock the shotgun but seems to be confused about the weapon.</p>");
		if (whereItem(21) == Place) md.write("<p>Amidst her naive fumbling you notice the sparkle of a small blue key as it falls to the floor.</p>");
		md.write("<p>You only have moments before she comes to her senses, what do you do?</p>");
		bNoShow = true;
		startQuestions();
		addLinkToPlace(md, "jump her!", 252, "type=shotjump");
		addLinkToPlace(md, "return to Ms Jones' office", 145, "", "", "", "LeaveLair()")
	} else if (stype === "" && bCharmed) {
		perAnita.showPerson("anita8.jpg", "height:max");
		addPlaceTitle(md, "Anita's Lair");
		md.write("<p>Your slave Anita is waiting for you in the abandoned storeroom, ready for anything, but also completely naked</p>");
		if (whereItem(47) == 252) md.write("<p>You see an empty sports bag sitting on a dusty shelf.</p>");
		if (whereItem(21) == 252) md.write("<p>You see an odd key hanging on a hook, on it you see a small engraving of a pentagram.</p>");
		startQuestions();
		addLinkToPlaceC(md, 'order her "Prove your loyalty!"', 252, "type=proveit");
		if (perAnita.checkFlag(7)) addLinkToPlaceC(md, "redeploy her", 252, "type=deploy");
		addLinkToPlace(md, "return to Ms Jones' office", 145)
	} else {
		if (stype === "anita5") {
			perAnita.showPerson(stype + ".jpg");
			addPlaceTitle(md, "Anita Under <i>Your</i> Charm Spell");
			md.write('<p>You tell her,<br>"No we did not <i>last night</i>" and she looks at you unsure why you stressed <i>last night</i>. She looks like she is about to ask you something, and you recite the words of the charm spell.</p>' + "<p>Anita looks startled, and swings the shotgun so it is ready, but she is not directly pointing it at you. She asks in an urgent manner,</p>" + '<p>"Did you hear that, I am sure I heard the word of command, but you are not my commander"</p>' +
				"<p>It would seem Anita here is a member of the military, but something there seems wrong, and you suspect she is more member of some sort of para-military group or militia, especially how she talked before. Still it does not matter at all what sort of unit or group she is with, your answer is the same,</p>" + '<p>"Yes I am a soldier! How dare you forget!"</p>' + "<p>She hesitates, but the power of the spell works itself through her mind, she stutters,</p>" + '<p>"' + myName + "...sorry..." + myName + '"</p>' +
				"<p>You look at her partially clothed body and smile, and order her,</p>" + '<p>"Don\'t forget again, for your punishment, remove your clothing, now!"</p>' + "<p>Anita hesitates, but the quickly removes her jacket and stands there before you, completely naked, holding her shotgun.</p>" + '<p>"Yes ' + myName + '"</p>' + "<p>You need to exert more control over her, especially as she is still armed.</p>");
			bNoShow = true;
			startQuestions();
			addLinkToPlaceC(md, '"Put the weapon down!"', 252, "type=anita6")
		} else if (stype ===
			"anita6") {
			perAnita.showPerson(stype + ".jpg");
			addPlaceTitle(md, "Anita Under <i>Your</i> Charm Spell");
			md.write("<p>You order Anita to put the shotgun down and she hesitates, you order her again, and she engages the safety, then carefully puts the shotgun down.</p>" + "<p>You think 'Good she is disarmed', except you see her get something from a bag and when she stands up facing away from you, she is holding a pistol. While you appreciate the view of her from behind (and her behind) you again order her to disarm. She replies immediately,</p>" +
				'<p>"You cannot do that! No commander of mine would order me to be defenceless!"</p>' + "<p>You realise that this is an important point for her and decide not to press the matter, and tell her,</p>" + '<p>"Yes of course, I was just checking your dedication. You must obey my orders in every other way, no matter what I order you to do!"</p>' + "<p>Again without hesitation, she replies,</p>" + '<p>"I will do absolutely <i>anything</i> you order, <i>anything</i>, just order me"</p>');
			bNoShow = true;
			startQuestions();
			addLinkToPlaceC(md, 'Order her "Prove it!"', 252, "type=anita7")
		} else if (stype === "anita7" || stype == "proveit") {
			if (stype === "proveit") perAnita.setFlag(7);
			if (!isExplicit()) perAnita.showPerson("anita7.jpg", "50vw");
			else if (perYou.isMaleSex()) perAnita.showPersonRandomX("anita7b", 3);
			else perAnita.showPersonX("anita7g.jpg", "50vw");
			addPlaceTitle(md, "Anita's Proof");
			md.write("<p>For a moment you reconsider your order, given Anita's shown violence, but she drops to her knees ");
			if (perYou.isMaleSex()) md.write("and undoes your trousers and takes your stiff cock into her mouth. She proceeds to give you a skilled blowjob until you explode in her mouth. She swallows and then asks,</p>" +
				'<p>"Would ' + myName + ' now like my ass or pussy?"</p>' + '<p>You of course reply "Both!"</p>' + "<p>You sate yourself on your new subordinates body, and she also experiences considerable pleasure, both from the effects of the spell and also as she seems to very, very much like sex!</p>");
			else md.write("and undoes your pants and with a little hesitation licks your pussy. She is probably not experienced with a woman but still she makes you come quickly to a shuddering climax. She then asks,</p>" + '<p>"Would ' +
				myName + ' now like my ass or pussy or shall I prove myself again?"</p>' + '<p>You of course reply "All of them!"</p>' + "<p>You sate yourself on your new subordinates body, and she also experiences considerable pleasure, despite, or maybe because of her lack of experience with women.</p>");
			bNoShow = stype === "anita7";
			startQuestions();
			if (isMurderPath() && perGates.other == 600 && !perAnita.checkFlag(4)) addLinkToPlaceC(md, "ask her about the killing of " + perGates.getPersonNameShort(), 252, "", "You ask her about what happened at the mansion</p><p>&quot;" +
				myName + "! Sorry " + myName + ", I do not remember that well, my memory is not clear. I am sure my last commander ordered the execution of an enemy, but it was ordered by his superior. I did as ordered, as I always will, " + myName + "&quot;</p><p>It is a little chilling her casual reply about the murder, as if it is something normal for her...</p>", "Anita", "setPersonFlag('Anita',4)");
			else addLinkToPlace(md, "talk more to Anita", 252)
		}
		addLinkToPlace(md, "return to Ms Jones' office", 145)
	}
	WritePlaceFooter(md, "",
		bNoShow)
}

function ShowPlace253() {
	var md = WritePlaceHeader(false, "td-left-med");
	var perLogan = findPerson("MissLogan");
	var bPool = perLogan.whereNow() == 269;
	setPlaceKnown("AnatomyClassroom");
	if (bPool) {
		perLogan.showPerson("logan12.jpg");
		addPlaceTitle(md, "Miss Logan Charmed");
		md.write("<p>Miss Logan shakes her head and looks over at you. Somewhat confused, she steps over and asks you,</p>" + '<p>"You are doing a project on the brain, right? Are you sure you would not prefer to do a study of anatomy?"</p>' + "<p>She suggestively squeezes her breasts together as she leans in toward you,</p>" + '<p>"I think that you need some help in reproduction," she claims. "Have you thought of a practical project?"</p>' +
			"<p>You're unsure exactly what she means but you get a pretty good idea...</p>")
	} else {
		perLogan.showPerson("logan4.jpg");
		addPlaceTitle(md, "Miss Logan Charmed");
		md.write("<p>Miss Logan shakes her head. Somewhat confused, she tries to remember what she was talking about. " + "As her mind shifts she climbs onto her desk like a panther.</p>" + '<p>"I think that you need some help in reproduction," she claims. "Have you thought of a practical project?"</p>' + "<p>You're unsure exactly what she means...</p>")
	}
	startQuestions();
	addLinkToPlaceC(md, "ask your teacher what she means", 254);
	if (perYou.checkFlag(26)) addLinkToPlaceC(md, '"practical about reproduction?"', 254, "type=breeder");
	WritePlaceFooter(md)
}

function ShowPlace254(stype) {
	var md = WritePlaceHeader();
	var perLogan = findPerson("MissLogan");
	var bBreed = stype == "breeder";
	if (bBreed) perLogan.charmThem(2);
	var bPool = perLogan.whereNow() == 269;
	if (bPool) {
		perLogan.showPerson("logan13.jpg");
		addPlaceTitle(md, "Miss Logan Charmed");
		md.write("<p>As you look at your teacher you remember a time a while ago Amy had whispered to you during a lesson that she thought Miss Logan was a lesbian. Catherine had dramatically told her <b>not</b> to spread rumours about the lesbian affair between two teachers, and proceeded to tell her lurid details.</p>" + "<p>Then again one time when you went to the Gym to meet Amy you saw Miss Logan flirting with some guy...</p>" +
			"<p>Your attention is drawn back to the present as Miss Logan slips off her bikini top, exposing her large breasts, larger than you had thought from school! You notice a couple of other people looking appreciatively at her. You are going to have to find somewhere more private.</p>");
		if (bBreed)
			if (perYou.isMaleSex()) md.write('<p>"Oh ' + perYou.getPersonName() + '," says Miss Logan, losing control of her social constraints. "Let me show you how reproduction occurs. Firstly the female is hot... prepares herself for her mate by... enticing him to her so that he may..."</p>' +
				'<p>You remember her offer of a practical and ask "You mean impregnate her, breed her?". Miss Logan looks at you and down at your growing erection. A wave of desire crushes the last of your teacher\'s will.</p>' + '<p>"Just take me ' + perYou.getPersonName() + '! Fuck me and cum in me, I am not taking contraceptives!"</p>');
			else md.write('<p>"Oh ' + perYou.getPersonName() + '," says Miss Logan, losing control of her social constraints. "Let me show you how reproduction occurs. Firstly the female is hot... prepares herself for her mate by... enticing him to her so that he may..."</p>' +
				'<p>You remember her offer of a practical and ask "You mean impregnate her, breed her?". Miss Logan looks at you and a wave of desire crushes the last of your teacher\'s will.</p>' + '<p>"Let me show you how to make a man really hot, so he can breed us! All men love to see two women together!"</p>');
		else if (perYou.isMaleSex()) md.write('<p>"Oh ' + perYou.getPersonName() + '," says Miss Logan, losing control of her social constraints. "Let me show you how reproduction occurs. Firstly the female is hot... prepares herself for her mate by... enticing him to her so that he may. Oh god!"</p>' +
			"<p>A wave of desire crushes the last of your teacher's will. \"Just take me " + perYou.getPersonName() + '! Take me now!"</p>');
		else md.write('<p>"Oh ' + perYou.getPersonName() + '," says Miss Logan, losing control of her social constraints. "Let me show you how reproduction occurs. Firstly the female is hot... prepares herself for her mate by... enticing him to her so that he may. Oh god!"</p>' + "<p>A wave of desire crushes the last of your teacher's will. \"Let me show you how to make a man really hot, " +
			perYou.getPersonName() + '! All men love to see two women together!"</p>')
	} else {
		perLogan.showPerson("logan5.jpg");
		addPlaceTitle(md, "Miss Logan Charmed");
		md.write("<p>As you look at your teacher you remember a time a while ago Amy had whispered to you during a lesson that she thought Miss Logan was a lesbian. Catherine had dramatically told her <b>not</b> to spread rumours about the lesbian affair between two teachers, and proceeded to tell her lurid details.</p>" + "<p>Then again one time when you went to the Gym to meet Amy you saw Miss Logan flirting with some guy...</p>" +
			"<p>Your attention is drawn back to the present as Miss Logan starts to unbutton her top,</p>");
		if (bBreed)
			if (perYou.isMaleSex()) md.write('<p>"Oh ' + perYou.getPersonName() + '," says Miss Logan, losing control of her social constraints. "Let me show you how reproduction occurs. Firstly the female is hot... prepares herself for her mate by... enticing him to her so that he may..."</p>' + '<p>You remember her offer of a practical and ask "You mean impregnate her, breed her?". Miss Logan looks at you and down at your growing erection. A wave of desire crushes the last of your teacher\'s will.</p>' +
				'<p>"Just take me ' + perYou.getPersonName() + '! Fuck me and cum in me, I am not taking contraceptives!"</p>');
			else md.write('<p>"Oh ' + perYou.getPersonName() + '," says Miss Logan, losing control of her social constraints. "Let me show you how reproduction occurs. Firstly the female is hot... prepares herself for her mate by... enticing him to her so that he may..."</p>' + '<p>You remember her offer of a practical and ask "You mean impregnate her, breed her?". Miss Logan looks at you and a wave of desire crushes the last of your teacher\'s will.</p>' +
				'<p>"Let me show you how to make a man really hot, so he can breed us! All men love to see two women together!"</p>');
		else if (perYou.isMaleSex()) md.write('<p>"Oh ' + perYou.getPersonName() + '," says Miss Logan, losing control of her social constraints. "Let me show you how reproduction occurs. Firstly the female is hot... prepares herself for her mate by... enticing him to her so that he may. Oh god!"</p>' + "<p>A wave of desire crushes the last of your teacher's will. \"Just take me " + perYou.getPersonName() +
			'! Take me now!"</p>');
		else md.write('<p>"Oh ' + perYou.getPersonName() + '," says Miss Logan, losing control of her social constraints. "Let me show you how reproduction occurs. Firstly the female is hot... prepares herself for her mate by... enticing him to her so that he may. Oh god!"</p>' + "<p>A wave of desire crushes the last of your teacher's will. \"Let me show you how to make a man really hot, " + perYou.getPersonName() + '! All men love to see two women together!"</p>')
	}
	startQuestions();
	addLinkToPlace(md,
		bBreed ? perYou.isMaleSex() ? "breed Miss Logan" : "discuss reproduction" : "take Miss Logan", 255);
	WritePlaceFooter(md)
}

function ShowPlace255() {
	var md = WritePlaceHeader();
	var perLogan = findPerson("MissLogan");
	var bBreed = perLogan.getCharmedLevel() == 2;
	var bPool = perLogan.whereNow() == 269;
	passTime(true);
	if (bPool) {
		if (isExplicit())
			if (perYou.isMaleSex() && bBreed) perLogan.showPersonRandomX("logan15", 2);
			else if (perYou.isMaleSex()) perLogan.showPersonX("logan14.jpg");
		else perLogan.showPersonRandomX("logan6g", 2);
		else if (perYou.isMaleSex() && bBreed) perLogan.showPersonRandomX("logan15", 2);
		else if (perYou.isMaleSex()) perLogan.showPerson("logan14.jpg");
		else perLogan.showPerson("logan6g.jpg");
		addPlaceTitle(md, "Miss Logan Charmed");
		if (bBreed || !perYou.isMaleSex()) md.write("<p>Miss Logan is losing all control, but this is a public place. You tell Miss Logan you need to continue this in a more private place. She refits her bikini top and grabs your hand and drags you to the hotel front desk. She quick rents a room, and you see a knowing look on the person at the desk, while this is no 'love hotel' or one that rents by the hour, still they must get quite a number of people having private...lessons.</p>" +
			"<p>A little later you are in the room, Miss Logan tearing off her clothing....</p>");
		else md.write("<p>Miss Logan is losing all control, but this is a public place. You glance around and see a more secluded area, out of the sight of the other people using the pool.</p>");
		if (bBreed) {
			if (perYou.isMaleSex()) {
				perLogan.setFlag(1);
				md.write("<p>You enjoy the pleasures of Miss Logan for the next twenty minutes, as she instructs you in the best positions and ways to maximise the chance of pregnancy.</p>" +
					"<p>After she seems confident you have successfully bred her, but that is more the influence of the spell on her mind. Still there is nothing stopping you trying again and again if she is not. As far as you know the charm spell does not affect the fertility of women you cast it on...</p>")
			} else md.write("<p>You enjoy the pleasures of Miss Logan for the next twenty minutes, and she instruct you in the best positions to increase the chance of pregnancy. She emphasises that if you orgasm it may increase the chance of conception. You had thought you had heard conflicting information on this, but Miss Logan is adamant, and besides she is very good at making you orgasm!</p>" +
				"<p>After she is a little disappointed that you could not breed her, and asks if you can arrange it with a friend of yours? It is impressive how the spell has shaped her mind, created this considerable desire, at leasts as far as you know the charm spell does not affect the fertility of women you cast it on...</p>");
			md.write("<p>As you dress you have to think that in all of the years of attending school you never dreamed that an anatomy lesson could be so much fun.</p>")
		} else md.write("<p>You enjoy the pleasures of Miss Logan for the next twenty minutes.</p>" +
			"<p>In all of the years of attending school you never dreamed that an anatomy lesson could be so much fun.</p>");
		md.write("<p>Miss Logan tells you in her 'teacher' voice, \"Make sure to visit me in the Anatomy Class tomorrow for a lesson...about my anatomy\"</p>");
		startQuestions();
		addLinkToPlace(md, "return to the pool", 269)
	} else {
		if (isExplicit())
			if (perYou.isMaleSex()) perLogan.showPersonRandomX("logan6b", 2);
			else perLogan.showPersonRandomX("logan6g", 2);
		else if (perYou.isMaleSex()) perLogan.showPersonRorX("logan6b.jpg");
		else perLogan.showPerson("logan6g.jpg");
		addPlaceTitle(md, "Miss Logan Charmed");
		if (bBreed) {
			if (perYou.isMaleSex()) {
				perLogan.setFlag(1);
				md.write("<p>You enjoy the pleasures of Miss Logan for the next twenty minutes, as she instructs you in the best positions and ways to maximise the chance of pregnancy.</p>" + "<p>After she seems confident you have successfully bred her, but that is more the influence of the spell on her mind. Still there is nothing stopping you trying again and again if she is not. As far as you know the charm spell does not affect the fertility of women you cast it on...</p>")
			} else md.write("<p>You enjoy the pleasures of Miss Logan for the next twenty minutes, and she instruct you in the best positions to increase the chance of pregnancy. She emphasises that if you orgasm it may increase the chance of conception. You had thought you had heard conflicting information on this, but Miss Logan is adamant, and besides she is very good at making you orgasm!</p>" +
				"<p>After she is a little disappointed that you could not breed her, and asks if you can arrange it with a friend of yours? It is impressive how the spell has shaped her mind, created this considerable desire, at leasts as far as you know the charm spell does not affect the fertility of women you cast it on...</p>");
			md.write("<p>As you dress you have to think that in all of the years of attending school you never dreamed that an anatomy lesson could be so much fun.</p>")
		} else md.write("<p>You enjoy the pleasures of Miss Logan for the next twenty minutes.</p>" +
			"<p>In all of the years of attending school you never dreamed that an anatomy lesson could be so much fun.</p>");
		startQuestions();
		addLinkToPlace(md, "exit the room", 70)
	}
	if (bBreed && perYou.isMaleSex()) {
		AddRightColumn(md);
		AddImageRandom("GenericSex/creampie", 2)
	}
	WritePlaceFooter(md, "", true, true)
}

function ShowPlace258(stype) {
	var md = WritePlaceHeader(false, stype == "lauren3" ? "td-left-large" : "");
	var perLauren = findPerson("Lauren");
	var perDonna = findPerson("Donna");
	if (stype == "lauren1") {
		perLauren.place = 0;
		movePerson("Sarah", 1);
		movePerson("AdeleRoss", 16);
		setPersonFlag("AdeleRoss", 1);
		setPersonFlag("Mom", 8);
		perYou.startQuest(6);
		perLauren.showPerson("lauren11b.jpg");
		addPlaceTitle(md, "Hotel Pool with Lauren");
		if (!isDay()) md.write("<p>The pool area is brightly lit by lighting scattered around, and ");
		else if (perDonna.place !=
			269) md.write("<p>The pool area ");
		else md.write("<p>");
		if (isDay() && perDonna.place == 269) md.write("Lauren gestures to follow her to a more discrete place away from anyone else. You find an isolated area partly shielded by some plants and Lauren kneels down in front of you.");
		else md.write("is fairly empty now but you both move to a more discrete place. You find an isolated area partly shielded by some plants and Lauren kneels down in front of you.");
		md.write("<p> She is wearing a very revealing bikini, little more than fishnets, almost completely exposing her breasts and privates. Lauren sees you looking at her swimsuit and deeply blushes, but you also observe her nipples stiffen a little. She hesitantly speaks,</p>" +
			'<p>"My Mistr...My Lady told me to wear this, as an appropriate attire for her servant and as a gift to you. Please can we not dwell on it....", she hesitates before taking a deep breath and continuing,</p>' + '<p>"My Lady has asked me to warn you that it is very dangerous trying to summon the dead. Her family has extensive history dealing with the Veil and the creatures who try to cross into this world...very extensive...very..She says that without powerful wards it would be impossible to safely deal with the more powerful spirits like the ghost of a witch or warlock."</p>' +
			"<p>She pauses, and you think she is troubled by what she just talked about, maybe she has had personal experience with the dead in some way. She looks at you and moves her arms to modestly cover her breasts but the gesture just accentuates her breasts, drawing your attention to them.</p>" + '<p>"My Lady believes it is time for you to meet her, but it is a delicate thing to do this, you will not be able to openly visit in the daytime and <i>all</i> doors of the <b>mansion</b> are closed at night. My Lady tells me that umm...Serphoni...will be needed, but it will only work during the midnight hour, when the shroud protecting the mansion is thinnest. You must also use the side entrance from the Sacred Clearing');
		if (!isPlaceKnown("SacredClearing")) {
			md.write('"</p><p>You interrupt and ask where the Sacred Clearing is, you have heard of it but do not know exactly where it is. Lauren explains,</p>' + '<p>"It is an ancient ritual area to the west of the mansion" and she gives some brief directions before continuing, "I am surprised, My Lady seemed to assume you knew of that place but I digress... ');
			setPlaceKnown("SacredClearing")
		}
		md.write('My Lady asks that you visit so you may trade things you have learned and so she can offer a ward against the dead."</p>' +
			"<p>You heard her say <b>mansion</b> and you ask if she means the Gate's Mansion, does her Lady live there? You were not aware anyone else lived there other than " + perGates.getPersonName() + ". Maybe your mother has heard something?</p>" + '<p>She just nods her head, "Yes, and My Lady asks one thing of you, a gift in return for what she has given you...and..and..me. You must bring her a bottle of the finest wine. Please bring it with you when you visit....", she trails off, ' + "and does not say anything as she looks at you. She is hesitating, unable or unwilling to say anything more.");
		startQuestions();
		addLinkToPlaceC(md, '"Is there anything more?"', 258, "type=lauren2")
	} else if (stype == "lauren2") {
		perLauren.showPerson("lauren11c.jpg");
		addPlaceTitle(md, "Hotel Pool with Lauren");
		md.write("<p>She blushes and adjusts her bikini top or at least the collection of strings that she is wearing and exposes her breasts completely. She stretches and says nervously,</p>" + '<p>"My..my..Lady has ordered...asked...me to tell you that I am to offer you any service you desire now I have delivered my message, <i>any desire</i>.."</p>' +
			"<p>She is clearly aroused but also very nervous, expecting and possibly wanting you to take her up on her offer of <i>any desire</i>, but also reluctant and uncertain.</p>");
		startQuestions("Will you accept her offer?");
		addLinkToPlace(md, "certainly!", 258, "type=lauren3");
		addLinkToPlace(md, "refuse and go to the Hotel Bar", 124, "", "An odd mixture of expressions pass over Lauren&rsquo;s face as you refuse and start to leave, relief and disappointment. She softly says &quot;Thanks...I think&quot;")
	} else if (stype ==
		"lauren3") {
		perLauren.setFlag(11);
		perYou.addCorruption(1);
		perLauren.showPerson(perYou.isMaleSex() ? "lauren11db.jpg" : "lauren11dg.jpg");
		addPlaceTitle(md, "Lauren's Service");
		md.write("<p>It would seem rude to refuse your ally and Lauren seems aroused and wants this too, she is just nervous. You tell her that you desire her, that this has nothing to do with her Lady, it is just your desire for her. You do not think she really believes you, but accepts your words.</p>" + "<p>She removes more of her 'swimsuit' and makes a little bit of a show for you. She is clearly nervous still and is a little awkward as she displays herself.</p>" +
			"<p>You take her, she is passionate if awkward and uncertain at times. She is no virgin but a little inexperienced and despite her nerves orgasms quite strongly.</p>" + "<p>After, as she redresses in more normal clothes, you remember that at times her skin felt odd, and you swear you saw a faint glow when she orgasmed. As you are looking at her she blushes again, curtseys,</p>" + '<p>"' + perYou.getLord() + ' I must return to My Lady now", and she leaves the pool area.</p>');
		startQuestions();
		addLinkToPlace(md,
			"go to the Hotel Bar", 124)
	}
	WritePlaceFooter(md)
}

function ShowPlace260() {
	var md = WritePlaceHeader();
	var perS = findPerson("OfficerSmith");
	var clv = perS.getCharmedLevel();
	var perDA = findPerson("Diane");
	var perMG = findPerson("MrsGranger");
	var perAbby = findPerson("Abby");
	if (!isPlaceKnown("JailCell")) setPlaceKnown("JailCell");
	if (perDA.getQuestArrested() === 0 && perYou.isArrested()) perDA.setQuestArrested(1);
	addPlaceTitle(md, "Jail Cell", "jail2.jpg");
	if (perYou.isArrested()) {
		if (isMurderPath()) md.write("<p>You are arrested, and accused of murder.");
		else md.write("<p>You are arrested, and awaiting trial for theft.");
		if (clv > 0) md.write(" Becky has left the cell door open... allowing you to leave anytime you want.</p>");
		else md.write(" Desperately you try to escape without success.</p>")
	}
	if (perDA.other == 50) md.write("<p>" + getProsecutor() + ' White stares out at you from another cell. "Let me out of here you <i>monster</i>," she rails.  "I don\'t know how you...  you...  just let me out of here!"</p>');
	if (perMG.place == 261) md.write("<p>You see Mrs Granger watching you in a nearby cell.</p>");
	if (!perYou.isArrested()) md.write("<p>The jail cell door stands open... allowing you to leave anytime you want.</p>");
	startQuestions();
	if (perS.place == 261 && perS.other != 100)
		if (clv > 0) addLinkToPlace(md, "call for Becky", 261);
		else addLinkToPlace(md, "yell for attention", 261);
	if (perMG.place == 261)
		if (perMG.other == 54 || perAbby.getQuestDragonGem() == 5) addQuestionC(md, "ask Mrs. Granger about the dragon vase", "MrsGranger", 2354);
	if (perYou.isArrested()) {
		if (perDA.getQuestArrested() > 0 && perDA.getQuestArrested() < 50) addLinkToPlace(md, "wait for your trial?", 285);
		else addLinkToPlace(md, "give up the game?", 999);
		if (clv > 0 && perS.place == 261) addLinkToPlace(md,
			"walk out through the open door your slave Becky left for you", 168)
	} else addLinkToPlace(md, "exit the jail?", 168);
	if (perDA.other == 50 || perMG.place == 261) {
		AddRightColumnLarge(md);
		if (perDA.other == 50) perDA.showPerson("diane8.jpg");
		if (perMG.place == 261) perMG.showPerson("!granger-jail1.jpg")
	}
	WritePlaceFooter(md)
}

function ShowPlace261() {
	var md = WritePlaceHeader();
	var perS = findPerson("OfficerSmith");
	var clvS = perS.getCharmedLevel();
	var perDA = findPerson("Diane");
	var clvDA = perDA.getCharmedLevel();
	var perMG = findPerson("MrsGranger");
	var perAbby = findPerson("Abby");
	var perBatton = findPerson("OfficerBatton");
	var clvBatton = perBatton.getCharmedLevel();
	if (!isPlaceKnown("JailCell")) setPlaceKnown("JailCell");
	if (clvS > 0) perS.showPerson("polg5.jpg");
	else perS.showPerson("polg1.jpg");
	if (!perS.checkFlag(1)) {
		perS.setFlag(1);
		showPopupWindow(getOfficer() +
			" Smith", "<img src='Images/polg0.jpg' class='imgpopup' alt='Smith'>" + getOfficer() + " Becky Smith is the youngest " + getOfficer(false) + " in the police department. She's a cadet and just recently finished her studies at the police academy.<br><br>" + "You know her from school, she was a senior year student when you just started your first year. You barely spoke to each other and you don\u2019t think she would recognize you now, but you used to hang out once or twice when there was a big event in the school. " +
			"She was quite sure that she wanted to be an " + getOfficer(false) + " of the law back then already. She was really ambitious and was passionately interested in making the world a better, safer place. Maybe that comes from her father who\u2019s a navy veteran.<br><br>" + "It looks like she's the jail guard here. They usually give the most boring jobs to the young cadets just so they can learn the ropes. She looks strict and serious patrolling between the jail cells every ten minutes.")
	}
	addPlaceTitle(md,
		"Jail Cell");
	if (clvS === 0) {
		md.write('<p">A cop stops by to check on you. ');
		if (perYou.isArrested()) md.write('"What\'s all of the commotion?" she asks. "If you don\'t shut up then I\'ll shut you up."</p>');
		else md.write(getOfficer() + ' Becky Smith steps out from one of the back rooms. "Is there something I can help you with?" she asks politely, as if you were touring the police station.</p>')
	} else {
		if (clvS > 0 && perS.checkFlag(2) && !perS.checkFlag(3)) showPopupWindow(perS.getPersonName(), "<img src='Images/polg8.jpg' class='imgpopup' alt='Becky'>" +
			'"Your father wanted you to become a soldier,right?", you always wanted to ask that to her, but you were afraid you would hurt her feelings. Not anymore.<br><br>' + '"That\u2019s right, Sir! My father trained me at home for years, he wanted me to join the navy SEALS just like he did to keep up the family traditions!", she answers monotonically. You come close to her and after you give a sheepish grin you start to rub your fingers against her pussy through her dress.<br><br>' + '"What happened then?", you ask curiously, rubbing your fingers harder.<br><br>' +
			'"I am a girl, Sir! He told me I am not good enough because I\u2019m a girl and I can\u2019t do all those hard and exhausting exercises right! After years and years of training he gave up and lost interest in me, Sir.", she tells you, her face still serious and doesn\u2019t show any sign of feelings.<br><br>' + '"Does that make you unhappy? That\u2019s why you chose to be an ' + getOfficer(false) + ' instead?", you ask again. You try your best to get her to climax, but it looks like she doesn\u2019t feel anything!<br><br>' +
			'"Yes, Sir! I wanted to impress him, to show him I\u2019m a good fighter too! But he did not want accept that and we became distant over the years, Sir!", she answers again like a machine. You stop what you\u2019re doing and stand in front of her.<br><br>' + '"You don\u2019t look sad or lost now, why? And what\u2019s up with your sexual attitude? Aren\u2019t you horny?", you ask her, she\u2019s still wearing her statue-like face, but you know you have her full attention.<br><br>' + '"That\u2019s because I am your slave, Sir! When you charmed me you gave me a new purpose in my life. To serve you, Sir!", Becky stops for a second.<br><br>' +
			'"If you want me to feel horny or sexual, you have to tell me, Sir! Order me, command me how and what to feel, Sir!", she continues.<br><br>' + "It seems when you charmed her, something in her personality has changed. You feel you have achieved what her father always wanted. She\u2019s the perfect soldier and " + getOfficer(false) + " and she\u2019s all yours!", "setPersonFlag('OfficerSmith',3)");
		md.write("<p>Your slave " + getOfficer() + " Becky Smith stops by to check on you. " + "It wasn\u2019t hard to persuade her even though she looks quite buffed and very athletic like so you thought she has a strong will too. Instead, she broke and gave in to your powers after a few seconds.</p>" +
			"<p>Now, she is making her ten minute round, but when she sees you she stops and makes a soldier-like salute to you and stands in attention, her hands behind her beck. You feel like her attitude is more of a soldier\u2019s than a police " + getOfficer(false) + "\u2019s.</p>" + "<p>Anyway, she has the keys to all cells so escaping from here is no longer a problem to you. You can leave anytime.</p>")
	}
	if (perDA.other == 50) md.write("<p>" + getProsecutor() + ' White stares out at you from another cell. "Let me out of here you <i>monster</i>," she rails.  "I don\'t know how you...  you...  just let me out of here!"</p>');
	else if (perDA.place == 261 && !perDA.isCharmedBy()) md.write("<p>" + getProsecutor() + " White is waiting for you to tell her your information</p>");
	if (perMG.place == 261) md.write("<p>You see Mrs Granger watching you in a nearby cell.</p>");
	startQuestions();
	if (clvS > 0 && perMG.other >= 50 && (perMG.checkFlag(1) || perMG.checkFlag(4)) && !isPlaceKnown("MechanicsShop")) {
		if (perS.other === 0) addQuestionC(md, "ask Becky about the Museum", "OfficerSmith", 9301);
		if (perS.other == 2) addQuestionC(md, "ask if the vase was found", "OfficerSmith",
			9302)
	}
	if (clvS > 0) {
		if (perYou.isArrested() && clvDA === 0)
			if (isMurderPath()) addQuestionC(md, "order Becky to take out " + getProsecutor() + " White", "OfficerSmith", 93100);
			else if (clvDA === 0 && clvBatton === 0 && perBatton.place == 168 && perDA.place != 261) addQuestionC(md, "order Becky to get " + getProsecutor() + " White in here", "OfficerSmith", 1E3);
		addLinkToPlace(md, "order Becky to strip again", 261, "type=beckystrip")
	}
	if (perDA.place == 261 && !perDA.isCharmedBy()) addQuestionC(md, "refuse to tell " + getProsecutor() + " White anything",
		"OfficerSmith", 1001);
	else {
		if (clvS > 0) addLinkToPlaceC(md, '"That is all for now Becky"', 260);
		else addLinkToPlaceC(md, '"Nothing more ' + getOfficer() + '"', 260);
		if (perMG.place == 261 && (perMG.other == 54 || perAbby.getQuestDragonGem() == 5)) addQuestionC(md, "ask Mrs. Granger about the dragon vase", "MrsGranger", 2354);
		if (!perYou.isArrested() || clvS > 0) addLinkToPlace(md, "exit the jail cell", 168)
	}
	if (perDA.other == 50 || perMG.place == 261 || perDA.place == 261 && !perDA.isCharmedBy()) {
		AddRightColumnLarge(md);
		if (perDA.other == 50 || perDA.place ==
			261) perDA.showPerson("diane8.jpg");
		if (perMG.place == 261) perMG.showPerson("!granger-jail1.jpg")
	}
	WritePlaceFooter(md)
}

function ShowPlace267(stype) {
	var md = WritePlaceHeader();
	var perKate = findPerson("Kate");
	var bKateCharmed = perKate.isCharmedBy("Davy");
	perDavy.place = 184;
	perKate.place = 9999;
	perKate.unCharmThem();
	perKate.other = 100;
	setPlaceFlag("Hotel", 8);
	if (isMurderPath()) {
		var perKhan = findPerson("OfficerKhan");
		if (perKhan.charmed == 2) {
			var perS = findPerson("Sarah");
			if (perS.place === 0) {
				perS.moveThem(1);
				movePerson("AdeleRoss", 16);
				setPersonFlag("AdeleRoss", 1)
			}
		}
		var perAnita = findPerson("Anita");
		if (perAnita.other != 101 && perAnita.other <
			900) {
			perAnita.other = 100;
			perAnita.place = 252;
			movePerson("MsJones", 145);
			setPlaceKnown("FrenchClassroom")
		}
	}
	if (stype === "" && bKateCharmed && !isKateTrusting() || stype == "defeated1") {
		setQueryParams("type=defeated1");
		perKate.showPerson("kate14a.jpg");
		addPlaceTitle(md, "Davy Defeated!!");
		md.write("<p>Davy's power is drained, leaving him defenseless against your magic and weaponry. " + "It would seem like he is completely at your mercy, and something about the look on his face tells " + "you that he knows it. You doubt a charm spell will work on him, the residual effects from Kurndorf would probably confuse or event shield him, maybe tomorrow?</p>" +
			"<p>He seems about ready to plead his case when you are surprised by a flash of movement from behind him.</p>" + '<p>"Serves you right you <b>ASSHOLE</b>," She says still holding the <i>very heavy</i> book from the ' + "bookcase.  Dropping the book, she starts to put on a form-fitting blue dress. There is no trace of the spell left on her face.</p>" + '<p>"Now," She says, glaring at you as if this were all your fault.  "I know he was controlling me with some sort of spell." ' + 'You are about to say something when she cuts you off before you can get a word out.  "AND..." She says, the look ' +
			'in her eyes enough of a warning to keep your trap shut.  "And I know that you can do the same thing...."</p>' + "<p><i>Yep, definitely not under his control anymore.</i> You think to yourself.</p>" + '<p>"So, here\'s what I suggest." She says, cocking her hip as she smiles at you.  "I am going to leave town, ' + "I don't care anymore.  This is just too <i>fucked up</i>.  My mom will be fine.  And you...  You will keep " + 'those lips shut or I <i>swear to god</i> I will knock you into next tuesday."</p>' +
			'<p>"Understand?" She asks...</p>');
		startQuestions();
		startAlternatives(md);
		addLinkToPlaceC(md, 'nod your head "yes..." and then go back to the bar', 124);
		if (isCharmedBy("Bambi")) addLinkToPlaceC(md, 'nod your head "yes...but first I need to deal with Davy"', 184, "type=restrain");
		else addLinkToPlaceC(md, 'nod your head "yes...but first I need to deal with Davy"', 124, "", "You would like to do something with Davy so when he wakes he cannot flee but you do not know what to do");
		addLinkToPlaceC(md, 'nod your head "yes..." but all you can think is "That ungrateful bitch"',
			267, "type=bitch");
		endAlternatives(md);
		WritePlaceFooter(md);
		return
	} else if (stype === "" && bKateCharmed && isKateTrusting() || stype == "defeated2") {
		perKate.place = 1E3;
		setQueryParams("type=defeated2");
		perKate.showPerson("kate14d.jpg");
		addPlaceTitle(md, "Davy Defeated!!");
		md.write("<p>Davy's power is drained, leaving him defenseless against your magic and weaponry. " + "It would seem like he is completely at your mercy, and something about the look on his face tells " + "you that he knows it. You doubt a charm spell will work on him, the residual effects from Kurndorf would probably confuse or even shield him, maybe tomorrow?</p>" +
			"<p>He seems about ready to plead his case when you are surprised by a flash of movement from behind him.</p>" + '<p>"Serves you right you <b>ASSHOLE</b>," She says still holding the <i>very heavy</i> book from the ' + "bookcase.  Dropping the book, she starts to put on a form-fitting blue dress. There is no trace of the spell left on her face.</p>")
	} else if (stype == "bitch") {
		perKate.showPerson("kate14c.jpg");
		perKate.place = 1E3;
		perKate.setFlag(18);
		startTimedEvent("KatesHome()", 20);
		addPlaceTitle(md, "Ungrateful Kate");
		md.write("<p>Kate quickly redresses and reapplies some make-up, keeping a careful eye on you. With a last uncertain, but determined look she leaves the room.</p>" + '<p>After all you have done, she still treats you as an enemy, a person she will not trust! How ungrateful she is for all you have done for her, sure it was at least party motivated by a desire to "know" her better, in a physical way, but still!!</p>' + "<p>The only way you can then change her ideas about you is using your magic, but it would seem a direct approach with the spell is unlikely to work, you would have to cast it unseen somehow. You will have to consider how, but however you do it you had better hurry, she is on her way home to pack a few things and the leave town.</p>");
		startQuestions();
		if (isCharmedBy("Bambi")) startAlternatives(md);
		addLinkToPlace(md, "let's get going!", 124);
		if (isCharmedBy("Bambi")) {
			addLinkToPlace(md, 'but first I need to deal with Davy"', 184, "type=restrain");
			endAlternatives(md)
		}
		WritePlaceFooter(md);
		return
	} else if (stype == "kick") {
		var safter = getQueryParam("after");
		perDavy.setFlag(5);
		startTimedEvent("DavyEscapes()", 40);
		perKate.showPerson("kate15a.jpg");
		addPlaceTitle(md, "Kate's Revenge");
		if (safter == "you") md.write("<p>You glance at Kate and she is looking impatient. You step towards Davy without any clear idea what to do, and he looks warily and quickly draws out a small silver dagger and waves it at you, clearly intent on stabbing you!</p>");
		else if (safter == "bambi") md.write('<p>In response to a glance from you Bambi "disengages" from Davy and moves back. Davy says, "What the hell...I\'m not finished you bitch!"</p>');
		else md.write("<p>Kate runs into the room, and you follow as quickly as you can. You see Davy using his phone, trying to call someone.</p>");
		md.write("<p>Kate rushes at Davy with speed born of her rage at Davy, and with a swift high-kick to the face, she slams him to the ground. Davy is dazed and tries to say something, undoubtedly to call out a spell. Before he can say something coherent Kate kicks him with all her might in his groin, winding him with the considerable pain. Kate continues kicking him until you call her to stop!</p>" +
			"<p>You are rather shocked at the severity of Kate's attack, she was so very, very angry!</p>");
		if (perKate.checkFlag(15)) md.write("<p>It would seem the necklace was not really necessary...<p>")
	} else if (perKate.place == 184 && !bKateCharmed && perKate.checkFlag(15) || stype == "kickedown") {
		setQueryParams("type=kickedown");
		if (isExplicit()) perKate.showPersonRandomX("kate14b", 2, "50vw");
		else perKate.showPerson("kate14b.jpg");
		addPlaceTitle(md, "Kate's Revenge");
		md.write("<p>You enter the room and you see Kate standing <b>on</b> a semi-conscious Davy.</p>")
	}
	if (perKate.checkFlag(13))
		if (perKate.checkFlag(15)) {
			perKate.setFlag(23);
			perKate.place = 1;
			md.write("<p>She looks at you, there is still a hint of anger in her expression, but it is fading. She gives the unconscious Davy a kick and says,</p>" + '<p>"' + perYou.getPersonName() + ' you promised to protect me, and you have done exactly that, this necklace guarded me and you aided me!"</p>' + "<p>She smiles and you start to suggest going back to her place, but she looks at you and says,</p>" + '<p>"I think I will, I cannot stay here or else I will do something worse to this bastard"</p>' +
				'<p>Once again she gives the unconscious Davy a kick. Quickly she redresses and gives you an awkward wave goodbye, and leaves saying "See you there"</p>');
			perKate.setFlag(23)
		} else {
			perKate.place = 1E3;
			perKate.setFlag(24);
			md.write("<p>She looks at you, there is still a hint of anger in her expression, but it is fading. She gives the unconscious Davy a kick and says,</p>" + '<p>"' + perYou.getPersonName() + ' you promised to protect me, and you have done exactly that, Thank you!"</p>' + "<p>She smiles and you start to suggest going back to her place, but she looks troubled, and says,</p>" +
				'<p>"I need to think about all this a bit more, please allow me some time, I will see you again, when I have cleared my head and can stop thinking about hurting this bastard!"</p>' + '<p>Once again she gives the unconscious Davy a kick. Quickly she redresses and gives you an awkward wave goodbye, and leaves saying "See you"</p>')
		}
	else if (perKate.checkFlag(14)) {
		perKate.place = 1;
		perKate.setFlag(22);
		md.write("<p>She looks at you, there is still a hint of anger in her expression, but it is fading. She gives the unconscious Davy a kick and says,</p>" +
			'<p>"' + perYou.getPersonName() + ' you said you were doing everything for me, and you are here to rescue me!"</p>' + "<p>She says nothing more, as she embraces you and kisses you passionately. When you separate from her, you start to suggest returning to her place, but she interrupts,</p>" + '<p>"Let\'s leave here, if we do not I swear I am going to...really, really hurt this bastard! Give me a little while to clean the filth from me, and meet me at my place?"</p>' + '<p>Once again she gives the unconscious Davy a kick and then give you a quick kiss. Quickly she redresses and gives you a cute wave goodbye, and leaves saying "I\'ll be waiting"</p>')
	} else {
		perKate.place =
			1E3;
		perKate.setFlag(24);
		md.write("<p>She looks at you, there is still a lot of anger in her expression. She gives the unconscious Davy a kick and says,</p>" + '<p>"' + perYou.getPersonName() + ' I think you might have been trying to help me before, Thank you for trying"</p>' + "<p>She smiles and you start to suggest going back to her place, but she looks troubled, and says,</p>" + '<p>"I need to think about all this a bit more, I am still not too sure about you as you can do the same things as Davy. I will see you again, when I have cleared my head and can stop thinking about hurting this bastard!"</p>' +
			'<p>Once again she gives the unconscious Davy a kick. Quickly she redresses and leaves saying "Bye for now"</p>')
	}
	startQuestions();
	startAlternatives(md);
	if (!perKate.checkFlag(15) && !perKate.checkFlag(14)) addLinkToPlaceC(md, 'nod your head "yes..." but all you can think is "That ungrateful bitch"', 267, "type=bitch");
	if (isCharmedBy("Bambi")) addLinkToPlaceC(md, '"...but first I need to deal with Davy"', 184, "type=restrain");
	else addLinkToPlaceC(md, '"...but first I need to deal with Davy"', 124, "", "You would like to do something with Davy so when he wakes he cannot flee but you do not know what to do");
	addLinkToPlace(md, "follow her back to the bar", 124);
	endAlternatives(md);
	WritePlaceFooter(md)
}

function ShowPlace269(stype) {
	var md = WritePlaceHeader();
	var perLauren = findPerson("Lauren");
	var perDonna = findPerson("Donna");
	var clvD = perDonna.getCharmedLevel();
	var perLogan = findPerson("MissLogan");
	var clvL = perLogan.getCharmedLevel();
	var perDidi = findPerson("Didi");
	var clvDD = perDidi.getCharmedLevel();
	var plcD = perDonna.whereNow();
	var plcL = perLogan.whereNow();
	var plcDD = perDidi.whereNow();
	if (plcL == 269) perLogan.showPerson(clvL > 0 ? "logan11b.jpg" : "logan11a.jpg");
	else if (plcDD == 269) perDidi.showPerson(clvDD >
		0 ? "poolc.jpg" : "poolu.jpg");
	else if (isDay() && plcD == 269) perDonna.showPerson(clvD > 0 ? "donna3.jpg" : "donna1.jpg");
	else if (perLauren.place == 269) perLauren.showPerson("lauren11b.jpg");
	else addPlaceImage(md, "pool1.jpg", "", "", "Pool");
	addPlaceTitle(md, "Hotel Pool");
	md.write("<p>Much to the envy of the rest of the town the outdoor pool is heated for the privileged guests of the hotel. The water is crystal clear and the odor of chlorine fills the air. Part of the pool is roofed over and there is an extensive lighting system so it can be brightly lit at night.</p>");
	if (isDay()) {
		if (plcL == 269)
			if (perLogan.checkFlag(2)) md.write("<p>Miss Logan is relaxing at the pool, happily supervising her non-existent club.</p>");
			else {
				perLogan.setFlag(2);
				md.write("<p>You see your teacher Miss Logan near the pool dressed in an orange polka-dot bikini and some white shorts. She notices you and looks surprised,</p>" + '<p>"Are you here for the swim club? Nuts...I thought no-one...I mean welcome but we have no other members so far."<p>' + "<p>Alright...so Miss Logan is running a club here but she expected no students to turn up on a Sunday, so she was trying to just have some time off at a pool while fulfilling some of her duties as a teacher.</p>" +
					"<p>You let her off and explain you are not here for the club, and Miss Logan looks relieved. You exchange a few words with her, but you keep getting distracted, her usual clothes at school do not emphasise her breasts quite like her bikini top does here.</p>")
			}
		if (perLauren.place == 269) md.write("<p>Lauren is patiently waiting for you besides the pool, wearing a very skimpy bikini.</p>");
		if (plcD == 269 && clvD === 0) {
			if (!perDonna.checkFlag(2)) {
				perDonna.setFlag(2);
				showPopupWindow("Redhead Swimmer", "<img src='Images/donna0.jpg' style='width:30%;float:right;margin: 0px 0px 4px 4px' alt='Donna'>" +
					'A redhead girl crawls out of the swimming pool just at the time when arrive there. She barely makes a glance towards you and goes back to her deck chair. She grabs the book "Pride and Prejudice" which lies on the floor and starts to read it. Ugh! You hope she is not an uptight, arrogant noble girl.<br><br>' + "It\u2019s obvious you didn\u2019t attract her attention, but this must be the girl Bambi mentioned to you. She\u2019s all alone...with you. She\u2019s an easy prey!")
			}
			md.write("<p>A girl is climbing out of the pool. She sees you, then turns away, ignoring your presence.</p>")
		} else if (plcD ==
			269 && clvD > 0) md.write("<p>Your redhead, pale skinned friend, Donna is here. She is sitting by the pool and reading a book. She takes off her sunglasses and waves to you, shouting.</p>" + '<p>"Hey ' + perYou.getPersonName() + "! Came to check on your me, huh? Come on, buddy, sit down here. I want to know everything!\u201d The purple light in her eyes dances in the sunlight.</p>")
	} else {
		if (perLauren.place == 269) md.write("<p>Lauren is patiently waiting for you besides the pool, wearning a very skimpy bikini.</p>");
		if (plcD == 269) md.write("<p>The pool is " + (perLauren.place == 269 ? "otherwise " : "") + "empty at this time of night, Donna is not here.</p>");
		else if (perLauren.place != 269) md.write("<p>The pool is empty at this time of night.</p>")
	}
	startQuestions();
	if (isDay() && plcD == 269)
		if (!perDonna.checkFlag(1)) addQuestionR(md, "introduce yourself to the girl", "She ignores you.", "Girl at the Pool", "setPersonFlag(\\'Donna\\',1);");
		else if (clvD > 0) addLinkToPlace(md, "spend time with Donna", Place, "type=enjoy");
	if (perLauren.place ==
		269) addLinkToPlace(md, "speak to Lauren", 258, "type=lauren1");
	addLinkToPlace(md, "go to the Hotel Bar", 124);
	if (isDay() && plcD == 269 && perLauren.place == 269) {
		AddPeopleColumnLarge(md);
		perLauren.showPerson("lauren11b.jpg")
	}
	if ((plcL == 269 || plcDD == 269) && isDay() && plcD == 269) {
		AddPeopleColumnLarge(md);
		if (clvD > 0) perDonna.showPerson("donna3.jpg");
		else perDonna.showPerson("donna1.jpg")
	}
	WritePlaceFooter(md)
}

function ShowPlace270() {
	var md = WritePlaceHeader();
	var perDonna = findPerson("Donna");
	perDonna.showPerson("donna2.jpg");
	addPlaceTitle(md, "Girl Under A Spell");
	md.write('<p>"Oh my gosh!" the girl exclaims. "I feel so strange. My tummy is on fire and and I have this sudden urge towards you. Who are you? Please answer me, stranger! I want to know you!\u201d</p>' + "<p>The spell starts to take effect on the innocent girl. She drops the classic book she was reading and stands up to face you. The colour purple is slowly filling her eyes. Yet you have an odd feeling. Something should be different, but you don\u2019t know what, it\u2019s just a feeling.</p>");
	startQuestions();
	addLinkToPlace(md, "introduce yourself", 271);
	addLinkToPlace(md, "go to the bar?", 124);
	WritePlaceFooter(md)
}

function ShowPlace271() {
	var md = WritePlaceHeader();
	var perDonna = findPerson("Donna");
	perDonna.showPerson("donna3.jpg");
	addPlaceTitle(md, "Donna Under A Spell");
	md.write('<p>"' + perYou.getPersonName() + ", pretty name for an ugly " + (perYou.isBornMale() ? "Guy" : "Girl") + ' like you\u2026"- The redhead sarcastically notes your body. She defends her statement right after she sees your pouting face.</p>' + '<p>"Heyy! Honey, it\u2019s just a joke! Don\u2019t take it too seriously. I\u2019m Donna and I already know we are going to be great friends!\u201d</p>' +
		"<p>What? Friends? This is rather new. She doesn\u2019t submit like the others and she is making smart jokes on you. What is going on?</p>" + '<p>"Donna, don\u2019t you feel curious? We\u2019ve just met and you want to be my friend? You don\u2019t even know me.\u201d \u2013 you push the subject, you want to understand what\u2019s going on.</p>' + '<p>"' + perYou.getPersonName() + ', sit down next to me. Just take a break. If I don\u2019t know you, I will soon. It doesn\u2019t matter. All that\u2019s important is that we enjoy each other\u2019s company\u2026 Hmmm, do you like my tits? I know they are not that special, but I want a friend who enjoys them.", Donna grabs your arm and makes you sit down next to her on the deckchair. She frees one of her boobs from her swimsuit and strokes it. She latches onto one of your hand and guides it onto her open breast.</p>');
	startQuestions();
	addLinkToPlace(md, "accept Donna's friendship", 272);
	WritePlaceFooter(md)
}

function ShowPlace272() {
	var md = WritePlaceHeader(false, "td-left-large");
	var perDonna = findPerson("Donna");
	if (isDay()) perDonna.showPerson("donna4.jpg");
	else if (perYou.isMaleSex()) perDonna.showPerson("donna9b.jpg");
	else perDonna.showPerson("donna9g.jpg");
	addPlaceTitle(md, "Donna Under a Spell");
	md.write("<p>The spell completes it\u2019s task fully and you see that it reached Donna\u2019s soul and altered her personality. She doesn\u2019t bow to you nor calling you names and titles. The spell changed her only so that she became rather friendly and open to you.</p>" + '<p>"Yes, Donna. These are a nice pair. I know we will become very close in time, but I still can\u2019t wrap my head around something. You know, I\u2019ve put a spell on you that should make you my slave, but it\u2019s not the case.\u201d You tell her the truth. You know the spell has affected her that much enough that she is caring for you and understands you.</p>' +
		'<p>"I don\u2019t know buddy. Yes, I do feel something different inside me, but to put it this way; I don\u2019t care. I\u2019m your friend now and I want the best for you. We can investigate this strange phenomenon you are witnessing together! Sounds fun!\u201d She cheers you up and for a moment you forget what\u2019s been bothering you. After an everlasting hug, she chimes into your ear.</p>' + "<p>\"I'll be here if you need me, " + perYou.getPersonName() + ". I don\u2019t want to be lonely so visit me when you can, bud.\u201d She picks up the book that she threw away earlier and cuddles into your arms and continues to read it.</p>");
	startQuestions();
	addLinkToPlace(md, "go to the bar?", 124);
	WritePlaceFooter(md)
}

function ShowPlace275() {
	var md = WritePlaceHeader();
	var perMegan = findPerson("NurseMegan");
	var perMG = findPerson("MrsGranger");
	var myName;
	if (!perMegan.isCharmedBy()) {
		perMegan.showPerson("megan1a.jpg");
		if (perYou.isMaleSex()) myName = "sir";
		else myName = "miss"
	} else {
		myName = perYou.getMaster();
		perMegan.showPerson("megan8.jpg")
	}
	addPlaceTitle(md, "Intensive Care Unit");
	md.write("<p>Machines and tubes are all around the room plugged into unconscious patients. Doctors and nurses constantly move between the beds checking the condition of the critically ill.</p>");
	if (perMegan.isCharmedBy()) md.write('Megan chuckles when she sees you enter.  "Hello, ' +
		myName + '," she says as you pull her into a more <i>private</i> station.  "Have you come to dispense more pleasure to your slave, or just more bad pick-up lines?"</p>');
	else {
		if (!perMegan.checkFlag(1)) perMegan.setFlag(1);
		if (perMegan.checkFlag(2)) md.write('<p>Nurse Megan intercepts you, "Excuse me, can I help you ' + myName + '?"</p>');
		else md.write('<p>A nurse intercepts you, "Excuse me, can I help you ' + myName + '?"</p>')
	}
	startQuestions();
	if (perMegan.isCharmedBy()) addLinkToPlaceC(md, '"Display yourself for me, slave"',
		Place, "type=megandisplay");
	addLinkToPlace(md, "leave the intensive care unit", 214);
	if (perMG.other >= 50 && perMG.other < 54 && perMG.place == 275.5) {
		AddRightColumnMed();
		addPlaceImage(md, "icu.jpg")
	}
	WritePlaceFooter(md)
}

function ShowPlace276() {
	var md = WritePlaceHeader();
	var perG = findPerson("Gina");
	addPlaceTitle(md, "Museum Safe", checkPlaceFlag("Museum", 3) ? "vault1.jpg" : "vault2.jpg");
	md.write("<p>The museum safe is used to keep the most valuable artifacts of Glenvale history.</p>");
	startQuestions();
	if (checkPlaceFlag("Museum", 3))
		if (perG.isCharmedBy() && perG.place === 0 && !isPossess()) addQuestionCO(md, "get your slave Gina to open the safe", "Gina", 11300);
		else if (isPossess("Gina") || checkPlaceFlag("Museum", 8)) addQuestionCO(md,
		"open the safe", "Misc", 11300);
	addLinkToPlace(md, "return to the main hall", 239);
	WritePlaceFooter(md)
}

function ShowPlace277() {
	var md = WritePlaceHeader();
	if (isCharmedBy("Gina")) return dispPlace(304);
	var perMG = findPerson("Mrs Granger");
	var perDA = findPerson("Diane");
	var perG = findPerson("Gina");
	if (perMG.other >= 50 && perDA.getQuestArrested() < 50) perG.showPerson("gina1c.jpg");
	else perG.showPerson("gina1a.jpg");
	addPlaceTitle(md, "Museum Guard");
	if (isShopOpen(2, 0, true)) md.write("<p>The security guard stops you to ask your business. She is not pleased to see you wandering around.</p>");
	else md.write("<p>The security guard stops you seeming to think you are an employee of the museum working late into the night.</p>");
	if (perMG.other >= 50 && perDA.getQuestArrested() < 50) md.write('<p>She recognizes you from the vase robbery and immediately reaches for her pistol. "Hold it right there!" she cries.</p>');
	startQuestions();
	if (isShopOpen(2, 0, true)) addLinkToPlace(md, "exit the museum before you get arrested", 238);
	else addLinkToPlace(md, "run away from her", 239);
	WritePlaceFooter(md)
}

function ShowPlace278() {
	var md = WritePlaceHeader();
	var perMG = findPerson("Mrs Granger");
	var perOK = findPerson("OfficerKhan");
	if (perMG.place == 278) perMG.showPerson(perMG.health < 75 ? "!granger14a.jpg" : "!granger14b.jpg");
	else if (perOK.place == 278) perOK.showPerson(perOK.isCharmedBy() ? "Setting/pol13b.jpg" : "Setting/pol13a.jpg");
	addPlaceTitle(md, "Ward 1 West");
	md.write("<p>The west ward is for the female patients of the hospital.</p>");
	if (perOK.place == 278)
		if (perOK.isCharmedBy()) md.write("<p>Your slave " + getOfficer() +
			" Cheryl Khan is waiting for you here.</p>");
		else if (perMG.place == 278) md.write("<p>A " + getOfficer(false) + " is on guard to watch Mrs. Granger who is under arrest for theft.</p>");
	startQuestions();
	addLinkToPlace(md, "exit the ward", 214);
	if (perMG.place == 278 && perOK.place == 278) {
		AddRightColumnLarge(md);
		perOK.showPerson(perOK.isCharmedBy() ? "Setting/pol13b.jpg" : "Setting/pol13a.jpg")
	}
	WritePlaceFooter(md)
}

function ShowPlace279(stype) {
	var md = WritePlaceHeader();
	var perHannah = findPerson("Hannah");
	var clv = perHannah.getCharmedLevel();
	if (stype === "" && clv === 0 && !isShopOpen(0)) return gotoPlaceDelayed(194, "", '<img src="UI/closed.png" style="float:left;width:15%;margin-right:5px">The Mechanics Workshop closes and Hannah asks you to leave.');
	if (clv === 0) perHannah.showPerson("hannah1.jpg", "", "", "hannah1a.jpg");
	else perHannah.showPerson("hannah6.jpg");
	addPlaceTitle(md, "Mechanic's Shop");
	if (!perHannah.isHere()) md.write("<p>The place is very clean for a mechanics workshop. Parts, tools and cars are reasonably well-kept and you walk through the office to the workshop without picking up any grease or dirt.</p>");
	startQuestions();
	addLinkToPlace(md, "exit the workshop?", 194);
	WritePlaceFooter(md)
}

function ShowPlace280(stype) {
	var md = WritePlaceHeader(false, "td-none");
	var perMonique = findPerson("Monique");
	addPlaceTitle(md, "Gem Spell");
	md.write('<form method="POST" name="FormChar">' + "<p>Tiny words are printed behind the gem. Some of the letters are faded. It reads <em>... One.</em></p>" + '<p><input type="text" size="20" name="research"><input type="button" name="button" value="please" onClick="ResearchOLD(\'X\', document.FormChar.research.value)"></p>' + "</form>");
	addLinkToPlace(md, "Never mind...",
		279);
	AddRightColumnMed(md);
	if (stype == "monique") perMonique.showPerson("monique12.jpg");
	else md.write('<img src="Images/Items/gem1.jpg" style="width:100%" alt="Gem">');
	WritePlaceFooter(md)
}

function ShowPlace281() {
	var md = WritePlaceHeader();
	addPlaceTitle(md, "Shopping Center Side Alley", "stripclub1.jpg");
	md.write("<p>A small side alley off of the main shopping center. The only notable place is the Avernus Club you were told about.</p>");
	if (!isShopOpen(-2, -2, true, true)) md.write("<p>The Avernus Club is closed at this time of day, it has a sign noting 10pm to late</p>");
	startQuestions();
	if (isShopOpen(-2, -2, true, true)) addLinkToPlace(md, "enter the Avernus Club", 282);
	addLinkToPlace(md, "walk back to the shopping center",
		194);
	WritePlaceFooter(md)
}

function ShowPlace282() {
	var md = WritePlaceHeader();
	var bOpen = isShopOpen(-2, -2, true, true);
	addPlaceTitle(md, "Avernus Club", bOpen ? "stripclub2.jpg" : "stripclub3.jpg");
	if (bOpen) md.write('<p>The Avernus strip-club, a place you did not even know existed until recently. Invitation only, but hardly high-class! There is a theme for some of the items on the walls, a light BDSM feel, a whip, a mask, a photo of a light bondage scene, and so on. After all, you are aware the name "Avernus" is one of many names of Hell.</p>' + "<p>There are dancers on the main stage, but there are other girls around, some with light bondage fetish clothes.</p>");
	else md.write("<p>The Avernus strip-club, empty at this time of day.</p>");
	startQuestions();
	if (bOpen) addLinkToPlace(md, "exit the Avernus Club", 281);
	else addTextForQuestions(md, "<b>the door is locked and you cannot leave the club</b>", "center");
	WritePlaceFooter(md)
}

function ShowPlace283() {
	var perMonique = findPerson("Monique");
	var clv = perMonique.getCharmedLevel();
	var md = WritePlaceHeader();
	perMonique.showPerson(clv === 0 ? "moniquehome1.jpg" : "monique15.jpg");
	addPlaceTitle(md, "Monique's Room");
	if (clv === 0) {
		md.write("<p>It is interesting to see Monique owns a small collection of car models, though otherwise the room's interior is somewhat spartan. She has just the necessary furniture to store clothes, her bed in one corner and a book rack above the rather large computer desk in another.</p>" + '<p>Monique is dressed casually and she stands as you enter, "Hello, I did not know you were a friend of Hannah, you should of mentioned"</p>');
		startQuestions()
	} else {
		md.write("<p>Monique mentioned being into cars, so it's probably no surprise that she owns a small collection of models, though otherwise the room's interior is somewhat spartan. She has just the necessary furniture to store clothes, her bed in one corner and a book rack above the rather large computer desk in another.</p>" + "<p>Your Faithful servant quickly rises from her PC as she sees you and almost pushes over her chair, quickly performing a small bow and asking what she may do for you.</p>");
		startQuestions();
		if (!perYou.isMaleSex()) {
			addLinkToPlaceC(md, "order Monique to use her soft lips on you", 283, "type=moniquebj");
			if (perYourBody.FindItem(45) > 0) addLinkToPlaceC(md, "take Monique with your strap on", 283, "type=moniquefuck")
		} else {
			addLinkToPlaceC(md, "order Monique to give you a blowjob", 283, "type=moniquebj");
			addLinkToPlaceC(md, "take Monique on her bed", 283, "type=moniquefuck")
		}
		addSleepLink(md, "go to bed for the night with Monique", "Going to bed with Monique", '<p style="position:absolute;right:0;top:35%;cursor:pointer;font-size:1.1em;width:75%;color:black;text-align:right">You notice that night has fallen,<br>and tell Monique that you will spend the night with her.</p>',
			"moniquebed.jpg")
	}
	addLinkToPlace(md, "leave Monique's room", 237);
	addLinkToPlace(md, "leave the apartment", 194);
	WritePlaceFooter(md)
}

function ShowPlace284() {
	var perHannah = findPerson("Hannah");
	var md = WritePlaceHeader();
	perHannah.showPerson("hannah13.jpg");
	addPlaceTitle(md, "Hannah's Room");
	md.write("<p>Hannah's room is rather basic, but lined with posters and memorabilia of various bands like Kiss, M\u00f6tley Cr\u00fce and AC/DC. She has a few cabinets for clothes, a large Sofa doubling as an extendable bed and a TV with some sort of videogame console hooked up to it.</p>" + "<p>Hannah removes most of her clothes with a cheeky smile as the two of you enter, stretching out invitingly on the Sofa and telling you to take a seat.</p>");
	startQuestions();
	addLinkToPlaceC(md, "catch a ride", 284, "type=catcharide");
	addSleepLink(md, "go to bed for the night with Hannah", "Going to bed with Hannah", '<p style="position:absolute;left:15%;top:6%;cursor:pointer;font-size:1.1em;width:75%;color:white">You notice that night has fallen, and tell Hannah that you will spend the night with her.</p>', "hannahbed.jpg");
	addLinkToPlace(md, "leave Hannah's room", 237);
	addLinkToPlace(md, "leave the apartment", 194);
	WritePlaceFooter(md)
}

function NotGuilty() {
	var perDA = findPerson("Diane");
	perYou.setArrested(0);
	if (perDA.extra[1] < 30) perDA.extra[1] = 30;
	if (perDA.other < 15) perDA.other = 15;
	perDA.setQuestArrested(50);
	DAReturnItems()
}

function ShowPlace285() {
	var md = WritePlaceHeader(false, "td-left-small");
	var perDA = findPerson("Diane");
	if (perDA.extra[1] === 0) perDA.extra[1] = 3;
	if (isMurderPath())
		if (perDA.extra[1] == 6 || perDA.extra[1] == 10)
			if (getPersonCharm("OfficerKhan") === 0) md.write('<img src="Images/' + (isBritish() ? "UK" : "US") + '/pol11.jpg" style="margin:0px 5px;width:95%" alt="Khan">');
			else if (isBritish()) md.write('<img src="Images/UK/judge1.jpg" style="margin:0px 5px;width:95%" alt="Judge">');
	else md.write('<img src="Images/US/judge1.jpg" style="margin:0px 5px;width:95%" alt="Judge">');
	else if (perDA.extra[1] == 15) md.write('<img src="Images/mom2.jpg" style="margin:0px 5px;width:95%" alt="Mom">');
	else if (perDA.extra[1] == 30) md.write('<img src="Images/beasley10.jpg" style="margin:0px 5px;width:95%" alt="Beasley">');
	else if (isBritish()) md.write('<img src="Images/UK/judge1.jpg" style="margin:0px 5px;width:95%" alt="Judge">');
	else md.write('<img src="Images/US/judge1.jpg" style="margin:0px 5px;width:95%" alt="Judge">');
	else {
		if (isBritish()) md.write('<img src="Images/UK/judge1.jpg" style="margin:0px 5px;width:95%" alt="Judge">');
		else md.write('<img src="Images/US/judge1.jpg" style="margin:0px 5px;width:95%" alt="Judge">');
		switch (perDA.extra[1]) {
			case 6:
			case 7:
				md.write('</td><td class="td-left-small"><img src="Images/gina-m-face.jpg" style="margin:0px 5px;width:95%" alt="Gina">');
				break;
			case 10:
				md.write('</td><td class="td-left-small"><img src="Images/diane7-in.jpg" style="margin:0px 5px;width:95%" alt="Diane">');
				break
		}
	}
	addPlaceTitle(md, "Court Room");
	if (perDA.extra[1] == 3) {
		passTimeDay();
		md.write("<p>The trial begins. Present in court are Judge Gabel, " +
			getOfficer() + " Khan and yourself.</p>" + '<p>Judge Gabel turns towards you to say, "' + perYou.getPersonName() + ", you are accused of ");
		if (isMurderPath()) md.write("murder");
		else md.write("attempted theft");
		md.write(". How plead you?")
	}
	if (!isMurderPath())
		if (perDA.extra[1] == 6) {
			md.write("<p>Museum Guard Gina steps forward to present her testimony.</p>" + '<p>"I noticed the accused and Mrs. Granger in the History of Town display area.  They were discussing something, then I saw the accused reaching for the vase in an apparent attempt to steal the artifact." She seems to pause for dramatic effect.</p>');
			if (wherePerson("MrsGranger") == 177) md.write('<p>"It was at this point that I ordered the accused to freeze and told ' + perYou.getHimHer() + " that " + perYou.getHeShe() + " was under arrest.  Then, after conferring with the accused Mrs. Granger left the museum.  That was when the accused attempted to use force and I was forces to restrain " + perYou.getHimHer() + ' and shortly thereafter other guards arrived and took the accused off to jail."</p>');
			else if (wherePerson("MrsGranger") == 261) md.write('<p>"It was at this point that I ordered the accused to freeze and told ' +
				perYou.getHimHer() + " that " + perYou.getHeShe() + ' was under arrest.  Then, after conferring with the accused, Mrs. Granger attempted to distract me so I arrested her and the accused. Shortly thereafter other guards arrived and took the accused and Mrs. Granger off to jail."</p>');
			else md.write('<p>"It was at this point that I ordered the accused to freeze and told ' + perYou.getHimHer() + " that " + perYou.getHeShe() + ' was under arrest.  Then, after conferring with the accused, Mrs. Granger leapt at me in an attempt to distract me.  That was when Mrs. Granger was injured and shortly thereafter other guards arrived and took the accused off to jail."</p>')
		} else if (perDA.extra[1] ==
		7) md.write('<p>Judge Gabel looks at Gina. "Did you witness anything that would refute this account of events?" he asks.</p>' + '<p>Gina looks confused for a moment.  "No, I suppose he <i>could</i> have been trying to stop her," she says reluctantly.</p>' + "<p>Judge Gabel looks at the " + getProsecutor() + ' and asks "Do you have any further incriminating evidence?"</p>');
	else if (perDA.extra[1] == 10) md.write("<p>" + getProsecutor() + ' White takes the stand and frowns down at you.  "The accused was questioned at the local police station concerning the events in question.  When I asked ' +
		perYou.getHimHer() + " about the theft " + perYou.getHeShe() + " responded with, and I quote - 'Mrs. Granger was doing my bidding'.\" " + "<p>The " + getProsecutor() + ' pauses, seemingly for dramatic effect before finishing.  "At first I was taken aback by ' + perYou.getHisHer() + " candor, but after a few moments when " + perYou.getHeShe() + " didn't recant I immediately called for " + perYou.getHisHer() + ' arrest."<p>' + "<p>She seems quite confident that she has sealed your fate with her testimony.</p>" + '<p>Judge Gabel looks at you.  "What do you have to say about this, ' +
		perYou.getPersonName() + '?" he asks.</p>');
	else {
		if (perDA.extra[1] == 30) md.write('<p>"No further questions," says Judge Gabel. "The accused is obviously innocent. You may go home ' + perYou.getPersonName() + '."</p>')
	} else {
		if (perDA.extra[1] == 6)
			if (getPersonCharm("OfficerKhan") > 0) md.write("<p>Police " + getOfficer() + " Mitchell steps forward to present the evidence. " + '"It is my opinion," he says deliberately. "That ' + perYou.getPersonName() + " murdered " + perGates.getPersonName() + ". " + perYou.getPersonName() + ' was found at the scene and knew about the crime, and his clothing was seen covered with blood."</p>' +
				'<p>The judge asks you, "Do you confirm these allegations?');
			else md.write("<p>Police " + getOfficer() + " Khan steps forward to present her evidence. " + '"It is my opinion," she says deliberately. "That ' + perYou.getPersonName() + " murdered " + perGates.getPersonName() + ". " + perYou.getPersonName() + " was found at the scene and knew about the crime, and " + perYou.getHisHer() + ' clothing was seen covered with blood."</p>' + '<p>The judge asks you, "Do you confirm these allegations, or would you like to call a witness in your defense?"');
		if (perDA.extra[1] == 7) md.write("<p>Judge Gabel calls a brief recess while you decide to choose a witness. Who would support you the most?</p>");
		if (perDA.extra[1] == 15) md.write("<p>Your mother takes the stand and looks at you with concern on her face.</p>" + '<p>Judge Gabel asks her, "Can you please explain to the court why the accused knew about the murder at the Gates estate."</p>' + "<p>\"I can't, " + perYou.getPersonName() + ' came home this afternoon with a bloodstained shirt. It was disgusting so I washed it."</p>' +
			'<p>"Hmm," says Judge Gabel looking at you. "Can you explain the blood?</p>');
		if (perDA.extra[1] == 16) md.write("<p>Everyone it the court waits for your answer as to who murdered " + perGates.getPersonNameShort() + ". You know that if you slip up then they will know you are guilty and it is the end of your journey.</p>");
		if (perDA.extra[1] == 30) md.write("<p>Mr. Beasley takes the stand. He looks over at you and smiles.</p>" + '<p>Judge Gabel asks, "Mr. Beasley,can you please explain to the court why the accused knew about the murder at the Gates estate."</p>' +
			'<p>"Certainly,  ' + perYou.getPersonName() + " visited me earlier today. I had heard that " + perGates.getPersonNameShort() + " was murdered and told  " + perYou.getPersonName() + ". As you are aware, " + perGates.getPersonNameShort() + " is my cousin and I heard of his passing through my family.</p>" + '<p>"No further questions," says Judge Gabel. "The accused is obviously innocent." You are amazed at Mr. Beasley\'s lie and the Judge\'s acceptance.</p>')
	}
	if (perDA.extra[1] == 20) md.write("<p>Everyone is appalled at your crime. Your mother breaks down and cries. Judge Gabel declares that there is more than enough evidence to begin the grand jury and orders you held over for criminal trial.</p>");
	if (perDA.extra[1] == 35) md.write('<p>"No further questions," says Judge Gabel. "The accused is obviously innocent." You are relieved to be let free and glad to have received ' + sCurrency + "100 compensation.</p>");
	startQuestions();
	if (!isMurderPath()) switch (perDA.extra[1]) {
		case 3:
			startAlternatives(md);
			addLinkToPlace(md, "plead guilty", 999);
			addQuestionC(md, "plead <i>NOT</i> guilty", "Trial", 3);
			endAlternatives(md);
			break;
		case 6:
			if (wherePerson("MrsGranger") == 177) addLinkToPlace(md, "admit that you tried to get the vase",
				999);
			else {
				startAlternatives(md);
				addLinkToPlace(md, "admit that Mrs Granger was doing your bidding", 999);
				addQuestionC(md, "claim that you noticed her odd behavior and were trying to stop her", "Trial", -6);
				endAlternatives(md)
			}
			break;
		case 7:
			if (perYourBody.FindItem(8) > 0) startAlternatives(md);
			addQuestionC(md, "wait for the " + getProsecutor() + " to present more evidence", "Trial", -7);
			if (perYourBody.FindItem(8) > 0) {
				addQuestionC(md, "give the judge the letter from Davy", "Trial", 35);
				endAlternatives(md)
			}
			break;
		case 10:
			startAlternatives(md);
			if (perYourBody.FindItem(8) > 0) addQuestionC(md, "give the judge the letter from Davy", "Trial", 35);
			if (wherePerson("MrsGranger") == 177) addLinkToPlace(md, "admit that you tried to get the vase", 999);
			else addLinkToPlace(md, "admit that Mrs. Granger was doing your bidding", 999);
			addLinkToPlace(md, "claim that you were just joshing with the " + getProsecutor() + ", and apologize for not taking the charges seriously at the time", 285, "", "", "", "Converse('Trial',10)");
			endAlternatives(md);
			break
	} else switch (perDA.extra[1]) {
		case 3:
			startAlternatives(md);
			addLinkToPlace(md, "plead guilty", 999);
			addQuestionC(md, "plead <i>NOT</i> guilty", "Trial", 3);
			endAlternatives(md);
			break;
		case 6:
			startAlternatives(md);
			addLinkToPlace(md, "confirm the allegations", 999);
			addQuestionC(md, "call for a witness", "Trial", 6);
			if (perYourBody.FindItem(36) > 0) addQuestionC(md, "give the judge the letter from Davy", "Trial", 35);
			endAlternatives(md);
			break;
		case 7:
			startAlternatives(md);
			addQuestionC(md, "call your Mother to the stand", "Trial", 71);
			addQuestionC(md, "call Mr. Beasley to the stand",
				"Trial", 72);
			if (perYourBody.FindItem(36) > 0) addQuestionC(md, "give the judge the letter from Davy", "Trial", 35);
			endAlternatives(md);
			break;
		case 15:
			startAlternatives(md);
			addQuestionC(md, "say that you cut yourself cooking dinner", "Trial", 151);
			addQuestionC(md, "say that you saw " + perGates.getPersonNameShort() + " get murdered", "Trial", 152);
			endAlternatives(md);
			break;
		case 16:
			startAlternatives(md);
			addQuestionC(md, "tell them that Mr Beasley did it", "Trial", 161);
			addQuestionC(md, "tell them that Police " + getOfficer() +
				" Khan did it", "Trial", 162);
			endAlternatives(md);
			break
	}
	if (perDA.extra[1] == 20) addLinkToPlace(md, "go to jail", 260);
	else if (perDA.extra[1] >= 30) addLinkToPlace(md, "go home", 46, "", "", "", "NotGuilty()");
	WritePlaceFooter(md)
}

function ShowPlace286(stype) {
	var md = WritePlaceHeader();
	var bOpen = isShopOpen(-2, -2, true, true);
	var perJade = findPerson("Jade");
	if (bOpen) perJade.showPerson("jade2.jpg");
	addPlaceTitle(md, "Jade's Room", bOpen ? "" : "dungeon.jpg");
	if (bOpen) md.write("<p>Jade is sitting waiting for you to tell her what you want.</p>");
	else md.write("<p>The room is empty at this time of day.</p>");
	startQuestions();
	addLinkToPlace(md, "return to the main area of the club", 282);
	WritePlaceFooter(md)
}

function PuzzleRadio(doc) {
	var perMadison = findPerson("Madison");
	if (perMadison.checkFlag(33) && doc.Puzzle.answera.selectedIndex * 44 / 25 == 1.76 || perMadison.checkFlag(34) && doc.Puzzle.answera.value == 5 || perMadison.checkFlag(35) && doc.Puzzle.answera.value == 3) gotoPlace(287, "type=correct");
	else gotoPlace(287, "type=wrong")
}

function ShowPlace287(stype) {
	var md = WritePlaceHeader();
	var perMadison = findPerson("Madison");
	if (perYou.getQuestRustyKey() == 900) return dispPlace(45);
	if (stype === "") {
		if (!perMadison.checkAnyFlags(33, 35)) perMadison.setFlag(Math.floor(Math.random() * 3) + 33);
		if (perYou.getQuestRustyKey() < 3) perYou.setQuestRustyKey(3);
		if (!isPlaceKnown("TVStation")) setPlaceKnown("TVStation");
		addPlaceTitle(md, "Phone Call", getThemeFolder() + "antenna.png");
		md.write("<p>You listen to the phone message.</p>" + '<p>"Hi," says a clear male voice. "This is local radio station MC 550. You are our lucky random call. Can you guess the answer to this puzzle for a prize stereo?"</p>');
		if (!isPuzzles()) {
			md.write("<p>The person asks you to answer a word game, and you are fairly sure you know the answer.</p>");
			startQuestions();
			addLinkToPlace(md, "answer confidently", 287, "type=correct");
			addLinkToPlace(md, "ummmm...on second thoughts I do not know", 287, "type=wrong");
			WritePlaceFooter(md);
			return
		}
		if (perMadison.checkFlag(33)) md.write("<p>What comes next in this sequence:</p>" + '<form method="POST" name="Puzzle">' + '<div style="text-align:center"><table style="background-image:url(' + getThemeFolder() +
			'background.jpg);padding:0px;border-collapse:collapse;border-spacing:0">' + "<tr>" + "<td>Dog, Cat, Mouse, Mole, Deer, Pig,&nbsp;</td>" + "<td> " + '<select name="answera" size="1">' + '<option selected value="1">Cow</option>' + '<option value="2">Llama</option>' + '<option value="3">Rabbit</option>' + '<option value="4">Frog</option>' + "</select>");
		else if (perMadison.checkFlag(34)) md.write("<p>What mathematical symbol can be put between 5 and 9, to get a number bigger than 5 and smaller than 9?</p>" + '<form method="POST" name="Puzzle">' +
			'<div style="text-align:center"><table style="background-image:url(' + getThemeFolder() + 'background.jpg);padding:0px;border-collapse:collapse;border-spacing:0">' + "<tr>" + "<td>+-*/.|&amp;,&nbsp;</td>" + "<td> " + '<select name="answera" size="1">' + '<option selected value="1">+</option>' + '<option value="2">-</option>' + '<option value="3">/</option>' + '<option value="4">*</option>' + '<option value="5">.</option>' + '<option value="6">|</option>' + '<option value="7">&amp;</option>' + "</select>");
		else md.write("<p>Two men decided to take a fishing trip. Both had one son and brought him along. Everyone on the trip caught and kept at least one fish. What's the fewest number of fish that could have been kept?</p>" +
			'<form method="POST" name="Puzzle">' + '<div style="text-align:center"><table style="background-image:url(' + getThemeFolder() + 'background.jpg);padding:0px;border-collapse:collapse;border-spacing:0">' + "<tr>" + "<td>How many?&nbsp;</td>" + "<td> " + '<select name="answera" size="1">' + '<option selected value="1">1</option>' + '<option value="2">2</option>' + '<option value="3">3</option>' + '<option value="4">4</option>' + "</select>");
		md.write("</td>" + "<td> " + '<input type="button" name="button" value="Go" onClick="PuzzleRadio(document)">' +
			"</td>" + "</tr>" + "</table>" + "</div>" + "</form><br>");
		startQuestions();
		addLinkToPlace(md, "give up", 45)
	} else if (stype == "correct") {
		if (perYou.getQuestRustyKey() < 5) perYou.setQuestRustyKey(5);
		perYou.setFlag(1);
		addPlaceTitle(md, "Correct Answer!", getThemeFolder() + "antenna.png");
		if (!isPuzzles()) md.write('<p>"You got it!"</p>');
		else if (perMadison.checkFlag(33)) md.write('<p>"You got it! Llama! The length of each word is the same length of the numbers one, two, three, four, five, six, etc."</p>');
		else if (perMadison.checkFlag(34)) md.write('<p>"You got it! It\'s a trick, you put a Decimal Point, 5.9 works nicely"</p>');
		else md.write('<p>"You got it! There were only three people. The son, his father, and his grandfather."</p>');
		md.write("<p>\"Congratulations, your prize will be delivered very soon by 'G.R USX Deliveries' a subsidary of MC 550 Radio!\"</p>");
		startQuestions();
		addLinkToPlace(md, "Hang up the phone", 45)
	} else if (stype == "wrong") {
		if (perYou.getQuestRustyKey() < 900) perYou.setQuestRustyKey(900);
		addPlaceTitle(md, "Wrong Answer!", getThemeFolder() + "antenna.png");
		md.write('<p>"Bad luck. Now for our next caller..."</p><p>The person hangs up, you have lost your chance for a new stereo.</p>');
		startQuestions();
		addLinkToPlace(md, "Hang up the phone", 45)
	}
	WritePlaceFooter(md)
}

function ShowPlace288(stype) {
	var md = WritePlaceHeader();
	var perMadison = findPerson("Madison");
	perMadison.showPerson("madison2.jpg");
	addPlaceTitle(md, "Radio MC550 Prize");
	if (stype == "met") md.write("<p>You open the door to leave and remember you heard someone knocking. Standing there is");
	else md.write("<p>Opening the door you are greeted by");
	md.write("a young lady who looks to be in her mid twenties. At first you don\u2019t understand why she\u2019s here and what she wants, but after a quick look you realize she must be the one who brings you your prize you won with the radio puzzle. Judging by her uniform (which fits her rather sexily) and the package she is carrying you think she is working for the TV station.</p>" + "<p>You hastily greet and let the pretty blonde into your house.</p>" +
		'<p>"Special delivery," she says. "I\'m Madison. You are the lucky winner of our radio station\'s contest. Today\'s prize is a stereo."</p>');
	startQuestions();
	addLinkToPlace(md, "ask Madison to bring the stereo inside", 289);
	WritePlaceFooter(md)
}

function ExitMagnet(no) {
	Leave();
	findPerson("Madison");
	if (whereItem(38) == 289) moveItem(38, 46);
	per.setFlag(5);
	if (no == 1) setComments('<img src="Images/' + per.getImg("madison-face.jpg") + '" style="float:right;width:20%;margin-bottom:1em;margin-left:5px"><b>Madison</b><br>"Thanks for understanding", and she leaves you to do more deliveries');
	else if (no == 2) setComments('<img src="Images/' + per.getImg("madison-face.jpg") + '" style="float:right;width:20%;margin-bottom:1em;margin-left:5px"><b>Madison</b><br>"Sorry", and she leaves you alone with the broken prize');
	else setComments('<img src="Images/' + per.getImg("madison-face.jpg") + '" style="float:right;width:20%;margin-bottom:1em;margin-left:5px"><b>Madison</b><br>"No way, I\'m not that sort of girl", and she leaves you alone with the broken prize');
	dispPlace(45, "")
}

function ShowPlace289() {
	var md = WritePlaceHeader();
	findPerson("Madison");
	per.showPerson("madison3.jpg");
	addPlaceTitle(md, "Radio MC550 Prize");
	if (perYou.getQuestRustyKey() == 7) perYou.setQuestRustyKey(8);
	md.write("<p>Madison tries to carry the equipment inside. Her high heels catch on the step, and before you can rescue her she drops the package.</p>" + '<p>"Oh my!" she says. "I\'m so sorry. Please don\'t tell the radio station what happened! It will be the end of my job if they find out."</p>' + "<p>You open the package. Inside the stereo is okay but the speakers are a mess. You open a speaker causing a small magnet to fall out.</p>");
	startQuestions();
	startAlternatives(md, "You could choose <b>one</b> of the following");
	addOptionLink(md, "Well, there is nothing that can be done, tell Madison to leave", "ExitMagnet(1)");
	addOptionLink(md, "angrily tell Madison to leave", "ExitMagnet(2)");
	addOptionLinkC(md, '"Well, you could make it up to me in another way"', "ExitMagnet(3)");
	endAlternatives(md);
	WritePlaceFooter(md)
}

function ShowPlace290(stype) {
	var md = WritePlaceHeader();
	var perLauren = findPerson("Lauren");
	var myLord = perLauren.getYourNameFor();
	perLauren.setFlag(3);
	if (perLauren.isCharmedBy()) perLauren.showPerson("lauren4.jpg");
	else if (isMurderPath()) perLauren.showPersonDN("lauren6.jpg");
	else if (stype == "escort") perLauren.showPersonDN("lauren1a.jpg");
	else addPlaceImage(md, "mansionguestroom.jpg");
	addPlaceTitle(md, "Guest Room");
	if (isMurderPath())
		if (!perLauren.isCharmedBy()) {
			if (!perLauren.checkFlag(4)) {
				md.write("<p>Following her discreetly, you watch as the maid enters one of the various guest rooms, her ass swaying slightly beneath the frills of the skirt, brought alluringly into view by the fabric's material. Pausing a moment, you wait for her to fully enter the room, watching the door frame as you speculatively look about, not expecting to see anyone else but wanting to be sure nonetheless. Finally, sure that you are indeed unlikely to come across any other people, you slip into the room.  The aloof servant is in an ensuite bathroom, and your entrance gains first a look of surprise then one of cool disdain.</p>");
				perLauren.setFlag(4)
			}
			md.write('<p>"Just what do you think you are doing here?" she asks, her voice ice-cold as she stares down at you as if you were little more than vermin she could exterminate without a moment\'s thought or care. "This is a private bedroom.  Leave now or I will call the police!"</p>')
		} else md.write("<p>Lauren, the maid, is waiting to serve you. Somewhere, deep down, she still has an independent spirit - only the magic has stripped away any reason she may have had to resist before you charmed her.</p>");
	else if (stype == "escort")
		if (getQueryParam("charm") == "yes") CharmLauren(md);
		else {
			perLauren.extra[0] = 0;
			if (getPersonOther("Sarah") == 100) setPersonOther("Sarah", 101);
			md.write("<p>Lauren escorts you to the room. It is a slightly old fashioned looking room, but everything is expensive and of fine quality. She shows you where things are including some spare clothes and night-attire. She waits a little to answer any questions.</p>")
		}
	else md.write("<p>A slightly old fashioned room, but everything is expensive and of fine quality.</p>");
	startQuestions();
	if (stype == "escort") addLinkToPlaceC(md, '"Thank you Lauren, that will be all"', 290);
	if (perLauren.isCharmedBy()) addLinkToPlaceC(md, "ask Lauren for service", 290, "type=laurenplay");
	if (!isDay())
		if (perLauren.isCharmedBy()) addSleepLink(md, "go to bed for the night", "Sleeping with some Service", '<p style="position:absolute;left:25%;top:15%;cursor:pointer;font-size:1.1em;width:50%">' + "You start to prepare for bed and as you do you see the maid Lauren silently start to remove her clothing and their lies on the bed awaiting you, ready to serve you however you wish.",
			perLauren.getImg(Math.random() < .5 ? "lauren-bed1.jpg" : "lauren-bed2.jpg"), true);
		else addLinkToPlace(md, "go to bed for the night", "", "", "You retire to bed for the night", "", "WaitforForDayNight()");
	else addOptionLink(md, "wait for darkness", "WaitforForDayNight()");
	if (isMurderPath()) addOptionLink(md, "exit the guest room", "visitSarah()");
	else addLinkToPlace(md, "exit the guest room", 18, "area=upstairs");
	WritePlaceFooter(md, isMurderPath() ? "Script by EH" : "")
}

function ShowPlace291() {
	var md = WritePlaceHeader();
	var perLauren = findPerson("Lauren");
	perLauren.showPerson("lauren2.jpg");
	addPlaceTitle(md, "Guest Room");
	md.write("<p>Giving her a bit of a smirk, you cross your arms and speak the simple syllables, &quot;Dai Chu Lauren!&quot;</p>" + "<p>A look of confusion flashes momentarily across her face as the first wave of desire lightly rises up within " + "her, the power of the magic slowly causing her body to warm in spite of herself. Her lips suddenly dry, she takes " +
		"a slow moment to lick them before resuming her hard stare, though the icy edge has dulled from across it, " + "&quot;Look, take yourself and your sneezes somewhere else and I'll just forget about this, all right?&quot;</p>" + "<p>Even as she says this, her eyes are losing some of their determination, slowly losing focus as the force of " + "the magic swells up within her. The mana slowly eating away " + "at her resistance, yet she struggles, fighting against the sudden urges, eyes flashing with a confused anger as " +
		"the sensations penetrate into the walls of her self-control, making her grow hotter and hotter. Finally, in a " + "voice that almost trembles she manages to force out a command: &quot;Leave now! ... please...?&quot;</p>");
	startQuestions();
	addLinkToPlace(md, "tell her to show her panties", 292);
	addLinkToPlace(md, "exit the guest room", 192);
	WritePlaceFooter(md, "Script by EH")
}

function ShowPlace292() {
	var md = WritePlaceHeader();
	var perLauren = findPerson("Lauren");
	perLauren.showPerson("lauren7.jpg");
	addPlaceTitle(md, "Guest Room");
	md.write("<p>Sensing the tremor of uncertainty that had entered her " + "voice, you decide to push things a bit further as you " + "tell her to show you her panties. Almost immediately she " + "balks, eyes flashing angrily at your outrageous demand " + "while her body almost immediately turns and bends over, " + "one hand sliding the skirt up. She wasn't wearing any panties " +
		"underneath the abbreviated skirt. As she notices her " + "actions, her eyes take a wild look, trying to force her " + "hands to drop the skirt back down, only to find them " + "resistant, not following her commands as they instead " + "continue to hold it high giving you a nice, long show.</p>" + "<p>Finally, a slow smile builds across her face as the " + "magic tightens its grip upon her mind, pulsing " + "again, causing her to wonder what she had been so upset about to begin with.</p>");
	startQuestions();
	addLinkToPlace(md,
		"tell her to show you her breasts", 293);
	addLinkToPlace(md, "exit the guest room", 192);
	WritePlaceFooter(md, "Script by EH")
}

function ShowPlace293() {
	var md = WritePlaceHeader();
	var perLauren = findPerson("Lauren");
	perLauren.showPerson("lauren3.jpg");
	addPlaceTitle(md, "Guest Room");
	md.write("<p>Seeing that the magic has increased its control over " + "her, you tell her to drop her skirt down once more, then remove her top and hop on the counter.</p>" + "<p>As her hands eagerly move to carry out your command, " + "her face loses its happy smile, her mind struggling free " + "of the magic holding it for a moment, trying to escape " + "the building fires of lust and submission. And, " +
		"surprisingly for one who spends her days in the service " + "of another, she fights back harder than any other you " + "have yet enthralled. Still, her fight doesn't stop her " + "instincts to obey, heightened by the magic of your spell, " + "from quickly following any task you give it, her voice the only " + "sign that she still resists as she crawls up onto the " + "granite, kneeling there in her light stockings as she begins to slowly pull off her uniform.</p>" + "<p>&quot;S-stop.... Please...&quot; her eyes water as her " +
		"voice breaks into a half sobbing plea, &quot;Please don't do this to me... please...&quot;</p>");
	startQuestions();
	addLinkToPlace(md, "order her to submit to you", 294);
	addLinkToPlace(md, "exit the guest room", 192);
	WritePlaceFooter(md, "Script by EH")
}

function ShowPlace294() {
	var md = WritePlaceHeader();
	var perLauren = findPerson("Lauren");
	perLauren.showPerson("lauren8.jpg");
	addPlaceTitle(md, "Lauren");
	md.write("<p>Her pleas fall on deaf ears as you become drunk with the tantalizing power you hold over her. Not even the " + "wild pleading of her eyes reaches you, so lost is your mind " + "in the sea of magic flowing from between your bodies. As " + "you order her down upon all fours on the bed, you can see " + "the magic asserting itself, the spell finalizing its hold upon her panicked mind.</p>" +
		"<p>Still slightly caught up in her own rebellion against the seemingly unstoppable force of the spell, she watches " + "helplessly as you approach her. A broken groan escapes her lips as she finds herself responding to your touch, " + "and she closes her eyes. Her body has already been lost to the " + "crashing waves of sensation you send through her, pounding against her sense of self, slowly eroding it bit " + "by bit, weakening her resolve as she grows slick with anticipation.</p>" + "<p>When you at last take her, the crash of pleasure carries away that last bit of resistance, smashing it " +
		"into oblivion as she begins to return your use with a " + "hungry enthusiasm, though when her eyes open again they carry of a note of resigned sadness.</p>");
	startQuestions();
	addLinkToPlace(md, "exit the guest room", 192);
	WritePlaceFooter(md, "Script by EH")
}

function LeaveNoBath(plc, cmt) {
	setPersonOther("Sarah", 1E3);
	setPersonFlag("Lauren", 2)
}

function ShowPlace296() {
	var stage = getQueryParam("stage");
	var md = WritePlaceHeader(false, stage == "sarahlauren1" || stage == "sarahlauren5" ? "td-left-large" : "");
	var perS = findPerson("Sarah");
	var bMan = perYou.isBornMale();
	AddImage(stage + ".jpg", stage == "sarahlauren1" || stage == "sarahlauren5" ? "" : "height:max");
	addPlaceTitle(md, "Sarah Bathing");
	perS.other += 1;
	if (stage == "sarahlauren1") {
		md.write("<p>You approach the door and you can see something is holding the door in place. As you decide if you should open the door and openly enter the room, you hear voices inside, and your eyes are drawn to what to can see through the doorway,</p>" +
			'<p>"I think ' + perYou.getHeShe() + ' saw my.."<br/>' + '"<i>Of course, now lather my back and..</i>"<br/>' + '"Yes, My Lady..oh..um..I could not close the door it is blocked."<br/>' + 'In a slightly louder voice "<i>Well no one is looking at us <b>only</b> looking</i>"<br/>' + '"Yes, My Lady, after this do you think I could wear pa..."<br/>' + '"<i>No!</i>"</p>' + "<p>You think this means that Sarah does not want you to enter the bathroom</p>");
		stage = "sarahlauren2"
	} else if (stage == "sarahlauren2") {
		md.write("<p>You continue to watch as best you can, Sarah never looks at you, but you notice the maid glance in your direction, or is it just the open door. She then starts to apply soap to Sarah's back while Sarah presses herself against the shower's glass wall.</p>" +
			'<p>"<i>That\'s right, make sure to lather my bum as well Lauren.</i>"<br/>' + '"Yes, My Lady, but do I really have to.."<br/>' + 'In a stern tone<br/>"<i>Yes you do and you well know why!</i>"<br/>' + '"Yes, My Lady"<br/>' + '"<i>Do you think it is too <b>' + (bMan ? "hard" : "wet") + '</b> now?</i>"<br/>' + "<p>Sarah then moans softly, and you know what she means by " + (bMan ? "hard" : "wet") + "!</p>");
		stage = "sarahlauren3"
	} else if (stage == "sarahlauren3") {
		md.write("<p>As you think about either leaving, entering the room or masturbating, Sarah turns around and kisses her maid Lauren. Lauren resists for a moment before returning the kiss. Their breasts rub together, nipples rubbing against each other. While still kissing Sarah take some soap and start applying it to Lauren's stomach and works lower and lower.</p>" +
			'<p>"<i>Now I think it is time for something better.</i>"<br/>' + '"Yes, My Lady"<br/>' + '"<i>Remember what I have told you to call me at these times</i>"<br/>' + '"Yes, M..mistress"<br/>');
		stage = "sarahlauren4"
	} else if (stage == "sarahlauren4") {
		md.write("<p>Lauren kneels down and applies soap to Sarah's stomach and then to her groin. She then uses the shower head and her hands to wash Sarah carefully and completely. You cannot see clearly but you think she also uses her mouth and tongue for a little while. Sarah moans and sighs as Lauren cleans her, until she huskily says,</p>" +
			'<p>"<i>Enough for <b>now</b> I will now clean you</i>"<br/>' + '"My...Mistress there is no need"<br/>' + '"<i>This is not a request!</i>"<br/>' + '"Yes, M..mistress"</p>' + "As Lauren says this she looks directly at you and immediately glances away</p>");
		stage = "sarahlauren5"
	} else if (stage == "sarahlauren5") {
		md.write("<p>Sarah makes Lauren lie down and uses a combination of soap, fingers and the shower to arouse Lauren. She kisses her mouth, breasts and starts to strongly manipulate, well masturbate Lauren.</p>" +
			'<p>"Ah..Mistress please stop, I do not want to..in front..."<br/>' + '"<i>You will</i>"<br/>' + '"Ahhh"</p>' + "<p>Lauren orgasms under Sarah's strict but caring touch and Sarah tenderly kisses her. Then Sarah says,</p>" + '"<i>Well Lauren, isn\'t that a good showing of what a lover could expect. I am sure you can work out how to close the door now. I am sure there is no-one there to stop you.</i>"</p>' + '<p>"Yes Mistress"</p>' + "<p>Lauren walks over and closes the door. As she does she looks directly at you, looking very, very embarrassed. As you start to leave you hear through the door, spoken louder than normal</p>" +
			'<p>"<i>Lauren you can finish cleaning me <b>now</b>, I really want to be finished, maybe a couple of times.</i>"</p>');
		stage = "end"
	} else if (stage == "sarahlauren6") {
		md.write("<p>You open the door and walk in. You see Sarah and her maid in the shower. Sarah is looking at you disappointed and the maid looks embarrassed. Sarah tells you,</p>" + '<p>"Impatient aren\'t we. No more playtime for you."</p>' + "<p>The maid awkwardly walks over and escorts you out of the bathroom and closes the door.</p>");
		stage =
			"end"
	}
	startQuestions();
	if (stage !== "end") {
		addLinkToPlace(md, "enter the bathroom", 296, "stage=sarahlauren6");
		addLinkToPlace(md, "continue watching", 296, "stage=" + stage);
		addLinkToPlace(md, "go downstairs", 18, "", "As you leave you hear a voice &quot;It appears this will be a boring visit&quot;", "", "LeaveNoBath()")
	} else addLinkToPlace(md, "go downstairs", 18);
	WritePlaceFooter(md)
}

function ShowPlace297() {
	if (isRunes()) {
		Research("Spell", "MirDaru", "sarah9a.jpg", 192);
		return
	}
	var md = WritePlaceHeader();
	var perS = findPerson("Sarah");
	if (isCharmedBy("Sarah")) perS.showPerson("sarah9a.jpg");
	else perS.showPerson("sarah9b.jpg");
	addPlaceTitle(md, "New Spell Research");
	md.write('<form method="POST" name="FormChar">' + "<p>I want to look up the word(s):</p>" + '<p><input type="text" size="20" name="research">' + '<input type="button" name="button" value="please" onClick="ResearchOLD(\'SG\', document.FormChar.research.value)"></p></form>');
	addLinkToPlace(md, "Never mind...", 192);
	WritePlaceFooter(md)
}

function ShowPlace299(stype) {
	var md = WritePlaceHeader();
	var perSarah = findPerson("Sarah");
	var perVamp = findPerson("Vampyre");
	if (stype == "free" && perVamp.isCharmedBy("You")) stype = "yours";
	var perB = findPerson("Bambi");
	var sWait = getQueryParam("wait");
	if (stype === "") {
		perVamp.showPerson("vamp9s.jpg");
		addPlaceTitle(md, "Sarah and her Vampyre");
		perVamp.setFlag(6);
		if (perSarah.checkFlag(2)) md.write("<p>You hear Sarah say something annoyed to the vampyre, it looks like she is trying again to make her submit. Clearly unsuccessfully. Sarah asks you</p>" + '<p>"Do you want to take her now?"</p>');
		else {
			perSarah.setFlag(2);
			if (sWait == "true") md.write('<p>You are sitting talking to Sarah and the Vampyre walks into the room, ignoring you completly and quietly stands next to Sarah. Sarah looks at you and smiles, she stands and starts to remove her clothing, but she turns her back to you and orders the vampyre, "Lilith, show our visitor your obedience and devotion, lick me and make me cum". Still ignoring you the Vampyre kneels behind Sarah, and starts licking her delightful rear end. You can see the vampyre has a curious mixture of lust and hunger in her expression, then she bites Sarah\'s ass, drawing a small trickle of blood and she starts to lick the blood. Sarah calls out in pain, she tells the vampyre,</p>' +
				'<p>"Enough Lilith!" and the speaks to you, "She will not act right, she says she loves me and will obey me, but she refuses to do some things. She will not submit to me, no matter how reluctantly, unlike someone I could name."</p>' + "<p>Sarah starts to redress, and the vampyre says to her,</p>" + '<p>"I am no slave, I am a predator and have my own will. You command my heart and soul, but you cannot control my nature."</p>' + '<p>Sarah looks annoyed, "See what I mean? Look, do you want her? Maybe we can work out how you could enspell her instead of me. We would have to free her of the Unlife-enspelled and the you could bind her. We would have to make sure she did not kill us inbetween, I do not feel confident any protective items would work again. Could we just tie her up? I do not have any experience with that sort of stuff, do you?"</p>');
			else md.write("<p>You hear Sarah yell out something, she sounds annoyed! You step into her room and see she is naked and the Vampyre is kneeling behind her, licking her delightful rear end. You can see the vampyre has a curious mixture of lust and hunger in her expression and you see a slight trace of blood. Sarah looks at you and she looks a little embarrassed, she tells the vampyre,</p>" + '<p>"Enough Lilith!" and the speaks to you, "She will not act right, she says she loves me and will obey me, but she refuses to do some things. She will not submit to me, no matter how reluctantly, unlike someone I could name."</p>' +
				"<p>Sarah starts to redress, and the vampyre says to her,</p>" + '<p>"I am no slave, I am a predator and have my own will. You command my heart and soul, but you cannot control my nature."</p>' + '<p>Sarah looks annoyed, "See what I mean? Look, do you want her? Maybe we can work out how you could enspell her instead of me. We would have to free her of the Unlife-enspelled and the you could bind her. We would have to make sure she did not kill us inbetween, I do not feel confident any protective items would work again. Could we just tie her up? I do not have any experience with that sort of stuff, do you?"</p>')
		}
		if (!isSpellKnown("MirDaru") ||
			perYourBody.FindItem(32) === 0) {
			md.write("<p>");
			if (!isSpellKnown("MirDaru")) md.write("Unfortunately you have not learned the spell to bind the vampyre yet.");
			if (perYourBody.FindItem(32) === 0) md.write(" You have no means to free the vampyre from the spell.");
			md.write("</p>")
		}
		startQuestions();
		addLinkToPlaceC(md, '"No, deal with her yourself"', 192, "type=nohelp");
		addLinkToPlaceC(md, "not yet", 192, "", "You tell Sarah to cope for now, you will deal with the vampyre later");
		if (perYourBody.FindItem(32) > 0 && isSpellKnown("MirDaru")) addLinkToPlaceC(md,
			'"I can free and bind her so we can do this"', 299, isCharmedBy("Bambi") ? "type=bound" : "type=notbound");
		else addLinkToPlaceC(md, "there is nothing you can do", 192, "", "You tell Sarah that there is nothing you can do, you have no means to free the Vampyre")
	} else if (stype === "notbound") {
		perVamp.showPerson("vamp1b.jpg");
		addPlaceTitle(md, "Vampyre");
		md.write("<p>You know you can free the vampyre and bind her with magic, but you are not sure how to restrain her after freeing her with the Silver Ring. If only you know more of bondage or knew someone skilled in these arts or at least talented as a courtesan.</p>" +
			"<p>You will have to leave it here, until you can work out a way to restrain the vampyre.</p>");
		startQuestions();
		addLinkToPlaceC(md, "leave it there for now", 192)
	} else if (stype === "bound") {
		perVamp.showPersonRandom("vamp6", 3);
		var myName = perB.getYourNameFor();
		addPlaceTitle(md, "Vampyre Bound");
		md.write("<p>You remember that Bambi has mentioned some experience in BDSM and phone her to join you here with Sarah. She eagerly agrees, and tells you she will be there as soon as she can. Maybe 30 mintes later there is a knock at the door and Bambi enters carrying a bag and dressed...differently. She looks around and says,</p>" +
			'<p>"Not what I expected ' + myName + ' I thought we were going to play with Miss Gates! Since I came here to play, how do you like my old school uniform? It still fits me!"</p>' + "<p>She giggles in a theatrical way, and continues,</p>" + '<p>"So is it this woman or Miss Gates who is to be the center of attention?"</p>' + "<p>The vampyre looks at Bambi with a murderous expression, and starts to, well, stalk towards Bambi. Sarah orders her to stop, and let Bambi tie her up. The vampyre stops with great reluctance, it seems she is near the limits of the control of the spell. Still, she sits still as Bambi gets out her bondage gear. You tell Bambi to make sure she is <b>very</b> tightly tied, <b>very</b>. Bambi winks, and continues, but Bambi being Bambi she first strips the vampyre naked before tying her extremely tightly.</p>" +
			'<p>After a while you look and the vampyre is securely bound and Bambi asks, continuing her role-playing "What kind of game are we going to play?"</p>');
		startQuestions();
		addLinkToPlaceC(md, '"No, no, not now!"', 192, "", "You tell Sarah and Bambi that you will forget it now and try this later");
		AddPeopleColumnMed();
		perB.showPerson("bambi14a.jpg")
	} else if (stype === "boundfree") {
		perVamp.showPersonRandom("vamp6", 3);
		startTimedEvent("dispPlace(299,'type=free')", 1);
		AddMana(5);
		addPlaceTitle(md, "Freed Vampyre Bound");
		md.write("<p>The silver ring absorbs the power of the spell binding the vampyre. Immediately the vampyre screams, a sound of fury and lust and you hear her bindings creak as she strains with her inhuman strength to break them, and kill everyone in this room.</p>" + '<p>Bambi looks confused, "Strange games you are playing here!"</p>' + "<p>You hear something snap in the vampyres bindings and you realise you only have a moment before she breaks free...</p>");
		startQuestions();
		addLinkToPlaceC(md, "tell Bambi to leave",
			299, "type=free");
		addLinkToPlaceC(md, "ask Sarah what is wrong", 299, "type=free");
		AddPeopleColumnMed();
		perB.showPerson("bambi14a.jpg")
	} else if (stype === "free") {
		perVamp.showPerson("vamp3b.jpg");
		addPlaceTitle(md, "Vampyre Breaks Free");
		md.write("<p>The vampyre screams as her bindings all break, and she leaps on you with inhuman speed. All goes dark...</p>" + "<p>...briefly you awaken to see the vampyre and Sarah embracing as they are standing over Bambi's body. There are fang marks on Sarah's neck and blood is flowing into her mouth from the vampyre.</p>" +
			"<p>They notice you are awake, and there is a blur as the vampyre attacks, killing you in an instant...</p>" + "<p>That would seem to be it, darkness falls over your eyes and over Glenvale as a plague of vampyres descend. You were just too slow in binding the vampyre.</p>");
		startQuestions();
		addRestartLink(md)
	} else if (stype === "free2") {
		perVamp.showPerson("vamp3b.jpg");
		addPlaceTitle(md, "Vampyre Freed");
		md.write("<p>The vampyre screams as you free her at the wrong time, and she leaps on you with inhuman speed. All goes dark...</p>" +
			"<p>...briefly you awaken to see the vampyre and Sarah embracing as they are standing over Bambi's body. There are fang marks on Sarah's neck and blood is flowing into her mouth from the vampyre.</p>" + "<p>They notice you are awake, and there is a blur as the vampyre attacks, killing you in an instant...</p>" + "<p>That would seem to be it, darkness falls over your eyes and over Glenvale as a plague of vampyres descend. You were just too slow in binding the vampyre.</p>");
		startQuestions();
		addRestartLink(md)
	} else if (stype ===
		"yours") {
		perVamp.showPerson("vamp1b.jpg");
		addPlaceTitle(md, "Your Vampyre");
		perVamp.place = -1;
		perVamp.other = 100;
		perSarah.other = 116;
		perVamp.charmThem(4);
		perSarah.setFlag(8);
		md.write("<p>The vampyre stops stuggling and you realise she is yours. With a sligh hesitation you tell Bambi to untie the vampyre, she looks at you, having no idea what has just happened,</p>" + '<p>"What, no games?"</p>' + "<p>You tell her that you will play another time, and she looks disappointed, but she unties the vampyre who looks intensely and hungrily at Bambi. You tell the vampyre to stop, and then order Bambi to leave and return to the hotel. Still unsure what is happening Bambi gets her things and leaves, waving you goodbye.</p>" +
			"<p>The vampyre stands and pointedly ignores Sarah, she clearly remembers everything and appears to be feeling scorned by Sarah, her ex-mistrsss and ex-lover. She looks at you intensely, as she partially removes her clothing, leaving a hood in place to cover most of her face. She has a beautiful, if pale body, and black hair, but her hair had odd quailities, and can appear reddish at times.</p>" + '<p>"' + perYou.getMaster() + ", that was the spell of Necromancy the charm of 'Bind the Dead', or 'Unlife Enspelled'. It has made me your thrall, in body and heart. I will do anything you command, my mind is my own but I still must obey and love you.\"</p>" +
			'<p>You ask the vampyre where she came from, and she replies, "' + perYou.getMaster() + ', I am yours to command, <b>you</b> may command me to do anything, except answer questions."</p>' + '<p>She continues, "I am yours, I will follow you to the grave, but in the daytime I must rest in the crypt."</p>' + '<p>Without looking at Sarah she states, "' + perYou.getMaster() + ' I will now kill the witch-girl"</p>' + '<p>You order her to stop and she will only kill at your command, never at any other time!. The vampyre smiles cruely, you think more for Sarah, "Of course ' +
			perYou.getMaster() + '"</p>');
		startQuestions();
		addLinkToPlaceC(md, "speak to Sarah", 192);
		AddPeopleColumnMed();
		perB.showPerson("bambi14a.jpg")
	} else if (stype == "stakevampyre") {
		perVamp.showPerson("vampdead.jpg");
		addPlaceTitle(md, "Your Vampyre");
		perVamp.place = 1E3;
		perVamp.health = 0;
		perSarah.other = 116;
		perVamp.unCharmThem();
		perSarah.setFlag(8);
		md.write("<p>You tell Bambi to leave as you grab a heavy ornament and take out one of the stakes you had made. You briefly hesitate, you are after all going to kill this person, but she is a fiend, and terrible vampire!</p>" +
			"<p>You hammer the stake but to little effect, and the vampyre looks around and strains at her bonds with her inhuman strength. You hea a snap and then another, and with desperation you hammer at the stake again. Somehow how it sinks into her flesh and she screams and falls limp. You do not know if she is dead, or well more dead, or not. You finish the ill-deed until the stake is deeply embedded in her and Sarah tells you,</p>" + '<p>"Stop, that is enough ' + perSarah.getYourNameFor() + ', she is lain to rest. I did not expect you to do this..."</p>' +
			"<p>TSarah looks rather surprised and a little shocked. She skaes her head as she regains her composure and tells you, a little hesitantly,</p>" + '<p>"It is the taks of my family to guard against these creatures...I will have the body dealt with...but can you leave me for a while...please."</p>');
		startQuestions();
		if (checkPersonFlag("Lauren", 3)) addLinkToPlace(md, "go to the guest room", 290, "", "", "", "", "moveblock");
		addLinkToPlace(md, "exit the house", 16)
	} else if (stype == "nohelp") {
		perVamp.showPerson("vamp9s.jpg");
		addPlaceTitle(md, "Sarah and her Vampyre");
		perSarah.other = 116;
		perSarah.setFlag(8);
		md.write("<p>You tell Sarah that the idea of controlling a vampyre is distateful to you and she should do her best to get her slave under her control. You promise to help her in any way you can, but not to the extent of taking the vampyre from Sarah.</p>" + "<p>TSarah looks disappointed,</p>" + '<p>"It is the taks of my family to guard against these creatures, I will just have to lean to control Lilith here better. I wish you had of take her, but so be it!"</p>');
		startQuestions();
		addLinkToPlaceC(md, "speak to Sarah", 192)
	}
	WritePlaceFooter(md, "", true, true)
}

function ShowPlace300(stype) {
	var md = WritePlaceHeader(false, "td-left-large");
	var bMan = perYou.isMaleSex();
	var perJK = findPerson("JanetKelly");
	var myName = perJK.getYourNameFor();
	var herName = perJK.getPersonName();
	var clv = perJK.getCharmedLevel();
	var hJ = "";
	if (clv == 2) hJ = "your lover ";
	else if (clv == 3) hJ = "your bimbo ";
	else if (clv == 4) hJ = "your slave ";
	else if (clv == 5) hJ = "your pet ";
	if (stype == "bj") {
		if (bMan) {
			perJK.showPersonRorX("janet9.jpg");
			addPlaceTitle(md, "Sex on the Stairs");
			md.write("<p>You tell " + herName + " to use her mouth to pleasure you. She expertly takes your length into her mouth and you do not take long to release into her mouth. She swallows and lies back and says, ");
			if (clv == 3) md.write('"Like totally thanks ' + myName + '".</p>');
			else md.write('"I love you ' + myName + '".</p>')
		} else {
			perJK.showPerson("janet9.jpg");
			addPlaceTitle(md, "Sex on the Stairs");
			md.write("<p>You tell " + herName + " to use her tongue to pleasure you and she does and she also starts to play with herself. To your delight and surprise she is an expert at pleasuring women and she makes you reach the peak of ecstasy quickly. After she lies back and says, ");
			if (clv == 3) md.write('"Neat!".</p>');
			else md.write('"I love you".</p>')
		}
		startQuestions()
	} else if (stype ==
		"fuck") {
		if (bMan) {
			perJK.showPersonRorX("janet10.jpg");
			addPlaceTitle(md, "Sex on the Stairs");
			md.write("<p>You happily agree to take her and you sink you manhood into her delightful pussy, ramming into her over and over. You feel her shudder in her release and that is the final straw and you pour your passion into her depths.")
		} else {
			perJK.showPerson("janet10.jpg");
			addPlaceTitle(md, "Sex on the Stairs");
			md.write("<p>You decide to explore " + herName + "'s body as you make each other experience peak after peak.")
		}
		if (clv ==
			3) md.write(' Afterwards Janet says "Like wow!".</p>');
		else md.write(' Afterwards Janet kisses you and says "Love you..."</p>');
		startQuestions()
	} else {
		perJK.showPerson("janet8.jpg");
		addPlaceTitle(md, herName + " on the Stairs");
		md.write("<p>Janet begins leading you up the stairs, getting more and more excited with every step.</p>");
		if (clv == 3) md.write('<p>"Uh...  I forget where it is again..." she says, throwing her clothes off as she speaks.  "Just take me here, ' + perYou.getMaster() + ', please!" she moans.</p>');
		else md.write('<p>"Lets just do it here!" she says, throwing her clothes off as she speaks.  "Just take me here, ' + perYou.getMaster() + ', please!" she moans.</p>');
		startQuestions();
		if (stype === "")
			if (bMan) {
				addLinkToPlace(md, "fuck her", 300, "type=fuck");
				addLinkToPlace(md, "fuck her mouth", 300, "type=bj")
			} else {
				addLinkToPlace(md, "have her lick you", 300, "type=bj");
				addLinkToPlace(md, "make love to her", 300, "type=fuck")
			}
	}
	addLinkToPlace(md, "go downstairs", 112);
	addLinkToPlace(md, "exit the house?", 44);
	WritePlaceFooter(md)
}

function ShowPlace302(stype) {
	var md = WritePlaceHeader();
	var perG = findPerson("Gina");
	var clv = perG.getCharmedLevel();
	if (stype == "locked") {
		showPopupWindow("Gina", "<img src='Images/door3.jpg' style='width:25%;float:right;margin-left:5px' alt='Gina's House'>" + "There is no answer at the door, there does not seem to be anyone at home. You are no burglar so there is no way in.", "gotoPlace(229)");
		WritePlaceFooter(md, "", true);
		return
	} else if (stype == "visitor1") {
		if (isExplicit()) perG.showPersonRandomRorX("gina28",
			3);
		else perG.showPersonRandom("gina28", 2, "50vw");
		addPlaceTitle(md, "Gina has a visitor");
		if (perYou.isMaleSex()) md.write('<p>You become aware in Gina\'s body and you feel a strange sensation a fullness you have never felt before. You feel yourself bouncing and look down, you are naked and you see Gina is impaled on a large cock, riding the man on top. As you hesitate, he firmly grabs your hips and starts thrusting from below, and you hear him say, "Hey babe, not now I am close"</p>' + "<p>You also feel a strong sense of arousal, and a tension that you are also very close to something as well...</p>");
		else md.write('<p>You become aware in Gina\'s body and you are unmistakably being fucked, riding a man on top, his large cock thrusting into you. You hesitate in surprise, and he firmly grabs your hips and starts thrusting from below, and you hear him say, "Hey babe, not now I am close"</p>' + "<p>You also feel a strong sense of arousal, and you know you are close to your orgasm as well...</p>");
		startQuestions();
		addLinkToPlaceC(md, "well...while he is here...", 302, "type=visitor2");
		addLinkToPlaceC(md,
			"stop! make and excuse and get him out", 302, "type=visitorkickout")
	} else if (stype == "visitor2") {
		if (isExplicit()) perG.showPersonX("gina26bb.jpg");
		else perG.showPerson("gina28c.jpg", "50vw");
		addPlaceTitle(md, "Gina has a visitor");
		if (perYou.isMaleSex()) md.write("<p>What the hell, he is here and fucking you are you are really close. You start to awkwardly ride him but he makes up for it from below.</p>" + '<p>A few minutes later your body convulses in an intense orgasm, and you hear him call out "Ahh, take it, take my load" as you feel another strange sensation as he cums in you.</p>');
		else md.write("<p>What the hell, he is here and fucking you are you are really close. You start to ride him but he makes up for it from below.</p>" + '<p>A few minutes later your body convulses in an intense orgasm, and you hear him call out "Ahh, take it, take my load" as you feel him cum in you.</p>');
		md.write('<p>The guy quickly kisses you, and says, "I gotta run, message me again when you have time off and feeling horney!". He quickly dresses and leaves you.</p>');
		startQuestions();
		addLinkToPlaceC(md,
			"get dressed", 302, "type=")
	} else {
		var myName = "";
		if (perG.place == 302)
			if (isPossess("Gina")) perG.showPerson("gina9.jpg");
			else if (clv > 0) {
			perG.showPerson("gina20.jpg");
			myName = perYou.getMaster()
		} else if (perG.other < 10) {
			perG.showPerson("gina7a.jpg");
			myName = "young " + perYou.getManWoman()
		} else {
			perG.showPerson("gina7.jpg");
			myName = "young " + perYou.getManWoman()
		} else perG.showPerson("gina9.jpg");
		addPlaceTitle(md, "2138 Rathdown Rd");
		if (stype == "visitorkickout") md.write("<p>You make some excuse about feeling ill and kick the guy out of Gina's house and body.<br>");
		else md.write("<p>Gina, the Museum Guard, calls this place home.  She seems to have made a pretty good life for herself here. <br> Of course it helps that she doesn't have any family or children to tie her down.<br>");
		if (perG.place == 302 && !isPossess("Gina"))
			if (clv === 0)
				if (isInvisible()) md.write("<p>Gina looks around, evidently very confused by the fact that you just <i>disappeared</i> right in front of her.</p>" + '<p>You hear her whisper under her breath.  "What the..."</p>');
				else {
					md.write("<p>Gina looks up at you as you enter, evidently quite surprised to have a visitor.</p>" +
						'<p>"Excuse me, ' + myName + '," she says flatly.  "What do you think you\'re doing here?"</p>');
					if (checkPlaceFlag("GinasHouse", 5)) md.write('<p>"I told you last time," she says forcefully.  <b>"Get. Out."</b></p>')
				}
		else if (isInvisible()) md.write('<p>"But ' + myName + '," she asks with a look of confusion on her face as you disappear.  "Where did you go?  How can I serve you if I can not <i>see</i> you?"</p>');
		else md.write("<p>Gina looks up at you, a flash of lust and desire crossing her face.</p>" + '<p>"Hello ' +
			myName + '," she says with a hungry voice.  "Is there <i>anything</i> I can do for you?"</p>');
		else if (!isPossess("Gina")) md.write("<p>There doesn't seem to be anyone home at the moment.</p>");
		else if (perG.extra[1] == 1) {
			md.write("<p>You are in the living room of Gina&apos;s home, for some reason you feel cold.</p>");
			if (!checkPlaceFlag("GinasHouse", 4)) md.write("<p>Through an open door you see a bed with some clothes and a cell phone, flashing with a message.</p>")
		} else md.write("<pYou are in the living room of Gina&apos;s home</p>");
		startQuestions();
		if (perG.place == 302)
			if (!isPossess() && clv > 0) {
				addLinkToPlaceC(md, '"Prove your gratitude again, Slave."', 315);
				addSleepLink(md, "go to bed for the night with Gina", "Sleeping with Gina", '<p style="position:absolute;left:45%;bottom:2em;cursor:pointer;font-size:1.1em;width:50%">You tell you large breasted slave that you will be spending the night here tonight. Gina leads you to her bedroom, making no reply, aside from once you arrive stripping most of her clothes and positioning herself on the bed, ready for you.',
					perG.getImg("gina29.jpg"), true)
			}
		addLinkToPlace(md, "go to the bathroom", 303);
		if (!isPossess()) addLinkToPlace(md, "leave the house", 229);
		else if (perG.extra[1] == 1)
			if (!checkPlaceFlag("GinasHouse", 4)) addQuestionR(md, "check the message", "You see the message is from an id Biker1 and it is just saying that they are running late and will be another half an hour.", "Gina", "setPlaceFlag(\\'GinasHouse\\', 4, true);")
	}
	WritePlaceFooter(md)
}

function ShowPlace303(stype) {
	var md = WritePlaceHeader(false, stype == "mirror4" && isExplicit() || stype == "mirror6" && !isExplicit() ? "td-left-med" : "");
	var perG = findPerson("Gina");
	var bNoShow = false;
	if (perG.place == 302 && !isPossess() && !perG.isCharmedBy()) {
		showPopupWindow("Gina", "<img src='Images/" + perG.getImg("gina7a.jpg") + "' class='imgpopup' alt='Gina'>" + '"Excuse me?" she says, blocking your way.  "You can\'t just barge in here and poke around!  Get out of my house!"', "gotoPlace(229)");
		setPlaceFlag("GinasHouse",
			5);
		WritePlaceFooter(md, "", bNoShow);
		return
	}
	if (stype == "mirror") {
		perG.showPerson("gina27.jpg");
		addPlaceTitle(md, "Gina's Bathroom Mirror");
		md.write("<p>In the mirror you see Gina, or actually yourself possessing Gina. You are wearing a bathtowel and it appears nothing else. Gina&apos;s large breasts are keeping the towel from falling or is it that the towel is barely containing them?");
		if (perYou.isBornMale()) md.write(" Being a large breasted blonde woman is a very strange experience for you, to say the least!");
		md.write("</p>");
		setPlaceFlag("GinasHouse", 3);
		bNoShow = true;
		startQuestions();
		addLinkToPlace(md, "look closer", 303, "type=mirror1");
		addLinkToPlace(md, "look away", 303, "type=")
	} else if (stype == "mirror1") {
		perG.showPerson("ginashower1.jpg");
		addPlaceTitle(md, "Gina's Bathroom Mirror");
		md.write("<p>You look fascinated and see out of the corner of your eye there is a full length mirror nearby and you hear the shower is running. You look in the mirror and see Gina, or is it you?</p>");
		bNoShow = true;
		startQuestions();
		addLinkToPlace(md, "well... while you are here", 303, "type=mirror2");
		addLinkToPlace(md, "No, no get back what you were here for", 303, "type=")
	} else if (stype == "mirror2") {
		perG.showPersonRandom("ginashower2", 2);
		addPlaceTitle(md, "Gina's Bathroom Mirror");
		md.write("<p>You step into the shower and lean against the glass wall, pressing Gina's...your breasts against the glass wall. In the mirror you can see the lovely sight.</p>");
		bNoShow = true;
		startQuestions();
		addLinkToPlace(md, "...she was just about to have a shower...",
			303, "type=mirror3");
		addLinkToPlace(md, "No, no get back what you were here for", 303, "type=")
	} else if (stype == "mirror3") {
		perG.showPerson("ginashower3.jpg");
		addPlaceTitle(md, "Gina's Bathroom Mirror");
		md.write("<p>You feel the shower on your body and start to rub your body with hands and soap. You start to feel very aroused, especially when you touch your large breasts.</p>");
		bNoShow = true;
		startQuestions();
		addLinkToPlace(md, "you have to explore more...", 303, "type=mirror4");
		addLinkToPlace(md, "No, no get back what you were here for",
			303, "type=")
	} else if (stype == "mirror4") {
		perG.showPersonRorX("ginashower4.jpg");
		addPlaceTitle(md, "Gina's Bathroom Mirror");
		md.write("<p>You touch your pussy, well Gina's, and feel a surge of arousal. quickly feeling close to your first orgasm in her body...</p>");
		bNoShow = true;
		startQuestions();
		addLinkToPlace(md, "...what is that over there...", 303, "type=mirror5");
		addLinkToPlace(md, "No, no get back what you were here for", 303, "type=")
	} else if (stype == "mirror5") {
		perG.showPerson("ginashower5.jpg");
		addPlaceTitle(md,
			"Gina's Bathroom Mirror");
		md.write("<p>You see a dildo sitting on a shelf nearby, ready for use...</p>");
		bNoShow = true;
		startQuestions();
		addLinkToPlace(md, "...well Gina uses it...", 303, "type=mirror6");
		addLinkToPlace(md, "No, no get back what you were here for", 303, "type=")
	} else if (stype == "mirror6") {
		perG.showPersonRorX("ginashower6.jpg");
		addPlaceTitle(md, "Gina's Bathroom Mirror");
		md.write("<p>You play with the dildo for a little, but very quickly ");
		if (perYou.isBornMale()) md.write(" come to your first powerful orgasm as a woman!");
		else md.write(" orgasm in Gina's body, it feels wonderful, similar but different!");
		md.write(".</p>");
		bNoShow = true;
		startQuestions();
		addLinkToPlace(md, "...ummm...", 303, "type=mirror7")
	} else if (stype == "mirror7") {
		perG.showPerson("ginashower7.jpg");
		addPlaceTitle(md, "Gina's Bathroom Mirror");
		md.write("<p>You look at Gina in the mirror in the afterglow of your orgasm, vowing to try this again sometime...</p>");
		bNoShow = true;
		startQuestions();
		addLinkToPlace(md, "Enough for now, get back to what you were here for",
			303, "type=")
	} else {
		if (sType === "ginabath") {
			perG.showPersonRandom("gina-bath", 3);
			addPlaceTitle(md, "Gina's Bath")
		} else addPlaceTitle(md, "Gina's Bathroom", "bath1.jpg");
		if (sType === "ginabath") md.write("<p>Gina is bathing, well playing in the bath for your pleasure.</p>");
		else md.write("<p>A nice, well kept, and clean bathroom.  Did you expect anything less from someone like Gina?</p>");
		if (!checkPlaceFlag("GinasHouse", 7)) md.write("<p>One of the drawers beside the sink seems to be jammed shut - quite out of place in such an immaculate room.</p>");
		else md.write("<p>The drawer now sits open...</p>");
		if (whereItem(34) == 303) md.write("<p>You notice a small lock of blonde hair caught up in one of the brushes within the drawer.</p>");
		if (checkPlaceFlag("GinasHouse", 6)) md.write("<p>You notice a small stone in the drawer... where <i>do</i> these things come from, you can't help but wonder.</p>");
		if (isPossess("Gina"))
			if (perG.extra[1] == 1) {
				md.write("<p></p>You are in the living room of Gina&apos;s home, for some reason you feel cold.</p>");
				if (!checkPlaceFlag("GinasHouse",
						3)) md.write("<p>A shower is running nearby and you catch a glimpse of yourself, or should you say Gina in a mirror...</p>")
			}
		startQuestions();
		if (isPossess("Gina")) {
			if (perYourBody.FindItem(43) > 0) addQuestionC(md, "remove the heirloom and hide it so Gina won't be able to find it", "Misc", 30300);
			if (perG.extra[1] == 1 && !checkPlaceFlag("GinasHouse", 3)) addLinkToPlace(md, "look in the mirror", 303, "type=mirror")
		}
		if (checkPlaceFlag("GinasHouse", 6)) addQuestionC(md, "pick up the stone", "Misc", 1506);
		if (perG.isCharmed() &&
			perG.place == 302 && sType !== "ginabath") addLinkToPlaceC(md, "ask Gina to join you in the bathroom", Place, "type=ginabath", "Gina joins you, quickly stripping and staring to run a hot bath. As the tub fills she plays with the shower-head and other bathing accessories for your entertainment.");
		addLinkToPlace(md, "leave the bathroom", 302, "", sType == "ginabath" ? "Gina dries off and follows you in a few minutes" : "")
	}
	WritePlaceFooter(md, "", bNoShow)
}

function ShowPlace304() {
	var md = WritePlaceHeader();
	var perG = findPerson("Gina");
	var myName = perYou.getMaster();
	if (perG.isCharmedBy() && perG.place === 0 && !isPossess("Gina")) perG.showPerson("gina12.jpg");
	else {
		setPlaceFlag("Museum", 8);
		perG.showPerson("gina5.jpg")
	}
	addPlaceTitle(md, "Museum Security Room");
	md.write('<p>Normally, this would be one of those places that would be more than a little "off limits".</p>');
	if (isPossess("Gina")) md.write("<p>Being able to <i>possess</i> people and make them do anything you want does have its privileges...</p>");
	else if (checkPlaceFlag("Museum", 8) || perG.isCharmedBy()) md.write("<p>Being able to <i>enslave</i> people and have them willingly do anything you want does have its privileges...</p>");
	if (perG.place === 0 && !isPossess() && perG.isCharmedBy()) md.write('<p>Your Slave, Gina, quickly begins to remove her clothing as you enter the room. "Hello ' + myName + '," she says, her voice dripping with desire and submission.  "How can I ever thank you enough for enslaving me?  You have made my life complete.  I only hope that I may somehow be able to repay your kindness."</p>');
	if (whereItem(42) == 303) md.write("<p>Evidently Gina left a note for the Mayor on the security desk.</p><br>");
	startQuestions();
	if (perG.isCharmedBy() && perG.place === 0 && !isPossess()) addLinkToPlaceC(md, '"Show me your gratitude again, Slave."', 315);
	addLinkToPlace(md, "leave the room", 239);
	WritePlaceFooter(md)
}

function ShowPlace311() {
	var md = WritePlaceHeader();
	var perGina = findPerson("Gina");
	if (!isArrestPossible())
		if (getPersonOther("Diane") === 0)
			if (wherePerson("AdeleRoss") == 436 || wherePerson("AdeleRoss") >= 900) setPersonOther("Diane", 30);
	if (perGina.place === 0) perGina.showPerson("gina1b.jpg");
	else perGina.showPerson("gina22.jpg");
	addPlaceTitle(md, "Gina Under a Spell");
	if (perGina.place === 0) md.write('<p>"What did you say?" she asks authoritatively, leaving her hands on her gun for the moment.</p>');
	else md.write('<p>"I\'m sorry, what was that?" she asks, suddenly finding herself very attracted to the ' +
		perYou.getManWoman() + " standing before her - her hand unconsciously sneaking up to her face flirtatiously.</p>");
	md.write('<p>"Oh... nothing," you lie, buying time for the spell to set in.  "I just said \'look at you\' is all."</p>' + '<p>"Look at me?" she asks, confused.  "Wha... What do you mean?"</p>' + '<p>"Oh, it\'s just that I was admiring how strong and independent you seem to be.  I imagine that must make you a very attractive woman, for some people."</p>' + '<p>"Yes," she says authoritatively. "Strong.  Independent.  Yes, I vowed as a young woman to never let myself be taken advantage of when people thought that just because I was a woman, that made me weak."</p>' +
		'<p>"Thats right.  And a strong, independent woman only does what <i>she</i> wants, doesn\'t she?" you ask, beginning to lead her down the path to her enslavement.</p>' + '<p>"Correct...  Yes..." she says, her body beginning to visibly quiver with desire.</p>' + '<p>"So... if someone were to tell you to do something, you would only do it if you <i>wanted</i> to, right?"</p>' + '<p>"Of course... only if I wanted to."</p>');
	startQuestions();
	addLinkToPlaceC(md, '"Show me what you have on under those clothes, then."',
		312);
	WritePlaceFooter(md)
}

function ShowPlace312() {
	var md = WritePlaceHeader();
	var perG = findPerson("Gina");
	if (perG.place === 0) perG.showPerson("gina2.jpg");
	else perG.showPerson("gina23.jpg");
	addPlaceTitle(md, "Gina Under a Spell");
	md.write("<p>Without thinking, and driven by the desire welling up within her, Gina immediately " + "begins to reveal what she's wearing underneath her clothing.</p>" + '<p>"Now.  Why are you doing that Gina?  Why are you doing what I told you to do?"</p>' + '<p>"Be... Because I wanted to.  I am a strong, independent woman and I only do what I ' + 'want to do?" she says, although this time finishing the statement as a question, as if ' +
		"already seeking your approval.</p>" + '<p>"We\'ll see," you say.  "But if you <i>wanted</i> to do that, then what does that ' + 'mean about me?  Why would you be stripping just for me?"</p>' + '<p>"Uhmm..." she says, confused, then her expression changes as she finally finds a ' + 'target for her blooming desire.  "Because I am trying to seduce you," she finally gets out.</p>' + '<p>"Seduce me?" you ask. "Well, you would be much more effective at that if you didn\'t ' + "tell me you were trying first.  Besides, I don't think you're trying to seduce me.  At least " +
		'not very hard," you say somewhat derisively.  "I\'m not really even attracted to you."</p>' + '<p>She is somewhat taken aback.  From her looks, you would guess she has never been told that before.  "Not attracted...  Why not?  What should I do, what <i>are</i> you attracted to?" she whimpers.</p>' + '<p>"I go more for the submissive type... the type that does what she is told <i>because</i> she ' + 'is told to do it."</p>' + '<p>"Tell me what to do!" she cries.  "I have to have you!"</p>');
	startQuestions();
	if (perG.place === 0) addLinkToPlaceC(md, '"Well, why don\'t you play with yourself for me."', 313);
	else addLinkToPlaceC(md, '"Well, why don\'t you take off your pants, turn around, and show me that ass of yours."', 313);
	WritePlaceFooter(md)
}

function ShowPlace313() {
	var md = WritePlaceHeader();
	var perG = findPerson("Gina");
	if (perG.place === 0) perG.showPerson("gina3.jpg");
	else perG.showPerson("gina24.jpg");
	addPlaceTitle(md, "Gina Under a Spell");
	md.write("<p>Gina quickly does as you ordered - ");
	if (perG.place === 0) md.write(" unbuttoning her trousers and sliding her hand down. The sudden onset of pleasure is amplified by the spell and she quickly begins to moan.</p>");
	else md.write(" pushing her pants to the floor and then turning to give you a better view.  You run your hands across her soft flesh, quickly drawing out moans of passion as the spell amplifies the pleasure of your touch.</p>");
	md.write('<p>"That\'s better," you say, running your eyes up and down her form as if inspecting a slab of meat. "But now I\'m afraid I am a bit confused."</p>' + '<p>"Con... con...  confused?" she tries say, stuttering as her mind and body are racked with wave after wave of pleasure as she continues to follow your order.</p>' + '<p>"Yes.  I thought you said that you were a strong, independent woman who only did things that she wanted to do." you say, smacking her on the ass as you do. ' + '"But now its looks more like you\'re a weak, submissive woman who will do anything she is told to do. - Something I find very attractive, by the way," you say, knowing how much you are teasing her mind with the idea that she is pleasing you.</p>' +
		'<p>"So which is it?" you ask as you walk circles around her.  "The strong woman that I find completely unattractive - or the submissive slave that is crying out for a ' + perYou.getMaster() + '?"');
	startQuestions();
	addLinkToPlace(md, "wait for her to reply", 314);
	WritePlaceFooter(md)
}

function ShowPlace314() {
	var md = WritePlaceHeader();
	var perG = findPerson("Gina");
	if (perG.place === 0) perG.showPerson("gina4.jpg");
	else perG.showPerson("gina25.jpg");
	var myName = perYou.getMaster();
	addPlaceTitle(md, "Gina Under a Spell");
	md.write('<p>"Oh, the submissive slave!" she says, turning to face you between shudders of pleasure.</p>' + '<p>"The slave?" you ask. "But what happened to the strong woman from before?"</p>' + '<p>"That was all an act!" she cries out in desperation.  "I\'ve always been a submissive woman, ' +
		"looking for someone to tell me what to do.  But I didn't know who I could trust.  I had to protect myself.\"</p>" + "<p>\"Well then...  If you've always been a slave, then who is your " + myName + ' then?"</p>' + "<p>\"I don't have a " + myName + '," she says, almost breaking down in tears. ' + '"Wait! Would you be my ' + myName + '? Oh please!?!"</p>' + '<p>"I don\'t know," you say, pretending to consider the offer.  "You were lying before, how can I trust ' + 'you now?  What could you possibly do for me as my slave?"</p>' +
		'<p>"I swear I will serve you faithfully and truthfully.  Please!  Ask anything of me and I will do it! ' + "I would live to serve you, to be anything you wanted me to be.  Your guard, your slave, your slut, your " + "plaything.  I am whatever you want me to be!  Please, I can not be a slave without a " + myName + '!" she cries.  It almost makes you feel sorry for her.  Almost.</p>' + '<p>"Fine then, <i>Slave</i>, come and pleasure your ' + myName + '," you say forcefully.');
	if (perYou.isMaleSex()) md.write('"Prove your devotion to your new ' +
		myName + ' as you suck my cock and swallow every drop!"</p>');
	else md.write('"Prove your devotion to your new ' + myName + ' as you drink every last drop from my wet slit!"</p>');
	startQuestions();
	if (perG.place === 0) {
		addLinkToPlace(md, "let her finish, then speak with Gina some more", 304);
		addLinkToPlace(md, "leave the Museum", 238)
	} else {
		addLinkToPlace(md, "let her finish, then speak with Gina some more", 302);
		addLinkToPlace(md, "leave the house", 229)
	}
	WritePlaceFooter(md)
}

function ShowPlace315(stype) {
	var md = WritePlaceHeader(false, stype != "play" && stype !== "" && isExplicit() ? "td-left-med" : "");
	var perG = findPerson("Gina");
	var bMuseum = perG.place === 0;
	if (stype == "play")
		if (perG.place === 0) perG.showPersonRorX("gina11a.jpg");
		else perG.showPersonRorX("gina11b.jpg");
	else if (isExplicit() && stype !== "")
		if (bMuseum)
			if (perYou.isMaleSex())
				if (stype == "bj") perG.showPersonRandomX("gina10b", 2);
				else perG.showPersonRandomX("gina12b", 2);
	else if (stype == "bj") perG.showPersonX("gina10ga.jpg");
	else perG.showPersonX("gina10gb.jpg");
	else if (perYou.isMaleSex())
		if (stype == "sixtynine") perG.showPersonX("gina26ba.jpg");
		else if (stype == "fuck") perG.showPersonX("gina26bb.jpg");
	else perG.showPersonX("gina26bc.jpg");
	else perG.showPersonX("gina26g.jpg");
	else if (bMuseum) perG.showPerson("gina10.jpg");
	else perG.showPerson("gina26.jpg");
	addPlaceTitle(md, "Slave Gina Showing her Gratitude");
	var myName = perYou.getMaster();
	if (stype === "") {
		md.write('<p>"Oh yes!" she cries, instantly removing her clothing, and carefully assisting ' + 'in the removal of yours. "How shall I please you today, ' +
			myName + '?" she asks as she lies back in her chair, displaying her naked body just the way you like it.</p>');
		if (perYou.isMaleSex()) md.write('<p>"Shall I swallow your cum again, ' + myName + '?  I so love the taste of it."</p>' + '<p>"Or would you like to take me from behind as I lean over the chair?  That always reminds me that I am not a real person, but a slave, an object for your use... and I <i>love</i> being reminded of that," she says, beginning to work herself into a fit.</p>');
		else {
			md.write('<p>"Shall I drink of your juices once more, ' +
				myName + '?  I so love the way you taste!"</p>');
			if (perG.place === 0) md.write('<p>"Or shall we lay on the floor and use a double ended dildo, the thought of you fucking yourself on this poor worthless slave is almost more than I can stand," she says,  beginning to work herself into a fit.</p>')
		}
		md.write("<p>Or shall I simply run my hands all over the body of my " + myName + ', worshiping every inch as if it was my sole purpose in life?  Which it is," she says smiling.</p>' + "<p>You think of your options for a while,</p>")
	} else if (stype ==
		"fuck")
		if (perYou.isMaleSex()) md.write("<p>You fuck Gina</p>" + "<p></p>");
		else md.write("<p>You fuck Gina with the dildo</p>" + "<p></p>");
	else if (stype == "bj")
		if (perYou.isMaleSex()) md.write("<p>Gian gives you a blowjob</p>" + "<p></p>");
		else md.write("<p>Gina licks you</p>" + "<p></p>");
	else if (stype == "sixtynine") md.write("<p>Eagerly Gina removes what little she is wearing and then almost rips your clothing off in her desire to obey you. She almost forcefully pushes you down and straddles your chest. You feel her hot, moist mouth envelope your hardening cock. She pushes her equally moist pussy towards your face.</p>" +
		"<p>You firmly reassert your control as you slap her ass and tell her to take your cock as deeply as she can. You grab her ass and start to lick her dripping folds. As you do she takes your cock deeper and deeper with long practised skill.</p>" + "<p>Gina is very talented and it does not take long before you are cumming hard down your slaves throat. As you do you feel a splash of her juices and see her pussy pulsing in her orgasm.</p>" + '<p>You both redress and Gina looks at you, "Thank you ' + perYou.getMaster() +
		'!"</p>');
	else if (stype == "play")
		if (bMuseum) md.write("<p>Gina steps off of the desk and starts to play with herself, making a big show of her large breasts. She is mainly playing for your attention, and not focusing much on her pleaure.</p>" + '<p>Still, her passion grows, you can see it in her nipples, her moistness and her breathing. She looks at you "' + perYou.getMaster() + ' are you ready for me to cum?". You tell her "Yes, cum for me slave".</p>');
		else md.write("<p>Gina quickly removes what little she is wearing and sits on the couch and intently plays with her pussy and breasts. She seems to be less playing for your entertainment than to arouse herself.</p>" +
			'<p>She quickly reaches the edge of her climax and she looks at you "Can I cum for you, and only you?". You see no reason to deny your big-breasted slave and tell her to cum. She cries out "' + perYou.getMaster() + '" and has a strong orgasm.</p>');
	startQuestions();
	if (bMuseum) {
		if (stype === "") {
			if (perYou.isMaleSex()) {
				addLinkToPlaceC(md, '"I will take you"', 315, "type=fuck");
				addLinkToPlaceC(md, '"swallow my cum"', 315, "type=bj")
			} else {
				addLinkToPlaceC(md, '"get the dildo"', 315, "type=fuck");
				addLinkToPlaceC(md, '"drink my juices"',
					315, "type=bj")
			}
			addLinkToPlaceC(md, '"play with yourself"', 315, "type=play")
		}
		addLinkToPlace(md, "let her finish, then speak with Gina some more", 304);
		addLinkToPlace(md, "leave the Museum", 238)
	} else {
		if (stype === "") {
			if (perYou.isMaleSex()) {
				addLinkToPlaceC(md, '"We will sixty-nine"', 315, "type=sixtynine");
				addLinkToPlaceC(md, '"I will take you"', 315, "type=fuck");
				addLinkToPlaceC(md, '"swallow my cum"', 315, "type=bj")
			} else addLinkToPlaceC(md, '"drink my juices"', 315, "type=bj");
			addLinkToPlaceC(md, '"play with yourself"',
				315, "type=play")
		}
		addLinkToPlace(md, "let her finish, then speak with Gina some more", 302);
		addLinkToPlace(md, "leave the house", 229)
	}
	WritePlaceFooter(md)
}

function ShowPlace317() {
	var md = WritePlaceHeader();
	var perDesiree = findPerson("Desiree");
	var perMS = findPerson("Daria");
	if (perDesiree.getQuestRelic() == 35 && perDesiree.place === 332 && !perMS.checkFlag(4)) perMS.setFlag(4);
	addPlaceTitle(md, "Lady of Our Heavenly Father", "church1.jpg", 100);
	if (perDesiree.isCharmedBy() && perMS.isCharmedBy() && isCharmedBy("Pamela")) md.write("<p>The Lady of our Heavenly Father. An effective name for the church now, as you have it under your powers. Daria and Desiree are serving a new religion; yours. The two priestess swore themselves to you. Pamela, the caretaker of your church is your trustworthy servant too. Not much has changed as how the church looks like since you seized power of it. Instead the mentality of the nuns became more fanatic, but now they worship you as their leader.</p>" + "<p>You know there is a small nunnery attached to the church with a typical set of cloisters. There are not many nuns around, Daria mentioned that there only a handful of them remained.</p>");
	else md.write("<p>Towering before you is the stone edifice of the Lady of Our Heavenly Father, one of the least-known yet most powerful branches of the Catholic Church to be found within the region. " + "Its arches seem to be staring out over the land as if it was designed to watch over something...or watch <i>for</i> it.</p>" + "<p>Who knows...  Perhaps it was.</p>" + "<p>You know there is a small nunnery attached to the church with a typical set of cloisters. There are not very many nuns here, or at least that is what you have heard, as you have never seen one.</p>");
	startQuestions();
	addOptionLink(md, "enter the church", "EnterChurch(318);");
	addLinkToPlace(md, "walk around the outer wall", 320);
	md.write("<br>");
	WritePlaceFooter(md)
}

function ShowPlace318(stype) {
	var md = WritePlaceHeader();
	if (stype == "stopped") {
		var s = "";
		switch (getQueryParam("from")) {
			case "chalice":
				s = "<p>As you try to pick up the chalice you are interrupted by a voice,</p>" + "<p>\"And just what do you think you're doing, young " + perYou.getManWoman() + '.  That is church property!  Would you like me to call the Police?" she demands, wrenching the chalice from your hands. "I suggest you leave!"</p>';
				break;
			case "15102":
				s = "You walk towards the archway that leaves towards the churches courtyard, but you are interrupted by a voice and you see s strong willed older woman appears before you wagging her finger as if to wield a sword against you.</p>" +
					'<p>"And just where do you think <i>you\'re</i> going?" she asks.  "You have no business other than here in this place of God."</p>';
				break;
			case "15103":
				s = "You see some stairs leading into a cellar or something and walk towards them, but you are interrupted by a voice and you see s strong willed older woman appears before you wagging her finger as if to wield a sword against you.</p>" + '<p>"And just where do you think <i>you\'re</i> going?" she asks.  "You have no business other than here in this place of God."</p>';
				break;
			case "15104":
				s = "You see an archway leading into the churches cloisters and decide to explore, but you are interrupted by a voice and you see s strong willed older woman appears before you wagging her finger as if to wield a sword against you.</p>" + '<p>"And just where do you think <i>you\'re</i> going?" she asks.  "You have no business other than here in this place of God."</p>';
				break
		}
		showPopupWindow("Mother Superior", "<img src='Images/mothersuperior1c.jpg' class='imgpopup' alt='Mother Superior'>" +
			s + "You recognise her as the Mother Superior, a figure of great power and authority, the Nun in charge of all the nuns here at this Church, and this particular person is a one of a kind woman. You can\u2019t really tell her age due to the clothes she\u2019s wearing hides 90 percent of her face and body. If you would have to guess though, she is around her late thirties or early forties. You know that she\u2019s been the head of the local church for years now, but faith was never your thing so you always avoided this place.<br><br>" +
			"Apart from her title, you don\u2019t even know her real name! She\u2019s wearing the traditional nun\u2019s uniform and she always wear a rosary or amulet around her neck. Though she\u2019s mysterious and strong willed and would be extremely tough to crack her you cannot take your mind off her!<br><br>" + "Imagine; a loyal devotee through religion and a stalwart warrior to your cause. She could be your lieutenant or officer in your harem who would issue discipline and order between your girls while you are busy.");
		setQueryParams()
	}
	addPlaceTitle(md, "Lady of Our Heavenly Father", "church2.jpg");
	if (isCharmedBy("Desiree") && isCharmedBy("Daria") && isCharmedBy("Pamela")) md.write("<p>For all of its visible magnificence the church still seems almost completely empty. No visitors, no nuns to come across with. That\u2019s Daria\u2019s work as she dedicated this whole building to you and only you. She closed the gates to tourists, locals and anyone else who wanted to visit the church. Gone are Sunday\u2019s masses or religious visitors who wish to pray. The church proper is completely yours to explore or just sit down and enjoy the silence and the place\u2019s aura.</p>" +
		"<p>The immaculate sanctuary of your very own church where Mother Superior spends her time praying to you every hour. Your other household slaves, Pamela and Desiree come here often to join her daily routine.</p>");
	else md.write("<p>The immaculate sanctuary of the church.  The wooden pews are intricately carved and the stained glass windows present bright images that almost seem to come alive and step out before you.</p><p>For all of its visible magnificence the church still seems almost completely deserted; almost as if there were only ghosts left to care for such an amazing building.</p>");
	if ((checkPlaceFlag("Church", 5) || checkPlaceFlag("Church", 7)) && !isPossess("Daria") && !checkPersonFlag("Daria", 4))
		if (!isInvisible()) md.write("<p>You see Mother Superior glaring at you from the far corner of the room, her gaze virtually burning a hole in your chest.  You aren't going to get anywhere as long as she is watching.</p>");
		else md.write("<p>You see Mother Superior sitting in the far corner of the room, she is scanning the church for any impudent souls, like you...</p>");
	startQuestions();
	if (isInvisible() ||
		isPossess() || checkPersonFlag("Daria", 4) || checkPersonFlag("Daria", 4)) {
		addLinkToPlace(md, "go to the church courtyard", 319);
		addLinkToPlace(md, "walk down the stairs in the back", 321);
		addLinkToPlace(md, "walk down the hall to the cloisters", 406, "", isInvisible() ? "Your invisibility fades as you cross the archway..." : "")
	} else {
		var id = checkPlaceFlag("Church", 7) ? -1 : 1;
		addQuestionCO(md, "go to the church courtyard", "Daria", id * 15102);
		addQuestionCO(md, "walk down the stairs in the back", "Daria", id * 15103);
		addQuestionCO(md,
			"walk down the hall to the cloisters", "Daria", id * 15104)
	}
	if (!isPossess()) addLinkToPlace(md, "leave the church", 317);
	if ((checkPlaceFlag("Church", 5) || checkPlaceFlag("Church", 7)) && !isPossess("Daria") && !checkPersonFlag("Daria", 4)) {
		AddPeopleColumnMed(md);
		findPerson("Daria").showPerson(isInvisible() ? "mothersuperior1b.jpg" : "mothersuperior1a.jpg")
	}
	WritePlaceFooter(md)
}

function ShowPlace319() {
	var md = WritePlaceHeader();
	setPlaceKnown("ChurchCourtyard");
	var perDesiree = findPerson("Desiree");
	addPlaceTitle(md, "Church Courtyard", "church3.jpg");
	md.write("<p>The inner courtyard of the Lady of our Heavenly Father.  It is almost unbelievable, the vista that lies before you.  Beautiful fountains, sculptures and even a large hedge maze all lie within a short walk.  Surprisingly there are not many people moving around such a large area, giving you the feeling of privacy even out in the open air.</p>" +
		"<p>A lovely fountain of crisp clear water bubbles away near the west wall of the courtyard.</p>");
	if (perDesiree.place === 332)
		if (perDesiree.isCharmedBy()) md.write("<p>Your Disciple, Desiree, stands near the bushes in further contemplation of the temptations of the flesh...  especially <i>your</i> flesh.</p>");
		else if (perDesiree.other === 0) md.write("<p>Near a maze you can see one of the Sisters, evidently lost in prayer - presumably some esoteric and or spiritual tribulation that is just <i>consuming</i> her soul...</p>");
	else md.write("<p>You can see Sister Desiree standing near the hedge maze, still lost in her thoughts.</p>");
	if (perDesiree.place == 1E3) md.write('<p><i>Normally you would find your "disciple" Desiree here, but you sent her off in search of something and she has not yet returned.  Perhaps you should find something to keep you busy.</i></p>');
	else if (perDesiree.place == 384) md.write("<p>You heard the Mother Superior tell Sister Desiree to follow her, so she is very likely with her now.</p>");
	startQuestions();
	if (perDesiree.place === 332)
		if (perDesiree.isCharmedBy() && !isPossess()) addLinkToPlace(md, "minister to your faithful Disciple", 332);
		else if (perDesiree.other === 0) addLinkToPlace(md, "approach the good Sister", 332);
	else addLinkToPlace(md, "approach Sister Desiree", 332);
	addLinkToPlace(md, "enter the cloisters", 406);
	addLinkToPlace(md, "walk back into the Church proper", 318);
	if (isPlaceKnown("ChurchSecretDoor") && !isPossess()) addLinkToPlace(md, "walk out the secret door through the wall", 320);
	WritePlaceFooter(md)
}

function ShowPlace320() {
	var md = WritePlaceHeader();
	var perPamela = findPerson("Pamela");
	addPlaceTitle(md, "Church Outer Wall", "church8.jpg");
	md.write("<p>The walls of the church go on for some time, almost endless.  The inner courtyard and cloisters must be quite large to require a wall this long.</p>");
	if (!perPamela.checkFlag(1)) {
		md.write("<p>You notice a small building in the distance, it must be the groundskeeper's shed.");
		if (!isDay()) md.write(" There are no lights on, no-one seems to be home.");
		md.write("</p>")
	} else if (perPamela.isCharmedBy()) md.write("<p>You can see movement in the shed. You see a face in the window. Pamela has seen you.</p>");
	else if (isDay()) md.write("<p>You can see movement in the shed.</p>");
	else md.write("<p>There are no lights on, no-one seems to be home.</p>");
	startQuestions();
	if (isDay() || perPamela.isCharmedBy())
		if (!perPamela.isCharmedBy() && !perPamela.checkFlag(1)) addLinkToPlace(md, "approach the would-be gardener", 326);
		else addLinkToPlace(md, "walk up and see what Pamela is up to", 326);
	addLinkToPlace(md, "walk back to the Church entrance", 317);
	WritePlaceFooter(md)
}

function ShowPlace321() {
	var md = WritePlaceHeader();
	addPlaceTitle(md, "Church Stores", "church4.jpg");
	md.write("<p>The basement floor beneath the church.  This is where the church keeps all of their supplies for the services and maintenance of the church.</p>");
	startQuestions();
	addLinkToPlace(md, "walk up the stairs", 318);
	addLinkToPlace(md, "enter the Catacombs", 322);
	WritePlaceFooter(md)
}

function GiveSkullFromCatacomb() {
	if (perYourBody.NoItems == perYourBody.MaxItems && perYourBody.FindItem(57) === 0) WriteComments("You don't have enough room to carry any more items.  Make room and try again.");
	else {
		if (perYourBody.FindItem(57) === 0) perYourBody.PutItem(57, true);
		perKurndorf.setFlag(3);
		WriteComments("<p>You pick up a skull from one of the recesses, feeling a bit creeped out, but you now have a skull.</p>");
		dispPlace()
	}
}

function ShowPlace322() {
	var md = WritePlaceHeader();
	addPlaceTitle(md, "Catacombs", "catacombs2.jpg");
	md.write("<p>A maze of tunnels that haven't seen much use in over a century lie before you.</p>" + "<p>Everywhere you walk, you leave a footprint in the dust collecting on the floor.</p>");
	startQuestions();
	if (!isPossess() && perKurndorf.getQuestGhost() >= 100 && perKurndorf.getQuestRitual() < 200 && !perKurndorf.checkFlag(3)) addOptionLink(md, "Search for a skull to use for the ritual", "GiveSkullFromCatacomb()");
	addLinkToPlace(md,
		"go back to the church stores", 321);
	if (isPlaceKnown("ChurchTunnel") && !isPossess()) addLinkToPlace(md, "slip into the church tunnel", 323);
	WritePlaceFooter(md)
}

function ShowPlace323() {
	var md = WritePlaceHeader();
	addPlaceTitle(md, "Catacomb Tunnel", "church10.jpg");
	md.write("<p>A long tunnel that reaches from the city graveyard all the way to the catacombs beneath the Lady of our Heavenly Father.  How the church managed to build this tunnel with no one being the wiser is a mystery.</p>");
	startQuestions();
	addLinkToPlace(md, "walk to the church catacombs", 322);
	addLinkToPlace(md, "exit the tunnel into the mausoleum", 324);
	WritePlaceFooter(md)
}

function ShowPlace324() {
	var md = WritePlaceHeader();
	if (nFromPlace == 323) setPlaceKnown("Graveyard");
	addPlaceTitle(md, "Mausoleum", isPlaceKnown("Graveyard") && !checkPlaceFlag("Graveyard", 6) ? "mausoleum2.jpg" : "mausoleum.jpg");
	md.write("<p>Presumably intended for the internment of a relatively famous person in the town's history, the actual occupant of this mausoleum has passed into the annals of history.</p>");
	if (isPlaceKnown("ChurchTunnel")) md.write("<p>Now, and presumably for some time, it serves as the hiding place of a tunnel that leads to the catacombs beneath an old Church.</p>");
	else md.write("<p>The crypt inside has seen better days, most of the decorations having been destroyed many years ago.  Even the stone coffin has fallen apart, the bodies inside presumably moved long ago - or lost to the elements.</p>");
	if (!checkPlaceFlag("Graveyard", 6)) md.write("<p>The doors of the crypt are locked and rusted through.  It would seem they have not been opened in many, many years.</p>");
	else md.write("<p>The aged, rusty iron doors of the crypt stand open - but still not quite inviting, if you know what I mean.  You take a peek inside but there's not much to see.  Seems to have been fairly well ransacked some time ago and evidently there are no living relatives around to clean the place up.  Too bad.</p>");
	startQuestions();
	if (isPlaceKnown("ChurchTunnel")) addOptionLink(md, "enter the secret tunnel to the church", "EnterChurch(323);");
	if (isPlaceKnown("Graveyard") || checkPlaceFlag("Graveyard", 6)) addLinkToPlace(md, "walk through the graveyard", 325);
	WritePlaceFooter(md)
}

function ShowPlace325(stype) {
	var md = WritePlaceHeader(false, stype == "fuck" ? "td-left-large" : "");
	var perLea = findPerson("Leanne");
	if (perLea.isHere() && perJesse.getDemonPath() >= 50) perLea.charmThem(4, "Demon");
	var bDemonCharm = perLea.isCharmedBy("Demon");
	if (stype == "talk") {
		perLea.setFlag(4);
		perLea.showPerson("leanne3b.jpg");
		addPlaceTitle(md, "Leanne at the Graveyard");
		md.write("<p>You approach Leanne and she looks at you sadly. Without a word you place an arm around her shoulders. After a little while you speak words of sympathy and comfort as best as you can. Leanna smiles in a slightly strained way and in a slightly broken voice,</p>" +
			'<p>"Sorry, it is just I keep hearing strange rumours, Louise said she saw a ghost the other day, and I heard someone saw weird shapes in the park and an unearthly scream like a banshee. It got me to thinking about death and the dead..."</p>' + "<p>You try to reassure her, but she continues,</p>" + "<p>\"You know my father's, great-grandfather, or was it great-great-grandfather...I can never remember this ancestry stuff...he was in the coven, a servant of that warlock Kurndorf. My mother's ancestors were even there too, but in a less...corrupt way...as..servants.. This talk of ghosts and banshee makes me think of these and my family...\"</p>" +
			"<p>You try to change the topic of the conversation, it is too close to what is going on for comfort, and Leanna tells you,</p>" + "<p>\"It's alright, when I am finished here I think I will go and seek God's guidance, the Mother will help as always.\"</p>" + "<p>You talk a little more with her, nothing of import, just to try to help her if you can. After a little while you part company with your friend.</p>");
		startQuestions();
		addLinkToPlace(md, "walk through the Graveyard", 325)
	} else if (stype == "fuck") {
		perLea.setFlag(5);
		if (perYou.isMaleSex()) perLea.showPerson("leanne5b.jpg");
		else perLea.showPerson("leanne5g.jpg");
		addPlaceTitle(md, "Thrall at the Graveyard");
		md.write("<p>You tell yourself that this is not your friend Leanne, it is her body, but this is a thrall of the demon Legion, not Leanne. You keep telling yourself that as you approach her.</p>" + "<p>You are rather confused and disturbed, you do not know if your friend is like this permanently, but you have always felt attracted to her, not that you would ever of considered doing anything before this. As you hesitate you see Leanne...the thrall smile and gesture for you to approach.</p>" +
			"<p>You step onto the stony wall or is it a decaying scarcophagus, and kneel awkwardly on part of Leanne's dress. You smell a faint hint of sulphur and look uncertainly at the thrall. She reaches up and undoes your pants, and then " + (perYou.isMaleSex() ? "strokes your hardening cock" : "rubs your moistening pussy") + ' and says "You want this body, take it"</p>' + "<p>Your hesitation evaporates, though not all your discomfort and you push the thrall down and ");
		if (perYou.isMaleSex()) md.write("sink your hard cock into her hot and very wet pussy. She lewdly moans and rakes her fingernails over your back. You pound your cock into her, fucking her with wild abandon, this is just your lust for Leanne..the thrall, a being driven by lust. You feel you climax rapidly approaching and the thrall painfully digs her nails into your back and you feel her orgasm, strong pulsations of her pussy and you grunt as you cum, unloading your lust and balls deeply into her.</p>");
		else md.write("straddle her face. She eagerly and skillfully licks your pussy lips and clit. You are aware she is masturbating herself but this is about lust and about the thrall satisfying your lust for Leanne..the thrall, a being driven by lust. Your orgasm builds quickly and irresistibly, and your scream of passion echoes through the graveyard. You slump and then see her pussy as she lowers it onto your face. You reach up to lick and at the touch of your tongue the thrall lewdly moans and you see her pussy intensely orgasm, pulsing with small squirts of unnaturally hot liquid.</p>");
		md.write('<p>Awkwardly and a little embarrassed you climb off her and redress. She looks at you "Desire remains, always"</p>');
		startQuestions();
		addLinkToPlace(md, "walk through the Graveyard", 325)
	} else {
		if (perLea.isHere() && bDemonCharm && !perLea.checkFlag(3)) perLea.showPerson("leanne4a.jpg");
		else if (perLea.isHere() && bDemonCharm) perLea.showPerson("leanne4b.jpg");
		else if (perLea.isHere() && !perLea.checkFlag(2)) perLea.showPerson("leanne3a.jpg");
		else addPlaceImage(md, "graveyard.jpg", "", "", "Graveyard");
		addPlaceTitle(md,
			"Graveyard");
		md.write("<p>The large graveyard of the city.  Many of the graves are so old and broken down that they must have been from the original settlers of the city before it was <i>rebuilt</i>.</p>" + "<p>There are any number of graves of different types, including more than a few mausoleums of people whose families were rich enough to not force their loved ones to endure interment <i>within</i> the earth, but rather above it.</p>");
		if (perLea.isHere())
			if (bDemonCharm)
				if (!perLea.checkFlag(3)) {
					perYou.startQuest(5);
					perLea.setFlag(3);
					md.write("<p>You see Leanne is still here, leaning against a wall. She seems to have had a problem with her clothes, her belt must have broken or the lower part ripped. You approach her to offer some assistance and she looks at you, a smile on her face. You are about to talk to her and you see her eyes, blank like the Demon Legion's thralls. Did the demon take your friend, turning her into a soul-less being of pure desire, with no free-will a puppet of the demon? As you look at her in horror, she speaks, her voice still that of Leanne but different, more sensual,</p>" +
						"<p>\"Mistress told this thrall to wait here but not for you. This one once here wanted you but would not take you, some pointless things called 'friendship' and 'family'. Mistress took that. Now this thrall waits for one of the brides to come here and submit to <b>her</b>. They come here, sneaking though a secret way, when they want to escape that place and the laws they must follow.\"</p>" + "<p>She looks at you, and you call for Leanne to resist the demons influence");
					if (perYourBody.FindItem(32) >
						0) md.write(", and try the silver ring but it fails to do anything");
					md.write(". Leanne, or is it the thrall, replies,</p>" + '<p>"Quiet, all of that one is gone, Mistress has her to devour when it is time to <i>leave</i>."</p>' + "<p>The thrall, you can no longer call her Leanne, looks at you hungrily,</p>" + '<p>"Desire remains and this thrall has time, this body is yours"</p>' + "<p>The thrall removes the rest of Leannes clothing and lies down on them, waiting for you.</p>")
				} else md.write("<p>You see the thrall in Leanne's body lying on her clothes, naked and waiting sensuously, for you, or for her prey.</p>");
		else if (!perLea.checkFlag(2)) {
			md.write("<p>You see Leanne near a ruined mausoleum, or maybe it is a disused part of the old church. She is walking thoughtfully towards her family graves, where her parents are buried and those of several generations of her kin. She has not noticed you yet.</p><p>You feel sad for your friend, she regularly visits the graves, probably too often but she takes some comfort here.</p>");
			perLea.setFlag(2)
		} else if (perLea.checkFlag(4)) md.write("<p>You see Leanne is still here visiting her families graves, you cannot think of a reason to interrupt her again.</p>");
		else md.write("<p>You see Leanne is still here visiting her families graves.</p>");
		startQuestions();
		if (perLea.isHere())
			if (bDemonCharm) addLinkToPlace(md, "take the thrall", 325, "type=fuck");
			else if (!perLea.checkFlag(4)) addLinkToPlaceC(md, "talk to Leanne", 325, "type=talk")
	}
	addLinkToPlace(md, "walk to the Broken Inn Hotel", 123);
	if (isPlaceKnown("Mausoleum")) addLinkToPlace(md, "inspect the Mausoleum", 324);
	if (perLea.isHere() && !perLea.shown) {
		AddPeopleColumnLarge();
		if (bDemonCharm) perLea.showPerson("leanne4b.jpg");
		else perLea.showPerson("leanne3b.jpg")
	}
	WritePlaceFooter(md)
}

function ShowPlace326() {
	var md = WritePlaceHeader();
	var perPamela = findPerson("Pamela");
	var bCharmed = perPamela.isCharmedBy();
	var myName = perPamela.getYourNameFor();
	var perSister = findPerson("Desiree");
	if (perSister.getQuestRelic() == 35 && perSister.place === 332 && !checkPersonFlag("Daria", 4)) setPersonFlag("Daria", 4);
	if (!bCharmed) perPamela.showPerson("pamela1.jpg");
	else if (!isDay()) perPamela.showPerson("pamela7c.jpg");
	else perPamela.showPerson(perPamela.checkFlag(8) ? "pamela7b.jpg" : "pamela7a.jpg");
	addPlaceTitle(md,
		"Pamela - the Church Groundskeeper");
	if (bCharmed) {
		md.write("<p>Your Slave Pamela sees you as you approach.  Your very presence seems to bring a blush to her cheeks as she raises her shirt, displaying herself for your viewing pleasure.</p>");
		if (!isPlaceKnown("ChurchSecretDoor") && checkPlaceFlag("Church", 7) && bCharmed) md.write('<p>"Would you like me to show you into the courtyard, ' + myName + '?" she asks, oh-so-willing to do that and... well... anything else you would like.</p>')
	} else if (!perPamela.checkFlag(1)) md.write("<p>You see what must be the church grounds keeper taking a break inside the shed.  She notices you as you approach and smiles warmly in your direction.</p>");
	else md.write("<p>You see Pamela working tidying up her tools.  She notices you as you approach and smiles warmly in your direction.</p>");
	if (perSister.getQuestRelic() == 35 && wherePerson("Desiree") === 332) {
		md.write('<p>"Oh, ' + myName + '!  Did you hear about the Mother Superior?" she asks, concerned.  "She has quite suddenly taken very ill.');
		if (bCharmed) md.write(" I mentioned that I knew of a great healer, but the others didn't seem interested,\" she says, sounding quite disappointed that she wasn't able to help.</p>");
		else md.write('"</p>')
	}
	startQuestions();
	if (isPlaceKnown("ChurchSecretDoor")) addOptionLink(md, "enter the church courtyard", "EnterChurch(319);");
	addLinkToPlace(md, "walk to the church entrance", 317);
	WritePlaceFooter(md)
}

function ShowPlace327(stype) {
	var md;
	var perPamela = findPerson("Pamela");
	if (stype === "curepamela") {
		md = WritePlaceHeader();
		if (!isDay()) perPamela.showPerson("pamela6c.jpg");
		else perPamela.showPerson(perPamela.checkFlag(8) ? "pamela6b.jpg" : "pamela6a.jpg");
		addPlaceTitle(md, "Curing Slave Pamela Again");
		md.write('<p>Your Slave smiles up at you as desire flashes across her face.  "Well, ' + perPamela.getYourNameFor() + ', I did feel a flush of heat when you approached."</p>' + '<p>"I thought as much," you say. "Perhaps we have not yet completely driven the disease out of your system."</p>' +
			'<p>She stretches out along the bench, pulling open her butt cheeks for easy access. "Would you like to <i>treat</i> me once again, ' + perPamela.getYourNameFor() + "?  I can feel myself become more and more <i>yours</i> every time, " + perPamela.getYourNameFor() + '.  And I love it," she says, desire and fulfillment dripping off of her as much as the smell of sex.</p>' + '<p>"Please take me, ' + perPamela.getYourNameFor() + '," she begs.  "I want every ounce of me to be <i>yours</i>!"</p>' + "<p>Who wouldn't be excited by that kind of devotion...  especially if it translated into her lovemakeing - as it does... <i>every</i> time.</p>");
		startQuestions();
		if (perYou.isMaleSex()) {
			addLinkToPlace(md, "take her as she begs", 327, "type=pamelafuck");
			if (isExplicit(true)) addLinkToPlace(md, "take her mouth", 327, "type=pamelabj")
		} else {
			addLinkToPlace(md, "ask her to lick you", 327, "type=pamelabj");
			addLinkToPlace(md, "make love to her", 327, "type=pamelafuck")
		}
		addLinkToPlace(md, "talk to Pamela some more", 326);
		WritePlaceFooter(md)
	} else {
		if (stype == "pamelabj") {
			md = WritePlaceHeader(false, "td-left-med");
			if (perYou.isMaleSex()) {
				perPamela.showPersonRandomX("pamela8b",
					2);
				addPlaceTitle(md, "Curing Slave Pamela Again");
				md.write('<p>You tell Pamela to use her mouth to pleasure you. She skillfully takes your length into her mouth  and you do not take long to release into her mouth. She swallows and lies back and says, "Thank you ' + perPamela.getYourNameFor() + '".</p>')
			} else {
				perPamela.showPersonRorX("pamela8g.jpg");
				addPlaceTitle(md, "Curing Slave Pamela Again");
				md.write('<p>You tell Pamela to use her tongue to pleasure you and while she is not very experienced she does have some skill she makes you reach the peak of ecstasy quickly. After she lies back and says, "Thank you!".</p>')
			}
		} else if (stype ==
			"pamelafuck") {
			md = WritePlaceHeader(false, "td-left-med");
			if (perYou.isMaleSex()) {
				perPamela.showPersonRorX("pamela9b.jpg");
				addPlaceTitle(md, "Curing Slave Pamela Again");
				md.write("<p>You readily agree to take her and you sink you manhood into her delightful pussy, ramming into her over and over. You feel her shudder in her release and that is the final straw and you pour your passion into her depths.</p>")
			} else {
				perPamela.showPerson("pamela9g.jpg");
				addPlaceTitle(md, "Curing Slave Pamela Again");
				md.write("<p>You readily agree and explore her body and after a while climb into place so she can lick you as you lick her. She is somewhat tentative but seems to have some experience and with some pointer she is able to make you reach your climax, and then you ensure she also reaches her peak.</p>")
			}
		} else if (stype ==
			"pamelanecklace") {
			md = WritePlaceHeader();
			perPamela.showPerson("pamela10.jpg", "", "", "", "", true);
			addPlaceTitle(md, "Pamela's Necklace");
			md.write("<p>You ask her about her necklace, and she explains,</p>" + '<p>"The necklace was a gift from my mother, she said it is ancient. It can be made into a pair of bracelets or a necklace"</p>');
			if (perYourBody.PutItem(46, true)) {
				AddMana(5);
				md.write("<p>She takes the necklace off and separates the necklace quickly forming the bracelets. She put one on her wrist and the other she slides on yours and she tenderly kisses your hand. You feel a small surge of magic and she continues,</p>" +
					'<p>"Now we are linked, heart to heart, soul to soul"</p>' + "<p>While poetic you have no idea what this actually means, you will have to research this.</p>");
				perPamela.setFlag(8)
			} else {
				AddMana(5);
				md.write("<p>She takes the necklace off intending to give you it, but you just cannot manage to carry anything else. You should ask her again when you can carry more.</p>")
			}
		}
		if (!perPamela.checkFlag(8)) {
			md.write("<p>You notice the necklace she is wearing and you can feel a hint of magic from it.</p>");
			startQuestions();
			addLinkToPlaceC(md, "Ask about her necklace", 327, "type=pamelanecklace")
		} else startQuestions();
		addLinkToPlace(md, "talk to Pamela some more", 326);
		WritePlaceFooter(md)
	}
}

function Exit332() {
	var perSister = findPerson("Desiree");
	if (perSister.other < 5) perSister.other = 5
}

function ShowPlace332(stype) {
	var md = WritePlaceHeader(false, stype == "discipline" ? "td-none" : "");
	var perSister = findPerson("Desiree");
	var perMS = findPerson("Daria");
	if (perSister.other == 10) perSister.other = 9;
	if (perSister.place !== 332) return dispPlace(319);
	var bThereIsStuffHere = perSister.NoItems > 0;
	if (isPossess()) perSister.showPerson("sister2.jpg");
	else if (perSister.isCharmedBy()) perSister.showPerson("sister9.jpg");
	else perSister.showPerson("sister1.jpg");
	if (perSister.isCharmedBy()) {
		addPlaceTitle(md, "Desiree - Disciple of Desire");
		if (isPossess()) md.write('<p>You can hear your disciple Desiree quickly putting her habit back on as you approach.  "Yes Mother Superior?" she asks, unable to completely mask the sound of the pleasure still coursing through her body.</p>');
		else {
			if (perSister.getQuestRelic() == 20) md.write("<p>Desiree sees you approach, the look on her face one of pure anguish.  You have a sinking suspicion that she could not find the relic.</p>");
			else if (perSister.getQuestRelic() == 35 || perSister.getQuestRelic() == 36) md.write("<p>As you approach you can see Desiree playing with herself and moaning in pleasure.  You smile with satisfaction at what her pleasure must mean.</p>");
			else md.write("<p>Your disciple's robes part the moment she sees that her Angel has returned.  Her crucifix is glistening wetly. \"Hello, " + perYou.getMaster() + '," she croons.  "What do you desire of me?"</p>');
			md.write("<p> You're not sure why but you can't help but pause for a moment, almost taken aback by the strength of her faith in you.  Of course, you know its all just the spell, but she seems to have taken it to such a level that it's almost...  palpable.  Impressive.  Even for you.</p>")
		}
		if (!isPossess() &&
			bThereIsStuffHere) md.write('<p>You notice a few things hidden under a bush.  "Oh yes, my Angel, Mother Superior quite unexpectedly entrusted a few things to my care.  Of course you may take them if you wish, they are rightfully yours after all."</p>')
	} else {
		addPlaceTitle(md, "The Good Sister");
		if (perSister.other < 5) {
			md.write("<p>In this corner of the garden, near the hedge maze, a lovely nun stands in prayer.  She stops when she sees you, evidently surprised to see anyone other than her sisters and the Mother Superior.</p>" +
				'"Hello," she says uncertainly.  "Are you lost?  This area is typically off-limits to outsiders');
			if (perYou.isBornMale()) md.write(", particularly men");
			md.write('."</p>' + '<p>"My name is ' + perYou.getPersonName() + '," you say.  "What\'s yours?"</p>' + '<p>"I am Sister Desiree," she says, then frowns.  "But I do not see why-"</p>' + '<p>"The Mother Superior sent me back here to speak with you," you interrupt, lying smoothly.</p>' + '<p>"Oh," she says, visibly relaxing.  "Then how can I be of service?"</p>')
		} else md.write("<p>In this corner of the garden, near the hedge maze, the lovely Sister Desiree stands in prayer.  She stops when she sees you, evidently surprised to see anyone other than her sisters and the Mother Superior.</p>" +
			'<p>"Good morrow, ' + perYou.getPersonName() + '," the beautiful Sister greets you pleasantly, if a little formally.</p>')
	}
	startQuestions();
	if (perSister.isCharmedBy() && !isPossess()) {
		addLinkToPlaceC(md, '"Recite your scripture once more, my Disciple"', 332, "type=recite");
		if (perSister.getQuestRelic() >= 5) {
			if (perSister.getQuestRelic() < 10) addQuestionC(md, '"Tell me where the relic is, Desiree."', "Desiree", 18309);
			else if (perSister.getQuestRelic() == 20) addQuestionC(md, '"Did you fail me, my Disciple?"', "Desiree",
				18320);
			else if (perSister.getQuestRelic() == 35 && perSister.getQuestRelic() == 36) addQuestionC(md, '"I believe you have something for me."', "Desiree", 18335);
			if (bThereIsStuffHere) addQuestionC(md, "take the items Mother Superior left", "Desiree", 137)
		}
		addSleepLink(md, "take Desiree to her cell for the night", "Cloistered with Sister Desiree", '<p style="position:absolute;left:2%;top:10%;cursor:pointer;font-size:1.1em;width:90%">You take Desiree back her her cell and join her for the night. She worships you and your body until you both fall into an exhausted sleep.<br><br>In the morning you see her lying next to you almost like an angel!.',
			perSister.getImg("sister-bed.jpg"), true)
	} else if (!isPossess()) {
		addLinkToPlace(md, "request absolution for your sins", 332, "type=absolution", "", "", "Exit332()");
		if (bThereIsStuffHere && !perSister.checkFlag(7)) addQuestionC(md, '"Did Mother Superior Give you anything?"', "Desiree", 136)
	} else if (isPossess("Daria"))
		if (perMS.NoItems > 0) addQuestionCO(md, "Give Desiree what you are carrying.", "Desiree", 1368);
	addLinkToPlace(md, "leave her be", 319, "", "", "", "Exit332()");
	WritePlaceFooter(md, "", !bThereIsStuffHere)
}

function ShowPlace334() {
	var md = WritePlaceHeader();
	findPerson("Desiree");
	if (per.other === 0) per.other = 5;
	per.setFlag(13, false);
	setPersonFlagAfterTime("Tracy", 5, true, 36);
	per.showPerson("sister3.jpg");
	addPlaceTitle(md, "A Crisis of Faith");
	md.write("<p>The sister is lost in prayer and does not hear the words of your spell.  All the same, you see the telltale " + "glow in her eyes and you feel the mana coiling out to draw her under.  Remembering the firm will of the Mother " + "Superior, you decide to proceed cautiously; a nun might be able to resist this devilish power.</p>" +
		'<p>"Sister," you say.  "I actually came here today to offer you counsel.  Even from without the building I felt ' + "the wavering of a troubled soul, and felt called to seek it out.  Tell me, Sister.  Are you the one I have sought? " + 'Have you been feeling doubts in your heart?"</p>' + "<p>Desiree is dumbstruck for a moment at your declaration.  You maintain your look of concern, but inwardly you laugh. " + "Your lie has confused her, and in her moments of confusion the spell is opening her to you, making her more pliable.</p>" +
		'<p>"Are you... you are some manner of holy ' + perYou.getManWoman() + "? " + 'You do not look it, but... I cannot deny you speak the truth.  I have felt doubts, and... base desires."</p>');
	startQuestions();
	addLinkToPlaceC(md, '"Tell me of these desires, Desiree.  I only wish to help you."', 335);
	WritePlaceFooter(md)
}

function ShowPlace335() {
	var md = WritePlaceHeader();
	var perSister = findPerson("Desiree");
	perSister.showPerson("sister4.jpg");
	addPlaceTitle(md, "A Crisis of Faith");
	md.write("<p>The Sister does not seem to notice that you have called her by name, informally. " + 'She says, "I dream, sometimes.  I dream of... illicit relations with a ' + perYou.getManWoman() + " and wake in a hot sweat with a... sinful wetness upon my bed.  I... Mother Superior tells me that these feelings will pass, " + 'but I... I..." ' + '<p>"A ' +
		perYou.getManWoman() + ', you say?" you ask, honestly interested.  "Tell me, Desiree: Does ' + "this " + perYou.getManWoman() + ' look like me?"</p>' + '<p>"A little, I suppose," she says.</p>' + '<p>"She has already been having the dreams," you mutter to yourself, inwardly enjoying the ' + 'hell out of this ruse.  "But is she ready for her destiny?"</p>' + '<p>"Destiny?" she squeaks.  "What are you talking about?"</p>' + '<p>"You know that Sisters do not display their bodies for pleasure.  It is taboo," you say, and she nods.  "Now, for the holy ' +
		"outsider who knows your deepest heart, for the " + perYou.getManWoman() + " whose body you have already " + 'felt in dreams.  Break this taboo."</p>' + "<p>At first, she tries to resist, her hand hesitating over the folds of her holy vestments.  Her eyes meet yours, and she gulps " + "and pulls up, now revealing shin, now thigh, and at last the lacy covering for her untarnished maidenhood.</p>");
	startQuestions();
	addLinkToPlaceC(md, 'Demand, "More"', 336);
	WritePlaceFooter(md)
}

function ShowPlace336() {
	var md = WritePlaceHeader();
	var perSister = findPerson("Desiree");
	perSister.showPerson("sister5.jpg");
	addPlaceTitle(md, "A <i>New</i> Faith");
	md.write('<p>Now the upper portion of her vestments part for you, revealing her perfect breasts.  "I..." she stammers. ' + '"It is taboo.  I will be-"</p>' + '<p>"Fear not," you say.  "I only needed to know that you were ready to make a leap of faith before I told you ' + "the truth: I am the Lord's Angel of Desire.  I have come to deliver the scripture.\"</p>" +
		"<p>The worry melts away from Sister Desiree's face.  It all makes sense, now: no wonder she feels such joy at " + "your nearness, if you are an angel.  No wonder she has felt arousal, even as a nun, when dreaming of your coming. " + '"What is this scripture?" she asks eagerly.  "Tell me!"</p>' + '<p>"This scripture is not told," you say.  "It is <i>felt</i>."</p>' + '<p>"Then...how do I learn the scripture?" she asks, her breathing coming a little heavier now in anticipation ' + "of your answer.</p>");
	startQuestions();
	addLinkToPlaceC(md, '"Feel my holy Word within you."', 337);
	WritePlaceFooter(md)
}

function ShowPlace337() {
	var md = WritePlaceHeader();
	var perSister = findPerson("Desiree");
	perSister.showPerson("sister6.jpg");
	addPlaceTitle(md, "A <i>New</i> Faith");
	md.write("<p>Completely taken in by your deception, Desiree opens herself to your spell's power " + "and lets out a contented sigh as it heightens her desires, fills her with pleasure at " + "your nearness, erases her few rebellious thoughts.</p>" + "<p>She parts her robes entirely and fondles herself, no longer caring about or even seeing her surroundings. " + '"Oh, bliss!" she cries, when she has momentarily sated herself.  "Please, if you are an angel then ' +
		"" + perYou.getMaster() + " cannot truly be your name.  What am I to call you, now " + 'that I know what you are?"</p>' + '<p>"Just call me ' + perYou.getMaster() + '," you laugh.  "Everyone else does. ' + 'Now, I must remind you of a teaching of your Mother Superior."</p>' + '<p>"Yes, ' + perYou.getMaster() + '?"</p>' + '<p>"It is not enough to know the scripture in your heart," you say with an evil grin.</p>');
	startQuestions();
	addLinkToPlaceC(md, '"You must put it to work in the world."', 338);
	WritePlaceFooter(md)
}

function ShowPlace338() {
	var md = WritePlaceHeader();
	var perSister = findPerson("Desiree");
	perSister.showPerson("sister7.jpg");
	addPlaceTitle(md, "Sister Desiree Under a Spell");
	md.write('<p>Desiree trembles so hard at your words that she collapses.  "All is well," she assures you, ' + 'fondling herself.  "I am merely preparing myself for your coming, ' + perYou.getMaster() + '." ' + "<p>As she says, by the time you lay a hand on her there are slick drops rolling bead-to-bead down her rosary.</p>" + "<p>It is astonishing how skilled she seems.  Her hands and tongue seem to seek out just the perfect spot without effort. " +
		"She is obviously a virgin, which leaves you to wonder if perhaps those dreams of hers were truly prophetic.  Perhaps she " + "truly has been practicing in her sleep every night, just for you.</p>" + '<p>"Desiree," you say, when you and she lay exhausted just within the hedge-maze.  "You must spread the Word."</p>' + '<p>"I understand, ' + perYou.getMaster() + '," she says breathlessly.  "This is my destiny. ' + 'I will do all I can for you."</p>');
	startQuestions();
	addLinkToPlace(md, "Clean up and exit the hedge maze",
		319);
	WritePlaceFooter(md)
}

function ShowPlace339() {
	if (perKurndorf.getQuestGhost() == 999) return dispPlace(997);
	var perJessica = findPerson("Jessica");
	var b2Cols = perJessica.place === 193 || perJessica.place === 161 || perKurndorf.getQuestGhost() == 30 || perKurndorf.getQuestGhost() == 25;
	var md = WritePlaceHeader(false, b2Cols ? "td-left-small" : "td-left", "black");
	if (perJesse.getDemonPath() > 0 && perJesse.getDemonPath() < 10) md.write('<img src="Images/demon1.jpg" alt="Demon" style="width:25%;margin:5px 5px" alt="Demon">');
	if (perKurndorf.getQuestGhost() > 0)
		if (perJesse.getDemonPath() >
			0 && perJesse.getDemonPath() < 10) md.write('<img src="Images/kurndorf.jpg" alt="Ghost" style="float:right;width:60%;margin:5px 5px" alt="Kurndorf">');
	if (perKurndorf.getQuestSeance() < 50) perJesse.showPerson("jesse1a.jpg", "", "", "", "Jesse");
	else if (perKurndorf.getQuestSeance() >= 70) perJesse.showPerson("jesse2.jpg", "", "", "", "Jesse");
	else perJesse.showPerson("jesse2a.jpg", "", "", "", "Jesse");
	addPlaceTitle(md, "S\u00e9ance of Carl Kurndorf");
	if (perKurndorf.getQuestGhost() <= 15) {
		if (perKurndorf.getQuestSeance() < 50) md.write('<p>"As you wish," she says."</p>' +
			"<p>Jessica begins to prepare for the S\u00e9ance, following the instructions you gleaned from your research.</p>" + "<p>The three of you form a circle and hold hands within the magical prison.</p>" + '<p>The Witch looks at you, apparently genuine concern in her voice. "Ready?  Once we begin we must finish or there will be grave consequences..." she says, letting the warning lie in the silence.</p>');
		else if (perKurndorf.getQuestSeance() == 50) md.write("<p>The Witch begins to chant, power rising around the three of you.  A quick glance at Jesse, your naive guest, reveals that the power seems to be flowing through her - leaving her quite unaware of what is happening around her.  Her eyes quickly begin to glaze over from the magical onslaught.</p>" +
			"<p>Within moments a ghostly form begins to appear within the circle.  Carl Kurndorf has graced you with his presence.</p>");
		else if (perKurndorf.getQuestGhost() == 15) md.write("<p>Kurndorf begins to chant something in a language that almost pulses with power, it is certainly a spoken form of the language the Book is written in.  You can feel the fear rising up within Jessica even as she stands frozen within the circle.</p>");
		else if (perKurndorf.getQuestSeance() > 50) md.write("<p>The spirit of Carl Kurndorf hovers in the room before you...  Who knows what power such a creature has, even in death.</p>");
		else if (perKurndorf.getQuestGhost() == 10) md.write('<p>"What!?!" Kurndorf yells in anger.  "How?  How have you stopped me?" he rails.');
		md.write('<img src="Images/' + (perKurndorf.getQuestGhost() == 15 ? "kurndorf-red" : "kurndorf") + '.jpg" alt="Ghost" style="display:block;width:30%;margin-left:auto;margin-right:auto;margin-top:-1em;margin-bottom:0.5em" alt="Kurndorf">')
	} else if (perKurndorf.getQuestGhost() == 20) md.write('<p>"That was me calling in a favor..." Kurndorf says smiling.</p>' + "<p>Kurndorf laughs as a dark energy swirls within the room.  The hair on the back of your neck begins to rise as you hear an alien laughing noise invade the room.</p>" +
		"<p>Within moments there is a 5th presence in the room, and a demon begins to flit around the room making lewd suggestions about different body parts among those present.</p>" + '<p>"Settle Down!" Kurndorf yells. "And take <i>care</i> of that <i>witch</i>!!"</p>' + "<p>The demon hisses its displeasure at being told what to do and then begins assailing the walls of the magickal prison binding the room.  Within moments you feel something <i>break</i>. You hear Jessica gasp.</p>" + '<p>Satisfied, the demon turns its attention to the <i>innocent</i> in the circle.  "Yes..." it hisses in pleasure. "This one will be sooo tasty..." It picks up speed, swirling around the young woman faster and faster.</p>');
	else if (perKurndorf.getQuestGhost() == 25) {
		md.write('<p>"Noo!" Kurndorf bellows as the demon\'s spirit enters the young woman, her eyes beginning to glow red with presence of the demon within.</p>' + '<p>"You will <i>OBEY</i> me!" he yells, pumping his fists towards the demon.</p>' + "<p>Terrified, Jesse screams for help, but you can only watch powerlessly as the demon dives into her mouth. Her scream is cut off mid breath, and the fear in her eyes slowly fades, to be replaced by a horrible red glow.");
		if (perJessica.place == 1E3) md.write('<p>With the prison broken the Witch, Jessica, immediately breaks the circle - abandoning Jesse to her fate.  "Free at last!" you can hear her screaming joyously as she climbs the stairs into the world above.</p>');
		else md.write("<p>You can see the Witch Jessica though the open doorway, bound in some way but Kurndorf and the Demon are preventing you checking more on her.</p>");
		md.write('<p>"Aaaah. Yes..." what used to be Jesse says, stretching the limbs of its new body. ');
		if (perJessica.place == 1E3) md.write("Kurndorf orders her to follow the witch, and she snorts contemptuously.</p>");
		else md.write("Kurndorf orders her to finish off the witch, and she snorts contemptuously.</p>");
		md.write("<p>The ghost's master plan seems to be unraveling before his... well, what amounts to his eyes.</p>")
	} else if (perKurndorf.getQuestGhost() == 30) {
		md.write("<p>The Ghost of Kurndorf floats in the air, seemingly unattached from his cares for the first time since he was summoned.</p>");
		md.write('<p>"Well, my ' + perYou.getSex() + '," He says almost amicably. "Better than I was a few short days ago I must say, but still not as well-off as I would have hoped."</p>');
		if (perJesse.place === 0) md.write("<p>A sweet pungent smell begins to tease your nose as the Demon within Jesse continues its exploration, its eyes passing around the room and pausing each time to gaze over your body - a hungry look crossing her face.</p>")
	}
	startQuestions();
	if (perKurndorf.getQuestSeance() < 50) {
		addQuestionCO(md,
			"start the s\u00e9ance", "Jessica", -2750);
		addLinkToPlace(md, "go back to the cellar", 193)
	}
	if (perKurndorf.getQuestGhost() == 1) addQuestionC(md, "introduce yourself", "Kurndorf", 14301);
	else if (perKurndorf.getQuestGhost() == 5) addQuestionC(md, "ask him why he was helping you", "Kurndorf", 14305);
	else if (perKurndorf.getQuestGhost() == 10) addQuestionC(md, "tell him about the aftane", "Kurndorf", 14310);
	else if (perKurndorf.getQuestGhost() == 15) addQuestionC(md, "uuuuh... what was that", "Kurndorf", -14315);
	else if (perKurndorf.getQuestGhost() ==
		20) {
		addQuestionCO(md, "watch powerlessly as the events unfold", "Kurndorf", -14320);
		if (perJessica.checkFlag(1) && perJessica.place === 193) addPopupLink(md, "why did Jessica cry out", "Demon and Jessica", "<img src='Images/jessica2ca.jpg' class='imgpopup' alt='Jessica'>" + "You heard Jessica cry out and as the magic in her prison was broken so you look to see why. You see the demon circling around her, and she seems to have no defences, having used all her mana. She staggers back out of the prison and into the doorway to the cellar." +
			"<br><br>As she does the demon rips off her remaining clothing and there is a swirling around her of dust and items. You see some chains fly in and wrap around her arms and feet. Some leggings seem to appear on her, black, shiny with odd heels. She cries out and then something flies in and fills her mouth, a ball-gag of some type," + '<br><br>Kurndorf laughs, "It seems the demon wants a Witch to toy with, I wish her all the torment and pain of hell!"' + "<br><br>The demon flies back to Jesse and resumes swirling around her...",
			true, "findPerson('Jessica').startAlly();Converse('Kurndorf',-14320);dispPlace();")
	} else if (perKurndorf.getQuestGhost() == 25) addQuestionC(md, "ask Kurndorf how he's doing", "Kurndorf", 14325);
	if (perJesse.getDemonPath() > 1 && perJesse.place === 0) addLinkToPlace(md, "talk to Jesse, uhm, the demon", 340);
	if (b2Cols) {
		AddPeopleColumnMed();
		if (perKurndorf.getQuestGhost() == 30 || perKurndorf.getQuestGhost() == 25) md.write('<img src="Images/kurndorf.jpg" style="float:left;width:100%;margin:5px 5px" alt="Kurndorf">');
		if (perJessica.place ===
			193) perJessica.showPerson(perKurndorf.getQuestGhost() < 20 ? "jessica2a.jpg" : "jessica2b.jpg", "", "", "", "Witch");
		else if (perJessica.place === 161) perJessica.showPerson("jessica2ca.jpg", "", "", "", "Bound Witch")
	}
	WritePlaceFooter(md)
}

function ShowPlace340() {
	var md = WritePlaceHeader(false, "", "black");
	perJesse.showPerson("jesse4.jpg");
	addPlaceTitle(md, "Jesse the Demon");
	md.write("<p>The creature that was once an innocent, beautiful young woman stand before you... Now every pore seems to be dripping with sex, the smell of it immediately assaulting your senses.</p>" + '<p>"Hello there little one..." she almost hisses in your direction. "You like this body, yesss?  Would you like to play with this body?  We would like to play with you... Oh yessss."</p>' +
		"<p>The closer she gets to you the stronger the smell becomes, soon beginning to overwhelm what little reason you may have had to resist her advances.  You can feel ");
	if (perYou.isMaleSex()) md.write("your member getting hard in anticipation, your desires rising to the surface.</p>");
	else md.write("your nipples getting hard and your panties quickly becoming soaked in anticipation, your desires rising to the surface.</p>");
	startQuestions();
	if (perJesse.getDemonPath() == 10) addQuestionC(md, "ask her what you should call her",
		"Jesse", 14410);
	addLinkToPlace(md, "give in to the temptation and take Jesse up on her offer", 341);
	WritePlaceFooter(md)
}

function DemonLeaves341() {
	perJesse.place = 10;
	perKurndorf.setQuestSeance(100);
	perKurndorf.setQuestGhost(50);
	if (!isMurderPath() && wherePerson("Sarah") === 0) {
		movePerson("Sarah", 1);
		movePerson("AdeleRoss", 16);
		setPersonFlag("AdeleRoss", 1)
	}
}

function ShowPlace341() {
	var md = WritePlaceHeader(false, "", "black");
	perJesse.showPerson("jesse5a.jpg");
	addPlaceTitle(md, "Jesse the Demon");
	md.write("<p>Jesse sits down and motions for you to come over to her as she begins to slowly expose more of her delicious flesh.</p>");
	if (perJesse.getDemonPath() < 20) md.write('<p>"Yessss, little thrall.  Come to LEGION...  Taste of Us..." she whispers to you.  The strength of your desire, and the heat in your loins, increases with every step you take towards your dark fate.</p>');
	else if (perJesse.getDemonPath() == 20) md.write('<p><b>"No you fool!"</b> Kurndorf yells.</p>' + "<p>A gut-wrenching nausea passes through you as the Ghost of Kurndorf passes through you, distracting you from the target of your desire.  It takes every ounce of self-control to keep from losing your lunch on the stone floor.</p>" + '<p>"Nooo!  You treacheroussss fool!" Jesse hisses in fury.  "You will pay for thisss!" Then she turns to you, her spell over you completely shattered.  "We will meet again, ' +
		perYou.getPersonName() + '. We promise you thisss...." she says, quickly gathering her things and fleeing out into the world.');
	startQuestions();
	if (perJesse.getDemonPath() < 20) addQuestionCO(md, "kiss her", "Kurndorf", -14420);
	else addPopupLink(md, "try and stop her", "Demon", "<img src='Images/jesse5b.jpg' class='imgpopup' alt='Demon'>" + '"No!" she hisses, locking her eyes on you as they begin to pulse red with hate.<br><br>' + '"You shall face us soon enough, <i>mortal</i>," she says, yanking her arm from you and escaping out into the town.',
		true, "DemonLeaves341();gotoPlace(342);");
	AddPeopleColumnMed();
	md.write('<img src="Images/kurndorf.jpg" alt="Ghost" style="float:left;width:90%;margin:5px 5px" alt="Kurndorf">');
	WritePlaceFooter(md)
}

function FindIt342() {
	if (isRunes()) Research("Spell", "Dest", "kurndorf.jpg", 342);
	else gotoPlace(347)
}

function ShowPlace342() {
	var md = WritePlaceHeader(false, "", "black");
	var mySex = perYou.getSex();
	md.write('<img src="Images/kurndorf.jpg" style="float:left;margin:0px 5px" alt="Kurndorf">');
	addPlaceTitle(md, "Ghost of Carl Kurndorf");
	md.write("<p>The ghost of Kurndorf hovers weightlessly before you.  Even though the S\u00e9ance is over it would seem that he still has enough power to maintain his presence here, at least for now.</p>");
	if (perKurndorf.getQuestGhost() == 85) md.write('<p>"You see, my ' + mySex +
		', before I was so rudely interrupted by that backstabbing witch Jessica I was about to cast a powerful spell that would have solidified my control of the entire town."</p>' + '<p>"Once that spell had been cast I would have been unstoppable within my own domain - the very town itself would have been <i>bound</i> to me, as if an extension of my will.</p>' + '<p>"Think of it," he says, a glint of reverence in his eyes. "To have any person in the town at my command.  To not have to seek out individuals and cast a spell over and over, slowly gathering followers and scrounging for every ounce of magical power. ' +
		"Instead, with this ritual, you would already have your fingers inside the minds of every citizen of the town - needing only to flex your own will to bow others to your control.</p>" + '<p>He looks at you, trying to gauge your reaction to his tale.  "So, what do you say?  Shall I instruct you in how to cast this spell yourself?" he asks.</p>');
	var nPrep = setBitFlag(0, 1, perKurndorf.checkFlag(11));
	nPrep = setBitFlag(nPrep, 2, perKurndorf.checkFlag(12));
	nPrep = setBitFlag(nPrep, 3, perKurndorf.checkFlag(13));
	nPrep =
		setBitFlag(nPrep, 4, perKurndorf.checkFlag(14));
	nPrep = setBitFlag(nPrep, 5, perKurndorf.checkFlag(15));
	nPrep = setBitFlag(nPrep, 6, perKurndorf.checkFlag(16));
	nPrep = setBitFlag(nPrep, 7, perKurndorf.checkFlag(17));
	nPrep = setBitFlag(nPrep, 8, perKurndorf.checkFlag(8));
	if (perKurndorf.getQuestGhost() >= 100) {
		if (nPrep < 255) md.write('<p>Kurndorf looks at you for a moment.  "Yes.  To begin, you must collect a few items.  Namely you will need to find chalk, salt, a chalice of some sort, a silver dagger, a large quartz crystal, a small branch of hemlock, some candles, a lock of your hair... Oh yes, and a human skull.</p>' +
			"<p>Kurndorf waits patiently for you to return with all of the requirements for the ritual.</p><p><i>When you have an item, <b>use</b> it here to prepare for the ritual</i></p><p>");
		else {
			md.write('<p>"Excellent, my ' + mySex + ". It would seem you have everything we need... ");
			if (perYourBody.FindItem(56) === 0) md.write(' Well, almost everything.  You will still need a piece of the individual subject of the ritual.  In this case, <i>you</i>.  A cutting of your hair perhaps?"</p>');
			else md.write('"</p>')
		}
		if (nPrep >
			0) {
			if (perKurndorf.checkFlag(17)) md.write(" <i>The chalk circle and pictograms have been drawn on the floor.</i><br>");
			if (perKurndorf.checkFlag(15)) md.write(" <i>The beeswax candles have been placed and lit.  They seem to burn forever.</i><br>");
			if (perYourBody.FindItem(56) > 0) md.write(" <i>You have a lock of your hair</i>");
			else if (perYourBody.FindItem(55) > 0) md.write(" <i>You have some scissors that you can use to cut a lock of your hair</i>");
			md.write("<br>Things on the Altar: ");
			if (perKurndorf.checkFlag(12)) md.write("<i>Ritual Chalice,</i> ");
			if (perKurndorf.checkFlag(13)) md.write("<i>the Crystal,</i> ");
			if (perKurndorf.checkFlag(14)) md.write("<i>the Dagger,</i> ");
			if (perKurndorf.checkFlag(11)) md.write("<i>the Salt,</i> ");
			if (perKurndorf.checkFlag(16)) md.write("<i>the Hemlock,</i> ");
			if (perKurndorf.checkFlag(8)) md.write("<i>the Skull</i>");
			md.write("</p><br>")
		}
	}
	startQuestions();
	if (isItemHere(57, 342)) addLinkToPlace(md, "examine</i> the skull on the altar", 342, "", "", "", "perKurndorf.setFlag(8,false);perKurndorf.setFlag(18,false);perYourBody.RemoveItem(57);perYourBody.PutItem(57);");
	if (perKurndorf.getQuestSeance() == 100) addQuestionC(md, '"Uhm, why are you still here?"', "Kurndorf", 27100);
	else if (perKurndorf.getQuestSeance() == 105) addQuestionC(md, '"So does that mean you can leave?"', "Kurndorf", 27105);
	if (perKurndorf.getQuestGhost() == 50) addQuestionC(md, '"Why did you help me before?"', "Kurndorf", 14350);
	else if (perKurndorf.getQuestGhost() == 55) addQuestionC(md, '"Why would you want to save my life?"', "Kurndorf", 14355);
	else if (perKurndorf.getQuestGhost() == 60) addQuestionC(md, '"You didn\'t answer my question."',
		"Kurndorf", 14360);
	else if (perKurndorf.getQuestGhost() == 65) addQuestionC(md, '"Help you?  Why would I help you?"', "Kurndorf", 14365);
	else if (perKurndorf.getQuestGhost() == 70) addQuestionC(md, '"And what would you want in return?"', "Kurndorf", 14370);
	else if (perKurndorf.getQuestGhost() == 75) addQuestionC(md, '"You would give up magic just to have a body?"', "Kurndorf", 14375);
	else if (perKurndorf.getQuestGhost() == 80) addQuestionC(md, '"What can you teach me?"', "Kurndorf", 14380);
	else if (perKurndorf.getQuestGhost() ==
		101) addQuestionC(md, '"I can\'t get all the stuff for the ritual."', "Kurndorf", 143101);
	else if (perKurndorf.getQuestGhost() == 102) addQuestionC(md, '"Is there anything you can <i>teach</i> me that might help?"', "Kurndorf", 143102);
	if (perKurndorf.getQuestGhost() == 103 && !isSpellKnown("Invisibility")) addOptionLink(md, "try to learn the spell", "FindIt342()");
	if (perKurndorf.getQuestGhost() > 80 && perKurndorf.getQuestGhost() < 100) addQuestionC(md, '"Teach me the ritual.  Tell me what I have to do."', "Kurndorf", 143100);
	if (perKurndorf.getQuestGhost() >= 100 && perKurndorf.getQuestGhost() < 200 && nPrep == 255 && (perYourBody.FindItem(55) > 0 || perYourBody.FindItem(56) > 0)) addLinkToPlace(md, "start the ritual", 343);
	addLinkToPlace(md, 'leave Kurndorf\'s "prison"', 161);
	WritePlaceFooter(md, "", true)
}

function EndRitual() {
	if (perDavy.other == 7) perDavy.other = 6;
	perKurndorf.setQuestRitual(200);
	PlaceI(52, 161);
	if (perYourBody.FindItem(4) > 0 && !checkPersonFlag("MrBeasley", 3)) {
		perYou.setInjury(5);
		perYourBody.DropItem(4, 76);
		showPopupWindowNow0()
	} else gotoPlace(161)
}

function ShowPlace343() {
	var md = WritePlaceHeader(false, "", "black");
	var mySex = perYou.getSex();
	if (perKurndorf.getQuestRitual() == 999) return dispPlace(996);
	if (perKurndorf.getQuestRitual() < 190) md.write('<img src="Images/kurndorf.jpg" style="float:left;margin:0px 5px" alt="Kurndorf">');
	else md.write('<img src="Images/kurndorf2.jpg" style="float:left;margin:0px 5px" alt="Kurndorf">');
	addPlaceTitle(md, "Ritual of Binding");
	if (perKurndorf.getQuestRitual() === 0) md.write("<p>Kurndorf's Ghost makes an audible sigh in preparation for the ritual.  For a moment you're tempted to remind him that he doesn't really breathe anymore, but something tells you a quip of that sort would not be the most appropriate thing to say at that particular moment.</p>" +
		'<p>After gathering himself for a moment, Kurndorf turns his gaze to you.  "Now, are you sure you are ready to begin? Is everything in place?" he asks.  Is that genuine concern in his voice?  "Once we start the ritual it can not be stopped...  Magic does make certain demands, as I\'m sure you have realized by now."</p>');
	else if (perKurndorf.getQuestRitual() == 5) md.write('<p>"Very well then," he says, beginning to summoning his power.  A dark aura immediately forms around his hands as he chants a few words.  Within moments a swirl of water fills the chalice on the altar.</p>' +
		'<p>"Purest water," he tells you before you have the chance to ask.  "I am not entirely out of tricks yet, my ' + mySex + '.  Now," he says, motioning towards the hemlock, "Mash a few leaves of that herb on the altar and mix them into the cup with the dagger.  Careful now, don\'t use too much - you\'ll be drinking that later."</p>');
	else if (perKurndorf.getQuestRitual() == 10) md.write('<p>Kurndorf takes a moment to gauge the progress of the ritual so far.  Evidently satisfied with the results he continues his instruction.  "Next, add a pinch of that salt on the altar to the chalice.  Sprinkle a bit over the crystal as well, then - repeat after me...</p>');
	else if (perKurndorf.getQuestRitual() == 15) md.write("<p>You chant the words that he tells you and begin to feel the power within the room growing...  just a tingle at the back of your neck, and then more as shivers begin to run up and down your spine.</p>" + "<p>For a ghost, Kurndorf seems to be quite pleased with the results of your efforts so far.</p>" + '<p>"And next..." he says between chanting his own mantra in a language you do not understand.  "You must drink from the chalice.  Only a few sips my ' +
		mySex + ", must not over do it just yet. We wouldn't want any harm to come to that body of yours,\" he says absently.</p>");
	else if (perKurndorf.getQuestRitual() == 20) md.write("<p>Within moments of partaking of the tincture you can feel it begin to take effect, its poison speeding through your system as the room begins to darken and swirls of energy begin to show themselves as they whisk around the room as if moths drawn to a flame.</p>" + '<p>"Almost there, my ' + mySex + ",\" he says, excitement beginning to show through his attempt at stoic control...  Or perhaps it was always there and you just didn't notice it before.</p>" +
		'<p>"There," he says, pointing at the silvered knife.  "Pick that up and use it to prick your finger, then anoint the waters within the chalice with your blood.  Then you must also smear the crystal itself."</p>');
	else if (perKurndorf.getQuestRitual() == 25) {
		md.write("<p>The power in the room is now unmistakable.  Your altered vision is near blinding, all of the colors within the room spinnig so fast it almost makes you dizzy.</p>" + "<p>Even the candles seem to be responding, their flame being whipped around by the moving energy as if a strong breeze were passing through the room.</p>" +
			"<p>Then the room almost <i>thickens</i>, as if all of the power had begun to press in on you - as if it were attempting to stop you from completing your task.</p>" + '<p>"Yes, Yes!" Kurndorf almost hisses in anticipation.  "Now - for the last step - the moment of truth."  His eyes look upon you as if you were nothing more than a fine meal for his ravenous hunger.  "You must use an item of the soul to be bound...  something from their person."</p>');
		if (perYourBody.FindItem(56) > 0) md.write('<p>"The lock of hair, it is from you, yes?  Excellent!  ');
		else md.write('<p>"Quickly, use those scissors to take a lock of your hair!  ');
		md.write("Drop it into the Chalice, my " + mySex + '.  Do it <b>now</b>!!"</p>')
	} else if (perKurndorf.getQuestRitual() == 30) {
		md.write("<p>Kurndorf looks down at you expectantly, his aura pulsing with power, desire, anticipation and.... hunger?</p>" + "<p>He has instructed you to drop an item of the person to be bound into the chalice.<br>Your gaze settles upon the altar as the final moment draws near.</p>");
		if (perKurndorf.checkFlag(18)) md.write("<p><i>You notice that a small piece of Kurndorf's skull has chipped off and lies in stark contrast against the white linen cloth on the altar</i></p>");
		if (perYourBody.FindItem(56) === 0) md.write("<p><i>You need to use the scissors to take a clipping of your hair if you wish to use it.</i></p>")
	} else if (perKurndorf.getQuestRitual() == 195) md.write("<p>You reach out to the altar and grab the small piece of Kurndorf's skull, quickly throwing it into the Chalice.  Bubbles and steam immediately begin to rise out of the cup as the color turns to a dark black.</p>" + "<p>The crystal begins to emit a slight hum that seems to quickly rise in intensity.</p>" + '<p>Kurndorf, moments before assured of his victory, now cries against his eminent defeat.  "Nooo!" he screams, "How could one such as you defeat me?!?"</p>' +
		"<p>The spirit of Carl Kurndorf stretches before your eyes, within moments drawn completely within its new crystal prison.  As you watch you hear the last paranoid accusations flee from the Warlocks mouth as he is pulled to his fate.</p>" + '<p>"That Witch! She has crossed me yet again hasn\'t she!  Or some other creature intent on my fate?  Surely the church did not warn you..."  his cries fade to nothing as the last of him is sucked into the crystal.</p>' + "<p>It would seem that the threat of Kurndorf has been thwarted once more, but for how long?  Even death did not defeat him before... will his new prison be any more permanent?</p>" +
		"<p><b>The room begins to shake, torn at its very foundations, and about to crumble down upon you!</b></p>");
	startQuestions();
	if (perKurndorf.getQuestRitual() === 0) {
		addQuestionC(md, '"Lets do this thing."', "Kurndorf", 14900);
		addLinkToPlace(md, "Reconsider... and talk some more", 342)
	}
	if (perKurndorf.getQuestRitual() == 5) {
		if (perKurndorf.getQuestGhost() < 105) addQuestionC(md, '"Uhmm... and exactly what other tricks <i>do</i> you have up your sleeve?"', "Kurndorf", 143105);
		addLinkToPlace(md, "Mash the hemlock and drop it into the chalice",
			343, "", "", "", "perKurndorf.setQuestRitual(10);")
	}
	if (perKurndorf.getQuestRitual() == 10) {
		if (perKurndorf.getQuestGhost() < 110) addQuestionC(md, '"This isn\'t going to be some lame mantra or something is it?"', "Kurndorf", 143110);
		addLinkToPlace(md, "Add the salt and follow his instructions", 343, "", "", "", "perKurndorf.setQuestRitual(15);")
	}
	if (perKurndorf.getQuestRitual() == 15) {
		if (perKurndorf.getQuestGhost() < 115) addQuestionC(md, '"Don\'t want anything to happen to my <i>body</i>? You mean <i>me</i>, right?"', "Kurndorf",
			143115);
		addLinkToPlace(md, "Drink from the chalice", 343, "", "", "", "perKurndorf.setQuestRitual(20);")
	}
	if (perKurndorf.getQuestRitual() == 20) {
		if (perKurndorf.getQuestGhost() < 120) addQuestionC(md, '"But you just said you <i>didn\'t</i> want me to get hurt! Now you want me to cut myself?"', "Kurndorf", 143120);
		addLinkToPlace(md, "Prick your finger and anoint the chalice and crystal", 343, "", "", "", "perKurndorf.setQuestRitual(25);")
	}
	if (perKurndorf.getQuestRitual() == 25) {
		if (perKurndorf.getQuestGhost() < 125) addQuestionC(md,
			'"Impatient much?"', "Kurndorf", 143125);
		addLinkToPlace(md, "Look at the altar for a moment and gather your power", 343, "", "", "", "perKurndorf.setQuestRitual(30);")
	}
	if (perKurndorf.getQuestRitual() == 30) {
		if (perKurndorf.checkFlag(18)) {
			if (perYourBody.FindItem(56) > 0) startAlternatives(md);
			addLinkToPlace(md, "Drop the chip of Kurndorf's skull into the chalice", 343, "", "", "", "perKurndorf.setQuestRitual(195);")
		}
		if (perYourBody.FindItem(56) > 0) {
			addLinkToPlace(md, "Drop the lock of your hair into the chalice", 996);
			if (perKurndorf.checkFlag(18)) endAlternatives(md)
		}
	}
	addPopupWindow(md,
		"Caught!", "<img src='Images/fallingrocks.jpg' class='imgpopup' alt='Collapse!'>" + "You try to run but you are hit by a part of the crumbling room. You stagger and fall out of the room into the cellar.</p>" + "<p>You cry out in pain and fall to the ground, the last thing you see is the eeriely glowing crystal...</p>" + '<a style="color:white;" href="javascript:closePopupWindowNow0()">unconsciousness claims you</a>', "gotoPlace(213);", undefined, true, false, true);
	if (perKurndorf.getQuestRitual() == 195) addOptionLink(md,
		"Leave everything and <b>RUN</b>!!", "EndRitual()");
	WritePlaceFooter(md, "", true)
}

function ShowPlace344() {
	var perJ = findPerson("JohnAdams");
	var b2Cols = isShopOpen(-1, 1, true) && perJ.place == 344 && checkPersonFlag("Pamela", 12) && (checkPersonFlag("Pamela", 13) || checkPersonFlag("Pamela", 14));
	var md = WritePlaceHeader(false, b2Cols ? "td-left" : "td-left-med");
	addPlaceTitle(md, "The New Age " + getShopStore(true), "newage2.jpg");
	md.write("<p>A small " + getShopStore() + " a short walk away from the rest of the shopping center.  Now that you think about it, you have heard stories of the psychic that owns the " + getShopStore() +
		'.  It would seem she has a reputation of being the "real thing."</p><p>A few days ago you would have balked at such a statement.  But with recent events, it leaves you wondering if perhaps she may be yet another magical individual in town.</p><p>Could she even be a threat?  Only time will tell.</p>');
	if (!isShopOpen(0, 0, true)) md.write("<p>The New Age " + getShopStore(true) + " has a sign noting that is closed, hours of business 7am to 5pm.</p>");
	if (b2Cols) {
		md.write("<p>You see John Adams standing near the " +
			getShopStore() + " entrance, as he notices you he walks into the " + getShopStore() + ".</p>");
		perJ.place = 345
	}
	startQuestions();
	if (isShopOpen(-1, 1, true)) addLinkToPlace(md, "enter the " + getShopStore(), 345);
	addLinkToPlace(md, "walk back to the shopping center", 194);
	if (b2Cols) {
		AddPeopleColumnMed();
		if (perJ.place == 344) perJ.showPerson("john11.jpg", "100%")
	}
	WritePlaceFooter(md)
}

function ShowPlace345(stype) {
	if (!isShopOpen(-1, 1, true)) return gotoPlaceDelayed(344, "", '<img src="UI/closed.png" style="float:left;width:15%;margin-right:5px">The New Age ' + getShopStore(true) + " closes and the owner Esmeralda asks you to leave.");
	var perJohn = findPerson("JohnAdams");
	var perJessica = findPerson("Jessica");
	var plcJessica = perJessica.place;
	var perGypsy = findPerson("Gypsy");
	var perDesiree = findPerson("Desiree");
	var perLeanne = findPerson("Leanne");
	var perVamp = findPerson("Vampyre");
	var b2Cols = perJohn.place ==
		345 || plcJessica == 345;
	var md = WritePlaceHeader();
	perGypsy.showPerson("gypsy1.jpg");
	addPlaceTitle(md, "New Age " + getShopStore(true));
	var myName = perYou.getPersonName();
	if (nMana < 20) perGypsy.setFlag(7);
	md.write("<p>A small " + getShopStore() + " that sells a wide range of new age, occult and spiritual items. The owner is dressed as a gypsy fortune teller, either as a costume for the customers or maybe she actually is one?</p>");
	if (perJohn.place == 345 && plcJessica != 345) md.write("<p>You see John Adams standing like he is browsing the shelves but he is clearly watching you.</p>");
	else if (perJohn.place == 345) md.write("<p>John Adams is standing near his Mistress and warily watching you.</p>");
	md.write('<p>The Gypsy fortune teller leans forward as you enter.  "Yes ' + myName + ', how can I help you today?"</p>');
	if (perGypsy.checkFlag(7)) md.write('<p>"Oh, ' + myName + '. I noticed something in my recent shipment of stones this morning that might interest you," she says, placing a small stone on the table. "Given the nature of the item...  I believe ' + sCurrency + '100 is a fair price."</p>');
	startQuestionsOnly("Items for sale");
	if (perGypsy.checkFlag(7)) addQuestionC(md, "pay " + sCurrency + "100 for the rustic stone", "Gypsy", 1717, "travelblock");
	addQuestionC(md, "pay " + sCurrency + "45 for the quartz crystal", "Gypsy", 52, "travelblock");
	addQuestionC(md, "pay " + sCurrency + "20 for some beeswax candles", "Gypsy", 54, "travelblock");
	if (whereItem(60) == 345) addQuestionC(md, "pay " + sCurrency + "100 for a book on Hypnosis", "Gypsy", 51, "travelblock");
	if (perYourBody.FindItem(49) === 0) addQuestionC(md, "pay " + sCurrency +
		"20 for some holy water from the church", "Gypsy", 49, "travelblock");
	md.write("<br>");
	startQuestions();
	if (!perGypsy.checkFlag(9)) addQuestionC(md, '"Uh, how did you know my name?"', "Gypsy", 15701);
	if (perKurndorf.getQuestGhost() >= 100 && perKurndorf.getQuestRitual() < 200) {
		if (!perGypsy.checkFlag(1)) addQuestionC(md, '"Do you have any... uhm.... Hemlock?"', "Gypsy", 1711);
		if (!perGypsy.checkFlag(2)) addQuestionC(md, '"Where can I find a silver dagger?"', "Gypsy", 1712);
		if (!perGypsy.checkFlag(3)) addQuestionC(md, '"Happen to know where I can find a human skull?"',
			"Gypsy", 1713);
		if (!perGypsy.checkFlag(4)) addQuestionC(md, '"Know of any way to protect someone from a...  evil spirit?"', "Gypsy", 1714)
	}
	if (!perGypsy.checkFlag(8) && perDesiree.getQuestRelic() > 0 && perDesiree.getQuestRelic() < 100) addQuestionC(md, '"Do you know anything about an old Catholic Relic at the local church?"', "Gypsy", 1718);
	if (checkPersonFlag("Pamela", 11) && !checkPersonFlag("Pamela", 12)) addQuestionC(md, "\"Are you looking for a 'Twin Souls' bracelet?\"", "Gypsy", 80);
	if (checkPersonFlag("Pamela", 12) && !(checkPersonFlag("Pamela",
			13) || checkPersonFlag("Pamela", 14))) {
		addQuestionC(md, 'Answer: "Yes, I do"', "Gypsy", 81);
		addQuestionC(md, 'Answer: "No, <b>I</b> do not"', "Gypsy", 82)
	}
	if (whereItem(60) === 0 && perYou.checkFlag(12)) addQuestionC(md, '"Do you have any books on hypnosis"', "Gypsy", 53);
	if (perLeanne.place == 382 && !perLeanne.checkFlag(9)) addQuestionC(md, "ask her about saving a person from demons", "Gypsy", 700);
	if (perVamp.other > 50 && !perVamp.checkFlag(10)) addQuestionC(md, '"Do you know much about Vampires"', "Gypsy", 55);
	addLinkToPlace(md,
		"leave the " + getShopStore(), 344);
	if (b2Cols) {
		AddPeopleColumnMed();
		if (perJohn.place == 345) perJohn.showPerson("john11.jpg", "100%")
	}
	WritePlaceFooter(md, "", true)
}

function DropTheSkull(nSkull) {
	perYourBody.DropItem(57, 342);
	perKurndorf.setFlag(8);
	if (nSkull == 1) perKurndorf.setFlag(18);
	else perKurndorf.setFlag(18, false);
	gotoPlace(342)
}

function ShowPlace346() {
	var md = WritePlaceHeader();
	addPlaceTitle(md, "Using the Skull", "Items/skull1.jpg");
	md.write("<p>Which skull you use in the ritual <i>may</i> have a very important impact on <i>how</i> the spell turns out.</p>" + '<p style="text-align:center;font-size:small">This is your only warning</i></p>');
	startQuestions("Which skull do you place on the altar?");
	if (perKurndorf.checkFlag(3)) addOptionLink(md, "Skull from the Church catacombs", "DropTheSkull(3)");
	if (perKurndorf.checkFlag(2)) addOptionLink(md,
		"Skull from the Graveyard", "DropTheSkull(2)");
	if (perKurndorf.checkFlag(1)) addOptionLink(md, "Skull from the Kurndorf's Tomb", "DropTheSkull(1)");
	addLinkToPlace(md, "Never mind...", 342);
	WritePlaceFooter(md)
}

function FindIt347(doc) {
	ResearchOLD("I", doc.FormChar.research.value)
}

function ShowPlace347() {
	if (isRunes()) {
		Research("Spell", "Dest", "kurndorf.jpg", 342);
		return
	}
	var md = WritePlaceHeader(false, "td-none");
	addPlaceTitle(md, "Kurndorf's Tutelage");
	md.write('<form method="POST" name="FormChar">' + "<p>What does it mean to be unseen? Enter the correct word to find the spell:</p>" + '<p><input type="text" size="20" name="research">');
	md.write('<input type="button" name="button" value="please" onClick="FindIt347(document)"></p></form><p>');
	addLinkToPlace(md, "Never mind...", 342);
	AddRightColumnLarge(md);
	AddImage("kurndorf.jpg");
	WritePlaceFooter(md)
}

function ShowPlace348() {
	var perVictoria = findPerson("Victoria");
	var clv = perVictoria.getCharmedLevel();
	var bStartEvent2 = clv == 2 && (!perVictoria.checkFlag(10) || !perVictoria.checkFlag(11) || !perVictoria.checkFlag(12) || !perVictoria.checkFlag(13) || !perVictoria.checkFlag(14));
	var bStartEvent1 = (clv == 4 || clv == 1) && nTime - perVictoria.charmedTime > 48;
	var md = WritePlaceHeader(false, bStartEvent1 ? "td-none" : "");
	var perDesiree = findPerson("Desiree");
	var perLeanne = findPerson("Leanne");
	if (clv === 0) {
		if (!isShopOpen(0, 0, true)) return gotoPlaceDelayed(194,
			"", '<img src="UI/closed.png" style="float:left;width:15%;margin-right:5px">The antiques ' + getShopStore() + " closes and Victoria asks you to leave.");
		perVictoria.showPerson("victoria1a.jpg")
	} else if (!bStartEvent1)
		if (bStartEvent2) perVictoria.showPerson("victoria4.jpg");
		else if (isNight()) perVictoria.showPerson("victoria1c.jpg");
	else if (clv == 4) perVictoria.showPerson("victoria1b.jpg");
	else perVictoria.showPerson("victoria2.jpg");
	if (bStartEvent1) {
		addPlaceTitle(md, "Victoria");
		perVictoria.showPerson("victoria4.jpg",
			"30%", "left");
		perVictoria.charmThem(2);
		md.write("<p>Victoria is eager to fulfill your every desire, she booms and moans all the time when she sees you. You know she wets her panties in an instant. She constantly tells you how she misses immediately after you leave her " + getShopStore() + ". You know that it\u2019s just the charm effect that\u2019s talking, but it feels good hearing it.</p>" + "<p>You are standing in front of her at the moment, mouth agape as she is wearing nothing. Her naked body presented to you like an offering.</p>" +
			'<p>"My love! Welcome! I hope this body is to your liking!", Victoria shouts in joy as she sees you. ' + "You are still shocked how stunning she looks. You never thought that she has such a nice figure  before.</p>" + '<p>"I wanted to please you! I know you have commanded me to stay put and wait further commands, but I thought you would be happy seeing me naked!", her last words are filled with little moans. You know that just by looking at you fills her with orgasms.</p>' + '<p>"Yes, you have pleased me, my dear! I\u2026 you see\u2026 you\u2019ve done well.", you stammer a bit.</p>' +
			'<p>"You know, you don\u2019t have to stand there! These are all yours!", she jiggles her boobs a bit and smiles.</p>' + '<p>"' + perYou.getPersonName() + '! I feel an urge to get to know you better. I want to understand you. Your desires, your dreams, your needs. I want to be the person whom you could always rely on, who always got your back. A girl who listens to you anytime and interested in your emotions.", Victoria runs a finger through your chest. ' + "You realise she really wants more than just being your girlfriend. Not just a sex toy or a slave like most of the others you have charmed, but a person who supports you. It comes to you that she wants to be your personal caretaker or assistant.</p>" +
			"<p>You grin at her and embrace her for a minute. The two of you silently caressing each other.</p>" + '<p>"All right, my dear. But enough talk for now! Let\u2019s have some fun!", you break the silence with a laugh. ' + "Victoria doesn\u2019t say a word, she just opens comes close to you and shows you her pair of round tits and gives you a mouthful kiss. You don\u2019t even have to tell her what you want, she\u2019s just doing it all by herself! She\u2019s like reading your mind by trying to please you on her own without your say in it and you like it so far!")
	} else {
		addPlaceTitle(md,
			"Antiques & Artifacts");
		md.write("<p>The Antique and Artifact " + getShopStore(true) + " is a quaint little " + getShopStore() + " that seems to have a little bit of everything - from the rare and valuable to the type of stuff your grandmother might have.</p>");
		if (!perVictoria.checkFlag(8) && !perVictoria.isCharmedBy()) md.write("<p>Your eyes and hands wander over some of the items for sale as you walk through the " + getShopStore() + ".</p>" + "<p>At the back of the " + getShopStore() + " you run into the " + (isBritish() ?
			"shop assistant" : "store clerk") + '. She looks up as you approach.   "Hello, can I help you with something today?"</p>');
		else if (clv === 0) md.write("<p>Your eyes and hands wander over some of the items for sale as you walk through the " + getShopStore() + ".</p>" + "<p>You find Victoria managing the " + getShopStore() + ".  She looks up as you approach.</p>");
		else md.write("<p>Only people who are interested in the occult and mysterious come where. Which is, let\u2019s face it, a small handful of people. The " +
			getShopStore() + " stands mostly empty during the day, only one or two costumer stop by.</p>" + "<p>Your lovely personal assistant, Victoria, still takes care of the " + getShopStore() + " after she sworn herself to you. In this way, she still has a regular job to do and something to keep her occupied. It would be too much for you to handle if she would follow you around, not leaving your side. Well, maybe one day you can make her dream come true, but you can\u2019t take risks at the moment.</p>" + '<p>Victoria stands behind a counter. "Hello, ' +
			perYou.getMaster() + ". I'm so glad you're here. Is there\u00a0<i>anything</i>\u00a0I can do for you?\"</p>")
	}
	if (perVictoria.checkFlag(35) && !perVictoria.checkFlag(36)) {
		startQuestionsOnly("Items for sale");
		addQuestionC(md, "buy assorted occult papers for " + sCurrency + "50", "Victoria", -2718, "travelblock");
		md.write("<br>")
	}
	startQuestions();
	if (!perVictoria.checkFlag(8)) addPopupLinkC(md, "introduce yourself", "Victoria", "<img src='Images/victoria0.jpg' style='height:80vh;float:right;margin-left:5px' alt='Victoria'>" +
		"As you search through the aisles containing strange relics and antique artefacts you come across the owner of the " + getShopStore() + ". The tall brunette lady greets you wholeheartedly,<br><br>" + '"Nice to meet you ' + perYou.getPersonName() + ".  My name is Victoria, my father used to own this " + getShopStore() + ' before I inherited it.  Now, is there something I can help you with?"<br><br>' + "You answer that you are just browsing, so she tells you to look around and have fun.<br><br>" + "Victoria seems nice, she even flashes a blush to you, but she is busy keeping the " +
		getShopStore() + " together so you two don\u2019t have enough time to get acquainted. But you certainly do feel a vibe for her and you know her affections are the same.", false, "setPersonFlag('Victoria', 8);dispPlace();");
	else {
		if (perDesiree.getQuestRelic() > 0 && !perVictoria.checkFlag(1)) addQuestionC(md, '"Do you know anything about an old Catholic relic around here?"', "Victoria", 1851);
		if (perYourBody.FindItem(48) > 0 && !perVictoria.checkFlag(2)) addQuestionC(md, 'show her the Relic - "Know anything about this?"',
			"Victoria", 1852);
		if (isMurderPath())
			if (perKurndorf.getQuestSeance() >= 16 && !perVictoria.checkFlag(3)) addQuestionC(md, '"Do you know of any relics that can protect from evil spirits?"', "Victoria", 14501);
		if (checkPersonFlag("Pamela", 8) && !checkPersonFlag("Pamela", 9) && !checkPersonFlag("Pamela", 10) && !checkPersonFlag("Pamela", 11) && perYourBody.FindItem(46) > 0) addQuestionC(md, '"Do you know anything about this bracelet?"', "Victoria", 1);
		if (checkPersonFlag("Pamela", 8) && checkPersonFlag("Pamela", 9) && !checkPersonFlag("Pamela",
				11) && perYourBody.FindItem(46) > 0) addQuestionC(md, "\"Do you know anything about this bracelet, it is called a 'Twin Souls' bracelet?\"", "Victoria", 2);
		if (perLeanne.place == 382 && !perLeanne.checkFlag(10)) addQuestionC(md, "ask Victoria about saving Leanne", "Victoria", 700);
		if (perLeanne.place == 382 && perLeanne.checkFlag(8) && !perVictoria.checkFlag(9) && !checkPersonFlag("Vampyre", 2)) addQuestionC(md, "ask Victoria about the 'Mirror of Souls'", "Victoria", 701);
		if (!isDay() && clv > 0) addPopupLink(md, "go upstairs and spend the night with Victoria",
			"Going to Bed with Victoria", '<img src="Images/victoriabed1.jpg" style="position:absolute;width:100%;bottom:0" alt="Victoria">' + "You tell your beautiful slave that you will sleep here tonight. She lies down awaiting you to sample her wares in bedding.", true, "sleepForNight()", false, undefined, "background-color:darkgrey;top:10%;left:5%;width:85%;height:80%;padding:0")
	}
	addLinkToPlace(md, "leave the " + getShopStore(), 194);
	WritePlaceFooter(md)
}

function ShowPlace349() {
	var md = WritePlaceHeader();
	var perVictoria = findPerson("Victoria");
	perVictoria.showPerson("victoria2.jpg");
	addPlaceTitle(md, "Victoria Under a Spell");
	md.write("<p>She looks at you, seemingly much more in control of herself than any other you have seen when the spell takes hold.</p>" + '<p>"You... you just said <i>Dai Chu Victoria</i>,didn\'t you," she says, more than asks. "I... I can feel ' + 'it working inside me, filling me with desire I did not have only moments ago."</p>' + '<p>"I, uhm.... I mean to say..." you stammer, caught off-guard by someone who knows so much about ' +
		"something you have only recently uncovered.  But does this mean that she knows of magic as well?</p>" + '<p>"Do not be afraid," she says.  Curious that she would try to console <i>you</i> considering that ' + 'you just cast a spell that will eventually enslave her.  "After all, in a few moments I will be your ' + 'willing slave and would no longer be a threat to you, even if I were magical myself," she says, as if reading your mind.</p>');
	startQuestions();
	addLinkToPlaceC(md, '"Uhm...  You\'re not reading my mind, are you?"',
		350);
	WritePlaceFooter(md)
}

function ShowPlace350() {
	var md = WritePlaceHeader();
	var perVictoria = findPerson("Victoria");
	perVictoria.showPerson("victoria3.jpg");
	addPlaceTitle(md, "Victoria Under a Spell");
	md.write('<p>She smiles at you. "No, I am not reading your mind," she says as she begins to undress. "My name is Victoria,');
	if (!perVictoria.checkFlag(8)) {
		md.write(" as you know, " + perYou.getMaster() + ", but of course you will call me whatever you wish.  Is that what I should call you from now on? " + perYou.getMaster() + '?"</p>');
		perVictoria.setFlag(8)
	} else md.write(perYou.getMaster() + ", but of course you will call me whatever you wish.  Is that what I should call you from now on? " + perYou.getMaster() + '?"</p>');
	md.write('<p>"Uhm...  Well...  Yes, that is what you shall call me from now on.  And, as for you, I suppose Victoria is fine.  Or slave," you stammer.  "But, I reserve the right to change my mind ' + 'at any time," you say, trying to reassert control over the situation. ' + '<p>"Of course, ' + perYou.getMaster() + '," she says.  "You shall do whatever you wish, and I will aid you in any way I can.  Shall I finish undressing for you now?" she asks.</p>' +
		'<p>"I can feel the spell still working within me, my desire is greatly increasing. I am almost ready for you to take me and complete my enslavement."</p>');
	startQuestions();
	addLinkToPlaceC(md, '"Yes, uhm...  continue undressing..."', 351);
	WritePlaceFooter(md)
}

function ShowPlace351() {
	var md = WritePlaceHeader();
	var perVictoria = findPerson("Victoria");
	perVictoria.showPerson("victoria4.jpg");
	addPlaceTitle(md, "Victoria Under a Spell");
	md.write('<p>"Do you like what you see, ' + perYou.getMaster() + '?"' + "she asks as she removes the last of her clothing.</p>" + '<p>"Yes, I do," you say, slowly beginning to recover from your initial surprise.  "How do you ' + 'know so much about what is happening to you?"</p>' + '<p>"Ah, yes.  I should have realized you would be curious about my reaction and informed you ' +
		"earlier.  Please forgive my failure " + perYou.getMaster() + '."</p>' + '<p>"You are forgiven, Slave, as long as you quit talking around my question and actually ' + 'answer it," you say, beginning to get somewhat annoyed with her altogether stoic reaction to your spell.</p>' + '<p>"Yes, of course," she says.  "The reason that I am reacting in such an uncharacteristic ' + "manner to the feelings coursing through me is because it is not the first time that I have " + 'experienced them," she says as she drops the last of her clothing to the ground.  "You see, ' +
		'I have been a <i>slave</i> before, victim of the very spell you have used on me yet again."</p>');
	startQuestions();
	addLinkToPlaceC(md, '"Tell me more, and play with yourself to prepare for your ' + perYou.getMaster() + '."', 352);
	WritePlaceFooter(md)
}

function ShowPlace352() {
	var md = WritePlaceHeader(false, "td-left-large");
	var perVictoria = findPerson("Victoria");
	perVictoria.showPerson("victoria5.jpg");
	addPlaceTitle(md, "Victoria Under a Spell");
	md.write('<p>"As you wish, ' + perYou.getMaster() + '," she says as she lays across ' + 'one of the antique chairs and begins to fondle her breasts.  "Is this what you wanted?"</p>' + '<p>"That will do for now," you say, feeling more and more comfortable around your newest aquisition. ' + '"Now, you were telling me about your past enslavement?"</p>' +
		"<p>\"Yes.  The man that I once called my 'father' was actually something of a warlock himself, or at " + "least he tried to be.  He knew less than a handful of spells and never amounted to much - but he was " + 'always searching for more magical items."</p>' + '<p>"Is that why he started an antique ' + getShopStore() + '?  As a front for his search?"</p>' + "<p>\"Yes.  And when he died a few years ago I 'inherited' the " + getShopStore() + " and moved it here to get away from " + 'him and the life that I led with him.  But it would seem that I was destined to be a <i>slave</i>," she says ' +
		'smiling.  "A destiny that I now fully embrace once more."</p>' + '<p>"Do you wish to use me now, ' + perYou.getMaster() + '?" she asks, the smell of ' + "sex suddenly assailing you and reminding you why you cast the spell in the first place.");
	startQuestions();
	addLinkToPlace(md, "<i>use</i> your new slave in as many ways as you can think of", 353);
	WritePlaceFooter(md)
}

function ShowPlace353() {
	var md = WritePlaceHeader();
	var perVictoria = findPerson("Victoria");
	perVictoria.showPerson("victoria6.jpg");
	addPlaceTitle(md, "Victoria Under a Spell");
	var myName = perYou.getMaster();
	md.write('<p>"Oh ' + myName + '," she cries as you take her, over and over again.</p>' + "<p>Sometime later, and after some of the most interactive sex play you have had in some time, you finally " + "find yourself sitting across from her in another chair.</p>" + "<p>Although you are exhausted, it would seem that your new slave has more energy and training than you " +
		"previously thought possible.  \"So, was that the spell or do I have your 'father' to thank for all of that?\"</p>" + '<p>"The spell certainly helps to keep me perpetually ready for you, ' + myName + ' and I was one of my fathers favorite pets," she says thoughtfully.  "But there is... something... about you ' + 'that brings out the animal in me," she says, albeit in her usual stoic tone of voice.</p>' + "<p>You barely stifle a bout of laughter, not sure what was more humorous... the entire situation, or the way " +
		'that she said "animal" with so <i>little</i> emotion that it makes you wonder if she is capable of emotion\tat all.</p>' + '<p>"I am <i>yours</i> now, ' + myName + ".  In every way possible.  Just the same " + "as every other piece of merchandise in what is now <i>your</i> " + getShopStore() + " as well.  Which I will continue to watch over " + "as long as you wish it of me. I live in an apartment upstairs of the " + getShopStore() + ', you make inspect me anytime, day or night."</p>');
	startQuestions();
	addLinkToPlace(md,
		"speak with Victoria of other matters", 348);
	addLinkToPlace(md, "leave the " + getShopStore() + " in Victoria's capable hands", 194);
	WritePlaceFooter(md)
}

function ShowPlace355() {
	var md = WritePlaceHeader();
	var splace = getQueryParam("place");
	var perMadison = findPerson("Madison");
	if (splace === "") {
		perYou.setFlag(2);
		perMadison.showPerson("madison10.jpg")
	} else perMadison.showPerson("madison20.jpg");
	addPlaceTitle(md, "Madison Under a Spell");
	md.write('<p>"What did...  I... Um...  Sorry?"  She stammers, her demeanor towards you instantly changing as the spell begins to set in.</p>' + "<p>\"You know,\" she starts in after a moment to 'regain' her senses. \"You're kinda cute and all... " +
		"and I'm seriously sorry about breaking your stereo.\"</p>" + '<p>"I know, but I was seriously looking forward to using that stereo," you say, trying to look ' + "upset about it being broken when a much more valuable prize is right in front of you...</p>" + "<p>And about to be all yours.</p>" + '<p>"I know, I know..." she says, eyeing you up and down as if she\'s about to jump you right ' + 'here and now. "Tell you what...  you tell me what you want for not turning me in and I\'ll do it."</p>' + "<p>The flash of the spell in her eyes tells you that you could literally ask for <i>anything</i> and " +
		"she <i>would</i> do it...  but what's the point of rushing things...</p>");
	startQuestions();
	addLinkToPlaceC(md, '"Lift your shirt and show me your breasts."', 356, "place=" + splace);
	WritePlaceFooter(md)
}

function ShowPlace356() {
	var md = WritePlaceHeader();
	var splace = getQueryParam("place");
	var perMadison = findPerson("Madison");
	if (splace === "") perMadison.showPerson("madison11.jpg");
	else perMadison.showPerson("madison21.jpg");
	addPlaceTitle(md, "Madison Under a Spell");
	md.write("<p>She hesitates for only a moment before the heightened desire from the spell banishes all " + 'modesty that may have gotten in the way.  "Anything you say," she says, flashing you a grin.</p>' + "<p>Moments later she not only has her shirt and bra lifted up but has managed to hick up her " +
		"skirt and slightly pulled down her panties.</p>" + '<p>You\'re not sure if she even realizes how far she has already fallen. "Not a bad start," you say, ' + "challenging her for more.</p>" + '<p>"Oh yeah," she says, rising to the bait.  "Not enough for you, huh?  Good thing you\'re so cute.  Normally ' + "I wouldn't dare do stuff like this,\" she says, her voice completely missing the concern that you would " + 'expect in that statement. "So, what else do I have to do to keep from getting turned in?"</p>');
	startQuestions();
	addLinkToPlaceC(md, '"Display yourself for my viewing pleasure."', 357, "place=" + splace);
	WritePlaceFooter(md)
}

function ShowPlace357() {
	var splace = getQueryParam("place");
	var md = WritePlaceHeader(false, splace === "" ? "td-left-large" : "");
	var perMadison = findPerson("Madison");
	var myName = perYou.getMaster();
	if (splace === "") {
		perMadison.showPerson("madison13.jpg");
		addPlaceTitle(md, "Madison Under a Spell");
		md.write("<p>A devilish smile crosses her face as she completely strips of her skirt and leans against the couch seductively. " + '"Does this please you...  ' + myName + '?" she asks playfully.</p>' + '<p>You smile at her word choice.  "Yes, in fact it does," you say with an evil grin.  "As a ' +
			"matter of fact, lets keep the " + myName + ' thing going, shall we?" you say as you inspect the nubile young form before you.</p>' + '<p>"As you wish, ' + myName + '," she says, almost purring this time. ' + '"Is there anything else I can do to please ' + myName + '?"</p>' + '<p>"Well, there was one thing..." you say, stepping up and running your hands across her warm and inviting flesh.</p>' + "<p>Her body instantly reacts to your touch, a soft moan escaping her lips as you tease her nipples " + 'and your hand runs down to her moist and exposed snatch. "Do you like being my <i>slave</i>?" you whisper into her ear.</p>' +
			'<p>"Yessss..." she whispers in return as her body shudders with orgasm from your attention.</p>')
	} else {
		perMadison.showPerson("madison22.jpg");
		addPlaceTitle(md, "Madison Under a Spell");
		md.write("<p>A devilish smile crosses her face as she completely strips of her skirt and leans against the desk seductively. " + '"Does this please you...  ' + myName + '?" she asks playfully.</p>' + '<p>You smile at her word choice.  "Yes, in fact it does," you say with an evil grin.  "As a ' + "matter of fact, lets keep the " +
			myName + " thing going, shall " + 'we?" you say as you inspect the nubile young form before you.</p>' + '<p>"As you wish, ' + myName + '," she says, almost purring this time. ' + '"Is there anything else I can do to please ' + myName + '?"</p>' + '<p>"Well, there was one thing..." you say, stepping up and running your hands across her warm and inviting flesh.</p>' + "<p>Her body instantly reacts to your touch, a soft moan escaping her lips as you tease her nipples " + 'and your hand runs down to her moist and exposed snatch. "Do you like being my <i>slave</i>?" you whisper into her ear.</p>' +
			'<p>"Yessss..." she whispers in return as her body shudders with orgasm from your attention.</p>')
	}
	startQuestions();
	addLinkToPlace(md, "take it to the next level", 358, "place=" + splace);
	WritePlaceFooter(md)
}

function ShowPlace358() {
	var md = WritePlaceHeader();
	var splace = getQueryParam("place");
	var myName = perYou.getMaster();
	var perMadison = findPerson("Madison");
	if (splace === "") perMadison.showPerson("madison14.jpg");
	else perMadison.showPerson("madison23.jpg");
	addPlaceTitle(md, "Madison Under a Spell");
	md.write('<p>"Oh my <i>god</i>," she says as you step away from her.  "No one has <i>ever</i> ' + 'made me feel like that."  And you watch as she shudders from just thinking about ' + 'the orgasm she just experienced.  "You <i>have</i> to do that again."</p>' +
		'<p>"I don\'t <i>have</i> to do anything," you say forcefully.  "You are <i>my</i> ' + 'slave, remember?  I can get you fired at any time."</p>' + '<p>"But, but," she stutters, looking like a toddler that just had her favorite toy taken away.</p>' + '<p>"But nothing, slave.  I am your ' + myName + " now, " + "and you will do anything and everything I say just for the <i>hope</i> of pleasure " + 'the likes of which I just gave you."  Fear and doubt flash across her face as you ' + 'continue.  "Remember, you broke <i>my</i> radio..."</p>' +
		'<p>"Besides," you say, stepping up and running your hand down over her breast.  "Its ' + "not as if you didn't <i>like</i> being my slave and that was for just a moment.  Think " + "of what it would be like to be my slave... permanently.  You'd like that, wouldn't you.\"</p>" + '<p>It takes her a moment, but she eventually wispers... "Yes," ever-so-quietly.</p>' + '<p>"Yes... what?" you whisper flatly in her ear.</p>' + '<p>"Yes ' + myName + '," she says, finally looking you in the eye ' + "before you give her a deep, deep kiss.  You can feel her body shudder from yet another " +
		"orgasm as she finally gives in and accepts her fate.</p>" + '<p>"What do you wish of me, ' + myName + '?" she asks finally.</p>');
	startQuestions();
	addLinkToPlaceC(md, 'order her "Now you will make me cum"', 410, "type=oral&place=" + splace);
	if (!perYou.isMaleSex() && perYourBody.FindItem(45) === 0 && isExplicit(true)) addLinkToPlaceC(md, 'order her "Now I\'d like to fuck you"', 411, "type=fuck&place=" + splace);
	else if (perYou.isMaleSex() || !perYou.isMaleSex() && perYourBody.FindItem(45) > 0) addLinkToPlaceC(md, 'order her "Now I will fuck you"',
		410, "type=fuck&place=" + splace);
	if (!perYou.isMaleSex()) addLinkToPlaceC(md, 'ask her "Let us make love"', 410, "type=sex&place=" + splace);
	if (wherePerson("Diane") != -1)
		if (splace === "") addLinkToPlaceC(md, 'order her "Go back to the station and wait for me there."', 45);
		else addLinkToPlaceC(md, 'leave after you order her "Change clothes and always deliver me pleasure"', 371);
	WritePlaceFooter(md)
}

function ShowPlace359() {
	var md = WritePlaceHeader();
	if (!isPlaceKnown("PoliceStation")) setPlaceKnown("PoliceStation");
	if (!isPlaceKnown("TVStation")) setPlaceKnown("TVStation");
	addPlaceTitle(md, "Glenvale Radio & Television Station", "radio1.jpg");
	md.write("<p>Glenvale's single Radio and Television station. It may not look like much, " + "but inside are some relatively cutting-edge radio productions and the town's " + "very own news channel, MC Channel 4 at 10 O'Clock. Not the highest-rated news show on TV, but it does have some colorful faces.</p>" +
		"<p>One of those faces happens to be your Mother's. Well, she isn't on the TV so much as a part of the production crew.</p>" + "<p>The building also houses the recording and production offices for the local radio station MC 550 and a small package delivery company.<p>");
	startQuestions();
	addLinkToPlace(md, "enter the TV station", 371);
	addLinkToPlace(md, "walk to the police station", 167);
	WritePlaceFooter(md)
}

function ShowPlace360() {
	var md = WritePlaceHeader();
	setPlaceBreakIn("Aquarium", false);
	addPlaceTitle(md, "Glenvale Aquarium", "aquarium1.jpg");
	md.write("<p>Glenvale's Aquarium stands tall as one of the oldest aquariums in the area, and although its " + "age may be somewhat obvious from the look and architecture outside, " + "inside it is <i>the</i> most frequently remodeled aquarium - the " + "city trustees spending a lot of time, and money, on making sure that " + "they have the most modern and up-to-date scientific displays of oceanographic life.</p>" +
		"<p>It was also a great place to take a date on friday nights since the lighting was always kept so low.</p>");
	if (!isShopOpen(2, 0, true)) md.write("<p>The Aquarium has a sign noting that is closed, hours of business 8am to 8pm.</p>");
	startQuestions();
	if (isShopOpen(2, 0, true)) addLinkToPlace(md, "enter the Aquarium", 361);
	else if (isCharmedBy("Melissa")) addLinkToPlace(md, "ask Melissa to let you in", 361);
	addLinkToPlace(md, "walk to the Museum", 238);
	WritePlaceFooter(md)
}

function ShowPlace361() {
	if (!isShopOpen(2, 0, true) && !isPlaceBreakIn("Aquarium") && !isCharmedBy("Melissa")) return gotoPlaceDelayed(360, "", '<img src="UI/closed.png" style="float:left;width:15%;margin-right:5px">The Glenvale Aquarium closes and you have to leave for now.');
	var md = WritePlaceHeader();
	var plcM = wherePerson("Melissa");
	if (plcM != 361) addPlaceImage(md, "aquarium4.jpg");
	if (plcM == 369 || plcM == 370) AddImage("cleaning.png", "20%", "left");
	addPlaceTitle(md, "Glenvale Aquarium Front Hall");
	md.write("<p>The front hall of the aquarium has always been a rather daunting place.  Large tanks of water loom within stylized displays as fish of every sort lazily swim around in the clear prisons.</p>" +
		"<p>There are a few displays that were always town favorites: one is the Kelp Forest, and Oceans of the World is the other.</p>");
	if (!isShopOpen(2, 0, true)) md.write("<p>The information desk is empty while the aquarium is closed.</p>");
	else {
		md.write("<p>There is a small information desk to one side, with a helpful young woman attending.</p>");
		if (isCharmedBy("Abby")) md.write("<p>You overhear a man say he is going to ask for some information, and you hear his girlfriend reply &quot;Don't you dare!&quot;.</p>")
	}
	if (plcM ==
		369 || plcM == 370) md.write("<p>You see a sign at the entrance to the " + (plcM == 369 ? "Kelp Forest" : "Oceans of the World") + " display noting it is being cleaned.</p>");
	startQuestions();
	addLinkToPlace(md, "visit the Kelp Forest display", 369);
	addLinkToPlace(md, "visit the Oceans of the World display", 370);
	if (isShopOpen(2, 0, true)) {
		addLinkToPlace(md, "ask for help from the information desk", 394);
		addLinkToPlace(md, "leave the Aquarium", 360)
	} else if (isCharmedBy("Melissa")) addLinkToPlaceC(md, "ask Melissa to let you out of the Aquarium",
		360);
	else addTextForQuestions(md, "<b>The doors of the Aquarium are locked</b>", "center");
	WritePlaceFooter(md)
}

function ShowPlace362() {
	var perK = findPerson("Kristin");
	var clv = perK.getCharmedLevel();
	var md = WritePlaceHeader(false, clv !== 0 ? "td-left-large" : "");
	if (clv === 0) perK.showPerson("kristin1.jpg");
	else perK.showPerson("kristin3.jpg");
	if (clv === 0) addPlaceTitle(md, "Bank Manager");
	else addPlaceTitle(md, "Slave Kristin");
	if (clv === 0) {
		md.write("<p>A rather beautiful woman sits before you, busily typing and clicking away at her computer, presumably checking accounts.  After a short time, she finishes whatever task held her attention and turns in your direction.</p>");
		if (perK.checkFlag(12)) {
			md.write('<p>"Yes?" she asks very professionally.  "I see you wish to apply for a credit card"</p>');
			perK.setFlag(13);
			setPersonFlag("Mom", 6, false)
		} else md.write('<p>"Yes?" she asks very professionally.  "What can I do for you today?"</p>')
	} else md.write('<p>"It\'s the most peculiar thing," Kristen says as you enter.  "I find I just have to show myself off to you, ' + perYou.getMaster() + '.  Why do you suppose that could be?"  She pulls her top down to show herself off again.</p>');
	startQuestions();
	if (clv > 0) {
		addLinkToPlace(md, "elucidate the reasons for her behavior", Place, "type=elucidate");
		if (perK.checkFlag(8) &&
			!perK.checkFlag(10)) addQuestionC(md, "ask Kristin to close the Bank", "Kristin", 2800);
		if (!perYou.checkFlag(9)) addQuestionC(md, "ask Kristin to remove the limit on your bank account", "Kristin", 2900);
		if (!perK.checkFlag(5)) addQuestionC(md, "ask about Ellie", "Kristin", 100)
	}
	if (!perK.checkFlag(1)) addPopupLinkC(md, "introduce yourself", "Bank Manager", "<img src='Images/kristin0.jpg' style='width:25%;float:left;margin-right:5px' alt='Kristin'>" + "The Bank manager is a raven haired woman who is in her early thirties. Your first impression of her is that she is the typical bossy, business woman character who doesn\u2019t take no for an answer and achieves everything she wants. Women in high and powerful places tend to be selfish and careerist and you guess the same things motivates her too.<br><br>" +
		"She\u2019s talking on the phone when you and Ellie arrive in front of her office. Ellie knocks on the door and whispers into your ear.<br>" + '"Whatever you do, just don\u2019t make her angry and always make her feel that she\u2019s the boss around here! She can be stiff as stone if you offend her!" says Ellie and she hurridly leaves you alone with her boss.<br><br>' + "Ellie\u2019s attitude did not cool you down a single bit, for one it just made you more nervous than you usually feel when you meet with new people. As you wait for the manager to finish her talk on the phone you look around in her office you realize your first thoughts of her were true. When she finally hangs up the phone she offers her hand to shake and introduces herself.<br><br>" +
		'"Hello! The name\u2019s Kristin! What can I help you with?"', false, "setPersonFlag('Kristin',1);dispPlace();");
	else if (perK.checkFlag(1) && perYourBody.FindItem(27) > 0) addQuestionCO(md, "give her the Letter of Credit from Gates", "Kristin", 2701);
	else if (clv === 0 && perK.checkFlag(1) && perK.checkFlag(12)) addQuestionCO(md, "apply for a Credit Card", "Kristin", 2802);
	addLinkToPlace(md, "leave her office", 225);
	addLinkToPlace(md, "exit the Bank", 194);
	WritePlaceFooter(md)
}

function ShowPlace363() {
	var md = WritePlaceHeader();
	var perK = findPerson("Kristin");
	perK.showPerson("kristin2.jpg");
	addPlaceTitle(md, "Kristin Enspelled");
	if (perK.flags[0] < 5) perK.setFlag(1);
	md.write("<p>The shielded spell pulses outward, and suddenly everybody but you and your victim " + "has something better to do than look into the bank manager's office.  Kristin, for " + "her part, is looking a little flushed in your presence and, perhaps in some desperate " + "attempt to resist these feelings, studies the accounts on her desk.</p>" +
		'<p>"Well, ah, if you have no further business..." she bites her lip, needful, and after ' + 'a furtive glance her passion gets the better of her.  "Nothing else you want me for..."</p>' + '<p>You rise to the invitation, standing and leaning over her desk.  "As a matter of fact, ' + 'there is," you say.  Lithe and catlike (at least in her eyes), you crawl onto her desk.</p>' + "<p>She leans back in her seat and gazes up at you, surprised and uncertain.</p>" + '<p>"You look confused," you tell her, and she nods her assent, her smile matching yours in spite of the shock.</p>');
	startQuestions();
	addLinkToPlaceC(md, '"Is there something that doesn\'t add up?"', 364);
	WritePlaceFooter(md, "Script by Tilde")
}

function ShowPlace364() {
	var md = WritePlaceHeader(false, "td-left-large");
	var perK = findPerson("Kristin");
	perK.showPerson("kristin3.jpg");
	addPlaceTitle(md, "Kristin Enspelled");
	md.write('<p> "Yes," she says.  "It makes no sense that a customer would be on my desk."</p>' + '<p>"But I am," you laugh.  "And you don\'t mind in the least that I\'m up here."</p>' + '<p>"Of course," she agrees, but you can see the quick, logical mind spinning behind ' + "her glowing eyes.  \"But it doesn't add up that I wouldn't mind, either.  I'm very " +
		"picky about who I allow to approach me, and I certainly would never let someone stay " + 'on my desk long enough to be seen - it could cost me my job!"</p>' + '<p> "You know what else makes no sense?" you chuckle.  "Nobody\'s looking at us, even with the door open."</p>' + "<p>The two of you share a puzzled moment, looking out the door as a subaccountant " + "walks past with a cup of water from the water-cooler, and waves out of habit but doesn't look in.</p>" + '<p>"You\'re right," she gasps.</p>' + "<p>\"And it doesn't make sense that I know so much about what's going on,\" you " +
		'continue.  "Or the way that you have to take off your clothes."</p>' + '<p>"Seriously," she gripes, pulling down her top to reveal one large, perfect breast. "This is really mystifying."</p>');
	startQuestions();
	addLinkToPlaceC(md, '"Would you like me to <i>explain</i> it to you?"', 365);
	WritePlaceFooter(md, "Script by Tilde")
}

function ShowPlace365() {
	var md = WritePlaceHeader();
	var perK = findPerson("Kristin");
	perK.showPerson("kristin4.jpg");
	addPlaceTitle(md, "Kristin Enspelled");
	md.write('<p>"Please do?" she says, her voice oddly pleading as once more her attraction ' + "to you rises to the surface.</p>" + "<p>\"Well, let's review our facts, shall we?  I'm sure everything will make " + 'perfect sense if I list everything properly and you listen to me," you say, and she nods.</p>' + "<p>\"You don't mind that I am on your desk, nobody is paying attention to our " +
		"behavior, you are taking your clothes off for me, I understand everything " + 'perfectly, you are listening carefully to me so that you can understand as well-"</p>' + '<p>"Oh!" she interrupts you.  "Perhaps I\'m dreaming?"</p>' + '<p>"You should play with your breasts," you recommend, and she does.  Her face ' + "remains passive, though her breath comes a little heavier.</p>" + '<p>"I thought pinching was how you tested whether you were dreaming."</p>' + '<p>"It\'s a question of sensation," you explain.  "You can tell you aren\'t ' +
		"dreaming now, because you feel your hands kneading your breasts, arousing you, " + 'making you want to obey me more with every touch."</p>' + '<p>"Obey?" she says, her voice quavering.  "Why would my hands make me want to obey?"</p>');
	startQuestions();
	addLinkToPlaceC(md, '"Come up here a moment and I\'ll explain it in more detail."', 366);
	WritePlaceFooter(md, "Script by Tilde")
}

function ShowPlace366() {
	var md = WritePlaceHeader();
	var perK = findPerson("Kristin");
	perK.showPerson("kristin5.jpg");
	addPlaceTitle(md, "Kristin Enspelled");
	md.write("<p>She continues to disrobe and crawls onto the desk with you.</p>" + '<p>"It isn\'t your hands, specifically," you say, running your hands across her ' + 'shoulders, her stomach, teasingly up and down her inner thigh.  "My hands make ' + 'you want to obey even more effectively."  She shudders with rapture, helpless ' + "against her magic-induced yearning.</p>" +
		'<p>"Ohh...yes..." she gasps.</p>' + '<p>"And the more you listen, the less resistance you have, until you have no ' + "desire to disobey me at all.  You enjoy listening to me talk, and now that " + "I've explained things you're perfectly content because all of those things " + 'you were worried about make perfect sense."</p>' + '<p>"Ah," she says, as if you\'ve actually explained any of what she asked ' + 'about.  "That would make ours a slave/' + perYou.getMaster() + " " + 'relationship, then. Interesting.  When did I become your slave?"</p>' +
		'<p>"You\'ve always been my slave," you lie easily.  "You simply didn\'t ' + 'understand it completely until I explained it to you, just now."</p>');
	startQuestions();
	addLinkToPlace(md, "command your slave to show herself off", 367);
	WritePlaceFooter(md, "Script by Tilde")
}

function ShowPlace367() {
	var md = WritePlaceHeader();
	var perK = findPerson("Kristin");
	perK.showPerson("kristin7.jpg");
	addPlaceTitle(md, "Kristin Enslaved");
	md.write("<p>Kristin shows off her well-groomed body for your pleasure.  \"I'm so glad " + "you explained my enslavement to me, " + perYou.getMaster() + "." + "Smart as I am, it was so  confusing that I might never have figured it out on my own.  You're so clever!\"</p>" + '<p>"Yes," you agree, blithely drawing her near again.  "Yes I am," you whisper ' + "into her ear, as the two of you begin to go at it.</p>" +
		"<p>At some point, the mail is delivered, but the mailman doesn't notice " + "the sounds and never looks up from the floor, where he leaves the mailbin.</p>");
	startQuestions();
	addLinkToPlace(md, "leave your oh so understanding slave", 225);
	WritePlaceFooter(md, "Script by Tilde")
}

function ShowPlace369() {
	var md = WritePlaceHeader();
	addPlaceTitle(md, "The Kelp Forest", "aquarium2.jpg");
	md.write("<p>This display is a blatant knock-off from the one in California, but that doesn't keep it from being a Glenvale favorite.</p>");
	if (isShopOpen(2, 0, true)) md.write("<p>There are always people milling about in front of the displays - watching as the kelp sways slightly in the simulated waves as all the little fish swim around.</p>");
	else md.write("<p>There are usually people milling about in front of the displays - watching as the kelp sways slightly in the simulated waves as all the little fish swim around, but not now.</p>");
	startQuestions();
	addLinkToPlace(md, "sit and watch the kelp", "", "", "You sit for a while, almost mesmerised by the swaying kelp", "", "WaitHere(5);");
	addLinkToPlace(md, "visit the Front Hall", 361);
	addLinkToPlace(md, "visit the Oceans of the World display", 370);
	if (isShopOpen(2, 0, true)) addLinkToPlace(md, "leave the Aquarium", 360);
	else addTextForQuestions(md, "<b>The doors of the Aquarium are locked</b>", "center");
	WritePlaceFooter(md)
}

function ShowPlace370() {
	var md = WritePlaceHeader();
	addPlaceTitle(md, "The Oceans of the World", "aquarium5.jpg");
	md.write("<p>This display is a series of large tanks, each containing a vista from a different ocean from around the world - hence the name.  It used to be a lot more popular with the crowds but as one of the older displays it seems to have fared poorly in the Aquarium's popularity contest.</p>");
	startQuestions();
	addLinkToPlace(md, "visit the Front Hall", 361);
	addLinkToPlace(md, "visit the Kelp Forest display",
		369);
	if (isShopOpen(2, 0, true)) addLinkToPlace(md, "leave the Aquarium", 360);
	else addTextForQuestions(md, "<b>The doors of the Aquarium are locked</b>", "center");
	WritePlaceFooter(md)
}

function ShowPlace371() {
	var md = WritePlaceHeader();
	var perMom = findPerson("Mom");
	if (sType !== "byesuitcase2" && !isDay()) {
		addPlaceTitle(md, "Radio/TV Station Reception", "radioreception.jpg");
		md.write("<p>The reception area of the TV and Radio Station is not staffed at night. There are few people around in this part of the building.</p>" + "<p>The hallway into the office area is locked at this time of night.</p>");
		startQuestions()
	} else {
		var perNina = findPerson("Nina");
		var perMadison = findPerson("Madison");
		var nNinaCharm =
			perNina.getCharmedLevel();
		if (nNinaCharm === 0) perNina.showPerson("nina1.jpg");
		else perNina.showPerson("nina9.jpg");
		addPlaceTitle(md, "Radio/TV Station Reception");
		if (!perNina.checkFlag(1)) md.write("<p>The sound of bells signals your entrance into the building.  A lovely young lady is sitting at the reception desk, chatting on the phone.  She doesn't look up.</p>");
		else if (nNinaCharm === 0) md.write("<p>Nina is still chatting on the phone.</p>");
		else md.write("<p>The sound of the door bells lets Nina know that someone is there.  Seeing that it's you, she leans on her desk and smiles.  She's no longer wearing panties.</p>" +
			"<p>Now she doesn\u2019t hang on the phone like she used to do, instead she\u2019s trying to prove her worth to you by throwing herself at your feet and nagging you by always asking questions or telling you ideas how she could serve. She\u2019s still really annoying, so if you have some freetime you should train Nina to be your personal whore rather than a disturbing bimbo who she is at the moment!</p>");
		startQuestions();
		if (perMadison.isCharmedBy()) addLinkToPlaceC(md, "ask to see Madison", 412, "enter=true");
		else if (perYou.checkFlag(2)) addLinkToPlaceC(md, "ask to see the person who delivered your prize", 413, "enter=true");
		else if (wherePerson("Diane") == -1) addLinkToPlaceC(md, "ask to see Madison", 413, "enter=true");
		if (perMom.place == 415) addLinkToPlace(md, "go to the office hallway", 372)
	}
	addLinkToPlace(md, "leave the station", 359);
	WritePlaceFooter(md)
}

function ShowPlace372() {
	var md = WritePlaceHeader();
	var perMom = findPerson("Mom");
	addPlaceTitle(md, "Radio/TV Station Hallway", "radio-corridor.jpg");
	md.write("<p>A basic hallway connecting the various studios and offices, nothing special.</p>");
	startQuestions();
	if (isDay()) {
		if (perMom.place == 452) addLinkToPlace(md, "visit Mom at work", 372, "", "Mom's office is... empty. That's strange, you know for sure that she is not back home, yet, but she appearently took the suitcase with her...</p><p>Maybe they are at Gabby's home on <b>11 Amaranth Pl</b>?",
			"", "setPlaceKnown('GabbysHouse')");
		else if (perMom.place == 415) addLinkToPlace(md, "visit Mom at work", 415);
		addLinkToPlace(md, "return to reception", 371)
	} else {
		if (perMom.place == 452) addLinkToPlace(md, "look into Mom's office", 372, "", "Mom's office is... empty. That's strange, you know for sure that she is not back home, yet, but she appearently took the suitcase with her...</p><p>Maybe they are at Gabby's home on <b>11 Amaranth Pl</b>?", "", "setPlaceKnown('GabbysHouse')");
		if (nMana < 2) addLinkToPlace(md, "hide somewhere within the studio until tomorrow",
			"", "", "You -really- could have planned this better. The studio is still locked and without Mana you have no way to get outside, but lucky for you, it's a big place.</p><p>You find a quiet corner where no one would immediately find you and make sure to get out unnoticed the moment the studio opens", "", "WaitforForDayNight();");
		addLinkToPlace(md, "return to reception", 372, "", "The studio doors are locked and you cannot go there")
	}
	WritePlaceFooter(md)
}

function ShowPlace374() {
	var md;
	if (perJesse.whereNow() == 6) {
		md = WritePlaceHeader(false, perJesse.checkFlag(3) ? "" : "td-left-large");
		var myName = perYou.getPersonName();
		if (wherePerson("Miku") == 408) setPersonFlag("Miku", 24);
		if (perJesse.checkFlag(3)) perJesse.showPerson("jesse9.jpg");
		else perJesse.showPerson("jesse8.jpg");
		addPlaceTitle(md, "Your Visitor in the Living Room");
		md.write("<p>When you enter your living room you know who is there before you even lay eyes on her.  Her <i>scent</i> gives her away.  You steel yourself against her influence as best you can as you enter.</p>");
		if (perJesse.getDemonPath() == 60) {
			perJesse.setDemonPath(61);
			md.write('<p>"Hello there, ' + myName + '.  May we speak for a moment?" she asks, her voice not quite as sultry as you seem to recall it usually was when she was trying to seduce you.</p>')
		}
		if (perJesse.checkFlag(3) && perJesse.getDemonPath() < 65) md.write("<p>\"Concerned for my little thrall's safety, " + myName + '?" she asks.  "Why?  Have you changed your mind about me?  Do you want me?" she asks, as her strength of her scent almost triples in intensity, making your head swoon.  "Would you like to... Kiss me?" she asks, wetting her lips.</p>');
		else if (perJesse.getDemonPath() == 70) md.write('<p>"I am here to declare a truce," she says.  "That is why I resisted the urge to enthrall your oh-so-tasty mother.  Her... <i>innocence</i> smells so sweet.  Not an easy thing to pass up."</p>' + '<p>The look on your face at her thinly veiled threat must have given her pause.  "I give you my word," she says in the most honest tone you have heard the creature use.  "As long as our truce lasts, I shall do no harm to your family.  I am a creature of habit,' +
			myName + ', and my word is binding."</p>');
		else if (perJesse.getDemonPath() == 75) md.write('<p>"There is a special...  locket.  That We need.  But it is guarded in a place that we can not go.  We need this locket.  Get it for Us and we will leave you and your town to its own devices."</p>' + '<p>"And in return, We will give you this," she says, brandishing a small old stone in her hand that looks very familiar.  "We know you want this...  Your type always wants this..." she says, instinctually lacing her voice with a hint of lust.</p>');
		startQuestions();
		if (!perJesse.checkFlag(3) && !perJesse.checkFlag(4) && perJesse.getDemonPath() < 65) addQuestionC(md, '"What happened to your pet?"', "Jesse", 1843);
		else if (!perJesse.checkFlag(4)) {
			addLinkToPlace(md, "Give in to temptation and <i>kiss</i> her", 995);
			addQuestionC(md, '"Shove off, <i>Legion</i>.  I will not fall for that trick."', "Jesse", 1844)
		}
		if (!perJesse.checkFlag(5) && perJesse.getDemonPath() < 65) addQuestionC(md, '"What did you do to my Mother?"', "Jesse", 1845);
		if (perJesse.getDemonPath() == 65) addQuestionC(md,
			'"Why are you here, <i>Legion</i>?"', "Jesse", 14465);
		else if (perJesse.getDemonPath() == 70) addQuestionC(md, '"Fine then.  What do you want for this truce?"', "Jesse", 14470);
		if (perJesse.checkFlag(8)) addQuestionCO(md, "Take the stone from her hand", "Jesse", 1848)
	} else {
		var perTracy = findPerson("Tracy");
		var clvT = perTracy.getCharmedLevel("You");
		var plcTracy = perTracy.whereNow();
		if (plcTracy == 374) {
			md = WritePlaceHeader();
			if (perTracy.isCharmedBy("You") > 0) perTracy.showPersonRandomDN("tracy5", isDay() ? 1 : 2);
			else perTracy.showPersonRandomDN("tracy1",
				2);
			addPlaceTitle(md, "Tracy in the Living Room")
		} else {
			md = WritePlaceHeader(false, "td-left-med");
			addPlaceTitle(md, "Your Living Room", "livingroom8.jpg")
		}
		md.write("<p>Your living room, fairly standard, the only notable thing is the large TV.</p>");
		startQuestions();
		var img;
		var js = "";
		var msg = "";
		if (clvT > 0 && isCharmedBy("Mom") && !checkPersonFlag("Mom", 33) && plcTracy == 374) {
			img = "momtv1.mp4";
			js = 'setPersonFlag("Mom",33)';
			msg = 'As you sit with Tracy to watch the video she tells you</p><p>"This is a video I found recently, I thought you might like it"<p><p>The video is of Mom with some woman you do not recognise! Tracy grins "Well I found it in her room..."'
		} else if (clvT >
			0 && plcTracy == 374) {
			var ex = isExplicit() && Math.random() < .6;
			img = (ex ? "Explicit/" : "") + "tracytv" + Math.ceil(Math.random() * 4) + ".gif"
		} else img = "tv" + (plcTracy == 374 ? "1" : Math.random() < .5 ? "2" : "3") + ".jpg";
		addWatchTVLink(md, "watch some TV", "TV Time" + (plcTracy == 374 ? " with Tracy" : ""), msg != "" ? msg : plcTracy == 374 ? "You kill some time watching a TV show with Tracy" + (clvT > 0 ? ", although you quickly see you are watching a show <b>of</b> Tracy. You look at her and she smiles cheekily." : "") : "You spend some time catching up on the news on TV, although not the station you would watch with Mom around.",
			img, js)
	}
	addLinkToPlace(md, "walk to the kitchen", 45);
	addLinkToPlace(md, "leave your house", 44);
	WritePlaceFooter(md)
}

function GoRoom113() {
	if (perJesse.getDemonPath() == 150) {
		perJesse.flags[0] = 0;
		perJesse.setFlag(10)
	}
	if (perJesse.getDemonPath() < 500) perJesse.setFlag(1);
	else perJesse.setFlag(1, false);
	perJesse.setFlag(5, false);
	perJesse.setFlag(7, false);
	gotoPlace(375)
}

function ShowPlace375(stype) {
	var md = WritePlaceHeader();
	var perLucy = findPerson("Lucy");
	var bDemonHere = perJesse.place == 8;
	if (bDemonHere)
		if (perJesse.checkFlag(5)) {
			perLucy.showPerson("lucy12a.jpg");
			perLucy.showPerson("lucy12b.jpg");
			perLucy.showPerson("lucy12c.jpg")
		} else if (perJesse.checkFlag(1)) perJesse.showPerson("jesse10.jpg");
	else perJesse.showPerson("jesse11.jpg");
	else if (perJesse.getDemonPath() < 600 || isDemonGone()) perLucy.showPerson("lucythrall1.jpg");
	else perJesse.showPerson("jesse22.jpg");
	addPlaceTitle(md,
		"Room 113 At the Broken Inn Hotel");
	if (bDemonHere) {
		if (perJesse.getDemonPath() < 500) md.write("<p>A familiar scent assails your senses as you step through the door.  Jesse must have been here for a while to have this strong of an effect without a potential victim to enthrall.  Or, perhaps she was simply preparing for <i>your</i> arrival.</p>");
		if (perJesse.getDemonPath() == 150) {
			perJesse.setDemonPath(151);
			md.write('<p>"So, ' + perYou.getPersonName() + '.  We know you have the artifact. We have been keeping our eyes on you. Do you have it with you?  May We have it?" she asks, her voice quickly developing a commanding tone. "Give it to Us," she demands, her arms idly playing with her latest thrall.</p>')
		} else if (perJesse.getDemonPath() <
			500)
			if (!perJesse.checkFlag(5)) md.write("<p>Jesse looks at you expectantly, her entire form almost seems to quiver in anticipation - conjuring images of a tiger about to pounce on its unsuspecting prey.</p>" + '<p>"Do you have it?" she asks.  "Give it to Us."</p>');
			else md.write('<p>"Not that We need <i>your</i> permission," she hisses, turning to her thrall.</p>' + "<p>The thrall begins to move in a hollow mockery of a strip tease. It's movements are awkward and filled with sudden jerks; a puppet with invisible strings. Jesse watches with a look of intense concentration on her face and her scent thick in the air. Directly manipulating her thrall, while obviously pleasurable, requires great focus on her part.</p>")
	} else if (isDemonQuestDone()) {
		if (perJesse.getDemonPath() ==
			500) md.write("<p>Moments later, the locket falls to the floor as Jesse opens her eyes.  For the first time since the s\u00e9ance she is in control of her own body, her eyes no longer colored red with the demon's malice.  \"Oh my god!\" she gasps.  She runs to the bathroom, and you can here the sounds of retching.  You decide to leave her be, at least for the moment.  She's had a rough day.</p>");
		if (perJesse.getDemonPath() == 900) {
			md.write("<p>The thrall that the demon left behind still hovers in the room her Mistress left her in.</p>" +
				"<p>She comes up to you and presses her warm body against you, and try as you might you can't help but become aroused when in its presence.</p>" + "<p>Only the eyes betray the otherworldly nature of what used to be a young woman - before the demon devoured her soul and turned her into this creature of pure sexual appitite.</p>");
			if (perLucy.checkFlag(1)) md.write("<p>As she leans forward you notice she has something in her hand.  She holds it out to you as if presenting you with a offering in supplication.</p>")
		} else if (perJesse.getDemonPath() <
			600) {
			md.write("<p>The thrall that the demon left behind still hovers in the room her Mistress left her in.</p>" + "<p>She comes up to you and presses her warm body against you, and try as you might you can't help but become aroused when in its presence.</p>" + "<p>Only the eyes betray the otherworldly nature of what used to be a young woman - before the demon devoured her soul and turned her into this creature of pure sexual appitite.</p>");
			if (perLucy.checkFlag(1)) md.write("<p>As she leans forward you notice she has something in her hand.  She holds it out to you as if presenting you with a offering in supplication.</p>");
			switch (perJesse.getDemonPath()) {
				case 501:
					md.write("<p>Jesse is still in the bathroom, the occasional sound of her retching can be heard.</p>");
					break;
				case 504:
				case 502:
					md.write("<p>Jesse is still in the bathroom, and she is weakly washing herself.</p>");
					break;
				case 503:
					md.write("<p>Jesse is still in the bathroom, a renewed bout of illness has stuck her.</p>");
					break;
				default:
					md.write("<p>Jesse is lying on a bed, awake but she does not seem to be paying any attention, lost in her illness and her memories of her time possessed.</p>");
					break
			}
			if (perJesse.getDemonPath() == 500) perJesse.setDemonPath(501)
		} else if (perJesse.getDemonPath() >= 600) {
			if (perJesse.getDemonPath() == 600) md.write("<p>Jesse and her 'friend' Lucy cheerfully greet with Jesse sating</p>" + '<p>"Hi, I was just starting to feel a little bored! What\'s going on?"');
			else md.write("<p>Jesse and her 'friend' Lucy cheerfully greet with Jesse sating</p>" + '<p>"Hi, I was just starting to feel a little bored! What\'s going on?"');
			if (perLucy.checkFlag(1)) md.write("<p>As she leans forward you notice she has something in her hand.  She holds it out to you as if presenting you with a offering in supplication.</p>")
		}
	}
	startQuestions();
	addLinkToPlace(md, "walk back to the bar", 124);
	addLinkToPlace(md, "leave the hotel", 123);
	WritePlaceFooter(md)
}

function ShowPlace382(stype) {
	var perMS = findPerson("Daria");
	var perLea = findPerson("Leanne");
	var nPossession = isPossess() && perLea.place != 382 && perMS.checkFlag(6) ? 2 : isPossess() ? 1 : 0;
	var td = "";
	if (stype == "metleanne") td = "td-left-med";
	else if (stype == "take") td = "td-left-large";
	else if (stype == "msmast" || nPossession == 2 && stype === "") td = "td-none";
	var md = WritePlaceHeader(false, td, td == "td-none" ? "black" : "");
	if (stype == "metleanne") {
		perLea.showPerson("leanne6b.jpg");
		addPlaceTitle(md, "Leanne in Mother Superior's Bed");
		md.write("<p>The woman's appearance changes and you see Leanne lying on the bed, or at least the thrall in her body. You can see no sign of the rosary she had a moment ago. She laughs and speaks to you,</p>" +
			'<p>"So, this thralls Mistress is not the only one who can take a body. Did you enjoy devouring her soul?"</p>' + "<p>You deny harming Mother Superior and tell the thrall you are just borrowing her body, her mind and soul are unconscious...and then you hear something, it is the confused voice of the Mother Superior wondering what Leanne is talking about. The voice fades away as if she falls asleep. " + "You are unsure what this means, it seems that she is still partly conscious. The Mother Superior is of such a strong will, or some other magical or spiritual effect, or even the presence of the thrall must allow her some awareness. As you consider this the thrall continues speaking,</p>" +
			'<p>"Are you here then to save this thrall, it cannot leave here, the holyness is oppressive, and this woman has promised to save her and she dragged this body here." She laughs cruelly, "As if that is possible". You dimly hear the Mother Superior <i>"...so hard to get an exorcist..could be weeks..I will save you Leanne..."</i></p>' + "<p>You ask the thrall how she came to be here, did she try to seduce one of the Brides of Christ, a nun, and she smiles,</p>" + '<p>"Tried, but it was this woman and she knows this body and recognised the presence of this thrall and sealed it here"</p>' +
			'<p>You hear the voice of the Mother Superior <i>"...Leanne, I need to save her, I just wish she would keep her clothes on, she is so very beautiful.."</i>. You ask the thrall about the glamour she had when you first saw her,</p>' + '<p>"To make this body as desirable as possible to the woman you have taken, to tempt her lust", you dimly hear the Mother Superior again <i>"..so very.."</i></p>' + "<p>You look at the thrall and vow to find a way to help Leanne, but as you do you hear the thrall,</p>" + '<p>"This body is full of lust, take it now using that woman!" and you dimly hear <i>"no..I could not..."</i></p>')
	} else if (stype ==
		"takeyou") {
		perLea.setFlag(12);
		perLea.showPerson("leanne6c.jpg");
		addPlaceTitle(md, "Taking the Thrall Personally");
		md.write("<p>You take the thrall, as yourself (to be expanded).</p>")
	} else if (stype == "take") {
		perLea.showPerson("leanne6c.jpg");
		addPlaceTitle(md, "Thrall and Mother Superior");
		if (perLea.checkFlag(5)) md.write("<p>Once again you tell yourself that this is not your friend Leanne, it is her body, but this is a thrall of the demon Legion, not Leanne.");
		else md.write("<p>You tell yourself that this is not your friend Leanne, it is her body, but this is a thrall of the demon Legion, not Leanne. You keep telling yourself that as you approach her.");
		md.write(" Furthermore this is the Mother Superior not you who will be doing it, you wonder how the Mother Superior will react to this act of carnality, especially as she seems to not quite be aware that you are possessing her body, or more sharing her body.");
		if (perYou.isBornMale()) md.write(" You do feel a bit nervous, you are possessing a woman and are going to have lesbian sex with the thrall possessing your best friend. You hope the porn you have seen helps here, as will the thrall.");
		md.write('</p><p>You are unsure how the robes of the nun\'s habit tied or fastened and as you start to fumble you hear the Mother Superior <i>"...I suppose I should rest.."</i> and you feel your/her hand more surely move to remove the robes. The thrall watches with considerable relish, and you see her fingers start to caress her pussy.</p>' +
			'<p>As you remove the last layers you realise the Mother Superior is wearing almost no underwear just a simple shift, and you also can feel she has a rather nice figure. You hear her think <i>"..got to keep fit..but wait Leanne is here..Daria what were you thinking, keep focus..."</i>. Despite that her words fade away, at least you know now her given name is Daria and she still seems unaware of your presence.</p>' + "<p>Maybe you should stop, but then again this may help to <b>weaken</b> the Mother Superiors resolve as she seems to think she is doing this herself!</p>");
		startQuestions();
		addLinkToPlaceC(md, '"No", stop this', 382);
		addLinkToPlaceC(md, '"<i>We</i> will do this"', 382, "type=take2");
		WritePlaceFooter(md, "", true, true);
		return
	} else if (stype == "take2") {
		perLea.setFlag(6);
		perMS.setFlag(1);
		perLea.showPerson("leanne6d.jpg");
		addPlaceTitle(md, "Take the Thrall with Mother Superior");
		if (perYou.isBornMale()) md.write("<p>You approach the thrall, still nervous as to how to do this, but you trust the thrall will lead the way and maybe Mother Superior too.</p>");
		md.write("<p>You reach out and embrace the thrall, as you do she passionately kisses the Mother Superior...you..and you are aware of the hot lust in her lips and body.</p>" +
			"<p>You can hear the Mother Superior trying to deny this and you can sense she is fully feeling everything, but still seems unaware of your presence. You decide to try something, you break the kiss and tell the thrall,</p>" + '<p>"I want you, and I am so aroused", and the thrall replies seeming to understand what you are trying to do,</p>' + '<p>"Everyone feels desire, our bodies need sex and we should give in to desire", and with that she lies you down and buries her face in your groin. licking and kissing with great expertise. You hear the Mother Superior, and her words almost echo yours. <i>I had not thought Leanne was bi-sexual..</i> and her words tail away into incoherent sounds of pleasure.</p>' +
			"<p>The thrall teases you and Daria, the Mother Superior, bringing you near to ecstasy and then pulling back and kissing you for a time, then bringing you to the brink again. She repeat this until you both are begging her to let you cum, the Mother Superior stridently in your head, and you loudly.</p>" + "<p>With a wicked grin the thrall takes you to a powerful orgasm, and barely had you recovered and she repositions herself so her pussy is above your face for you to do the same to her, except you immediately realise she is more positioned so you can both pleasure each other.</p>" +
			"<p>Later as you are relaxed in the after-glow of your orgasms, and the thrall is lying content from hers, you realise the Mother Superior had stopped resisting, and denying thing and was actively enjoying the experience, and you dimly hear her words <i>..well, I do not believe I gave in to temptation so easily, and loved it so much..</i></p>" + "<p>You wonder if maybe you could do this again, and 'train' her to be less inhibited and more receptive to you. Then again, the thrall is probably going to be an issue, wanting to corrupt the Mother Superior for her Mistress, not...well...for you. It would probably be best to first save Leanne!</p>")
	} else if (stype ==
		"msmast") {
		addPlaceTitle(md, "Remembering Leanne", "", 0, false, "white");
		perMS.showPersonRandomRorX("mothersuperior3", 2, "30%", "left");
		perMS.setFlag(2);
		perMS.moveThem(384);
		md.write("<p>You do your best to remember when you had sex with the thrall while possessing Daria, about the pleasure and your and the Mother Superiors orgasms. As you do you can feel a building arousal in Daria/your body, your thoughts are having an effect! Daria again interrupts,</p>" + '<p><i>"I...I...should not dwell on this, it has been difficult to stop thinking about...I am feeling the sinful lust again.."</i></p>' +
			"<p>You try to continue thinking but now more about satisfying your current lust. About there is nothing sinful really, it is just how you act on lust that may be sinful. Bodies are created to feel this way, so why not....</p>" + '<p><i>"...I do not think that is right...but it is so hard to think clearly recently...I really want to..."</i></p>' + "<p>You push again, why not, we were created to feel this way, and it is a glorious feeling, and that is it. You feel Daria stop resisting and her hands move to her groin and she starts to urgently masturbate. In your determination to encourage her you had not noticed how very, very aroused she/you were becoming.</p>" +
			'<p>You can hear her incoherent thoughts, and then brokenly <i>"God...Leanne..."</i>, and you are shocked by her intense orgasm</p>' + '<p>Her fingers gently rub and caress her pussy and you hear her think "<i>maybe once more..</i>" and you insistently think "twice" and you hear her, <i>"well..let\'s be damned for more...twice"</i></p>' + "<p>She starts to more urgently rub, but as she does you can feel her thoughts fade....</p>");
		startQuestions("Your vision fades");
		addOptionLink(md, "...and the spell ends",
			"Dispossession()");
		WritePlaceFooter(md, "", true, true);
		return
	} else if (stype == "mswander") {
		perMS.showPerson("mothersuperior5b.jpg");
		addPlaceTitle(md, "Mother Superior Taking a Stroll");
		perMS.setFlag(3);
		perMS.moveThem(384);
		md.write("<p>You think that it is best to finish dressing back in your room, and that there is no-one else around. Daria seems shocked at this thought,</p>" + '<p><i>"..n..no..I couldn\'t just walk through the church naked!...It is so naughty...sinfull..."</i></p>' + "<p>You agree, it's so naughty, but it is not a sin is it? If no-one is around then is it just walking somewhere after all?</p>" +
			"<p>Daria steps out of the vestry into the church proper, and she starts to walk nervously down the central pathway, despite common assumptions this is not called the aisle!</p>" + "<p>Daria's nerves settle down as she walks towards the archway leading to the cloisters and her room, but she hesitates looking around the church, and you can feel she is enjoying this naughty experience.</p>" + "<p>Suddenly there is a noise, the main door of the church opens, and with a burst of speed Daria runs out of the church, along the cloister pathway and quickly into her room and slams the door shut behind her.</p>" +
			'<p><i>"Who was that...a parishoner...Pamela...a Sister...I am so embarrassed"</i></p>' + "<p>Despite her thoughts, you can feel her excitement and arousal. You try to encourage her further, but as you start the feelings fade...</p>");
		startQuestions("Your vision fades");
		addOptionLink(md, "...and the spell ends", "Dispossession()");
		addLinkToPlace(md, "No!!! Concentrate on her arousal and Leanne", 382, "type=msmast");
		WritePlaceFooter(md, "", true, true);
		return
	} else {
		if (perMS.checkFlag(1) && !isPossess()) {
			perMS.showPerson("mothersuperior2.jpg");
			addPlaceTitle(md, "Mother Superior' Penance");
			md.write("<p>Mother Superior is still in her room, her habit only partially replaced from your earlier possession of her. She seems lost deep in prayer.</p>")
		} else if (nPossession == 2) {
			addPlaceTitle(md, "Mother Superior Changing", "", 0, false, "white");
			perMS.showPerson("mothersuperior5a.jpg", "30%", "right");
			md.write("<p>For a long while you experience nothing, just blackness and silence. Gradually you start to see and you are in some sort of room in the church. To your distress you have no control, you try to turn, reach out a hand and nothing happens. You then hear Daria, the Mother Superiors thoughts,</p>" +
				'<p><i>"..he always leaves the vestry in a mess. I will have to get Desiree to tidy up here. She has been a problem lately, claiming to have a revelation but being unwilling to talk about it, just waiting there in the courtyard..."</i></p>' + "<p>You are clearly in her body, but it seems the possession has barely worked, her iron will seems to still be there and almost prevented you possessing her. It seems <b>unlikely</b> you will be able to possess her again.</p>" + "<p>Your thoughts are interrupted by Daria,</p>" +
				'<p><i>"in her body...Leanne...I should not think about that...."</i></p>' + "<p>Did she hear you, but she seemed to think it was her own thoughts. Then you feel a chill in her, your, both of your body,</p>" + '<p><i>"Blessed draft...I should finish dressing...", and she looks at a mirror and you see she is only partly dressed in the light from a large stained-glass window.</i></p>' + "<p>You wonder if you can influence her thoughts more...</p>");
			startQuestions();
			addLinkToPlace(md, "remember sex with the Thrall Leanne",
				382, "type=msmast");
			addLinkToPlace(md, "dress back in my room", 382, "type=mswander");
			addLinkToPlace(md, "discipline Desiree", 332, "type=discipline");
			WritePlaceFooter(md, "", true, true);
			return
		} else {
			addPlaceTitle(md, "Mother Superior's Room", "nunroom1.jpg");
			md.write('<p>A very simple room decorated in a way that would most generously be called "spartan".</p><p>For a moment you are amazed at how few trappings these Nuns live with.</p>');
			if (perMS.checkFlag(4)) md.write("<p>A small bowl of chicken soup sits on a table next to the bed, evidently her way of nursing herself back to health.</p>")
		}
		if (perLea.isHere()) {
			md.write("<p>How can you help Leanne? You doubt you could just walk with her out of here, and even if you did, you have no hold over her. ");
			if (isDemonInTown()) md.write("After all the demon is still in Glenvale and would just take control over her again, so you would just be freeing her for the demon to use.");
			else if (perYou.checkFlag(21)) md.write("You could teleport with her out of here but where to and how to free Leanne of the spell. At least here she is safe and unable to harm others. You really need to seek other peoples <b>advice</b>.</p>")
		}
		if (!isPossess() && !perMS.checkFlag(1)) {
			showPopupWindow("Mother Superior", "<img src='Images/mothersuperior1d.jpg' style='width:40%;float:right;margin-left:5px' alt='Mother Superior'>" +
				"Mother Superior hears your enter her room and immediately forces you back out.<br>" + '"How dare you!" she cries, her voice breaking from the strain of her illness. "Get out, you perverted creature!"', "dispPlace(318)");
			WritePlaceFooter(md, "", true, true);
			return
		}
		if (!isPlaceKnown("MotherSuperiorsRoom")) {
			setPlaceKnown("MotherSuperiorsRoom");
			showPopupWindow("Familiar Woman", "<img src='Images/leanne6a.jpg' class='imgpopup' alt='Familiar Woman?'>" + "You become aware of standing in a room, dressed in heavy robes. You are in Mother Superior's body and her private room! " +
				"You did feel a great resistance as the spell completed and you became aware. Mother Superior has a very strong will and it seems unlikely you could possibly repeat this unless she were <b>weakened</b> in some way.</p>" + "<p>You hear a voice and see a familiar looking woman lying on her bed, naked except for a rosary, looking at you seductively, and she says</p>" + '<p>"It is you...no need for this glamour", and her appearance shimmers...', "dispPlace(382,'type=metleanne');");
			perLea.place = 382;
			WritePlaceFooter(md,
				"", true, true);
			return
		}
	}
	startQuestions();
	if (perLea.isHere() && stype != "take2" && stype != "takeyou") {
		perYou.startQuest(5);
		addLinkToPlace(md, "take the thrall", 382, isPossess() ? "type=take" : "type=takeyou");
		if (perLea.checkFlag(6) && !isPlaceKnown("MotherSuperiorsSecretRoom") && !isSpellKnown("Clairvoyance")) addQuestionC(md, '"Do you know where the relic is"', "Leanne", -100);
		if (nMana > 0 && isPlaceAttuned(53) && perYou.checkFlag(21) && perLea.checkFlag(8) && whereItem(35) == -53 && !isPossess()) addLinkToPlace(md, "teleport with the thrall to the Hidden Room",
			53, "type=teleportthrall")
	}
	if (isPlaceKnown("MotherSuperiorsSecretRoom")) addLinkToPlace(md, "enter the secret room", 383);
	addLinkToPlace(md, "walk back to the cloisters", 406);
	if (perLea.isHere() && stype === "") {
		AddPeopleColumnLarge();
		perLea.showPerson("leanne6b.jpg")
	}
	WritePlaceFooter(md)
}

function ShowPlace383() {
	var md = WritePlaceHeader();
	var perMS = findPerson("Daria");
	addPlaceTitle(md, "Mother Superior's Secret Room", "nunroom2.jpg");
	md.write("<p>A small hidden room with a door that blends in <i>perfectly</i> with the wall around it.</p>" + "<p>Were it not for magic you would have never noticed it against the wall.  In fact, if you didn't know better you would swear it was magic that hid it from you in the first place.</p>");
	if (whereItem(48) == Place) md.write("<p>On a small table, with a simple white cloth, lies a small locket.  Not much to look at but, considering it's the only thing in the room and the amount of trouble it was to find, it has to be the Relic that she protected so fervently.</p>");
	startQuestions();
	addLinkToPlace(md, "leave the secret room", perMS.place == 382 ? 382 : 384);
	WritePlaceFooter(md)
}

function ShowPlace384(stype) {
	var perMS = findPerson("Daria");
	perMS.setFlag(7);
	var idx;
	var img;
	var clv = perMS.getCharmedLevel();
	var perSister = findPerson("Desiree");
	var bDesireeHere = perSister.isHere() && !perSister.checkFlag(1);
	var be = perMS.checkFlag(11) ? "-be" : "";
	var futa = perMS.getPersonGender() == "futa" ? "f" : "g";
	var fb = futa + be;
	var td = "";
	var md;
	if (stype == "fuck") {
		if (isExplicit())
			if (bDesireeHere) {
				idx = Math.floor(Math.random() * 2) + 1;
				if (idx == 2) td = "td-left-large"
			} else td = "td-left-large";
		else {
			idx = 1;
			td = "td-left-large"
		}
		md =
			WritePlaceHeader(false, td);
		if (bDesireeHere) {
			if (!isExplicit()) perMS.showPerson("mothersuperiordesiree3a.jpg");
			else perMS.showPersonX("mothersuperiordesiree3b" + futa + String.fromCharCode(idx + 96) + ".jpg");
			addPlaceTitle(md, "Anointing your Disciples");
			if (perYou.isMaleSex()) md.write('<p>You tell them jokingly that you wish to annoint them with you. At first you think they wouldn\u2019t understand what you are referring to, but to your surprise both nuns jump at you, ready to have sex with the most important person in their life. Daria is the quick one, grabbing your "holy" penis and shoving it right into her pussy. Sister Desiree starts to lick your "glorious" balls in the heat. Daria is just as insane in bed as you thought. You enjoy yourself on her fit body and ride her all the way to heaven. Under the two of you, Sister Desiree still sucking your balls like there is no tomorrow. This goes on for a while and it is obvious who is in charge of this group. Daria doesn\u2019t let the young priestess to you, keeping you all to herself. She rigorously tries to please you. The Mother Superior selfishly moves her hips at a faster rate, to annoy Desiree. When you are ready to cum, Daria climbs herself from you, kneeling in a position where she could get most of your delightful seed. At the last minute you decide that Desiree should receive your gift. They clean themselves up, wanting more, but you are drained for the moment.</p>');
			else md.write("<p>You have a threesome with Daria and Desiree</p>" + "<p></p>")
		} else {
			perMS.showPersonRorX("mothersuperior9b" + fb + ".jpg");
			addPlaceTitle(md, "Daria");
			md.write("<p>It is time for the real deal. You push her down to her knees down into ground and tear the nun dress apart. You push and pull your dick as quick as you can. From Daria\u2019s face it\u2019s obvious she feels like she is in heaven and her God is destroying her pussy with the biggest dick in the universe. She doesn\u2019t moan nor make any faces while you practically bang her brains out because you haven\u2019t told her so. She is like some kind of a doll and doesn\u2019t even dare to move. You order her to enjoy the sex and she let\u2019s out a loud shriek following it with small squeals. You commend her of her sins by releasing your sperm into her body. You can\u2019t stop there! You push your somewhat tired penis into her other hole and enjoy a sweet little anal. The encounter ends with both of you on the floor, but Daria bumps back to her feet and offers you a hand to get up. It is amazing to see how strong she is as she helps you back on your feet.</p>")
		}
	} else if (stype ==
		"watchdiscipline") {
		md = WritePlaceHeader(false, "td-left-large");
		perMS.showPerson("mothersuperiordesiree4.jpg");
		addPlaceTitle(md, "Disciplining Desiree");
		if (perYou.isMaleSex()) md.write("<p>You decide to watch instead of taking control of the action. You order Daria to discipline Desiree all while you enjoy the scene. Without wasting a second, Daria pulls out the Holy Bible, which she considers trash and useless. She grabs Desiree by the cloak and yanks her dress off. The naked flesh of Desiree brings you joy, but the fun doesn\u2019t stop there. As hard as she can, Daria hits the other nun on the butt. Never stopping, she does this until you say otherwise. They both remain silent, not even a grunt leaves their mouth. Soon the blossoming acolyte\u2019s ass is as red as a tomato. You know it is time stop there as you do not wish to damage your slaves too much. They both rise up, ready to receive their next blessing from you.</p>");
		else md.write("<p>You decide to watch instead of taking control of the action. You order Daria to discipline Desiree all while you enjoy the scene. Without wasting a second, Daria pulls out the Holy Bible, which she considers trash and useless. She grabs Desiree by the cloak and yanks her dress off. The naked flesh of Desiree brings you joy, but the fun doesn\u2019t stop there. As hard as she can, Daria hits the other nun on the butt. Never stopping, she does this until you say otherwise. They both remain silent, not even a grunt leaves their mouth. Soon the blossoming acolyte\u2019s ass is as red as a tomato. You know it is time stop there as you do not wish to damage your slaves too much. They both rise up, ready to receive their next blessing from you.</p>")
	} else if (stype ==
		"bj") {
		if (bDesireeHere) {
			if (isExplicit()) {
				idx = Math.floor(Math.random() * 2) + 1;
				if (idx == 2) td = "td-left-large"
			}
		} else if (isExplicit() && perYou.isMaleSex()) td = "td-left-large";
		md = WritePlaceHeader(false, td);
		if (bDesireeHere) {
			if (isExplicit())
				if (perYou.isMaleSex()) perMS.showPersonX("mothersuperiordesiree2" + String.fromCharCode(idx + 96) + ".jpg");
				else perMS.showPerson("mothersuperiordesiree2g.jpg");
			else if (perYou.isMaleSex()) perMS.showPerson("mothersuperiordesiree2b.jpg");
			else perMS.showPerson("mothersuperiordesiree2g.jpg");
			addPlaceTitle(md, "A Double Blessing");
			if (perYou.isMaleSex()) md.write("<p>You don\u2019t have time to ask for the full service, so you order your two fanatic slaves to give a you a blowjob. They start slowly, building up a great chemistry between them. They change every ten seconds or so, thus you can receive the best experience. Both of them keep an eye contact with you, so if you ever wish something different they are ready for it. You enjoy this simple, short blowjob from two experienced women, their mouth sucking your penis like a vacuum cleaner. It is obvious that they were practicing on each other while you are away from them. It doesn\u2019t take long for you to come on their pretty faces. Both nuns lick each other furiously while you pull your jeans up. They stay on the ground, kneeling, ready for your next wish.</p>");
			else md.write('<p>You issue a single order to both them; lick. They understand what you mean by that. As usual, Daria is the fast and strong, pushing Desiree away a bit. She caresses the "holy trophy", that\u2019s how Daria calls your pussy. You don\u2019t have the time nor the energy to focus on the origin of your pussy\u2019s newfound title as Daria pushes her tounge deep. She is damn fine licker, that is clear. While Desiree still tries to put her head near your vagina, she finally wins and joins in licking you. Desiree turns her attention to your buttcheek and brushes her warm tounge into new territory. The fun stays the same for a while, but you decide to end it. You dry your wet pussy by rubbing it into Daria\u2019s nun dress. She couldn\u2019t be more happy to receive your blessing.</p>')
		} else {
			if (perYou.isMaleSex())
				if (isExplicit()) perMS.showPersonX("mothersuperior10b" +
					futa + ".jpg");
				else perMS.showPerson("mothersuperior10b.jpg");
			else perMS.showPersonRandomRorX("mothersuperior10g", isExplicit() ? 2 : 3);
			addPlaceTitle(md, "Daria Worshiping You");
			if (perYou.isMaleSex()) md.write("<p>You just don\u2019t have enough time for a full fuck, so it is for the best if you just get a blowjob from Daria, your crazy priestess. She knows her job well enough servicing you like you are royalty. She keeps the eye contact, just to see if you are satisfied with her service. Between each fifteen seckond sucking part she takes time to recite the prayer she come up with. It goes on as she recite it verse by verse, mostly talking about how perfect you are and how everything you touch or do is law. It is astonishing to see that she doesn\u2019t stop saying the prayer even when her mouth is full of your glorious cum. A bit spill out on her dress, you know she will not wash that dress for months because of it.</p>");
			else md.write('<p>You issue out a single word order to Daria; lick. She knows what she has to do and is already on her knees, servicing your "holy trophy". That\u2019s the name of your pussy, she name it that  way out of pure honor, still it sounds a bit off. She is a damn licker though, that\u2019s clear. The action goes on for a few more minutes and explodes into a great end. You squirm all the way, while she pushes your body to it\u2019s limit. She goes the extra mile and you have a fantastic orgasm. Crazy or not, Daria sure knows how to pleasure her Goddess!/p>')
		}
		startQuestions()
	} else if (bDesireeHere) {
		md =
			WritePlaceHeader(false, td);
		if (clv > 0) {
			perMS.showPerson("mothersuperior7" + fb + ".jpg");
			addPlaceTitle(md, "Mother Superior and Sister Desiree");
			md.write("<p>Daria and Sister Desiree are waiting for you.</p>");
			startQuestions();
			if (perYou.isMaleSex()) addLinkToPlace(md, "anoint them", 384, "type=fuck");
			addLinkToPlace(md, "a double blessing", 384, "type=bj");
			addLinkToPlace(md, "watch Mother Superior apply discipline", 384, "type=watchdiscipline");
			addSleepLink(md, "go to bed for the night with Daria", "Cloistered with Daria",
				'<p style="position:absolute;left:2%;top:10%;cursor:pointer;font-size:1.1em;width:90%">You notice night has fallen, and wonder what it would be like to spend the night in a Nun\'s cell, well room as this is the Mother Superior after all.<br><br>You join Daria in her narrow and not particularly comfortable bed but she does her best to make you comfortable as she worships your body.', perMS.getImg("mothersuperior-bed.jpg"))
		} else {
			perMS.showPerson("mothersuperior4c.jpg");
			addPlaceTitle(md, "Mother Superior and Sister Desiree");
			md.write("<p>Daria, the Mother Superior is sitting and showing quite a lot of leg for some reason, was she getting dressed? She looks at you coldly,</p>" + '"What are you doing here, I am in the middle of chastising one of my Nuns. Get out!", and she actually blushes as she glances to one side.</p>' + "<p>You see Sister Desiree, naked and her ass red from caning. She is lightly bound, more a token to show her submission to the Mother Superior. Despite the welts on her ass she is smiling, she seems to be enjoying her punishment. When she sees you her smile broadens.</p>" +
				"<p>Well, you did not come here just to watch, now did you?</p>")
		}
	} else {
		md = WritePlaceHeader(false, td);
		if (clv > 0) {
			perMS.showPerson("mothersuperior7" + fb + ".jpg");
			addPlaceTitle(md, "Mother Superior in her Room");
			md.write("<p>Daria, the Mother Superior is waiting for you.</p>");
			startQuestions();
			if (perYou.isMaleSex()) addLinkToPlace(md, "fuck her", 384, "type=fuck");
			addLinkToPlace(md, perYou.isMaleSex() ? "get a blowjob" : "Daria will lick you", 384, "type=bj");
			addSleepLink(md, "go to bed for the night with Daria", "Cloistered with Daria",
				'<p style="position:absolute;left:2%;top:10%;cursor:pointer;font-size:1.1em;width:90%">You notice night has fallen, and wonder what it would be like to spend the night in a Nun\'s cell, well room as this is the Mother Superior after all.<br><br>You join Daria in her narrow and not particularly comfortable bed but she does her best to make you comfortable as she worships your body.', perMS.getImg("mothersuperior-bed.jpg"))
		} else {
			if (perMS.checkFlag(3)) perMS.showPerson("mothersuperior4a.jpg");
			else perMS.showPerson("mothersuperior4c.jpg");
			addPlaceTitle(md, "Mother Superior in her Room");
			if (perMS.checkFlag(3)) md.write("<p>As you walk into the room you see Daria, the Mother Superior is partially undressed. She looks at you embarrassed,</p>");
			else md.write("<p>Daria, the Mother Superior is sitting and showing quite a lot of leg for some reason, was she getting dressed? She looks at you coldly,</p>");
			md.write('"What are you doing here in my private room. Get out now!"</p>' + "<p>Well, you did not come here just to leave, now did you?</p>")
		}
	}
	startQuestions();
	if (clv === 0 && perMS.checkFlag(8) && perYou.checkFlag(25)) addLinkToPlace(md, "hypnotise the Mother Superior", 384, "trance=yes");
	if (bDesireeHere) addSleepLink(md, "take Desiree to her cell for the night", "Cloistered with Sister Desiree", '<p style="position:absolute;left:2%;top:10%;cursor:pointer;font-size:1.1em;width:90%">You take Desiree back her her cell and join her for the night. She worships you and your body until you both fall into an exhausted sleep.<br><br>In the morning you see her lying next to you almost like an angel!.',
		findPerson("Desiree").getImg("sister-bed.jpg"), true);
	if (isPlaceKnown("MotherSuperiorsSecretRoom")) addLinkToPlace(md, "enter the secret room", 383);
	addLinkToPlace(md, "walk back to the cloisters", 406);
	if (bDesireeHere && stype === "") {
		AddPeopleColumnLarge();
		perSister.showPerson("sister12b.jpg")
	}
	WritePlaceFooter(md)
}

function ShowPlace394(stype) {
	var perAbby = findPerson("Abby");
	var perMiku = findPerson("Miku");
	var bCharm = perAbby.isCharmedBy();
	var md = WritePlaceHeader(false, perMiku.isHere() ? "" : "td-left-large");
	if (perMiku.isHere()) perAbby.showPerson("abby1d.jpg", "", "", "", "Information Slave Girl");
	else if (bCharm) perAbby.showPersonRandom("abby1", 3, "", "", "", "Information Slave Girl");
	else perAbby.showPerson("abby1.jpg", "", "", "", "Information Girl");
	addPlaceTitle(md, "Aquarium Information Desk");
	if (perMiku.isHere()) md.write("<p>Abby and Miku are completely engaged in their conversation, well, Abby is, while Miku does her best to keep up and occasionally nods. She seems surprisingly unconcerned with Abby's nudity and right now pretty distracted from you.</p>");
	else if (bCharm) md.write("<p>You visit the information desk and see Abby is happy to see you. She is completely naked with her clothes neatly folded on a desk.</p><p>She smiles and joins you ready to assist you in any way she can.</p><p>She brightly talks about all the ways she can <i>help</i> you and how you can <i>help</i> her. As always she continuously talks and talks and talks.</p>");
	else md.write("<p>You visit the information desk and see the cute young woman attending the desk ready to answer your questions about the aquarium.</p><p>Before you ask anything she brightly gives you advice about new exhibits and almost will not let you get a word in amongst all her recommendations.</p>");
	startQuestions();
	if (bCharm && whereItem(35) == 279 && !perAbby.checkFlag(9)) addLinkToPlaceC(md, perAbby.checkFlag(7) ? '"Again can we talk about the dragon gem"' : '"Do you know about the dragon gem"', 394, "type=gem");
	if (checkPlaceFlag("Alley", 9) && whereItem(35) == 279 && perAbby.checkFlag(9)) {
		if (isConspiracyPath() && !checkPlaceFlag("Alley", 8)) addLinkToPlaceC(md, '"There is a Dragon Statue, can you look at it for me"', 53, "type=checkstatue");
		if (checkPlaceFlag("Alley", 8)) addLinkToPlaceC(md, '"Can you move the dragon gem for me"',
			53, "type=movegem")
	}
	addLinkToPlace(md, "return to the front hall", 361);
	WritePlaceFooter(md)
}

function LeaveMinAbby() {
	findPerson("Abby");
	per.charmThem(1);
	dispPlace(361, "");
	WriteComments("You leave the information desk and the girl to deal with the spell.<br/>She will be affected by the spell but you have chosen to not try to reinforce or guide her so the effect will be minimal.")
}

function ShowPlace395() {
	var md = WritePlaceHeader();
	var perAbby = findPerson("Abby");
	perAbby.showPerson("abby2.jpg");
	addPlaceTitle(md, "Information Girl Under a Spell");
	md.write("<p>You cast the charm spell on the girl at the information desk. " + "She hears you mumble the incantation but just smiles and ignores the words and she says something to you, but it is a language you do not recognise, not Chinese but another Asian language. She gives a small laugh and repeats herself in English,</p>" + "<p>&quot;Hi! I'm Abby! I really, really want to help you, it is my hearts desire to help you, please?&quot;</p>" +
		"<p>You see her hands fidgeting at the base of her white top and her jeans, but despite the desire the spell is causing to flood her mind, she is still smiling.</p>");
	startQuestions();
	addLinkToPlaceC(md, '"Yes you can help me"', 396, "stage=abby3a");
	addOptionLink(md, "exit the information desk", "LeaveMinAbby()");
	WritePlaceFooter(md)
}

function ShowPlace396() {
	var md = WritePlaceHeader();
	var perAbby = findPerson("Abby");
	var stage = getQueryParam("stage");
	perAbby.showPerson(stage + ".jpg");
	addPlaceTitle(md, "Abby Under a Spell");
	md.write("<p>");
	var ostage = stage + "";
	if (stage === "abby3a") {
		md.write("Abby smiles again and says.</p>" + "<p>&quot;I know how I want to assist you, would it help you for me to remove my top?&quot;</p>" + "<p>Before you answer she starts removing her top, the magic if the spell is arousing her and bending her to your will but she is not letting you say much as she cheerfully offers her help.</p>");
		stage = "abby3b"
	} else if (stage == "abby3b" || stage == "abby3c") {
		md.write("Abby happily removes more clothing as she continually talks, about how much she is eager to help you, about how clothing is an anachronism, and asking if this is helping you?</p>");
		if (stage == "abby3b") stage = "abby3c";
		else if (stage == "abby3c") stage = "abby3d"
	} else if (stage === "abby3d") {
		md.write('Abby is standing naked before you looking completely comformatable and happy, and excited. You start to tell her to show more, but maybe it is time to move to the next level when she just talks over you,</p><p>"Would you like me to give you a little show here, or maybe elsewhere?"</p>');
		stage = "abby3e"
	} else if (stage === "abby3e") {
		md.write('Abby turns around to show you more of her shapely rear, and notice her tattoo. You start to ask her about it, and again she talks over you,</p><p>"My tattoo is a family thing, all women get one like this, the men get much more extensive ones. It&apos;s a heritage of a rough time in our past, the designs are always related to the legends of our family past. Mine is a tale of a dragon, the daichunai that would steal the heart and souls of people, and how a brave ancestor of mine was finally able to defeat it."</p>');
		stage = "abby4"
	} else if (stage === "abby4") {
		md.write('Abby continues,</p><p>"Of course I thought that was just a legend, but you have the dragon power, so you must be a descendant of the hero, a far distant relative of mine. I will help you in anything you need, in any way I can!');
		if (perYourBody.FindItem(24) === 0) PlaceI(24);
		md.write(" Maybe this will be of help to you, it is supposed to be a fragment of dragon bone." + '"</p><p>Abby stands and gestures to you,</p><p>"Let me help you now in <i>another</i> way" and she starts to walk towards the back of the office.</p>')
	}
	startQuestions();
	if (ostage !== "abby4") {
		if (ostage === "abby3d" || stage == "abby3e") addLinkToPlace(md, "tell her to put on the show", 396, "stage=" + stage);
		else addLinkToPlace(md, "tell her to help a bit more", 396, "stage=" + stage);
		addLinkToPlace(md, "tell her we will take it to the next level", 397)
	} else addLinkToPlace(md, "follow her", 397);
	WritePlaceFooter(md)
}

function ShowPlace397() {
	var md = WritePlaceHeader(false, "td-left-large");
	ClearComments();
	var perAbby = findPerson("Abby");
	perAbby.showPersonRandom("abby5", 2);
	addPlaceTitle(md, "Abby Under a Spell");
	md.write("<p>Abby sits on a couch comfortably and with no self-consciousness, clearly offering herself to you.</p>" + '<p>"There are many more ways I can help you, with joy and our great pleasure. You are the ' + perYou.getMaster() + ", my " + perYou.getMaster() + ', order me to do anything you want or desire."</p>' +
		"<p>Her dedication was sincere, you are not sure if it is from the magic or something else. Despite her sincerity she is still smiling and continues talking about nothing, about everything, waiting for your response, but talking while doing so.</p>");
	startQuestions();
	addLinkToPlace(md, "accept her dedication", 398);
	WritePlaceFooter(md)
}

function ShowPlace398() {
	var md = WritePlaceHeader();
	findPerson("Abby");
	if (isExplicit() && !perYou.isMaleSex()) per.showPersonRandomX("abby6", 2);
	else per.showPerson("abby6.jpg");
	addPlaceTitle(md, "Abby Under a Spell");
	md.write("<p>Abby lies back and passionately and noisily accepts your body and brings you both to the peak of ecstasy. A little disconcertingly, but not surprisingly, she talks and yells her way the entire time, begging you, telling you or just crying out her joy.</p>" + "<p>She lies back sated after your pleasure is complete, and as you get dressed she says,</p>" +
		'<p>"My dedication to my ' + perYou.getMaster() + ' will stay for all to see!"</p>');
	startQuestions();
	addLinkToPlace(md, "return to the front hall", 361);
	WritePlaceFooter(md)
}

function ShowPlace399() {
	var md = WritePlaceHeader();
	var perDebra = findPerson("DebraKelly");
	perDebra.showPerson("debra6.jpg");
	addPlaceTitle(md, "Debra Kelly under a Charm Spell");
	md.write("<p>\"You're not a woman anymore, Debra.  From now on you are just an animal, a plaything, " + "a pet.  It's okay for pets to pleasure themselves when they have their <i>Owner's</i> permission.  You want " + "to pleasure yourself, you like feeling this good - don't you Debra?\"</p>" + '<p>"Okay for pets to feel this way. To do this.  Yes..." she moans, losing herself to your suggestions.</p>' +
		'<p>"Good girl, Debra" you say, sending another wave of pleasure through her body.  "You\'re going to cum ' + "soon aren't you Debra, and when you do your transformation will be complete.  You will no longer be a " + "woman, will you.  You will be an animal, a pet, a thing, a possession. <i>My possession</i>.  You want that, " + "don't you Debra?  You want to be owned - need to be owned.  To be nothing more than an object " + "for your " + perYou.getMaster() + "'s pleasure, to have no purpose in life " + "other than to serve your " +
		perYou.getMaster() + ' as best you can. That is all you will live for from now on."</p>' + "<p>You can tell that she is moments away from orgasm, the tiny part of her that is still fighting you quickly dying under your assault.</p>");
	startQuestions();
	addLinkToPlaceC(md, "order Debra to SIT", 92);
	WritePlaceFooter(md)
}

function ShowPlace400() {
	var md = WritePlaceHeader();
	var perT = findPerson("MrsTanika");
	perT.setFlag(1);
	perT.showPerson("tanika4.jpg");
	addPlaceTitle(md, "Mrs. Tanika Under a Spell");
	md.write("<p>You recite the spell while concentrating on Mrs. Tanika and she looks up at you annoyed. She is a rather strict and standoff-ish teacher who dislikes to be interrupted. She stands with the intention of disciplining you,</p>" + '<p>"Young ' + perYou.getManWoman() + ', who do you think you are doing here and interrupting my reading..."</p>' +
		"<p>Her voice trails off a little as the magic works itself into her mind and body, and she looks you up and down, appraising you. She recovers her demeanour and continues,</p>" + '<p>"Leave this room now! I want..need to be alone to...finish my paperwork."</p>' + "<p>You can see the arousal of the spell has swept through her quickly and she probably wants to try to relieve it herself. You could just leave her, the magic will still affect her and she will obey you in future. Then again this is your opportunity to completely control her.</p>");
	startQuestions();
	if (perYou.checkFlag(26)) addLinkToPlaceC(md, '"You look troubled can I help you?"', 402, "type=help");
	addLinkToPlaceC(md, '"NO!" and slap her', 402, "type=dominate");
	addLinkToPlace(md, "exit the teachers lounge", 401);
	WritePlaceFooter(md)
}

function ShowPlace401() {
	var md = WritePlaceHeader();
	var perT = findPerson("MrsTanika");
	perT.showPerson("tanika7.jpg");
	addPlaceTitle(md, "Leaving Mrs. Tanika Alone");
	md.write("<p>You leave Mrs. Tanika to deal with the spell. She will be affected by the spell but you have chosen to not try to reinforce or guide her so the effect will be minimal.</p>" + "<p>You leave the room and she closes the door quickly behind you but it was not closed properly and re-opens a little. Through the gap you see Mrs. Tanika has stripped off her clothing and is frantically masturbating. She comes to a shuddering, gasping orgasm, and you are sure you heard her say your name as she reached her peak.</p>" +
		"<p>She is panting from the exertion and she looks toward the door, you are not sure if she can see you or not, you think she can. Her fingers move back to her pussy as she starts to masturbate again and she looks you directly in the eyes. Again she quickly orgasms due to the power of the spell, and as she does she kicks the door and it closes.</p>");
	startQuestions();
	addLinkToPlace(md, "leave Mrs. Tanika for now", 70);
	WritePlaceFooter(md)
}

function ShowPlace402(type) {
	var md = WritePlaceHeader();
	var perT = findPerson("MrsTanika");
	if (type == "help") perT.showPerson("tanika5.jpg");
	else perT.showPerson("tanika5a.jpg");
	if (type == "help") addPlaceTitle(md, "Mrs. Tanika Under a Spell");
	else addPlaceTitle(md, "Dominating Mrs. Tanika With A Spell");
	if (type === "help") md.write("Mrs. Tanika is a little confused by the magic coursing through her,</p>" + '<p>"Yes, I am feeling very <b>hot</b> and I very much would like you to help me with that"</p>' + "<p>She starts to open her white woolen top a little, and you step over to <i>assist</i> her and instead you open it completely and it starts to slip off her shoulders. She stifles a moan at your touch, and you ask if this is helping her and suggest that she needs more.</p>" +
		"<p>She openly moans as you lift her skirt, explaining it will allow you to help her a lot more.</p>");
	else md.write('You have had enough of her attitude, she is a disciplinarian who enjoys punishing her students. You firmly tell her "No" you will not leave the room and you slap her while focusing on the spell and reciting it again. She staggers, but the slap was not that hard, she moans as the magic rushes through her more and more. You tell her,</p>' + '<p>"I am your ' + perYou.getMaster() + ' and you are mine to order as I like!"</p>' +
		"<p>You are a little surprised at your forcefulness here, it is more from your history with her and the stories you have heard about her. She says,</p>" + '<p>"I am <span style="font-size:small">...not...</span> yours to order around like a slut, a toy, a plaything"</p>' + '<p>She does not sound very certain, and you flip up her skirt and start spanking her and you tell her "Yes, you are!". She cries out, but not in pain, as her body shudders in orgasm.</p>');
	startQuestions();
	if (type === "help") addLinkToPlaceO(md,
		"push her more", 403, "type=help");
	else {
		addLinkToPlaceC(md, "tell her she is your slave", 403, "type=slave");
		if (perYou.checkFlag(26)) addLinkToPlaceC(md, "tell her she is your fucktoy", 403, "type=fucktoy")
	}
	WritePlaceFooter(md)
}

function ShowPlace403(type) {
	var md = WritePlaceHeader(false, type == "help" ? "" : "td-left-large");
	var perT = findPerson("MrsTanika");
	if (type == "help") perT.showPerson("tanika6.jpg");
	else perT.showPerson("tanika6a.jpg");
	if (type == "help") addPlaceTitle(md, "Mrs. Tanika Under a Spell");
	else if (type == "slave") addPlaceTitle(md, "Enslaving Mrs. Tanika With A Spell");
	else addPlaceTitle(md, "Mrs. Tanika, your Fuck-Toy");
	if (type === "help") {
		perT.charmThem(2);
		md.write("You tell Mrs. Tanika that really what she is feeling is her love and desire for you and how much she must want you above and instead of <i>anyone</i> else,</p>" +
			'<p>"Yes, that is it, but it\'s wrong, I thought I loved my husband, but now I can only think of you"</p>' + "<p>She removes more of her clothing and spreads herself, offering herself to you blatantly.</p>")
	} else if (type == "slave") {
		perT.charmThem(4);
		md.write("You tell her that she is your slave, who is utterly obsessed with you and will do absolutely anything for you. No-one and nothing else matters anymore in her life!</p>" + '<p>"You are my ' + perYou.getMaster() + ", my husband is nothing to me now and you are everything to me. Please take me!</p>")
	} else {
		perT.charmThem(3);
		if (perYou.isMaleSex()) md.write("You tell her she is a cock-ornament, a cum-dump, a slut who&apos;s purpose is to provide you sexual pleasure! You tell her she will always be aroused and ready for your cock. To your surprise she smiles,</p>" + '<p>"I am your fuck-toy, my past life, my husband means nothing. Fuck me!</p>');
		else md.write("You tell her she is a lesbian toy, a slut who&apos;s purpose is to make you orgasm with tongue, fingers or body. You tell her she will always be aroused and ready for your strap-on or to lick you when ordered. A look of defiance passes over her face,</p>" +
			'<p>"I am a married woman, I am not a lesbian toy!"</p>' + 'You order her, "Of course you are!" and she looks uncertain, but starts to smile.</p>')
	}
	startQuestions();
	if (type === "help") addLinkToPlaceO(md, "take her", 404, "type=take");
	else if (type == "slave")
		if (perYou.isMaleSex() || perYourBody.FindItem(45) > 0) addLinkToPlaceO(md, "fuck your slave", 404, "type=fuck");
		else {
			if (!perYou.isMaleSex() || perYou.isMaleSex() && isExplicit()) addLinkToPlaceO(md, "have your slave orally service you", 404, "type=bj")
		}
	else {
		if (perYou.isMaleSex() ||
			perYourBody.FindItem(45) > 0) addLinkToPlaceO(md, "fuck your toy", 404, "type=fuck");
		if (!perYou.isMaleSex() || perYou.isMaleSex() && isExplicit()) addLinkToPlaceO(md, "use your fucktoy&apos;s mouth", 404, "type=bj")
	}
	WritePlaceFooter(md)
}

function ShowPlace404(type) {
	var md;
	var perT = findPerson("MrsTanika");
	var clv = perT.getCharmedLevel();
	var bMan = perYou.isMaleSex();
	if (type == "take" || type == "fuck")
		if (bMan) {
			md = WritePlaceHeader(false, "td-left-large");
			perT.showPersonRandomRorX("tanika8b", isExplicit() ? 3 : 1)
		} else {
			md = WritePlaceHeader(false, isExplicit() ? "td-left-med" : "td-left-large");
			perT.showPersonRandomRorX("tanika8g", isExplicit() ? 4 : 2)
		}
	else {
		md = WritePlaceHeader(false, bMan || !isExplicit() ? "td-left-large" : "");
		perT.showPersonRandomRorX(bMan ? "tanika9b" :
			"tanika9g", bMan ? isExplicit() ? 4 : 1 : 2)
	}
	if (type == "take") addPlaceTitle(md, "Mrs. Tanika Under a Spell");
	else if (clv == 4) addPlaceTitle(md, "Your slave Mrs. Tanika");
	else addPlaceTitle(md, "Fucking your Fuck-Toy");
	if (type === "take") {
		if (bMan) md.write("You explore Mrs. Tanika's, that is Susan's body and she experiences peak after peak of pleasure before you reach yours and pour your lust into her</p>");
		else md.write("<p>Mrs. Tanika, that is Susan is nervous and inexperienced but learns quickly how to pleasure another woman and herself in the process. To her surprise, she reaches multiple peaks of ecstasy before you achieve yours.</p>");
		md.write("<p>You ask Mrs. Tanika..Susan to remain here at school until you return for her.</p>")
	} else {
		if (type == "fuck")
			if (clv == 3) {
				if (bMan) md.write("You mount your fuck-toy, telling her how now she is truly a cock-ornament and how great she looks. You then slap her ass and start to fuck her, concentrating on your own pleasure. As you are getting close to cumming, you feel your slut shudder in orgasm and that triggers your orgasm and cum hard into her pussy. As you pull out you tell her that she is a good cum-dump.</p>");
				else md.write("You put on your strap-on and mount your new fuck-toy. Mrs. Tanika is clearly inexperienced with this and you tell her that she will have to get used to this and pleasing you in other ways. You find the strap-on is pleasurable and as you near your orgasm you hear Mrs. Tanika cry out her orgasm. This triggers you orgasm and you orgasm hard. As you remove your strap-on you tell Mrs. Tanika that she is a good toy.</p>");
				md.write("<p>You tell your fuck-toy to get dressed and to go to your home and wait in your bedroom.</p>")
			} else {
				if (bMan) md.write("You mount your slave, a tell her how sexy she is. You then slap her ass and start to fuck her and she enthusiastically participates. She orgasms twice before you finally cum into her pussy. As you pull out you tell her that she is a good slave.");
				else md.write("You put on your strap-on and mount your new slave. Mrs. Tanika is clearly inexperienced with this and you tell her you will teach her everything she needs to know as a good slave. You both orgasm close to each other, Mrs. Tanika looking relieved and you tell her she is a good slave!</p>");
				md.write("<p>You tell your slave to get dressed and to go to your home and wait in your bedroom.</p>")
			}
		else if (clv == 4) {
			if (bMan) md.write("You tell your slave to give you a blowjob! She kneels and gives you a surprisingly expert blowjob and you cum hard in her mouth. Without a word from you she swallows.</p>");
			else md.write("You tell her that she will now lick you to an orgasm. She kneels uncertain how to proceed and you sit down and give her instructions to service you. While she is inexperienced she has clearly received this sort of attention before and is able to bring you to a pleasant orgasm. You tell her she is a good slave and that you will teach her and do better in future.</p>");
			md.write("<p>You tell your slave to get dressed and to go to your home and wait in your bedroom.</p>")
		} else {
			if (bMan) md.write("You tell her she is a cum-dump, and a cock-sucker and to demonstrate! She kneels and gives you a surprisingly expert blowjob and you cum hard in the sluts mouth. You tell your fuck-toy to swallow, and she does.</p>");
			else md.write("You tell her she is a lesbian toy, and that she will now lick you to an orgasm. She kneels uncertain how to proceed and you sit down and give her instructions to service you. While she is inexperienced she has clearly received this sort of attention before and is able to bring you to a pleasant orgasm. You tell her she is a good fuck-toy and that she will have to learn and do better in future.</p>");
			md.write("<p>You tell your fuck-toy to get dressed and to go to your home and wait in your bedroom.</p>")
		}
		perT.moveThem(45);
		if (isDay()) md.write("<p>" + perT.getPersonNameShort() + " apologises and explains that she has duties here at school and asks if she can finish up here before obeying your order to go to your bed. You consider and decide it is best that she tidies up any of her business before assuming her duties of pleasuring you!. She thanks you and mentions also picking up some items at her home on the way, some items you will really like. She promises to be in your bed no later than this evening.</p>")
	}
	startQuestions();
	addLinkToPlace(md, "leave the Teacher's Lounge", 70);
	WritePlaceFooter(md)
}

function ShowPlace406() {
	var md = WritePlaceHeader();
	var perMS = findPerson("Daria");
	addPlaceTitle(md, "Church Cloisters", "cloisters.jpg");
	md.write("<p>The cloisters are a set of covered walkways almost always associated with monasteries and convents. Commonly the walkways surround a courtyard and have a set of small rooms, or cells, that the devoted study or live in.</p>" + "<p>There is a very large courtyard, and the church makes one wall and the cloisters the other three sides. There are many small rooms lining the walkways, all with an air of quiet contemplation.</p>");
	if (!isPossess())
		if (!perMS.checkFlag(4) ||
			perMS.checkFlag(7) && !perMS.isCharmedBy()) {
			setPlaceFlag("Church", 5);
			showPopupWindow("Mother Superior", "<img src='Images/mothersuperior1c.jpg' class='imgpopup' alt='Mother Superior'>" + "The sound of your footsteps echo off the walls as you move down the cloister's walkway. Suddenly Mother Superior appears out of nowhere and stops you. <br><br>" + '"What do you think you\'re doing here? Get Out!" she yells.', "dispPlace(318)");
			WritePlaceFooter(md);
			return
		}
	startQuestions();
	if (isPlaceKnown("MotherSuperiorsRoom"))
		if (perMS.place ==
			384 && !perMS.checkFlag(9)) {
			var s = '<img src="Images/spiralstair.jpg" class="imgpopup" alt="Spiral">' + '<p style="position:absolute;cursor:pointer;font-size:1.1em;color:white;width:60%">' + "As you approach the Mother Superior's room you notice her room seems to be at the base of a tower, with a <b>spiral</b> staircase leading upwards.<br><br>" + "You have to wonder if you are ready to confront her now in person, what after possessing her and hopefully either confusing or weakening her will at least a little.<br><br>" +
				"Will the charm spell will be enough, her will is so strong, and you know there is no way she will trust you for something a little more mundane. Magic is definitely needed somehow!";
			addPopupLink(md, "visit Mother Superior's Room", "Spiral Staircase", s, false, "setPersonFlag('Daria',9);dispPlace();")
		} else addLinkToPlace(md, "visit Mother Superior's Room", perMS.place == 382 ? 382 : 384);
	addLinkToPlace(md, "walk into the Courtyard", 319);
	addLinkToPlace(md, "walk back into the Church proper", 318);
	WritePlaceFooter(md)
}

function ShowPlace408() {
	var perMiku = findPerson("Miku");
	var s;
	if (perMiku.other == -1) s = "Miku did her best to make sure the attic is homely, but it surprisingly doesn't look like she has brought a lot of belongings with her.</p><p>There are two large suitcases worth of clothes, her schoolbooks, some sextoys, a plush animal and an old laptop, which makes you wonder how her living condition used to be before she invited herself into your home.";
	else if (perMiku.other == -100) s = "With Miku taking a more permanent residence with you and your family, the attic has finally started to look like someones home. She has begun to decorate the room with plants and plush animals, bought a few extra books and placed a few posters on the wall.";
	else s = "The small spare room in the attic. Your mother converted it to a bedroom with the idea of renting it out, but never actually advertised it. You have always found it a little cold, but it is private and you sometimes come up here to read in warm weather.</p><p>There is a small room set aside for storage and the rest is the bedroom and a small study area.";
	showGeneralPlace("Attic Bedroom", "attic2.jpg", s, "return downstairs", 45)
}

function ShowPlace410(stype) {
	var md = WritePlaceHeader();
	var splace = getQueryParam("place");
	var perMadison = findPerson("Madison");
	if (splace === "") perMadison.showPerson("madison15h.jpg");
	else perMadison.showPerson("madison15o.jpg");
	addPlaceTitle(md, "Madison Under You");
	switch (stype) {
		case "oral":
			if (perYou.isMaleSex()) md.write("<p>She gives you a blowjob</p>");
			else md.write("<p>She licks you</p>");
			break;
		case "fuck":
			if (perYou.isMaleSex()) md.write("<p>You fuck her pussy</p>");
			else md.write("<p>You put on the strap-on Madison gave you, and fuck her to mutual orgasms.</p>");
			break;
		case "sex":
			md.write("<p>You make love, grinding your pussies together.</p>");
			break
	}
	md.write('<p>"What do you wish of me now ' + perYou.getMaster() + '?" she asks.</p>');
	startQuestions();
	if (wherePerson("Diane") == -1) addLinkToPlaceC(md, "ask about the documents", 412, "type=askdocuments");
	else if (splace === "") addLinkToPlaceC(md, 'order her "Go back to the station and wait for me there."', 45);
	else addLinkToPlaceC(md, 'leave after you order her "Change clothes and always deliver me pleasure"', 371);
	AddRightColumnLarge();
	switch (stype) {
		case "oral":
			if (perYou.isMaleSex())
				if (isExplicit()) AddImageRandomX("GenericSex/sex-mf blowjob ", 5);
				else AddImage("GenericSex/sex-mf blowjob blonde hair-b.jpg");
			else AddImageRandomRorX("GenericSex/sex-ff lick ", isExplicit() ? 6 : 1);
			break;
		case "fuck":
			if (perYou.isMaleSex())
				if (isExplicit()) AddImageRandomX("GenericSex/sex-mf pussy ", 6);
				else AddImageArray(["GenericSex/sex-mf pussy a.gif", "GenericSex/sex-mf pussy b.jpg"]);
			else AddImageRandomX("GenericSex/sex-ff strapon ", 8);
			break;
		case "sex":
			AddImageRandomRorX("GenericSex/sex-ff trib ",
				isExplicit() ? 6 : 2);
			break
	}
	WritePlaceFooter(md)
}

function Leave411() {
	if (whereItem(45) == 411) moveItem(45, 46)
}

function LeaveTakeStrapOn() {
	if (perYourBody.FindItem(45) === 0) perYourBody.PutItem(45, true)
}

function ShowPlace411() {
	var md = WritePlaceHeader();
	var splace = getQueryParam("place");
	var perMadison = findPerson("Madison");
	if (splace === "") {
		perMadison.showPersonX("madison16.jpg");
		addPlaceTitle(md, "Madison's Gift");
		md.write("<p>You tell Madison you would like to fuck her but you lack any toys to do this with. Madison grins at this and quickly puts on her jacket and skirt and asks if she can get you a present. A little surprised you let her. She leaves and a few minutes later returns with a package she was due to deliver to someone else and gives it to you.</p>" + '<p>"Don\'t worry our insurance will cover it" she says while removing her clothing again eagerly. You see the package is from a well known internet site for adult products. It is labelled as a "Delux Strap-on" and included are several different appendages to use.</p>' +
			'<p>"Now you can fuck me...please Mistress?"</p>')
	} else {
		perMadison.showPersonX("madison24.jpg");
		addPlaceTitle(md, "Madison's Gift");
		md.write('<p>You tell Madison you would like to fuck her but you lack any toys to do this with. Madison grins at this and quickly puts on her jacket and skirt and asks if she can get you a present. A little surprised you let her. She leaves and a few minutes later returns with a package and turns her back while opening it and doing something with it. When she turns around she is loosely wearing a strap-on, with a box on the desk labeled "Delux Strap-on" with several different appendages still in the box</p>' +
			'<p>"Nina has bought this for her lover but never got up the courage to give it to her. They have broken up and Nina had regretted getting it. Don\'t worry if she notices I will pay her", she says.</p>' + '<p>"Now I can fuck you, or please, you can fuck me Mistress?"</p>')
	}
	if (whereItem(45) === 0) PlaceI(45);
	startQuestions();
	addLinkToPlaceC(md, '"Yes, I will fuck you"', 410, "type=fuck&place=" + splace, "", "", "LeaveTakeStrapOn()");
	if (wherePerson("Diane") != -1)
		if (splace === "") addLinkToPlaceC(md, 'order her "Go back to the station and wait for me there."',
			45, "", "", "", "Leave411()");
		else addLinkToPlaceC(md, 'leave after you order her "Change clothes and always deliver me pleasure"', 371, "", "", "", "Leave411()");
	WritePlaceFooter(md)
}

function Enjoy412() {
	Leave(true);
	WriteComments("You sate youself on Madison's body and leave her satisfied but wanting more");
	dispPlace(371, "")
}

function ShowPlace412(stype) {
	var md = WritePlaceHeader();
	var perMadison = findPerson("Madison");
	var perZoey = findPerson("Zoey");
	var bZDay = getHour() < 16;
	if (stype == "strip") perMadison.showPerson(perMadison.checkFlag(13) ? "madison18be.jpg" : "madison18.jpg");
	else perMadison.showPerson(perMadison.checkFlag(13) ? "madison17be.jpg" : "madison17.jpg");
	addPlaceTitle(md, stype == "zoey" ? "Madison and Zoey" : "Madison at Work");
	if (getQueryParam("enter") === "true")
		if (checkPersonFlag("Mom", 26) || checkPersonFlag("Gabby", 2))
			if (isCharmedBy("Nina")) addComments("Nina runs a hand over her breasts and gestures to Madison's office, you walk over to the office while looking appreciatively at Nina.");
			else addComments("Annoyed, Nina gestures towards an office, you walk over and enter.");
	if (stype == "strip") md.write("<p>Madison removes all her clothing except her leggings and begs you,<br/>&quot;" + perYou.getMaster() + " please...&quot;</p>");
	else if (stype == "zoey") {
		md.write("<p>Madison makes a quick phone call, and a few minutes later Zoey walks in ");
		if (bZDay) md.write("dressed in her uniform, she was probably just having a quick lunch");
		else md.write("dressed casually, she mist of changed out of her uniform ready to go home");
		md.write(". She looks at Madison's partially dressed state, and at yourself.</p>" + '<p>"Hey Maddy, is this the ' + (perYou.getManWoman() != "man" ? "girl" : "guy") + " you were talking about, your " + perYou.getMaster() + '?"</p>' + "<p>Madison looks at you,</p>" + '<p>"' + perYou.getMaster() + ' I told her about you, after all she is going to be your slave as well!"</p>' + '<p>Zoey shakes her head, "Maddy, I told you I am not into all that ' + perYou.getMaster() + " and slave thing. You and your " + (perYou.getManWoman() != "man" ?
			"woman" : "man") + " can play your games, and I'll play mine. I think I will go and see if Nina is interested in a game or two.\"</p>")
	} else {
		md.write('<p>The office has a small sign "G.R USX Deliveries", your mother had mentioned that the Station runs a small package delivery company out of it&apos;s main office.</p>' + "<p>Well, it looks like Madison is quite a nasty little tigress in bed. She regularly changes her clothes, each time a dress that pleases your sexual hunger more. She often teases you by appearing half naked already when you just have entered her workplace.</p>" +
			'<p>You ordered her to continue her job as a mail and package carrier to avoid unnecessary attention from the townsfolk. She agreed and playfully added that she will personally bring any mail or packages of yours to your house without wearing any underwear. She mentioned that she will also bring an "appetite that only you can soothe".</p>');
		if (!perMadison.checkFlag(6)) {
			perMadison.setFlag(6);
			setPersonFlagAfterTime("Madison", 7, true, Math.floor(Math.random() * 12) + 12);
			md.write("<p>Madison gives you her phone number, telling you that you can call her anytime you need her to deliver something special.</p>")
		}
	}
	startQuestions();
	if (stype === "") {
		if (perMadison.checkFlag(8) && !isCharmedBy("Zoey") && !perMadison.checkFlag(10)) addQuestionC(md, !perMadison.checkFlag(9) ? "ask about Zoey" : "ask if Zoey is in the office", "Madison", 100);
		if (isCharmedBy("Zoey")) addQuestionC(md, "ask if Zoey is in the office", "Madison", 101);
		addLinkToPlaceO(md, "remove more clothing", 412, "type=strip&enter=false");
		addLinkToPlace(md, "return to the station reception", 371)
	} else if (stype == "strip") addOptionLink(md, "enjoy Madison and return to the station reception",
		"Enjoy412()");
	else if (stype == "zoey") {
		addLinkToPlace(md, "return to the station reception", 371);
		AddRightColumnLarge(md);
		if (bZDay) perZoey.showPerson("zoey1-noon.jpg");
		else perZoey.showPerson("zoey1-afternoon.jpg")
	}
	WritePlaceFooter(md)
}

function ShowPlace413() {
	var md = WritePlaceHeader();
	var perMadison = findPerson("Madison");
	perYou.setFlag(2, false);
	perMadison.showPerson("madison19.jpg");
	addPlaceTitle(md, "Madison at Work");
	var senter = getQueryParam("enter");
	if (senter === "true")
		if (isCharmedBy("Nina")) WriteComments("Nina runs a hand over her breasts and gestures to an office, you walk over to the office while looking appreciatively at Nina.");
		else WriteComments("Annoyed, Nina gestures towards an office, you walk over and enter.");
	perYou.setFlag(2,
		false);
	md.write('<p>The office has a small sign "G.R USX Deliveries", your mother had mentioned that the Station runs a small package delivery company out of it&apos;s main office.</p>');
	if (wherePerson("Diane") == -1) md.write('<p>When you enter the room you ask the girl there, "Hey! You are Madison, right?"</p>' + '<p>She replies, "That is correct, ' + (perYou.isBornMale() ? "sir" : "miss") + '! How did you get in here? It\u2019s a restricted area. \u2013 the blonde delivery girl doesn\u2019t speak too kindly to you."</p>' +
		'<p>You ask, "I\u2019m just looking for a package that belongs to me and it was mistakenly delivered to this place. You were the one who brought it here."</p>' + '<p>Madison replies "I see...sorry, ' + (perYou.isBornMale() ? "sir" : "miss") + ', but I can\u2019t help you! First, you need to register at the reception desk, the girl, Nina will gladly help. But it\u2019s not in my authority to tell you more\u2026"</p>' + '<p>You insist "You don\u2019t understand\u2026it\u2019s very important that I get this package, right now! It\u2019s all a misunderstanding\u2026"</p>' +
		'<p>She replies "I said, I can\u2019t help with this issue\u2026I have to return to my work, so please just leave or I have to call for help."</p>' + "<p>She\u2019s too stubborn to help, you don\u2019t have much choice, but to charm Madison quickly or else you will never get the chance to find those documents!</p>");
	else {
		if (perMadison.checkFlag(5)) md.write('<p>As you enter you see Madison, the young woman who delivered the prize to you, and she greets you, "Hello again, ' + (perYou.getManWoman() != "man" ?
			"Miss" : "Mr") + " prize-winner! How can I help you now?</p>" + '<p>You show her the damaged stereo and she looks at it and says, "I am sorry again, but I thought you were ok and were not going to complain!"</p>');
		else md.write('<p>As you enter you see a lively young girl, who greets you "Hi! I\'m Madison, how can I help you?"</p>' + '<p>You show her the damaged stereo and explain how it was delivered damaged. She blushes and says, "I am sorry I..I mean the person who delivered it must have dropped it!"</p>');
		md.write('<p>You ask her what she can <b>do</b> for you and she tells you "I was going to contact you, but I can arrange to have it repaired, it will take a day or two, and I promise we will cover all costs and deliver it back to you"</p>' + '<p>While there are other things you would day-dream of her doing for you, this will have to do for now. She takes the stereo and looks at you cheerfully, "Was there anything else?"</p>' + '<p>As you try to think of something else, she continues "I have got some more deliveries to make, so I need to <b>leave</b> the office, so if there is nothing more?"</p>')
	}
	startQuestions();
	addLinkToPlace(md, "return to the station reception", 371);
	WritePlaceFooter(md)
}

function ShowPlace414(stype) {
	var md = WritePlaceHeader(false, stype == "threesome" || stype == "fuck" ? "td-left-large" : "");
	var perMadison = findPerson("Madison");
	var perZoey = findPerson("Zoey");
	var bZDay = getHour() < 16;
	if (stype == "charm1") {
		if (getHour() < 16) perZoey.showPerson("zoey2-noon.jpg");
		else perZoey.showPerson("zoey2-afternoon.jpg");
		addPlaceTitle(md, "Zoey Under a Spell");
		md.write('<p>You recite the charm spell "Dai Chu Zoey" and she starts to say "Gesundheit..." but looks at you uncertainly. Madison speaks before you can start to mold Zoey,</p>' + '<p>"Hear that Zoey, it means you are going to be ' +
			perYou.getMaster() + "'s slut and mine when " + perYou.getHeShe() + ' allows it."</p>' + '<p>You tell Madison "Shut up Madison, it is for me to decide if she is to be a slut or slave, or both". Madison grins and answers "Yes ' + perYou.getMaster() + '!"</p>' + '<p>Zoey looks amused, "Maddy, again I am not into BDSM or just Domination games, but how you two are talking now is kind of hot....", you can hear in her voice the spell is taking effect on her.</p>' + "<p>It is time to assert yourself, and take Zoey's attention from Madison. You tell her firmly,</p>" +
			'<p>"It does not matter what you are into, a slave has no choice how their ' + perYou.getMaster() + ' wants them to act. Strip your clothing slave!"</p>' + "<p>With an almost unconscious motion Zoey removes her " + (bZDay ? "skirt" : "pants") + " and looks at you surprised and aroused.");
		if (perYou.checkFlag(26)) md.write(" It is time to further re-inforce this, and you consider Madison's original words.</p>");
		else md.write("</p>");
		startQuestions();
		if (perYou.checkFlag(26)) addLinkToPlaceC(md, '"You are our slut now"',
			414, "type=charm2slut");
		addLinkToPlaceC(md, '"You are my slave now"', 414, "type=charm2slave")
	} else if (stype == "charm2slave" || stype == "charm2slut") {
		if (stype == "charm2slut") perZoey.charmThem(2);
		if (getHour() < 16) perZoey.showPerson("zoey3-noon.jpg");
		else perZoey.showPerson("zoey3-afternoon.jpg");
		if (stype == "charm2slut") {
			addPlaceTitle(md, "Slut Zoey Under a Spell");
			md.write('<p>As you tell Zoey that she is now your slut, Madison comments, "' + perYou.getMaster() + ' I am pretty sure she was already a slut!"</p>' + '<p>Zoey looks confused and again you say "Madison shut up, she is my slut first". Zoey looks at Madison and says,</p>' +
				'<p>"Maddy..don\'t be rude, just because I love sex and like a lot of lovers, it does not mean I am a slut"</p>' + '<p>Again you focus her attention on yourself, "Yes it does Zoey, you are a wanton slut who lives for sex, look you are stripping naked in front of me"</p>' + '<p>She continues to strip in response to your words, but she tried to deny it, "No...no...I just like....", you interrupt,</p>' + '<p>"Yes..yes..would anyone except a slut now be naked in front of a stranger. A stranger that they are now going to ' +
				(perYou.isMaleSex() ? "suck their cock" : "eat their pussy") + '?"</p>' + "<p>");
			if (isExplicit()) AddImageX(perYou.isMaleSex() ? "GenericSex/sex-mf blowjob d.jpg" : "GenericSex/sex-ff lick d.jpg", perYou.isMaleSex() ? "25%" : "40%", "left");
			else AddImage(perYou.isMaleSex() ? "GenericSex/sex-mf blowjob blonde hair-b.jpg" : "GenericSex/sex-ff lick a.jpg", perYou.isMaleSex() ? "25%" : "40%", "left");
			if (perYou.isMaleSex()) md.write("Zoey kneels down as you unzip and take out your cock. To your surprise and delight she gives you an expert blowjob and then starts to deep-throat you, she has clearly done this before.</p>" +
				'<p>As your pleasure builds you tell Zoey, "Ahh, very good, you are a true slut". She buries herself balls-deep on your cock and you feel her tongue lick your balls. You cry out in ecstasy "Here it comes slut, the first of many...ahhhh". You pull out, Zoey breaths deeply and looks up at you.</p>');
			else md.write("<p>Zoey kneels down as you lower your pants and expose your pussy. To your surprise and delight is very skilled, Madison had mentioned she was bisexual, she is clearly right.</p>" + '<p>As your pleasure builds you tell Zoey, "Ahh, very good, you are a true slut". She works your pussy and clit with redoubled vigour. You cry out in ecstasy "Ahh cumming you slut, you will be doing this a lot...ahhhh". Zoey leans back and looks up at you.</p>')
		} else {
			addPlaceTitle(md,
				"Slave Zoey Under a Spell");
			md.write('<p>As you tell Zoey that she is now your slave, Madison comments, "Zoey you will love being a slave, sex is so much more intense and there is no need for dating, you have ' + perYou.getMaster() + ' now!"</p>' + '<p>Zoey looks confused and again you say "Madison shut up, she is my slave". Zoey looks at Madison and says,</p>' + '<p>"Maddy..I don\'t like those sort of games..."</p>' + '<p>Again you focus her attention on yourself, "Of course you do Zoey, you have been obeying my orders to strip and it is turning you on. You love the idea of submitting to me, and only to me. Strip more slave!"</p>' +
				'<p>She continues to strip in response to your words, but she tried to deny it, "No...no...I am not...I just like....", you interrupt,</p>' + '<p>"You like submitting and obeying like the slave you are. You are now be naked in front of your ' + perYou.getMaster() + ". Now prove your submission, " + (perYou.isMaleSex() ? "suck my cock" : "eat my pussy") + '!"</p>' + "<p>");
			if (isExplicit()) AddImageX(perYou.isMaleSex() ? "GenericSex/sex-mf blowjob d.jpg" : "GenericSex/sex-ff lick d.jpg", perYou.isMaleSex() ? "25%" : "40%", "left");
			else AddImage(perYou.isMaleSex() ? "GenericSex/sex-mf blowjob blonde hair-b.jpg" : "GenericSex/sex-ff lick a.jpg", perYou.isMaleSex() ? "25%" : "40%", "left");
			if (perYou.isMaleSex()) md.write("Zoey kneels down as you unzip and take out your cock, she looks confused but obeys. To your surprise and delight she gives you an expert blowjob and then starts to deep-throat you, she has clearly done this before.</p>" + '<p>As your pleasure builds you tell Zoey, "Ahh, very good slave". She buries herself balls-deep on your cock and you feel her tongue lick your balls. You cry out in ecstasy "Here it comes slut, the first of many...ahhhh". You pull out, Zoey breaths deeply and looks up at you, the confusion gone from her eyes.</p>');
			else md.write("<p>Zoey kneels down as you lower your pants and expose your pussy, she looks confused but obeys. To your surprise and delight is very skilled, Madison had mentioned she was bisexual, she is clearly right.</p>" + '<p>As your pleasure builds you tell Zoey, "Ahh, very good slave". She works your pussy and clit with redoubled vigour. You cry out in ecstasy "Ahh cumming you slut, you will be doing this a lot...ahhhh". Zoey leans back and looks up at you, the confusion gone from her eyes.</p>')
		}
		startQuestions();
		if (stype == "charm2slut") addLinkToPlaceC(md, '"Good slut!"', 414, "type=charm3slut");
		else addLinkToPlaceC(md, '"Good slave!"', 414, "type=charm3slave")
	} else if (stype == "charm3slut" || stype == "charm3slave") {
		if (getHour() < 16) perZoey.showPerson("zoey4-noon.jpg");
		else perZoey.showPerson("zoey4-afternoon.jpg");
		if (stype == "charm3slut") {
			addPlaceTitle(md, "Slut Zoey");
			md.write('<p>Your new slut stands before you, almost completely naked, "Well, I admit it, I am a slut, how about your fuck me now?"</p>')
		} else {
			addPlaceTitle(md,
				"Slave Zoey");
			md.write('<p>You tell your new slave to stand, and she looks at you smiling, "' + perYou.getMaster() + ' want do you want me to do to you or Madison?"</p>')
		}
		md.write("<p>Zoey is yours, to take, to use as you wish! You see Madison looking at Zoey expectantly, so you order,</p>" + '<p>"Zoey it is time to reward Madison for bringing you to me"</p>' + "<p>");
		if (isExplicit()) AddImageX("GenericSex/sex-ff lick e.jpg", "40%", "right");
		else AddImage("GenericSex/sex-ff lick a.jpg", "40%", "right");
		md.write("Madison almost squeals in delight as she pulls off the rest of her clothing and practically forces her exposed pussy into Zoey's face. Madison cries out,<br><br>" +
			'"Thank you ' + perYou.getMaster() + ', office work is going to be a lot more fun now!"</p>');
		md.write("<p>Afterwards Zoey gives you her phone number, telling you that you can call her anytime you need her.</p>");
		startQuestions();
		addLinkToPlace(md, "return to the station reception", 371)
	} else if (stype == "fuck") {
		perZoey.showPerson("zoey7.jpg");
		addPlaceTitle(md, "Fucking Zoey");
		md.write("<p>Zoey quickly changes into her delivery uniform and makes a show of her short skirt and in the end she shows off her panties as she waits for your touch.</p>" +
			"<p>You touch her, and more as you take her and yourself to the heights of ecstacy before you leave Zoey and Madison for now.</p>");
		startQuestions();
		addLinkToPlace(md, "return to the station reception", 371)
	} else if (stype == "threesome") {
		if (!isExplicit()) perZoey.showPerson("GenericSex/threesome1.jpg");
		else if (perYou.isMaleSex()) perZoey.showPersonX("GenericSex/sex-mff threesome e.gif");
		else perZoey.showPersonX("GenericSex/sex-fff threesome a.jpg");
		addPlaceTitle(md, "Fucking Zoey and Madison");
		md.write("<p>There is no need to just have Madison watch so you call her over to join in.</p>" +
			"<p>The three of you take each other to the heights of ecstacy before you leave Zoey and Madison for now.</p>");
		startQuestions();
		addLinkToPlace(md, "return to the station reception", 371)
	} else if (stype == "visitzoey" || stype === "") {
		if (getHour() < 16) perZoey.showPerson(perZoey.checkFlag(1) ? "zoey6-noon.jpg" : "zoey5-noon.jpg");
		else perZoey.showPerson(perZoey.checkFlag(1) ? "zoey6-afternoon.jpg" : "zoey5-afternoon.jpg");
		addPlaceTitle(md, "Zoey Visits");
		md.write("<p>Zoey arrives and starts removing her clothing, and begs you,<br/>&quot;" +
			perYou.getMaster() + " please...&quot;</p>");
		startQuestions();
		addLinkToPlace(md, '"I\'d prefer you in your uniform"', 414, "type=fuck");
		addLinkToPlace(md, '"I want both you and Madison', 414, "type=threesome");
		if (isCharmedBy("Nina") && checkPersonFlag("Nina", 4)) addLinkToPlace(md, '"let\'s visit Nina for some more practise"', 371, "type=ninazoey2");
		addLinkToPlace(md, "return to the station reception", 371)
	}
	if (sType !== "threesome") {
		AddRightColumnMed(md);
		perMadison.showPerson(perMadison.checkFlag(13) ? "madison18be.jpg" :
			"madison18.jpg")
	}
	WritePlaceFooter(md)
}

function ShowPlace415() {
	var md = WritePlaceHeader();
	var perMom = findPerson("Mom");
	perMom.setFlag(13);
	var perGabby = findPerson("Gabby");
	var bBothCharmed = perMom.isCharmedBy() && perGabby.isCharmedBy();
	if (bBothCharmed) perGabby.showPerson("gabby-mom3.jpg");
	else perMom.showPersonRandom("mom5", 2);
	addPlaceTitle(md, "Mom at Work");
	if (bBothCharmed) md.write("<p>Your mothers' office is a good size, as befits her role as a senior member of the production staff.</p>" + "<p>She is, as usual, absorbed in conversation with Gabby, but the two are obviously a lot more \u201cfamiliar\u201d with each other now and it takes them a while to notice you.</p>" + "<p>\u201cOh, hi " +
		perYou.getPersonName() + ", we are still busy, but do you need anything from us?\u201d</p>" + "<p>Gabby still looks annoyed when you visit, but even she is somewhat excited to see you, now.</p>");
	else if (perGabby.isCharmedBy()) md.write("<p>Your mothers' office is a good size, as befits her role as a senior member of the production staff.</p>" + "<p>Both women are clearly absorbed in their work, but Gabby twitches a little as you enter the room. You see her pressing her legs together as she greets you, and Mom quickly follows suit.</p>" +
		"<p>\u201cOh, hi " + perYou.getPersonName() + ", we still have a lot to do, but if you need anything I can make some time.\u201d</p>");
	else {
		md.write("<p>Your mothers' office is a good size as befits her role as a senior member of the production staff.</p>" + "<p>You see her absorbed in conversation with her assistant Gabby Halliway and it takes a moment for her to realise you are there,</p>");
		if (perMom.checkFlag(19) && !perMom.checkFlag(34)) md.write('<p>"Hi ' + perYou.getPersonName() + ',  did you bring the clothes I asked for?"</p>' +
			"<p>You apologies that you had not got around to it. You notice that Gabby looks annoyed at the interruption.</p>");
		else md.write('<p>"Hi ' + perYou.getPersonName() + ', sorry but Mommy is really busy, can you come back later?"</p>' + "<p>You agree, and you notice that Gabby looks annoyed at the interruption.</p>")
	}
	startQuestions();
	if (bBothCharmed) {
		addLinkToPlace(md, "ask Mom if you may \u201cuse\u201d her assistant for a moment", Place, "type=usegabbyoffice");
		if (perMom.getCharmedLevel() > 1) addLinkToPlace(md,
			"tell Mom you need help in releasing some pent-up desire", Place, "type=momdesireoffice");
		if (perGabby.getCharmedLevel() == 1) addPopupLink(md, "tell them to not mind you and proceed", "Mom and Gabby", "<img src='Images/People/Gabby/gabby-mom9.jpg' class='imgpopup' alt='Mom Gabby'>" + "You know by now how your presence affects those under the Dai-Chu, and even though Mom and Gabby are both hesitant to give in to their needs, it only takes a small push to convince them they'd work way more efficiently when they make sure to release all that pent-up lust distracting them, and Mom is the first to take action, silencing her assistant's protest with a deep kiss that's leaving her breathless.",
			true, "dispPlace(Place,'type=momgabbyoffice2')")
	}
	addLinkToPlace(md, "return to the hallway", 372);
	WritePlaceFooter(md)
}

function ShowPlace416() {
	showGeneralPlace("Storage Room", "storageroom.jpg", "You are finally inside the storage room. It\u2019s a dark and small place filled with boxes, cabinets and unused cupboards. It looks  like this place is not used very often as it even has a musty and damp smell to it. You judge Madison and the other delivery people just throw in the stuff they carry and leave or just grab whatever they need and leave quickly. This whole place is not very organized.", "return to Madison's office",
		412)
}

function ShowPlace417() {
	showGeneralPlace("Gabby's Office", "gabby-office.jpg", "<p>Gabby's office is right next to Mom's and pretty much exactly how you expected it to be. Everything is very clean and looks like it has been placed exactly where she wants it to be using a water level and tape measure.</p>" + "<p>You can hear Mom and Gabby talking in the next room.</p>", "return to the hallway", 372)
}

function Selling() {
	var perCarol = findPerson("Carol");
	perCarol.setFlag(2);
	bChat = false;
	WriteComments(perCarol.addPersonFace() + "With no other idea, you tell her that you are here selling magazine subscriptions door to door. Carol smiles but refuses saying she reads everything now online. Before you can say more she says a polite goodbye and closes the door.</p>");
	dispPlace(5)
}

function ShowPlace420(stype) {
	var md = WritePlaceHeader();
	var perCarol = findPerson("Carol");
	var bCarolCharmed = perCarol.isCharmedBy();
	var herNameC = perCarol.getPersonName();
	var perEllie = findPerson("Ellie");
	var bEllieCharmed = perEllie.isCharmedBy("You");
	var herNameE = perEllie.getPersonName();
	var bLeave = true;
	if (!bEllieCharmed && perEllie.place == 93) perEllie.place = 430;
	if (perEllie.place == 430 && bEllieCharmed) perEllie.place = 422;
	if (perEllie.place == 93 && bEllieCharmed) perEllie.place = 422;
	var plcEllie = perEllie.whereNow();
	if (wherePerson("Kristin") === 420)
		if (checkPersonFlag("Kristin", 14)) {
			if (stype === "") {
				setQueryParams("type=kristincarol2");
				stype = "kristincarol2"
			}
		} else if (plcEllie == 422) return dispPlace(422, "type=visitcb");
	else {
		WriteComments("There is no answer at the door");
		return dispPlace(5)
	}
	if (stype === "") {
		if (bEllieCharmed && bCarolCharmed && plcEllie == 422) perCarol.showPerson("carolellie1.jpg", "height:max");
		else if (bCarolCharmed) perCarol.showPersonDN("carol1d.jpg");
		else perCarol.showPersonDN("carol1a.jpg");
		if (!perCarol.checkFlag(1)) {
			addPlaceTitle(md,
				"Bartel Home Doorstep");
			md.write("<p>You approach the house and again you cannot help but admire the fairly new and large house, It is a little bit of a contrast to some of the older homes in the area. You notice an expensive yellow sports car in the driveway.</p><p>You knock on the door, a little unclear on how you are going to approach Ellie but sure you can wing something. The door opens and you see a tall gorgeous blonde woman smiling at you. She speaks to you with a slight accent that you cannot quite place,</p>" +
				'<p>"Hello there I\'m Carol Bartel, nice day! What is it you want? If you are for my wife Sally, she is away doing a business trip."</p>' + "<p>She has not invited you into the house yet so you are standing on the front door-step. As you consider your reply your eyes are almost unconsciously drawn to her large and you would guess natural breasts. You quickly look back up, and you see her smile, she must be very used to people admiring her.</p>");
			perCarol.setFlag(1)
		} else if (!bCarolCharmed) {
			addPlaceTitle(md,
				"Bartel Home Doorstep");
			md.write('<p>"Hello again! What is it you want this time?"</p>' + "<p>She has not invited you into the house yet so you are standing on the front door-step.</p>")
		} else if (bEllieCharmed && plcEllie == 422) {
			addPlaceTitle(md, "Bartel Home");
			md.write("<p>You visit " + herNameC + " and " + herNameE + " in the living room. They address you in practised unison,</p>");
			md.write('<p>"Hello ' + perYou.getMaster() + ' what can we do to you this time?"</p>')
		} else {
			addPlaceTitle(md, isDay() ? "Bartel Home Kitchen" :
				"Bartel Home Living Room");
			var sw = perYou.isMaleSex() ? "Volkhov" : "Vedma";
			md.write("<p>When you arrive " + herNameC + " seems happy that you visit her and gestures you to follow into the kitchen. You see her stretch seductively on the way, inevitably pulling up her top and making no effort to return it into place.</p>" + "<p>\"It's really nice to have some company, my " + sw + ' would you like me to get you something? A drink, snack, lots of dirty sex?"</p>')
		}
		startQuestions();
		if (!perCarol.checkFlag(2) && !perCarol.checkFlag(3)) {
			addOptionLinkC(md,
				'"ummm..I am selling magazine subscriptions"', "Selling()");
			addLinkToPlaceC(md, '"oh..I\'m from the Bank and I need to speak to Ellie"', 420, "type=bank")
		}
		if (plcEllie == 422)
			if (bEllieCharmed && bCarolCharmed) {
				addLinkToPlaceC(md, "speak to Ellie privately", 422);
				addLinkToPlaceC(md, "speak to Carol privately", 424);
				addLinkToPlaceC(md, "let us play together", 420, "type=threesome");
				addLinkToPlaceC(md, "mother daughter time", 420, "type=motherdaughter")
			} else addLinkToPlaceC(md, '"I am here to visit Ellie, she invited me over"',
				422, bCarolCharmed ? "" : "type=visitc");
		else if (bCarolCharmed) addLinkToPlaceC(md, "speak to Carol privately", 424);
		if (plcEllie == 423) addLinkToPlaceC(md, '"Is Ellie at home?"', 423);
		else if (bEllieCharmed || perCarol.checkFlag(12)) addLinkToPlace(md, "check the pool", 423)
	} else if (stype == "threesome") {
		if (isExplicit())
			if (perYou.isMaleSex()) perCarol.showPersonX("carolellie3b.jpg");
			else perCarol.showPersonRandomX("carolellie3g", 4, "30vw,50vw");
		else if (perYou.isMaleSex()) perCarol.showPersonX("carolellie3b.jpg", "50vw");
		else perCarol.showPersonRandomX("carolellie3g", 2, "50vw");
		addPlaceTitle(md, "Playing together with the Bartel's");
		md.write("<p>You invite Carol and Ellie to join you in the bedroom to live out the mother/daughter threesome fantasy.</p>");
		startQuestions();
		addLinkToPlaceC(md, "mother daughter time", 420, "type=motherdaughter");
		addLinkToPlace(md, "return to the living room", 420)
	} else if (stype == "motherdaughter") {
		perCarol.showPersonRorX("carolellie2.jpg");
		addPlaceTitle(md, "Mother/Daughter Bonding");
		md.write("<p>You invite Carol and Ellie to join you in the bedroom, but tell them to get closer to each other, and play together. Ellie looks a little reluctant, but Carol embraces her with enthusiasm and a smile on her face.</p>");
		startQuestions();
		addLinkToPlaceC(md, "let us play together", 420, "type=threesome");
		addLinkToPlace(md, "return to the living room", 420)
	} else if (stype == "bank") {
		perCarol.showPersonDN("carol1b.jpg");
		addPlaceTitle(md, "Bartel Home");
		md.write("<p>You tell her that you are here from the Bank and need to check some information with Ellie. Carol Bartel answers,</p>" + '<p>"My daughter is popular lately."<br/>' + "She giggles and then says<br/>" + '"Creepy new boyfriends aside, I been told there some funny things happening in town recently. I will call Kristin and check you do work for her"<br/>' +
			"<p>She takes out her mobile phone and makes a call,<br/>" + '<p>"Hi Kristy, there is a ' + perYou.getSex() + " here to see Ellie from your Bank, is this ok...Good!...Yeah I suppose cute, " + (perYou.isBornMale() ? "but you know not my type" : "you're cuter") + '..See you tonight?...Ok bye!"</p>');
		if (isDay()) md.write("<p>She puts her phone away and stretches while looking at you curiously. Her top slips up exposing the lower parts of her breasts but she does not notice. She says,</p>" + '<p>"Kristy likes you and says fine then. Ellie is at the park reading, she is studying for a part-time business degree. She would have gone to her new boyfriend but she said he was busy. Try the lake at the Glenvale Park. If she is not there you may like to try his house, it\'s the Robbins house on Yoolaroo Drive."</p>' +
			'<p>She checks her phone for the address and as she does she notices her top and adjusts it. She smiles and tells you "Naughty!".</p>');
		else md.write("<p>She puts her phone away and stretches while looking at you curiously. Her thin nightie slips exposing more of her breasts but she does not notice. She says,</p>" + '<p>"Kristy likes you and says fine then. Ellie is at the park reading, she is studying for a part-time business degree. She would have gone to her new boyfriend but she said he was busy. Try the lake at the Glenvale Park. If she is not there you may like to try his house, it\'s the Robbins house on Yoolaroo Drive."</p>' +
			'<p>She checks her phone for the address and as she does she notices her nightie and adjusts it. She smiles and tells you "Naughty!".</p>');
		perCarol.setFlag(3);
		perEllie.place = 421;
		setPlaceKnown("DuckPond");
		if (!isPlaceKnown("RobbinsHouse")) {
			md.write("<p><b>You now know the Robbinses' address.</b></p>");
			setPlaceKnown("RobbinsHouse");
			if (!isPlaceKnown("Alley")) setPlaceKnown("Alley")
		}
		startQuestions()
	} else if (stype == "kristinvisit") {
		movePerson("Kristin", 420);
		AddImage("kristincarol1.jpg");
		addPlaceTitle(md,
			"Kristin visits Carol");
		md.write("<p>Kristin dresses casually and you both leave her house and go next door. As you arrive you see Carol has changed and is leaving her house and walking over to the sports car in the driveway. Kristin walks over to her, and they talk for a little while, just small talk, ignoring you entirely. Kristin glances over to you and quickly shows her phone to you, she must mean she will call you when things are ready. She then waves to you, and she and Carol enter into Carol's home, just before the door closes you see them kissing.</p><p>You will have to kill some time until Kristin calls. You suppose you could wait in Kristin's house or go for a walk, you doubt you will have to wait for long.</p>");
		setPersonFlag("Kristin", 4);
		setPersonFlagAfterTime("Kristin", 15, undefined, 10);
		startQuestions()
	} else if (stype == "kristincarol2") {
		movePerson("Kristin", 430);
		perEllie.place = 423;
		bLeave = false;
		AddImage(stype + ".jpg");
		addPlaceTitle(md, "Visiting Kristin and Carol");
		md.write("<p>You knock on the door to the Bartel's house, and a moment later Kristin answers it, dressed in sexy lingerie. She takes you through into the master bedroom where Carol is already waiting on the bed, dressed in a similar attire. She explains to you with a smile,</p>");
		if (perYou.isBornMale()) md.write('<p>"Carol has agreed to letting you watch us, but you may not touch or join in. Men do nothing for her sexually, unlike me."</p>');
		else md.write('<p>"Carol has agreed to letting you watch us, and maybe even join in. Let us see how she likes you after a bit"</p>');
		md.write("<p>She slips onto the bed and kisses Carol, who at first returns the kiss, but then quickly breaks away, looking at you suspiciously,</p>" + "<p>\"Wait a moment, you are the one from before...  what was that about selling magazine subscriptions?\u201d She looks at you suspiciously. \u201cLook, you are a friend of Kristin, and I don't know why you lied to me, but I'm not comfortable with this anymore, you should leave now.\"</p>");
		startQuestions();
		addLinkToPlaceC(md, '"Goodbye?"', 5, "", "A little while after leaving the house Kristin joins you, &quot;Sorry " + perYou.getMaster() + " she can be a bit temperamental at times! Come back to my home, and I will make it up to you!&quot;")
	} else if (stype == "kristincarol3") {
		AddImage(stype + ".jpg");
		addPlaceTitle(md, "Carol under a Charm Spell");
		md.write("<p>You whisper the words of the charm and Carol sighs as the spell floods her body with arousal, strengthening what she must have already been feeling. She starts to undress Kristin, who gives you a knowing smile. Carol, though, glares at you as she notices,<br>" +
			'"You\'re still here, go away...I need..with Kristy..."</p>' + "<p>You shake your head and firmly tell her,<br>" + '"How could I leave if you want Kristin? She is my slave, my completely loyal servant and plaything. We are only here because I want you, and Kristin is obeying my desires. She is my proxy, Carol, a sex toy I am using to arouse you and a toy I will use to fuck you."</p>' + "<p>While you speak, Kristin kisses a distracted Carol, quickly removing most of her lingerie and whispering to her,<br>" +
			'"Is this not great? I will be the toy ' + perYou.getMaster() + " uses to make love to you, Carol!\u201d She turns to you. \u201cPlease use me, " + perYou.getMaster() + '!"</p>' + "<p>Carol looks between the two of you in confusion, dimly aware that something can't be right as the spell increases her arousal further, making her more receptive for Kristin's touch.<br>" + '"Don\'t worry, Carol," You say. "you will be joining Kristin soon, but first, you will lick my toy."<br>' + '<p>Carol gasps while Kristin\'s hands roam over her body, some of her resistance vanishing as she looks at you. "Joining?"');
		startQuestions();
		addLinkToPlaceC(md, 'you answer "As a slave"', 420, "type=kristincarol4")
	} else if (stype == "kristincarol4") {
		AddImageRorX(stype + ".jpg");
		addPlaceTitle(md, "Carol under a Charm Spell");
		md.write("<p>Carol mind seems to snap back into reality a little and again, she glares at you,<br>" + '"Slave?..."<br>' + "You interrupt her,<br>" + '"Yes, a Slave! And you will stop questioning me. I want you to lick my toy and properly prepare her to fuck you."</p>' + "<p>She is clearly struggling with your words, but after a moment of hesitation, her arousal gets the better of her and she moves to kiss and lick Kristin's folds, something they have undoubtedly done many times before. You watch as Carol gets more and more lost in her arousal and the passion of the moment and seems to forget about you in her desire to tend to her lover. You would guess that Kristin often takes the lead or even a dominant role in these things.</p>" +
			"<p>Kristin on her end, seems to really enjoy herself, giving you a sly smile as she leans back to present her body to Carol and moaning loudly under her touch,<br>" + '"' + perYou.getMaster() + ", your toy is getting very wet, and your new slave is very good at licking pussies.\u201d She seems close to the edge and roughly grabs her lovers hair. \u201dCarol, oh Carol! My body belongs to my " + perYou.getMaster() + ", so drink your " + perYou.getMaster() + "s cum!\u201d</p>" + "<p>Kristin cries out as she orgasms and Carol looks at you, still confused by what is happening with her, her mind malleable under your spell,<br>" +
			'"Slave Carol. You will now present your pussy to my Toy, and I will use her to fuck you."</p>' + "<p>She starts to object, but you cut her off,</p>");
		startQuestions();
		addLinkToPlaceC(md, '"Obey Slave"', 420, "type=kristincarol5")
	} else if (stype == "kristincarol5") {
		AddImageRorX(stype + ".jpg");
		addPlaceTitle(md, "Slave Carol under a Charm Spell");
		md.write("<p>Your words seem to shake her body and she gasps in pleasure as you repeat them, telling her to obey you and turn back to Kristin,<br>" + '"Join me as ' + (perYou.isBornMale() ?
				"Masters" : "Mistresses") + " slave,\u201d Your toy coos to her, her lips close to Carols. \u201dlet me fuck you as our " + (perYou.isBornMale() ? "Masters" : "Mistresses") + " toy and accept " + perYou.getHimHer() + " as your " + perYou.getMaster() + ' as well."</p>' + "<p>Carol's expression changes, a last moment of defiance flaring up before the doubt and confusion leaves her mind and she gives Kristin a deep kiss, finally turning to you.<br>" + '"' + perYou.getMaster() + '... \u201cShe smiles at you broadly.\u201d Please fuck me. Use your toy or fuck your slave. I want to be yours!"</p>' +
			"<p>Kristin picks up a dildo from what seems to be a curiously large collection and leans back, motioning for Carol to move on top of her. Your new slave happily complies and you watch as your toy uses the Dildo to fuck her in your name, driving the already heavily aroused woman to her climax with surprising speed,<br>" + '"' + perYou.getMaster() + "! Your toy...you..ahhh..making me cummm!!!</p>" + "<p>Carol slumps back onto her back from the sensation, looking at you with nothing but devotion in her eyes,</p>" +
			'<p>"' + perYou.getMaster() + '..."</p>');
		startQuestions();
		addLinkToPlaceO(md, "fuck your slave, Carol", 420, "type=fuckcarol")
	} else if (stype == "fuckcarol") {
		if (perYou.isBornMale()) AddImageRandomRorX("carol7b", 2, "50vw");
		else AddImageRorX("carol7g.jpg", "50vw");
		addPlaceTitle(md, "Fucking Slave Carol");
		md.write("<p>Seeing how the spell has fully taken over Carols mind, you finally move closer to the bed, ordering Kristin to undress you while you speak to your newest acquisition,<br>" + '"I will now Fuck you personally, slave, turn around and present your pussy."</p>');
		if (perYou.isBornMale()) md.write("<p>Carol complies but seems uncertain as Kristin removes your underwear and reveals your erect cock, but you just shake your head. \"I know are a Lesbian, but I also know you want me to fuck you, isn't that right, slave?\" You position yourself behind her as you speak, placing your cock's tip to her folds.</p>");
		else md.write('<p>Carol complies eagerly while Kristin fastens a likely well used strap on to your hip. "You like to be fucked with this, right slave?" You ask and position yourself behind her, placing the strap tip to her folds.</p>');
		md.write('<p>"Yes ' + perYou.getMaster() + '...." She coos...</p>' + '<p>"And you will fuck any woman I want you to as well, like a good little slavetoy, right?"</p>' + '<p>"Yes, ' + perYou.getMaster() + "...\u201d She begins to grind her hip back against you with desperate moans.</p>" + '<p>"Good slave. Now let me claim you fully, and become mine."</p>' + "<p>You push into her before she even has a chance to reply and begin to rock your hips, delighting in Carols unrestrained passion as you take her roughly, and seal her fate as your slave.</p>");
		startQuestions()
	}
	if (bLeave) addLinkToPlace(md, "leave the house", 5);
	WritePlaceFooter(md)
}

function ShowPlace421(stype) {
	var perE = findPerson("Ellie");
	var herName = perE.getPersonName();
	var perKate = findPerson("Kate");
	if (perKate.place == 421 && perE.place != 421) return dispPlace(36);
	var md = WritePlaceHeader();
	if (perE.place == 421 && perKate.place == 421 && stype === "") {
		addPlaceTitle(md, "Duck Pond", "pond1.jpg");
		md.write("<p>An artificial duck pond in the park, a very pleasant place to sit and relax.</p><p>You can see Ellie sitting on a bench and around the other side of the pond Kate is walking along a path</p>");
		startQuestions();
		addLinkToPlaceC(md, "talk to Kate", 36);
		addLinkToPlaceC(md, "talk to Ellie", 421, "type=ellie2a");
		addLinkToPlace(md, "walk to the park entrance", 47);
		WritePlaceFooter(md);
		return
	} else if (stype === "contemplate") {
		addPlaceTitle(md, "Duck Pond", "pond2.jpg");
		md.write("<p>You look at the small ornamental pool but meditation has never been a thing for you.</p>");
		startQuestions();
		addLinkToPlaceC(md, "that is enough", 421)
	} else if (perE.place !== 421) {
		addPlaceTitle(md, "Duck Pond", "pond1.jpg");
		md.write("<p>An artificial duck pond in the park, a very pleasant place to sit and relax. There is a small ornamental pool to one side, it is one or two paces across, just meant for contemplation.</p>");
		startQuestions();
		addLinkToPlaceC(md, "contemplate the pool", 421, "type=contemplate")
	} else {
		if (stype === "") stype = "ellie2a";
		perE.showPerson(stype + ".jpg");
		addPlaceTitle(md, herName + " at the Duck Pond");
		if (stype == "ellie2a") md.write('<p>You see Ellie is relaxing on a seat dressed casually in the bright sunlight. She appears to be daydreaming, not studying as her mother thought. You think you hear her whisper "Davy".</p>');
		else if (stype == "ellie2b") {
			md.write("<p>She looks at you, a flash of anger crosses her face, and she exclaims,</p>" +
				'<p>"That bitch!"</p>' + "<p>She looks at you again, and her expression changes,</p>" + '<p>"I\'m sorry, I do not know what has come over me recently. She is not really, I just wish she would leave my mother alone.<br/><br/>Look what you have done, ruined my fantasy here, I think I will go and see if <b>he</b> is free, please let him be and not be with <i>her</i>!"</p>' + "<p>She smiles at you and walks back to the park entrance.</p>");
			perE.place = 93;
			perE.setFlag(2)
		}
	}
	startQuestions();
	if (perE.place === 421) {
		if (!perE.checkFlag(1)) addQuestionR(md,
			"hello", "She smiles brightly and replies, &quot;Hi!&quot; but then looks away back to her thoughts.", "Ellie", "setPersonFlag(\\'Ellie\\',1);");
		if (perE.checkFlag(1) && !perE.checkFlag(2)) addLinkToPlaceC(md, '"The Bank Manager Kirstin sent me..."', 421, "type=ellie2b")
	}
	addLinkToPlace(md, "walk to the park entrance", 47);
	WritePlaceFooter(md)
}

function ShowPlace422(stype) {
	var perCarol = findPerson("Carol");
	var bCarolCharmed = perCarol.isCharmedBy();
	var perEllie = findPerson("Ellie");
	var herName = perEllie.getPersonName();
	var clvE = perEllie.isCharmedBy() ? perEllie.getCharmedLevel() : 0;
	var myName = clvE == 4 ? perYou.getMaster() : perYou.getPersonName();
	var md = WritePlaceHeader(stype === "seecarol", stype === "carol5" || !isExplicit() && stype == "fuck" ? "td-left-large" : "");
	var bWait = true;
	var b2Cols = false;
	if (stype === "") {
		perEllie.showPersonRandom("ellie16", 2);
		addPlaceTitle(md,
			"Ellie in the Living-room");
		if (clvE == 4) md.write("<p>You request to talk with your lover/slave in private for a bit, and Carol gives the two of you a knowing wink before she excuses herself into the Kitchen to prepare a snack.</p>" + "<p>Ellie opens the door to her room, obediently waiting for you to enter with her eyes still downcast, and locks it behind her.</p>" + "<p>You sit down on a nearby couch and watch her as she slips onto her knees again, both legs slightly spread and her arms resting on her tights, palms upward in a strangely specific looking way.</p>" +
			'<p"How may this slave be of service to you, ' + perYou.getMaster() + '?" She asks submissively, not daring to look at you directly.</p>');
		else md.write("<p>" + herName + " is sitting on the lounge, and she is not wearing very much at all.</p>" + '<p>"Hello my love! I am really happy to see you again!!</p>');
		startQuestions();
		if (perYou.isMaleSex()) {
			addLinkToPlaceO(md, clvE == 4 ? "fuck her" : "fuck her", 422, "type=fuck");
			addLinkToPlaceO(md, clvE == 4 ? "have her serve you with her mouth" : "fuck her mouth", 422, "type=bj")
		} else {
			addLinkToPlaceO(md,
				clvE == 4 ? "have her lick you" : "have her lick you", 422, "type=bj");
			addLinkToPlaceO(md, clvE == 4 ? "make love to her" : "make love to her", 422, "type=fuck")
		}
		addSleepLink(md, "go to bed for the night with Ellie", "Going to Bed with Ellie", '<p style="position:absolute;left:2%;top:2em;cursor:pointer;font-size:1.1em;width:66%">It is getting late and and Ellie suggests you spend the night, mentioning she prefers to sleep in the nude...', "ellie-bed.jpg")
	} else if (stype == "fuck") {
		if (!perYou.isMaleSex()) perEllie.showPerson("ellie19g.jpg");
		else if (isExplicit()) perEllie.showPersonRandomX("ellie30", 3);
		else perEllie.showPersonRandom("ellie30", 2);
		addPlaceTitle(md, herName);
		md.write("<p>You fuck " + herName + "</p>" + "<p></p>");
		startQuestions()
	} else if (stype == "bj") {
		if (perYou.isMaleSex()) perEllie.showPersonRorX("ellie19b.jpg", "50vw");
		else perEllie.showPersonRorX("ellie19g.jpg", isExplicit() ? "50vw" : "");
		addPlaceTitle(md, herName);
		if (perYou.isMaleSex()) md.write("<p>" + herName + " gives you a blowjob</p>");
		else md.write("<p>" + herName + " licks you</p>");
		startQuestions()
	} else if (stype == "visitcb" || stype == "visitc") {
		perEllie.showPersonRandom("ellie16", 2);
		addPlaceTitle(md, "Ellie in the Living-room");
		if (stype == "visitcb") {
			md.write("<p>You knock on the door to the Bartel home and after a little " + herName + " answers and she leads you into the living room. She is not wearing very much at all.</p>");
			if (clvE == 4) md.write('<p>"Hello ' + myName + ' this slave is sorry for being so slow, her mother is currently busy with a friend of hers, the Bank Manager Kristin."</p>');
			else md.write('<p>"Hello my love! Sorry I took so long, I thought my mother was going to answer the door. Then I remembered she is busy with her friend Kristin". You notice she looks a little unhappy. You reassure her that it will be alright and she smiles and kisses you.</p>')
		} else if (stype == "visitc")
			if (!bCarolCharmed) md.write('<p>Carol tells you that Ellie is in the lounge room, and steps aside as you enter the house. Before you have a chance to do anything else, she has already moved into another room and closes the door. "I just leave you two alone." You hear her comment from behind the door in a teasing voice.</p>' +
				"<p>Once again, you are surprised at the speed of the women of this family, what are they all? Hyperactive? You go to Ellie's room, and she greets you wearing little more than a rather sexy corset.</p>");
		startQuestions();
		if (stype == "visitcb") addLinkToPlaceC(md, '"Would you interrupt your mother, I need to see her"', 420, "type=interrupt")
	} else if (stype === "seecarol") {
		bWait = false;
		b2Cols = true;
		md.write('<table class="table-main"><tr><td>');
		addPlaceTitle(md, "Carol Visits", "", 0, true);
		perCarol.showPersonDN("carol1c.jpg",
			"60%", "center");
		perEllie.setFlag(4);
		md.write("<p>Your " + (clvE == 4 ? "slave" : "lover") + ' steps over to a door and asks, "Mom, do you have a moment to meet someone?"</p>' + "<p>Her mother Carol steps into the room a few minutes later, giving Ellie a smile as she takes a seat and stretching out with her legs up on a counter top. She looks at you with the broad smile that seems to be characteristic of the women of this family, well, that and a surprising turn of speed at times.</p>" + '<p>Carol says, "Well, it is the ' +
			perYou.getSex() + " from the Bank, is it not? Are you and Ellie an item now? I hope so, her last boyfriend was creepy!\u201d</p>");
		if (clvE == 4) md.write('<p>Ellie exclaims, "Mom...what do you mean, my last boyfriend...? ' + perYou.getPersonName() + " is not my lover, but my " + perYou.getMaster() + '"</p>' + '<p>Carol lifts her eyebrows at at statement and just says "Kinky, I like!"</p>');
		else {
			md.write("<p>Ellie exclaims, \"Mom... I... don't really like to think about my last Boyfriend, but I do love " + perYou.getPersonName() +
				' dearly, it was love at first sight."</p>');
			if (!perYou.isBornMale()) md.write('<p>Carol looks a little surprised, "Strange, my Ellie has never liked girls that way before, you must have a special way about you?</p>')
		}
		md.write('<p>Carol continues, "So tell me about yourself!"</p>');
		startQuestions();
		addLinkToPlaceC(md, "talk about yourself", 422, "", "You have a pleasant chat with Carol and after a while she apologies and tells you she has an appointment and has to leave, she smiles and leaves you and " +
			herName + " alone.")
	} else {
		bWait = false;
		b2Cols = true;
		if (stype === "carol4") perCarol.showPersonRorXDN(stype + ".jpg");
		else if (stype === "carol5") perCarol.showPersonRorXDN(stype + ".jpg");
		else perCarol.showPersonDN(stype + ".jpg");
		addPlaceTitle(md, "Carol Under a Charm Spell");
		var sw = perYou.isMaleSex() ? "volkhov" : "vedma";
		if (stype === "carol2") {
			md.write("<p>You tell Carol about your search for the Kurndorf book and the secrets of magic it contains, she smiles and tells you,</p>" + '<p>"You want to be be a ' + sw + " from the old tales, a spinner of potions and spells, a talker to the vampir and wolf-skin's.\"<br>" +
				'She gently laughs, and continues in amusement, "So my little ' + sw + ' what have you found?"</p>' + '<p>You tell her "Here is one thing" and recite the charm spell, the sudden rush of mana entering her body taking Carol completely of guard. "Strange words those..."</p>' + "<p>She stands and stretches, her breasts slipping out of her tight top, she pays no attention as the spell work itself into her mind, looking around for a moment before she comments,</p>" + '<p>"So strange, like Svarog is here...it is so hot and I feel the pounding of his hammers...."</p>' +
				"<p>Carol grabs her short skirt and waves it around to cool her growing passions, but all she achieves is to show you her " + (isDay() ? "red" : "black") + " underwear.</p>");
			startQuestions();
			addLinkToPlaceC(md, 'ask her "Who is Svarog"', 422, "type=carol3")
		} else if (stype === "carol3") {
			md.write("<p>You ask about the name Svarog. You think you have heard the name in mythology but cannot place it. Also, this helps to keep her mind off what is happening to her for a while.</p>" + '<p>"Svarog, the smith of the sky forge some say.", Her voice trails off and she continues speaking in some Slavic language until she realizes it and stops. You decide to take advantage of her confusion,</p>' +
				'<p>"If you are so hot, you should make yourself comfortable"</p>' + "<p>Carol removes her skirt and slides her top up further. You notice her " + (isDay() ? "red" : "black") + " panties start to slip down as well. She may have pulled them down as she removed her skirt, but your attention was focused at the time on her lovely breasts. Carol looks at you, a smile re-forming on her face,</p>" + '<p>"Naughty ' + sw + " aren't you\"</p>");
			startQuestions();
			addLinkToPlaceC(md, 'answer "Yes I am a ' + sw + '"', 422, "type=carol4")
		} else if (stype ===
			"carol4") {
			perCarol.charmThem(2);
			md.write('<p>You tell her "Yes I am a ' + sw + ', and you are under my spell"</p>' + '<p>Carol laughs, "Yes, I am enchanted by you, naughty little ' + sw + '"</p>' + "<p>She is just playing along with a game but not realizing how close to the actual truth she is, so you continue to play along as well, speaking in a playful manner, but never straying from the absolute truth,</p>" + '<p>"You are ensorcelled by me!\u201d You lay it on thick. \u201cA slave to my spell! And you want to do something naughty for me now."</p>');
			if (isExplicit()) md.write("<p>Carol removes her panties, and while she does, Ellie hands her mother a transparent plastic item. Svarog only knows how she got it so fast, but Carol eagerly puts it to her lips and you see it is a narrow dildo. Carol begins licking playfully with surprising experience, eager to delight and arouse you.</p>");
			else md.write("<p>Carol sits down and removes her panties, as she does Ellie rearranges a chair so Carol can put her legs up. Carol spreads her legs giving you a clear view of her pussy, touching it as you watch.</p>");
			md.write('<p>Carol asks "Naughty enough, little ' + sw + "</p>");
			startQuestions();
			addLinkToPlaceC(md, 'of course you answer "No"', 422, "type=carol5")
		} else if (stype === "carol5") {
			md.write('<p>"No!\u201d Your voice booms. \u201cMy spell commands you to do more!"</p>' + "<p>Carol laughs gently at your true words, and it is difficult to say how much it is the spell which is controlling her, or the game she thinks she is playing. In some ways it does not matter as long as she does not stop playing, and the spell should ensure to make it that way.</p>");
			if (isExplicit()) md.write('<p>Carol now uses the dildo to tease her pussy, but quickly begins to do more, pushing it into her feverishly to fuck herself until she finally cries out "I cum for my little ' + sw + '!"</p>');
			else md.write('<p>Carol plays more with per pussy and ass and after a while moves and actively starts masturbating herself. After a while she cries out "I cum for my little ' + sw + '!"</p>');
			md.write('<p>\u201cYes!\u201d You again lay on the ham. \u201cCum for me! Cum and the Spell will be completed to bind you to my will! And when it is, we will play these games more often!"</p>' +
				'<p>Once again speaking the truth within the game, Carol is finally driven over the edge with a loud scream and falls back to bask in the afterglow, her now pink eyes focus on you adoringly as she replies: "Yes, we should play again.\u201d Once more giving you a broad smile.</p>');
			startQuestions()
		}
	}
	if (wherePerson("Kristin") === 422) {
		if (checkPersonFlag("Kristin", 14)) addLinkToPlace(md, "go and see Kristin and Carol", 420)
	} else if (!bCarolCharmed)
		if (!perEllie.checkFlag(4)) addLinkToPlaceC(md, "ask to see her mother, Carol",
			422, "type=seecarol");
	if (bWait) {
		addLinkToPlaceO(md, "wait for a while", 422);
		if (bCarolCharmed) addLinkToPlaceC(md, "talk more with Carol and Ellie", 420)
	}
	addLinkToPlace(md, "leave the house", 5);
	if (b2Cols) {
		AddPeopleColumn();
		perEllie.showPerson("ellie17.jpg", "100%")
	}
	WritePlaceFooter(md)
}

function ShowPlace423(stype) {
	var perE = findPerson("Ellie");
	var clv = perE.getCharmedLevel();
	var herName = perE.getPersonName();
	var md = WritePlaceHeader(false, stype === "ellie26" || stype === "pooloral" || stype === "" && perE.place == 423 ? "td-left-large" : "");
	if (stype === "") {
		if (perE.place == 423) {
			perE.showPerson("ellie21.jpg");
			addPlaceTitle(md, "Ellie in the Swimming Pool");
			md.write("<p>" + herName + " is wearning a cute one-piece swimming suit as she plays in the expensive looking swimming pool. She is sitting on an inflatable bed and splashing around.</p>");
			if (!isInvisible())
				if (perE.isCharmedBy("Davy")) md.write('<p>She notices you and looks at you curiously, "Why are you here?", and she looks thoughtful for a moment. She starts to paddle over to the edge of the pool where her towel is on a sun-lounge.</p>');
				else md.write('<p>She notices you and calls out "Hi there, are you a friend of Moms? Haven\'t I seen you at the bank?"</p>')
		} else {
			addPlaceTitle(md, "Bartel Swimming Pool", "pool2.jpg");
			md.write("<p>The swimming pool looks very expensive, but it is empty at this time.</p>")
		}
		startQuestions()
	} else if (stype ===
		"pooloral") {
		perE.showPerson("ellie28.jpg");
		if (clv == 4) addPlaceTitle(md, herName + " Showing Her Devotion");
		else addPlaceTitle(md, herName + " Showing Her Love");
		if (clv == 4) {
			md.write("<p>You order your new slave to show her obedience and devotion. Ellie looks at you, unsure what you mean, but smiles as you remove your clothing and sit down on the edge of the pool.</p>");
			if (perYou.isBornMale()) md.write("<p>She kneels and takes over, pulling down your underwear and taking your cock and balls into her hands. She starts to lick along the entire length of your shaft, and you can tell she is no novice but also not all too practiced ether. Still, she is talented enough, and shows her somewhat playful nature as she pleases you.</p>" +
				'<p>You decide to enforce your dominance of her a little more, and while she is licking the head of your cock you firmly grasp her hair and make it clear she is to go deeper, as deep as she can. She tries to accommodate you but she has definitely not done this before. She manages to get a bit over half your length into her mouth and throat before you call out "Now swallow, Slave!" and cum into her throat. She gags a little, but manages to keep most of it inside, swallowing obediently and looking up at you, the smile returning to her face.</p>');
			else md.write("<p>She looks at you uncertain, hesitating until you reinforce your order and she finally steps into the pool to nervously lick your pussy.</p>" + "<p>Well, at least for about 5 seconds, before she backs away and lowers her head in shame. \u201cY..your slave apologizes, mistress. But she is not a lesbian.... she can't do that.</p>" + "<p>Well, that was unexpected, you reach down and lift her chin to check her eyes, but she is clearly under your spell, you can feel your mana flowing through her body and see the pink shine in her eyes.</p>" +
				"<p>\u201cSlave Ellie.\u201d You speak firmly. You will do as you are told, and not question my orders.</p>" + "<p>The pink glow flares up and again, her head moves forward, but to your amazement, she again resists.</p>" + "<p>\u201cI... your slave really can't do this, mistress... It.... does not feel right...\u201d Her head slumps down again\u201d Sorry, mistress.\u201d</p>" + "<p>So, even with the spell in full effect, she has enough willpower to deny certain orders... you admit you are somewhat impressed, and decide to relent until you know more about this, telling her that she will not be required to serve you like this... for now.</p>");
			md.write('<p>Finally, you address her: \u201cSlave Ellie, go and clean up and I will meet you inside"</p>' + "<p>Ellie smiles and walks into the house, still completely naked...</p>")
		} else {
			md.write("<p>You move to make her lie down on the sun-lounge, but as you try to press your body against hers, she suddenly recoils from your touch.</p>" + '<p>"Ouugh, I... just had a horrible vision of someone else...not you..."</p>' + "<p>You realize she still has some memories of Davy and suggest delaying this for a while, but she shakes her head.</p>" +
				'<p>"N...no, It\'s fine. Let me show you my love another way, instead."</p>' + "<p>She steps into the pool and gestures for you to sit on the edge,, reaching out with both hands to open your pants, but once again recoils after a few seconds, looking both confused and embarrassed.</p>" + "<p>\u201cCome to think of it, Your mom might hear us.\u201d You finally interrupt her, realizing that she might still be fighting both your charm and the memories of her time as Davys slave  in her subconsciousness.\u201c We might be taking this too fast, anyway, ");
			if (!perYou.isBornMale()) md.write("and you didn't even know you could fall for another woman until now, ");
			md.write("so we better give it some time.</p>" + "<p>Ellie still looks a little embarrassed, but also relieved, and quickly nods. You tell her that it's best if the two of you return inside now, and that you can talk later.</p>" + "<p>Ellie smiles and agrees before she gives you a kiss and grabs her towel and swimsuit on her way into the house, not bothering to re-dress...</p>")
		}
		startQuestions()
	} else {
		perE.showPerson(stype +
			".jpg");
		if (stype === "ellie22") addPlaceTitle(md, "Ellie Freed from Davy's Spell");
		else addPlaceTitle(md, "Ellie Under a Charm Spell");
		if (stype === "ellie22") {
			perE.unCharmThem();
			md.write("<p>The ring glows as you clasp it in your fist and focus on the mana powering the <i>charm</i> over Ellie, absorbing it within moments.</p>" + "<p>Ellie looks startled, scanning the area in confusion.</p>" + '<p>"Where am... is this our pool?" How did I...</p>');
			if (!isInvisible()) md.write("<p>When she finally notices you, her eyes widen in shock. \"Who are you, didn't we meet somewhere... recently? \u201c It seems the memory slowly catches up with her and tears begin to form. \u201dDavy... he told me to... hurt you...\u201d</p>" +
				"<p>\u201cNo...no, this is not right, what happened to me?\u201d</p>");
			startQuestions()
		} else if (stype === "ellie23") {
			perE.place = 422;
			md.write("<p>You recite the words of the spell and Ellie looks at you in surprise,</p>" + '<p>"I know those words, they are from a song Davy sung for me... but they make me feel..."</p>' + "<p>Her words trail off as the spell works itself into her mind and body again. She lies down on the inflatable, deep in thought, a soft sigh coming from her.</p>" + "<p>You are a little torn here, she is troubled by her time under Davy's influence and now you are doing the same to her. You " +
				(perYou.checkFlag(26) ? "could" : "can") + " make her your obedient little slave as Davy did, she is very cute and will be a delightful slave.");
			if (perYou.checkFlag(26)) md.write(" You could also be gentler and convince her she has fallen in love with you dramatically, she will not be as obedient, but still yours and protected from Davy. It depends on what you want.");
			md.write("</p>");
			startQuestions();
			addLinkToPlaceO(md, "enslave Ellie", 423, "type=ellie24", "", "", "charmPerson('Ellie',4);");
			if (perYou.checkFlag(26)) addLinkToPlaceO(md,
				"charm Ellie", 423, "type=ellie24", "", "", "charmPerson('Ellie',2);")
		} else if (stype === "ellie24")
			if (clv == 4) {
				md.write('<p>Ellie stands in the shallow part of the pool, and as she does you firmly tell her "Forget about the song, it does not matter to you, all you need to do it listen to me and do what I ask you"</p>' + "<p>She turns to look at you surprised, her hands covering herself and she replies,</p>" + '<p>"What do you mean, what <b>are</b> you asking me to do?"</p>' + '<p>You reply firmly "It does not matter what, you just want to do anything I ask of you, don\'t you?"</p>' +
					"<p>Your words almost pound into her and for a moment her ever present smile fades, she then hesitantly says,</p>" + '<p>"I do...not...think I barely know you...you are ' + perYou.getPersonName() + ' right..."</p>');
				startQuestions();
				addLinkToPlaceC(md, "ask her to remove the swimsuit", 423, "type=ellie25")
			} else {
				md.write('<p>Ellie looks thoughtful and slips off of the float to stand in the shallow part of the pool. You speak to her and she turns to face you, her hands covering herself as best she can. "Ellie, you should not worry about that song, but I can see how you are looking at me. Do you actually like me?"</p>' +
					'<p>Ellie looks at you curiously, "Well... I am feeling a bit... odd...');
				if (perYou.isBornMale()) md.write("but yes you are handsome");
				else md.write("and yes, you are beautiful... but I am not really into girls");
				md.write('..."</p><p>She looks at you more closely, and as the idea of you as a potential lover sinks into her mind, you reinforce it,</p>' + '<p>"You are a very cute girl and I did not come here expecting you to <b>fall in love with me</b>, I mean love at first sight is something for romance novels"</p>' +
					'<p>She hesitates as your words sink in more, pulling in her lower lip before she replies, "Love at first sight..." and you see a blush pass across her face, or maybe a flush of arousal.</p>');
				if (!perYou.isBornMale()) md.write("<p>\u201cN... no.\u201d She suddenly shakes her head. \u201cI may have two mothers, and I really believe that you should love whoever you want... but I'm only into guys.\"</p>");
				startQuestions();
				addLinkToPlaceO(md, "increase her desire", 423, "type=ellie25")
			}
		else if (stype === "ellie25")
			if (clv ==
				4) {
				md.write("<p>Ellie looks surprised and starts to get out of the pool, and with her remaining willpower, she folds her arms in a desperate attempt to keep them from moving.</p>" + "<p>\"No, I don't think so, I cannot remove my swimsuit, I barely know you " + perYou.getPersonName() + '"</p>' + "<p>You focus on the magical link between you and Ellie, forcing your will on her and reply simply,</p>" + '<p>"You do not have to worry about these things, or think about anything other than obeying me, and you should not call me ' +
					perYou.getPersonName() + '"</p>' + '<p>She looks confused, the spell slowly taking its toll, "Why...what should I call you?"</p>');
				startQuestions();
				addLinkToPlaceC(md, 'You tell her "' + perYou.getMaster() + '"', 423, "type=ellie26")
			} else {
				md.write("<p>You focus on her and the magical link between you and Ellie, willing her to desire you more and more.</p><p>");
				if (perYou.isBornMale()) md.write("\u201cI feel like there is a connection between you and me, is there?\u201d");
				else md.write("\u201cBut if we are supposed to love whoever we want, can we really afford to not take a chance to find love because of our gender?\u201d");
				md.write("<p>She contemplates your words briefly, then looks at you smiling,</p>" + '<p>"It is so strange how attractive you are, do you like me too?"</p>' + "<p>She starts to tease you, as she starts to get out of the pool leaning low to show you her cleavage and down into her swimsuit. She looks back you expectantly.</p>" + "<p>There is only one real answer to her question, even if you do not really mean it, yet...</p>");
				startQuestions();
				addLinkToPlaceC(md, "Yes, and I love you", 423, "type=ellie26")
			}
		else if (stype ===
			"ellie26")
			if (clv == 4) {
				md.write('<p>She looks troubled, "' + perYou.getMaster() + " that's not right, that would mean I was some sort of servant...\"</p>" + "<p>You reply firmly,</p>" + '<p>"No, that means you are my slave, who will obey me, doing anything I ask at anytime.<br>And now, my slave, you will strip!"</p>' + "<p>She struggles, but the spell easily compels her to quickly strip out off her swimsuit, and mustering her last tiny measure of control, she almost whispers,</p>" + "<p>\"I wont't...I can't do some things, I know there was something I had to do, but I can't hurt...\"</p>" +
					"<p>You see how troubled she is about some orders Davy had given her before, and how there are some limits of what she will do, no matter what you say. You relent a little,</p>" + '<p>"I will never order you to harm another, that is not what I want from you as my slave. Obey me and only think of what I desire and my pleasure, as the slave you are."</p>' + '<p>She looks at you nervously, but your assurance seems to put her somewhat at ease as the spell washes away the last traces of doubt and resistance, a blissful smile forming on her lips "Yes, ' +
					perYou.getMaster() + '"</p>');
				startQuestions();
				addLinkToPlaceC(md, '"Prove your obedience"', 423, "type=ellie27")
			} else {
				md.write('<p>Ellie looks radiantly happy and replies "I love you too!"</p>');
				if (!perYou.isBornMale()) md.write('<p>Ellie looks a little troubled, "Still you are a girl, I am not a lesbian or even bi-sexual, but I do love you...". You reassure her the love is love and that labels like "lesbian" do not matter. While she is still a little troubled, she puts the issue to the side.</p>');
				md.write('<p>Ellie looks radiantly happy to hear this and  quickly replies "I love you too!"</p>');
				if (!perYou.isBornMale()) md.write("<p>The spell seems to have fully claimed her, and yet, some resistance still lingers. \u201cI am not sure why, I <b>am</b> not a lesbian... I'm not even Bisexual...</p>" + "<p>You tell her that labels like \u201cStraight\u201d and \u201cLesbian do not matter because love is love, and while she still seems a little troubled, she lets the issue rest for now.</p>");
				md.write("<p>Ellie smiles then and starts to remove her swimsuit, turned to the side to possibly preserve a little modesty, but mainly to show off her figure. She looks at you, the arousal from the magic spell still working itself on her.</p>" +
					'<p>"Do you want more, my love?"</p>');
				startQuestions();
				addLinkToPlaceC(md, '"Yes, I do"', 423, "type=ellie27")
			}
		else if (stype === "ellie27")
			if (clv == 4) {
				md.write("<p>Ellie drops her swimsuit and sits there before you, naked and beautiful. She smiles,</p>" + "<p>" + perYou.getMaster() + ', what can your slave do to prove her devotion?"</p>' + "<p>You are a little surprised, and pleased, at the way she addresses you. She seems to have completely adopted a slave attitude, even referring to herself as a slave and not by name. You can see she is yours now, to do anything you like, as long as you do not cross a certain line and ever ask her to harm another person.</p>" +
					"<p>You look at your smiling slave and decide how to proceed,</p>");
				startQuestions();
				addLinkToPlaceO(md, "dominate her more", 423, "type=pooloral")
			} else {
				md.write("<p>Playfully Ellie throws away her swimsuit and sits there before you, completely naked in all her beauty, and as you admire her body, her lips form a wide smile.</p>" + "<p>She leans in and kisses you, but while you can feel the force of the spell still coursing though her and reinforcing her feelings, the actual kiss is brief and still hesitant.</p><p>");
				if (perYou.isBornMale()) md.write("\u201cI can't believe how quick I fell for you, my love...\u201d");
				else md.write("\u201cI'm actually in love with another woman...\u201d");
				md.write("</p><p>She whispers as she breaks the kiss and looks deeply into your eyes, desire and love filling her expression,</p>" + "<p>Shall we...here?</p>");
				startQuestions();
				addLinkToPlaceC(md, '"Yes, I need you now"', 423, "type=pooloral")
			}
	}
	addLinkToPlace(md, "leave the pool", 420);
	WritePlaceFooter(md)
}

function ShowPlace424(stype) {
	var perCarol = findPerson("Carol");
	var md = WritePlaceHeader();
	perCarol.showPerson("carol8.jpg");
	addPlaceTitle(md, "Carol in her Bedroom");
	md.write('<p>"I always have time for you, my naughty little ' + perYou.getWitch(true, true) + '." She says with an inviting smile and motions you to follow her, most of her clothes falling to the floor one way or another as she leads you into the large bedroom.</p>' + "<p>You are still stunned by the size and splendor of both the room itself and the bed at its center, as well as Carols dildo and sextoy collection.</p>" +
		"<p>Your main attention, however, is still focused on your beautiful plaything as she crawls onto the bed on all fours, facing you with a teasing smile and hungry look in her eyes.</p>" + '<p>"What naughtiness will your spell compel me to do this time, I wonder?" She asks in a playful purr and her exotic accent seems even more pronounced then usual.</p>');
	startQuestions();
	addLinkToPlace(md, "return to the living room", 420);
	addLinkToPlace(md, "leave the house", 5);
	WritePlaceFooter(md)
}

function ShowPlace430(stype) {
	var md = WritePlaceHeader();
	var perKristin = findPerson("Kristin");
	var myNameK = perKristin.getYourNameFor();
	var herNameK = perKristin.getPersonName();
	var perEllie = findPerson("Ellie");
	var bEllieCharmed = perEllie.isCharmedBy("You");
	if (perEllie.place == 420 && !bEllieCharmed) perEllie.place = 430;
	if (perEllie.place == 430 && bEllieCharmed) perEllie.place = 422;
	if (perKristin.whereNow() !== 430) {
		if (!perKristin.checkFlag(11) && whereItem(5) === 0) {
			PlaceI(5, 430);
			perKristin.setFlag(11)
		}
		addPlaceTitle(md, herNameK +
			"'s Home", "livingroom3.jpg");
		md.write("<p>Kristin is not at home now and her elegant home is empty.</p>");
		if (whereItem(5) == 430) md.write("<p>You see an ornament on a shelf, it is a familiar looking stone.</p>");
		startQuestions()
	} else if (stype === "") {
		perKristin.showPerson("kristin10a.jpg");
		addPlaceTitle(md, herNameK + "'s Home");
		md.write("<p>Kristin is eager to see you and has dressed herself in an attractive set of pink lingerie for you.</p>");
		md.write('<p>"Hello ' + myNameK + " have you come to check my interest rates or to discuss ");
		if (perYou.isMaleSex()) md.write("a matter of inflation and to make a deposit");
		else md.write("liquidating assets");
		md.write('?"</p>');
		if (perEllie.place == 430) md.write('<p>She also mentions "Ellie from next-door is visiting, she used to visit a lot when she was arguing with her mother or upset, but not a lot recently. She looked confused and upset and she is now in the spare room."</p>');
		startQuestions()
	} else if (stype === "neighbours") {
		perKristin.setFlag(2);
		perKristin.showPerson("kristin10b.jpg");
		addPlaceTitle(md,
			herNameK + "'s Home");
		md.write("<p>Kristin seems a little uncomfortable as she answers,</p>");
		md.write('<p>"' + myNameK + " they are good friends of mine, I have known them since Ellie was quite young, I sometime baby-sat for her as a child.<br/><br/>Carol's wife Sally is a very successful business woman with a large international company. She travels on business a lot and has a habit of taking Carol for granted.<br/><br/>Carol is a <b>very</b> good friend of mine");
		if (perYou.isBornMale()) md.write(", sorry " +
			myNameK + " she has no interest in men at all");
		else md.write("I'm sure she will like you " + myNameK);
		md.write(".<br/><br/>She is the birth mother of Ellie, I understand she used a sperm bank or some such to conceive, against Sally's preferences.\"</p>");
		md.write("<p>You notice her emphasis about being <b>very</b> good friends with Carol, and you ask her to tell you more. She hesitates,</p>");
		startQuestions();
		addLinkToPlaceC(md, "Order her to tell you", 430, "type=carolorder");
		addLinkToPlaceC(md, "Ask her again",
			430, "type=carolask")
	} else if (stype === "carolorder" || stype === "carolask") {
		if (stype == "carolorder") perKristin.setFlag(4);
		perKristin.setFlag(3);
		perKristin.showPerson("kristin10b.jpg");
		addPlaceTitle(md, herNameK + "'s Home");
		if (stype == "carolorder") md.write("<p>You order your slave to tell you, and Kristin realises your authority over her,</p>");
		else md.write("<p>You ask her again to please tell you,</p>");
		md.write('<p>"' + myNameK + ", Carol is a trophy wife and unhappy with her marriage. We have been lovers for over a year, she knows I take other lovers, men and women. Ellie knows of our relationship, she is not happy but accepts it and has kept our secret.</p>");
		startQuestions()
	} else if (stype === "neighboursagain") {
		perKristin.setFlag(4);
		perKristin.showPerson("kristin10b.jpg");
		addPlaceTitle(md, herNameK + "'s Home");
		md.write("<p>Again you talk about her neighbours, the Bartels and this time she is more open,</p>" + '<p>"' + myNameK + " they are good friends of mine, I have known them since Ellie was quite young, I sometime baby-sat for her as a child.<br/><br/>Carol's wife Sally is a very successful business woman with a large international company. She travels on business a lot and has a habit of taking Carol for granted.<br/><br/>Carol is a <b>very</b> good friend of mine.</p>" +
			'<p>"' + myNameK + ", Carol is a trophy wife and unhappy with her marriage. We have been lovers for over a year, she knows I take other lovers, men and women. Ellie knows of our relationship, she is not happy but accepts it and has kept our secret.</p>");
		startQuestions()
	} else if (stype === "carolorder" || stype === "carolask") {
		if (stype == "carolorder") perKristin.setFlag(4);
		perKristin.setFlag(3);
		perKristin.showPerson("kristin10b.jpg");
		addPlaceTitle(md, herNameK + "'s Home");
		if (stype == "carolorder") md.write("<p>You order your slave to tell you, and Kristin realises your authority over her,</p>");
		else md.write("<p>You ask her again to please tell you,</p>");
		md.write('<p>"' + myNameK + ", Carol is a trophy wife and unhappy with her marriage. We have been lovers for over a year, she knows I take other lovers, men and women. Ellie knows of our relationship, she is not happy but accepts it and has kept our secret.</p>");
		startQuestions()
	} else if (stype === "bj") {
		if (perYou.isMaleSex()) {
			if (isExplicit()) perKristin.showPersonRandomX("kristin12b", 2, "50vw,height:max");
			else perKristin.showPerson("kristin12b.jpg",
				"40vw");
			addPlaceTitle(md, "An Oral Deposit");
			md.write("<p>You tell " + herNameK + ' to use her mouth to pleasure you. She skillfully takes your length into her mouth  and you do not take long to release into her mouth. She swallows and lies back and says, "Thank you ' + myNameK + '".</p>')
		} else {
			if (isExplicit()) perKristin.showPersonRandomX("kristin12g", 2, "40vw");
			else perKristin.showPerson("kristin12g.jpg", "40vw");
			addPlaceTitle(md, "A Bank Servicing");
			md.write("<p>You tell " + herNameK + ' to use her tongue to pleasure you and while she is not very experienced she does have some skill she makes you reach the peak of ecstasy quickly. After she lies back and says, "Thank you!".</p>')
		}
		startQuestions()
	} else if (stype ===
		"fuck") {
		if (perYou.isMaleSex()) {
			if (isExplicit()) perKristin.showPersonRandomX("kristin11b", 2, "50vw,height:max,50vw");
			else perKristin.showPerson("kristin11b.jpg", "40vw");
			addPlaceTitle(md, "Making a Deposit");
			md.write("<p>You readily agree to take her and you sink you manhood into her delightful pussy, ramming into her over and over. You feel her shudder in her release and that is the final straw and you pour your passion into her depths.</p>")
		} else {
			perKristin.showPersonRorX("kristin11g.jpg", "50vw");
			addPlaceTitle(md,
				"An Asset Meeting");
			md.write("<p>You put on your strap-on and tell Kristin to mount herself on it and ride you cowgirl style.</p>")
		}
		startQuestions()
	}
	if (perKristin.place === 430) {
		if (stype === "") {
			if (perYou.isMaleSex()) {
				addLinkToPlaceO(md, "make a deposit", 430, "type=fuck");
				addLinkToPlaceO(md, "orally negotiate a deposit", 430, "type=bj")
			} else {
				addLinkToPlaceO(md, "have her service your assets", 430, "type=bj");
				if (perYourBody.FindItem(45) > 0) addLinkToPlaceO(md, "ream her assets", 430, "type=fuck")
			}
			if ((checkPersonFlag("Carol",
					2) || perEllie.checkFlag(4) && !isCharmedBy("Carol")) && !perKristin.checkFlag(2)) addLinkToPlaceC(md, "ask about her neighbours", 430, "type=neighbours");
			if (perKristin.checkFlag(6) && !this.checkFlag(4)) addLinkToPlaceC(md, "ask again about her neighbours", 430, "type=neighboursagain");
			if (perKristin.checkFlag(9) && !perKristin.checkFlag(10)) addQuestionC(md, "ask Kristin to re-open the Bank", "Kristin", 2801);
			addSleepLink(md, "go to bed for the night with Kristin", "Going to Bed with Kristin", '<p style="position:absolute;left:2%;top:2em;cursor:pointer;font-size:1.1em;width:66%">It is getting late and Kristin suggests you may wish to spend the night to further assess her portfolio. When you agree and join her in her bedroom she demonstrates to you her preferred sleeping atire, nothing at all.',
				"kristin13.jpg")
		}
		if (perKristin.checkFlag(3) && !perKristin.checkFlag(4)) addLinkToPlaceC(md, '"Can you get me into her house?"', 420, "type=kristinvisit")
	}
	if (perEllie.place == 430 && stype === "") addLinkToPlace(md, "visit Ellie", 430, "type=visitellie");
	addLinkToPlace(md, "exit the house", 5);
	WritePlaceFooter(md)
}

function ShowPlace433() {
	showGeneralPlace("Aunt's House", "livingroom5.jpg", "The home of Aunt Brandi and Kylie", "return to Cherise Rd", 37)
}

function ShowPlace435(stype) {
	var md = WritePlaceHeader();
	addPlaceTitle(md, "Kings's Gym", "gyminside.jpg");
	md.write("<p>A clean and modern gym with a wide range of equipment for your fitness needs, at least that is what their adverts say! Your friend Amy works here part-time.</p>");
	startQuestions();
	addLinkToPlace(md, "leave the gym", 37);
	WritePlaceFooter(md)
}

function ShowPlace436() {
	var perAdele = findPerson("AdeleRoss");
	var perCatherine = findPerson("Catherine");
	var bAdeleHere = perAdele.isHere();
	if (perCatherine.isHere() && !bAdeleHere && !perAdele.checkFlag(6)) return gotoPlaceDelayed(37, "", '<img src="UI/knock.png" style="float:left;width:10%"><br>The house is securely locked, there might be someone home but there is no answer to the door or to their phones.');
	var md = WritePlaceHeader();
	addPlaceTitle(md, "Ross Home Living Room", "livingroom5.jpg");
	md.write("<p>Amy and Catherine live in a lovely old house. You are now in the living room, it is very clean and stylish.</p>");
	startQuestions();
	if (perAdele.checkFlag(6)) {
		addLinkToPlaceC(md, "visit Amy's room", 437);
		addLinkToPlaceC(md, "visit Catherine's room", 438)
	}
	if (perAdele.getCharmedLevel() == 4) addLinkToPlaceC(md, "visit Adele's room", 439);
	addLinkToPlace(md, "leave the house", 37);
	if (perAdele.checkFlag(6)) {
		AddPeopleColumnMed(md);
		perCatherine.showPerson(perCatherine.isCharmedBy() ? "catherine-watching1c.jpg" : "catherine-watching1.jpg")
	}
	WritePlaceFooter(md, "", bAdeleHere)
}

function ShowPlace437(stype) {
	var md;
	md = WritePlaceHeader();
	addPlaceTitle(md, "Amy's Bedroom", "bedroom9.jpg");
	md.write("<p>Amy's bedroom is furnished in an old somewhat gothic style. Amy has always said she rather liked it that way.</p>");
	startQuestions();
	addLinkToPlace(md, "leave the bedroom", 436);
	addLinkToPlace(md, "leave the house", 37);
	WritePlaceFooter(md)
}

function ShowPlace438(stype) {
	var md = WritePlaceHeader();
	var perCatherine = findPerson("Catherine");
	perCatherine.showPerson((perCatherine.isCharmedBy() ? "catherine-bedroomc" : "catherine-bedroom") + ".jpg");
	addPlaceTitle(md, "Catherine's Bedroom");
	md.write("<p>Catherine strips quickly down to her cute pink underwear and kneels on her bed,</p>" + '<p>"' + perYou.getPersonName() + " I hope you are not just here for a conversation, you know I am ready for <i>anything</i> you want!\u201d</p>");
	startQuestions();
	addLinkToPlace(md,
		"leave the bedroom", 436);
	addLinkToPlace(md, "leave the house", 37);
	WritePlaceFooter(md)
}

function ShowPlace439(stype) {
	var md;
	var perAdele = findPerson("AdeleRoss");
	if (perAdele.place != 436) {
		md = WritePlaceHeader();
		addPlaceTitle(md, "Adele's Bedroom", "bedroom6.jpg");
		md.write("<p>Adele's bedroom, or at least the room she is using now, is neat and tidy. On her bedside table is a book of the occult, a work describing practises and rituals. Nothing on par with the Book!</p>");
		startQuestions();
		addLinkToPlace(md, "leave the bedroom", 436);
		addLinkToPlace(md, "leave the house", 37);
		WritePlaceFooter(md);
		return
	}
	if (stype === "") {
		md = WritePlaceHeader();
		perAdele.showPerson("Setting/adele-bedroom.jpg");
		addPlaceTitle(md, "Adele's Bedroom");
		md.write("<p>Adele kneels on her bed,</p>" + '<p>"' + perYou.getMaster() + ", how can I serve you?\u201d</p>")
	} else if (stype == "bj") {
		if (isBritish())
			if (!isExplicit()) {
				md = WritePlaceHeader();
				perAdele.showPerson("UK/adele-bedroom-sex-fuckg.jpg")
			} else if (perYou.isMaleSex()) {
			md = WritePlaceHeader();
			perAdele.showPersonX("UK/adele-bedroom-sex-bjb.jpg")
		} else {
			md = WritePlaceHeader(false, "td-left-med");
			perAdele.showPersonX("UK/adele-bedroom-sex-bjg.jpg")
		} else if (!perYou.isMaleSex() || !isExplicit()) {
			md = WritePlaceHeader();
			perAdele.showPerson("US/adele-bedroom-sex-bj.jpg")
		} else {
			md = WritePlaceHeader();
			perAdele.showPersonX("US/adele-bedroom-sex-bjb.jpg")
		}
		if (perYou.isMaleSex()) {
			addPlaceTitle(md, "Adele");
			md.write("<p>Adele gives you a blowjob.</p>")
		} else {
			addPlaceTitle(md, "Adele");
			md.write("<p>Adele licks you.</p>")
		}
	} else if (stype == "fuck") {
		if (isBritish())
			if (!isExplicit())
				if (perYou.isMaleSex()) {
					md = WritePlaceHeader(false,
						"td-left-med");
					perAdele.showPerson("UK/adele-bedroom-sex-fuckb.jpg")
				} else {
					md = WritePlaceHeader();
					perAdele.showPerson("UK/adele-bedroom-sex-fuckg.jpg")
				}
		else if (perYou.isMaleSex()) {
			md = WritePlaceHeader(false, "td-left-med");
			perAdele.showPersonX("UK/adele-bedroom-sex-fuckb.jpg")
		} else {
			md = WritePlaceHeader(false, "td-left-med");
			perAdele.showPersonX("UK/adele-bedroom-sex-fuckg.jpg")
		} else if (!perYou.isMaleSex() || !isExplicit()) {
			md = WritePlaceHeader();
			perAdele.showPerson("US/adele-bedroom-sex-fuck.jpg")
		} else {
			md =
				WritePlaceHeader(false, "td-left-med");
			perAdele.showPersonX("US/adele-bedroom-sex-fuckb.jpg")
		}
		if (perYou.isMaleSex()) {
			addPlaceTitle(md, "Adele");
			md.write("<p>You fuck Adele.</p>")
		} else {
			addPlaceTitle(md, "Adele");
			md.write("<p>Adele and you have a 69</p>")
		}
	}
	startQuestions();
	if (stype === "") {
		if (perYou.isMaleSex()) {
			addLinkToPlace(md, "take her", 439, "type=fuck");
			addLinkToPlace(md, "take her mouth", 439, "type=bj")
		} else {
			addLinkToPlace(md, "ask her to lick you", 439, "type=bj");
			addLinkToPlace(md, "lick each other", 439,
				"type=fuck")
		}
		addSleepLink(md, "sleep with Adele", "Sleeping with Adele", '<p style="position:absolute;left:2%;top:85%;cursor:pointer;font-size:1.1em;width:66%">You tell Adele that you will spend the night with her.', "Setting/adele-sleep.jpg", true, 436)
	}
	addLinkToPlace(md, "leave the bedroom", 436);
	addLinkToPlace(md, "leave the house", 37);
	WritePlaceFooter(md)
}

function ShowPlace441() {
	var md = WritePlaceHeader();
	addPlaceTitle(md, "Hospital Morgue", "hospitalmorgue.jpg");
	md.write("<p>The morgue, used for all deaths in Glenvale. This is one creepy place that you cannot wait to leave.</p>");
	if (wherePerson("Sarah") > 0 && isMurderPath())
		if (perGates.other == 600) md.write("<p>Nervously you notice one of the drawers is labeled '" + perGates.getPersonName() + "'.</p>");
		else md.write("<p>With some guilt you notice one of the drawers is labeled '" + perGates.getPersonName() + "'.</p>");
	if (getPersonOther("Anita") == 901) md.write("<p>You have mixed feelings when you see the drawer labeled 'Anita (unknown last name)'.</p>");
	if (getPersonOther("Diane") == 900 && wherePerson("Diane") == 441) md.write("<p>You are troubled to see the drawer labeled 'Diane White'.</p>");
	if (getPersonOther("OfficerSmith") == 900 && wherePerson("OfficerSmith") == 441) md.write("<p>You are troubled to see the drawer labeled '" + getOfficer() + " Becky Smith'.</p>");
	startQuestions();
	addLinkToPlace(md, "exit the morgue", 442);
	WritePlaceFooter(md)
}

function ShowPlace442() {
	var md = WritePlaceHeader();
	setPlaceFlag("Hospital", 3);
	addPlaceTitle(md, "Hospital Basement", "hospitalbasement.jpg");
	md.write("<p>The basement of the hospital, it seems almost deserted, there is no-one down here. There is a chill in the air, the air-conditioning must be set too low down here.</p>" + "<p>There is a set of doors at one end of the corridor with a sign 'Area off limits until renovation is complete' with a logo of mayor's office. Dimly you can see through the glass in the door, the area looks very old-fashioned, more like the basement of some large house. It must be from the early days of Glenvale when the hospital was actually a large mansion.");
	if (checkPlaceFlag("Hospital", 4)) md.write(" You have a key to the door that the Mayor gave you.</p>");
	else md.write("</p>");
	startQuestions();
	addLinkToPlace(md, "visit the morgue", 441);
	if (checkPlaceFlag("Hospital", 4)) addLinkToPlace(md, "visit the old basement", 443);
	AddRightColumn(md);
	addPlaceImage(md, "elevator.jpg");
	md.write('<p style="text-align:center">Ride the ' + (isBritish() ? "lift" : "elevator") + '<br><img src="Images/elevatorbuttons.jpg" style="margin: 5px 5px;width:100%" alt="Elevator" title="The elevator"></p>');
	addLinkToPlace(md, isBritish() ? "First Floor" : "Second Floor", 444, "", "", "", "", "hailblock");
	addLinkToPlace(md, isBritish() ? "Ground Floor" : "First Floor", 214, "", "", "", "", "hailblock hailup");
	WritePlaceFooter(md)
}

function ShowPlace443(stype) {
	var md = WritePlaceHeader();
	addPlaceTitle(md, "Old Basement", "hospitaloldbasement.jpg");
	md.write("<p>The old basement, parts are abandoned, and other parts look to have been a kitchen at one time, but long abandoned. It is very cold and damp here, and a slight mist forms in a couple of places, notably coming down an old chimney and in the corner of the kitchen area.</p>" + "<p>The doors back to the main basement are locked from this side as well.</p>");
	startQuestions(checkPlaceFlag("Hospital",
		4) ? undefined : "There is no physical way out of here...");
	if (checkPlaceFlag("Hospital", 4)) addLinkToPlace(md, "return to the main part of the basement", 442);
	WritePlaceFooter(md)
}

function ShowPlace444() {
	var md = WritePlaceHeader();
	var perNS = findPerson("NurseSandra");
	var perMegan = findPerson("NurseMegan");
	var perGhost = findPerson("Ghost");
	var lv = isBritish() ? "First Floor" : "Second Floor";
	addPlaceTitle(md, "Hospital " + lv, "hospitalcorridor1.jpg");
	md.write("<p>" + lv + " of the hospital, it is divided between administrative areas and operating theatres.</p>" + "<p>You notice a whiteboard chart on one wall with a simple roster of nurses marked and current locations.</p>");
	if (perGhost.checkFlag(2) &&
		!perNS.checkFlag(1) || perMegan.checkFlag(1) && !perMegan.checkFlag(2) || wherePerson("Desiree") == 444 && checkPersonFlag("Desiree", 3)) {
		startQuestions();
		if (perGhost.checkFlag(2) && !perNS.checkFlag(1)) addQuestionR(md, "where does that red-haired nurse work?", "On the whiteboard chart you notice a Nurse Sandra is noted as working in Ward 1 East, it must be the red-headed woman who spoke to you about the ghost, or at least denied the existence of the ghost.", "", "setPersonFlag(\\'NurseSandra\\', 1);");
		if (perMegan.checkFlag(1) &&
			!perMegan.checkFlag(2)) addQuestionR(md, "what is the name of the nurse in the ICU?", "On the whiteboard chart you check and currently the lead nurse recorded as working there is named Megan.", "", "setPersonFlag(\\'NurseMegan\\', 2);")
	} else startQuestions("There is nowhere really to go here...");
	AddRightColumn(md);
	addPlaceImage(md, "elevator.jpg");
	md.write('<p style="text-align:center">Ride the ' + (isBritish() ? "lift" : "elevator") + '<br><img src="Images/elevatorbuttons.jpg" style="margin: 5px 5px;width:100%" alt="Elevator" title="The elevator"></p>');
	addLinkToPlace(md, isBritish() ? "Ground Floor" : "First Floor", 214, "", "", "", "", "hailblock");
	addLinkToPlace(md, "Basement", 442, "", "", "", "", "hailblock hailup");
	WritePlaceFooter(md)
}

function ShowPlace450(stype) {
	var md = WritePlaceHeader();
	var perLeanne = findPerson("Leanne");
	var nInf = perLeanne.getInfluenced();
	if (!perLeanne.isHere()) {
		if (nInf > 4 && sType === "" && !perLeanne.checkFlag(21) && perLeanne.place === 9999) return gotoPlaceDelayed(38, "", '<img src="UI/knock.png" style="float:left;width:10%;margin-right:5px">No one answers your knock and you hear no one moving, but as you try to reach Leanne on her Mobile phone, you hear it ringing inside the house.');
		addPlaceTitle(md, "Leannes Living Room",
			"livingroom6.jpg");
		md.write("<p>Leanne's very clean and stylish living room.</p>");
		startQuestions();
		addLinkToPlace(md, "leave the house", 38);
		WritePlaceFooter(md);
		return
	}
	var bThrall = perLeanne.isCharmedBy("Demon");
	var bLost = isDemonGone();
	if (bThrall) {
		if (!perLeanne.checkFlag(13)) {
			perLeanne.setFlag(13);
			perLeanne.showPerson("leanne13t.jpg");
			addPlaceTitle(md, "The Thrall in Leanne's Living Room");
			md.write("<p>Uncertain what you will find you push Leanne's front door open and call out her name, except you know she is not here, her body might be as controlled by the thrall, but not Leanne herself.");
			if (bLost) md.write(" You also know that Leanne will never be here again, she is lost forever.");
			md.write("</p><p>You cautiously enter the living room and your suspicion is confirmed, the thrall is standing there, dressed in some kind of red latex dress. She looks at you and unzips the front of her dress as she walks towards you,</p>");
			if (bLost) md.write('<p>"This thrall is here as you commanded, and this body shall be the reward promised"</p>' + '<p>You reply, "Well, that is something you have offered before, what else can you offer? I saw you use a power I do not have in the Mother Superior\'s room, can you teach me this, or something similar?"</p>' +
				"<p>She looks at you almost sadly, \"This thrall does not know how it does those abilities, it can just do them. The thrall's Mistress gave it small powers to seduce and tempt but little a " + perYou.getWitch() + ' like you could not.", she pauses and continues<br>' + '<p>What is a slave without an owner, a thrall with no Mistress? They are nothing, this body is all that can be offered or the abilities of this thrall to seduce"</p>' + '<p>You reply forcefully, "Then that is it, I will give you a purpose, you will reward me with your eternal service, your slavery to me as your ' +
				perYou.getMaster() + '"</p>' + "<p>You say this as a way to control her, you have the slight hope that someday you have be able to find the demon and free Leanne, but you also know this is a false hope, she is <i>almost</i> certainly lost. At least you can prevent the thrall in her body doing harm or at least spoiling Leanne's good name. The thrall looks at you,</p>" + '<p>"The contract is agreed, this thrall, is now <i>your</i> thrall to use in any way you desire."</p>');
			else {
				md.write('<p>"This thrall should have realised you would know this place, one place strongly in this bodies memories. Know this, you will not trick this thrall again, while this thrall\'s Mistress is gone, her orders remain."</p>' +
					'<p>You reply, "Your orders to try to corrupt the church have failed", though you are not sure that is really true considering the Mother Superior and Sister Desiree. You continue, "You have no Mistress and no purpose any more!"</p>' + '<p>She replies a little sadly, "You speak the truth, this thrall has no purpose and no Mistress. This thrall will stay here, another will arrive to claim it from the <i>gate</i>."</p>' + "<p>Well you think this is best as it will keep her from harming others, until you can work out how to free Leanne. You just need to get the thrall back to the Hidden Room some other way, teleport will not work any more.");
				if (perYourBody.FindItem(48) === 0 && perYourBody.FindItem(48) != -53) md.write(" Then again you still do not have the relic...");
				md.write("</p>")
			}
		} else {
			perLeanne.showPerson("leanne8t.jpg");
			addPlaceTitle(md, "The Thrall in Leanne's Living Room");
			if (bLost) md.write("<p>Your thrall is here ready to do anything you command.</p>");
			else {
				md.write("<p>The thrall is still here, you still have to work out how to deal with her");
				if (perYourBody.FindItem(48) === 0 && perYourBody.FindItem(48) != -53) md.write(", and you still do not have the relic..");
				md.write(".</p>")
			}
		}
		startQuestions();
		addLinkToPlace(md, "leave the house", 38);
		WritePlaceFooter(md);
		return
	}
	var perMS = findPerson("Daria");
	var nFreed = nTime - perMS.extra[0];
	var clv = perLeanne.getCharmedLevel();
	var bRecovered = nTime - perMS.extra[0] > 575;
	if (nInf > 4 && sType === "" && clv === 0) return gotoPlaceDelayed(38, "", '<img src="UI/knock.png" style="float:left;width:10%;margin-right:5px">You hear a rustle inside, but the door remains closed, it seems like Leanne doesn&rsquo;t want to see you right now.');
	if (clv ==
		1) perLeanne.showPersonDN("leanne16.jpg");
	else if (clv == 4) perLeanne.showPersonDN("leanne17.jpg");
	else perLeanne.showPerson(perLeanne.hadSexYourself() ? isDay() ? "leanne8s.jpg" : "leanne8-night.jpg" : "leanne9.jpg");
	addPlaceTitle(md, "Leanne at Home");
	md.write("<p>Leanne has inherited a pleasant, modern home which she often laments is much to big for her to live in all alone by herself. She has openly contemplated selling it a few times, but in the end, she doesn't want to leave the memories behind and hopes that maybe one day it'll be filled with a family of her own.</p>");
	if (clv == 1) md.write("<p>Your lover greets you with a deep kiss right after you open the door and pulls you into the house.</p>" + "<p>\u201cI missed you, <Playername>.\u201d She says with a happy smile. \u201cHow have you been? Any sexy new slaves or girlfriends I should know about?\u201d</p>");
	else if (clv == 4) md.write("<p>Your slave had given you a spare key to her house, and when you let yourself in and she is already expecting you. \u201cWelcome home, " + perYou.getMaster() + ".\u201d She welcomes you with a soft smile, seductively lying on the sofa. \u201cWhat can your little slut do for you?\u201d</p>");
	else if (perLeanne.checkFlag(17)) md.write("<p>Leanne asks you calmly, but rather firmly to please leave if you are not willing to help or even talk to her about it.</p>" + "<p>She has been rather mad about what you did during her possession/She was under enough stress after what happened, to begin with, and your unwillingness to help her surely didn't give you any bonus points here.</p>");
	else if (perLeanne.checkFlag(16)) {
		if (nInf === 0) md.write("<p>\u201cHey " + perYou.getPersonName() + ", it's good to see you.\u201d Leanne greets you with a warm hug and invites you in. \u201cHow are you, and how are your magic-stuff-studies coming along?\u201d</p>");
		if (nInf < 5) md.write("<p>Leanne greets you warmly and invites you inside. She is still a bit guarded around you, but more calm and relaxed by now, asking you about your day and how your \u201cmagic-stuff-studies\u201d are moving along.</p>")
	} else if (perLeanne.hadSexYourself()) md.write("<p>Leanne is still dealing with the aftermath of her possession and often nervous, especially while you are around. She has taken a few days off from work to deal with the dreams, anxiousness and... other feelings she is not yet willing to discuss.</p>" +
		"<p>You did offer your help, but she is understandably still rather upset with you and flatly says that the best way for you to help is giving her some time and space to work things out herself.</p>" + "<p>You figured it might be for the best to give her that space. The residual effect from the glamour the thrall used has not fully worn off, and the longer you are around her, the more you remember what you did when it offered her body to you, and the more you wonder what it would be like to have her again.</p>");
	else md.write("<p>Leanne is happy to see you, but the time as Legions thrall clearly took a toll on her.</p>" + "<p>She gladly asks you inside when you visit, but usually avoids talking about anything regarding the demon and often asks you to leave early or excuses herself on short notice.</p>" + "<p>You know that she has taken a few days off of work to deal with the dreams, anxiety and other... feelings she is unwilling to discuss, and you occasionally check in on her, but give her the space she needs, and for good reason.</p>" +
		"<p>The residual effect of the thralls glamour has still not worn off, and the longer you are with her, the more your mind drifts off, and you find it harder to not see her as she was back then, naked, beautiful, and all too willing to be taken by you.</p>");
	startQuestions();
	switch (clv) {
		case 0:
			if (bRecovered && !perLeanne.checkFlag(16)) addLinkToPlace(md, "ask how she is holding up", 450, "type=askher");
			addQuestionRO(md, "pass some time chatting", "Leanne offers you a drink and the two of you spend some time talking about various topics, like the " +
				getShopStore() + ", school or recent developments. You tend to avoid bringing up anything regarding your harem, but she is occasionally a little curious about your sexual adventures, too.</p>" + "<p>In the end, an hour has quickly passed.", "Leanne", "WaitHere(12)");
			addSleepLink(md, "spend the night at Leannes house", "", "<p style='position:absolute;top:62%;left:2%;cursor:pointer;margin-top:-12px;font-size:x-large'><b>Sleeping At Leanne's Home</b></p>" + '<p style="position:absolute;left:2%;top:65%;cursor:pointer;font-size:1.1em;width:50%">' +
				"It had gotten late and Leanne offers you to spend the night in the guest room, and it's an offer you gladly take.<br><br>" + "You find the night mostly quiet, but it still takes you a while to fall asleep and you suddenly hear strange noises from inside the house.<br><br>" + "As you investigate, you catch a glimpse through Leanne's bedroom door and to your surprise, not only find it open but Leanne herself laying on top of her sheets and masturbating furiously with what seems to be no small amount of frustration about something.<br><br>" +
				"You contemplate going in, but decide that for now, it might be better to wait for her to approach you, if she even wants to, and quietly head back to bed before you are spotted.", "leanne-bed1.jpg");
			break;
		case 1:
			addLinkToPlace(md, "spend some sexy time with your lover", 450, "type=sexytime");
			addLinkToPlace(md, "let her take the lead", 450, "type=takelead");
			addSleepLink(md, "spend the night with Leanne", "", "<p style='position:absolute;top:62%;left:50%;cursor:pointer;margin-top:-12px;font-size:x-large'><b>Going to Bed with Leanne</b></p>" +
				'<p style="position:absolute;left:50%;top:65%;cursor:pointer;font-size:1.1em;width:45%">The hour grows late, and you gladly accept Leanne\'s offer to spend the night in her bed while she nestles her body against yours with a sweet smile.', "leanne-bed2.jpg");
			break;
		case 4:
			addLinkToPlace(md, "order her to turn around and present her pussy to you.", 450, "type=slavepussy");
			if (perYou.isMaleSex()) addLinkToPlace(md, "order her to get on her knees and service you with her mouth", 450, "type=oralservice");
			addSleepLink(md,
				"spend the night with Leanne", "", '<img src="Images/leanne-bed2.jpg" style="position:absolute;width:100%;bottom:0" alt="Leanne"></p>' + "<p style='position:absolute;top:62%;left:50%;cursor:pointer;margin-top:-12px;font-size:x-large'><b>Going to Bed with Leanne</b></p>" + '<p style="position:absolute;left:50%;top:65%;cursor:pointer;font-size:1.1em;width:45%">Leanne prepares the bed for the two of you and completely undresses before she slips in besides you, and the two of you spend the night in each others arms. ',
				"leanne-bed2.jpg");
			break
	}
	addLinkToPlace(md, "leave the house", 38);
	WritePlaceFooter(md)
}

function ShowPlace452() {
	if (whereItem(67) == 453 && isCharmedBy("Gabby")) moveItem(67);
	showGeneralPlace("Gabby's Home", "livingroom-gabby.jpg", "Gabby's living room looks like something out of a furniture catalog, clean and functional, but with very little personality.", "return to Amaranth Pl", 38)
}

function ShowPlace455() {
	var md = WritePlaceHeader();
	addPlaceTitle(md, "Celeste Road", "street5.jpg");
	md.write("<p>Celeste Road consists of several recently build apartment houses located in the towns outer ring and maintained by a local company, the area has a reputation to provide quality housing for singles, students and low income families.</p>");
	startQuestions();
	addLinkToPlace(md, "enter the apartments", 456);
	addLinkToPlace(md, "walk to the Museum", 238);
	WritePlaceFooter(md)
}

function ShowPlace456() {
	var md = WritePlaceHeader(false, "td-left-large");
	addPlaceTitle(md, "Apartment Building", "apartments1-foyer.jpg");
	setPlaceBreakIn("Apartments", false);
	setPlaceKnown("Apartments");
	md.write("<p>The foyer of the apartment building, surprisingly clean and well maintained.</p>");
	startQuestions();
	if (isPlaceKnown("CamrynsApartment")) addLinkToPlace(md, "visit Camryn's apartment", 457);
	if (isPlaceKnown("MiasApartment"))
		if (wherePerson("Mia") == 458) addLinkToPlace(md, "visit Mia's apartment", 458);
		else addLinkToPlace(md, "visit Mia's apartment", 456, "", "There is no answer at the bell, she is probably not home.");
	if (isPlaceKnown("AbbysApartment"))
		if (wherePerson("Abby") == 459) addLinkToPlace(md, "visit Abby's apartment", 459);
		else addLinkToPlace(md, "visit Abby's apartment", 456, "", "There is no answer at the bell, she is probably not home.");
	if (isPlaceKnown("AngelasApartment"))
		if (wherePerson("Angela") == 460) addLinkToPlace(md, "visit Angela's apartment", 460);
		else addLinkToPlace(md, "visit Angela's apartment",
			456, "", "There is no answer at the bell, she is probably not home.");
	addLinkToPlace(md, "leave the apartment building", 455);
	WritePlaceFooter(md)
}

function ShowPlace457() {
	showGeneralPlace("Camryn's Apartment", "attic2.jpg", "Camryn's apartment is very clean and sporting only the most necessary furniture and  few decorative elements, so she likely moved in very recently. It consists of a living-room with a small kitchen-corner directly connected to a smaller bedroom and a bathroom.", "return to the foyer", 456)
}

function ShowPlace458() {
	showGeneralPlace("Mia's Apartment", "apartment2.jpg", "Mia's apartment has a few of her personal items around but mostly it is a general furnished apartment.", "return to the foyer", 456)
}

function ShowPlace459() {
	showGeneralPlace("Abby's Apartment", "apartment3.jpg", "Abby's apartment, neat and stylish.", "return to the foyer", 456)
}

function ShowPlace460() {
	showGeneralPlace("Angela's Apartment", "apartment3.jpg", "Angela's apartment, neat and stylish.", "return to the foyer", 456)
}

function ShowPlace465() {
	var md = WritePlaceHeader();
	addPlaceTitle(md, "Haven Apartments", "apartments2.jpg");
	md.write("<p>The Haven apartments are a small set of exclusive and thus expensive, fully serviced apartments.</p>");
	startQuestions();
	addLinkToPlace(md, "enter the apartments", 466);
	addLinkToPlace(md, "return to the shopping center", 194);
	WritePlaceFooter(md)
}

function ShowPlace466() {
	var md = WritePlaceHeader(false, "td-left-large");
	addPlaceTitle(md, "Haven Apartments Foyer", "apartments2-foyer.jpg");
	setPlaceKnown("HavenApartments");
	md.write("<p>The foyer of the Haven Apartments, spotlessly clean and well maintained.</p>");
	startQuestions();
	addLinkToPlace(md, "leave the apartments", 465);
	WritePlaceFooter(md)
}

function ShowPlace467() {
	showGeneralPlace("Diane's Apartment", "livingroom1.jpg", "Dianes's apartment, very stylish and elegant.", "return to the foyer", 466)
}

function ShowPlace468() {
	showGeneralPlace("Beatrice's Apartment", "livingroom1.jpg", "Mayor Thomas's penthouse apartment, very stylish and elegant.", "return to the foyer", 466)
}

function ShowPlace470() {
	showGeneralPlace("Tanika Home", "livingroom7.jpg", "The Tanika home.", "return to the street", 43)
}

function ShowPlace480(stype) {
	var md = WritePlaceHeader();
	addPlaceTitle(md, "Access Road", "accessroad.jpg");
	md.write("<p>The access road has some construction machinery parked in places, looking almost abandoned. There is a fence to the south and beyond that Yoolaroo Drive. To the north is a clearing with a small portable building and some more machinery.</p>");
	startQuestions();
	addLinkToPlace(md, "walk to the construction site", 481);
	if (checkPlaceFlag("Park", 5)) addLinkToPlace(md, "return all the way back to Yoolaroo Drive",
		43);
	WritePlaceFooter(md)
}

function ShowPlace481(stype) {
	var md = WritePlaceHeader();
	addPlaceTitle(md, "Construction Site", "accessroad-site.jpg");
	md.write("<p>This is the main construction site, with a small portable building and some construction machinery. An access road for trucks and workers leads to the south.</p>");
	startQuestions();
	addLinkToPlace(md, "relax for a while", 481, "", "You sit on a piece of machinery for a while", "", "WaitHere(3)");
	addLinkToPlace(md, "walk to down the road", 480);
	if (checkPlaceFlag("Park", 5)) addLinkToPlace(md,
		"return all the way back to Yoolaroo Drive", 43);
	WritePlaceFooter(md)
}

function ShowPlace990() {
	var md = WritePlaceHeader(false, isExplicit() && stage == "end" ? "td-left-large" : "");
	var stage = getQueryParam("stage");
	var fldr = "Player/" + sAvatarFolder;
	if (stage === "") AddImage(fldr + "/charmedbydavy-start.jpg");
	else if (isExplicit() && stage == "end")
		if (!perYou.isBornMale()) AddImage(fldr + "/Explicit/charmedbydavy-enslaved.jpg");
		else AddImage(fldr + "/charmedbydavy-enslaved.jpg");
	else AddImage(fldr + "/charmedbydavy-resisting.jpg");
	if (stage === "") {
		addPlaceTitle(md, "Hotel Room 101");
		perYou.setFlag(31);
		md.write('<p>Davy looks angry as you intrude on his activity. "You are really beginning to annoy me," he says, then you hear him whisper <i>"Dai Chu ' + perYou.getPersonName() + '"</i>.</p>');
		if (perYou.isBornMale()) {
			md.write('<p>"Congratulations ' + perYou.getPersonName() + '," he says, "You are are now my loyal slave."</p>');
			md.write('<p>"Hello," says Kate, smiling a welcome to you. "Have you come to join in the fun?"</p>');
			md.write("<p>A strange sensation comes over you, filling your loins with desire. Passion wells up, destroying your inhibitions, and you start to remove your clothes.</p>")
		} else {
			md.write('<p>"Congratulations ' +
				perYou.getPersonName() + '," he says, leering at your body. "You are are now my loyal slave."</p>');
			md.write('<p>"Hello," says Kate, smiling a welcome to you. "Have you come to join in the fun?"</p>');
			md.write("<p>A strange sensation comes over you, filling your loins and breasts with desire. Passion wells up, destroying your inhibitions, and you start to remove your clothes.</p>")
		}
		if (perYou.checkFlag(18) && nMana > 19) md.write("<p>Groggily you can feel how all this is wrong, as the magic in you and the spell conflict with each other.</p>");
		else perYou.charmThem(4, "Davy");
		startQuestions("You must:");
		if (perYou.checkFlag(18) && nMana > 19) addLinkToPlaceO(md, "no!, try to fight the spell", 990, "stage=resist");
		addLinkToPlaceO(md, "remove all your clothes.", 990, "stage=end")
	} else if (stage === "resist") {
		AddMana(-20);
		addPlaceTitle(md, "Resisting Davy's Spell");
		md.write("<p>The mana in you surges as you struggle to resist the spell. You suddenly feel the spell vanish and your mana is drained by the struggle.</p>");
		md.write("<p>Davy has not noticed as he continues to fuck Kate...</p>");
		startQuestions();
		addLinkToPlace(md, "go back to the bar", 124)
	} else {
		addPlaceTitle(md, "Davy's Loyal Slave");
		if (perYou.isBornMale()) md.write("<p>\u201cStop resisting already!\u201d Davy shouts with an irritated voice when he catches your attempt to fight his spell, and the force behind his command causes your concentration to slip.</p>" + "<p>\u201cDo you think that you are able to withstand my power? Do you really believe that you are my rival? My equal? You are nothing!\u201d</p>" + "<p>The words crash into your mind like a train and shatter your last resistance.</p>" +
			"<p>\u201cYou are an amateur playing with forces you don't even understand, the pure idea that you might be on my level is a joke!\u201d</p>" + "<p>You can practically feel your mind changing with every word as your confidence drains away, and of course, he is right... How could a lowly novice warlock like you even hope to stand up to one as powerful as him?</p>" + "<p>You fall to your knees as the realization hits you: It is just as he says.</p>" + "<p>Davy is leagues above you. A warlock of an ancient bloodline with power you could never even dream to achieve, smart, experienced and so very handsome...</p>" +
			"<p>How could you not see sooner that you should have wanted nothing more than to serve this wonderful man? How could you oppose him like this?</p>" + "<p>At least Davy seems to be able to relax now that you are groveling before him and no longer a threat, and you gaze at him with adoration as he grasps Kate's hair and drags her in front of you.</p>" + "<p>\u201cThis is why you were here right? To steal my bitch.\u201d He chuckles coldly.\u201d As if you even could!\u201d</p>" + "<p>He pushes Kate's head to the ground right in front of your crotch, moves behind her, and without a second of delay pushes his cock into her pussy.</p>" +
			"<p>\u201cYou love hat, right, bitch?\u201d He begins to harshly rock his hip forward and once again takes a hold of her hair. \u201cTell him!\u201d</p>" + "<p>Kate looks at you with glassy eyes as he pulls her head back to align with yours, her face a grimace of pain and lust while your former enemy pounds into her right in front of you.</p>" + "<p>\u201cYes, Davy! I love it, " + perYou.getPersonName() + "! I love it when he fucks my pussy! I love being his horny bitch!\u201d</p>" + "<p>She almost screams the words out in pure lust, panting and moaning heavily every time Davy's hip collides with her rear while you watch the two. The woman you wanted, the one you thought you loved has been claimed by a superior warlock, and you can only watch as he satisfies her in ways you never could.</p>" +
			"<p>Never in your life have you felt this mortified.... and this aroused... Kate will never be yours now, but at least you are allowed to watch as Davy, your new Master, fucks her in front of you, again and again...</p>");
		else md.write("<p>\u201cStop resisting already!\u201d Davy shouts with an irritated voice when he catches your attempt to fight his spell, and the force behind his command causes your concentration to slip.</p>" + "<p>\u201cDo you think that you are able to withstand my power? Do you really believe that you are my rival? My equal?\u201d</p>" +
			"<p>Davy's voice is shaking as he angrily pushes Kate off his lap, and despite your best attempts to fight back the desire building within you, your body betrays you.</p>" + "<p>\u201cYou are nothing, " + perYou.getPersonName() + "!\u201d</p>" + "<p>You tremble as he speaks your name, and when you try to back away from him, you lose your balance and fall flat on your rear.</p>" + "<p>\u201cYou are not even worth being my slave, you will be a toy for me to stick my cock into!\u201d</p>" + "<p>His words hammer into your mind, and while you desperately try to push him away, you find you lack the strength, well, more of the will to do so.</p>" +
			"<p>\u201cNot even able to struggle? Good.\u201d He takes a hold of your hair, and despite your feeble attempts to suppress his influence, you find your heart racing faster the moment he pushes your face against his cock.</p>" + "<p>\u201cNow, open your whoremouth and savor this, bitch, because it is the closest you will ever get to tasting Kate's pussy!\u201d</p>" + "<p>Everything in you just screams to clamp your teeth shut, but of course you don't. Your lips open wide without even taking a moment to think about it and your tongue rolls out in anticipation for what is to come next, and Davy doesn't even wait a second before he roughly forces himself into your mouth.</p>" +
			"<p>\u201cFinally...\u201d Davy's voice relaxes a little, and you gag as the tip of his cock pushes against your throat and the grip around your hair tightened to keep your head in place. \u201cI wanted to do this ever since that party where you tried to steal Kate from me.\u201d</p>" + "<p>Your head begins to spin from the lack of oxygen, leaving you all the more suggestible to his orders. \u201cYou like that, cockslut? I know you do!\u201d He forces his Tip into your throat and your lips wrap around the base of his cock. \u201cYou will crave having my cock in your holes, it will be all you live for, and you only get it when you are nice and obedient.\u201d</p>" +
			"<p>Your mind absorbs every single word as the spell claims you fully and a new truth begins to take root: Davy is right. He has defeated you fair and square and the least you can do is to gracefully bow to the superior warlock and let him fuck your mouth, ass and pussy whenever he wants to.</p>" + "<p>Your new master is very rough when he finally begins to move his hip, but you can't really blame him after all you have put him through. He holds your head in place, just rams his cock into your mouth over and over, and what began as painful and uncomfortable, even nauseating at first, quickly changes with every stroke.</p>" +
			"<p>Your head is still spinning and tears have started to well in your eyes, and yet you are happy. Davy, the most powerful warlock of Glenvale is using your mouth for his pleasure and deep down you know that this is all you ever wanted.</p>" + "<p>You brace yourself as you notice his impeding climax, and when he finally pulls out and your face is hit by a load of salty cum... you know that this is the happiest day in your life.</p>");
		startQuestions("You can only:");
		addOptionLink(md, "Restart Game",
			"DoRestart()")
	}
	WritePlaceFooter(md)
}

function ShowPlace991(stype) {
	var md = WritePlaceHeader();
	perYou.health = 0;
	perYourBody.DropItem(4, "Mayor");
	findPerson("Mayor").showPerson("mayor6a.jpg");
	addPlaceTitle(md, "Shot!");
	md.write("<p>You hand the book to the mayor, who snatches it away. Before you can respond a bullet strikes you in the chest, then " + "penetrates out the other side of your body, taking ribbons of flesh with it. You can't believe that after all this play the " + "game has ended this way. Your life ebbs away and all you can think of is revenge in the afterlife.</p>" + "<p>Better luck next time...</p>");
	startQuestions();
	addRestartLink(md);
	WritePlaceFooter(md)
}

function ShowPlace992(stype) {
	var md = WritePlaceHeader();
	perYou.charmThem(4, "Davy");
	nMana = 0;
	updateLeftBar();
	AddImage("Endings/robbinsbadendb.jpg");
	addPlaceTitle(md, "Unexpected Awakening ");
	md.write("<p>You wake up, a burning arousal washing through your groin" + (perYou.isBornMale() ? "" : " and breasts") + ". Distractedly you notice you are completely naked and a bit drained, do you have any mana left? You hear a voice from behind you,</p>" + '<p>"Well done slut-Mom and Big Sister-slut! ' + perYou.getPersonName() +
		' is mine, my loyal, unquestioning slave!"</p>' + "<p>The words beat into your mind and you know it is Davy and that he has cast the charm spell on you. ");
	if (isCharmedBy("Tina")) md.write("Tina also seems to be charmed by him, how did he remove your spell and control her? ");
	md.write("You feel defenceless, no mana and no possessions but try to struggle against the spell flooding through you.</p>" + '<p>Davy commands "Tina, time for you and Mom to help me with my new slave"</p>' + "<p>Tina is clearly in charge as they approach you, but you think she is not really into it. She has probably been ordered to dominate her mother and either does not like it, or is resisting Davy's control. At another time and place this would be helpful, but as you are struggling in your own control it means little.</p>" +
		"<p>They move over you with an impossible to resist mother-daughter assault of kisses, slaps, pussies and breasts. You loose all your resistance and completely succumb to them and the spell.</p>" + "<p>You are <b>Davy's slave</b> and all is lost for you. Better luck next time...</p>");
	startQuestions();
	addRestartLink(md);
	WritePlaceFooter(md)
}

function ShowPlace993(stype) {
	var md = WritePlaceHeader(false, "", "black");
	perYou.charmThem(4, "Demon");
	nMana = 0;
	updateLeftBar();
	AddImage("Endings/ending-demonslave.jpg");
	addPlaceTitle(md, "Demon's Slave", "", 0, false, "white");
	md.write("<p>You appear somewhere in darkness, hot, cloying darkness. A feminine presence embraces you and kisses you passionately on your lips.</p>" + "<p>You feel a wave of magic wash over you, overpowering any and all of your defences, the woman steps back and you clearly see her, your Mistress, your one and only purpose in life!</p>" +
		'<p>She whispers, "Now cum for me my slave, my thrall!"</p>' + "<p>Your mind, your will, your sanity is washes away in the cataclysmic orgasm that wracks your....your Mistresses thrall's body!</p>" + "<p>You are a demon's plaything, happily serving her every desire without thought, without will. Better luck next time...</p>");
	startQuestions();
	addRestartLink(md);
	WritePlaceFooter(md, "", true, true)
}

function ShowPlace995() {
	var md = WritePlaceHeader(false, perJesse.place == 2 ? "td-left-large" : "");
	var perSera = findPerson("Seraphina");
	if (perJesse.place == 2) perSera.showPerson("thrall1-1.jpg");
	else if (perJesse.place == 6) perJesse.showPerson("jesse9.jpg");
	else if (perJesse.place == 8) perJesse.showPerson("jesse11.jpg");
	perYou.setFlag(31);
	addPlaceTitle(md, "The End Of the Road");
	md.write("<p>Legions presence is a constant strain on your will, but you believed that you understood the power behind the creature's allure by now and knew how to withstand it.</p>" +
		"<p>You were wrong.</p>" + "<p>A tiny lapse of judgment, a brief moment of overconfidence... it was all it took for the demon to get inside your head and plant a tiny seed of discord, the idea that... maybe... you are missing a wonderful chance by denying yourself to the creature.</p>" + "<p>Your heart begins to beat faster as her influence spreads within your thoughts, and your gaze lingers on the creatures sweet lips, watching as she slowly and oh so enticingly runs her tongue over them.</p>" + "<p>\u201cReally " +
		perYou.getPersonName() + "?\u201d She taunts you as you take a step closer to her, your eyes glazing over. \u201cAfter all that bravado at the park, this is how you want it to end?\u201d</p>" + "<p>You stop in your tracks and try to tear yourself away from her, but it is no use, her smell, her voice, her sweet lips... everything about her promises pleasures untold if you'd just give in and strop struggling... If you'd just allow her to embrace you and share that kiss...</p>" + "<p>\u201cYou could have been a so much more useful tool than a mere thrall.\u201d Her voice seems to hallow inside your mind as she approaches you, and now that her lips are close enough to allow you to feel her breath on your skin, her sweet smell is overtaking your senses. \u201cBut we will not loose the opportunity to claim a soul as... precious as yours. So we shall ask again...\u201d</p>" +
		"<p>You feel her fingers caress your cheek and sliding under your chin, your eyes locking on hers as she whispers to you with a soft hiss.</p>" + '<p>"Would you like to... Kiss me?"</p>' + "<p>Your heart is racing as you hear those words, and you are barely in control of your lips when you whisper the answer.\u201d</p>" + "<p>\u201cYesss...\u201d</p>" + "<p>A cold chuckle hallows in your mind, but as the demon finally lays her lips upon yours, you no longer care and pour all your desire, all your passion into this one embrace, your entire being taking over by pure bliss until you suddenly experience the most alien sensation you have ever felt in your life.</p>" +
		"<p>Within your own ears echoes the empty sound of your very soul being sucked down into the abyss that is the Legion within the body of Jesse, and the instant that it begins, you know that you are lost.</p>" + "<p>The Demon devours your soul as if it were a fine meal, and moments later, she pulls away from you and looks into your deep, black, soulless eyes with a cold smile. \u201cVery good, now come, my pet, we have much to do.\u201d</p>" + "<p>You follow Legion into your mothers bedroom, and your body tingles all over as you watch her rise to her feet by an unseen command and close her eyes. Legion embraces your mother gently, and the moment their lips touch, you know hers is the first soul of many you would help your mistress claim, and you will love every second of it...</p>");
	startQuestions();
	addRestartLink(md);
	WritePlaceFooter(md)
}

function ShowPlace996() {
	var md = WritePlaceHeader(true);
	md.write('<table class="table-main"><tr><td style="vertical-align:top">');
	md.write('<img src="Images/Player/' + sAvatarFolder + '/ritualbadend.jpg" style="border-width:2px;border-style:solid;margin:0px 5px" alt="Player">');
	addPlaceTitle(md, "The End Of the Road");
	md.write("<p>Within moments of dropping your own hair clipping into the cup you realize the severity of your mistake.</p>" + "<p>A sinking feeling in the pit of your stomach accompanies a wrenching feeling deep within you as your soul is " + "ripped from your body and bound forever within the quartz crystal upon the altar.</p>" +
		"<p>Gazing out through the hazy walls of your crystalline prison you can see the Ghost of Kurndorf laugh maniacally as " + "his spirit moves to inhabit the now-soulless husk that was once <i>your</i> body.</p>" + '<p>"Fool, ' + perYou.getSex() + '!" he says derisively.  "Did you really think that ' + 'a man of my <i>power</i> would deign to serve one such as you?  You fell right into my trap!"</p>' + "<p>Moments later you hear your own voice finish the reborn Warlock's ranting. \"Now this town shall feel the wrath " +
		'of Carl Kurndorf <b>REBORN</b>.  Let all tremble and serve at my feet."</p>' + '<p>The Witch warned you...  <i>"Even in death Kurndorf is dangerous,"</i> she said.  If only you had listened.</p><br>');
	startQuestions();
	if (perKurndorf.checkFlag(18) && gameState.bAllowUndo) addLinkToPlaceO(md, "go back and make a different choice", 343);
	else perKurndorf.setQuestRitual(999);
	perYou.setFlag(31);
	addOptionLink(md, "restart the game and do things differently", "DoRestart()");
	WritePlaceFooter(md)
}

function ShowPlace997() {
	perYou.setFlag(31);
	var md = WritePlaceHeader();
	addPlaceTitle(md, "The End Of the Road", "crypt1.jpg");
	md.write("<p>You find yourself trapped within your own body as the spirit of Carl Kurndorf " + "slips in through your mouth and quickly takes total control.</p>" + '<p>The Witch had warned you...  <i>"Even in death Kurndorf is dangerous,"</i> she said.</p>' + "<p>If only you had listened...  If only you had found some way of protecting yourself from " + "his influence.  Surely there must have been some spell or artifact that could have shielded you " +
		"from him once he had been summoned.</p>" + "<p>But its too late now.  Within your body your soul cringes at the thought of the evil " + "you have just unleashed upon the world.  And from somewhere within you can hear the " + "evil laughter of the Warlock as he stretches the limbs of his new body.</p>");
	startQuestions();
	addOptionLink(md, "Restart Game", "DoRestart()");
	WritePlaceFooter(md)
}

function ShowPlace998() {
	var md = WritePlaceHeader();
	perYou.setFlag(30);
	addPlaceTitle(md, "Glenvale Jail", "jail1.jpg");
	md.write("<p>Alone in your cell you wonder how you have failed to complete the adventure game.</p>" + '<p>Did you use your mana/cash to frivolously?  Did you go somewhere you shouldn\'t have without removing some "damning" evidence?</p>' + "<p>The game is meant to challenge, and there <b>are</b> pitfalls, most of which you can get out of if you use your resources wisely.</p>" + "<p>Better luck next time...  I wonder...  What will you do differently then?</p>");
	startQuestions();
	addOptionLink(md, "Restart Game", "DoRestart()");
	WritePlaceFooter(md, "", true)
}

function ShowPlace999() {
	var md = WritePlaceHeader(true);
	addPlaceTitle(md, "The End Of the Road", "", 0, true);
	md.write("<p>Congratulations for finding the end of the road. Unfortunately " + "this means that you can't get any farther in the game yet but I'm " + "busily creating the rest for you as you read this page.</p>" + "<p>The plot, dialogue and pictures have been added to the game " + "from people just like you. So why don't you join in with our " + "discussion forum and post your ideas.</p>");
	addOptionLink(md,
		"Return to the game.", "Place = nFromPlace;history.back()");
	WritePlaceFooter(md)
};